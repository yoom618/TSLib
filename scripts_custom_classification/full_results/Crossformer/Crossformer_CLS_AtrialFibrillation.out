Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2231028079986572
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3416130542755127
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.33442115783691406
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3934638500213623
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5776464939117432
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.46361231803894043
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43706440925598145
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4330577850341797
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.39003562927246094
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.39731287956237793
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.3284873962402344
Epoch: 11, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4500753879547119
Epoch: 12, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.42199110984802246
Epoch: 13, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5542197227478027
Epoch: 14, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4584500789642334
Epoch: 15, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5090477466583252
Epoch: 16, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5270884037017822
Epoch: 17, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.37343788146972656
Epoch: 18, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5913262367248535
Epoch: 19, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.42081141471862793
Epoch: 20, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14394175
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.674203872680664
Epoch: 1, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4086315631866455
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.41585493087768555
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3919034004211426
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.41928935050964355
Epoch: 5, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.39950084686279297
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.381009578704834
Epoch: 7, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4383089542388916
Epoch: 8, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4499990940093994
Epoch: 9, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.44987940788269043
Epoch: 10, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.36968159675598145
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4135253429412842
Epoch: 12, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.35868120193481445
Epoch: 13, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14368063
model size : 59.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.487180709838867
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48905205726623535
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4568314552307129
Epoch: 3, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4935934543609619
Epoch: 4, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48043298721313477
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4368562698364258
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49836158752441406
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49538683891296387
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3986854553222656
Epoch: 9, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4276599884033203
Epoch: 10, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.5771944522857666
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6058204174041748
Epoch: 12, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5918927192687988
Epoch: 13, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.545384407043457
Epoch: 14, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5023019313812256
Epoch: 15, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5050976276397705
Epoch: 16, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5202100276947021
Epoch: 17, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.563417911529541
Epoch: 18, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.348 Vali Acc: 0.267 Test Loss: 1.348 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5836882591247559
Epoch: 19, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6517140865325928
Epoch: 20, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.385 Vali Acc: 0.200 Test Loss: 1.385 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14341951
model size : 59.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.557316541671753
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4377880096435547
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5177164077758789
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47515368461608887
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.509650468826294
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.185 Vali Acc: 0.133 Test Loss: 1.185 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.37880730628967285
Epoch: 6, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.45267772674560547
Epoch: 7, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.200 Vali Acc: 0.133 Test Loss: 1.200 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4979720115661621
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5862288475036621
Epoch: 9, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.489579439163208
Epoch: 10, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5156247615814209
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5412728786468506
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.245 Vali Acc: 0.067 Test Loss: 1.245 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 14315839
model size : 59.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1823480129241943
Epoch: 1, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6153378486633301
Epoch: 2, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.47818922996520996
Epoch: 3, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6191473007202148
Epoch: 4, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.745891809463501
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6237080097198486
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7038938999176025
Epoch: 7, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.643207311630249
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7300136089324951
Epoch: 9, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4292471408843994
Epoch: 10, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4844543933868408
Epoch: 11, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6424000263214111
Epoch: 12, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6399884223937988
Epoch: 13, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12030271
model size : 50.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.021867513656616
Epoch: 1, Steps: 1 | Train Loss: 1.300 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5601975917816162
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4872245788574219
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4378190040588379
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5455174446105957
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49456143379211426
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5520975589752197
Epoch: 7, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6997907161712646
Epoch: 8, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5998449325561523
Epoch: 9, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6043343544006348
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.47348642349243164
Epoch: 11, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5938928127288818
Epoch: 12, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5569751262664795
Epoch: 13, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5991876125335693
Epoch: 14, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12004159
model size : 50.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0838890075683594
Epoch: 1, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5507762432098389
Epoch: 2, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.700810432434082
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7058048248291016
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6111893653869629
Epoch: 5, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.721848726272583
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6004483699798584
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6324923038482666
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6251082420349121
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.622624397277832
Epoch: 10, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6364593505859375
Epoch: 11, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6855924129486084
Epoch: 12, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8838441371917725
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5946438312530518
Epoch: 14, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5217161178588867
Epoch: 15, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.670691967010498
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11978047
model size : 50.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8620851039886475
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5578339099884033
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5826997756958008
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.250 Vali Acc: 0.200 Test Loss: 1.250 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5341360569000244
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.247 Vali Acc: 0.067 Test Loss: 1.247 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.623084545135498
Epoch: 5, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.249 Vali Acc: 0.133 Test Loss: 1.249 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6011719703674316
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5739734172821045
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5150561332702637
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.627145528793335
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.646634578704834
Epoch: 10, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6173491477966309
Epoch: 11, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.287 Vali Acc: 0.200 Test Loss: 1.287 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11951935
model size : 50.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.916536331176758
Epoch: 1, Steps: 1 | Train Loss: 1.360 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6143252849578857
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6197412014007568
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6333997249603271
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5564799308776855
Epoch: 5, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5519723892211914
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6518793106079102
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6135797500610352
Epoch: 8, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.711531400680542
Epoch: 9, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6249663829803467
Epoch: 10, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7884383201599121
Epoch: 11, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6560173034667969
Epoch: 12, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10848319
model size : 46.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.822256326675415
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7008771896362305
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6059949398040771
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.592181921005249
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5498976707458496
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.525867223739624
Epoch: 6, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6206388473510742
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.587244987487793
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7645115852355957
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6123025417327881
Epoch: 10, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5663609504699707
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6733682155609131
Epoch: 12, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6032721996307373
Epoch: 13, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.520514965057373
Epoch: 14, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10822207
model size : 46.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0660853385925293
Epoch: 1, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6851813793182373
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7356188297271729
Epoch: 3, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7018671035766602
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6263742446899414
Epoch: 5, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6055688858032227
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5582380294799805
Epoch: 7, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.617844820022583
Epoch: 8, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.5799667835235596
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7755646705627441
Epoch: 10, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7253406047821045
Epoch: 11, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6367526054382324
Epoch: 12, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6132762432098389
Epoch: 13, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7349612712860107
Epoch: 14, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7900087833404541
Epoch: 15, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6509273052215576
Epoch: 16, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.250 Vali Acc: 0.200 Test Loss: 1.250 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6523818969726562
Epoch: 17, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7096195220947266
Epoch: 18, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10796095
model size : 46.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5397307872772217
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9151322841644287
Epoch: 2, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6787266731262207
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7597601413726807
Epoch: 4, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8646674156188965
Epoch: 5, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.834336519241333
Epoch: 6, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7279813289642334
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.627363920211792
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7180099487304688
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9733762741088867
Epoch: 10, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9216828346252441
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6757028102874756
Epoch: 12, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8026623725891113
Epoch: 13, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7093496322631836
Epoch: 14, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.727567195892334
Epoch: 15, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.7350707054138184
Epoch: 16, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7371587753295898
Epoch: 17, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6651804447174072
Epoch: 18, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6284468173980713
Epoch: 19, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8209409713745117
Epoch: 20, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8346145153045654
Epoch: 21, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.253 Vali Acc: 0.133 Test Loss: 1.253 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8470015525817871
Epoch: 22, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6814391613006592
Epoch: 23, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5264766216278076
Epoch: 24, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5146856307983398
Epoch: 25, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.347 Vali Acc: 0.200 Test Loss: 1.347 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10769983
model size : 46.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1845791339874268
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8412551879882812
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.709871768951416
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6166543960571289
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7558541297912598
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.673898458480835
Epoch: 6, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7285118103027344
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6387248039245605
Epoch: 8, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6049084663391113
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6782224178314209
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6853282451629639
Epoch: 11, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7093489170074463
Epoch: 12, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5959875583648682
Epoch: 13, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10257343
model size : 44.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4202139377593994
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6720936298370361
Epoch: 2, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5662674903869629
Epoch: 3, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6767675876617432
Epoch: 4, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.7363123893737793
Epoch: 5, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7837367057800293
Epoch: 6, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.8094031810760498
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5658249855041504
Epoch: 8, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6996777057647705
Epoch: 9, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6042475700378418
Epoch: 10, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6705503463745117
Epoch: 11, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7071223258972168
Epoch: 12, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.6210265159606934
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.7245242595672607
Epoch: 14, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7777295112609863
Epoch: 15, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9365940093994141
Epoch: 16, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7622501850128174
Epoch: 17, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6918201446533203
Epoch: 18, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7389814853668213
Epoch: 19, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6029965877532959
Epoch: 20, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8720002174377441
Epoch: 21, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.669715404510498
Epoch: 22, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.355 Vali Acc: 0.267 Test Loss: 1.355 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6583192348480225
Epoch: 23, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.342 Vali Acc: 0.267 Test Loss: 1.342 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 10231231
model size : 44.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5849204063415527
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7130775451660156
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9164624214172363
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7464442253112793
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7410306930541992
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7616560459136963
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7483270168304443
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8488903045654297
Epoch: 8, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7959117889404297
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6943740844726562
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6872208118438721
Epoch: 11, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7302610874176025
Epoch: 12, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7399106025695801
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7861685752868652
Epoch: 14, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10205119
model size : 44.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6500823497772217
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5956830978393555
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6314256191253662
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6921241283416748
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.632063627243042
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.630190372467041
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6585159301757812
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6640136241912842
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6439478397369385
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7132971286773682
Epoch: 10, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.669457197189331
Epoch: 11, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8047168254852295
Epoch: 12, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10179007
model size : 43.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.687504291534424
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6639597415924072
Epoch: 2, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.115 Vali Acc: 0.133 Test Loss: 1.115 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7026033401489258
Epoch: 3, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.114 Vali Acc: 0.133 Test Loss: 1.114 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.630856990814209
Epoch: 4, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.114 Vali Acc: 0.133 Test Loss: 1.114 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5979280471801758
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.114 Vali Acc: 0.133 Test Loss: 1.114 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5685551166534424
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.6405460834503174
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7947425842285156
Epoch: 8, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6639220714569092
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0526306629180908
Epoch: 10, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6873512268066406
Epoch: 11, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7490990161895752
Epoch: 12, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6945891380310059
Epoch: 13, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6737005710601807
Epoch: 14, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7057280540466309
Epoch: 15, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.623950719833374
Epoch: 16, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7567715644836426
Epoch: 17, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4842431
model size : 21.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6911730766296387
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6584906578063965
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6622223854064941
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6840164661407471
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6933097839355469
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7344720363616943
Epoch: 6, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6398782730102539
Epoch: 7, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6607015132904053
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6539263725280762
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.752312421798706
Epoch: 10, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7889049053192139
Epoch: 11, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4829375
model size : 21.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3878345489501953
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7016818523406982
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5860598087310791
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6796784400939941
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6609807014465332
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7392661571502686
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.754976749420166
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6135621070861816
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.76918625831604
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7806000709533691
Epoch: 10, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7860171794891357
Epoch: 11, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4816319
model size : 21.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2968039512634277
Epoch: 1, Steps: 1 | Train Loss: 1.433 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6450088024139404
Epoch: 2, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5405888557434082
Epoch: 3, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6280059814453125
Epoch: 4, Steps: 1 | Train Loss: 1.399 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.693082332611084
Epoch: 5, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.6406850814819336
Epoch: 6, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.087 Vali Acc: 0.133 Test Loss: 1.087 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7167162895202637
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6102569103240967
Epoch: 8, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6320843696594238
Epoch: 9, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6659808158874512
Epoch: 10, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7757918834686279
Epoch: 11, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6253869533538818
Epoch: 12, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7889308929443359
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6802477836608887
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.769934892654419
Epoch: 15, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6544873714447021
Epoch: 16, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6425542831420898
Epoch: 17, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4803263
model size : 20.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1544976234436035
Epoch: 1, Steps: 1 | Train Loss: 1.536 Vali Loss: 1.487 Vali Acc: 0.333 Test Loss: 1.487 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.6101493835449219
Epoch: 2, Steps: 1 | Train Loss: 1.451 Vali Loss: 1.395 Vali Acc: 0.333 Test Loss: 1.395 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.636674165725708
Epoch: 3, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.314 Vali Acc: 0.333 Test Loss: 1.314 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.788395881652832
Epoch: 4, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5587029457092285
Epoch: 5, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6111118793487549
Epoch: 6, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5333127975463867
Epoch: 7, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5612809658050537
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5604548454284668
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6673660278320312
Epoch: 10, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6942636966705322
Epoch: 11, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.662926435470581
Epoch: 12, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6468181610107422
Epoch: 13, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6517772674560547
Epoch: 14, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7037734985351562
Epoch: 15, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6864228248596191
Epoch: 16, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6234676837921143
Epoch: 17, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.668936014175415
Epoch: 18, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3658175
model size : 16.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5136702060699463
Epoch: 1, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.195 Vali Acc: 0.133 Test Loss: 1.195 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6728849411010742
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.6213474273681641
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.565706729888916
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6925754547119141
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6079742908477783
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5582330226898193
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.712313175201416
Epoch: 8, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7311949729919434
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7238879203796387
Epoch: 10, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5862255096435547
Epoch: 11, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6648404598236084
Epoch: 12, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5931429862976074
Epoch: 13, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7682158946990967
Epoch: 14, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3645119
model size : 16.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5981101989746094
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5349926948547363
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.570784330368042
Epoch: 3, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.6557207107543945
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.6751446723937988
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7864415645599365
Epoch: 6, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6347613334655762
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5929956436157227
Epoch: 8, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6394004821777344
Epoch: 9, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5716073513031006
Epoch: 10, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6580746173858643
Epoch: 11, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.146 Vali Acc: 0.067 Test Loss: 1.146 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.530475378036499
Epoch: 12, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5695974826812744
Epoch: 13, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5474987030029297
Epoch: 14, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6301703453063965
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5750129222869873
Epoch: 16, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3632063
model size : 16.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4892385005950928
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6871931552886963
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8367099761962891
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7622289657592773
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.7417116165161133
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.7816410064697266
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.8510518074035645
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7492756843566895
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6163642406463623
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7185652256011963
Epoch: 10, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7178256511688232
Epoch: 11, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6998522281646729
Epoch: 12, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7372643947601318
Epoch: 13, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7609050273895264
Epoch: 14, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6543924808502197
Epoch: 15, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7733192443847656
Epoch: 16, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3619007
model size : 16.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7443885803222656
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8259017467498779
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6887016296386719
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7264504432678223
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.62929368019104
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6575348377227783
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6505768299102783
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6778368949890137
Epoch: 8, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6207191944122314
Epoch: 9, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5847828388214111
Epoch: 10, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6576263904571533
Epoch: 11, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7576901912689209
Epoch: 12, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6275784969329834
Epoch: 13, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.663642168045044
Epoch: 14, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7824513912200928
Epoch: 15, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8935635089874268
Epoch: 16, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7895910739898682
Epoch: 17, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.637535572052002
Epoch: 18, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6413102149963379
Epoch: 19, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5832662582397461
Epoch: 20, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6582059860229492
Epoch: 21, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3066047
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.377511501312256
Epoch: 1, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.680401086807251
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7591054439544678
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.916759729385376
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7321734428405762
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6380205154418945
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7694721221923828
Epoch: 7, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7083079814910889
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6320772171020508
Epoch: 9, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7894501686096191
Epoch: 10, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7377581596374512
Epoch: 11, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7310206890106201
Epoch: 12, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8046362400054932
Epoch: 13, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6089348793029785
Epoch: 14, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9182798862457275
Epoch: 15, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3052991
model size : 14.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.571280002593994
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8620572090148926
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7300140857696533
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5928940773010254
Epoch: 4, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6692578792572021
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.721776008605957
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7579288482666016
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.623943567276001
Epoch: 8, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6994705200195312
Epoch: 9, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6662261486053467
Epoch: 10, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6809959411621094
Epoch: 11, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.764869213104248
Epoch: 12, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7832365036010742
Epoch: 13, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7150459289550781
Epoch: 14, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3039935
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9996674060821533
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7208313941955566
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8379383087158203
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6976304054260254
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8141014575958252
Epoch: 5, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6462647914886475
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6859116554260254
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.753084659576416
Epoch: 8, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7172107696533203
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7572908401489258
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7416634559631348
Epoch: 11, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7874515056610107
Epoch: 12, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.765735387802124
Epoch: 13, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6951980590820312
Epoch: 14, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6290225982666016
Epoch: 15, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6534121036529541
Epoch: 16, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7411785125732422
Epoch: 17, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3026879
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.330994129180908
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5994200706481934
Epoch: 2, Steps: 1 | Train Loss: 1.358 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6019687652587891
Epoch: 3, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8228421211242676
Epoch: 4, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6434600353240967
Epoch: 5, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6053736209869385
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7439324855804443
Epoch: 7, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6873233318328857
Epoch: 8, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6821019649505615
Epoch: 9, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7407703399658203
Epoch: 10, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6219420433044434
Epoch: 11, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6054015159606934
Epoch: 12, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6713504791259766
Epoch: 13, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6243646144866943
Epoch: 14, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.5781378746032715
Epoch: 15, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6819384098052979
Epoch: 16, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6080074310302734
Epoch: 17, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6690988540649414
Epoch: 18, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7113480567932129
Epoch: 19, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7801146507263184
Epoch: 20, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6138145923614502
Epoch: 21, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6545968055725098
Epoch: 22, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6712594032287598
Epoch: 23, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5999951362609863
Epoch: 24, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2769983
model size : 13.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.276428461074829
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5616145133972168
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7213928699493408
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.7186944484710693
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.69122314453125
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7241349220275879
Epoch: 6, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.714465856552124
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6764819622039795
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6918361186981201
Epoch: 9, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7875573635101318
Epoch: 10, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.625645637512207
Epoch: 11, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7278571128845215
Epoch: 12, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.71999192237854
Epoch: 13, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6959550380706787
Epoch: 14, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8638701438903809
Epoch: 15, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7466754913330078
Epoch: 16, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2756927
model size : 13.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2954437732696533
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6864464282989502
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6004600524902344
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6579084396362305
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6424334049224854
Epoch: 5, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.140 Vali Acc: 0.067 Test Loss: 1.140 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7677137851715088
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7253894805908203
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6917808055877686
Epoch: 8, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6878304481506348
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5891740322113037
Epoch: 10, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.150 Vali Acc: 0.067 Test Loss: 1.150 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5007915496826172
Epoch: 11, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2743871
model size : 13.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1498043537139893
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6926867961883545
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7525005340576172
Epoch: 3, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9013378620147705
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7873880863189697
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7445154190063477
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6135430335998535
Epoch: 7, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5974009037017822
Epoch: 8, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6561615467071533
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7118799686431885
Epoch: 10, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6673686504364014
Epoch: 11, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6820483207702637
Epoch: 12, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6212530136108398
Epoch: 13, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7113595008850098
Epoch: 14, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6227223873138428
Epoch: 15, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2730815
model size : 13.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2161083221435547
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6135623455047607
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7084941864013672
Epoch: 3, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8021337985992432
Epoch: 4, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.192 Vali Acc: 0.133 Test Loss: 1.192 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7863044738769531
Epoch: 5, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7987604141235352
Epoch: 6, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6316773891448975
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.5172586441040039
Epoch: 8, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5542826652526855
Epoch: 9, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8209550380706787
Epoch: 10, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6843152046203613
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8009867668151855
Epoch: 12, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6165435314178467
Epoch: 13, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6424329280853271
Epoch: 14, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7742867469787598
Epoch: 15, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9079039096832275
Epoch: 16, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6512136459350586
Epoch: 17, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7707278728485107
Epoch: 18, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1836031
model size : 8.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6156601905822754
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.701178789138794
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6081364154815674
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6265180110931396
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6941335201263428
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6755709648132324
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9263978004455566
Epoch: 7, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7232062816619873
Epoch: 8, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6620078086853027
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8510422706604004
Epoch: 10, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6613504886627197
Epoch: 11, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6286072731018066
Epoch: 12, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7882790565490723
Epoch: 13, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7479572296142578
Epoch: 14, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6002964973449707
Epoch: 15, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8054370880126953
Epoch: 16, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7621042728424072
Epoch: 17, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6033077239990234
Epoch: 18, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.831017255783081
Epoch: 19, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6497464179992676
Epoch: 20, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6930985450744629
Epoch: 21, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7810816764831543
Epoch: 22, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7044816017150879
Epoch: 23, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1829503
model size : 8.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2513115406036377
Epoch: 1, Steps: 1 | Train Loss: 1.342 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7211909294128418
Epoch: 2, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6525712013244629
Epoch: 3, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.6315083503723145
Epoch: 4, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5751032829284668
Epoch: 5, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.6180496215820312
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.7121677398681641
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6411097049713135
Epoch: 8, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7071857452392578
Epoch: 9, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6565146446228027
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7564244270324707
Epoch: 11, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6569933891296387
Epoch: 12, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.688774824142456
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6828310489654541
Epoch: 14, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7826602458953857
Epoch: 15, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7272665500640869
Epoch: 16, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.596731424331665
Epoch: 17, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1822975
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7128567695617676
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.723461389541626
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5595202445983887
Epoch: 3, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7643370628356934
Epoch: 4, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.110 Vali Acc: 0.133 Test Loss: 1.110 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7076408863067627
Epoch: 5, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6049106121063232
Epoch: 6, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7392401695251465
Epoch: 7, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7729506492614746
Epoch: 8, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.6626298427581787
Epoch: 9, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.025860071182251
Epoch: 10, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8095395565032959
Epoch: 11, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7914433479309082
Epoch: 12, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.620124340057373
Epoch: 13, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7498433589935303
Epoch: 14, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7713422775268555
Epoch: 15, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7222015857696533
Epoch: 16, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7237405776977539
Epoch: 17, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6393201351165771
Epoch: 18, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7907743453979492
Epoch: 19, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6720573902130127
Epoch: 20, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7772717475891113
Epoch: 21, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.941185474395752
Epoch: 22, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8346686363220215
Epoch: 23, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1816447
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9072821140289307
Epoch: 1, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6666927337646484
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7944014072418213
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7046329975128174
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6209688186645508
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8270864486694336
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6417078971862793
Epoch: 7, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6961004734039307
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6294517517089844
Epoch: 9, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7614970207214355
Epoch: 10, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7447326183319092
Epoch: 11, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.661064624786377
Epoch: 12, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7524604797363281
Epoch: 13, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9099423885345459
Epoch: 14, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8536956310272217
Epoch: 15, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7953047752380371
Epoch: 16, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5361495018005371
Epoch: 17, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6367473602294922
Epoch: 18, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7325687408447266
Epoch: 19, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1241599
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5399343967437744
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7230410575866699
Epoch: 2, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6242682933807373
Epoch: 3, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5753934383392334
Epoch: 4, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6203951835632324
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7258017063140869
Epoch: 6, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6514127254486084
Epoch: 7, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6384365558624268
Epoch: 8, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7493875026702881
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6731760501861572
Epoch: 10, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6944067478179932
Epoch: 11, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7568588256835938
Epoch: 12, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9039700031280518
Epoch: 13, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7135539054870605
Epoch: 14, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.827995777130127
Epoch: 15, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7123429775238037
Epoch: 16, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7441756725311279
Epoch: 17, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.658369779586792
Epoch: 18, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8331758975982666
Epoch: 19, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1235071
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.865623950958252
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7117254734039307
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6603991985321045
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5871701240539551
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6005692481994629
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7788112163543701
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7434132099151611
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8875813484191895
Epoch: 8, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.739133358001709
Epoch: 9, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6743636131286621
Epoch: 10, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7154936790466309
Epoch: 11, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7720820903778076
Epoch: 12, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.66184401512146
Epoch: 13, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6495361328125
Epoch: 14, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5794036388397217
Epoch: 15, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6493213176727295
Epoch: 16, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1228543
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.433072090148926
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6820592880249023
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6840741634368896
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7514383792877197
Epoch: 4, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6911141872406006
Epoch: 5, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.5519282817840576
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7569091320037842
Epoch: 7, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9172141551971436
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7304353713989258
Epoch: 9, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7002823352813721
Epoch: 10, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7407891750335693
Epoch: 11, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6937582492828369
Epoch: 12, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5781385898590088
Epoch: 13, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7084410190582275
Epoch: 14, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7210879325866699
Epoch: 15, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1222015
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.709033966064453
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6959719657897949
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5947551727294922
Epoch: 3, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7743611335754395
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7110800743103027
Epoch: 5, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7936975955963135
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6785836219787598
Epoch: 7, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6211822032928467
Epoch: 8, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5881931781768799
Epoch: 9, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6516685485839844
Epoch: 10, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7494652271270752
Epoch: 11, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6469588279724121
Epoch: 12, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.712456226348877
Epoch: 13, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 944383
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.455942153930664
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6939289569854736
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6639273166656494
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8130104541778564
Epoch: 4, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8527069091796875
Epoch: 5, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7738192081451416
Epoch: 6, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7231206893920898
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7405645847320557
Epoch: 8, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6546051502227783
Epoch: 9, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7199780941009521
Epoch: 10, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.843817949295044
Epoch: 11, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6079578399658203
Epoch: 12, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6615619659423828
Epoch: 13, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 937855
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6677987575531006
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8287909030914307
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.8641080856323242
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8663699626922607
Epoch: 4, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8983469009399414
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8869049549102783
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 1.0796868801116943
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7908055782318115
Epoch: 8, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8269574642181396
Epoch: 9, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.904167890548706
Epoch: 10, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 11 cost time: 0.7121620178222656
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.670015811920166
Epoch: 12, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.9149444103240967
Epoch: 13, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7364356517791748
Epoch: 14, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8490912914276123
Epoch: 15, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0377604961395264
Epoch: 16, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9711060523986816
Epoch: 17, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7562525272369385
Epoch: 18, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9097223281860352
Epoch: 19, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.766707181930542
Epoch: 20, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.701678991317749
Epoch: 21, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6933712959289551
Epoch: 22, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6619429588317871
Epoch: 23, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 931327
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6643104553222656
Epoch: 1, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7539768218994141
Epoch: 2, Steps: 1 | Train Loss: 1.399 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6874825954437256
Epoch: 3, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6982371807098389
Epoch: 4, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.8438732624053955
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7374265193939209
Epoch: 6, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9661705493927002
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7070045471191406
Epoch: 8, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.126 Vali Acc: 0.133 Test Loss: 1.126 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8098509311676025
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8298399448394775
Epoch: 10, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7661118507385254
Epoch: 11, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.7003800868988037
Epoch: 12, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8129568099975586
Epoch: 13, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0089201927185059
Epoch: 14, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8359158039093018
Epoch: 15, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7787570953369141
Epoch: 16, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9949061870574951
Epoch: 17, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9010722637176514
Epoch: 18, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 1.0220634937286377
Epoch: 19, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8311588764190674
Epoch: 20, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6866214275360107
Epoch: 21, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7353432178497314
Epoch: 22, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9225382804870605
Epoch: 23, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0125558376312256
Epoch: 24, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7432782649993896
Epoch: 25, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7550230026245117
Epoch: 26, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1258320808410645
Epoch: 27, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7088170051574707
Epoch: 28, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 924799
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5967605113983154
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6636631488800049
Epoch: 2, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9444077014923096
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7709259986877441
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.696690559387207
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7586257457733154
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8477368354797363
Epoch: 7, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6856176853179932
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7798068523406982
Epoch: 9, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.013786792755127
Epoch: 10, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.867412805557251
Epoch: 11, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8111140727996826
Epoch: 12, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9573187828063965
Epoch: 13, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7295856475830078
Epoch: 14, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5179693698883057
Epoch: 15, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6718757152557373
Epoch: 16, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7091310024261475
Epoch: 17, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 795775
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.443650960922241
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8458428382873535
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.94461989402771
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7553157806396484
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.820232629776001
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.205 Vali Acc: 0.067 Test Loss: 1.205 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8536841869354248
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.206 Vali Acc: 0.067 Test Loss: 1.206 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6978921890258789
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.207 Vali Acc: 0.067 Test Loss: 1.207 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7970776557922363
Epoch: 8, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.208 Vali Acc: 0.067 Test Loss: 1.208 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7267909049987793
Epoch: 9, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.209 Vali Acc: 0.067 Test Loss: 1.209 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8423843383789062
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.210 Vali Acc: 0.133 Test Loss: 1.210 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8020687103271484
Epoch: 11, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6817185878753662
Epoch: 12, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 789247
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.480386734008789
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7314140796661377
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.760718584060669
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.938957691192627
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.144620418548584
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.711611270904541
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6691746711730957
Epoch: 7, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7975735664367676
Epoch: 8, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7104182243347168
Epoch: 9, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7312436103820801
Epoch: 10, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6853134632110596
Epoch: 11, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.023531436920166
Epoch: 12, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7994027137756348
Epoch: 13, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.845583438873291
Epoch: 14, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9002001285552979
Epoch: 15, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6438281536102295
Epoch: 16, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7680799961090088
Epoch: 17, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9061169624328613
Epoch: 18, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7373735904693604
Epoch: 19, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9140324592590332
Epoch: 20, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7875077724456787
Epoch: 21, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 782719
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6082208156585693
Epoch: 1, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6811542510986328
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7143380641937256
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7620885372161865
Epoch: 4, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8196077346801758
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8022522926330566
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6969747543334961
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.7199444770812988
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7525885105133057
Epoch: 9, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7347595691680908
Epoch: 10, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.7427268028259277
Epoch: 11, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8339002132415771
Epoch: 12, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6946721076965332
Epoch: 13, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7312765121459961
Epoch: 14, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8170104026794434
Epoch: 15, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7784173488616943
Epoch: 16, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8446717262268066
Epoch: 17, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.747112512588501
Epoch: 18, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8063564300537109
Epoch: 19, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6851990222930908
Epoch: 20, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 776191
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.947446346282959
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9504003524780273
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6713852882385254
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7565877437591553
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8690712451934814
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7871191501617432
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7097232341766357
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7523603439331055
Epoch: 8, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7633485794067383
Epoch: 9, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7245316505432129
Epoch: 10, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7249395847320557
Epoch: 11, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8611721992492676
Epoch: 12, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7622263431549072
Epoch: 13, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7737576961517334
Epoch: 14, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8934774398803711
Epoch: 15, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9103963375091553
Epoch: 16, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8148791790008545
Epoch: 17, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 775199
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1207473278045654
Epoch: 1, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6678049564361572
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5913615226745605
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.645561695098877
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0467522144317627
Epoch: 5, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7593462467193604
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8246088027954102
Epoch: 7, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9373652935028076
Epoch: 8, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8325347900390625
Epoch: 9, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.836296796798706
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7771880626678467
Epoch: 11, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7276458740234375
Epoch: 12, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.742286205291748
Epoch: 13, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.8560981750488281
Epoch: 14, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8631303310394287
Epoch: 15, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7805056571960449
Epoch: 16, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7876262664794922
Epoch: 17, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0719130039215088
Epoch: 18, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8685297966003418
Epoch: 19, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7680830955505371
Epoch: 20, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8357422351837158
Epoch: 21, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8522248268127441
Epoch: 22, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8830008506774902
Epoch: 23, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 771935
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.832498073577881
Epoch: 1, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8572361469268799
Epoch: 2, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5940837860107422
Epoch: 3, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6345744132995605
Epoch: 4, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6601855754852295
Epoch: 5, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.706312894821167
Epoch: 6, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9045019149780273
Epoch: 7, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7506289482116699
Epoch: 8, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.925736665725708
Epoch: 9, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8023271560668945
Epoch: 10, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7683451175689697
Epoch: 11, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7494034767150879
Epoch: 12, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7213239669799805
Epoch: 13, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7559022903442383
Epoch: 14, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8301887512207031
Epoch: 15, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.88319993019104
Epoch: 16, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8265833854675293
Epoch: 17, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.839177131652832
Epoch: 18, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.654996395111084
Epoch: 19, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6418724060058594
Epoch: 20, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 768671
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.693185806274414
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.6767265796661377
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8299989700317383
Epoch: 3, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6635775566101074
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.7372651100158691
Epoch: 5, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.6757862567901611
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.6436748504638672
Epoch: 7, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.7037129402160645
Epoch: 8, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0107781887054443
Epoch: 9, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8151116371154785
Epoch: 10, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.966569185256958
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8317079544067383
Epoch: 12, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6884045600891113
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7527508735656738
Epoch: 14, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9687442779541016
Epoch: 15, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7059650421142578
Epoch: 16, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.725928783416748
Epoch: 17, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 765407
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.588684320449829
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.9304938316345215
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.849787712097168
Epoch: 3, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8443779945373535
Epoch: 4, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8615579605102539
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9881033897399902
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8804445266723633
Epoch: 7, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7129144668579102
Epoch: 8, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7807137966156006
Epoch: 9, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7836928367614746
Epoch: 10, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8123412132263184
Epoch: 11, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 475679
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.546215057373047
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.80633544921875
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7795960903167725
Epoch: 3, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.165454626083374
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8081893920898438
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7541804313659668
Epoch: 6, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9237878322601318
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6900756359100342
Epoch: 8, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7876198291778564
Epoch: 9, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8884396553039551
Epoch: 10, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8433470726013184
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 472415
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8838770389556885
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2656466960906982
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6368386745452881
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6635041236877441
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.7920429706573486
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.678776741027832
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8158326148986816
Epoch: 7, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.992260217666626
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7771220207214355
Epoch: 9, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9288475513458252
Epoch: 10, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.844855785369873
Epoch: 11, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.758275032043457
Epoch: 12, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7452614307403564
Epoch: 13, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7606570720672607
Epoch: 14, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 469151
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0995030403137207
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7270493507385254
Epoch: 2, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6683192253112793
Epoch: 3, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6252169609069824
Epoch: 4, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7261574268341064
Epoch: 5, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9672989845275879
Epoch: 6, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7341842651367188
Epoch: 7, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9754889011383057
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7111709117889404
Epoch: 9, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9070746898651123
Epoch: 10, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8437645435333252
Epoch: 11, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6681880950927734
Epoch: 12, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.0308959484100342
Epoch: 13, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1808226108551025
Epoch: 14, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.936408519744873
Epoch: 15, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1307170391082764
Epoch: 16, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8703205585479736
Epoch: 17, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7288486957550049
Epoch: 18, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7898998260498047
Epoch: 19, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8907480239868164
Epoch: 20, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.902735710144043
Epoch: 21, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.8749592304229736
Epoch: 22, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.8055093288421631
Epoch: 23, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.849545955657959
Epoch: 24, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7756450176239014
Epoch: 25, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7376983165740967
Epoch: 26, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7564549446105957
Epoch: 27, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9373276233673096
Epoch: 28, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8042781352996826
Epoch: 29, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9966275691986084
Epoch: 30, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8182404041290283
Epoch: 31, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8278470039367676
Epoch: 32, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 465887
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5829367637634277
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6934914588928223
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.093364953994751
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8782119750976562
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 1.1366345882415771
Epoch: 5, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.7664756774902344
Epoch: 6, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8838934898376465
Epoch: 7, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7796266078948975
Epoch: 8, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8646771907806396
Epoch: 9, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7579741477966309
Epoch: 10, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7390298843383789
Epoch: 11, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8302743434906006
Epoch: 12, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8785314559936523
Epoch: 13, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9753446578979492
Epoch: 14, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9533801078796387
Epoch: 15, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 325919
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4292151927948
Epoch: 1, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7168979644775391
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7336375713348389
Epoch: 3, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6590476036071777
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.760425329208374
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6920278072357178
Epoch: 6, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7166714668273926
Epoch: 7, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8991987705230713
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.6841285228729248
Epoch: 9, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.124 Vali Acc: 0.600 Test Loss: 1.124 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6420912742614746
Epoch: 10, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7697014808654785
Epoch: 11, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8119614124298096
Epoch: 12, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7598872184753418
Epoch: 13, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6790227890014648
Epoch: 14, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7828385829925537
Epoch: 15, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7457709312438965
Epoch: 16, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8901598453521729
Epoch: 17, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8080527782440186
Epoch: 18, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6188321113586426
Epoch: 19, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 322655
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3282647132873535
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7993373870849609
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7777433395385742
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7911415100097656
Epoch: 4, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6204500198364258
Epoch: 5, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5451598167419434
Epoch: 6, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7229840755462646
Epoch: 7, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6500294208526611
Epoch: 8, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6776223182678223
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6368839740753174
Epoch: 10, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7367568016052246
Epoch: 11, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8564906120300293
Epoch: 12, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8084626197814941
Epoch: 13, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7849562168121338
Epoch: 14, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7619228363037109
Epoch: 15, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8062803745269775
Epoch: 16, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 319391
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3847506046295166
Epoch: 1, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7044327259063721
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6875789165496826
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6449518203735352
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7060399055480957
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.848419189453125
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8287298679351807
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6388218402862549
Epoch: 8, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7280387878417969
Epoch: 9, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6835107803344727
Epoch: 10, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7692661285400391
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7747128009796143
Epoch: 12, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6709742546081543
Epoch: 13, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7462847232818604
Epoch: 14, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8856570720672607
Epoch: 15, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7196412086486816
Epoch: 16, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6388158798217773
Epoch: 17, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6952145099639893
Epoch: 18, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7736265659332275
Epoch: 19, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 316127
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.944730520248413
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.568356990814209
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5344536304473877
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7770040035247803
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.75234055519104
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8340315818786621
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7513394355773926
Epoch: 7, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6585419178009033
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6652560234069824
Epoch: 9, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7767894268035889
Epoch: 10, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6427385807037354
Epoch: 11, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7310519218444824
Epoch: 12, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6234726905822754
Epoch: 13, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6736893653869629
Epoch: 14, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6341350078582764
Epoch: 15, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.90045166015625
Epoch: 16, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6529264450073242
Epoch: 17, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7134668827056885
Epoch: 18, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 251039
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.540590286254883
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7919533252716064
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6468558311462402
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5877349376678467
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5787007808685303
Epoch: 5, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6792933940887451
Epoch: 6, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6962394714355469
Epoch: 7, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6622991561889648
Epoch: 8, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8062446117401123
Epoch: 9, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8740923404693604
Epoch: 10, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7797672748565674
Epoch: 11, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7389721870422363
Epoch: 12, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7348816394805908
Epoch: 13, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6035120487213135
Epoch: 14, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.648773193359375
Epoch: 15, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 247775
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6316983699798584
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7577621936798096
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6738364696502686
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6143817901611328
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.605349063873291
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6781418323516846
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7423098087310791
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8037211894989014
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6854095458984375
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8285737037658691
Epoch: 10, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7653520107269287
Epoch: 11, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7611281871795654
Epoch: 12, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6819653511047363
Epoch: 13, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7201840877532959
Epoch: 14, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7157919406890869
Epoch: 15, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 244511
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7938177585601807
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7730367183685303
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.760150671005249
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8192577362060547
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7603681087493896
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.668764591217041
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6934406757354736
Epoch: 7, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7555136680603027
Epoch: 8, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8231093883514404
Epoch: 9, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.7936501502990723
Epoch: 10, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8587079048156738
Epoch: 11, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9081661701202393
Epoch: 12, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8357267379760742
Epoch: 13, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7334785461425781
Epoch: 14, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6707334518432617
Epoch: 15, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.936100959777832
Epoch: 16, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8294277191162109
Epoch: 17, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.841616153717041
Epoch: 18, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1843390464782715
Epoch: 19, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 241247
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1067075729370117
Epoch: 1, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5490679740905762
Epoch: 2, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6682760715484619
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7153091430664062
Epoch: 4, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6890017986297607
Epoch: 5, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7093081474304199
Epoch: 6, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7236678600311279
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6580042839050293
Epoch: 8, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8240349292755127
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.8487217426300049
Epoch: 10, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7201454639434814
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7899188995361328
Epoch: 12, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8119122982025146
Epoch: 13, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7964203357696533
Epoch: 14, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7966659069061279
Epoch: 15, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.80776047706604
Epoch: 16, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6702826023101807
Epoch: 17, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.901970386505127
Epoch: 18, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8124394416809082
Epoch: 19, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 11231795
model size : 47.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9759023189544678
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6485350131988525
Epoch: 2, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.867194414138794
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6853737831115723
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7996616363525391
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7895550727844238
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6101987361907959
Epoch: 7, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7331485748291016
Epoch: 8, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6382400989532471
Epoch: 9, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8210830688476562
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7749574184417725
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6437816619873047
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7601304054260254
Epoch: 13, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9125759601593018
Epoch: 14, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11207475
model size : 47.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9539525508880615
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6456201076507568
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6988461017608643
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6846175193786621
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5644919872283936
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6442735195159912
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.165 Vali Acc: 0.067 Test Loss: 1.165 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6476895809173584
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.726334810256958
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.6163265705108643
Epoch: 9, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6928122043609619
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.658858060836792
Epoch: 11, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.786672830581665
Epoch: 12, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8627297878265381
Epoch: 13, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7814240455627441
Epoch: 14, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7756161689758301
Epoch: 15, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7246179580688477
Epoch: 16, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.237 Vali Acc: 0.133 Test Loss: 1.237 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7348334789276123
Epoch: 17, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7314343452453613
Epoch: 18, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7029731273651123
Epoch: 19, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.283 Vali Acc: 0.133 Test Loss: 1.283 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5736739635467529
Epoch: 20, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.328 Vali Acc: 0.133 Test Loss: 1.328 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 11183155
model size : 47.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.50079607963562
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5242679119110107
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.266656 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.5706136226654053
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7251279354095459
Epoch: 4, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7833678722381592
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.92441725730896
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6521255970001221
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.685152530670166
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6425182819366455
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5439696311950684
Epoch: 10, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5669922828674316
Epoch: 11, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6106245517730713
Epoch: 12, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 11158835
model size : 47.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6585519313812256
Epoch: 1, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7526471614837646
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6701557636260986
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6589088439941406
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6175429821014404
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5796999931335449
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6579647064208984
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7342281341552734
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6867141723632812
Epoch: 9, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6665835380554199
Epoch: 10, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6562032699584961
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.797435998916626
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.697685956954956
Epoch: 13, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5791187286376953
Epoch: 14, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5877768993377686
Epoch: 15, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9009885787963867
Epoch: 16, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5430307388305664
Epoch: 17, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5983896255493164
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6885552406311035
Epoch: 19, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6309521198272705
Epoch: 20, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6624395847320557
Epoch: 21, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6831254959106445
Epoch: 22, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9393203
model size : 40.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.460963487625122
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7776057720184326
Epoch: 2, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7210497856140137
Epoch: 3, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7527086734771729
Epoch: 4, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7190327644348145
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6325018405914307
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8033895492553711
Epoch: 7, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7917068004608154
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6450724601745605
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6168637275695801
Epoch: 10, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8077771663665771
Epoch: 11, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.536738395690918
Epoch: 12, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8083701133728027
Epoch: 13, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.208 Vali Acc: 0.067 Test Loss: 1.208 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 9368883
model size : 40.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.62088680267334
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7518994808197021
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8606760501861572
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7882702350616455
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7978274822235107
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6320459842681885
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.711249828338623
Epoch: 7, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6832129955291748
Epoch: 8, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7660372257232666
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7214512825012207
Epoch: 10, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6383769512176514
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 9344563
model size : 40.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3983004093170166
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0400340557098389
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6285061836242676
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5633823871612549
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9669520854949951
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7323026657104492
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8522567749023438
Epoch: 7, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8013641834259033
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7260191440582275
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8000152111053467
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7964928150177002
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7991631031036377
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.676285982131958
Epoch: 13, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7371237277984619
Epoch: 14, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7095174789428711
Epoch: 15, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8522977828979492
Epoch: 16, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8960785865783691
Epoch: 17, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8108835220336914
Epoch: 18, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8692159652709961
Epoch: 19, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8275768756866455
Epoch: 20, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8387312889099121
Epoch: 21, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9151551723480225
Epoch: 22, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9320243
model size : 40.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.479933500289917
Epoch: 1, Steps: 1 | Train Loss: 1.373 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6873888969421387
Epoch: 2, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7551190853118896
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.757871150970459
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6164708137512207
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7597103118896484
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5867950916290283
Epoch: 7, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6718196868896484
Epoch: 8, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6792447566986084
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.6352934837341309
Epoch: 10, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7006485462188721
Epoch: 11, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6334829330444336
Epoch: 12, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6553952693939209
Epoch: 13, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.699603796005249
Epoch: 14, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6813585758209229
Epoch: 15, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.6731100082397461
Epoch: 16, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7099542617797852
Epoch: 17, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6384668350219727
Epoch: 18, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6384308338165283
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6656444072723389
Epoch: 20, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.278 Vali Acc: 0.200 Test Loss: 1.278 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.588310718536377
Epoch: 21, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.293 Vali Acc: 0.133 Test Loss: 1.293 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7321062088012695
Epoch: 22, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.262 Vali Acc: 0.133 Test Loss: 1.262 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6554698944091797
Epoch: 23, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6905670166015625
Epoch: 24, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6291606426239014
Epoch: 25, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.296 Vali Acc: 0.200 Test Loss: 1.296 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8473907
model size : 37.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5083365440368652
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6991314888000488
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6038947105407715
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6835999488830566
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.750352144241333
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7882251739501953
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6225504875183105
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.797391414642334
Epoch: 8, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.669818639755249
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6574490070343018
Epoch: 10, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7622158527374268
Epoch: 11, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6948244571685791
Epoch: 12, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7407536506652832
Epoch: 13, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8474981784820557
Epoch: 14, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6749534606933594
Epoch: 15, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.5952048301696777
Epoch: 16, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7865726947784424
Epoch: 17, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5785677433013916
Epoch: 18, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6648190021514893
Epoch: 19, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8866865634918213
Epoch: 20, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6005744934082031
Epoch: 21, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7841899394989014
Epoch: 22, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7854111194610596
Epoch: 23, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8689818382263184
Epoch: 24, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7392711639404297
Epoch: 25, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.347 Vali Acc: 0.333 Test Loss: 1.347 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8449587
model size : 37.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.457857370376587
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7179417610168457
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6812937259674072
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7902867794036865
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7945549488067627
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7601261138916016
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7488846778869629
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8431665897369385
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6991927623748779
Epoch: 9, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7971279621124268
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6614701747894287
Epoch: 11, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8974716663360596
Epoch: 12, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7226510047912598
Epoch: 13, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7547192573547363
Epoch: 14, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8425267
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5720605850219727
Epoch: 1, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7224948406219482
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6573960781097412
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6306791305541992
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7314879894256592
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6933078765869141
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6515259742736816
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.688852071762085
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7828431129455566
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.674720048904419
Epoch: 10, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6341869831085205
Epoch: 11, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.847325325012207
Epoch: 12, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7102372646331787
Epoch: 13, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8400947
model size : 37.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.454676628112793
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5904765129089355
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.641167402267456
Epoch: 3, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6429529190063477
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7773652076721191
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6905949115753174
Epoch: 6, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.7414631843566895
Epoch: 7, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7204251289367676
Epoch: 8, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6904950141906738
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7481615543365479
Epoch: 10, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6627392768859863
Epoch: 11, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9184844493865967
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6562607288360596
Epoch: 13, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5587654113769531
Epoch: 14, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6889030933380127
Epoch: 15, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6417922973632812
Epoch: 16, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8014259
model size : 35.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7102415561676025
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6811239719390869
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6690874099731445
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5854310989379883
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7121763229370117
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7412991523742676
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6824371814727783
Epoch: 7, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8650143146514893
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.652214765548706
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6724421977996826
Epoch: 10, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7394518852233887
Epoch: 11, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6625051498413086
Epoch: 12, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 7989939
model size : 35.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6265480518341064
Epoch: 1, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6611621379852295
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6860618591308594
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5767383575439453
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.6110382080078125
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.116 Vali Acc: 0.067 Test Loss: 1.116 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6199791431427002
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6478259563446045
Epoch: 7, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7989721298217773
Epoch: 8, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7687511444091797
Epoch: 9, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6436421871185303
Epoch: 10, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7686340808868408
Epoch: 11, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6873712539672852
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7838077545166016
Epoch: 13, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5986044406890869
Epoch: 14, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7965619
model size : 35.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2714614868164062
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6252214908599854
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5779228210449219
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.6697018146514893
Epoch: 4, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6530873775482178
Epoch: 5, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6091878414154053
Epoch: 6, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7440152168273926
Epoch: 7, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5672166347503662
Epoch: 8, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5693583488464355
Epoch: 9, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6547641754150391
Epoch: 10, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7011678218841553
Epoch: 11, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6689057350158691
Epoch: 12, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6613872051239014
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7941299
model size : 35.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.457218885421753
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6042711734771729
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5397050380706787
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6761667728424072
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7663083076477051
Epoch: 5, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6936814785003662
Epoch: 6, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7618453502655029
Epoch: 7, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.691033124923706
Epoch: 8, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7016246318817139
Epoch: 9, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6356608867645264
Epoch: 10, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4823496341705322
Epoch: 11, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.564664363861084
Epoch: 12, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.6932642459869385
Epoch: 13, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7496464252471924
Epoch: 14, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6928682327270508
Epoch: 15, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.528498649597168
Epoch: 16, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7286927700042725
Epoch: 17, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8111608028411865
Epoch: 18, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.134 Vali Acc: 0.133 Test Loss: 1.134 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6649560928344727
Epoch: 19, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6567811965942383
Epoch: 20, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5690996646881104
Epoch: 21, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5977733135223389
Epoch: 22, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3784499
model size : 17.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.60020112991333
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8605084419250488
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7003200054168701
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.8386821746826172
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8676290512084961
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8186230659484863
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7142415046691895
Epoch: 7, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7214829921722412
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7610361576080322
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8573477268218994
Epoch: 10, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6617162227630615
Epoch: 11, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8282501697540283
Epoch: 12, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7247636318206787
Epoch: 13, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3772339
model size : 16.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7600646018981934
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7521014213562012
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8032476902008057
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.7883303165435791
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.648613691329956
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7200865745544434
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7404158115386963
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7625367641448975
Epoch: 8, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.70729660987854
Epoch: 9, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7100265026092529
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8714840412139893
Epoch: 11, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.902695894241333
Epoch: 12, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.848322868347168
Epoch: 13, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3760179
model size : 16.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3653886318206787
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7105519771575928
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6807515621185303
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6310570240020752
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6558136940002441
Epoch: 5, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6522567272186279
Epoch: 6, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7206630706787109
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6106154918670654
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7371940612792969
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6509451866149902
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7025623321533203
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6840229034423828
Epoch: 12, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3748019
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.694739818572998
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6984388828277588
Epoch: 2, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6226062774658203
Epoch: 3, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7766318321228027
Epoch: 4, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.646256685256958
Epoch: 5, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8260152339935303
Epoch: 6, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6156525611877441
Epoch: 7, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6023807525634766
Epoch: 8, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6096572875976562
Epoch: 9, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6401195526123047
Epoch: 10, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7428944110870361
Epoch: 11, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7292342185974121
Epoch: 12, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7283501625061035
Epoch: 13, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.7815244197845459
Epoch: 14, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7127349376678467
Epoch: 15, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7423677444458008
Epoch: 16, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6583688259124756
Epoch: 17, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7145509719848633
Epoch: 18, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7189488410949707
Epoch: 19, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6398196220397949
Epoch: 20, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8199160099029541
Epoch: 21, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6433897018432617
Epoch: 22, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6504459381103516
Epoch: 23, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2863411
model size : 13.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0304629802703857
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6767308712005615
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8000917434692383
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8157453536987305
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7666168212890625
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8782529830932617
Epoch: 6, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7295958995819092
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9591033458709717
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7804427146911621
Epoch: 9, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7049212455749512
Epoch: 10, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7393810749053955
Epoch: 11, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2851251
model size : 13.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5134506225585938
Epoch: 1, Steps: 1 | Train Loss: 1.528 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6138954162597656
Epoch: 2, Steps: 1 | Train Loss: 1.389 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8102569580078125
Epoch: 3, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.7718961238861084
Epoch: 4, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7409906387329102
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7148423194885254
Epoch: 6, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8476543426513672
Epoch: 7, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1277544498443604
Epoch: 8, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9653096199035645
Epoch: 9, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9530637264251709
Epoch: 10, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.008568525314331
Epoch: 11, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6757450103759766
Epoch: 12, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7208023071289062
Epoch: 13, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8232631683349609
Epoch: 14, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7577662467956543
Epoch: 15, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2839091
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7637834548950195
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.927215576171875
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.83504319190979
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9235057830810547
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7843616008758545
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0041248798370361
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7494490146636963
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8334455490112305
Epoch: 8, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7736117839813232
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7558050155639648
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8601713180541992
Epoch: 11, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7466874122619629
Epoch: 12, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.6740036010742188
Epoch: 13, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7885370254516602
Epoch: 14, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8563225269317627
Epoch: 15, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.894890546798706
Epoch: 16, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8882837295532227
Epoch: 17, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9188442230224609
Epoch: 18, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8433115482330322
Epoch: 19, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7207880020141602
Epoch: 20, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7407009601593018
Epoch: 21, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6947312355041504
Epoch: 22, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2826931
model size : 13.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.803133249282837
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7935891151428223
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8437504768371582
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8096051216125488
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9855911731719971
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8543198108673096
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8261668682098389
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7489635944366455
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9169387817382812
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7921650409698486
Epoch: 10, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8287773132324219
Epoch: 11, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8035027980804443
Epoch: 12, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9765334129333496
Epoch: 13, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.879450798034668
Epoch: 14, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8455438613891602
Epoch: 15, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2402867
model size : 11.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3373501300811768
Epoch: 1, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1201016902923584
Epoch: 2, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.775531530380249
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.8893110752105713
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8991777896881104
Epoch: 5, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.113161563873291
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9426877498626709
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8022058010101318
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8269534111022949
Epoch: 9, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7629475593566895
Epoch: 10, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8626594543457031
Epoch: 11, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9045431613922119
Epoch: 12, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0632941722869873
Epoch: 13, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.8324718475341797
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.021745204925537
Epoch: 15, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8585739135742188
Epoch: 16, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8780350685119629
Epoch: 17, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8064365386962891
Epoch: 18, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7396838665008545
Epoch: 19, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8106577396392822
Epoch: 20, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9761683940887451
Epoch: 21, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.146939992904663
Epoch: 22, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0542631149291992
Epoch: 23, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2390707
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.150930881500244
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1171727180480957
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8340559005737305
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9922702312469482
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1173875331878662
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8227307796478271
Epoch: 6, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8112883567810059
Epoch: 7, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8955047130584717
Epoch: 8, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9636106491088867
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7815887928009033
Epoch: 10, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9743845462799072
Epoch: 11, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2378547
model size : 11.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.129385232925415
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7660200595855713
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0151000022888184
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.658806562423706
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8796916007995605
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7071127891540527
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7967839241027832
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.775489091873169
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.934283971786499
Epoch: 9, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.888514518737793
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.809579610824585
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9070148468017578
Epoch: 12, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.204 Vali Acc: 0.133 Test Loss: 1.204 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8330764770507812
Epoch: 13, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7527694702148438
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8073973655700684
Epoch: 15, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2366387
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7513749599456787
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7358901500701904
Epoch: 2, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7725710868835449
Epoch: 3, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8370499610900879
Epoch: 4, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0295090675354004
Epoch: 5, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9614014625549316
Epoch: 6, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7900702953338623
Epoch: 7, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7393057346343994
Epoch: 8, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9205076694488525
Epoch: 9, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7666473388671875
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7791070938110352
Epoch: 11, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8137097358703613
Epoch: 12, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7689433097839355
Epoch: 13, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9229192733764648
Epoch: 14, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1910412311553955
Epoch: 15, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0695796012878418
Epoch: 16, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.884885311126709
Epoch: 17, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8667266368865967
Epoch: 18, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8475167751312256
Epoch: 19, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9354043006896973
Epoch: 20, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7576799392700195
Epoch: 21, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0375111103057861
Epoch: 22, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2172595
model size : 10.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.594233989715576
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7823171615600586
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.9042069911956787
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.1661756038665771
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9996256828308105
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.079763650894165
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0053210258483887
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9494655132293701
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.125535011291504
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0678603649139404
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9215147495269775
Epoch: 11, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.943152904510498
Epoch: 12, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9036712646484375
Epoch: 13, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2160435
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1112000942230225
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.220 Vali Acc: 0.000 Test Loss: 1.220 Test Acc: 0.000
Validation loss decreased (inf --> 0.000012).  Saving model ...
Epoch: 2 cost time: 0.8568875789642334
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.219 Vali Acc: 0.000 Test Loss: 1.219 Test Acc: 0.000
Validation loss decreased (0.000012 --> 0.000012).  Saving model ...
Epoch: 3 cost time: 0.8569028377532959
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.219 Vali Acc: 0.000 Test Loss: 1.219 Test Acc: 0.000
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7671799659729004
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.221 Vali Acc: 0.067 Test Loss: 1.221 Test Acc: 0.067
Validation loss decreased (0.000012 --> -0.066654).  Saving model ...
Epoch: 5 cost time: 0.6606249809265137
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.222 Vali Acc: 0.000 Test Loss: 1.222 Test Acc: 0.000
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8371312618255615
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.223 Vali Acc: 0.000 Test Loss: 1.223 Test Acc: 0.000
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8284854888916016
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.225 Vali Acc: 0.067 Test Loss: 1.225 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9104478359222412
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.225 Vali Acc: 0.067 Test Loss: 1.225 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9995906352996826
Epoch: 9, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.224 Vali Acc: 0.067 Test Loss: 1.224 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7772345542907715
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.225 Vali Acc: 0.000 Test Loss: 1.225 Test Acc: 0.000
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8561644554138184
Epoch: 11, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.226 Vali Acc: 0.000 Test Loss: 1.226 Test Acc: 0.000
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1107449531555176
Epoch: 12, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.228 Vali Acc: 0.000 Test Loss: 1.228 Test Acc: 0.000
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8548181056976318
Epoch: 13, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.230 Vali Acc: 0.000 Test Loss: 1.230 Test Acc: 0.000
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8965597152709961
Epoch: 14, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.233 Vali Acc: 0.133 Test Loss: 1.233 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 15 cost time: 0.958505392074585
Epoch: 15, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.238 Vali Acc: 0.000 Test Loss: 1.238 Test Acc: 0.000
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.778064489364624
Epoch: 16, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.243 Vali Acc: 0.067 Test Loss: 1.243 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7639744281768799
Epoch: 17, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.248 Vali Acc: 0.067 Test Loss: 1.248 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8831033706665039
Epoch: 18, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 19 cost time: 0.7265019416809082
Epoch: 19, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.258 Vali Acc: 0.133 Test Loss: 1.258 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7438242435455322
Epoch: 20, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.260 Vali Acc: 0.133 Test Loss: 1.260 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7975904941558838
Epoch: 21, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.260 Vali Acc: 0.000 Test Loss: 1.260 Test Acc: 0.000
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8206970691680908
Epoch: 22, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.262 Vali Acc: 0.000 Test Loss: 1.262 Test Acc: 0.000
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7262575626373291
Epoch: 23, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.268 Vali Acc: 0.000 Test Loss: 1.268 Test Acc: 0.000
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0063807964324951
Epoch: 24, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.276 Vali Acc: 0.000 Test Loss: 1.276 Test Acc: 0.000
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5834832191467285
Epoch: 25, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.283 Vali Acc: 0.000 Test Loss: 1.283 Test Acc: 0.000
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7393240928649902
Epoch: 26, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.290 Vali Acc: 0.000 Test Loss: 1.290 Test Acc: 0.000
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7315349578857422
Epoch: 27, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.308 Vali Acc: 0.133 Test Loss: 1.308 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7413239479064941
Epoch: 28, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.325 Vali Acc: 0.133 Test Loss: 1.325 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 2148275
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1576216220855713
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0888910293579102
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9462614059448242
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.066117525100708
Epoch: 4, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8109869956970215
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.800736665725708
Epoch: 6, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.9114699363708496
Epoch: 7, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9895973205566406
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8183488845825195
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1766655445098877
Epoch: 10, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.078 Vali Acc: 0.200 Test Loss: 1.078 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8993792533874512
Epoch: 11, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.002922534942627
Epoch: 12, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9378433227539062
Epoch: 13, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1573541164398193
Epoch: 14, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.769667387008667
Epoch: 15, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7500052452087402
Epoch: 16, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2136115
model size : 10.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.188176155090332
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8789682388305664
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6571087837219238
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9043638706207275
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7852978706359863
Epoch: 5, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8273205757141113
Epoch: 6, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9597291946411133
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.873049259185791
Epoch: 8, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8614716529846191
Epoch: 9, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8183274269104004
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8632123470306396
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8128890991210938
Epoch: 12, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8457231521606445
Epoch: 13, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8510615825653076
Epoch: 14, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1437107
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5987794399261475
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7837281227111816
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.823880672454834
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.645357608795166
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8502218723297119
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9287023544311523
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8468897342681885
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.909055233001709
Epoch: 8, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.820472240447998
Epoch: 9, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6693377494812012
Epoch: 10, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7803616523742676
Epoch: 11, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7671334743499756
Epoch: 12, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9366941452026367
Epoch: 13, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9629671573638916
Epoch: 14, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7253649234771729
Epoch: 15, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1431027
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.90995454788208
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.652245283126831
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7534430027008057
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7220301628112793
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8592393398284912
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7922484874725342
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9048130512237549
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8081939220428467
Epoch: 8, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7582199573516846
Epoch: 9, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.694756031036377
Epoch: 10, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8933565616607666
Epoch: 11, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.68937087059021
Epoch: 12, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.142165184020996
Epoch: 13, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7972614765167236
Epoch: 14, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7781758308410645
Epoch: 15, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.7699785232543945
Epoch: 16, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7348752021789551
Epoch: 17, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9670865535736084
Epoch: 18, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6571204662322998
Epoch: 19, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0063707828521729
Epoch: 20, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.782412052154541
Epoch: 21, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7555663585662842
Epoch: 22, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9543728828430176
Epoch: 23, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9437284469604492
Epoch: 24, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6897287368774414
Epoch: 25, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1424947
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7142157554626465
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7865869998931885
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7299695014953613
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7773292064666748
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1743884086608887
Epoch: 5, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9732820987701416
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0214414596557617
Epoch: 7, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8842573165893555
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1890008449554443
Epoch: 9, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.701066255569458
Epoch: 10, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8007087707519531
Epoch: 11, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7730562686920166
Epoch: 12, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1418867
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8760242462158203
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8884563446044922
Epoch: 2, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9076464176177979
Epoch: 3, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7903420925140381
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9223418235778809
Epoch: 5, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7263402938842773
Epoch: 6, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7241880893707275
Epoch: 7, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.135 Vali Acc: 0.133 Test Loss: 1.135 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8010680675506592
Epoch: 8, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.132 Vali Acc: 0.067 Test Loss: 1.132 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7360763549804688
Epoch: 9, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6286435127258301
Epoch: 10, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8736171722412109
Epoch: 11, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9742445945739746
Epoch: 12, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7773146629333496
Epoch: 13, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7952070236206055
Epoch: 14, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8055739402770996
Epoch: 15, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8503398895263672
Epoch: 16, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6201217174530029
Epoch: 17, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6517162322998047
Epoch: 18, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.694042444229126
Epoch: 19, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 974771
model size : 5.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.353963851928711
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5769767761230469
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8138935565948486
Epoch: 3, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7163383960723877
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.681718111038208
Epoch: 5, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7797188758850098
Epoch: 6, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9736745357513428
Epoch: 7, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0043437480926514
Epoch: 8, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8066561222076416
Epoch: 9, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.006371259689331
Epoch: 10, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8493964672088623
Epoch: 11, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8534581661224365
Epoch: 12, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9111020565032959
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9954066276550293
Epoch: 14, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8563547134399414
Epoch: 15, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.8037161827087402
Epoch: 16, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6960253715515137
Epoch: 17, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.7688968181610107
Epoch: 18, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6406111717224121
Epoch: 19, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8005719184875488
Epoch: 20, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.754711389541626
Epoch: 21, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7902824878692627
Epoch: 22, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7020516395568848
Epoch: 23, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.027754545211792
Epoch: 24, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8357372283935547
Epoch: 25, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8053069114685059
Epoch: 26, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7002255916595459
Epoch: 27, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 968691
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.941293954849243
Epoch: 1, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.890047550201416
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6985642910003662
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6379737854003906
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6836733818054199
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8841261863708496
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6192054748535156
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7942929267883301
Epoch: 8, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7948789596557617
Epoch: 9, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7445895671844482
Epoch: 10, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7073397636413574
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8493843078613281
Epoch: 12, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.846858024597168
Epoch: 13, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0269463062286377
Epoch: 14, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 962611
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.812931776046753
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9418199062347412
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8905448913574219
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8036916255950928
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.911867618560791
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8585295677185059
Epoch: 6, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8176870346069336
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7488071918487549
Epoch: 8, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0719199180603027
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1884822845458984
Epoch: 10, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0590829849243164
Epoch: 11, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0267863273620605
Epoch: 12, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0944292545318604
Epoch: 13, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8562324047088623
Epoch: 14, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7697727680206299
Epoch: 15, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 956531
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.838797092437744
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6740429401397705
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7424194812774658
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9640007019042969
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.119 Vali Acc: 0.133 Test Loss: 1.119 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2541537284851074
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8118102550506592
Epoch: 6, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6961796283721924
Epoch: 7, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.9148635864257812
Epoch: 8, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7207226753234863
Epoch: 9, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7614200115203857
Epoch: 10, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8795566558837891
Epoch: 11, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8563117980957031
Epoch: 12, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8815209865570068
Epoch: 13, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7436556816101074
Epoch: 14, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9072537422180176
Epoch: 15, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7039041519165039
Epoch: 16, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7637085914611816
Epoch: 17, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.126 Vali Acc: 0.133 Test Loss: 1.126 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 743603
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6458303928375244
Epoch: 1, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.750847339630127
Epoch: 2, Steps: 1 | Train Loss: 1.366 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.828524112701416
Epoch: 3, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.7674350738525391
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7167994976043701
Epoch: 5, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0782551765441895
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9480011463165283
Epoch: 7, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8968074321746826
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8431158065795898
Epoch: 9, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0329127311706543
Epoch: 10, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9389758110046387
Epoch: 11, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8699843883514404
Epoch: 12, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0062758922576904
Epoch: 13, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8727943897247314
Epoch: 14, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 737523
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.270596504211426
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0375099182128906
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1516830921173096
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1661779880523682
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9958357810974121
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0712356567382812
Epoch: 6, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.015272855758667
Epoch: 7, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.077256441116333
Epoch: 8, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0110080242156982
Epoch: 9, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.005704641342163
Epoch: 10, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0692765712738037
Epoch: 11, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7706763744354248
Epoch: 12, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0942575931549072
Epoch: 13, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1844213008880615
Epoch: 14, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 731443
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4669506549835205
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6215317249298096
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7174532413482666
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6791203022003174
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8103218078613281
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9388878345489502
Epoch: 6, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9166741371154785
Epoch: 7, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6731252670288086
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8375167846679688
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7797107696533203
Epoch: 10, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6550052165985107
Epoch: 11, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 725363
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5298967361450195
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8243639469146729
Epoch: 2, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7901351451873779
Epoch: 3, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8608310222625732
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.89011549949646
Epoch: 5, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9771883487701416
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8764092922210693
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7450418472290039
Epoch: 8, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8817214965820312
Epoch: 9, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8345732688903809
Epoch: 10, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8447799682617188
Epoch: 11, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8062655925750732
Epoch: 12, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.8662874698638916
Epoch: 13, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8667252063751221
Epoch: 14, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.7431895732879639
Epoch: 15, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.7767460346221924
Epoch: 16, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7044153213500977
Epoch: 17, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8511347770690918
Epoch: 18, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.752739429473877
Epoch: 19, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5859746932983398
Epoch: 20, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6956918239593506
Epoch: 21, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9151735305786133
Epoch: 22, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8298928737640381
Epoch: 23, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7779614925384521
Epoch: 24, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7571127414703369
Epoch: 25, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 628019
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.754488468170166
Epoch: 1, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6192965507507324
Epoch: 2, Steps: 1 | Train Loss: 1.309 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.693474531173706
Epoch: 3, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7504706382751465
Epoch: 4, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7935123443603516
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7460038661956787
Epoch: 6, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7467236518859863
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7114658355712891
Epoch: 8, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9811484813690186
Epoch: 9, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6276531219482422
Epoch: 10, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8171858787536621
Epoch: 11, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6658995151519775
Epoch: 12, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.833289384841919
Epoch: 13, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.658801794052124
Epoch: 14, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.896726131439209
Epoch: 15, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 621939
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6891467571258545
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7096884250640869
Epoch: 2, Steps: 1 | Train Loss: 1.306 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9488480091094971
Epoch: 3, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7829596996307373
Epoch: 4, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7630784511566162
Epoch: 5, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8010585308074951
Epoch: 6, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8323655128479004
Epoch: 7, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9264912605285645
Epoch: 8, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8255772590637207
Epoch: 9, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9482007026672363
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8236618041992188
Epoch: 11, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8814525604248047
Epoch: 12, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8420400619506836
Epoch: 13, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9986691474914551
Epoch: 14, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0577452182769775
Epoch: 15, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8433260917663574
Epoch: 16, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8995361328125
Epoch: 17, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8372421264648438
Epoch: 18, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7616620063781738
Epoch: 19, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.019651174545288
Epoch: 20, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0377414226531982
Epoch: 21, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.066615343093872
Epoch: 22, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9403378963470459
Epoch: 23, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8101704120635986
Epoch: 24, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0846247673034668
Epoch: 25, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7227494716644287
Epoch: 26, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 615859
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9724507331848145
Epoch: 1, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6642541885375977
Epoch: 2, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8628466129302979
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.076718807220459
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6504776477813721
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8023765087127686
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.675729513168335
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7821438312530518
Epoch: 8, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7891302108764648
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.018594741821289
Epoch: 10, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8904869556427002
Epoch: 11, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8780884742736816
Epoch: 12, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.125727891921997
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7346551418304443
Epoch: 14, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7349989414215088
Epoch: 15, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 0.7847597599029541
Epoch: 16, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9841339588165283
Epoch: 17, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8251733779907227
Epoch: 18, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6713428497314453
Epoch: 19, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8219449520111084
Epoch: 20, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7702388763427734
Epoch: 21, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7443740367889404
Epoch: 22, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8518810272216797
Epoch: 23, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8620061874389648
Epoch: 24, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7630252838134766
Epoch: 25, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 609779
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.738199234008789
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.925616979598999
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7728662490844727
Epoch: 3, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.004028081893921
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9324750900268555
Epoch: 5, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8193747997283936
Epoch: 6, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.113 Vali Acc: 0.133 Test Loss: 1.113 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8257198333740234
Epoch: 7, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.906057596206665
Epoch: 8, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8684766292572021
Epoch: 9, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8459334373474121
Epoch: 10, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.9280185699462891
Epoch: 11, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9541950225830078
Epoch: 12, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8382689952850342
Epoch: 13, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.814558744430542
Epoch: 14, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9819660186767578
Epoch: 15, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8677980899810791
Epoch: 16, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9256658554077148
Epoch: 17, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8643834590911865
Epoch: 18, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.872596025466919
Epoch: 19, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8255975246429443
Epoch: 20, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 607475
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4788243770599365
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7616314888000488
Epoch: 2, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7165436744689941
Epoch: 3, Steps: 1 | Train Loss: 1.368 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8787233829498291
Epoch: 4, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.0942459106445312
Epoch: 5, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.8417880535125732
Epoch: 6, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 1.0098180770874023
Epoch: 7, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.111328363418579
Epoch: 8, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8948225975036621
Epoch: 9, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.7120897769927979
Epoch: 10, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8003804683685303
Epoch: 11, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2413523197174072
Epoch: 12, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1390104293823242
Epoch: 13, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9763569831848145
Epoch: 14, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.208768367767334
Epoch: 15, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2774896621704102
Epoch: 16, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8865261077880859
Epoch: 17, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8844268321990967
Epoch: 18, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.279224157333374
Epoch: 19, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 604435
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.965235948562622
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7867541313171387
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.161451816558838
Epoch: 3, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8789329528808594
Epoch: 4, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8421742916107178
Epoch: 5, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7659947872161865
Epoch: 6, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7975940704345703
Epoch: 7, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2544362545013428
Epoch: 8, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8614356517791748
Epoch: 9, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7990109920501709
Epoch: 10, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8040621280670166
Epoch: 11, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9342505931854248
Epoch: 12, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6842696666717529
Epoch: 13, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7721166610717773
Epoch: 14, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 601395
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.562286138534546
Epoch: 1, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6978504657745361
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.063873291015625
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0123133659362793
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9180915355682373
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8384606838226318
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.110985517501831
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.695556640625
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7275266647338867
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7408080101013184
Epoch: 10, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8505873680114746
Epoch: 11, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7379834651947021
Epoch: 12, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 598355
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.004300117492676
Epoch: 1, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6771986484527588
Epoch: 2, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6724298000335693
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8687148094177246
Epoch: 4, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7872538566589355
Epoch: 5, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.333322 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.7190656661987305
Epoch: 6, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.079 Vali Acc: 0.667 Test Loss: 1.079 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.8965351581573486
Epoch: 7, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7935779094696045
Epoch: 8, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9477474689483643
Epoch: 9, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8244824409484863
Epoch: 10, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7831263542175293
Epoch: 11, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8966548442840576
Epoch: 12, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7530806064605713
Epoch: 13, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6989374160766602
Epoch: 14, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8465478420257568
Epoch: 15, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7852034568786621
Epoch: 16, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 374515
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.709970235824585
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9919672012329102
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.945385217666626
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0367279052734375
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.077 Vali Acc: 0.667 Test Loss: 1.077 Test Acc: 0.667
Validation loss decreased (-0.466656 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.8094339370727539
Epoch: 5, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4760544300079346
Epoch: 6, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8172192573547363
Epoch: 7, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9926373958587646
Epoch: 8, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7696816921234131
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6806066036224365
Epoch: 10, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9955525398254395
Epoch: 11, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1305110454559326
Epoch: 12, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.92038893699646
Epoch: 13, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0111830234527588
Epoch: 14, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 371475
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.795020341873169
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7470834255218506
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7292780876159668
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7326099872589111
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.920987606048584
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9761290550231934
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.116974115371704
Epoch: 7, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8533751964569092
Epoch: 8, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9008469581604004
Epoch: 9, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.806419849395752
Epoch: 10, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6883683204650879
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9037034511566162
Epoch: 12, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7827043533325195
Epoch: 13, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0811872482299805
Epoch: 14, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0337464809417725
Epoch: 15, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9540822505950928
Epoch: 16, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8981020450592041
Epoch: 17, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8860843181610107
Epoch: 18, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 368435
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.685584545135498
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7250564098358154
Epoch: 2, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8527607917785645
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.9037201404571533
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0056533813476562
Epoch: 5, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0540788173675537
Epoch: 6, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9158239364624023
Epoch: 7, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8550577163696289
Epoch: 8, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6914451122283936
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7163732051849365
Epoch: 10, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7490577697753906
Epoch: 11, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8474984169006348
Epoch: 12, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0304548740386963
Epoch: 13, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 365395
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.5387563705444336
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.888704776763916
Epoch: 2, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6635138988494873
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9865617752075195
Epoch: 4, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9199116230010986
Epoch: 5, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0322356224060059
Epoch: 6, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9853947162628174
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8531086444854736
Epoch: 8, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.941666841506958
Epoch: 9, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8883750438690186
Epoch: 10, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7621290683746338
Epoch: 11, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.993107795715332
Epoch: 12, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.7285351753234863
Epoch: 13, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.806948184967041
Epoch: 14, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8032901287078857
Epoch: 15, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8576445579528809
Epoch: 16, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1855435371398926
Epoch: 17, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1858153343200684
Epoch: 18, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6384625434875488
Epoch: 19, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7836863994598389
Epoch: 20, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7978532314300537
Epoch: 21, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7129065990447998
Epoch: 22, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.815840482711792
Epoch: 23, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 258035
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.485658884048462
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8796155452728271
Epoch: 2, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9264528751373291
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7484531402587891
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8265419006347656
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7800087928771973
Epoch: 6, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.022191047668457
Epoch: 7, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9952385425567627
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1715826988220215
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9339215755462646
Epoch: 10, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9136290550231934
Epoch: 11, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.095808506011963
Epoch: 12, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7349839210510254
Epoch: 13, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7892282009124756
Epoch: 14, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1533403396606445
Epoch: 15, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 254995
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.644333839416504
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8714094161987305
Epoch: 2, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.869518518447876
Epoch: 3, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.920896053314209
Epoch: 4, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8176279067993164
Epoch: 5, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9395291805267334
Epoch: 6, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7082273960113525
Epoch: 7, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7760636806488037
Epoch: 8, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6096367835998535
Epoch: 9, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.779632568359375
Epoch: 10, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7225546836853027
Epoch: 11, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.8641674518585205
Epoch: 12, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8667867183685303
Epoch: 13, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7675888538360596
Epoch: 14, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9387993812561035
Epoch: 15, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9058632850646973
Epoch: 16, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0350801944732666
Epoch: 17, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7949364185333252
Epoch: 18, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.8619656562805176
Epoch: 19, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.7371656894683838
Epoch: 20, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7516205310821533
Epoch: 21, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8320424556732178
Epoch: 22, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7432610988616943
Epoch: 23, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7604799270629883
Epoch: 24, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7196567058563232
Epoch: 25, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.7185797691345215
Epoch: 26, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8331375122070312
Epoch: 27, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7707536220550537
Epoch: 28, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.775066614151001
Epoch: 29, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8847336769104004
Epoch: 30, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0853271484375
Epoch: 31, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8017668724060059
Epoch: 32, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6984858512878418
Epoch: 33, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9553635120391846
Epoch: 34, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6503312587738037
Epoch: 35, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 251955
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.077676773071289
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7344448566436768
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7733092308044434
Epoch: 3, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8370251655578613
Epoch: 4, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7527992725372314
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.885890007019043
Epoch: 6, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7532908916473389
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0496819019317627
Epoch: 8, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9632406234741211
Epoch: 9, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8394312858581543
Epoch: 10, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8225407600402832
Epoch: 11, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8898048400878906
Epoch: 12, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0028514862060547
Epoch: 13, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9018101692199707
Epoch: 14, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.133901596069336
Epoch: 15, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6975266933441162
Epoch: 16, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 248915
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7929556369781494
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7932567596435547
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4829022884368896
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9976732730865479
Epoch: 4, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.064608097076416
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0169827938079834
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.0230872631072998
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8561992645263672
Epoch: 8, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1828694343566895
Epoch: 9, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7671823501586914
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9789819717407227
Epoch: 11, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8912570476531982
Epoch: 12, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9338340759277344
Epoch: 13, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.9059863090515137
Epoch: 14, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.882399320602417
Epoch: 15, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8184165954589844
Epoch: 16, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.970914363861084
Epoch: 17, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.221522569656372
Epoch: 18, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7932062149047852
Epoch: 19, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7987766265869141
Epoch: 20, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8879761695861816
Epoch: 21, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8733758926391602
Epoch: 22, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.834991455078125
Epoch: 23, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9936363697052002
Epoch: 24, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8927743434906006
Epoch: 25, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 199795
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1356825828552246
Epoch: 1, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.9061746597290039
Epoch: 2, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1048851013183594
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9506678581237793
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.7643749713897705
Epoch: 5, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.803502082824707
Epoch: 6, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9637346267700195
Epoch: 7, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9947783946990967
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7808008193969727
Epoch: 9, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7196793556213379
Epoch: 10, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8916316032409668
Epoch: 11, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9008851051330566
Epoch: 12, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8445417881011963
Epoch: 13, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9860570430755615
Epoch: 14, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.8445239067077637
Epoch: 15, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0446803569793701
Epoch: 16, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7886745929718018
Epoch: 17, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0181145668029785
Epoch: 18, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6931459903717041
Epoch: 19, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3026893138885498
Epoch: 20, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0452849864959717
Epoch: 21, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0335636138916016
Epoch: 22, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.888498067855835
Epoch: 23, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.012880802154541
Epoch: 24, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 196755
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.143490791320801
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8252229690551758
Epoch: 2, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1054060459136963
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9638516902923584
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9999961853027344
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.0400443077087402
Epoch: 6, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8301239013671875
Epoch: 7, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8990979194641113
Epoch: 8, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8658976554870605
Epoch: 9, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9340376853942871
Epoch: 10, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0655322074890137
Epoch: 11, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.897946834564209
Epoch: 12, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8716340065002441
Epoch: 13, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9750208854675293
Epoch: 14, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9631388187408447
Epoch: 15, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2672088146209717
Epoch: 16, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9777646064758301
Epoch: 17, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8193995952606201
Epoch: 18, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9796693325042725
Epoch: 19, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1050090789794922
Epoch: 20, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9008176326751709
Epoch: 21, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 193715
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.336996078491211
Epoch: 1, Steps: 1 | Train Loss: 1.329 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.9504251480102539
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.789597749710083
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.0890533924102783
Epoch: 4, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.879086971282959
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.878333568572998
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1237592697143555
Epoch: 7, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9860877990722656
Epoch: 8, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8110432624816895
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1646337509155273
Epoch: 10, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.820542573928833
Epoch: 11, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.119981288909912
Epoch: 12, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7935218811035156
Epoch: 13, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0271029472351074
Epoch: 14, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.8770651817321777
Epoch: 15, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9663646221160889
Epoch: 16, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0262641906738281
Epoch: 17, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0708837509155273
Epoch: 18, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9559266567230225
Epoch: 19, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9870600700378418
Epoch: 20, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9815068244934082
Epoch: 21, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7187211513519287
Epoch: 22, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8029534816741943
Epoch: 23, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.075559139251709
Epoch: 24, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 190675
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9222681522369385
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.785123348236084
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8723628520965576
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8603136539459229
Epoch: 4, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9338533878326416
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7180962562561035
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.816176176071167
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.099 Vali Acc: 0.133 Test Loss: 1.099 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8010540008544922
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8108134269714355
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9434928894042969
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6686229705810547
Epoch: 11, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7070581912994385
Epoch: 12, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7507984638214111
Epoch: 13, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8050622940063477
Epoch: 14, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7776186466217041
Epoch: 15, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9179680347442627
Epoch: 16, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8071463
model size : 35.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.5984206199645996
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8180034160614014
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.091 Vali Acc: 0.133 Test Loss: 1.091 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8804914951324463
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8617219924926758
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2008132934570312
Epoch: 5, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7707798480987549
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.094 Vali Acc: 0.133 Test Loss: 1.094 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.05867338180542
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0827388763427734
Epoch: 8, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.988457441329956
Epoch: 9, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7449429035186768
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9510819911956787
Epoch: 11, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8050727
model size : 35.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6116180419921875
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9012877941131592
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6668565273284912
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6559016704559326
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6368179321289062
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8199124336242676
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7636792659759521
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.589367151260376
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6029098033905029
Epoch: 9, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6495585441589355
Epoch: 10, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.730065107345581
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5618717670440674
Epoch: 12, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.609196662902832
Epoch: 13, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6833882331848145
Epoch: 14, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6097414493560791
Epoch: 15, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8029991
model size : 35.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.439164400100708
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7568206787109375
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0291078090667725
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.083284616470337
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9177966117858887
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0196809768676758
Epoch: 6, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8091912269592285
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9280080795288086
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7579061985015869
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1007874011993408
Epoch: 10, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8317337036132812
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 8009255
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0218887329101562
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8270587921142578
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.199989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8384342193603516
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8235578536987305
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8653194904327393
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0684263706207275
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0545744895935059
Epoch: 7, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8557877540588379
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8185579776763916
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.794724702835083
Epoch: 10, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9315886497497559
Epoch: 11, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8137764930725098
Epoch: 12, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6758183
model size : 30.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.732760190963745
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6824727058410645
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.938098669052124
Epoch: 3, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8615641593933105
Epoch: 4, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6672422885894775
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9624149799346924
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7702460289001465
Epoch: 7, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7932858467102051
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8689370155334473
Epoch: 9, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2971043586730957
Epoch: 10, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8000648021697998
Epoch: 11, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8040227890014648
Epoch: 12, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.5868563652038574
Epoch: 13, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7484076023101807
Epoch: 14, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7010204792022705
Epoch: 15, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8192160129547119
Epoch: 16, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6851193904876709
Epoch: 17, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.739570140838623
Epoch: 18, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9984700679779053
Epoch: 19, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8255715370178223
Epoch: 20, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.251 Vali Acc: 0.533 Test Loss: 1.251 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 21 cost time: 0.806236743927002
Epoch: 21, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7287476062774658
Epoch: 22, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7401080131530762
Epoch: 23, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9182946681976318
Epoch: 24, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7050838470458984
Epoch: 25, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6061403751373291
Epoch: 26, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.385 Vali Acc: 0.333 Test Loss: 1.385 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7402515411376953
Epoch: 27, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.379 Vali Acc: 0.333 Test Loss: 1.379 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.95438551902771
Epoch: 28, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.386 Vali Acc: 0.267 Test Loss: 1.386 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.665745735168457
Epoch: 29, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.411 Vali Acc: 0.267 Test Loss: 1.411 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6258177757263184
Epoch: 30, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.440 Vali Acc: 0.267 Test Loss: 1.440 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6737447
model size : 30.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.219964027404785
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.869375467300415
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7374663352966309
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9585409164428711
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7596487998962402
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.7259731292724609
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9493262767791748
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8175089359283447
Epoch: 8, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8648505210876465
Epoch: 9, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7718851566314697
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7120916843414307
Epoch: 11, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7571542263031006
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.814826250076294
Epoch: 13, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8177030086517334
Epoch: 14, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8195061683654785
Epoch: 15, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6716711
model size : 30.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.040100336074829
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9172086715698242
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8547189235687256
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.820866584777832
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9068408012390137
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9431023597717285
Epoch: 6, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8279576301574707
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6889166831970215
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0486514568328857
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.059264898300171
Epoch: 10, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7695248126983643
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8889296054840088
Epoch: 12, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8235893249511719
Epoch: 13, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9281511306762695
Epoch: 14, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7472474575042725
Epoch: 15, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.171006441116333
Epoch: 16, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0510003566741943
Epoch: 17, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6695975
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9890236854553223
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0421113967895508
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8824138641357422
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8138582706451416
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.649003267288208
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8110561370849609
Epoch: 6, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.067216396331787
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7414026260375977
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3808376789093018
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9592092037200928
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.057936429977417
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6101543
model size : 28.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9083406925201416
Epoch: 1, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7289724349975586
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.9706273078918457
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8918852806091309
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9795088768005371
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9430017471313477
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0009124279022217
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9632046222686768
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0589642524719238
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8285174369812012
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8134779930114746
Epoch: 11, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.80135178565979
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6080807
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2225546836853027
Epoch: 1, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7645058631896973
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8274385929107666
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9098465442657471
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.031275749206543
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.878209114074707
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9352705478668213
Epoch: 7, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0196876525878906
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.013042688369751
Epoch: 9, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2267425060272217
Epoch: 10, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8746185302734375
Epoch: 11, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9208166599273682
Epoch: 12, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9440319538116455
Epoch: 13, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9015889167785645
Epoch: 14, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9434754848480225
Epoch: 15, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6847798824310303
Epoch: 16, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8605654239654541
Epoch: 17, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2882270812988281
Epoch: 18, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9846031665802002
Epoch: 19, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1004056930541992
Epoch: 20, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9930679798126221
Epoch: 21, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6060071
model size : 28.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7028756141662598
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7936229705810547
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8696231842041016
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.926966667175293
Epoch: 4, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7439191341400146
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.694786548614502
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9538166522979736
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8199024200439453
Epoch: 8, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.156 Vali Acc: 0.067 Test Loss: 1.156 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7238185405731201
Epoch: 9, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7836601734161377
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0890140533447266
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8434710502624512
Epoch: 12, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6039335
model size : 28.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.978353977203369
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7844903469085693
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9297952651977539
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9085118770599365
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9540648460388184
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7606480121612549
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1401584148406982
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2280163764953613
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8549110889434814
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.896190881729126
Epoch: 10, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9397597312927246
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9828901290893555
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.841099739074707
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5773223
model size : 27.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.865009307861328
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9403307437896729
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9541850090026855
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8142154216766357
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0869882106781006
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0471069812774658
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7212479114532471
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9059045314788818
Epoch: 8, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0129523277282715
Epoch: 9, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.908710241317749
Epoch: 10, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2171902656555176
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5752487
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7660372257232666
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7130568027496338
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7153611183166504
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8025350570678711
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7677741050720215
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7484962940216064
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.76029372215271
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8882796764373779
Epoch: 8, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7828018665313721
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.816199541091919
Epoch: 10, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7175257205963135
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.010035753250122
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9449489116668701
Epoch: 13, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5731751
model size : 26.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8466241359710693
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8021035194396973
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
Validation loss decreased (-0.466655 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.8426408767700195
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8940780162811279
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7413902282714844
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9879684448242188
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9355268478393555
Epoch: 7, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8842756748199463
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8982851505279541
Epoch: 9, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.856896162033081
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.940241813659668
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8271133899688721
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5711015
model size : 26.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5005123615264893
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7743434906005859
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6951792240142822
Epoch: 3, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7445390224456787
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8836209774017334
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8080735206604004
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8183341026306152
Epoch: 7, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7917284965515137
Epoch: 8, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7925944328308105
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8175168037414551
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7111854553222656
Epoch: 11, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2727591
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2528135776519775
Epoch: 1, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7612431049346924
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7727100849151611
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1141772270202637
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9428114891052246
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2323265075683594
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9109230041503906
Epoch: 7, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9626269340515137
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8744134902954102
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8667521476745605
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3211901187896729
Epoch: 11, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.91660475730896
Epoch: 12, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2717223
model size : 12.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.889289855957031
Epoch: 1, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.5218725204467773
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3926944732666016
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 2.222588062286377
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 2.1554548740386963
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0681297779083252
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7405965328216553
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7998247146606445
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.71413254737854
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7955160140991211
Epoch: 10, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1269400119781494
Epoch: 11, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6902799606323242
Epoch: 12, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8676433563232422
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7144460678100586
Epoch: 14, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2706855
model size : 12.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5488693714141846
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0098626613616943
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8841452598571777
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8501338958740234
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7715969085693359
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.701880693435669
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.762671947479248
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0255577564239502
Epoch: 8, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8107376098632812
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9166319370269775
Epoch: 10, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8333263397216797
Epoch: 11, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2696487
model size : 12.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.979105234146118
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9009902477264404
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7972185611724854
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7154784202575684
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.805964469909668
Epoch: 5, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7908878326416016
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6315574645996094
Epoch: 7, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8436241149902344
Epoch: 8, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8123910427093506
Epoch: 9, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8380892276763916
Epoch: 10, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8976032733917236
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8992798328399658
Epoch: 12, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2069671
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8575849533081055
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0560047626495361
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9094505310058594
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.145611047744751
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8983404636383057
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9205830097198486
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0228235721588135
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.028045892715454
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7607262134552002
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8827147483825684
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7601463794708252
Epoch: 11, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7261683940887451
Epoch: 12, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.174 Vali Acc: 0.067 Test Loss: 1.174 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7719295024871826
Epoch: 13, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8283588886260986
Epoch: 14, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9526424407958984
Epoch: 15, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.181 Vali Acc: 0.133 Test Loss: 1.181 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.060002088546753
Epoch: 16, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.184 Vali Acc: 0.067 Test Loss: 1.184 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8758273124694824
Epoch: 17, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2059303
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1457250118255615
Epoch: 1, Steps: 1 | Train Loss: 1.367 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7917964458465576
Epoch: 2, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8967790603637695
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7740974426269531
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9760055541992188
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.784123420715332
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0512840747833252
Epoch: 7, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7604975700378418
Epoch: 8, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1843056678771973
Epoch: 9, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7813034057617188
Epoch: 10, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.822838544845581
Epoch: 11, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7085433006286621
Epoch: 12, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.064206600189209
Epoch: 13, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6148700714111328
Epoch: 14, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8540794849395752
Epoch: 15, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2048935
model size : 10.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.882477045059204
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7095241546630859
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8549420833587646
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9259014129638672
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7834205627441406
Epoch: 5, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8685781955718994
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1365365982055664
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8402917385101318
Epoch: 8, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0304851531982422
Epoch: 9, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9344265460968018
Epoch: 10, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.976250171661377
Epoch: 11, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0014123916625977
Epoch: 12, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7896826267242432
Epoch: 13, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2038567
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8494081497192383
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.8289799690246582
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7425107955932617
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.0117807388305664
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8020946979522705
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.689145565032959
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7719662189483643
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8663568496704102
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.7414417266845703
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6644461154937744
Epoch: 10, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8400647640228271
Epoch: 11, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9374854564666748
Epoch: 12, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7949469089508057
Epoch: 13, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8382284641265869
Epoch: 14, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8212103843688965
Epoch: 15, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7856037616729736
Epoch: 16, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9044725894927979
Epoch: 17, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8632471561431885
Epoch: 18, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1740711
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.899263858795166
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9382543563842773
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.644817590713501
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.797191858291626
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0406951904296875
Epoch: 5, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8200607299804688
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.962712287902832
Epoch: 7, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.065617561340332
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.763343334197998
Epoch: 9, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7566447257995605
Epoch: 10, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.949901819229126
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7762572765350342
Epoch: 12, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7317490577697754
Epoch: 13, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1730343
model size : 9.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4812865257263184
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7587070465087891
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7955520153045654
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6157777309417725
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8326585292816162
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8939177989959717
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7400331497192383
Epoch: 7, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8595123291015625
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9174909591674805
Epoch: 9, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7527337074279785
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0905835628509521
Epoch: 11, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7565126419067383
Epoch: 12, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7698562145233154
Epoch: 13, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1719975
model size : 9.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8231890201568604
Epoch: 1, Steps: 1 | Train Loss: 1.471 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7666358947753906
Epoch: 2, Steps: 1 | Train Loss: 1.449 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8100161552429199
Epoch: 3, Steps: 1 | Train Loss: 1.355 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.962078332901001
Epoch: 4, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8688573837280273
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8664960861206055
Epoch: 6, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
Validation loss decreased (-0.333320 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.8910462856292725
Epoch: 7, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7846014499664307
Epoch: 8, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9407069683074951
Epoch: 9, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.029615879058838
Epoch: 10, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9415285587310791
Epoch: 11, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.209 Vali Acc: 0.467 Test Loss: 1.209 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8766648769378662
Epoch: 12, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.789177656173706
Epoch: 13, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.73309326171875
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.815913200378418
Epoch: 15, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7950358390808105
Epoch: 16, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1709607
model size : 9.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0869922637939453
Epoch: 1, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.8874473571777344
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6689608097076416
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6532614231109619
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7394309043884277
Epoch: 5, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1798086166381836
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9584395885467529
Epoch: 7, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9196031093597412
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.144 Vali Acc: 0.067 Test Loss: 1.144 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8634238243103027
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7002761363983154
Epoch: 10, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9513823986053467
Epoch: 11, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1576231
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8581414222717285
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1832189559936523
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6941483020782471
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8469235897064209
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8924679756164551
Epoch: 5, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.06229567527771
Epoch: 6, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8804965019226074
Epoch: 7, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.796471118927002
Epoch: 8, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7078845500946045
Epoch: 9, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9576594829559326
Epoch: 10, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.020630121231079
Epoch: 11, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8052423000335693
Epoch: 12, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.949138879776001
Epoch: 13, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1565863
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9061014652252197
Epoch: 1, Steps: 1 | Train Loss: 1.433 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8818871974945068
Epoch: 2, Steps: 1 | Train Loss: 1.403 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7715179920196533
Epoch: 3, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9915602207183838
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7161729335784912
Epoch: 5, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9950704574584961
Epoch: 6, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9152266979217529
Epoch: 7, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7904863357543945
Epoch: 8, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9311525821685791
Epoch: 9, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9211883544921875
Epoch: 10, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9626200199127197
Epoch: 11, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7259480953216553
Epoch: 12, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9561712741851807
Epoch: 13, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8276114463806152
Epoch: 14, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8180892467498779
Epoch: 15, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1555495
model size : 8.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.064573287963867
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9696283340454102
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8458089828491211
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9007358551025391
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8262062072753906
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9047384262084961
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0586092472076416
Epoch: 7, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7221503257751465
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8658261299133301
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7911031246185303
Epoch: 10, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.798419713973999
Epoch: 11, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7002017498016357
Epoch: 12, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9204070568084717
Epoch: 13, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8939635753631592
Epoch: 14, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9475612640380859
Epoch: 15, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1438255310058594
Epoch: 16, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0022969245910645
Epoch: 17, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1545127
model size : 8.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.909792184829712
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6698637008666992
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7661566734313965
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5827577114105225
Epoch: 4, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6209840774536133
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8342974185943604
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9419863224029541
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7905426025390625
Epoch: 8, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7903914451599121
Epoch: 9, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8261005878448486
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7758963108062744
Epoch: 11, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.729363203048706
Epoch: 12, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1038695
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5743813514709473
Epoch: 1, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.716052770614624
Epoch: 2, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7511627674102783
Epoch: 3, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6959693431854248
Epoch: 4, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6747884750366211
Epoch: 5, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 0.706866979598999
Epoch: 6, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7715115547180176
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7365865707397461
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.684851884841919
Epoch: 9, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6919898986816406
Epoch: 10, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8605825901031494
Epoch: 11, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8345992565155029
Epoch: 12, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.760767936706543
Epoch: 13, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8336324691772461
Epoch: 14, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.781437873840332
Epoch: 15, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1033511
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.520526170730591
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9233567714691162
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8007147312164307
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0840575695037842
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8402149677276611
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9052197933197021
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.782517671585083
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7767062187194824
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.734175443649292
Epoch: 9, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.6335434913635254
Epoch: 10, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7142584323883057
Epoch: 11, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7764937877655029
Epoch: 12, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6730220317840576
Epoch: 13, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7040653228759766
Epoch: 14, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7381212711334229
Epoch: 15, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7754781246185303
Epoch: 16, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7795534133911133
Epoch: 17, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8775062561035156
Epoch: 18, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.758509635925293
Epoch: 19, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1028327
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7856099605560303
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.9885036945343018
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6987185478210449
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.8910276889801025
Epoch: 4, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8377583026885986
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7870349884033203
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7372879981994629
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8505525588989258
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.203432321548462
Epoch: 9, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.066786289215088
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8595893383026123
Epoch: 11, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.020 Vali Acc: 0.667 Test Loss: 1.020 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 12 cost time: 1.08656907081604
Epoch: 12, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.016 Vali Acc: 0.733 Test Loss: 1.016 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 0.854377031326294
Epoch: 13, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9458134174346924
Epoch: 14, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9516644477844238
Epoch: 15, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9349949359893799
Epoch: 16, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8783931732177734
Epoch: 17, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8457691669464111
Epoch: 18, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.016 Vali Acc: 0.667 Test Loss: 1.016 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8160250186920166
Epoch: 19, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0563817024230957
Epoch: 20, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9727869033813477
Epoch: 21, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9761769771575928
Epoch: 22, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 1023143
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6762993335723877
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8676712512969971
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7652838230133057
Epoch: 3, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.9172685146331787
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8087286949157715
Epoch: 5, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8598873615264893
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.954153299331665
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0288059711456299
Epoch: 8, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.75441575050354
Epoch: 9, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9636094570159912
Epoch: 10, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7744259834289551
Epoch: 11, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7395808696746826
Epoch: 12, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9033126831054688
Epoch: 13, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 708455
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.570958375930786
Epoch: 1, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7029678821563721
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.699124813079834
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7183520793914795
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6511185169219971
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7574145793914795
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7093448638916016
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.837831974029541
Epoch: 8, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7132701873779297
Epoch: 9, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9593939781188965
Epoch: 10, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.103487491607666
Epoch: 11, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0149939060211182
Epoch: 12, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9248952865600586
Epoch: 13, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7379882335662842
Epoch: 14, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.7446029186248779
Epoch: 15, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8045547008514404
Epoch: 16, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7839419841766357
Epoch: 17, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8472888469696045
Epoch: 18, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7034225463867188
Epoch: 19, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7455711364746094
Epoch: 20, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7934658527374268
Epoch: 21, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7349584102630615
Epoch: 22, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7320940494537354
Epoch: 23, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.003450870513916
Epoch: 24, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 703271
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7799901962280273
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.982250452041626
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7820024490356445
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.9874377250671387
Epoch: 4, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.801002025604248
Epoch: 5, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9202673435211182
Epoch: 6, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7881515026092529
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9586200714111328
Epoch: 8, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8412413597106934
Epoch: 9, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9437894821166992
Epoch: 10, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0408470630645752
Epoch: 11, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7840104103088379
Epoch: 12, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1252336502075195
Epoch: 13, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 698087
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1755988597869873
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9863944053649902
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.1484992504119873
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7319581508636475
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9052278995513916
Epoch: 5, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8750510215759277
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8340692520141602
Epoch: 7, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0810387134552002
Epoch: 8, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9382469654083252
Epoch: 9, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.891740083694458
Epoch: 10, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8788712024688721
Epoch: 11, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.924858808517456
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8173494338989258
Epoch: 13, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9977719783782959
Epoch: 14, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.766143798828125
Epoch: 15, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8089849948883057
Epoch: 16, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 692903
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.888943672180176
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.9142212867736816
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.7481791973114014
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8510591983795166
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.1523418426513672
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9146475791931152
Epoch: 6, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9022369384765625
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0650808811187744
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7515020370483398
Epoch: 9, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9400074481964111
Epoch: 10, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8715486526489258
Epoch: 11, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7919981479644775
Epoch: 12, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.7249472141265869
Epoch: 13, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0879852771759033
Epoch: 14, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9552428722381592
Epoch: 15, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8863298892974854
Epoch: 16, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9413762092590332
Epoch: 17, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6918885707855225
Epoch: 18, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8006024360656738
Epoch: 19, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9353444576263428
Epoch: 20, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7677333354949951
Epoch: 21, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.056337833404541
Epoch: 22, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 543335
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5843594074249268
Epoch: 1, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5968389511108398
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8134820461273193
Epoch: 3, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7602481842041016
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.786034107208252
Epoch: 5, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7857637405395508
Epoch: 6, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8061308860778809
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7572073936462402
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.14994215965271
Epoch: 9, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7012574672698975
Epoch: 10, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6710786819458008
Epoch: 11, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.841066837310791
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7262835502624512
Epoch: 13, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0047342777252197
Epoch: 14, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7516076564788818
Epoch: 15, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9210934638977051
Epoch: 16, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8354675769805908
Epoch: 17, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0379459857940674
Epoch: 18, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 538151
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.382875442504883
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.588097095489502
Epoch: 2, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8275079727172852
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.702017068862915
Epoch: 4, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8361678123474121
Epoch: 5, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.8977546691894531
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8341264724731445
Epoch: 7, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.874922513961792
Epoch: 8, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.978477954864502
Epoch: 9, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8936343193054199
Epoch: 10, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0530519485473633
Epoch: 11, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7099041938781738
Epoch: 12, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6879549026489258
Epoch: 13, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8305470943450928
Epoch: 14, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7749741077423096
Epoch: 15, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 532967
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.582611083984375
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7167863845825195
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7289900779724121
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.645359992980957
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.6814649105072021
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8319952487945557
Epoch: 6, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9108679294586182
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7738006114959717
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.68670654296875
Epoch: 9, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8121962547302246
Epoch: 10, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7507226467132568
Epoch: 11, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.734429121017456
Epoch: 12, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3350803852081299
Epoch: 13, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7894248962402344
Epoch: 14, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6667211055755615
Epoch: 15, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.082 Vali Acc: 0.200 Test Loss: 1.082 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6577768325805664
Epoch: 16, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6888892650604248
Epoch: 17, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0433204174041748
Epoch: 18, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.089 Vali Acc: 0.133 Test Loss: 1.089 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 527783
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.481454610824585
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8140034675598145
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8495564460754395
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9512045383453369
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9247233867645264
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9719393253326416
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0269112586975098
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9302375316619873
Epoch: 8, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8097789287567139
Epoch: 9, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7402350902557373
Epoch: 10, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8238968849182129
Epoch: 11, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9054503440856934
Epoch: 12, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8097248077392578
Epoch: 13, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 460775
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9183690547943115
Epoch: 1, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9241170883178711
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7704598903656006
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6695008277893066
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9493124485015869
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8953900337219238
Epoch: 6, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6337072849273682
Epoch: 7, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9894101619720459
Epoch: 8, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7274703979492188
Epoch: 9, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8165040016174316
Epoch: 10, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8627004623413086
Epoch: 11, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.673175573348999
Epoch: 12, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.87099289894104
Epoch: 13, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7116165161132812
Epoch: 14, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6933050155639648
Epoch: 15, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8870775699615479
Epoch: 16, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.887631893157959
Epoch: 17, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8194975852966309
Epoch: 18, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9223201274871826
Epoch: 19, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9126787185668945
Epoch: 20, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.655381441116333
Epoch: 21, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9883363246917725
Epoch: 22, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 455591
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3205857276916504
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9285218715667725
Epoch: 2, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9817883968353271
Epoch: 3, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.892195463180542
Epoch: 4, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7569398880004883
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9782280921936035
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 1.0308043956756592
Epoch: 7, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9807729721069336
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6921021938323975
Epoch: 9, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.86136794090271
Epoch: 10, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9233202934265137
Epoch: 11, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0179026126861572
Epoch: 12, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8674921989440918
Epoch: 13, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.050900936126709
Epoch: 14, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0816991329193115
Epoch: 15, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.082625389099121
Epoch: 16, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 450407
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.826622486114502
Epoch: 1, Steps: 1 | Train Loss: 1.300 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6981329917907715
Epoch: 2, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7873134613037109
Epoch: 3, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.814528226852417
Epoch: 4, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.9328770637512207
Epoch: 5, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.977724552154541
Epoch: 6, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8370494842529297
Epoch: 7, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8164122104644775
Epoch: 8, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.752615213394165
Epoch: 9, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.948514461517334
Epoch: 10, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.797236442565918
Epoch: 11, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8036239147186279
Epoch: 12, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.718475341796875
Epoch: 13, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9204161167144775
Epoch: 14, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7721714973449707
Epoch: 15, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 445223
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.945607900619507
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.813643217086792
Epoch: 2, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8241422176361084
Epoch: 3, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9083778858184814
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.754239559173584
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7272040843963623
Epoch: 6, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.832801342010498
Epoch: 7, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9375505447387695
Epoch: 8, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9369268417358398
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7107524871826172
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.958282470703125
Epoch: 11, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9230029582977295
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.024446964263916
Epoch: 13, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9448292255401611
Epoch: 14, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 440007
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9526138305664062
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7541570663452148
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8605501651763916
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8253238201141357
Epoch: 4, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9502546787261963
Epoch: 5, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8070571422576904
Epoch: 6, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7774298191070557
Epoch: 7, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7915558815002441
Epoch: 8, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7419869899749756
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7369980812072754
Epoch: 10, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8427929878234863
Epoch: 11, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 437415
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.928255319595337
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9983384609222412
Epoch: 2, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7228014469146729
Epoch: 3, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6958646774291992
Epoch: 4, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7363030910491943
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9744791984558105
Epoch: 6, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8576526641845703
Epoch: 7, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8907420635223389
Epoch: 8, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.8059520721435547
Epoch: 9, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6920013427734375
Epoch: 10, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7503306865692139
Epoch: 11, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.956345796585083
Epoch: 12, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8322422504425049
Epoch: 13, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8138332366943359
Epoch: 14, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7790896892547607
Epoch: 15, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.977567195892334
Epoch: 16, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8737587928771973
Epoch: 17, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0321588516235352
Epoch: 18, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 434823
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6800150871276855
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7975926399230957
Epoch: 2, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8453476428985596
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8191685676574707
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0440335273742676
Epoch: 5, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.014629602432251
Epoch: 6, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7832655906677246
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.6154372692108154
Epoch: 8, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7001323699951172
Epoch: 9, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7388708591461182
Epoch: 10, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.673377275466919
Epoch: 11, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8217365741729736
Epoch: 12, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7265956401824951
Epoch: 13, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6719551086425781
Epoch: 14, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7366068363189697
Epoch: 15, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8169653415679932
Epoch: 16, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8916852474212646
Epoch: 17, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 432231
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.255361795425415
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.646773099899292
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7346947193145752
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8386163711547852
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8087892532348633
Epoch: 5, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5679678916931152
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7120895385742188
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8350811004638672
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7256026268005371
Epoch: 9, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6461191177368164
Epoch: 10, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6948568820953369
Epoch: 11, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7268662452697754
Epoch: 12, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7446415424346924
Epoch: 13, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8995156288146973
Epoch: 14, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7457945346832275
Epoch: 15, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.867163896560669
Epoch: 16, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 273607
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.578235387802124
Epoch: 1, Steps: 1 | Train Loss: 1.524 Vali Loss: 1.515 Vali Acc: 0.333 Test Loss: 1.515 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.5773875713348389
Epoch: 2, Steps: 1 | Train Loss: 1.586 Vali Loss: 1.448 Vali Acc: 0.333 Test Loss: 1.448 Test Acc: 0.333
Validation loss decreased (-0.333318 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.6691453456878662
Epoch: 3, Steps: 1 | Train Loss: 1.424 Vali Loss: 1.388 Vali Acc: 0.333 Test Loss: 1.388 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 0.6185977458953857
Epoch: 4, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.673321008682251
Epoch: 5, Steps: 1 | Train Loss: 1.400 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.8343074321746826
Epoch: 6, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.7924284934997559
Epoch: 7, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5786781311035156
Epoch: 8, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5630459785461426
Epoch: 9, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7173359394073486
Epoch: 10, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8084869384765625
Epoch: 11, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.538982629776001
Epoch: 12, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7271106243133545
Epoch: 13, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.828688383102417
Epoch: 14, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6638731956481934
Epoch: 15, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7162938117980957
Epoch: 16, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6606941223144531
Epoch: 17, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8636739253997803
Epoch: 18, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0084095001220703
Epoch: 19, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8612856864929199
Epoch: 20, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.588066816329956
Epoch: 21, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 271015
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.557290554046631
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8237912654876709
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9206695556640625
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7424890995025635
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7079033851623535
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9837288856506348
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8079445362091064
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9369010925292969
Epoch: 8, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8858916759490967
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7327938079833984
Epoch: 10, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7424893379211426
Epoch: 11, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7691504955291748
Epoch: 12, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9495265483856201
Epoch: 13, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8445634841918945
Epoch: 14, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9020187854766846
Epoch: 15, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5951948165893555
Epoch: 16, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 268423
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.267026424407959
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7101218700408936
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7163169384002686
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6231780052185059
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9784650802612305
Epoch: 5, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6557550430297852
Epoch: 6, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8590652942657471
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7393221855163574
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7058145999908447
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8312084674835205
Epoch: 10, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8171370029449463
Epoch: 11, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9655306339263916
Epoch: 12, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 265831
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.694166660308838
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7066202163696289
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7729823589324951
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7502281665802002
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8311665058135986
Epoch: 5, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.776064395904541
Epoch: 6, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8095896244049072
Epoch: 7, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.016554832458496
Epoch: 8, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1771459579467773
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0926885604858398
Epoch: 10, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5352668762207031
Epoch: 11, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9112722873687744
Epoch: 12, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 190407
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.470292568206787
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7102391719818115
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8593688011169434
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8681097030639648
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8610637187957764
Epoch: 5, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7901291847229004
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9526104927062988
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8801479339599609
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.76521897315979
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9288656711578369
Epoch: 10, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7230989933013916
Epoch: 11, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 187815
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8815770149230957
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.732731819152832
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7824110984802246
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6669411659240723
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7530982494354248
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7171940803527832
Epoch: 6, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1166961193084717
Epoch: 7, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7161538600921631
Epoch: 8, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.09027099609375
Epoch: 9, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7443780899047852
Epoch: 10, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6741883754730225
Epoch: 11, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.839576005935669
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0240516662597656
Epoch: 13, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 185223
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8546454906463623
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8549418449401855
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7817304134368896
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7239727973937988
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8227763175964355
Epoch: 5, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8346552848815918
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8491027355194092
Epoch: 7, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8639833927154541
Epoch: 8, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.945458173751831
Epoch: 9, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0726408958435059
Epoch: 10, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9369440078735352
Epoch: 11, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6985290050506592
Epoch: 12, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8216581344604492
Epoch: 13, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9813764095306396
Epoch: 14, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 182631
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7763280868530273
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1093990802764893
Epoch: 2, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9697787761688232
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8950550556182861
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.019226312637329
Epoch: 5, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0397517681121826
Epoch: 6, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9037890434265137
Epoch: 7, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.772780179977417
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7474465370178223
Epoch: 9, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7274312973022461
Epoch: 10, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7020635604858398
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9023768901824951
Epoch: 12, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7099449634552002
Epoch: 13, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8793542385101318
Epoch: 14, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.750136137008667
Epoch: 15, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7665243148803711
Epoch: 16, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 148807
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2728846073150635
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6795880794525146
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8003921508789062
Epoch: 3, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6893072128295898
Epoch: 4, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7371668815612793
Epoch: 5, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6905896663665771
Epoch: 6, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5603072643280029
Epoch: 7, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9054498672485352
Epoch: 8, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8765406608581543
Epoch: 9, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6801478862762451
Epoch: 10, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8353943824768066
Epoch: 11, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.953744649887085
Epoch: 12, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0233910083770752
Epoch: 13, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7604365348815918
Epoch: 14, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8391914367675781
Epoch: 15, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6363940238952637
Epoch: 16, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 146215
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.082240581512451
Epoch: 1, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.273 Vali Acc: 0.200 Test Loss: 1.273 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6864006519317627
Epoch: 2, Steps: 1 | Train Loss: 1.376 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
Validation loss decreased (-0.199987 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.057978868484497
Epoch: 3, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8308675289154053
Epoch: 4, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7642078399658203
Epoch: 5, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8152282238006592
Epoch: 6, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9565556049346924
Epoch: 7, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.0430562496185303
Epoch: 8, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9687190055847168
Epoch: 9, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8497769832611084
Epoch: 10, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9372453689575195
Epoch: 11, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9313814640045166
Epoch: 12, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8882272243499756
Epoch: 13, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9360289573669434
Epoch: 14, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0013020038604736
Epoch: 15, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9147415161132812
Epoch: 16, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9231343269348145
Epoch: 17, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9780988693237305
Epoch: 18, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0036962032318115
Epoch: 19, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9644331932067871
Epoch: 20, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9470987319946289
Epoch: 21, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 143623
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6340346336364746
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9669108390808105
Epoch: 2, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9841437339782715
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2265169620513916
Epoch: 4, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2435636520385742
Epoch: 5, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.859572172164917
Epoch: 6, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.914574384689331
Epoch: 7, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8507153987884521
Epoch: 8, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7603633403778076
Epoch: 9, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8723018169403076
Epoch: 10, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9330978393554688
Epoch: 11, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 141031
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9274895191192627
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6425554752349854
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6841237545013428
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6965353488922119
Epoch: 4, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8267385959625244
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7427194118499756
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.765812873840332
Epoch: 7, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7320346832275391
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9337234497070312
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7149999141693115
Epoch: 10, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6705150604248047
Epoch: 11, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.186 Vali Acc: 0.067 Test Loss: 1.186 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.823857307434082
Epoch: 12, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.188 Vali Acc: 0.067 Test Loss: 1.188 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6902782917022705
Epoch: 13, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8224554061889648
Epoch: 14, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 4919323
model size : 23.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.586127281188965
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6712772846221924
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8022041320800781
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6657664775848389
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6264958381652832
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7968268394470215
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.783571720123291
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7526137828826904
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8893661499023438
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6393814086914062
Epoch: 10, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8046510219573975
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8713674545288086
Epoch: 12, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9213080406188965
Epoch: 13, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.773756742477417
Epoch: 14, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8843040466308594
Epoch: 15, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1303372383117676
Epoch: 16, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4905499
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9251599311828613
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.707019567489624
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6772077083587646
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8393337726593018
Epoch: 4, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0532937049865723
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7689456939697266
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8371226787567139
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2485847473144531
Epoch: 8, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6922690868377686
Epoch: 9, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.736412525177002
Epoch: 10, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8391318321228027
Epoch: 11, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4891675
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.597015619277954
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7192180156707764
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.798281192779541
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6578109264373779
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6977612972259521
Epoch: 5, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.708958625793457
Epoch: 6, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7767596244812012
Epoch: 7, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.712512731552124
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3409066200256348
Epoch: 9, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6456961631774902
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6728799343109131
Epoch: 11, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9117250442504883
Epoch: 12, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.683800220489502
Epoch: 13, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8394355773925781
Epoch: 14, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6857738494873047
Epoch: 15, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.7656478881835938
Epoch: 16, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9592330455780029
Epoch: 17, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6802213191986084
Epoch: 18, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6707596778869629
Epoch: 19, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.934912919998169
Epoch: 20, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8945670127868652
Epoch: 21, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.947429895401001
Epoch: 22, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9142897129058838
Epoch: 23, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.352 Vali Acc: 0.333 Test Loss: 1.352 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8610899448394775
Epoch: 24, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.333 Vali Acc: 0.333 Test Loss: 1.333 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9129788875579834
Epoch: 25, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4877851
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7383275032043457
Epoch: 1, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0525333881378174
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.890484094619751
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9777164459228516
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8831818103790283
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7106966972351074
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9005427360534668
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8766300678253174
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7108330726623535
Epoch: 9, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7647151947021484
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7750928401947021
Epoch: 11, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6722204685211182
Epoch: 12, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4131355
model size : 20.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.323087692260742
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7749340534210205
Epoch: 2, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7630085945129395
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7191061973571777
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6760215759277344
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.734619140625
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7114512920379639
Epoch: 7, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8398194313049316
Epoch: 8, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7632186412811279
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7509655952453613
Epoch: 10, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8086762428283691
Epoch: 11, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8614559173583984
Epoch: 12, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9063777923583984
Epoch: 13, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8047866821289062
Epoch: 14, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0252385139465332
Epoch: 15, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8519866466522217
Epoch: 16, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4117531
model size : 20.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.571247100830078
Epoch: 1, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6188809871673584
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7449042797088623
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6026017665863037
Epoch: 4, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7184042930603027
Epoch: 5, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6898829936981201
Epoch: 6, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.679279088973999
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7025983333587646
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7565352916717529
Epoch: 9, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6523990631103516
Epoch: 10, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7408442497253418
Epoch: 11, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.776425838470459
Epoch: 12, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.673940896987915
Epoch: 13, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0756142139434814
Epoch: 14, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7732794284820557
Epoch: 15, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7154805660247803
Epoch: 16, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4103707
model size : 20.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.454143762588501
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6198935508728027
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8155806064605713
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.806602954864502
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6957964897155762
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6996948719024658
Epoch: 6, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.026735782623291
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8612070083618164
Epoch: 8, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7311344146728516
Epoch: 9, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8955409526824951
Epoch: 10, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7472062110900879
Epoch: 11, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4089883
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9687039852142334
Epoch: 1, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7688651084899902
Epoch: 2, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9121193885803223
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.903247594833374
Epoch: 4, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8003876209259033
Epoch: 5, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9049854278564453
Epoch: 6, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9199666976928711
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8176567554473877
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.742368221282959
Epoch: 9, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8679778575897217
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7123928070068359
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7925319671630859
Epoch: 12, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8383896350860596
Epoch: 13, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8705966472625732
Epoch: 14, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8962478637695312
Epoch: 15, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.210946798324585
Epoch: 16, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7461628913879395
Epoch: 17, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8371281623840332
Epoch: 18, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3737371
model size : 19.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8230392932891846
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8005590438842773
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8950345516204834
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9518918991088867
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9972574710845947
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6433379650115967
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9248168468475342
Epoch: 7, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7102539539337158
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6739497184753418
Epoch: 9, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6472384929656982
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6634666919708252
Epoch: 11, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8473460674285889
Epoch: 12, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8939762115478516
Epoch: 13, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7521629333496094
Epoch: 14, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8688998222351074
Epoch: 15, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3723547
model size : 19.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.99041748046875
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8390896320343018
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7076377868652344
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9860506057739258
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8004138469696045
Epoch: 5, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8611769676208496
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7985773086547852
Epoch: 7, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.985039234161377
Epoch: 8, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.791085958480835
Epoch: 9, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6429853439331055
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6534919738769531
Epoch: 11, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6781518459320068
Epoch: 12, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8688840866088867
Epoch: 13, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3709723
model size : 19.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6091103553771973
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7157647609710693
Epoch: 2, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.0764122009277344
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7320218086242676
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7320225238800049
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7131638526916504
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7914674282073975
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6527421474456787
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7727205753326416
Epoch: 9, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8833632469177246
Epoch: 10, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7475101947784424
Epoch: 11, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7071890830993652
Epoch: 12, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9751837253570557
Epoch: 13, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 1.0263378620147705
Epoch: 14, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0415050983428955
Epoch: 15, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7116308212280273
Epoch: 16, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8239233493804932
Epoch: 17, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8627269268035889
Epoch: 18, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7938652038574219
Epoch: 19, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.008213996887207
Epoch: 20, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6993200778961182
Epoch: 21, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9429836273193359
Epoch: 22, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9447004795074463
Epoch: 23, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3695899
model size : 19.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5060007572174072
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5751147270202637
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6377360820770264
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6103732585906982
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5355510711669922
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5204730033874512
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6632318496704102
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5923848152160645
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6655652523040771
Epoch: 9, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6562871932983398
Epoch: 10, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5958316326141357
Epoch: 11, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.705348014831543
Epoch: 12, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.538809061050415
Epoch: 13, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6207113265991211
Epoch: 14, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3540379
model size : 18.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0731208324432373
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7367138862609863
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.8439605236053467
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.020843267440796
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9036543369293213
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8880834579467773
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9302737712860107
Epoch: 7, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9293406009674072
Epoch: 8, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.761347770690918
Epoch: 9, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7755172252655029
Epoch: 10, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7648625373840332
Epoch: 11, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9236063957214355
Epoch: 12, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 3526555
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6886658668518066
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6812465190887451
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7060160636901855
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2287547588348389
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6235995292663574
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8174576759338379
Epoch: 6, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9624080657958984
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.774742841720581
Epoch: 8, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7184476852416992
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9686603546142578
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.7684421539306641
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8232009410858154
Epoch: 12, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8418734073638916
Epoch: 13, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8732123374938965
Epoch: 14, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7180144786834717
Epoch: 15, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8574972152709961
Epoch: 16, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8430161476135254
Epoch: 17, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8507528305053711
Epoch: 18, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8169040679931641
Epoch: 19, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7596633434295654
Epoch: 20, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3512731
model size : 18.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0659406185150146
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.4016859531402588
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8259260654449463
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8076210021972656
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6682443618774414
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8518869876861572
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9381062984466553
Epoch: 7, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8072142601013184
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7254467010498047
Epoch: 9, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7432491779327393
Epoch: 10, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8213741779327393
Epoch: 11, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9825174808502197
Epoch: 12, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3498907
model size : 18.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.556337594985962
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9642493724822998
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7823348045349121
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7520146369934082
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8670339584350586
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8681180477142334
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.734919548034668
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6597099304199219
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9851441383361816
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7825882434844971
Epoch: 10, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7385272979736328
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9379417896270752
Epoch: 12, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1674779
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5365443229675293
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.922961950302124
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7520465850830078
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7030506134033203
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8358750343322754
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.022322177886963
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2625305652618408
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3135640621185303
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2281620502471924
Epoch: 9, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0886986255645752
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.685420036315918
Epoch: 11, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7203431129455566
Epoch: 12, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1667867
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8396756649017334
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7467927932739258
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6546921730041504
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8128619194030762
Epoch: 4, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6880652904510498
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7150273323059082
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7484827041625977
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8551006317138672
Epoch: 8, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8048675060272217
Epoch: 9, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6681158542633057
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7177939414978027
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8443243503570557
Epoch: 12, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.635922908782959
Epoch: 13, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7228066921234131
Epoch: 14, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1660955
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9145419597625732
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.64349365234375
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7862672805786133
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7083184719085693
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8623611927032471
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7877967357635498
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6998887062072754
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7857985496520996
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6740119457244873
Epoch: 9, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7188401222229004
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6889586448669434
Epoch: 11, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1654043
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8632733821868896
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8200912475585938
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9681267738342285
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8251571655273438
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7092993259429932
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7430310249328613
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7147157192230225
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.6459481716156006
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7381117343902588
Epoch: 9, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8502902984619141
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8197717666625977
Epoch: 11, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7307767868041992
Epoch: 12, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8078806400299072
Epoch: 13, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7820398807525635
Epoch: 14, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9005870819091797
Epoch: 15, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6490745544433594
Epoch: 16, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6320321559906006
Epoch: 17, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1280027
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7964975833892822
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.961162805557251
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7999882698059082
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7651214599609375
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8114900588989258
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7730810642242432
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0642991065979004
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4466478824615479
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9328210353851318
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.61568284034729
Epoch: 10, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2507340908050537
Epoch: 11, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6761267185211182
Epoch: 12, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0288214683532715
Epoch: 13, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1273115
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9430899620056152
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.0549557209014893
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7599170207977295
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7747304439544678
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8372592926025391
Epoch: 5, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8471193313598633
Epoch: 6, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.9367327690124512
Epoch: 7, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5928211212158203
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7087385654449463
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.903632640838623
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.06015944480896
Epoch: 11, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8871164321899414
Epoch: 12, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9221298694610596
Epoch: 13, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9623730182647705
Epoch: 14, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9004232883453369
Epoch: 15, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8314681053161621
Epoch: 16, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7843143939971924
Epoch: 17, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1266203
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.159090042114258
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6773083209991455
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6794798374176025
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7762532234191895
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9390575885772705
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8370978832244873
Epoch: 6, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.745638370513916
Epoch: 7, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7932641506195068
Epoch: 8, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.8188111782073975
Epoch: 9, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9188258647918701
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7471272945404053
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8008301258087158
Epoch: 12, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7682340145111084
Epoch: 13, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8975324630737305
Epoch: 14, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8363354206085205
Epoch: 15, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0396876335144043
Epoch: 16, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8497543334960938
Epoch: 17, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6862409114837646
Epoch: 18, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1259291
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9609735012054443
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.85178542137146
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0169215202331543
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0929503440856934
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7575900554656982
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8234908580780029
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9052636623382568
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.98799729347229
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0539793968200684
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9310708045959473
Epoch: 10, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7895791530609131
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.902944803237915
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9397187232971191
Epoch: 13, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.87827467918396
Epoch: 14, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9049620628356934
Epoch: 15, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0532991886138916
Epoch: 16, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1082651
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0943429470062256
Epoch: 1, Steps: 1 | Train Loss: 1.328 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7609739303588867
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8308768272399902
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9927291870117188
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6544606685638428
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.954749345779419
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0052940845489502
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9198408126831055
Epoch: 8, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0109436511993408
Epoch: 9, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9582545757293701
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8003997802734375
Epoch: 11, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.063194751739502
Epoch: 12, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7760210037231445
Epoch: 13, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1075739
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7714970111846924
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7381107807159424
Epoch: 2, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.8471114635467529
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 1.0565571784973145
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9378976821899414
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8178918361663818
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.9224753379821777
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9244847297668457
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.65224289894104
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.797696590423584
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.11033296585083
Epoch: 11, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9616439342498779
Epoch: 12, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9124023914337158
Epoch: 13, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9735534191131592
Epoch: 14, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8473403453826904
Epoch: 15, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1219143867492676
Epoch: 16, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8292596340179443
Epoch: 17, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0532011985778809
Epoch: 18, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1068827
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.54331374168396
Epoch: 1, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9676156044006348
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8107430934906006
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8980557918548584
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.903404951095581
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6994004249572754
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8992483615875244
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8610234260559082
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.9543495178222656
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7446191310882568
Epoch: 10, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.82472825050354
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.8241264820098877
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8968961238861084
Epoch: 13, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0906944274902344
Epoch: 14, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.153 Vali Acc: 0.067 Test Loss: 1.153 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9701344966888428
Epoch: 15, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9963881969451904
Epoch: 16, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0416905879974365
Epoch: 17, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7330801486968994
Epoch: 18, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8146214485168457
Epoch: 19, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7776691913604736
Epoch: 20, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.170 Vali Acc: 0.067 Test Loss: 1.170 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9128634929656982
Epoch: 21, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.173 Vali Acc: 0.067 Test Loss: 1.173 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1061915
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.734402894973755
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
Validation loss decreased (inf --> -0.533324).  Saving model ...
Epoch: 2 cost time: 0.7784004211425781
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7358040809631348
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.011 Vali Acc: 0.333 Test Loss: 1.011 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8608651161193848
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7436885833740234
Epoch: 5, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.726184606552124
Epoch: 6, Steps: 1 | Train Loss: 1.116 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8082296848297119
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7756137847900391
Epoch: 8, Steps: 1 | Train Loss: 0.920 Vali Loss: 0.985 Vali Acc: 0.467 Test Loss: 0.985 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6977663040161133
Epoch: 9, Steps: 1 | Train Loss: 1.019 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6933972835540771
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7509679794311523
Epoch: 11, Steps: 1 | Train Loss: 0.919 Vali Loss: 0.988 Vali Acc: 0.400 Test Loss: 0.988 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 983963
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.529223918914795
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6389467716217041
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6320679187774658
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 1.046743631362915
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6152982711791992
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5938351154327393
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8394889831542969
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8827335834503174
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.7137782573699951
Epoch: 9, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7771894931793213
Epoch: 10, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0571413040161133
Epoch: 11, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5168731212615967
Epoch: 12, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7768704891204834
Epoch: 13, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7221477031707764
Epoch: 14, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7545511722564697
Epoch: 15, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.729485034942627
Epoch: 16, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6766214370727539
Epoch: 17, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8907859325408936
Epoch: 18, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 977051
model size : 6.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8494014739990234
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7939820289611816
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (-0.266655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.8549590110778809
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.660428524017334
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.9416422843933105
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9937243461608887
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0825932025909424
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9997522830963135
Epoch: 8, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1378700733184814
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0300407409667969
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8309626579284668
Epoch: 11, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9493379592895508
Epoch: 12, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.867180347442627
Epoch: 13, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9957129955291748
Epoch: 14, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 970139
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2938005924224854
Epoch: 1, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6700782775878906
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0238037109375
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.93105149269104
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8460373878479004
Epoch: 5, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8099284172058105
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7136924266815186
Epoch: 7, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7516818046569824
Epoch: 8, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7156529426574707
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8391993045806885
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.635282039642334
Epoch: 11, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6828463077545166
Epoch: 12, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6597554683685303
Epoch: 13, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8391408920288086
Epoch: 14, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8274970054626465
Epoch: 15, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7582018375396729
Epoch: 16, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5679101943969727
Epoch: 17, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 963227
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.377134323120117
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6149675846099854
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7873630523681641
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7538135051727295
Epoch: 4, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7302522659301758
Epoch: 5, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7396676540374756
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8349714279174805
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8370471000671387
Epoch: 8, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7153353691101074
Epoch: 9, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7611126899719238
Epoch: 10, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7416393756866455
Epoch: 11, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 642331
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3372340202331543
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8375000953674316
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9267730712890625
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8786165714263916
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7162859439849854
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8079869747161865
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1380887031555176
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7327713966369629
Epoch: 8, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6885550022125244
Epoch: 9, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.6764097213745117
Epoch: 10, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8202855587005615
Epoch: 11, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9376394748687744
Epoch: 12, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9017157554626465
Epoch: 13, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7106831073760986
Epoch: 14, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9941186904907227
Epoch: 15, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.754981279373169
Epoch: 16, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 1.0352294445037842
Epoch: 17, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6966068744659424
Epoch: 18, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7635936737060547
Epoch: 19, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.661139965057373
Epoch: 20, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9114272594451904
Epoch: 21, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8987441062927246
Epoch: 22, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8720521926879883
Epoch: 23, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8798871040344238
Epoch: 24, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7246510982513428
Epoch: 25, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6978302001953125
Epoch: 26, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 638875
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.546339750289917
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8710649013519287
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.674705982208252
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8106679916381836
Epoch: 4, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2408430576324463
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7158801555633545
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7278988361358643
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.783430814743042
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9434142112731934
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7260198593139648
Epoch: 10, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6732757091522217
Epoch: 11, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7801249027252197
Epoch: 12, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.862358570098877
Epoch: 13, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6444149017333984
Epoch: 14, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8296115398406982
Epoch: 15, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0709853172302246
Epoch: 16, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8645870685577393
Epoch: 17, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8022570610046387
Epoch: 18, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9028317928314209
Epoch: 19, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9150044918060303
Epoch: 20, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0552890300750732
Epoch: 21, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 635419
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.878326177597046
Epoch: 1, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0058550834655762
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9485378265380859
Epoch: 3, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7924063205718994
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.751929759979248
Epoch: 5, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6324300765991211
Epoch: 6, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8032877445220947
Epoch: 7, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7044994831085205
Epoch: 8, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8375470638275146
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8813323974609375
Epoch: 10, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1036350727081299
Epoch: 11, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0041956901550293
Epoch: 12, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9480865001678467
Epoch: 13, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 631963
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.797776460647583
Epoch: 1, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8106966018676758
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7789955139160156
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7920775413513184
Epoch: 4, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.7042627334594727
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6317236423492432
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7277867794036865
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8072359561920166
Epoch: 8, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8179233074188232
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7350978851318359
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.821340799331665
Epoch: 11, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8211119174957275
Epoch: 12, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8341460227966309
Epoch: 13, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9563958644866943
Epoch: 14, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 444187
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.023831844329834
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7137224674224854
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9522686004638672
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8893961906433105
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.124049186706543
Epoch: 5, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8549027442932129
Epoch: 6, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.974449634552002
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7947206497192383
Epoch: 8, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7557287216186523
Epoch: 9, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7796533107757568
Epoch: 10, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3228604793548584
Epoch: 11, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8331174850463867
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.098473072052002
Epoch: 13, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.199509859085083
Epoch: 14, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9189972877502441
Epoch: 15, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8536200523376465
Epoch: 16, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0689501762390137
Epoch: 17, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7468748092651367
Epoch: 18, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 440731
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.177333354949951
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8086514472961426
Epoch: 2, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.869626522064209
Epoch: 3, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.221832036972046
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9956309795379639
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0300607681274414
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0930650234222412
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.856191873550415
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0352797508239746
Epoch: 9, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1507885456085205
Epoch: 10, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8835370540618896
Epoch: 11, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 437275
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.97322154045105
Epoch: 1, Steps: 1 | Train Loss: 1.347 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9571638107299805
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8812308311462402
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8484764099121094
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0494966506958008
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.817204475402832
Epoch: 6, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1172316074371338
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1160883903503418
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.993558406829834
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0315308570861816
Epoch: 10, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7811422348022461
Epoch: 11, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8127930164337158
Epoch: 12, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8172464370727539
Epoch: 13, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 433819
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.5977373123168945
Epoch: 1, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6566321849822998
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6398582458496094
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7523050308227539
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9213988780975342
Epoch: 5, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8263654708862305
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7420611381530762
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8615353107452393
Epoch: 8, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9762749671936035
Epoch: 9, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6698260307312012
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7211806774139404
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.082 Vali Acc: 0.200 Test Loss: 1.082 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6086337566375732
Epoch: 12, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.083 Vali Acc: 0.200 Test Loss: 1.083 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 345115
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5557076930999756
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7255997657775879
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6907165050506592
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.4463250637054443
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.101 Vali Acc: 0.133 Test Loss: 1.101 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8171308040618896
Epoch: 5, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.101 Vali Acc: 0.067 Test Loss: 1.101 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8300209045410156
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.101 Vali Acc: 0.067 Test Loss: 1.101 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7917459011077881
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.099 Vali Acc: 0.067 Test Loss: 1.099 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7175238132476807
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8662095069885254
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7493040561676025
Epoch: 10, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9187610149383545
Epoch: 11, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7480049133300781
Epoch: 12, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7755661010742188
Epoch: 13, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 341659
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.623750686645508
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6265978813171387
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.855323076248169
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6517488956451416
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8769245147705078
Epoch: 5, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6376664638519287
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6092908382415771
Epoch: 7, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8004765510559082
Epoch: 8, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.8473682403564453
Epoch: 9, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0199065208435059
Epoch: 10, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8852617740631104
Epoch: 11, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8722968101501465
Epoch: 12, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7024469375610352
Epoch: 13, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8950340747833252
Epoch: 14, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.659928560256958
Epoch: 15, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6803970336914062
Epoch: 16, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7478823661804199
Epoch: 17, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6776916980743408
Epoch: 18, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 338203
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6276485919952393
Epoch: 1, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7893671989440918
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8503997325897217
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8241922855377197
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7220137119293213
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8824374675750732
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8180420398712158
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.975102424621582
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2494769096374512
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6968097686767578
Epoch: 10, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9799916744232178
Epoch: 11, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1355323791503906
Epoch: 12, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.380664348602295
Epoch: 13, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1827054023742676
Epoch: 14, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 334747
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.085951328277588
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.2127821445465088
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.69162917137146
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8127696514129639
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.024986982345581
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8916974067687988
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7388315200805664
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8517088890075684
Epoch: 8, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0661675930023193
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.1053149700164795
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7735438346862793
Epoch: 11, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6410315036773682
Epoch: 12, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9248325824737549
Epoch: 13, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8815007209777832
Epoch: 14, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8296470642089844
Epoch: 15, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9551558494567871
Epoch: 16, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.961514949798584
Epoch: 17, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8082497119903564
Epoch: 18, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.9074916839599609
Epoch: 19, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7808446884155273
Epoch: 20, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6851623058319092
Epoch: 21, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6881427764892578
Epoch: 22, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6955671310424805
Epoch: 23, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9314873218536377
Epoch: 24, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.933783769607544
Epoch: 25, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8682575225830078
Epoch: 26, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.022059679031372
Epoch: 27, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2649216651916504
Epoch: 28, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 295579
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8714096546173096
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0147128105163574
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.714451789855957
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7493317127227783
Epoch: 4, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0514578819274902
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8290879726409912
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9884462356567383
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8178057670593262
Epoch: 8, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8064925670623779
Epoch: 9, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7817871570587158
Epoch: 10, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9619131088256836
Epoch: 11, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8400740623474121
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9102427959442139
Epoch: 13, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 292123
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.570324659347534
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6466138362884521
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.156 Vali Acc: 0.067 Test Loss: 1.156 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7846677303314209
Epoch: 3, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.880239725112915
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8392922878265381
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7946257591247559
Epoch: 6, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7514853477478027
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.985058069229126
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8569295406341553
Epoch: 9, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7605750560760498
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9841337203979492
Epoch: 11, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6587660312652588
Epoch: 12, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9911110401153564
Epoch: 13, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 288667
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5051090717315674
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8207104206085205
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.083 Vali Acc: 0.600 Test Loss: 1.083 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.7782938480377197
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7584552764892578
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8858511447906494
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7159872055053711
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7300131320953369
Epoch: 7, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7840845584869385
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8697731494903564
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8964581489562988
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7803223133087158
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9315645694732666
Epoch: 12, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 285211
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.50439190864563
Epoch: 1, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6649887561798096
Epoch: 2, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7681500911712646
Epoch: 3, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.9112677574157715
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.783715009689331
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8958277702331543
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7952780723571777
Epoch: 7, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5921883583068848
Epoch: 8, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6480212211608887
Epoch: 9, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6596715450286865
Epoch: 10, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.683793306350708
Epoch: 11, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6932339668273926
Epoch: 12, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7420780658721924
Epoch: 13, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 273563
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.638762950897217
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9346141815185547
Epoch: 2, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8951051235198975
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.810187578201294
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9574048519134521
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.88004469871521
Epoch: 6, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2372336387634277
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0873546600341797
Epoch: 8, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0085983276367188
Epoch: 9, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0093803405761719
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6865315437316895
Epoch: 11, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0409774780273438
Epoch: 12, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0002901554107666
Epoch: 13, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 271835
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8010640144348145
Epoch: 1, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8143126964569092
Epoch: 2, Steps: 1 | Train Loss: 1.286 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0046329498291016
Epoch: 3, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6652283668518066
Epoch: 4, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8315067291259766
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0161192417144775
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9883594512939453
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8192238807678223
Epoch: 8, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9043946266174316
Epoch: 9, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.880908727645874
Epoch: 10, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7697460651397705
Epoch: 11, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7103428840637207
Epoch: 12, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0161898136138916
Epoch: 13, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9596154689788818
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.7482447624206543
Epoch: 15, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7848565578460693
Epoch: 16, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9776186943054199
Epoch: 17, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9040646553039551
Epoch: 18, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9117856025695801
Epoch: 19, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.906217098236084
Epoch: 20, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6657004356384277
Epoch: 21, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7680459022521973
Epoch: 22, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7970890998840332
Epoch: 23, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7103016376495361
Epoch: 24, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.938861608505249
Epoch: 25, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 270107
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.726897954940796
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6108677387237549
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.866574764251709
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2744028568267822
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9368381500244141
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0334680080413818
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8198904991149902
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8264007568359375
Epoch: 8, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9666435718536377
Epoch: 9, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0095021724700928
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7969379425048828
Epoch: 11, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6814656257629395
Epoch: 12, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 268379
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.668734550476074
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6929497718811035
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7477962970733643
Epoch: 3, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6753182411193848
Epoch: 4, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6991240978240967
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7386434078216553
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6394040584564209
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7808668613433838
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9415831565856934
Epoch: 9, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9238035678863525
Epoch: 10, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8607192039489746
Epoch: 11, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7699413299560547
Epoch: 12, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8053314685821533
Epoch: 13, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8142216205596924
Epoch: 14, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7879369258880615
Epoch: 15, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6726551055908203
Epoch: 16, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.6082115173339844
Epoch: 17, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.185337781906128
Epoch: 18, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5379142761230469
Epoch: 19, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6229922771453857
Epoch: 20, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9116935729980469
Epoch: 21, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7245984077453613
Epoch: 22, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6239602565765381
Epoch: 23, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8222692012786865
Epoch: 24, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8788330554962158
Epoch: 25, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7222757339477539
Epoch: 26, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 27 cost time: 0.7099406719207764
Epoch: 27, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8303005695343018
Epoch: 28, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7632713317871094
Epoch: 29, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6697530746459961
Epoch: 30, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8482258319854736
Epoch: 31, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8135159015655518
Epoch: 32, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.573122501373291
Epoch: 33, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.838733434677124
Epoch: 34, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9390490055084229
Epoch: 35, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6724839210510254
Epoch: 36, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 173723
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5365209579467773
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6676685810089111
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.556276798248291
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5941555500030518
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6773033142089844
Epoch: 5, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7333290576934814
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6318240165710449
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7086973190307617
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.717883825302124
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7688348293304443
Epoch: 10, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6253259181976318
Epoch: 11, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6743550300598145
Epoch: 12, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.958003044128418
Epoch: 13, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.179 Vali Acc: 0.133 Test Loss: 1.179 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8509042263031006
Epoch: 14, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 171995
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7573089599609375
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7500419616699219
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9860594272613525
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9193730354309082
Epoch: 4, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6449601650238037
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8660438060760498
Epoch: 6, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8147842884063721
Epoch: 7, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8966720104217529
Epoch: 8, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0756902694702148
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7481627464294434
Epoch: 10, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9041228294372559
Epoch: 11, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8383767604827881
Epoch: 12, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0360498428344727
Epoch: 13, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6326572895050049
Epoch: 14, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.858461856842041
Epoch: 15, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8860583305358887
Epoch: 16, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8901171684265137
Epoch: 17, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7283878326416016
Epoch: 18, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8451814651489258
Epoch: 19, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6298918724060059
Epoch: 20, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 170267
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1197242736816406
Epoch: 1, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7417068481445312
Epoch: 2, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6976437568664551
Epoch: 3, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8039932250976562
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9614386558532715
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9588966369628906
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8195116519927979
Epoch: 7, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9376559257507324
Epoch: 8, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8420407772064209
Epoch: 9, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8119256496429443
Epoch: 10, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0070297718048096
Epoch: 11, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8033993244171143
Epoch: 12, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8557324409484863
Epoch: 13, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2192425727844238
Epoch: 14, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 168539
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.740687131881714
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6664206981658936
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.9570403099060059
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7563080787658691
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.00022554397583
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7909927368164062
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7032039165496826
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6828527450561523
Epoch: 8, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7927980422973633
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.7620007991790771
Epoch: 10, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7245128154754639
Epoch: 11, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8316175937652588
Epoch: 12, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7955014705657959
Epoch: 13, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7833409309387207
Epoch: 14, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2944271564483643
Epoch: 15, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8543872833251953
Epoch: 16, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7290554046630859
Epoch: 17, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7944996356964111
Epoch: 18, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.590984582901001
Epoch: 19, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 123803
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0613062381744385
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6241507530212402
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.117 Vali Acc: 0.133 Test Loss: 1.117 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.799699068069458
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7578721046447754
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6159360408782959
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6888482570648193
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7395148277282715
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8441166877746582
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9637420177459717
Epoch: 9, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7433433532714844
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9762167930603027
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.8614161014556885
Epoch: 12, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.6012246608734131
Epoch: 13, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.6333231925964355
Epoch: 14, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6521403789520264
Epoch: 15, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6774797439575195
Epoch: 16, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0300872325897217
Epoch: 17, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.842644214630127
Epoch: 18, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9246475696563721
Epoch: 19, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0863087177276611
Epoch: 20, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9052162170410156
Epoch: 21, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0854065418243408
Epoch: 22, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8754832744598389
Epoch: 23, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 122075
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.052759885787964
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7588729858398438
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0368151664733887
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7635304927825928
Epoch: 4, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8161566257476807
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8824462890625
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0153517723083496
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0293409824371338
Epoch: 8, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.899691104888916
Epoch: 9, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.007673740386963
Epoch: 10, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8106441497802734
Epoch: 11, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8549754619598389
Epoch: 12, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9826531410217285
Epoch: 13, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7510602474212646
Epoch: 14, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 120347
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.054832696914673
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.104416847229004
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.847447395324707
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7822074890136719
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8411190509796143
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7195398807525635
Epoch: 6, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9182891845703125
Epoch: 7, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8955917358398438
Epoch: 8, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9372272491455078
Epoch: 9, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9152581691741943
Epoch: 10, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0035741329193115
Epoch: 11, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9408383369445801
Epoch: 12, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.973315954208374
Epoch: 13, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.146 Vali Acc: 0.067 Test Loss: 1.146 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8325684070587158
Epoch: 14, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.148 Vali Acc: 0.067 Test Loss: 1.148 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8839130401611328
Epoch: 15, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 118619
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.814885139465332
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7346334457397461
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8506515026092529
Epoch: 3, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7658491134643555
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7804903984069824
Epoch: 5, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8272149562835693
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7206568717956543
Epoch: 7, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7525067329406738
Epoch: 8, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9781136512756348
Epoch: 9, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.907149076461792
Epoch: 10, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.763758659362793
Epoch: 11, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8307249546051025
Epoch: 12, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2923328876495361
Epoch: 13, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 98843
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.488178014755249
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7007734775543213
Epoch: 2, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.651557207107544
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8270072937011719
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8898775577545166
Epoch: 5, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.925868034362793
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.8609941005706787
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7456605434417725
Epoch: 8, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7085163593292236
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6314809322357178
Epoch: 10, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7898585796356201
Epoch: 11, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8206608295440674
Epoch: 12, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.140634298324585
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7366104125976562
Epoch: 14, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8444674015045166
Epoch: 15, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.835498571395874
Epoch: 16, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 97115
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.214177131652832
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5519905090332031
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7848105430603027
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6437950134277344
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6189696788787842
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8371224403381348
Epoch: 6, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6793091297149658
Epoch: 7, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7544865608215332
Epoch: 8, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7928714752197266
Epoch: 9, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6718077659606934
Epoch: 10, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7709512710571289
Epoch: 11, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 95387
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.510378360748291
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6374032497406006
Epoch: 2, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8907842636108398
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9426512718200684
Epoch: 4, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9288370609283447
Epoch: 5, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0552589893341064
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7972056865692139
Epoch: 7, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6873021125793457
Epoch: 8, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7325198650360107
Epoch: 9, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8392186164855957
Epoch: 10, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6822586059570312
Epoch: 11, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8928322792053223
Epoch: 12, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_Crossformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 93659
model size : 1.03MB
