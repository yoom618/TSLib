Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 58.80815672874451
Epoch: 1, Steps: 70 | Train Loss: 9.734 Vali Loss: 3.339 Vali Acc: 0.500 Test Loss: 3.339 Test Acc: 0.500
Validation loss decreased (inf --> -0.499967).  Saving model ...
Epoch: 2 cost time: 63.27948188781738
Epoch: 2, Steps: 70 | Train Loss: 9.749 Vali Loss: 3.106 Vali Acc: 0.500 Test Loss: 3.106 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499969).  Saving model ...
Epoch: 3 cost time: 56.16382193565369
Epoch: 3, Steps: 70 | Train Loss: 6.366 Vali Loss: 4.861 Vali Acc: 0.500 Test Loss: 4.861 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 63.063761472702026
Epoch: 4, Steps: 70 | Train Loss: 2.730 Vali Loss: 2.401 Vali Acc: 0.500 Test Loss: 2.401 Test Acc: 0.500
Validation loss decreased (-0.499969 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 62.60816502571106
Epoch: 5, Steps: 70 | Train Loss: 4.126 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
Validation loss decreased (-0.499976 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 58.02363896369934
Epoch: 6, Steps: 70 | Train Loss: 2.834 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 58.53366732597351
Epoch: 7, Steps: 70 | Train Loss: 2.000 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 59.438552141189575
Epoch: 8, Steps: 70 | Train Loss: 2.588 Vali Loss: 6.114 Vali Acc: 0.500 Test Loss: 6.114 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 58.506176471710205
Epoch: 9, Steps: 70 | Train Loss: 6.945 Vali Loss: 7.660 Vali Acc: 0.500 Test Loss: 7.660 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 61.91715335845947
Epoch: 10, Steps: 70 | Train Loss: 5.757 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 49.670692920684814
Epoch: 11, Steps: 70 | Train Loss: 4.700 Vali Loss: 4.412 Vali Acc: 0.500 Test Loss: 4.412 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 58.70078945159912
Epoch: 12, Steps: 70 | Train Loss: 2.885 Vali Loss: 3.263 Vali Acc: 0.500 Test Loss: 3.263 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 61.83600401878357
Epoch: 13, Steps: 70 | Train Loss: 5.411 Vali Loss: 2.099 Vali Acc: 0.500 Test Loss: 2.099 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 56.28268647193909
Epoch: 14, Steps: 70 | Train Loss: 5.691 Vali Loss: 5.472 Vali Acc: 0.500 Test Loss: 5.472 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 55.6664936542511
Epoch: 15, Steps: 70 | Train Loss: 3.543 Vali Loss: 2.207 Vali Acc: 0.500 Test Loss: 2.207 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 58.22309947013855
Epoch: 16, Steps: 70 | Train Loss: 2.627 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 44.681519985198975
Epoch: 17, Steps: 70 | Train Loss: 2.278 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499991).  Saving model ...
Epoch: 18 cost time: 61.10209918022156
Epoch: 18, Steps: 70 | Train Loss: 3.704 Vali Loss: 3.180 Vali Acc: 0.500 Test Loss: 3.180 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 62.43991732597351
Epoch: 19, Steps: 70 | Train Loss: 2.229 Vali Loss: 2.679 Vali Acc: 0.500 Test Loss: 2.679 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 55.718116760253906
Epoch: 20, Steps: 70 | Train Loss: 2.648 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 62.533092975616455
Epoch: 21, Steps: 70 | Train Loss: 2.029 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 22 cost time: 62.52133512496948
Epoch: 22, Steps: 70 | Train Loss: 4.272 Vali Loss: 2.058 Vali Acc: 0.500 Test Loss: 2.058 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 55.78370189666748
Epoch: 23, Steps: 70 | Train Loss: 2.432 Vali Loss: 5.092 Vali Acc: 0.500 Test Loss: 5.092 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 59.37381863594055
Epoch: 24, Steps: 70 | Train Loss: 3.164 Vali Loss: 0.999 Vali Acc: 0.500 Test Loss: 0.999 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 61.3828022480011
Epoch: 25, Steps: 70 | Train Loss: 2.486 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 26 cost time: 55.544835805892944
Epoch: 26, Steps: 70 | Train Loss: 2.080 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 61.63100814819336
Epoch: 27, Steps: 70 | Train Loss: 2.634 Vali Loss: 5.334 Vali Acc: 0.500 Test Loss: 5.334 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 59.6202027797699
Epoch: 28, Steps: 70 | Train Loss: 2.192 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 57.48100185394287
Epoch: 29, Steps: 70 | Train Loss: 1.484 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 53.569265365600586
Epoch: 30, Steps: 70 | Train Loss: 1.342 Vali Loss: 2.157 Vali Acc: 0.500 Test Loss: 2.157 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 57.5984468460083
Epoch: 31, Steps: 70 | Train Loss: 1.379 Vali Loss: 1.864 Vali Acc: 0.500 Test Loss: 1.864 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 57.49814701080322
Epoch: 32, Steps: 70 | Train Loss: 1.313 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 59.931926250457764
Epoch: 33, Steps: 70 | Train Loss: 2.244 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 56.008782148361206
Epoch: 34, Steps: 70 | Train Loss: 1.342 Vali Loss: 3.016 Vali Acc: 0.500 Test Loss: 3.016 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 49.94379162788391
Epoch: 35, Steps: 70 | Train Loss: 1.790 Vali Loss: 4.779 Vali Acc: 0.500 Test Loss: 4.779 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 19877182
model size : 80.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 56.66510534286499
Epoch: 1, Steps: 70 | Train Loss: 7.989 Vali Loss: 18.115 Vali Acc: 0.500 Test Loss: 18.115 Test Acc: 0.500
Validation loss decreased (inf --> -0.499819).  Saving model ...
Epoch: 2 cost time: 49.684590101242065
Epoch: 2, Steps: 70 | Train Loss: 8.714 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
Validation loss decreased (-0.499819 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 49.903712034225464
Epoch: 3, Steps: 70 | Train Loss: 3.360 Vali Loss: 11.564 Vali Acc: 0.500 Test Loss: 11.564 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 57.59658646583557
Epoch: 4, Steps: 70 | Train Loss: 4.899 Vali Loss: 3.234 Vali Acc: 0.500 Test Loss: 3.234 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 54.34663224220276
Epoch: 5, Steps: 70 | Train Loss: 3.470 Vali Loss: 4.321 Vali Acc: 0.500 Test Loss: 4.321 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 58.62444090843201
Epoch: 6, Steps: 70 | Train Loss: 5.338 Vali Loss: 4.488 Vali Acc: 0.500 Test Loss: 4.488 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 55.088969707489014
Epoch: 7, Steps: 70 | Train Loss: 3.498 Vali Loss: 4.041 Vali Acc: 0.500 Test Loss: 4.041 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 59.12575888633728
Epoch: 8, Steps: 70 | Train Loss: 5.571 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499991).  Saving model ...
Epoch: 9 cost time: 58.29595136642456
Epoch: 9, Steps: 70 | Train Loss: 3.973 Vali Loss: 2.200 Vali Acc: 0.500 Test Loss: 2.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 46.81426382064819
Epoch: 10, Steps: 70 | Train Loss: 2.737 Vali Loss: 6.571 Vali Acc: 0.500 Test Loss: 6.571 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 58.640777826309204
Epoch: 11, Steps: 70 | Train Loss: 3.980 Vali Loss: 9.420 Vali Acc: 0.500 Test Loss: 9.420 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 51.47013807296753
Epoch: 12, Steps: 70 | Train Loss: 3.949 Vali Loss: 4.287 Vali Acc: 0.500 Test Loss: 4.287 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 57.54365801811218
Epoch: 13, Steps: 70 | Train Loss: 3.738 Vali Loss: 2.333 Vali Acc: 0.500 Test Loss: 2.333 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 54.998709201812744
Epoch: 14, Steps: 70 | Train Loss: 2.320 Vali Loss: 2.785 Vali Acc: 0.500 Test Loss: 2.785 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 49.71887683868408
Epoch: 15, Steps: 70 | Train Loss: 3.207 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 55.9751763343811
Epoch: 16, Steps: 70 | Train Loss: 3.481 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 48.237279653549194
Epoch: 17, Steps: 70 | Train Loss: 4.759 Vali Loss: 1.476 Vali Acc: 0.500 Test Loss: 1.476 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 54.97043228149414
Epoch: 18, Steps: 70 | Train Loss: 3.434 Vali Loss: 3.640 Vali Acc: 0.500 Test Loss: 3.640 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 19756862
model size : 80.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 59.25204277038574
Epoch: 1, Steps: 70 | Train Loss: 6.316 Vali Loss: 11.623 Vali Acc: 0.500 Test Loss: 11.623 Test Acc: 0.500
Validation loss decreased (inf --> -0.499884).  Saving model ...
Epoch: 2 cost time: 60.1393141746521
Epoch: 2, Steps: 70 | Train Loss: 5.907 Vali Loss: 6.783 Vali Acc: 0.500 Test Loss: 6.783 Test Acc: 0.500
Validation loss decreased (-0.499884 --> -0.499932).  Saving model ...
Epoch: 3 cost time: 58.9965341091156
Epoch: 3, Steps: 70 | Train Loss: 4.507 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
Validation loss decreased (-0.499932 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 62.42080283164978
Epoch: 4, Steps: 70 | Train Loss: 4.210 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 57.45515418052673
Epoch: 5, Steps: 70 | Train Loss: 4.703 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 63.273940324783325
Epoch: 6, Steps: 70 | Train Loss: 3.898 Vali Loss: 10.716 Vali Acc: 0.500 Test Loss: 10.716 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 58.68683934211731
Epoch: 7, Steps: 70 | Train Loss: 3.117 Vali Loss: 2.126 Vali Acc: 0.500 Test Loss: 2.126 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 60.38248038291931
Epoch: 8, Steps: 70 | Train Loss: 2.733 Vali Loss: 2.138 Vali Acc: 0.500 Test Loss: 2.138 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 61.19934582710266
Epoch: 9, Steps: 70 | Train Loss: 2.759 Vali Loss: 11.496 Vali Acc: 0.500 Test Loss: 11.496 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 58.095144748687744
Epoch: 10, Steps: 70 | Train Loss: 4.840 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 61.22137951850891
Epoch: 11, Steps: 70 | Train Loss: 3.706 Vali Loss: 6.862 Vali Acc: 0.500 Test Loss: 6.862 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 54.868090867996216
Epoch: 12, Steps: 70 | Train Loss: 4.773 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 62.08983826637268
Epoch: 13, Steps: 70 | Train Loss: 2.659 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 58.666903018951416
Epoch: 14, Steps: 70 | Train Loss: 3.663 Vali Loss: 8.138 Vali Acc: 0.500 Test Loss: 8.138 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 51.68813109397888
Epoch: 15, Steps: 70 | Train Loss: 3.244 Vali Loss: 1.597 Vali Acc: 0.500 Test Loss: 1.597 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 19636542
model size : 79.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 55.44486165046692
Epoch: 1, Steps: 70 | Train Loss: 5.932 Vali Loss: 6.196 Vali Acc: 0.510 Test Loss: 6.196 Test Acc: 0.510
Validation loss decreased (inf --> -0.509938).  Saving model ...
Epoch: 2 cost time: 60.09079909324646
Epoch: 2, Steps: 70 | Train Loss: 2.943 Vali Loss: 4.409 Vali Acc: 0.500 Test Loss: 4.409 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 58.176939487457275
Epoch: 3, Steps: 70 | Train Loss: 3.075 Vali Loss: 5.964 Vali Acc: 0.500 Test Loss: 5.964 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 55.27993822097778
Epoch: 4, Steps: 70 | Train Loss: 3.981 Vali Loss: 1.808 Vali Acc: 0.500 Test Loss: 1.808 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 50.33394980430603
Epoch: 5, Steps: 70 | Train Loss: 4.370 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 51.601189851760864
Epoch: 6, Steps: 70 | Train Loss: 2.982 Vali Loss: 3.313 Vali Acc: 0.500 Test Loss: 3.313 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 45.93988847732544
Epoch: 7, Steps: 70 | Train Loss: 4.160 Vali Loss: 3.426 Vali Acc: 0.500 Test Loss: 3.426 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 54.476404666900635
Epoch: 8, Steps: 70 | Train Loss: 4.008 Vali Loss: 3.039 Vali Acc: 0.500 Test Loss: 3.039 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 38.26908826828003
Epoch: 9, Steps: 70 | Train Loss: 4.313 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 57.02159404754639
Epoch: 10, Steps: 70 | Train Loss: 3.888 Vali Loss: 5.890 Vali Acc: 0.500 Test Loss: 5.890 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 50.52338933944702
Epoch: 11, Steps: 70 | Train Loss: 3.683 Vali Loss: 0.927 Vali Acc: 0.500 Test Loss: 0.927 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 19516222
model size : 79.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 52.51508641242981
Epoch: 1, Steps: 70 | Train Loss: 5.339 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 53.44246029853821
Epoch: 2, Steps: 70 | Train Loss: 5.782 Vali Loss: 6.366 Vali Acc: 0.500 Test Loss: 6.366 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.182021141052246
Epoch: 3, Steps: 70 | Train Loss: 4.932 Vali Loss: 4.821 Vali Acc: 0.500 Test Loss: 4.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 52.93165564537048
Epoch: 4, Steps: 70 | Train Loss: 2.904 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 52.78722667694092
Epoch: 5, Steps: 70 | Train Loss: 2.633 Vali Loss: 5.031 Vali Acc: 0.500 Test Loss: 5.031 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 46.88306474685669
Epoch: 6, Steps: 70 | Train Loss: 5.931 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 52.15455865859985
Epoch: 7, Steps: 70 | Train Loss: 4.053 Vali Loss: 1.770 Vali Acc: 0.500 Test Loss: 1.770 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 52.75780892372131
Epoch: 8, Steps: 70 | Train Loss: 3.843 Vali Loss: 12.359 Vali Acc: 0.500 Test Loss: 12.359 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 53.63636779785156
Epoch: 9, Steps: 70 | Train Loss: 5.107 Vali Loss: 8.097 Vali Acc: 0.500 Test Loss: 8.097 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 53.729198694229126
Epoch: 10, Steps: 70 | Train Loss: 2.965 Vali Loss: 5.135 Vali Acc: 0.500 Test Loss: 5.135 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 53.13122916221619
Epoch: 11, Steps: 70 | Train Loss: 3.636 Vali Loss: 3.157 Vali Acc: 0.500 Test Loss: 3.157 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 42.54845929145813
Epoch: 12, Steps: 70 | Train Loss: 4.902 Vali Loss: 3.811 Vali Acc: 0.500 Test Loss: 3.811 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 51.72221064567566
Epoch: 13, Steps: 70 | Train Loss: 6.267 Vali Loss: 7.505 Vali Acc: 0.500 Test Loss: 7.505 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 50.19330024719238
Epoch: 14, Steps: 70 | Train Loss: 3.966 Vali Loss: 5.959 Vali Acc: 0.500 Test Loss: 5.959 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 17513278
model size : 71.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 45.65088939666748
Epoch: 1, Steps: 70 | Train Loss: 9.444 Vali Loss: 7.006 Vali Acc: 0.500 Test Loss: 7.006 Test Acc: 0.500
Validation loss decreased (inf --> -0.499930).  Saving model ...
Epoch: 2 cost time: 42.82969808578491
Epoch: 2, Steps: 70 | Train Loss: 2.617 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
Validation loss decreased (-0.499930 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 41.48569083213806
Epoch: 3, Steps: 70 | Train Loss: 3.452 Vali Loss: 2.175 Vali Acc: 0.500 Test Loss: 2.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 49.267032623291016
Epoch: 4, Steps: 70 | Train Loss: 4.385 Vali Loss: 2.186 Vali Acc: 0.500 Test Loss: 2.186 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 43.77343535423279
Epoch: 5, Steps: 70 | Train Loss: 3.268 Vali Loss: 5.770 Vali Acc: 0.500 Test Loss: 5.770 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 43.205568075180054
Epoch: 6, Steps: 70 | Train Loss: 4.171 Vali Loss: 4.628 Vali Acc: 0.500 Test Loss: 4.628 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 48.13901448249817
Epoch: 7, Steps: 70 | Train Loss: 4.521 Vali Loss: 1.340 Vali Acc: 0.500 Test Loss: 1.340 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 51.85617256164551
Epoch: 8, Steps: 70 | Train Loss: 2.561 Vali Loss: 4.073 Vali Acc: 0.500 Test Loss: 4.073 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 48.57994341850281
Epoch: 9, Steps: 70 | Train Loss: 2.919 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 42.22649312019348
Epoch: 10, Steps: 70 | Train Loss: 3.344 Vali Loss: 7.005 Vali Acc: 0.500 Test Loss: 7.005 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 43.677042722702026
Epoch: 11, Steps: 70 | Train Loss: 3.927 Vali Loss: 3.012 Vali Acc: 0.500 Test Loss: 3.012 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 47.93436527252197
Epoch: 12, Steps: 70 | Train Loss: 4.767 Vali Loss: 2.382 Vali Acc: 0.500 Test Loss: 2.382 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 44.511834144592285
Epoch: 13, Steps: 70 | Train Loss: 3.448 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 47.103317975997925
Epoch: 14, Steps: 70 | Train Loss: 2.321 Vali Loss: 0.997 Vali Acc: 0.500 Test Loss: 0.997 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499990).  Saving model ...
Epoch: 15 cost time: 34.88623380661011
Epoch: 15, Steps: 70 | Train Loss: 3.113 Vali Loss: 3.702 Vali Acc: 0.500 Test Loss: 3.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 44.73307752609253
Epoch: 16, Steps: 70 | Train Loss: 4.100 Vali Loss: 9.226 Vali Acc: 0.500 Test Loss: 9.226 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 43.75525498390198
Epoch: 17, Steps: 70 | Train Loss: 4.885 Vali Loss: 3.400 Vali Acc: 0.500 Test Loss: 3.400 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 47.60128664970398
Epoch: 18, Steps: 70 | Train Loss: 2.372 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499992).  Saving model ...
Epoch: 19 cost time: 38.79959535598755
Epoch: 19, Steps: 70 | Train Loss: 2.707 Vali Loss: 2.435 Vali Acc: 0.500 Test Loss: 2.435 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 40.069769620895386
Epoch: 20, Steps: 70 | Train Loss: 2.332 Vali Loss: 4.407 Vali Acc: 0.500 Test Loss: 4.407 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 41.03494906425476
Epoch: 21, Steps: 70 | Train Loss: 6.896 Vali Loss: 8.263 Vali Acc: 0.500 Test Loss: 8.263 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 47.84618258476257
Epoch: 22, Steps: 70 | Train Loss: 13.839 Vali Loss: 7.260 Vali Acc: 0.500 Test Loss: 7.260 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 43.15374827384949
Epoch: 23, Steps: 70 | Train Loss: 6.924 Vali Loss: 10.163 Vali Acc: 0.500 Test Loss: 10.163 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 45.40579319000244
Epoch: 24, Steps: 70 | Train Loss: 6.147 Vali Loss: 2.883 Vali Acc: 0.500 Test Loss: 2.883 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 37.63253355026245
Epoch: 25, Steps: 70 | Train Loss: 5.423 Vali Loss: 8.882 Vali Acc: 0.500 Test Loss: 8.882 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 42.7491295337677
Epoch: 26, Steps: 70 | Train Loss: 4.460 Vali Loss: 5.202 Vali Acc: 0.500 Test Loss: 5.202 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 45.05099034309387
Epoch: 27, Steps: 70 | Train Loss: 3.220 Vali Loss: 1.860 Vali Acc: 0.500 Test Loss: 1.860 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 39.30393385887146
Epoch: 28, Steps: 70 | Train Loss: 2.440 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 17392958
model size : 71.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 43.8692421913147
Epoch: 1, Steps: 70 | Train Loss: 6.383 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 38.24111080169678
Epoch: 2, Steps: 70 | Train Loss: 5.969 Vali Loss: 4.287 Vali Acc: 0.500 Test Loss: 4.287 Test Acc: 0.500
Validation loss decreased (-0.489990 --> -0.499957).  Saving model ...
Epoch: 3 cost time: 37.03142023086548
Epoch: 3, Steps: 70 | Train Loss: 4.746 Vali Loss: 7.118 Vali Acc: 0.500 Test Loss: 7.118 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 39.26621770858765
Epoch: 4, Steps: 70 | Train Loss: 3.014 Vali Loss: 6.197 Vali Acc: 0.500 Test Loss: 6.197 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 51.897034883499146
Epoch: 5, Steps: 70 | Train Loss: 4.455 Vali Loss: 0.784 Vali Acc: 0.430 Test Loss: 0.784 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 46.852274656295776
Epoch: 6, Steps: 70 | Train Loss: 2.564 Vali Loss: 1.435 Vali Acc: 0.500 Test Loss: 1.435 Test Acc: 0.500
Validation loss decreased (-0.499957 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 47.92902898788452
Epoch: 7, Steps: 70 | Train Loss: 3.828 Vali Loss: 5.031 Vali Acc: 0.500 Test Loss: 5.031 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 52.02118110656738
Epoch: 8, Steps: 70 | Train Loss: 4.355 Vali Loss: 1.722 Vali Acc: 0.500 Test Loss: 1.722 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.81092548370361
Epoch: 9, Steps: 70 | Train Loss: 3.250 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 48.433544874191284
Epoch: 10, Steps: 70 | Train Loss: 2.562 Vali Loss: 9.589 Vali Acc: 0.500 Test Loss: 9.589 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 52.89342951774597
Epoch: 11, Steps: 70 | Train Loss: 3.848 Vali Loss: 1.639 Vali Acc: 0.500 Test Loss: 1.639 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 42.88018083572388
Epoch: 12, Steps: 70 | Train Loss: 4.111 Vali Loss: 5.821 Vali Acc: 0.500 Test Loss: 5.821 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 46.710110902786255
Epoch: 13, Steps: 70 | Train Loss: 5.709 Vali Loss: 3.406 Vali Acc: 0.500 Test Loss: 3.406 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 44.888599157333374
Epoch: 14, Steps: 70 | Train Loss: 5.496 Vali Loss: 6.297 Vali Acc: 0.500 Test Loss: 6.297 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 52.81324505805969
Epoch: 15, Steps: 70 | Train Loss: 4.830 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 46.92856502532959
Epoch: 16, Steps: 70 | Train Loss: 4.680 Vali Loss: 8.457 Vali Acc: 0.500 Test Loss: 8.457 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 52.99468398094177
Epoch: 17, Steps: 70 | Train Loss: 4.505 Vali Loss: 4.690 Vali Acc: 0.500 Test Loss: 4.690 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 51.68273162841797
Epoch: 18, Steps: 70 | Train Loss: 4.008 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499992).  Saving model ...
Epoch: 19 cost time: 41.6951208114624
Epoch: 19, Steps: 70 | Train Loss: 2.795 Vali Loss: 3.934 Vali Acc: 0.500 Test Loss: 3.934 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 49.89445877075195
Epoch: 20, Steps: 70 | Train Loss: 2.316 Vali Loss: 1.934 Vali Acc: 0.500 Test Loss: 1.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 46.91124773025513
Epoch: 21, Steps: 70 | Train Loss: 2.533 Vali Loss: 2.661 Vali Acc: 0.500 Test Loss: 2.661 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 51.05089616775513
Epoch: 22, Steps: 70 | Train Loss: 5.162 Vali Loss: 3.201 Vali Acc: 0.500 Test Loss: 3.201 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 52.059115409851074
Epoch: 23, Steps: 70 | Train Loss: 3.714 Vali Loss: 53.797 Vali Acc: 0.500 Test Loss: 53.797 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 45.42832398414612
Epoch: 24, Steps: 70 | Train Loss: 7.479 Vali Loss: 6.830 Vali Acc: 0.500 Test Loss: 6.830 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 44.01753520965576
Epoch: 25, Steps: 70 | Train Loss: 6.606 Vali Loss: 2.094 Vali Acc: 0.500 Test Loss: 2.094 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 42.807825803756714
Epoch: 26, Steps: 70 | Train Loss: 5.260 Vali Loss: 1.995 Vali Acc: 0.500 Test Loss: 1.995 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 45.374709129333496
Epoch: 27, Steps: 70 | Train Loss: 8.510 Vali Loss: 11.173 Vali Acc: 0.500 Test Loss: 11.173 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 42.32797861099243
Epoch: 28, Steps: 70 | Train Loss: 5.829 Vali Loss: 7.428 Vali Acc: 0.500 Test Loss: 7.428 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 17272638
model size : 70.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 52.75356149673462
Epoch: 1, Steps: 70 | Train Loss: 4.705 Vali Loss: 5.466 Vali Acc: 0.540 Test Loss: 5.466 Test Acc: 0.540
Validation loss decreased (inf --> -0.539945).  Saving model ...
Epoch: 2 cost time: 51.5845901966095
Epoch: 2, Steps: 70 | Train Loss: 4.576 Vali Loss: 1.923 Vali Acc: 0.510 Test Loss: 1.923 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 46.53095769882202
Epoch: 3, Steps: 70 | Train Loss: 3.539 Vali Loss: 7.528 Vali Acc: 0.500 Test Loss: 7.528 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 51.87697100639343
Epoch: 4, Steps: 70 | Train Loss: 2.563 Vali Loss: 0.888 Vali Acc: 0.500 Test Loss: 0.888 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 45.57297706604004
Epoch: 5, Steps: 70 | Train Loss: 2.782 Vali Loss: 6.767 Vali Acc: 0.500 Test Loss: 6.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 44.72063326835632
Epoch: 6, Steps: 70 | Train Loss: 2.640 Vali Loss: 6.136 Vali Acc: 0.500 Test Loss: 6.136 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 48.40491604804993
Epoch: 7, Steps: 70 | Train Loss: 3.957 Vali Loss: 7.775 Vali Acc: 0.500 Test Loss: 7.775 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 41.867610692977905
Epoch: 8, Steps: 70 | Train Loss: 3.849 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 39.86918759346008
Epoch: 9, Steps: 70 | Train Loss: 4.767 Vali Loss: 2.197 Vali Acc: 0.500 Test Loss: 2.197 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 46.641876459121704
Epoch: 10, Steps: 70 | Train Loss: 3.799 Vali Loss: 2.992 Vali Acc: 0.500 Test Loss: 2.992 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 35.539865493774414
Epoch: 11, Steps: 70 | Train Loss: 2.970 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 17152318
model size : 70.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 39.18256092071533
Epoch: 1, Steps: 70 | Train Loss: 8.066 Vali Loss: 7.104 Vali Acc: 0.500 Test Loss: 7.104 Test Acc: 0.500
Validation loss decreased (inf --> -0.499929).  Saving model ...
Epoch: 2 cost time: 45.12483286857605
Epoch: 2, Steps: 70 | Train Loss: 5.178 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
Validation loss decreased (-0.499929 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 48.96115255355835
Epoch: 3, Steps: 70 | Train Loss: 2.234 Vali Loss: 0.870 Vali Acc: 0.420 Test Loss: 0.870 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.439621686935425
Epoch: 4, Steps: 70 | Train Loss: 3.164 Vali Loss: 6.676 Vali Acc: 0.500 Test Loss: 6.676 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 48.104355573654175
Epoch: 5, Steps: 70 | Train Loss: 2.547 Vali Loss: 2.755 Vali Acc: 0.500 Test Loss: 2.755 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 38.67994451522827
Epoch: 6, Steps: 70 | Train Loss: 2.878 Vali Loss: 7.591 Vali Acc: 0.500 Test Loss: 7.591 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 40.76855731010437
Epoch: 7, Steps: 70 | Train Loss: 2.963 Vali Loss: 2.019 Vali Acc: 0.500 Test Loss: 2.019 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.951613664627075
Epoch: 8, Steps: 70 | Train Loss: 4.217 Vali Loss: 4.458 Vali Acc: 0.500 Test Loss: 4.458 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 45.14880108833313
Epoch: 9, Steps: 70 | Train Loss: 2.353 Vali Loss: 0.955 Vali Acc: 0.500 Test Loss: 0.955 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 33.957924604415894
Epoch: 10, Steps: 70 | Train Loss: 2.332 Vali Loss: 2.113 Vali Acc: 0.500 Test Loss: 2.113 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 45.381109952926636
Epoch: 11, Steps: 70 | Train Loss: 3.772 Vali Loss: 11.360 Vali Acc: 0.500 Test Loss: 11.360 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 42.303064584732056
Epoch: 12, Steps: 70 | Train Loss: 3.731 Vali Loss: 4.411 Vali Acc: 0.500 Test Loss: 4.411 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 16331326
model size : 67.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 37.85937571525574
Epoch: 1, Steps: 70 | Train Loss: 5.804 Vali Loss: 5.470 Vali Acc: 0.570 Test Loss: 5.470 Test Acc: 0.570
Validation loss decreased (inf --> -0.569945).  Saving model ...
Epoch: 2 cost time: 37.13251972198486
Epoch: 2, Steps: 70 | Train Loss: 7.230 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.118128776550293
Epoch: 3, Steps: 70 | Train Loss: 3.908 Vali Loss: 2.924 Vali Acc: 0.500 Test Loss: 2.924 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 41.54606604576111
Epoch: 4, Steps: 70 | Train Loss: 4.856 Vali Loss: 3.091 Vali Acc: 0.500 Test Loss: 3.091 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 44.50598955154419
Epoch: 5, Steps: 70 | Train Loss: 3.162 Vali Loss: 5.815 Vali Acc: 0.500 Test Loss: 5.815 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 31.824886322021484
Epoch: 6, Steps: 70 | Train Loss: 3.455 Vali Loss: 7.965 Vali Acc: 0.500 Test Loss: 7.965 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 43.85448360443115
Epoch: 7, Steps: 70 | Train Loss: 6.499 Vali Loss: 2.871 Vali Acc: 0.500 Test Loss: 2.871 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 33.253934144973755
Epoch: 8, Steps: 70 | Train Loss: 2.256 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 40.518917083740234
Epoch: 9, Steps: 70 | Train Loss: 2.148 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 34.94906139373779
Epoch: 10, Steps: 70 | Train Loss: 2.333 Vali Loss: 3.885 Vali Acc: 0.500 Test Loss: 3.885 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 37.02152466773987
Epoch: 11, Steps: 70 | Train Loss: 1.978 Vali Loss: 4.792 Vali Acc: 0.500 Test Loss: 4.792 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 16211006
model size : 66.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 48.99062657356262
Epoch: 1, Steps: 70 | Train Loss: 4.621 Vali Loss: 2.631 Vali Acc: 0.490 Test Loss: 2.631 Test Acc: 0.490
Validation loss decreased (inf --> -0.489974).  Saving model ...
Epoch: 2 cost time: 52.759316205978394
Epoch: 2, Steps: 70 | Train Loss: 3.719 Vali Loss: 4.205 Vali Acc: 0.500 Test Loss: 4.205 Test Acc: 0.500
Validation loss decreased (-0.489974 --> -0.499958).  Saving model ...
Epoch: 3 cost time: 47.89720416069031
Epoch: 3, Steps: 70 | Train Loss: 4.514 Vali Loss: 1.972 Vali Acc: 0.500 Test Loss: 1.972 Test Acc: 0.500
Validation loss decreased (-0.499958 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 52.470033168792725
Epoch: 4, Steps: 70 | Train Loss: 5.304 Vali Loss: 3.147 Vali Acc: 0.500 Test Loss: 3.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 45.50130271911621
Epoch: 5, Steps: 70 | Train Loss: 3.816 Vali Loss: 4.587 Vali Acc: 0.500 Test Loss: 4.587 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 51.53592348098755
Epoch: 6, Steps: 70 | Train Loss: 3.834 Vali Loss: 6.837 Vali Acc: 0.500 Test Loss: 6.837 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 48.35640549659729
Epoch: 7, Steps: 70 | Train Loss: 3.439 Vali Loss: 5.085 Vali Acc: 0.500 Test Loss: 5.085 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 52.420278549194336
Epoch: 8, Steps: 70 | Train Loss: 2.926 Vali Loss: 4.218 Vali Acc: 0.500 Test Loss: 4.218 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 49.98881554603577
Epoch: 9, Steps: 70 | Train Loss: 3.039 Vali Loss: 2.901 Vali Acc: 0.500 Test Loss: 2.901 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 41.11486005783081
Epoch: 10, Steps: 70 | Train Loss: 2.956 Vali Loss: 3.524 Vali Acc: 0.500 Test Loss: 3.524 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 51.48497700691223
Epoch: 11, Steps: 70 | Train Loss: 3.427 Vali Loss: 6.429 Vali Acc: 0.500 Test Loss: 6.429 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 46.727885246276855
Epoch: 12, Steps: 70 | Train Loss: 3.181 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499992).  Saving model ...
Epoch: 13 cost time: 51.12668538093567
Epoch: 13, Steps: 70 | Train Loss: 2.447 Vali Loss: 2.513 Vali Acc: 0.500 Test Loss: 2.513 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 44.012311697006226
Epoch: 14, Steps: 70 | Train Loss: 2.354 Vali Loss: 1.679 Vali Acc: 0.500 Test Loss: 1.679 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 51.55526542663574
Epoch: 15, Steps: 70 | Train Loss: 3.920 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 46.20282793045044
Epoch: 16, Steps: 70 | Train Loss: 4.082 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 51.1428382396698
Epoch: 17, Steps: 70 | Train Loss: 6.821 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 37.662845849990845
Epoch: 18, Steps: 70 | Train Loss: 5.920 Vali Loss: 3.930 Vali Acc: 0.500 Test Loss: 3.930 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 48.21032786369324
Epoch: 19, Steps: 70 | Train Loss: 9.776 Vali Loss: 10.930 Vali Acc: 0.500 Test Loss: 10.930 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 48.73933005332947
Epoch: 20, Steps: 70 | Train Loss: 5.701 Vali Loss: 8.819 Vali Acc: 0.500 Test Loss: 8.819 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 46.692930698394775
Epoch: 21, Steps: 70 | Train Loss: 4.506 Vali Loss: 5.873 Vali Acc: 0.500 Test Loss: 5.873 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 49.3799409866333
Epoch: 22, Steps: 70 | Train Loss: 2.779 Vali Loss: 4.981 Vali Acc: 0.500 Test Loss: 4.981 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 16090686
model size : 66.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 49.78797674179077
Epoch: 1, Steps: 70 | Train Loss: 6.915 Vali Loss: 12.804 Vali Acc: 0.510 Test Loss: 12.804 Test Acc: 0.510
Validation loss decreased (inf --> -0.509872).  Saving model ...
Epoch: 2 cost time: 37.61248302459717
Epoch: 2, Steps: 70 | Train Loss: 13.733 Vali Loss: 4.268 Vali Acc: 0.450 Test Loss: 4.268 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 42.915146827697754
Epoch: 3, Steps: 70 | Train Loss: 3.030 Vali Loss: 2.072 Vali Acc: 0.500 Test Loss: 2.072 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 40.351969480514526
Epoch: 4, Steps: 70 | Train Loss: 2.406 Vali Loss: 8.335 Vali Acc: 0.500 Test Loss: 8.335 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 35.427823543548584
Epoch: 5, Steps: 70 | Train Loss: 5.168 Vali Loss: 4.376 Vali Acc: 0.500 Test Loss: 4.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 36.40016150474548
Epoch: 6, Steps: 70 | Train Loss: 3.345 Vali Loss: 6.279 Vali Acc: 0.500 Test Loss: 6.279 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 42.19764232635498
Epoch: 7, Steps: 70 | Train Loss: 2.726 Vali Loss: 3.576 Vali Acc: 0.500 Test Loss: 3.576 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 44.82717704772949
Epoch: 8, Steps: 70 | Train Loss: 2.619 Vali Loss: 6.683 Vali Acc: 0.500 Test Loss: 6.683 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 42.0169951915741
Epoch: 9, Steps: 70 | Train Loss: 4.153 Vali Loss: 4.009 Vali Acc: 0.500 Test Loss: 4.009 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 45.53814482688904
Epoch: 10, Steps: 70 | Train Loss: 2.687 Vali Loss: 2.893 Vali Acc: 0.500 Test Loss: 2.893 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 41.264511823654175
Epoch: 11, Steps: 70 | Train Loss: 6.650 Vali Loss: 4.615 Vali Acc: 0.500 Test Loss: 4.615 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 15970366
model size : 66.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 43.618635177612305
Epoch: 1, Steps: 70 | Train Loss: 3.767 Vali Loss: 6.839 Vali Acc: 0.500 Test Loss: 6.839 Test Acc: 0.500
Validation loss decreased (inf --> -0.499932).  Saving model ...
Epoch: 2 cost time: 46.69724225997925
Epoch: 2, Steps: 70 | Train Loss: 7.226 Vali Loss: 7.612 Vali Acc: 0.500 Test Loss: 7.612 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 41.2937171459198
Epoch: 3, Steps: 70 | Train Loss: 2.988 Vali Loss: 2.789 Vali Acc: 0.500 Test Loss: 2.789 Test Acc: 0.500
Validation loss decreased (-0.499932 --> -0.499972).  Saving model ...
Epoch: 4 cost time: 46.139466524124146
Epoch: 4, Steps: 70 | Train Loss: 2.727 Vali Loss: 2.225 Vali Acc: 0.500 Test Loss: 2.225 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499978).  Saving model ...
Epoch: 5 cost time: 38.35004758834839
Epoch: 5, Steps: 70 | Train Loss: 2.150 Vali Loss: 2.677 Vali Acc: 0.500 Test Loss: 2.677 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 46.83252143859863
Epoch: 6, Steps: 70 | Train Loss: 2.562 Vali Loss: 2.352 Vali Acc: 0.500 Test Loss: 2.352 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 43.067392349243164
Epoch: 7, Steps: 70 | Train Loss: 3.734 Vali Loss: 8.198 Vali Acc: 0.500 Test Loss: 8.198 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 35.70165538787842
Epoch: 8, Steps: 70 | Train Loss: 5.494 Vali Loss: 2.430 Vali Acc: 0.500 Test Loss: 2.430 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 39.8365375995636
Epoch: 9, Steps: 70 | Train Loss: 3.968 Vali Loss: 3.226 Vali Acc: 0.500 Test Loss: 3.226 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 41.83829212188721
Epoch: 10, Steps: 70 | Train Loss: 3.680 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
Validation loss decreased (-0.499978 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 38.840121030807495
Epoch: 11, Steps: 70 | Train Loss: 3.224 Vali Loss: 3.636 Vali Acc: 0.500 Test Loss: 3.636 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 36.34164071083069
Epoch: 12, Steps: 70 | Train Loss: 3.892 Vali Loss: 3.654 Vali Acc: 0.500 Test Loss: 3.654 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 35.577136516571045
Epoch: 13, Steps: 70 | Train Loss: 2.808 Vali Loss: 5.036 Vali Acc: 0.500 Test Loss: 5.036 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 41.42601823806763
Epoch: 14, Steps: 70 | Train Loss: 2.959 Vali Loss: 5.262 Vali Acc: 0.500 Test Loss: 5.262 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 44.46246671676636
Epoch: 15, Steps: 70 | Train Loss: 3.654 Vali Loss: 6.575 Vali Acc: 0.500 Test Loss: 6.575 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 41.29119324684143
Epoch: 16, Steps: 70 | Train Loss: 4.264 Vali Loss: 1.613 Vali Acc: 0.500 Test Loss: 1.613 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 35.574859857559204
Epoch: 17, Steps: 70 | Train Loss: 2.327 Vali Loss: 3.417 Vali Acc: 0.500 Test Loss: 3.417 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 37.54150700569153
Epoch: 18, Steps: 70 | Train Loss: 2.415 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 42.86198091506958
Epoch: 19, Steps: 70 | Train Loss: 1.693 Vali Loss: 4.003 Vali Acc: 0.500 Test Loss: 4.003 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 36.92203330993652
Epoch: 20, Steps: 70 | Train Loss: 4.929 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499990).  Saving model ...
Epoch: 21 cost time: 34.49461627006531
Epoch: 21, Steps: 70 | Train Loss: 4.062 Vali Loss: 2.174 Vali Acc: 0.500 Test Loss: 2.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 34.64417862892151
Epoch: 22, Steps: 70 | Train Loss: 2.401 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499992).  Saving model ...
Epoch: 23 cost time: 40.215951681137085
Epoch: 23, Steps: 70 | Train Loss: 2.177 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 24 cost time: 26.69408082962036
Epoch: 24, Steps: 70 | Train Loss: 2.461 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 36.23378109931946
Epoch: 25, Steps: 70 | Train Loss: 1.664 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 30.21595549583435
Epoch: 26, Steps: 70 | Train Loss: 1.830 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 39.062488079071045
Epoch: 27, Steps: 70 | Train Loss: 8.277 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 35.372950315475464
Epoch: 28, Steps: 70 | Train Loss: 3.100 Vali Loss: 3.985 Vali Acc: 0.500 Test Loss: 3.985 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 40.10784935951233
Epoch: 29, Steps: 70 | Train Loss: 3.485 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 28.319596529006958
Epoch: 30, Steps: 70 | Train Loss: 3.717 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 39.36178231239319
Epoch: 31, Steps: 70 | Train Loss: 2.623 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 35.10443329811096
Epoch: 32, Steps: 70 | Train Loss: 3.367 Vali Loss: 2.637 Vali Acc: 0.500 Test Loss: 2.637 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 37.12572002410889
Epoch: 33, Steps: 70 | Train Loss: 2.095 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15740350
model size : 65.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 37.126782178878784
Epoch: 1, Steps: 70 | Train Loss: 4.592 Vali Loss: 11.554 Vali Acc: 0.500 Test Loss: 11.554 Test Acc: 0.500
Validation loss decreased (inf --> -0.499884).  Saving model ...
Epoch: 2 cost time: 32.35345101356506
Epoch: 2, Steps: 70 | Train Loss: 8.713 Vali Loss: 9.697 Vali Acc: 0.500 Test Loss: 9.697 Test Acc: 0.500
Validation loss decreased (-0.499884 --> -0.499903).  Saving model ...
Epoch: 3 cost time: 32.54438591003418
Epoch: 3, Steps: 70 | Train Loss: 5.958 Vali Loss: 3.991 Vali Acc: 0.500 Test Loss: 3.991 Test Acc: 0.500
Validation loss decreased (-0.499903 --> -0.499960).  Saving model ...
Epoch: 4 cost time: 27.572147607803345
Epoch: 4, Steps: 70 | Train Loss: 4.416 Vali Loss: 1.485 Vali Acc: 0.500 Test Loss: 1.485 Test Acc: 0.500
Validation loss decreased (-0.499960 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 25.895932912826538
Epoch: 5, Steps: 70 | Train Loss: 3.552 Vali Loss: 7.433 Vali Acc: 0.500 Test Loss: 7.433 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 46.39249086380005
Epoch: 6, Steps: 70 | Train Loss: 2.989 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 49.347450733184814
Epoch: 7, Steps: 70 | Train Loss: 2.713 Vali Loss: 5.554 Vali Acc: 0.500 Test Loss: 5.554 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 48.68038320541382
Epoch: 8, Steps: 70 | Train Loss: 3.691 Vali Loss: 10.938 Vali Acc: 0.500 Test Loss: 10.938 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 45.06230354309082
Epoch: 9, Steps: 70 | Train Loss: 2.633 Vali Loss: 5.049 Vali Acc: 0.500 Test Loss: 5.049 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 45.55731678009033
Epoch: 10, Steps: 70 | Train Loss: 2.646 Vali Loss: 6.093 Vali Acc: 0.500 Test Loss: 6.093 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 49.21663999557495
Epoch: 11, Steps: 70 | Train Loss: 3.713 Vali Loss: 6.618 Vali Acc: 0.500 Test Loss: 6.618 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 41.69689416885376
Epoch: 12, Steps: 70 | Train Loss: 4.391 Vali Loss: 3.243 Vali Acc: 0.500 Test Loss: 3.243 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 44.481098651885986
Epoch: 13, Steps: 70 | Train Loss: 3.245 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 47.563886642456055
Epoch: 14, Steps: 70 | Train Loss: 2.666 Vali Loss: 7.180 Vali Acc: 0.500 Test Loss: 7.180 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 47.50918507575989
Epoch: 15, Steps: 70 | Train Loss: 3.052 Vali Loss: 5.565 Vali Acc: 0.500 Test Loss: 5.565 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 45.22867465019226
Epoch: 16, Steps: 70 | Train Loss: 3.482 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15620030
model size : 64.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 42.70099067687988
Epoch: 1, Steps: 70 | Train Loss: 7.962 Vali Loss: 3.745 Vali Acc: 0.490 Test Loss: 3.745 Test Acc: 0.490
Validation loss decreased (inf --> -0.489963).  Saving model ...
Epoch: 2 cost time: 42.817121267318726
Epoch: 2, Steps: 70 | Train Loss: 4.516 Vali Loss: 1.798 Vali Acc: 0.500 Test Loss: 1.798 Test Acc: 0.500
Validation loss decreased (-0.489963 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 45.00071740150452
Epoch: 3, Steps: 70 | Train Loss: 4.760 Vali Loss: 3.736 Vali Acc: 0.500 Test Loss: 3.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 47.12845587730408
Epoch: 4, Steps: 70 | Train Loss: 2.591 Vali Loss: 2.611 Vali Acc: 0.500 Test Loss: 2.611 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 44.416807413101196
Epoch: 5, Steps: 70 | Train Loss: 3.529 Vali Loss: 5.571 Vali Acc: 0.500 Test Loss: 5.571 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.30805420875549
Epoch: 6, Steps: 70 | Train Loss: 3.968 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499991).  Saving model ...
Epoch: 7 cost time: 45.084242820739746
Epoch: 7, Steps: 70 | Train Loss: 3.164 Vali Loss: 7.136 Vali Acc: 0.500 Test Loss: 7.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 43.18001699447632
Epoch: 8, Steps: 70 | Train Loss: 3.050 Vali Loss: 6.021 Vali Acc: 0.500 Test Loss: 6.021 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 40.42268753051758
Epoch: 9, Steps: 70 | Train Loss: 3.912 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 10 cost time: 30.93298578262329
Epoch: 10, Steps: 70 | Train Loss: 2.786 Vali Loss: 5.683 Vali Acc: 0.500 Test Loss: 5.683 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 50.66089963912964
Epoch: 11, Steps: 70 | Train Loss: 3.479 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 12 cost time: 44.334341287612915
Epoch: 12, Steps: 70 | Train Loss: 4.209 Vali Loss: 5.816 Vali Acc: 0.500 Test Loss: 5.816 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 50.87471866607666
Epoch: 13, Steps: 70 | Train Loss: 4.810 Vali Loss: 3.575 Vali Acc: 0.500 Test Loss: 3.575 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 48.596627950668335
Epoch: 14, Steps: 70 | Train Loss: 7.390 Vali Loss: 9.675 Vali Acc: 0.500 Test Loss: 9.675 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 49.40535640716553
Epoch: 15, Steps: 70 | Train Loss: 4.132 Vali Loss: 3.530 Vali Acc: 0.500 Test Loss: 3.530 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 38.67160606384277
Epoch: 16, Steps: 70 | Train Loss: 4.535 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 17 cost time: 45.280433654785156
Epoch: 17, Steps: 70 | Train Loss: 3.777 Vali Loss: 6.148 Vali Acc: 0.500 Test Loss: 6.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 48.568238735198975
Epoch: 18, Steps: 70 | Train Loss: 4.143 Vali Loss: 13.201 Vali Acc: 0.500 Test Loss: 13.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 43.93525671958923
Epoch: 19, Steps: 70 | Train Loss: 6.157 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 48.40737009048462
Epoch: 20, Steps: 70 | Train Loss: 2.199 Vali Loss: 7.967 Vali Acc: 0.500 Test Loss: 7.967 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 40.77225303649902
Epoch: 21, Steps: 70 | Train Loss: 4.108 Vali Loss: 3.580 Vali Acc: 0.500 Test Loss: 3.580 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 44.62171030044556
Epoch: 22, Steps: 70 | Train Loss: 4.029 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 47.28496241569519
Epoch: 23, Steps: 70 | Train Loss: 2.338 Vali Loss: 6.911 Vali Acc: 0.500 Test Loss: 6.911 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 40.11993885040283
Epoch: 24, Steps: 70 | Train Loss: 2.615 Vali Loss: 4.107 Vali Acc: 0.500 Test Loss: 4.107 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 40.395581007003784
Epoch: 25, Steps: 70 | Train Loss: 2.817 Vali Loss: 5.713 Vali Acc: 0.500 Test Loss: 5.713 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 41.948914766311646
Epoch: 26, Steps: 70 | Train Loss: 3.611 Vali Loss: 2.213 Vali Acc: 0.500 Test Loss: 2.213 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15499710
model size : 64.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 37.378493309020996
Epoch: 1, Steps: 70 | Train Loss: 5.737 Vali Loss: 14.167 Vali Acc: 0.500 Test Loss: 14.167 Test Acc: 0.500
Validation loss decreased (inf --> -0.499858).  Saving model ...
Epoch: 2 cost time: 43.92307257652283
Epoch: 2, Steps: 70 | Train Loss: 5.201 Vali Loss: 1.682 Vali Acc: 0.500 Test Loss: 1.682 Test Acc: 0.500
Validation loss decreased (-0.499858 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 47.47896122932434
Epoch: 3, Steps: 70 | Train Loss: 3.676 Vali Loss: 2.285 Vali Acc: 0.500 Test Loss: 2.285 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 47.73053550720215
Epoch: 4, Steps: 70 | Train Loss: 2.226 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 43.577593088150024
Epoch: 5, Steps: 70 | Train Loss: 4.178 Vali Loss: 9.658 Vali Acc: 0.500 Test Loss: 9.658 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 41.019806146621704
Epoch: 6, Steps: 70 | Train Loss: 4.345 Vali Loss: 5.032 Vali Acc: 0.500 Test Loss: 5.032 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.77432465553284
Epoch: 7, Steps: 70 | Train Loss: 1.968 Vali Loss: 3.638 Vali Acc: 0.500 Test Loss: 3.638 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.0260591506958
Epoch: 8, Steps: 70 | Train Loss: 3.897 Vali Loss: 2.907 Vali Acc: 0.500 Test Loss: 2.907 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 42.02095937728882
Epoch: 9, Steps: 70 | Train Loss: 3.619 Vali Loss: 2.031 Vali Acc: 0.500 Test Loss: 2.031 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 39.66644763946533
Epoch: 10, Steps: 70 | Train Loss: 3.988 Vali Loss: 3.343 Vali Acc: 0.500 Test Loss: 3.343 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 45.13273000717163
Epoch: 11, Steps: 70 | Train Loss: 4.105 Vali Loss: 8.228 Vali Acc: 0.500 Test Loss: 8.228 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 41.214916467666626
Epoch: 12, Steps: 70 | Train Loss: 4.079 Vali Loss: 3.937 Vali Acc: 0.500 Test Loss: 3.937 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15379390
model size : 63.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 35.951409578323364
Epoch: 1, Steps: 70 | Train Loss: 3.121 Vali Loss: 11.025 Vali Acc: 0.500 Test Loss: 11.025 Test Acc: 0.500
Validation loss decreased (inf --> -0.499890).  Saving model ...
Epoch: 2 cost time: 33.577038288116455
Epoch: 2, Steps: 70 | Train Loss: 3.427 Vali Loss: 0.748 Vali Acc: 0.410 Test Loss: 0.748 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.811313152313232
Epoch: 3, Steps: 70 | Train Loss: 2.623 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.499890 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 39.03573131561279
Epoch: 4, Steps: 70 | Train Loss: 3.522 Vali Loss: 6.737 Vali Acc: 0.500 Test Loss: 6.737 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.89677453041077
Epoch: 5, Steps: 70 | Train Loss: 3.624 Vali Loss: 0.987 Vali Acc: 0.390 Test Loss: 0.987 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.30301761627197
Epoch: 6, Steps: 70 | Train Loss: 3.229 Vali Loss: 2.020 Vali Acc: 0.500 Test Loss: 2.020 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.845231294631958
Epoch: 7, Steps: 70 | Train Loss: 2.561 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 34.71595001220703
Epoch: 8, Steps: 70 | Train Loss: 2.521 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.37167477607727
Epoch: 9, Steps: 70 | Train Loss: 2.801 Vali Loss: 4.021 Vali Acc: 0.500 Test Loss: 4.021 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 34.181758403778076
Epoch: 10, Steps: 70 | Train Loss: 2.016 Vali Loss: 2.610 Vali Acc: 0.500 Test Loss: 2.610 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 31.8813533782959
Epoch: 11, Steps: 70 | Train Loss: 2.331 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 34.899080753326416
Epoch: 12, Steps: 70 | Train Loss: 2.879 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 31.722224712371826
Epoch: 13, Steps: 70 | Train Loss: 2.039 Vali Loss: 6.223 Vali Acc: 0.500 Test Loss: 6.223 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 7583934
model size : 31.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.545478343963623
Epoch: 1, Steps: 70 | Train Loss: 5.352 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 32.28116273880005
Epoch: 2, Steps: 70 | Train Loss: 3.859 Vali Loss: 3.079 Vali Acc: 0.500 Test Loss: 3.079 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.83447551727295
Epoch: 3, Steps: 70 | Train Loss: 3.328 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 39.85322666168213
Epoch: 4, Steps: 70 | Train Loss: 1.843 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 41.84096002578735
Epoch: 5, Steps: 70 | Train Loss: 2.155 Vali Loss: 3.360 Vali Acc: 0.500 Test Loss: 3.360 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 38.49207353591919
Epoch: 6, Steps: 70 | Train Loss: 1.560 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 40.9785578250885
Epoch: 7, Steps: 70 | Train Loss: 2.076 Vali Loss: 1.659 Vali Acc: 0.500 Test Loss: 1.659 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 42.933884143829346
Epoch: 8, Steps: 70 | Train Loss: 2.368 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 38.23614740371704
Epoch: 9, Steps: 70 | Train Loss: 4.037 Vali Loss: 5.097 Vali Acc: 0.500 Test Loss: 5.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.693313121795654
Epoch: 10, Steps: 70 | Train Loss: 2.692 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 40.1903874874115
Epoch: 11, Steps: 70 | Train Loss: 3.984 Vali Loss: 7.009 Vali Acc: 0.500 Test Loss: 7.009 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 38.6004102230072
Epoch: 12, Steps: 70 | Train Loss: 3.959 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 39.26353216171265
Epoch: 13, Steps: 70 | Train Loss: 2.947 Vali Loss: 7.587 Vali Acc: 0.500 Test Loss: 7.587 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 41.832160234451294
Epoch: 14, Steps: 70 | Train Loss: 2.558 Vali Loss: 3.023 Vali Acc: 0.500 Test Loss: 3.023 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 37.73651099205017
Epoch: 15, Steps: 70 | Train Loss: 1.485 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 41.73695158958435
Epoch: 16, Steps: 70 | Train Loss: 1.724 Vali Loss: 3.557 Vali Acc: 0.500 Test Loss: 3.557 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 36.876150131225586
Epoch: 17, Steps: 70 | Train Loss: 1.794 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 39.45830512046814
Epoch: 18, Steps: 70 | Train Loss: 1.928 Vali Loss: 0.997 Vali Acc: 0.500 Test Loss: 0.997 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 35.92587924003601
Epoch: 19, Steps: 70 | Train Loss: 1.860 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 37.67544364929199
Epoch: 20, Steps: 70 | Train Loss: 1.859 Vali Loss: 3.011 Vali Acc: 0.500 Test Loss: 3.011 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 7523774
model size : 31.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 35.75127029418945
Epoch: 1, Steps: 70 | Train Loss: 3.284 Vali Loss: 5.800 Vali Acc: 0.500 Test Loss: 5.800 Test Acc: 0.500
Validation loss decreased (inf --> -0.499942).  Saving model ...
Epoch: 2 cost time: 35.66426968574524
Epoch: 2, Steps: 70 | Train Loss: 2.632 Vali Loss: 0.992 Vali Acc: 0.500 Test Loss: 0.992 Test Acc: 0.500
Validation loss decreased (-0.499942 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 32.68400192260742
Epoch: 3, Steps: 70 | Train Loss: 1.829 Vali Loss: 2.256 Vali Acc: 0.500 Test Loss: 2.256 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.938729763031006
Epoch: 4, Steps: 70 | Train Loss: 2.591 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 37.45214891433716
Epoch: 5, Steps: 70 | Train Loss: 1.684 Vali Loss: 2.374 Vali Acc: 0.500 Test Loss: 2.374 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.79219937324524
Epoch: 6, Steps: 70 | Train Loss: 2.326 Vali Loss: 2.523 Vali Acc: 0.500 Test Loss: 2.523 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 38.92494463920593
Epoch: 7, Steps: 70 | Train Loss: 2.454 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 37.78250169754028
Epoch: 8, Steps: 70 | Train Loss: 2.654 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 38.03637099266052
Epoch: 9, Steps: 70 | Train Loss: 2.620 Vali Loss: 5.046 Vali Acc: 0.500 Test Loss: 5.046 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 39.15018439292908
Epoch: 10, Steps: 70 | Train Loss: 6.232 Vali Loss: 3.047 Vali Acc: 0.500 Test Loss: 3.047 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.38821291923523
Epoch: 11, Steps: 70 | Train Loss: 1.879 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 39.39451289176941
Epoch: 12, Steps: 70 | Train Loss: 2.750 Vali Loss: 2.813 Vali Acc: 0.500 Test Loss: 2.813 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.4014790058136
Epoch: 13, Steps: 70 | Train Loss: 2.268 Vali Loss: 6.117 Vali Acc: 0.500 Test Loss: 6.117 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 36.04766225814819
Epoch: 14, Steps: 70 | Train Loss: 2.800 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 38.19473600387573
Epoch: 15, Steps: 70 | Train Loss: 1.845 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 33.5112886428833
Epoch: 16, Steps: 70 | Train Loss: 2.500 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 24.77746820449829
Epoch: 17, Steps: 70 | Train Loss: 2.456 Vali Loss: 2.414 Vali Acc: 0.500 Test Loss: 2.414 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 7463614
model size : 31.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.074551820755005
Epoch: 1, Steps: 70 | Train Loss: 5.080 Vali Loss: 3.311 Vali Acc: 0.500 Test Loss: 3.311 Test Acc: 0.500
Validation loss decreased (inf --> -0.499967).  Saving model ...
Epoch: 2 cost time: 37.28935718536377
Epoch: 2, Steps: 70 | Train Loss: 4.550 Vali Loss: 7.083 Vali Acc: 0.500 Test Loss: 7.083 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.7257936000824
Epoch: 3, Steps: 70 | Train Loss: 2.718 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 30.578293800354004
Epoch: 4, Steps: 70 | Train Loss: 2.569 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 36.08195495605469
Epoch: 5, Steps: 70 | Train Loss: 2.494 Vali Loss: 4.006 Vali Acc: 0.500 Test Loss: 4.006 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.60804033279419
Epoch: 6, Steps: 70 | Train Loss: 2.229 Vali Loss: 1.524 Vali Acc: 0.500 Test Loss: 1.524 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.16766119003296
Epoch: 7, Steps: 70 | Train Loss: 1.869 Vali Loss: 1.245 Vali Acc: 0.510 Test Loss: 1.245 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509988).  Saving model ...
Epoch: 8 cost time: 32.338751792907715
Epoch: 8, Steps: 70 | Train Loss: 1.657 Vali Loss: 3.939 Vali Acc: 0.500 Test Loss: 3.939 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.23322892189026
Epoch: 9, Steps: 70 | Train Loss: 1.945 Vali Loss: 2.055 Vali Acc: 0.500 Test Loss: 2.055 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.350030422210693
Epoch: 10, Steps: 70 | Train Loss: 3.170 Vali Loss: 8.690 Vali Acc: 0.500 Test Loss: 8.690 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.96540117263794
Epoch: 11, Steps: 70 | Train Loss: 3.213 Vali Loss: 3.596 Vali Acc: 0.500 Test Loss: 3.596 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 33.83805298805237
Epoch: 12, Steps: 70 | Train Loss: 2.248 Vali Loss: 2.100 Vali Acc: 0.500 Test Loss: 2.100 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.30357575416565
Epoch: 13, Steps: 70 | Train Loss: 1.793 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 33.44537973403931
Epoch: 14, Steps: 70 | Train Loss: 2.014 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 34.43562436103821
Epoch: 15, Steps: 70 | Train Loss: 3.369 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.80680513381958
Epoch: 16, Steps: 70 | Train Loss: 1.944 Vali Loss: 5.817 Vali Acc: 0.500 Test Loss: 5.817 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 33.48501801490784
Epoch: 17, Steps: 70 | Train Loss: 2.630 Vali Loss: 2.208 Vali Acc: 0.500 Test Loss: 2.208 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 7403454
model size : 30.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.066224098205566
Epoch: 1, Steps: 70 | Train Loss: 5.424 Vali Loss: 16.285 Vali Acc: 0.510 Test Loss: 16.285 Test Acc: 0.510
Validation loss decreased (inf --> -0.509837).  Saving model ...
Epoch: 2 cost time: 34.56212854385376
Epoch: 2, Steps: 70 | Train Loss: 9.827 Vali Loss: 2.096 Vali Acc: 0.480 Test Loss: 2.096 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.413660764694214
Epoch: 3, Steps: 70 | Train Loss: 5.564 Vali Loss: 5.005 Vali Acc: 0.500 Test Loss: 5.005 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.511785745620728
Epoch: 4, Steps: 70 | Train Loss: 3.360 Vali Loss: 3.057 Vali Acc: 0.500 Test Loss: 3.057 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 35.558908224105835
Epoch: 5, Steps: 70 | Train Loss: 2.307 Vali Loss: 5.017 Vali Acc: 0.500 Test Loss: 5.017 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 29.892455101013184
Epoch: 6, Steps: 70 | Train Loss: 2.194 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 32.65791988372803
Epoch: 7, Steps: 70 | Train Loss: 1.744 Vali Loss: 2.586 Vali Acc: 0.500 Test Loss: 2.586 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 33.334187507629395
Epoch: 8, Steps: 70 | Train Loss: 2.140 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 28.84399390220642
Epoch: 9, Steps: 70 | Train Loss: 4.772 Vali Loss: 3.342 Vali Acc: 0.500 Test Loss: 3.342 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 34.631789207458496
Epoch: 10, Steps: 70 | Train Loss: 3.947 Vali Loss: 3.895 Vali Acc: 0.500 Test Loss: 3.895 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 32.309529304504395
Epoch: 11, Steps: 70 | Train Loss: 1.929 Vali Loss: 1.677 Vali Acc: 0.510 Test Loss: 1.677 Test Acc: 0.510
Validation loss decreased (-0.509837 --> -0.509983).  Saving model ...
Epoch: 12 cost time: 29.34994149208069
Epoch: 12, Steps: 70 | Train Loss: 2.784 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.249911069869995
Epoch: 13, Steps: 70 | Train Loss: 2.152 Vali Loss: 6.729 Vali Acc: 0.500 Test Loss: 6.729 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.17188024520874
Epoch: 14, Steps: 70 | Train Loss: 2.293 Vali Loss: 5.969 Vali Acc: 0.500 Test Loss: 5.969 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 30.982897996902466
Epoch: 15, Steps: 70 | Train Loss: 2.159 Vali Loss: 0.843 Vali Acc: 0.580 Test Loss: 0.843 Test Acc: 0.580
Validation loss decreased (-0.509983 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 27.033435344696045
Epoch: 16, Steps: 70 | Train Loss: 3.275 Vali Loss: 6.513 Vali Acc: 0.500 Test Loss: 6.513 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 31.030557870864868
Epoch: 17, Steps: 70 | Train Loss: 2.393 Vali Loss: 1.416 Vali Acc: 0.500 Test Loss: 1.416 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 30.185084104537964
Epoch: 18, Steps: 70 | Train Loss: 2.075 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 27.255051612854004
Epoch: 19, Steps: 70 | Train Loss: 1.334 Vali Loss: 1.663 Vali Acc: 0.500 Test Loss: 1.663 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 29.991416454315186
Epoch: 20, Steps: 70 | Train Loss: 1.616 Vali Loss: 3.172 Vali Acc: 0.500 Test Loss: 3.172 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 30.575347900390625
Epoch: 21, Steps: 70 | Train Loss: 1.999 Vali Loss: 5.192 Vali Acc: 0.500 Test Loss: 5.192 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 27.4799747467041
Epoch: 22, Steps: 70 | Train Loss: 2.224 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 20.377084255218506
Epoch: 23, Steps: 70 | Train Loss: 1.926 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 28.007060050964355
Epoch: 24, Steps: 70 | Train Loss: 1.612 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 24.55490756034851
Epoch: 25, Steps: 70 | Train Loss: 1.578 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6399678
model size : 27.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.692494869232178
Epoch: 1, Steps: 70 | Train Loss: 2.321 Vali Loss: 7.255 Vali Acc: 0.500 Test Loss: 7.255 Test Acc: 0.500
Validation loss decreased (inf --> -0.499927).  Saving model ...
Epoch: 2 cost time: 19.000813245773315
Epoch: 2, Steps: 70 | Train Loss: 3.038 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
Validation loss decreased (-0.499927 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 24.169081449508667
Epoch: 3, Steps: 70 | Train Loss: 1.992 Vali Loss: 4.300 Vali Acc: 0.500 Test Loss: 4.300 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.25481343269348
Epoch: 4, Steps: 70 | Train Loss: 2.113 Vali Loss: 2.108 Vali Acc: 0.500 Test Loss: 2.108 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.87109613418579
Epoch: 5, Steps: 70 | Train Loss: 2.900 Vali Loss: 3.931 Vali Acc: 0.500 Test Loss: 3.931 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.300620555877686
Epoch: 6, Steps: 70 | Train Loss: 2.638 Vali Loss: 1.783 Vali Acc: 0.500 Test Loss: 1.783 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.294568300247192
Epoch: 7, Steps: 70 | Train Loss: 2.842 Vali Loss: 1.993 Vali Acc: 0.500 Test Loss: 1.993 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.674673318862915
Epoch: 8, Steps: 70 | Train Loss: 1.897 Vali Loss: 4.355 Vali Acc: 0.500 Test Loss: 4.355 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 26.05542826652527
Epoch: 9, Steps: 70 | Train Loss: 2.542 Vali Loss: 6.216 Vali Acc: 0.500 Test Loss: 6.216 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 26.60866618156433
Epoch: 10, Steps: 70 | Train Loss: 2.652 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.805675268173218
Epoch: 11, Steps: 70 | Train Loss: 3.677 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.497077226638794
Epoch: 12, Steps: 70 | Train Loss: 2.947 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499993).  Saving model ...
Epoch: 13 cost time: 22.857347011566162
Epoch: 13, Steps: 70 | Train Loss: 2.777 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 14 cost time: 20.29062032699585
Epoch: 14, Steps: 70 | Train Loss: 3.246 Vali Loss: 11.093 Vali Acc: 0.500 Test Loss: 11.093 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.878869771957397
Epoch: 15, Steps: 70 | Train Loss: 3.720 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 28.953262090682983
Epoch: 16, Steps: 70 | Train Loss: 2.697 Vali Loss: 4.046 Vali Acc: 0.500 Test Loss: 4.046 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 27.90363359451294
Epoch: 17, Steps: 70 | Train Loss: 3.476 Vali Loss: 2.650 Vali Acc: 0.500 Test Loss: 2.650 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 20.40804100036621
Epoch: 18, Steps: 70 | Train Loss: 3.327 Vali Loss: 3.584 Vali Acc: 0.500 Test Loss: 3.584 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.182519674301147
Epoch: 19, Steps: 70 | Train Loss: 2.686 Vali Loss: 2.867 Vali Acc: 0.500 Test Loss: 2.867 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.275339126586914
Epoch: 20, Steps: 70 | Train Loss: 1.903 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.257994890213013
Epoch: 21, Steps: 70 | Train Loss: 2.716 Vali Loss: 2.386 Vali Acc: 0.500 Test Loss: 2.386 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 22.297444581985474
Epoch: 22, Steps: 70 | Train Loss: 1.752 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 19.42766571044922
Epoch: 23, Steps: 70 | Train Loss: 1.609 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 6339518
model size : 26.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.86168313026428
Epoch: 1, Steps: 70 | Train Loss: 1.880 Vali Loss: 3.832 Vali Acc: 0.500 Test Loss: 3.832 Test Acc: 0.500
Validation loss decreased (inf --> -0.499962).  Saving model ...
Epoch: 2 cost time: 32.47994637489319
Epoch: 2, Steps: 70 | Train Loss: 3.339 Vali Loss: 2.398 Vali Acc: 0.500 Test Loss: 2.398 Test Acc: 0.500
Validation loss decreased (-0.499962 --> -0.499976).  Saving model ...
Epoch: 3 cost time: 28.651989221572876
Epoch: 3, Steps: 70 | Train Loss: 1.684 Vali Loss: 1.790 Vali Acc: 0.500 Test Loss: 1.790 Test Acc: 0.500
Validation loss decreased (-0.499976 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 30.538917064666748
Epoch: 4, Steps: 70 | Train Loss: 3.452 Vali Loss: 1.448 Vali Acc: 0.500 Test Loss: 1.448 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 31.296692848205566
Epoch: 5, Steps: 70 | Train Loss: 2.358 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 29.484610557556152
Epoch: 6, Steps: 70 | Train Loss: 2.334 Vali Loss: 11.359 Vali Acc: 0.500 Test Loss: 11.359 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.693410634994507
Epoch: 7, Steps: 70 | Train Loss: 4.326 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 31.59465742111206
Epoch: 8, Steps: 70 | Train Loss: 1.679 Vali Loss: 3.754 Vali Acc: 0.500 Test Loss: 3.754 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.090746879577637
Epoch: 9, Steps: 70 | Train Loss: 2.509 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 29.9459285736084
Epoch: 10, Steps: 70 | Train Loss: 2.940 Vali Loss: 8.813 Vali Acc: 0.500 Test Loss: 8.813 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 32.968668937683105
Epoch: 11, Steps: 70 | Train Loss: 3.215 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 29.16368842124939
Epoch: 12, Steps: 70 | Train Loss: 1.750 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 31.48008918762207
Epoch: 13, Steps: 70 | Train Loss: 1.605 Vali Loss: 1.927 Vali Acc: 0.500 Test Loss: 1.927 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 31.887573719024658
Epoch: 14, Steps: 70 | Train Loss: 2.087 Vali Loss: 1.975 Vali Acc: 0.500 Test Loss: 1.975 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 27.57909870147705
Epoch: 15, Steps: 70 | Train Loss: 2.614 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 6279358
model size : 26.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.946136474609375
Epoch: 1, Steps: 70 | Train Loss: 3.229 Vali Loss: 8.211 Vali Acc: 0.500 Test Loss: 8.211 Test Acc: 0.500
Validation loss decreased (inf --> -0.499918).  Saving model ...
Epoch: 2 cost time: 21.542884349822998
Epoch: 2, Steps: 70 | Train Loss: 9.348 Vali Loss: 0.805 Vali Acc: 0.580 Test Loss: 0.805 Test Acc: 0.580
Validation loss decreased (-0.499918 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 28.167010068893433
Epoch: 3, Steps: 70 | Train Loss: 2.624 Vali Loss: 2.890 Vali Acc: 0.500 Test Loss: 2.890 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.77189350128174
Epoch: 4, Steps: 70 | Train Loss: 4.765 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.84752321243286
Epoch: 5, Steps: 70 | Train Loss: 2.034 Vali Loss: 5.554 Vali Acc: 0.500 Test Loss: 5.554 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.92290496826172
Epoch: 6, Steps: 70 | Train Loss: 3.726 Vali Loss: 5.635 Vali Acc: 0.500 Test Loss: 5.635 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 25.206639766693115
Epoch: 7, Steps: 70 | Train Loss: 3.979 Vali Loss: 2.727 Vali Acc: 0.500 Test Loss: 2.727 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.7451810836792
Epoch: 8, Steps: 70 | Train Loss: 2.160 Vali Loss: 5.460 Vali Acc: 0.500 Test Loss: 5.460 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.401670932769775
Epoch: 9, Steps: 70 | Train Loss: 3.105 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 27.932320833206177
Epoch: 10, Steps: 70 | Train Loss: 2.071 Vali Loss: 1.005 Vali Acc: 0.500 Test Loss: 1.005 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 27.797211170196533
Epoch: 11, Steps: 70 | Train Loss: 2.370 Vali Loss: 1.823 Vali Acc: 0.500 Test Loss: 1.823 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 28.901870489120483
Epoch: 12, Steps: 70 | Train Loss: 2.416 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6219198
model size : 26.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.619760036468506
Epoch: 1, Steps: 70 | Train Loss: 3.878 Vali Loss: 14.754 Vali Acc: 0.500 Test Loss: 14.754 Test Acc: 0.500
Validation loss decreased (inf --> -0.499852).  Saving model ...
Epoch: 2 cost time: 26.462472677230835
Epoch: 2, Steps: 70 | Train Loss: 3.780 Vali Loss: 0.828 Vali Acc: 0.470 Test Loss: 0.828 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.943642616271973
Epoch: 3, Steps: 70 | Train Loss: 2.498 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
Validation loss decreased (-0.499852 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 17.78607487678528
Epoch: 4, Steps: 70 | Train Loss: 3.296 Vali Loss: 1.555 Vali Acc: 0.500 Test Loss: 1.555 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 29.81352996826172
Epoch: 5, Steps: 70 | Train Loss: 1.762 Vali Loss: 6.495 Vali Acc: 0.500 Test Loss: 6.495 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.865787267684937
Epoch: 6, Steps: 70 | Train Loss: 3.290 Vali Loss: 5.474 Vali Acc: 0.500 Test Loss: 5.474 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.20625877380371
Epoch: 7, Steps: 70 | Train Loss: 3.419 Vali Loss: 4.238 Vali Acc: 0.500 Test Loss: 4.238 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.204842567443848
Epoch: 8, Steps: 70 | Train Loss: 2.416 Vali Loss: 4.448 Vali Acc: 0.500 Test Loss: 4.448 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 29.89097499847412
Epoch: 9, Steps: 70 | Train Loss: 1.918 Vali Loss: 3.767 Vali Acc: 0.500 Test Loss: 3.767 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.725934982299805
Epoch: 10, Steps: 70 | Train Loss: 1.833 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
Validation loss decreased (-0.499984 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 27.86675453186035
Epoch: 11, Steps: 70 | Train Loss: 3.773 Vali Loss: 2.046 Vali Acc: 0.510 Test Loss: 2.046 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.47454810142517
Epoch: 12, Steps: 70 | Train Loss: 2.759 Vali Loss: 0.996 Vali Acc: 0.520 Test Loss: 0.996 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.26175022125244
Epoch: 13, Steps: 70 | Train Loss: 1.909 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.78385877609253
Epoch: 14, Steps: 70 | Train Loss: 1.569 Vali Loss: 3.666 Vali Acc: 0.490 Test Loss: 3.666 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 27.156012296676636
Epoch: 15, Steps: 70 | Train Loss: 1.848 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.9311842918396
Epoch: 16, Steps: 70 | Train Loss: 2.462 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.049409866333008
Epoch: 17, Steps: 70 | Train Loss: 2.765 Vali Loss: 1.743 Vali Acc: 0.500 Test Loss: 1.743 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 21.32958436012268
Epoch: 18, Steps: 70 | Train Loss: 1.716 Vali Loss: 5.617 Vali Acc: 0.500 Test Loss: 5.617 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 24.598392486572266
Epoch: 19, Steps: 70 | Train Loss: 1.566 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 17.258270263671875
Epoch: 20, Steps: 70 | Train Loss: 1.411 Vali Loss: 1.781 Vali Acc: 0.500 Test Loss: 1.781 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5807550
model size : 24.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.707175493240356
Epoch: 1, Steps: 70 | Train Loss: 3.172 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 30.367596864700317
Epoch: 2, Steps: 70 | Train Loss: 3.064 Vali Loss: 9.190 Vali Acc: 0.500 Test Loss: 9.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.141851902008057
Epoch: 3, Steps: 70 | Train Loss: 2.831 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499990).  Saving model ...
Epoch: 4 cost time: 20.720932722091675
Epoch: 4, Steps: 70 | Train Loss: 1.871 Vali Loss: 0.705 Vali Acc: 0.450 Test Loss: 0.705 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.45165228843689
Epoch: 5, Steps: 70 | Train Loss: 3.517 Vali Loss: 1.716 Vali Acc: 0.500 Test Loss: 1.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.61940622329712
Epoch: 6, Steps: 70 | Train Loss: 2.773 Vali Loss: 2.574 Vali Acc: 0.500 Test Loss: 2.574 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.349494695663452
Epoch: 7, Steps: 70 | Train Loss: 2.138 Vali Loss: 1.713 Vali Acc: 0.500 Test Loss: 1.713 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.92307186126709
Epoch: 8, Steps: 70 | Train Loss: 2.175 Vali Loss: 8.410 Vali Acc: 0.500 Test Loss: 8.410 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.634900093078613
Epoch: 9, Steps: 70 | Train Loss: 2.342 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.96375036239624
Epoch: 10, Steps: 70 | Train Loss: 2.829 Vali Loss: 3.937 Vali Acc: 0.500 Test Loss: 3.937 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.926939487457275
Epoch: 11, Steps: 70 | Train Loss: 2.316 Vali Loss: 2.515 Vali Acc: 0.500 Test Loss: 2.515 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.928479194641113
Epoch: 12, Steps: 70 | Train Loss: 1.855 Vali Loss: 1.414 Vali Acc: 0.500 Test Loss: 1.414 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.036348342895508
Epoch: 13, Steps: 70 | Train Loss: 2.634 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499991).  Saving model ...
Epoch: 14 cost time: 22.856995344161987
Epoch: 14, Steps: 70 | Train Loss: 1.922 Vali Loss: 3.598 Vali Acc: 0.500 Test Loss: 3.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.34383749961853
Epoch: 15, Steps: 70 | Train Loss: 2.912 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.056582927703857
Epoch: 16, Steps: 70 | Train Loss: 1.866 Vali Loss: 3.269 Vali Acc: 0.500 Test Loss: 3.269 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.168869495391846
Epoch: 17, Steps: 70 | Train Loss: 2.454 Vali Loss: 4.667 Vali Acc: 0.500 Test Loss: 4.667 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 23.697615146636963
Epoch: 18, Steps: 70 | Train Loss: 1.543 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 19 cost time: 20.805067539215088
Epoch: 19, Steps: 70 | Train Loss: 1.361 Vali Loss: 0.695 Vali Acc: 0.460 Test Loss: 0.695 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 28.18926763534546
Epoch: 20, Steps: 70 | Train Loss: 2.197 Vali Loss: 3.200 Vali Acc: 0.590 Test Loss: 3.200 Test Acc: 0.590
Validation loss decreased (-0.499992 --> -0.589968).  Saving model ...
Epoch: 21 cost time: 25.24504828453064
Epoch: 21, Steps: 70 | Train Loss: 5.485 Vali Loss: 2.245 Vali Acc: 0.490 Test Loss: 2.245 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.900140523910522
Epoch: 22, Steps: 70 | Train Loss: 4.093 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 24.76703643798828
Epoch: 23, Steps: 70 | Train Loss: 1.680 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 27.441561698913574
Epoch: 24, Steps: 70 | Train Loss: 1.485 Vali Loss: 3.137 Vali Acc: 0.500 Test Loss: 3.137 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 24.19785785675049
Epoch: 25, Steps: 70 | Train Loss: 2.125 Vali Loss: 3.073 Vali Acc: 0.500 Test Loss: 3.073 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 20.443307161331177
Epoch: 26, Steps: 70 | Train Loss: 2.034 Vali Loss: 4.468 Vali Acc: 0.500 Test Loss: 4.468 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 24.462064743041992
Epoch: 27, Steps: 70 | Train Loss: 1.997 Vali Loss: 1.526 Vali Acc: 0.500 Test Loss: 1.526 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 25.628177881240845
Epoch: 28, Steps: 70 | Train Loss: 1.670 Vali Loss: 1.438 Vali Acc: 0.420 Test Loss: 1.438 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 21.059216260910034
Epoch: 29, Steps: 70 | Train Loss: 2.220 Vali Loss: 3.265 Vali Acc: 0.460 Test Loss: 3.265 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 19.941452503204346
Epoch: 30, Steps: 70 | Train Loss: 1.720 Vali Loss: 4.901 Vali Acc: 0.500 Test Loss: 4.901 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5747390
model size : 24.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.64858031272888
Epoch: 1, Steps: 70 | Train Loss: 2.915 Vali Loss: 1.614 Vali Acc: 0.540 Test Loss: 1.614 Test Acc: 0.540
Validation loss decreased (inf --> -0.539984).  Saving model ...
Epoch: 2 cost time: 32.61806082725525
Epoch: 2, Steps: 70 | Train Loss: 3.893 Vali Loss: 6.182 Vali Acc: 0.500 Test Loss: 6.182 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.632412910461426
Epoch: 3, Steps: 70 | Train Loss: 2.904 Vali Loss: 4.483 Vali Acc: 0.500 Test Loss: 4.483 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.43552589416504
Epoch: 4, Steps: 70 | Train Loss: 2.448 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 32.276219844818115
Epoch: 5, Steps: 70 | Train Loss: 2.289 Vali Loss: 4.010 Vali Acc: 0.500 Test Loss: 4.010 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 35.86890649795532
Epoch: 6, Steps: 70 | Train Loss: 3.561 Vali Loss: 4.501 Vali Acc: 0.500 Test Loss: 4.501 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 34.88563108444214
Epoch: 7, Steps: 70 | Train Loss: 2.251 Vali Loss: 5.840 Vali Acc: 0.500 Test Loss: 5.840 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 30.93165159225464
Epoch: 8, Steps: 70 | Train Loss: 5.054 Vali Loss: 2.094 Vali Acc: 0.500 Test Loss: 2.094 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 35.548120737075806
Epoch: 9, Steps: 70 | Train Loss: 1.545 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 35.55884552001953
Epoch: 10, Steps: 70 | Train Loss: 2.366 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 30.601460695266724
Epoch: 11, Steps: 70 | Train Loss: 2.064 Vali Loss: 1.889 Vali Acc: 0.510 Test Loss: 1.889 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 27.200863122940063
Epoch: 12, Steps: 70 | Train Loss: 2.001 Vali Loss: 2.148 Vali Acc: 0.500 Test Loss: 2.148 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 34.60746908187866
Epoch: 13, Steps: 70 | Train Loss: 3.646 Vali Loss: 1.823 Vali Acc: 0.460 Test Loss: 1.823 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 30.07125163078308
Epoch: 14, Steps: 70 | Train Loss: 2.362 Vali Loss: 4.818 Vali Acc: 0.500 Test Loss: 4.818 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 34.73523664474487
Epoch: 15, Steps: 70 | Train Loss: 1.836 Vali Loss: 1.938 Vali Acc: 0.500 Test Loss: 1.938 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 35.15874195098877
Epoch: 16, Steps: 70 | Train Loss: 2.799 Vali Loss: 6.665 Vali Acc: 0.500 Test Loss: 6.665 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 29.50930643081665
Epoch: 17, Steps: 70 | Train Loss: 2.960 Vali Loss: 3.844 Vali Acc: 0.500 Test Loss: 3.844 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 33.93059539794922
Epoch: 18, Steps: 70 | Train Loss: 3.196 Vali Loss: 5.135 Vali Acc: 0.500 Test Loss: 5.135 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 35.52478051185608
Epoch: 19, Steps: 70 | Train Loss: 2.854 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 5687230
model size : 24.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.143860816955566
Epoch: 1, Steps: 70 | Train Loss: 2.858 Vali Loss: 1.893 Vali Acc: 0.470 Test Loss: 1.893 Test Acc: 0.470
Validation loss decreased (inf --> -0.469981).  Saving model ...
Epoch: 2 cost time: 26.658971548080444
Epoch: 2, Steps: 70 | Train Loss: 5.251 Vali Loss: 1.981 Vali Acc: 0.500 Test Loss: 1.981 Test Acc: 0.500
Validation loss decreased (-0.469981 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 25.949394702911377
Epoch: 3, Steps: 70 | Train Loss: 2.699 Vali Loss: 3.686 Vali Acc: 0.500 Test Loss: 3.686 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.136648416519165
Epoch: 4, Steps: 70 | Train Loss: 2.274 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 31.334876537322998
Epoch: 5, Steps: 70 | Train Loss: 2.261 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 27.688977479934692
Epoch: 6, Steps: 70 | Train Loss: 3.088 Vali Loss: 2.632 Vali Acc: 0.500 Test Loss: 2.632 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.687385082244873
Epoch: 7, Steps: 70 | Train Loss: 1.726 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 26.337209701538086
Epoch: 8, Steps: 70 | Train Loss: 2.303 Vali Loss: 4.952 Vali Acc: 0.500 Test Loss: 4.952 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.63944697380066
Epoch: 9, Steps: 70 | Train Loss: 2.110 Vali Loss: 1.993 Vali Acc: 0.490 Test Loss: 1.993 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.486457109451294
Epoch: 10, Steps: 70 | Train Loss: 1.659 Vali Loss: 1.569 Vali Acc: 0.500 Test Loss: 1.569 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.43521213531494
Epoch: 11, Steps: 70 | Train Loss: 1.562 Vali Loss: 3.132 Vali Acc: 0.500 Test Loss: 3.132 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.28967547416687
Epoch: 12, Steps: 70 | Train Loss: 4.142 Vali Loss: 2.980 Vali Acc: 0.500 Test Loss: 2.980 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.749982595443726
Epoch: 13, Steps: 70 | Train Loss: 1.774 Vali Loss: 6.641 Vali Acc: 0.500 Test Loss: 6.641 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 32.123730421066284
Epoch: 14, Steps: 70 | Train Loss: 2.860 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539987).  Saving model ...
Epoch: 15 cost time: 32.8790647983551
Epoch: 15, Steps: 70 | Train Loss: 2.700 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 27.464784860610962
Epoch: 16, Steps: 70 | Train Loss: 2.251 Vali Loss: 2.281 Vali Acc: 0.500 Test Loss: 2.281 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 33.18562388420105
Epoch: 17, Steps: 70 | Train Loss: 1.410 Vali Loss: 1.984 Vali Acc: 0.500 Test Loss: 1.984 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 32.83585834503174
Epoch: 18, Steps: 70 | Train Loss: 2.107 Vali Loss: 0.690 Vali Acc: 0.530 Test Loss: 0.690 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 27.90109920501709
Epoch: 19, Steps: 70 | Train Loss: 2.018 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 23.699742794036865
Epoch: 20, Steps: 70 | Train Loss: 1.712 Vali Loss: 0.996 Vali Acc: 0.500 Test Loss: 0.996 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 31.422916173934937
Epoch: 21, Steps: 70 | Train Loss: 1.701 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 28.214271068572998
Epoch: 22, Steps: 70 | Train Loss: 1.615 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 28.634929895401
Epoch: 23, Steps: 70 | Train Loss: 1.653 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 26.913822889328003
Epoch: 24, Steps: 70 | Train Loss: 1.330 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 5627070
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.65159296989441
Epoch: 1, Steps: 70 | Train Loss: 4.173 Vali Loss: 5.759 Vali Acc: 0.500 Test Loss: 5.759 Test Acc: 0.500
Validation loss decreased (inf --> -0.499942).  Saving model ...
Epoch: 2 cost time: 29.469199895858765
Epoch: 2, Steps: 70 | Train Loss: 6.941 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
Validation loss decreased (-0.499942 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 28.888415098190308
Epoch: 3, Steps: 70 | Train Loss: 3.212 Vali Loss: 0.716 Vali Acc: 0.410 Test Loss: 0.716 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.966134548187256
Epoch: 4, Steps: 70 | Train Loss: 1.883 Vali Loss: 2.160 Vali Acc: 0.500 Test Loss: 2.160 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.395177125930786
Epoch: 5, Steps: 70 | Train Loss: 1.908 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
Validation loss decreased (-0.499987 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 26.583719730377197
Epoch: 6, Steps: 70 | Train Loss: 2.051 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.44609260559082
Epoch: 7, Steps: 70 | Train Loss: 2.040 Vali Loss: 2.917 Vali Acc: 0.500 Test Loss: 2.917 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.877690076828003
Epoch: 8, Steps: 70 | Train Loss: 2.318 Vali Loss: 1.285 Vali Acc: 0.510 Test Loss: 1.285 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.576550722122192
Epoch: 9, Steps: 70 | Train Loss: 3.244 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 27.42936396598816
Epoch: 10, Steps: 70 | Train Loss: 2.274 Vali Loss: 3.997 Vali Acc: 0.500 Test Loss: 3.997 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 27.171902418136597
Epoch: 11, Steps: 70 | Train Loss: 3.405 Vali Loss: 2.581 Vali Acc: 0.530 Test Loss: 2.581 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529974).  Saving model ...
Epoch: 12 cost time: 30.248246431350708
Epoch: 12, Steps: 70 | Train Loss: 3.477 Vali Loss: 4.523 Vali Acc: 0.500 Test Loss: 4.523 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.292742252349854
Epoch: 13, Steps: 70 | Train Loss: 2.801 Vali Loss: 7.314 Vali Acc: 0.500 Test Loss: 7.314 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.698363780975342
Epoch: 14, Steps: 70 | Train Loss: 5.120 Vali Loss: 1.607 Vali Acc: 0.500 Test Loss: 1.607 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 28.47175407409668
Epoch: 15, Steps: 70 | Train Loss: 3.135 Vali Loss: 2.280 Vali Acc: 0.500 Test Loss: 2.280 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 27.073843240737915
Epoch: 16, Steps: 70 | Train Loss: 2.853 Vali Loss: 4.136 Vali Acc: 0.500 Test Loss: 4.136 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 23.299362897872925
Epoch: 17, Steps: 70 | Train Loss: 4.966 Vali Loss: 4.374 Vali Acc: 0.500 Test Loss: 4.374 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.97254252433777
Epoch: 18, Steps: 70 | Train Loss: 3.634 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 27.454307079315186
Epoch: 19, Steps: 70 | Train Loss: 2.516 Vali Loss: 1.413 Vali Acc: 0.500 Test Loss: 1.413 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 24.14986228942871
Epoch: 20, Steps: 70 | Train Loss: 1.988 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.431833267211914
Epoch: 21, Steps: 70 | Train Loss: 1.993 Vali Loss: 2.650 Vali Acc: 0.490 Test Loss: 2.650 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 5511486
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.235452890396118
Epoch: 1, Steps: 70 | Train Loss: 2.506 Vali Loss: 6.282 Vali Acc: 0.500 Test Loss: 6.282 Test Acc: 0.500
Validation loss decreased (inf --> -0.499937).  Saving model ...
Epoch: 2 cost time: 19.57860016822815
Epoch: 2, Steps: 70 | Train Loss: 6.403 Vali Loss: 3.323 Vali Acc: 0.500 Test Loss: 3.323 Test Acc: 0.500
Validation loss decreased (-0.499937 --> -0.499967).  Saving model ...
Epoch: 3 cost time: 22.084864854812622
Epoch: 3, Steps: 70 | Train Loss: 3.016 Vali Loss: 3.629 Vali Acc: 0.500 Test Loss: 3.629 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.6172091960907
Epoch: 4, Steps: 70 | Train Loss: 3.266 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 25.804444313049316
Epoch: 5, Steps: 70 | Train Loss: 3.033 Vali Loss: 1.995 Vali Acc: 0.500 Test Loss: 1.995 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.32915997505188
Epoch: 6, Steps: 70 | Train Loss: 2.294 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.233074188232422
Epoch: 7, Steps: 70 | Train Loss: 2.235 Vali Loss: 1.514 Vali Acc: 0.510 Test Loss: 1.514 Test Acc: 0.510
Validation loss decreased (-0.499986 --> -0.509985).  Saving model ...
Epoch: 8 cost time: 25.013726472854614
Epoch: 8, Steps: 70 | Train Loss: 3.192 Vali Loss: 3.555 Vali Acc: 0.500 Test Loss: 3.555 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.845579862594604
Epoch: 9, Steps: 70 | Train Loss: 3.787 Vali Loss: 6.881 Vali Acc: 0.500 Test Loss: 6.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.082877159118652
Epoch: 10, Steps: 70 | Train Loss: 2.294 Vali Loss: 2.156 Vali Acc: 0.500 Test Loss: 2.156 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.87099313735962
Epoch: 11, Steps: 70 | Train Loss: 2.111 Vali Loss: 2.463 Vali Acc: 0.500 Test Loss: 2.463 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.595025777816772
Epoch: 12, Steps: 70 | Train Loss: 2.055 Vali Loss: 3.081 Vali Acc: 0.500 Test Loss: 3.081 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.976175785064697
Epoch: 13, Steps: 70 | Train Loss: 1.872 Vali Loss: 3.293 Vali Acc: 0.500 Test Loss: 3.293 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.105458736419678
Epoch: 14, Steps: 70 | Train Loss: 2.383 Vali Loss: 2.970 Vali Acc: 0.500 Test Loss: 2.970 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.632242679595947
Epoch: 15, Steps: 70 | Train Loss: 1.997 Vali Loss: 2.524 Vali Acc: 0.500 Test Loss: 2.524 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 30.08950114250183
Epoch: 16, Steps: 70 | Train Loss: 1.748 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 36.752403020858765
Epoch: 17, Steps: 70 | Train Loss: 1.627 Vali Loss: 1.753 Vali Acc: 0.500 Test Loss: 1.753 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5451326
model size : 23.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.545241832733154
Epoch: 1, Steps: 70 | Train Loss: 3.133 Vali Loss: 3.262 Vali Acc: 0.500 Test Loss: 3.262 Test Acc: 0.500
Validation loss decreased (inf --> -0.499967).  Saving model ...
Epoch: 2 cost time: 29.214526653289795
Epoch: 2, Steps: 70 | Train Loss: 5.922 Vali Loss: 4.556 Vali Acc: 0.500 Test Loss: 4.556 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.123615741729736
Epoch: 3, Steps: 70 | Train Loss: 3.678 Vali Loss: 1.062 Vali Acc: 0.490 Test Loss: 1.062 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.40304923057556
Epoch: 4, Steps: 70 | Train Loss: 3.119 Vali Loss: 5.653 Vali Acc: 0.500 Test Loss: 5.653 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 29.19412350654602
Epoch: 5, Steps: 70 | Train Loss: 3.279 Vali Loss: 5.431 Vali Acc: 0.500 Test Loss: 5.431 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 33.70232439041138
Epoch: 6, Steps: 70 | Train Loss: 3.420 Vali Loss: 0.958 Vali Acc: 0.500 Test Loss: 0.958 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499990).  Saving model ...
Epoch: 7 cost time: 32.45249342918396
Epoch: 7, Steps: 70 | Train Loss: 2.142 Vali Loss: 3.575 Vali Acc: 0.500 Test Loss: 3.575 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.37777519226074
Epoch: 8, Steps: 70 | Train Loss: 3.078 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 31.242027282714844
Epoch: 9, Steps: 70 | Train Loss: 3.148 Vali Loss: 3.990 Vali Acc: 0.500 Test Loss: 3.990 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.416836261749268
Epoch: 10, Steps: 70 | Train Loss: 5.871 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 34.11509585380554
Epoch: 11, Steps: 70 | Train Loss: 1.951 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499993).  Saving model ...
Epoch: 12 cost time: 32.34546375274658
Epoch: 12, Steps: 70 | Train Loss: 2.152 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.04368782043457
Epoch: 13, Steps: 70 | Train Loss: 2.154 Vali Loss: 6.028 Vali Acc: 0.500 Test Loss: 6.028 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 27.439414501190186
Epoch: 14, Steps: 70 | Train Loss: 3.248 Vali Loss: 3.897 Vali Acc: 0.500 Test Loss: 3.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 28.3873233795166
Epoch: 15, Steps: 70 | Train Loss: 3.609 Vali Loss: 2.198 Vali Acc: 0.500 Test Loss: 2.198 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 31.083964824676514
Epoch: 16, Steps: 70 | Train Loss: 2.378 Vali Loss: 5.417 Vali Acc: 0.500 Test Loss: 5.417 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 32.019203424453735
Epoch: 17, Steps: 70 | Train Loss: 1.992 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.86535334587097
Epoch: 18, Steps: 70 | Train Loss: 1.941 Vali Loss: 3.814 Vali Acc: 0.500 Test Loss: 3.814 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 33.89410901069641
Epoch: 19, Steps: 70 | Train Loss: 2.512 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 33.250840187072754
Epoch: 20, Steps: 70 | Train Loss: 2.947 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 21 cost time: 32.28695869445801
Epoch: 21, Steps: 70 | Train Loss: 2.106 Vali Loss: 0.940 Vali Acc: 0.500 Test Loss: 0.940 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 34.442527294158936
Epoch: 22, Steps: 70 | Train Loss: 1.689 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 28.771122455596924
Epoch: 23, Steps: 70 | Train Loss: 1.379 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 26.377488136291504
Epoch: 24, Steps: 70 | Train Loss: 2.267 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 32.43817186355591
Epoch: 25, Steps: 70 | Train Loss: 1.961 Vali Loss: 2.996 Vali Acc: 0.500 Test Loss: 2.996 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 28.91286611557007
Epoch: 26, Steps: 70 | Train Loss: 1.582 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 32.76113319396973
Epoch: 27, Steps: 70 | Train Loss: 1.051 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 18.529924392700195
Epoch: 28, Steps: 70 | Train Loss: 1.312 Vali Loss: 2.480 Vali Acc: 0.500 Test Loss: 2.480 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 29.657217025756836
Epoch: 29, Steps: 70 | Train Loss: 1.130 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 31.68402338027954
Epoch: 30, Steps: 70 | Train Loss: 0.946 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 5391166
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.509371519088745
Epoch: 1, Steps: 70 | Train Loss: 4.149 Vali Loss: 7.160 Vali Acc: 0.500 Test Loss: 7.160 Test Acc: 0.500
Validation loss decreased (inf --> -0.499928).  Saving model ...
Epoch: 2 cost time: 27.198447704315186
Epoch: 2, Steps: 70 | Train Loss: 5.097 Vali Loss: 3.129 Vali Acc: 0.500 Test Loss: 3.129 Test Acc: 0.500
Validation loss decreased (-0.499928 --> -0.499969).  Saving model ...
Epoch: 3 cost time: 22.689499139785767
Epoch: 3, Steps: 70 | Train Loss: 1.754 Vali Loss: 2.942 Vali Acc: 0.500 Test Loss: 2.942 Test Acc: 0.500
Validation loss decreased (-0.499969 --> -0.499971).  Saving model ...
Epoch: 4 cost time: 20.791933298110962
Epoch: 4, Steps: 70 | Train Loss: 2.404 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.499971 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 31.353739261627197
Epoch: 5, Steps: 70 | Train Loss: 2.228 Vali Loss: 4.052 Vali Acc: 0.500 Test Loss: 4.052 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.919032096862793
Epoch: 6, Steps: 70 | Train Loss: 1.951 Vali Loss: 3.088 Vali Acc: 0.500 Test Loss: 3.088 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.724531888961792
Epoch: 7, Steps: 70 | Train Loss: 2.568 Vali Loss: 4.358 Vali Acc: 0.500 Test Loss: 4.358 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 29.347719430923462
Epoch: 8, Steps: 70 | Train Loss: 5.294 Vali Loss: 2.444 Vali Acc: 0.500 Test Loss: 2.444 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.69419240951538
Epoch: 9, Steps: 70 | Train Loss: 1.959 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 29.678537845611572
Epoch: 10, Steps: 70 | Train Loss: 2.249 Vali Loss: 8.813 Vali Acc: 0.500 Test Loss: 8.813 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 27.32599115371704
Epoch: 11, Steps: 70 | Train Loss: 3.523 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499992).  Saving model ...
Epoch: 12 cost time: 30.869242906570435
Epoch: 12, Steps: 70 | Train Loss: 3.250 Vali Loss: 6.056 Vali Acc: 0.500 Test Loss: 6.056 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.962696075439453
Epoch: 13, Steps: 70 | Train Loss: 3.382 Vali Loss: 6.892 Vali Acc: 0.500 Test Loss: 6.892 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.53906226158142
Epoch: 14, Steps: 70 | Train Loss: 3.700 Vali Loss: 3.882 Vali Acc: 0.500 Test Loss: 3.882 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 29.216350078582764
Epoch: 15, Steps: 70 | Train Loss: 2.304 Vali Loss: 1.965 Vali Acc: 0.500 Test Loss: 1.965 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 27.61907982826233
Epoch: 16, Steps: 70 | Train Loss: 3.337 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 17 cost time: 19.834172248840332
Epoch: 17, Steps: 70 | Train Loss: 2.319 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.901310682296753
Epoch: 18, Steps: 70 | Train Loss: 1.510 Vali Loss: 2.062 Vali Acc: 0.500 Test Loss: 2.062 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 25.443246126174927
Epoch: 19, Steps: 70 | Train Loss: 1.670 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 22.361351251602173
Epoch: 20, Steps: 70 | Train Loss: 1.781 Vali Loss: 3.181 Vali Acc: 0.500 Test Loss: 3.181 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 26.095892667770386
Epoch: 21, Steps: 70 | Train Loss: 1.629 Vali Loss: 2.679 Vali Acc: 0.500 Test Loss: 2.679 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 28.005940675735474
Epoch: 22, Steps: 70 | Train Loss: 1.969 Vali Loss: 3.494 Vali Acc: 0.500 Test Loss: 3.494 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 29.131423234939575
Epoch: 23, Steps: 70 | Train Loss: 1.595 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 24.526412963867188
Epoch: 24, Steps: 70 | Train Loss: 1.185 Vali Loss: 2.266 Vali Acc: 0.500 Test Loss: 2.266 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 24.119694709777832
Epoch: 25, Steps: 70 | Train Loss: 1.293 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 29.52597427368164
Epoch: 26, Steps: 70 | Train Loss: 1.035 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 5331006
model size : 22.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.452143907546997
Epoch: 1, Steps: 70 | Train Loss: 1.396 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 26.383036375045776
Epoch: 2, Steps: 70 | Train Loss: 4.881 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.184173583984375
Epoch: 3, Steps: 70 | Train Loss: 2.376 Vali Loss: 1.807 Vali Acc: 0.500 Test Loss: 1.807 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.039767980575562
Epoch: 4, Steps: 70 | Train Loss: 1.287 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.895891189575195
Epoch: 5, Steps: 70 | Train Loss: 1.452 Vali Loss: 5.498 Vali Acc: 0.500 Test Loss: 5.498 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.21304965019226
Epoch: 6, Steps: 70 | Train Loss: 2.571 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.444474697113037
Epoch: 7, Steps: 70 | Train Loss: 1.537 Vali Loss: 5.001 Vali Acc: 0.500 Test Loss: 5.001 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 32.108630895614624
Epoch: 8, Steps: 70 | Train Loss: 2.108 Vali Loss: 2.357 Vali Acc: 0.500 Test Loss: 2.357 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 31.44062566757202
Epoch: 9, Steps: 70 | Train Loss: 1.229 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 29.208786964416504
Epoch: 10, Steps: 70 | Train Loss: 1.489 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 32.63537526130676
Epoch: 11, Steps: 70 | Train Loss: 2.595 Vali Loss: 0.973 Vali Acc: 0.490 Test Loss: 0.973 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 3206782
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.861883640289307
Epoch: 1, Steps: 70 | Train Loss: 2.192 Vali Loss: 8.773 Vali Acc: 0.500 Test Loss: 8.773 Test Acc: 0.500
Validation loss decreased (inf --> -0.499912).  Saving model ...
Epoch: 2 cost time: 31.8951895236969
Epoch: 2, Steps: 70 | Train Loss: 3.730 Vali Loss: 2.864 Vali Acc: 0.500 Test Loss: 2.864 Test Acc: 0.500
Validation loss decreased (-0.499912 --> -0.499971).  Saving model ...
Epoch: 3 cost time: 26.72278666496277
Epoch: 3, Steps: 70 | Train Loss: 1.463 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
Validation loss decreased (-0.499971 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 25.398775815963745
Epoch: 4, Steps: 70 | Train Loss: 1.983 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.731362342834473
Epoch: 5, Steps: 70 | Train Loss: 1.559 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.03876280784607
Epoch: 6, Steps: 70 | Train Loss: 2.013 Vali Loss: 1.480 Vali Acc: 0.500 Test Loss: 1.480 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.810373067855835
Epoch: 7, Steps: 70 | Train Loss: 1.867 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.740640878677368
Epoch: 8, Steps: 70 | Train Loss: 1.760 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 27.274330615997314
Epoch: 9, Steps: 70 | Train Loss: 2.348 Vali Loss: 2.780 Vali Acc: 0.500 Test Loss: 2.780 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 30.269910097122192
Epoch: 10, Steps: 70 | Train Loss: 1.341 Vali Loss: 2.100 Vali Acc: 0.510 Test Loss: 2.100 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.198437690734863
Epoch: 11, Steps: 70 | Train Loss: 1.757 Vali Loss: 3.335 Vali Acc: 0.500 Test Loss: 3.335 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.43506908416748
Epoch: 12, Steps: 70 | Train Loss: 1.348 Vali Loss: 2.313 Vali Acc: 0.500 Test Loss: 2.313 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.67765974998474
Epoch: 13, Steps: 70 | Train Loss: 1.765 Vali Loss: 7.862 Vali Acc: 0.500 Test Loss: 7.862 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 3176702
model size : 13.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.992077350616455
Epoch: 1, Steps: 70 | Train Loss: 2.823 Vali Loss: 2.680 Vali Acc: 0.500 Test Loss: 2.680 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 18.565473079681396
Epoch: 2, Steps: 70 | Train Loss: 3.645 Vali Loss: 3.438 Vali Acc: 0.500 Test Loss: 3.438 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.402776956558228
Epoch: 3, Steps: 70 | Train Loss: 2.140 Vali Loss: 2.279 Vali Acc: 0.500 Test Loss: 2.279 Test Acc: 0.500
Validation loss decreased (-0.499973 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 25.940999031066895
Epoch: 4, Steps: 70 | Train Loss: 1.336 Vali Loss: 1.187 Vali Acc: 0.510 Test Loss: 1.187 Test Acc: 0.510
Validation loss decreased (-0.499977 --> -0.509988).  Saving model ...
Epoch: 5 cost time: 29.133290767669678
Epoch: 5, Steps: 70 | Train Loss: 1.162 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.983680486679077
Epoch: 6, Steps: 70 | Train Loss: 2.114 Vali Loss: 2.104 Vali Acc: 0.500 Test Loss: 2.104 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.108909368515015
Epoch: 7, Steps: 70 | Train Loss: 2.384 Vali Loss: 0.680 Vali Acc: 0.560 Test Loss: 0.680 Test Acc: 0.560
Validation loss decreased (-0.509988 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 26.772655487060547
Epoch: 8, Steps: 70 | Train Loss: 1.632 Vali Loss: 0.695 Vali Acc: 0.610 Test Loss: 0.695 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 9 cost time: 27.31247854232788
Epoch: 9, Steps: 70 | Train Loss: 1.562 Vali Loss: 4.638 Vali Acc: 0.500 Test Loss: 4.638 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.3535475730896
Epoch: 10, Steps: 70 | Train Loss: 1.903 Vali Loss: 1.639 Vali Acc: 0.500 Test Loss: 1.639 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.814752101898193
Epoch: 11, Steps: 70 | Train Loss: 2.134 Vali Loss: 3.092 Vali Acc: 0.500 Test Loss: 3.092 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.164387702941895
Epoch: 12, Steps: 70 | Train Loss: 1.807 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.487851858139038
Epoch: 13, Steps: 70 | Train Loss: 1.615 Vali Loss: 3.023 Vali Acc: 0.500 Test Loss: 3.023 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 27.003614902496338
Epoch: 14, Steps: 70 | Train Loss: 2.563 Vali Loss: 3.262 Vali Acc: 0.500 Test Loss: 3.262 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.487518310546875
Epoch: 15, Steps: 70 | Train Loss: 1.660 Vali Loss: 2.548 Vali Acc: 0.500 Test Loss: 2.548 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 21.20564889907837
Epoch: 16, Steps: 70 | Train Loss: 1.698 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.056196928024292
Epoch: 17, Steps: 70 | Train Loss: 1.364 Vali Loss: 2.714 Vali Acc: 0.500 Test Loss: 2.714 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 20.960400342941284
Epoch: 18, Steps: 70 | Train Loss: 1.585 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3146622
model size : 13.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.757092714309692
Epoch: 1, Steps: 70 | Train Loss: 2.204 Vali Loss: 4.832 Vali Acc: 0.500 Test Loss: 4.832 Test Acc: 0.500
Validation loss decreased (inf --> -0.499952).  Saving model ...
Epoch: 2 cost time: 24.522022008895874
Epoch: 2, Steps: 70 | Train Loss: 2.800 Vali Loss: 7.148 Vali Acc: 0.500 Test Loss: 7.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.197792291641235
Epoch: 3, Steps: 70 | Train Loss: 2.959 Vali Loss: 1.753 Vali Acc: 0.500 Test Loss: 1.753 Test Acc: 0.500
Validation loss decreased (-0.499952 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 22.621318340301514
Epoch: 4, Steps: 70 | Train Loss: 2.157 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.057096242904663
Epoch: 5, Steps: 70 | Train Loss: 2.218 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.74688410758972
Epoch: 6, Steps: 70 | Train Loss: 2.350 Vali Loss: 2.155 Vali Acc: 0.500 Test Loss: 2.155 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.651169776916504
Epoch: 7, Steps: 70 | Train Loss: 3.158 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499991).  Saving model ...
Epoch: 8 cost time: 25.67278027534485
Epoch: 8, Steps: 70 | Train Loss: 1.756 Vali Loss: 1.055 Vali Acc: 0.470 Test Loss: 1.055 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.828955173492432
Epoch: 9, Steps: 70 | Train Loss: 1.531 Vali Loss: 1.531 Vali Acc: 0.520 Test Loss: 1.531 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519985).  Saving model ...
Epoch: 10 cost time: 24.38388752937317
Epoch: 10, Steps: 70 | Train Loss: 2.827 Vali Loss: 1.898 Vali Acc: 0.490 Test Loss: 1.898 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.28233766555786
Epoch: 11, Steps: 70 | Train Loss: 1.862 Vali Loss: 2.554 Vali Acc: 0.470 Test Loss: 2.554 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.39260506629944
Epoch: 12, Steps: 70 | Train Loss: 1.756 Vali Loss: 3.113 Vali Acc: 0.480 Test Loss: 3.113 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.834089279174805
Epoch: 13, Steps: 70 | Train Loss: 2.845 Vali Loss: 2.053 Vali Acc: 0.490 Test Loss: 2.053 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.55193829536438
Epoch: 14, Steps: 70 | Train Loss: 1.719 Vali Loss: 1.720 Vali Acc: 0.520 Test Loss: 1.720 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.79384970664978
Epoch: 15, Steps: 70 | Train Loss: 1.428 Vali Loss: 3.192 Vali Acc: 0.500 Test Loss: 3.192 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.190053701400757
Epoch: 16, Steps: 70 | Train Loss: 1.877 Vali Loss: 3.797 Vali Acc: 0.500 Test Loss: 3.797 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.334826707839966
Epoch: 17, Steps: 70 | Train Loss: 1.668 Vali Loss: 1.767 Vali Acc: 0.500 Test Loss: 1.767 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.261919260025024
Epoch: 18, Steps: 70 | Train Loss: 1.333 Vali Loss: 1.444 Vali Acc: 0.510 Test Loss: 1.444 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 24.066547870635986
Epoch: 19, Steps: 70 | Train Loss: 1.652 Vali Loss: 0.986 Vali Acc: 0.500 Test Loss: 0.986 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 3116542
model size : 13.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.72819948196411
Epoch: 1, Steps: 70 | Train Loss: 2.633 Vali Loss: 8.276 Vali Acc: 0.500 Test Loss: 8.276 Test Acc: 0.500
Validation loss decreased (inf --> -0.499917).  Saving model ...
Epoch: 2 cost time: 19.878092050552368
Epoch: 2, Steps: 70 | Train Loss: 2.345 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
Validation loss decreased (-0.499917 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 23.819920778274536
Epoch: 3, Steps: 70 | Train Loss: 1.621 Vali Loss: 0.794 Vali Acc: 0.450 Test Loss: 0.794 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.306025981903076
Epoch: 4, Steps: 70 | Train Loss: 1.743 Vali Loss: 3.317 Vali Acc: 0.500 Test Loss: 3.317 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.674657344818115
Epoch: 5, Steps: 70 | Train Loss: 2.759 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 18.88890051841736
Epoch: 6, Steps: 70 | Train Loss: 1.455 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.58070659637451
Epoch: 7, Steps: 70 | Train Loss: 1.605 Vali Loss: 7.192 Vali Acc: 0.500 Test Loss: 7.192 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.382964849472046
Epoch: 8, Steps: 70 | Train Loss: 3.572 Vali Loss: 3.488 Vali Acc: 0.500 Test Loss: 3.488 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.442237615585327
Epoch: 9, Steps: 70 | Train Loss: 2.090 Vali Loss: 2.044 Vali Acc: 0.500 Test Loss: 2.044 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.011003017425537
Epoch: 10, Steps: 70 | Train Loss: 1.351 Vali Loss: 2.875 Vali Acc: 0.500 Test Loss: 2.875 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.14224648475647
Epoch: 11, Steps: 70 | Train Loss: 2.185 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.02426242828369
Epoch: 12, Steps: 70 | Train Loss: 1.163 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519991).  Saving model ...
Epoch: 13 cost time: 27.726990222930908
Epoch: 13, Steps: 70 | Train Loss: 1.483 Vali Loss: 3.751 Vali Acc: 0.500 Test Loss: 3.751 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.416520595550537
Epoch: 14, Steps: 70 | Train Loss: 1.394 Vali Loss: 2.547 Vali Acc: 0.500 Test Loss: 2.547 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.85996699333191
Epoch: 15, Steps: 70 | Train Loss: 1.949 Vali Loss: 1.208 Vali Acc: 0.530 Test Loss: 1.208 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529988).  Saving model ...
Epoch: 16 cost time: 13.278820514678955
Epoch: 16, Steps: 70 | Train Loss: 1.930 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.664042711257935
Epoch: 17, Steps: 70 | Train Loss: 3.742 Vali Loss: 6.353 Vali Acc: 0.500 Test Loss: 6.353 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.86984133720398
Epoch: 18, Steps: 70 | Train Loss: 6.060 Vali Loss: 2.008 Vali Acc: 0.520 Test Loss: 2.008 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 25.58043909072876
Epoch: 19, Steps: 70 | Train Loss: 4.513 Vali Loss: 9.597 Vali Acc: 0.500 Test Loss: 9.597 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.155253648757935
Epoch: 20, Steps: 70 | Train Loss: 4.162 Vali Loss: 1.986 Vali Acc: 0.450 Test Loss: 1.986 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.46698236465454
Epoch: 21, Steps: 70 | Train Loss: 1.675 Vali Loss: 2.310 Vali Acc: 0.650 Test Loss: 2.310 Test Acc: 0.650
Validation loss decreased (-0.529988 --> -0.649977).  Saving model ...
Epoch: 22 cost time: 20.537626266479492
Epoch: 22, Steps: 70 | Train Loss: 2.100 Vali Loss: 3.539 Vali Acc: 0.500 Test Loss: 3.539 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.968162536621094
Epoch: 23, Steps: 70 | Train Loss: 1.661 Vali Loss: 1.362 Vali Acc: 0.560 Test Loss: 1.362 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 16.178042888641357
Epoch: 24, Steps: 70 | Train Loss: 1.631 Vali Loss: 1.390 Vali Acc: 0.610 Test Loss: 1.390 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.325082540512085
Epoch: 25, Steps: 70 | Train Loss: 2.574 Vali Loss: 4.180 Vali Acc: 0.620 Test Loss: 4.180 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 16.65019917488098
Epoch: 26, Steps: 70 | Train Loss: 1.945 Vali Loss: 2.357 Vali Acc: 0.560 Test Loss: 2.357 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 22.511791229248047
Epoch: 27, Steps: 70 | Train Loss: 1.683 Vali Loss: 1.526 Vali Acc: 0.620 Test Loss: 1.526 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 22.304941654205322
Epoch: 28, Steps: 70 | Train Loss: 1.493 Vali Loss: 2.237 Vali Acc: 0.510 Test Loss: 2.237 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 25.045772552490234
Epoch: 29, Steps: 70 | Train Loss: 1.334 Vali Loss: 3.680 Vali Acc: 0.490 Test Loss: 3.680 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 24.049914121627808
Epoch: 30, Steps: 70 | Train Loss: 1.536 Vali Loss: 1.813 Vali Acc: 0.550 Test Loss: 1.813 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 24.96925687789917
Epoch: 31, Steps: 70 | Train Loss: 1.081 Vali Loss: 1.784 Vali Acc: 0.600 Test Loss: 1.784 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 2612350
model size : 11.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.353158473968506
Epoch: 1, Steps: 70 | Train Loss: 3.055 Vali Loss: 5.250 Vali Acc: 0.500 Test Loss: 5.250 Test Acc: 0.500
Validation loss decreased (inf --> -0.499947).  Saving model ...
Epoch: 2 cost time: 23.607730627059937
Epoch: 2, Steps: 70 | Train Loss: 3.779 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
Validation loss decreased (-0.499947 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 20.30989718437195
Epoch: 3, Steps: 70 | Train Loss: 1.953 Vali Loss: 2.664 Vali Acc: 0.500 Test Loss: 2.664 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.953858613967896
Epoch: 4, Steps: 70 | Train Loss: 1.385 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.53045392036438
Epoch: 5, Steps: 70 | Train Loss: 1.947 Vali Loss: 1.783 Vali Acc: 0.500 Test Loss: 1.783 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.502206563949585
Epoch: 6, Steps: 70 | Train Loss: 1.316 Vali Loss: 4.745 Vali Acc: 0.500 Test Loss: 4.745 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.292255878448486
Epoch: 7, Steps: 70 | Train Loss: 1.560 Vali Loss: 1.046 Vali Acc: 0.480 Test Loss: 1.046 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.028826475143433
Epoch: 8, Steps: 70 | Train Loss: 1.491 Vali Loss: 4.459 Vali Acc: 0.500 Test Loss: 4.459 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.872284650802612
Epoch: 9, Steps: 70 | Train Loss: 1.849 Vali Loss: 2.015 Vali Acc: 0.500 Test Loss: 2.015 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 21.479050636291504
Epoch: 10, Steps: 70 | Train Loss: 1.719 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 19.984434604644775
Epoch: 11, Steps: 70 | Train Loss: 1.367 Vali Loss: 6.791 Vali Acc: 0.500 Test Loss: 6.791 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 23.079065561294556
Epoch: 12, Steps: 70 | Train Loss: 1.950 Vali Loss: 2.518 Vali Acc: 0.500 Test Loss: 2.518 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 2582270
model size : 11.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.006449222564697
Epoch: 1, Steps: 70 | Train Loss: 2.393 Vali Loss: 1.944 Vali Acc: 0.500 Test Loss: 1.944 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 20.596951007843018
Epoch: 2, Steps: 70 | Train Loss: 2.654 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 21.775341987609863
Epoch: 3, Steps: 70 | Train Loss: 1.876 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.323792695999146
Epoch: 4, Steps: 70 | Train Loss: 1.754 Vali Loss: 5.225 Vali Acc: 0.500 Test Loss: 5.225 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.580390453338623
Epoch: 5, Steps: 70 | Train Loss: 2.616 Vali Loss: 2.321 Vali Acc: 0.500 Test Loss: 2.321 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.6563982963562
Epoch: 6, Steps: 70 | Train Loss: 1.722 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 18.865957975387573
Epoch: 7, Steps: 70 | Train Loss: 1.223 Vali Loss: 3.669 Vali Acc: 0.500 Test Loss: 3.669 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.179296493530273
Epoch: 8, Steps: 70 | Train Loss: 2.455 Vali Loss: 3.958 Vali Acc: 0.500 Test Loss: 3.958 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.86473560333252
Epoch: 9, Steps: 70 | Train Loss: 1.786 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.102946996688843
Epoch: 10, Steps: 70 | Train Loss: 1.991 Vali Loss: 2.475 Vali Acc: 0.500 Test Loss: 2.475 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.812846422195435
Epoch: 11, Steps: 70 | Train Loss: 2.240 Vali Loss: 0.771 Vali Acc: 0.620 Test Loss: 0.771 Test Acc: 0.620
Validation loss decreased (-0.509992 --> -0.619992).  Saving model ...
Epoch: 12 cost time: 18.49443030357361
Epoch: 12, Steps: 70 | Train Loss: 2.132 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.888288497924805
Epoch: 13, Steps: 70 | Train Loss: 1.687 Vali Loss: 3.295 Vali Acc: 0.500 Test Loss: 3.295 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.013561248779297
Epoch: 14, Steps: 70 | Train Loss: 2.220 Vali Loss: 6.048 Vali Acc: 0.500 Test Loss: 6.048 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.118370056152344
Epoch: 15, Steps: 70 | Train Loss: 1.923 Vali Loss: 5.090 Vali Acc: 0.500 Test Loss: 5.090 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.950636386871338
Epoch: 16, Steps: 70 | Train Loss: 1.347 Vali Loss: 2.585 Vali Acc: 0.500 Test Loss: 2.585 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.49431037902832
Epoch: 17, Steps: 70 | Train Loss: 0.984 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 23.659281969070435
Epoch: 18, Steps: 70 | Train Loss: 1.635 Vali Loss: 1.946 Vali Acc: 0.500 Test Loss: 1.946 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 19.1812744140625
Epoch: 19, Steps: 70 | Train Loss: 1.931 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.094343900680542
Epoch: 20, Steps: 70 | Train Loss: 1.369 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.395057678222656
Epoch: 21, Steps: 70 | Train Loss: 1.344 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2552190
model size : 11.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.623097896575928
Epoch: 1, Steps: 70 | Train Loss: 2.388 Vali Loss: 1.165 Vali Acc: 0.530 Test Loss: 1.165 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 27.854767322540283
Epoch: 2, Steps: 70 | Train Loss: 2.383 Vali Loss: 6.185 Vali Acc: 0.500 Test Loss: 6.185 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.89330983161926
Epoch: 3, Steps: 70 | Train Loss: 3.190 Vali Loss: 0.700 Vali Acc: 0.470 Test Loss: 0.700 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.21433973312378
Epoch: 4, Steps: 70 | Train Loss: 2.090 Vali Loss: 4.516 Vali Acc: 0.500 Test Loss: 4.516 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 28.450385570526123
Epoch: 5, Steps: 70 | Train Loss: 1.806 Vali Loss: 2.516 Vali Acc: 0.500 Test Loss: 2.516 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 29.406028032302856
Epoch: 6, Steps: 70 | Train Loss: 1.725 Vali Loss: 3.838 Vali Acc: 0.500 Test Loss: 3.838 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 31.646475076675415
Epoch: 7, Steps: 70 | Train Loss: 1.792 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 31.144449472427368
Epoch: 8, Steps: 70 | Train Loss: 2.343 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 24.063673496246338
Epoch: 9, Steps: 70 | Train Loss: 2.028 Vali Loss: 0.668 Vali Acc: 0.610 Test Loss: 0.668 Test Acc: 0.610
Validation loss decreased (-0.529988 --> -0.609993).  Saving model ...
Epoch: 10 cost time: 28.21826934814453
Epoch: 10, Steps: 70 | Train Loss: 1.398 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.886685848236084
Epoch: 11, Steps: 70 | Train Loss: 1.728 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 30.57077932357788
Epoch: 12, Steps: 70 | Train Loss: 1.340 Vali Loss: 3.548 Vali Acc: 0.500 Test Loss: 3.548 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 27.241127014160156
Epoch: 13, Steps: 70 | Train Loss: 2.213 Vali Loss: 1.712 Vali Acc: 0.500 Test Loss: 1.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.833323001861572
Epoch: 14, Steps: 70 | Train Loss: 1.589 Vali Loss: 3.544 Vali Acc: 0.500 Test Loss: 3.544 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 31.635753393173218
Epoch: 15, Steps: 70 | Train Loss: 1.376 Vali Loss: 3.395 Vali Acc: 0.500 Test Loss: 3.395 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 30.52515745162964
Epoch: 16, Steps: 70 | Train Loss: 1.857 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.6653470993042
Epoch: 17, Steps: 70 | Train Loss: 1.289 Vali Loss: 1.869 Vali Acc: 0.500 Test Loss: 1.869 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.35274577140808
Epoch: 18, Steps: 70 | Train Loss: 1.495 Vali Loss: 3.471 Vali Acc: 0.500 Test Loss: 3.471 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 28.711856842041016
Epoch: 19, Steps: 70 | Train Loss: 1.284 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2522110
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.469302892684937
Epoch: 1, Steps: 70 | Train Loss: 1.296 Vali Loss: 1.667 Vali Acc: 0.510 Test Loss: 1.667 Test Acc: 0.510
Validation loss decreased (inf --> -0.509983).  Saving model ...
Epoch: 2 cost time: 23.577392101287842
Epoch: 2, Steps: 70 | Train Loss: 3.014 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.45322299003601
Epoch: 3, Steps: 70 | Train Loss: 1.723 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.6846706867218
Epoch: 4, Steps: 70 | Train Loss: 2.666 Vali Loss: 7.566 Vali Acc: 0.500 Test Loss: 7.566 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.804166555404663
Epoch: 5, Steps: 70 | Train Loss: 2.757 Vali Loss: 1.780 Vali Acc: 0.500 Test Loss: 1.780 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.57310652732849
Epoch: 6, Steps: 70 | Train Loss: 1.656 Vali Loss: 1.009 Vali Acc: 0.480 Test Loss: 1.009 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 23.42637848854065
Epoch: 7, Steps: 70 | Train Loss: 2.636 Vali Loss: 4.278 Vali Acc: 0.500 Test Loss: 4.278 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 26.2758309841156
Epoch: 8, Steps: 70 | Train Loss: 2.747 Vali Loss: 4.464 Vali Acc: 0.500 Test Loss: 4.464 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 29.67633843421936
Epoch: 9, Steps: 70 | Train Loss: 1.989 Vali Loss: 1.823 Vali Acc: 0.500 Test Loss: 1.823 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 24.69392728805542
Epoch: 10, Steps: 70 | Train Loss: 1.403 Vali Loss: 2.006 Vali Acc: 0.510 Test Loss: 2.006 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 29.405062913894653
Epoch: 11, Steps: 70 | Train Loss: 2.435 Vali Loss: 7.009 Vali Acc: 0.500 Test Loss: 7.009 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 2315134
model size : 10.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.12903332710266
Epoch: 1, Steps: 70 | Train Loss: 3.779 Vali Loss: 5.638 Vali Acc: 0.490 Test Loss: 5.638 Test Acc: 0.490
Validation loss decreased (inf --> -0.489944).  Saving model ...
Epoch: 2 cost time: 16.26918888092041
Epoch: 2, Steps: 70 | Train Loss: 5.152 Vali Loss: 3.356 Vali Acc: 0.500 Test Loss: 3.356 Test Acc: 0.500
Validation loss decreased (-0.489944 --> -0.499966).  Saving model ...
Epoch: 3 cost time: 26.50711226463318
Epoch: 3, Steps: 70 | Train Loss: 2.389 Vali Loss: 8.418 Vali Acc: 0.500 Test Loss: 8.418 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.350130319595337
Epoch: 4, Steps: 70 | Train Loss: 1.989 Vali Loss: 6.098 Vali Acc: 0.500 Test Loss: 6.098 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 29.33259677886963
Epoch: 5, Steps: 70 | Train Loss: 3.277 Vali Loss: 2.460 Vali Acc: 0.500 Test Loss: 2.460 Test Acc: 0.500
Validation loss decreased (-0.499966 --> -0.499975).  Saving model ...
Epoch: 6 cost time: 23.7102952003479
Epoch: 6, Steps: 70 | Train Loss: 1.500 Vali Loss: 3.021 Vali Acc: 0.500 Test Loss: 3.021 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.528117656707764
Epoch: 7, Steps: 70 | Train Loss: 1.772 Vali Loss: 0.896 Vali Acc: 0.440 Test Loss: 0.896 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.71039891242981
Epoch: 8, Steps: 70 | Train Loss: 2.139 Vali Loss: 1.952 Vali Acc: 0.500 Test Loss: 1.952 Test Acc: 0.500
Validation loss decreased (-0.499975 --> -0.499980).  Saving model ...
Epoch: 9 cost time: 25.933398723602295
Epoch: 9, Steps: 70 | Train Loss: 1.729 Vali Loss: 6.086 Vali Acc: 0.500 Test Loss: 6.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.59048080444336
Epoch: 10, Steps: 70 | Train Loss: 2.507 Vali Loss: 2.477 Vali Acc: 0.500 Test Loss: 2.477 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.845686435699463
Epoch: 11, Steps: 70 | Train Loss: 1.700 Vali Loss: 2.999 Vali Acc: 0.500 Test Loss: 2.999 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.27214479446411
Epoch: 12, Steps: 70 | Train Loss: 1.195 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 20.57027316093445
Epoch: 13, Steps: 70 | Train Loss: 1.534 Vali Loss: 5.779 Vali Acc: 0.500 Test Loss: 5.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.347280979156494
Epoch: 14, Steps: 70 | Train Loss: 1.815 Vali Loss: 1.902 Vali Acc: 0.570 Test Loss: 1.902 Test Acc: 0.570
Validation loss decreased (-0.499987 --> -0.569981).  Saving model ...
Epoch: 15 cost time: 18.564887762069702
Epoch: 15, Steps: 70 | Train Loss: 1.703 Vali Loss: 3.476 Vali Acc: 0.500 Test Loss: 3.476 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.775357961654663
Epoch: 16, Steps: 70 | Train Loss: 1.126 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 26.88602900505066
Epoch: 17, Steps: 70 | Train Loss: 1.000 Vali Loss: 3.860 Vali Acc: 0.570 Test Loss: 3.860 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 26.682051420211792
Epoch: 18, Steps: 70 | Train Loss: 0.942 Vali Loss: 2.654 Vali Acc: 0.490 Test Loss: 2.654 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.935678243637085
Epoch: 19, Steps: 70 | Train Loss: 1.383 Vali Loss: 1.922 Vali Acc: 0.560 Test Loss: 1.922 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 25.25731921195984
Epoch: 20, Steps: 70 | Train Loss: 0.837 Vali Loss: 2.550 Vali Acc: 0.470 Test Loss: 2.550 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.993346691131592
Epoch: 21, Steps: 70 | Train Loss: 0.496 Vali Loss: 4.098 Vali Acc: 0.500 Test Loss: 4.098 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 25.353759765625
Epoch: 22, Steps: 70 | Train Loss: 0.825 Vali Loss: 3.921 Vali Acc: 0.540 Test Loss: 3.921 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 20.638261079788208
Epoch: 23, Steps: 70 | Train Loss: 0.590 Vali Loss: 7.645 Vali Acc: 0.530 Test Loss: 7.645 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 19.889265537261963
Epoch: 24, Steps: 70 | Train Loss: 0.749 Vali Loss: 3.582 Vali Acc: 0.530 Test Loss: 3.582 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2285054
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.11923313140869
Epoch: 1, Steps: 70 | Train Loss: 2.016 Vali Loss: 1.046 Vali Acc: 0.460 Test Loss: 1.046 Test Acc: 0.460
Validation loss decreased (inf --> -0.459990).  Saving model ...
Epoch: 2 cost time: 17.67955994606018
Epoch: 2, Steps: 70 | Train Loss: 3.851 Vali Loss: 6.583 Vali Acc: 0.500 Test Loss: 6.583 Test Acc: 0.500
Validation loss decreased (-0.459990 --> -0.499934).  Saving model ...
Epoch: 3 cost time: 18.570059537887573
Epoch: 3, Steps: 70 | Train Loss: 3.562 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
Validation loss decreased (-0.499934 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 21.267576694488525
Epoch: 4, Steps: 70 | Train Loss: 1.752 Vali Loss: 2.129 Vali Acc: 0.500 Test Loss: 2.129 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.771280765533447
Epoch: 5, Steps: 70 | Train Loss: 1.956 Vali Loss: 1.434 Vali Acc: 0.500 Test Loss: 1.434 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.89773440361023
Epoch: 6, Steps: 70 | Train Loss: 3.174 Vali Loss: 6.768 Vali Acc: 0.500 Test Loss: 6.768 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.570027828216553
Epoch: 7, Steps: 70 | Train Loss: 1.604 Vali Loss: 5.904 Vali Acc: 0.500 Test Loss: 5.904 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.52666139602661
Epoch: 8, Steps: 70 | Train Loss: 2.310 Vali Loss: 3.123 Vali Acc: 0.500 Test Loss: 3.123 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.799322366714478
Epoch: 9, Steps: 70 | Train Loss: 1.953 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 19.917288303375244
Epoch: 10, Steps: 70 | Train Loss: 2.129 Vali Loss: 4.608 Vali Acc: 0.500 Test Loss: 4.608 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.163212060928345
Epoch: 11, Steps: 70 | Train Loss: 1.587 Vali Loss: 4.127 Vali Acc: 0.500 Test Loss: 4.127 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.21893286705017
Epoch: 12, Steps: 70 | Train Loss: 1.564 Vali Loss: 1.503 Vali Acc: 0.480 Test Loss: 1.503 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.20065999031067
Epoch: 13, Steps: 70 | Train Loss: 1.088 Vali Loss: 5.629 Vali Acc: 0.500 Test Loss: 5.629 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.47478461265564
Epoch: 14, Steps: 70 | Train Loss: 1.963 Vali Loss: 1.436 Vali Acc: 0.480 Test Loss: 1.436 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.378626585006714
Epoch: 15, Steps: 70 | Train Loss: 1.306 Vali Loss: 1.992 Vali Acc: 0.570 Test Loss: 1.992 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569980).  Saving model ...
Epoch: 16 cost time: 17.32632613182068
Epoch: 16, Steps: 70 | Train Loss: 1.399 Vali Loss: 1.542 Vali Acc: 0.590 Test Loss: 1.542 Test Acc: 0.590
Validation loss decreased (-0.569980 --> -0.589985).  Saving model ...
Epoch: 17 cost time: 20.85084319114685
Epoch: 17, Steps: 70 | Train Loss: 1.274 Vali Loss: 4.653 Vali Acc: 0.520 Test Loss: 4.653 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.675997257232666
Epoch: 18, Steps: 70 | Train Loss: 1.186 Vali Loss: 3.911 Vali Acc: 0.560 Test Loss: 3.911 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.829453468322754
Epoch: 19, Steps: 70 | Train Loss: 1.823 Vali Loss: 3.671 Vali Acc: 0.500 Test Loss: 3.671 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.47135877609253
Epoch: 20, Steps: 70 | Train Loss: 1.872 Vali Loss: 2.144 Vali Acc: 0.500 Test Loss: 2.144 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 16.007815837860107
Epoch: 21, Steps: 70 | Train Loss: 1.589 Vali Loss: 3.498 Vali Acc: 0.500 Test Loss: 3.498 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.290952682495117
Epoch: 22, Steps: 70 | Train Loss: 1.165 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 18.110121726989746
Epoch: 23, Steps: 70 | Train Loss: 1.452 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 26.595691442489624
Epoch: 24, Steps: 70 | Train Loss: 1.019 Vali Loss: 1.481 Vali Acc: 0.520 Test Loss: 1.481 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 28.715603828430176
Epoch: 25, Steps: 70 | Train Loss: 1.888 Vali Loss: 2.808 Vali Acc: 0.520 Test Loss: 2.808 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 24.318657875061035
Epoch: 26, Steps: 70 | Train Loss: 0.865 Vali Loss: 2.482 Vali Acc: 0.510 Test Loss: 2.482 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2254974
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.54490065574646
Epoch: 1, Steps: 70 | Train Loss: 3.410 Vali Loss: 4.684 Vali Acc: 0.490 Test Loss: 4.684 Test Acc: 0.490
Validation loss decreased (inf --> -0.489953).  Saving model ...
Epoch: 2 cost time: 18.18764042854309
Epoch: 2, Steps: 70 | Train Loss: 3.076 Vali Loss: 1.716 Vali Acc: 0.500 Test Loss: 1.716 Test Acc: 0.500
Validation loss decreased (-0.489953 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 24.884132862091064
Epoch: 3, Steps: 70 | Train Loss: 2.301 Vali Loss: 5.014 Vali Acc: 0.500 Test Loss: 5.014 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.374940156936646
Epoch: 4, Steps: 70 | Train Loss: 2.779 Vali Loss: 2.624 Vali Acc: 0.500 Test Loss: 2.624 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.52379274368286
Epoch: 5, Steps: 70 | Train Loss: 2.048 Vali Loss: 1.517 Vali Acc: 0.500 Test Loss: 1.517 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 15.45649242401123
Epoch: 6, Steps: 70 | Train Loss: 1.681 Vali Loss: 1.625 Vali Acc: 0.500 Test Loss: 1.625 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.670202493667603
Epoch: 7, Steps: 70 | Train Loss: 1.771 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499991).  Saving model ...
Epoch: 8 cost time: 28.354549169540405
Epoch: 8, Steps: 70 | Train Loss: 1.841 Vali Loss: 2.744 Vali Acc: 0.500 Test Loss: 2.744 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.279407739639282
Epoch: 9, Steps: 70 | Train Loss: 1.403 Vali Loss: 4.508 Vali Acc: 0.500 Test Loss: 4.508 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.591169595718384
Epoch: 10, Steps: 70 | Train Loss: 2.128 Vali Loss: 2.902 Vali Acc: 0.500 Test Loss: 2.902 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.767120361328125
Epoch: 11, Steps: 70 | Train Loss: 1.585 Vali Loss: 5.294 Vali Acc: 0.480 Test Loss: 5.294 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.826430320739746
Epoch: 12, Steps: 70 | Train Loss: 1.508 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 13 cost time: 16.764694452285767
Epoch: 13, Steps: 70 | Train Loss: 1.390 Vali Loss: 3.099 Vali Acc: 0.500 Test Loss: 3.099 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.452183485031128
Epoch: 14, Steps: 70 | Train Loss: 1.852 Vali Loss: 2.136 Vali Acc: 0.500 Test Loss: 2.136 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.95812153816223
Epoch: 15, Steps: 70 | Train Loss: 1.466 Vali Loss: 1.341 Vali Acc: 0.540 Test Loss: 1.341 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539987).  Saving model ...
Epoch: 16 cost time: 27.54608726501465
Epoch: 16, Steps: 70 | Train Loss: 1.776 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539992).  Saving model ...
Epoch: 17 cost time: 18.3765766620636
Epoch: 17, Steps: 70 | Train Loss: 1.202 Vali Loss: 0.980 Vali Acc: 0.490 Test Loss: 0.980 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.097413539886475
Epoch: 18, Steps: 70 | Train Loss: 1.548 Vali Loss: 1.133 Vali Acc: 0.450 Test Loss: 1.133 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.361199617385864
Epoch: 19, Steps: 70 | Train Loss: 1.581 Vali Loss: 5.150 Vali Acc: 0.500 Test Loss: 5.150 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 25.832308292388916
Epoch: 20, Steps: 70 | Train Loss: 1.412 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 22.4480984210968
Epoch: 21, Steps: 70 | Train Loss: 1.235 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 26.388113260269165
Epoch: 22, Steps: 70 | Train Loss: 1.402 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 18.895585775375366
Epoch: 23, Steps: 70 | Train Loss: 1.166 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 22.682807445526123
Epoch: 24, Steps: 70 | Train Loss: 1.358 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 23.749889373779297
Epoch: 25, Steps: 70 | Train Loss: 1.097 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 25.907454013824463
Epoch: 26, Steps: 70 | Train Loss: 1.045 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 2224894
model size : 9.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.483577251434326
Epoch: 1, Steps: 70 | Train Loss: 1.871 Vali Loss: 5.513 Vali Acc: 0.500 Test Loss: 5.513 Test Acc: 0.500
Validation loss decreased (inf --> -0.499945).  Saving model ...
Epoch: 2 cost time: 24.320180416107178
Epoch: 2, Steps: 70 | Train Loss: 3.570 Vali Loss: 0.915 Vali Acc: 0.490 Test Loss: 0.915 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.045448541641235
Epoch: 3, Steps: 70 | Train Loss: 2.702 Vali Loss: 4.053 Vali Acc: 0.500 Test Loss: 4.053 Test Acc: 0.500
Validation loss decreased (-0.499945 --> -0.499959).  Saving model ...
Epoch: 4 cost time: 22.99501657485962
Epoch: 4, Steps: 70 | Train Loss: 1.578 Vali Loss: 2.652 Vali Acc: 0.500 Test Loss: 2.652 Test Acc: 0.500
Validation loss decreased (-0.499959 --> -0.499973).  Saving model ...
Epoch: 5 cost time: 27.37379479408264
Epoch: 5, Steps: 70 | Train Loss: 2.110 Vali Loss: 4.529 Vali Acc: 0.500 Test Loss: 4.529 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.291615962982178
Epoch: 6, Steps: 70 | Train Loss: 1.864 Vali Loss: 1.646 Vali Acc: 0.510 Test Loss: 1.646 Test Acc: 0.510
Validation loss decreased (-0.499973 --> -0.509984).  Saving model ...
Epoch: 7 cost time: 18.233986854553223
Epoch: 7, Steps: 70 | Train Loss: 1.729 Vali Loss: 1.799 Vali Acc: 0.500 Test Loss: 1.799 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.846745014190674
Epoch: 8, Steps: 70 | Train Loss: 1.999 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.467701196670532
Epoch: 9, Steps: 70 | Train Loss: 2.625 Vali Loss: 1.414 Vali Acc: 0.500 Test Loss: 1.414 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.448848485946655
Epoch: 10, Steps: 70 | Train Loss: 2.094 Vali Loss: 1.509 Vali Acc: 0.500 Test Loss: 1.509 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.51646089553833
Epoch: 11, Steps: 70 | Train Loss: 2.520 Vali Loss: 2.801 Vali Acc: 0.500 Test Loss: 2.801 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.188629388809204
Epoch: 12, Steps: 70 | Train Loss: 2.110 Vali Loss: 4.275 Vali Acc: 0.500 Test Loss: 4.275 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 25.53083562850952
Epoch: 13, Steps: 70 | Train Loss: 1.900 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.872442483901978
Epoch: 14, Steps: 70 | Train Loss: 2.557 Vali Loss: 5.395 Vali Acc: 0.500 Test Loss: 5.395 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.13267755508423
Epoch: 15, Steps: 70 | Train Loss: 2.764 Vali Loss: 7.880 Vali Acc: 0.500 Test Loss: 7.880 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.457935571670532
Epoch: 16, Steps: 70 | Train Loss: 3.194 Vali Loss: 1.046 Vali Acc: 0.490 Test Loss: 1.046 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 2166526
model size : 9.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.090745449066162
Epoch: 1, Steps: 70 | Train Loss: 1.700 Vali Loss: 7.070 Vali Acc: 0.500 Test Loss: 7.070 Test Acc: 0.500
Validation loss decreased (inf --> -0.499929).  Saving model ...
Epoch: 2 cost time: 21.57883048057556
Epoch: 2, Steps: 70 | Train Loss: 2.199 Vali Loss: 2.616 Vali Acc: 0.500 Test Loss: 2.616 Test Acc: 0.500
Validation loss decreased (-0.499929 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 25.687834978103638
Epoch: 3, Steps: 70 | Train Loss: 1.955 Vali Loss: 0.691 Vali Acc: 0.610 Test Loss: 0.691 Test Acc: 0.610
Validation loss decreased (-0.499974 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 18.89157247543335
Epoch: 4, Steps: 70 | Train Loss: 2.667 Vali Loss: 6.101 Vali Acc: 0.500 Test Loss: 6.101 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.942747116088867
Epoch: 5, Steps: 70 | Train Loss: 3.272 Vali Loss: 2.581 Vali Acc: 0.500 Test Loss: 2.581 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.863682746887207
Epoch: 6, Steps: 70 | Train Loss: 1.773 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.137656211853027
Epoch: 7, Steps: 70 | Train Loss: 1.848 Vali Loss: 2.177 Vali Acc: 0.500 Test Loss: 2.177 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.190214157104492
Epoch: 8, Steps: 70 | Train Loss: 1.921 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.355046033859253
Epoch: 9, Steps: 70 | Train Loss: 1.792 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.943066596984863
Epoch: 10, Steps: 70 | Train Loss: 1.922 Vali Loss: 4.266 Vali Acc: 0.500 Test Loss: 4.266 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.730026721954346
Epoch: 11, Steps: 70 | Train Loss: 1.844 Vali Loss: 0.918 Vali Acc: 0.450 Test Loss: 0.918 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.80962038040161
Epoch: 12, Steps: 70 | Train Loss: 1.391 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.105777263641357
Epoch: 13, Steps: 70 | Train Loss: 1.277 Vali Loss: 1.167 Vali Acc: 0.490 Test Loss: 1.167 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2136446
model size : 9.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.563828229904175
Epoch: 1, Steps: 70 | Train Loss: 1.808 Vali Loss: 4.817 Vali Acc: 0.500 Test Loss: 4.817 Test Acc: 0.500
Validation loss decreased (inf --> -0.499952).  Saving model ...
Epoch: 2 cost time: 26.412103414535522
Epoch: 2, Steps: 70 | Train Loss: 2.922 Vali Loss: 3.629 Vali Acc: 0.500 Test Loss: 3.629 Test Acc: 0.500
Validation loss decreased (-0.499952 --> -0.499964).  Saving model ...
Epoch: 3 cost time: 23.53719973564148
Epoch: 3, Steps: 70 | Train Loss: 2.200 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
Validation loss decreased (-0.499964 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 28.31905770301819
Epoch: 4, Steps: 70 | Train Loss: 2.078 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.090264081954956
Epoch: 5, Steps: 70 | Train Loss: 1.659 Vali Loss: 3.096 Vali Acc: 0.500 Test Loss: 3.096 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.514428853988647
Epoch: 6, Steps: 70 | Train Loss: 2.134 Vali Loss: 2.138 Vali Acc: 0.500 Test Loss: 2.138 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.79361128807068
Epoch: 7, Steps: 70 | Train Loss: 2.476 Vali Loss: 1.415 Vali Acc: 0.500 Test Loss: 1.415 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.316155672073364
Epoch: 8, Steps: 70 | Train Loss: 1.943 Vali Loss: 1.695 Vali Acc: 0.500 Test Loss: 1.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.902820110321045
Epoch: 9, Steps: 70 | Train Loss: 2.084 Vali Loss: 3.399 Vali Acc: 0.500 Test Loss: 3.399 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.68236207962036
Epoch: 10, Steps: 70 | Train Loss: 1.908 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 11 cost time: 27.12169599533081
Epoch: 11, Steps: 70 | Train Loss: 2.300 Vali Loss: 4.823 Vali Acc: 0.500 Test Loss: 4.823 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.829106330871582
Epoch: 12, Steps: 70 | Train Loss: 1.822 Vali Loss: 4.951 Vali Acc: 0.500 Test Loss: 4.951 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.27825355529785
Epoch: 13, Steps: 70 | Train Loss: 1.224 Vali Loss: 1.322 Vali Acc: 0.520 Test Loss: 1.322 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.614176034927368
Epoch: 14, Steps: 70 | Train Loss: 1.287 Vali Loss: 1.949 Vali Acc: 0.490 Test Loss: 1.949 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 21.305643320083618
Epoch: 15, Steps: 70 | Train Loss: 1.200 Vali Loss: 3.113 Vali Acc: 0.450 Test Loss: 3.113 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.50502872467041
Epoch: 16, Steps: 70 | Train Loss: 1.071 Vali Loss: 3.955 Vali Acc: 0.530 Test Loss: 3.955 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529960).  Saving model ...
Epoch: 17 cost time: 25.378796815872192
Epoch: 17, Steps: 70 | Train Loss: 0.936 Vali Loss: 8.078 Vali Acc: 0.450 Test Loss: 8.078 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.343742609024048
Epoch: 18, Steps: 70 | Train Loss: 1.005 Vali Loss: 4.337 Vali Acc: 0.510 Test Loss: 4.337 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 22.55000066757202
Epoch: 19, Steps: 70 | Train Loss: 1.070 Vali Loss: 2.838 Vali Acc: 0.410 Test Loss: 2.838 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.683685302734375
Epoch: 20, Steps: 70 | Train Loss: 0.941 Vali Loss: 1.593 Vali Acc: 0.560 Test Loss: 1.593 Test Acc: 0.560
Validation loss decreased (-0.529960 --> -0.559984).  Saving model ...
Epoch: 21 cost time: 20.96690583229065
Epoch: 21, Steps: 70 | Train Loss: 1.579 Vali Loss: 1.187 Vali Acc: 0.480 Test Loss: 1.187 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.638803243637085
Epoch: 22, Steps: 70 | Train Loss: 0.779 Vali Loss: 2.500 Vali Acc: 0.460 Test Loss: 2.500 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 26.521125555038452
Epoch: 23, Steps: 70 | Train Loss: 0.561 Vali Loss: 7.621 Vali Acc: 0.460 Test Loss: 7.621 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 24.83252215385437
Epoch: 24, Steps: 70 | Train Loss: 0.761 Vali Loss: 5.811 Vali Acc: 0.500 Test Loss: 5.811 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 23.128911018371582
Epoch: 25, Steps: 70 | Train Loss: 0.514 Vali Loss: 3.996 Vali Acc: 0.490 Test Loss: 3.996 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 18.00353240966797
Epoch: 26, Steps: 70 | Train Loss: 0.414 Vali Loss: 4.533 Vali Acc: 0.440 Test Loss: 4.533 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 24.242671489715576
Epoch: 27, Steps: 70 | Train Loss: 0.308 Vali Loss: 5.467 Vali Acc: 0.490 Test Loss: 5.467 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 22.496628761291504
Epoch: 28, Steps: 70 | Train Loss: 0.076 Vali Loss: 9.232 Vali Acc: 0.470 Test Loss: 9.232 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 21.983176231384277
Epoch: 29, Steps: 70 | Train Loss: 0.256 Vali Loss: 4.358 Vali Acc: 0.550 Test Loss: 4.358 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 22.198344707489014
Epoch: 30, Steps: 70 | Train Loss: 0.210 Vali Loss: 10.684 Vali Acc: 0.490 Test Loss: 10.684 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2106366
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.884805917739868
Epoch: 1, Steps: 70 | Train Loss: 2.322 Vali Loss: 5.149 Vali Acc: 0.500 Test Loss: 5.149 Test Acc: 0.500
Validation loss decreased (inf --> -0.499949).  Saving model ...
Epoch: 2 cost time: 20.057624578475952
Epoch: 2, Steps: 70 | Train Loss: 3.619 Vali Loss: 1.668 Vali Acc: 0.500 Test Loss: 1.668 Test Acc: 0.500
Validation loss decreased (-0.499949 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 19.724833250045776
Epoch: 3, Steps: 70 | Train Loss: 3.065 Vali Loss: 4.277 Vali Acc: 0.500 Test Loss: 4.277 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.053919553756714
Epoch: 4, Steps: 70 | Train Loss: 1.628 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.639696836471558
Epoch: 5, Steps: 70 | Train Loss: 1.877 Vali Loss: 2.066 Vali Acc: 0.500 Test Loss: 2.066 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.325090408325195
Epoch: 6, Steps: 70 | Train Loss: 1.800 Vali Loss: 2.719 Vali Acc: 0.500 Test Loss: 2.719 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.107689142227173
Epoch: 7, Steps: 70 | Train Loss: 1.530 Vali Loss: 0.906 Vali Acc: 0.480 Test Loss: 0.906 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.32693839073181
Epoch: 8, Steps: 70 | Train Loss: 1.578 Vali Loss: 3.510 Vali Acc: 0.500 Test Loss: 3.510 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 23.0384783744812
Epoch: 9, Steps: 70 | Train Loss: 1.962 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499984).  Saving model ...
Epoch: 10 cost time: 22.078970670700073
Epoch: 10, Steps: 70 | Train Loss: 1.218 Vali Loss: 3.247 Vali Acc: 0.500 Test Loss: 3.247 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.126397848129272
Epoch: 11, Steps: 70 | Train Loss: 2.088 Vali Loss: 1.982 Vali Acc: 0.510 Test Loss: 1.982 Test Acc: 0.510
Validation loss decreased (-0.499984 --> -0.509980).  Saving model ...
Epoch: 12 cost time: 22.4016056060791
Epoch: 12, Steps: 70 | Train Loss: 1.959 Vali Loss: 2.971 Vali Acc: 0.500 Test Loss: 2.971 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.394938468933105
Epoch: 13, Steps: 70 | Train Loss: 2.006 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.668555736541748
Epoch: 14, Steps: 70 | Train Loss: 1.655 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.448363065719604
Epoch: 15, Steps: 70 | Train Loss: 1.187 Vali Loss: 1.374 Vali Acc: 0.540 Test Loss: 1.374 Test Acc: 0.540
Validation loss decreased (-0.509980 --> -0.539986).  Saving model ...
Epoch: 16 cost time: 23.90824866294861
Epoch: 16, Steps: 70 | Train Loss: 1.306 Vali Loss: 3.381 Vali Acc: 0.510 Test Loss: 3.381 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.213053703308105
Epoch: 17, Steps: 70 | Train Loss: 0.977 Vali Loss: 4.715 Vali Acc: 0.530 Test Loss: 4.715 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 19.373372316360474
Epoch: 18, Steps: 70 | Train Loss: 1.357 Vali Loss: 1.622 Vali Acc: 0.440 Test Loss: 1.622 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.647828102111816
Epoch: 19, Steps: 70 | Train Loss: 0.635 Vali Loss: 2.643 Vali Acc: 0.450 Test Loss: 2.643 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.824028491973877
Epoch: 20, Steps: 70 | Train Loss: 0.840 Vali Loss: 8.500 Vali Acc: 0.500 Test Loss: 8.500 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.160287857055664
Epoch: 21, Steps: 70 | Train Loss: 0.663 Vali Loss: 2.653 Vali Acc: 0.520 Test Loss: 2.653 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.70135474205017
Epoch: 22, Steps: 70 | Train Loss: 0.451 Vali Loss: 4.947 Vali Acc: 0.560 Test Loss: 4.947 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559951).  Saving model ...
Epoch: 23 cost time: 16.641791582107544
Epoch: 23, Steps: 70 | Train Loss: 0.551 Vali Loss: 2.383 Vali Acc: 0.520 Test Loss: 2.383 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 18.7214994430542
Epoch: 24, Steps: 70 | Train Loss: 0.174 Vali Loss: 7.868 Vali Acc: 0.530 Test Loss: 7.868 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 27.480361938476562
Epoch: 25, Steps: 70 | Train Loss: 0.297 Vali Loss: 5.445 Vali Acc: 0.520 Test Loss: 5.445 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.14844560623169
Epoch: 26, Steps: 70 | Train Loss: 0.209 Vali Loss: 6.822 Vali Acc: 0.510 Test Loss: 6.822 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 27.268621921539307
Epoch: 27, Steps: 70 | Train Loss: 0.617 Vali Loss: 3.946 Vali Acc: 0.600 Test Loss: 3.946 Test Acc: 0.600
Validation loss decreased (-0.559951 --> -0.599961).  Saving model ...
Epoch: 28 cost time: 19.448206424713135
Epoch: 28, Steps: 70 | Train Loss: 0.580 Vali Loss: 5.981 Vali Acc: 0.480 Test Loss: 5.981 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 20.964845180511475
Epoch: 29, Steps: 70 | Train Loss: 0.291 Vali Loss: 15.389 Vali Acc: 0.460 Test Loss: 15.389 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 25.436012029647827
Epoch: 30, Steps: 70 | Train Loss: 0.199 Vali Loss: 3.552 Vali Acc: 0.550 Test Loss: 3.552 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 18.989619731903076
Epoch: 31, Steps: 70 | Train Loss: 0.286 Vali Loss: 5.435 Vali Acc: 0.470 Test Loss: 5.435 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 20.308040380477905
Epoch: 32, Steps: 70 | Train Loss: 0.231 Vali Loss: 6.984 Vali Acc: 0.570 Test Loss: 6.984 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 23.321725845336914
Epoch: 33, Steps: 70 | Train Loss: 0.113 Vali Loss: 8.690 Vali Acc: 0.610 Test Loss: 8.690 Test Acc: 0.610
Validation loss decreased (-0.599961 --> -0.609913).  Saving model ...
Epoch: 34 cost time: 18.807896375656128
Epoch: 34, Steps: 70 | Train Loss: 0.180 Vali Loss: 7.120 Vali Acc: 0.530 Test Loss: 7.120 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 18.4667067527771
Epoch: 35, Steps: 70 | Train Loss: 0.362 Vali Loss: 5.780 Vali Acc: 0.510 Test Loss: 5.780 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 20.320231676101685
Epoch: 36, Steps: 70 | Train Loss: 0.056 Vali Loss: 6.570 Vali Acc: 0.530 Test Loss: 6.570 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 22.95291805267334
Epoch: 37, Steps: 70 | Train Loss: 0.056 Vali Loss: 4.653 Vali Acc: 0.550 Test Loss: 4.653 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 21.254531621932983
Epoch: 38, Steps: 70 | Train Loss: 0.001 Vali Loss: 5.629 Vali Acc: 0.530 Test Loss: 5.629 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 18.08759593963623
Epoch: 39, Steps: 70 | Train Loss: 0.000 Vali Loss: 5.961 Vali Acc: 0.550 Test Loss: 5.961 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 23.004974842071533
Epoch: 40, Steps: 70 | Train Loss: 0.000 Vali Loss: 6.008 Vali Acc: 0.550 Test Loss: 6.008 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 19.64556050300598
Epoch: 41, Steps: 70 | Train Loss: 0.000 Vali Loss: 6.380 Vali Acc: 0.520 Test Loss: 6.380 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 15.273102521896362
Epoch: 42, Steps: 70 | Train Loss: 0.000 Vali Loss: 6.473 Vali Acc: 0.490 Test Loss: 6.473 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 20.349833250045776
Epoch: 43, Steps: 70 | Train Loss: 0.000 Vali Loss: 6.549 Vali Acc: 0.480 Test Loss: 6.549 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2076286
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.6326584815979
Epoch: 1, Steps: 70 | Train Loss: 1.157 Vali Loss: 1.716 Vali Acc: 0.510 Test Loss: 1.716 Test Acc: 0.510
Validation loss decreased (inf --> -0.509983).  Saving model ...
Epoch: 2 cost time: 14.670133590698242
Epoch: 2, Steps: 70 | Train Loss: 1.627 Vali Loss: 2.278 Vali Acc: 0.470 Test Loss: 2.278 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.185495615005493
Epoch: 3, Steps: 70 | Train Loss: 1.548 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.336846590042114
Epoch: 4, Steps: 70 | Train Loss: 1.783 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.159693241119385
Epoch: 5, Steps: 70 | Train Loss: 1.518 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.253253936767578
Epoch: 6, Steps: 70 | Train Loss: 1.440 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.577898025512695
Epoch: 7, Steps: 70 | Train Loss: 1.757 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.65162205696106
Epoch: 8, Steps: 70 | Train Loss: 3.116 Vali Loss: 2.439 Vali Acc: 0.500 Test Loss: 2.439 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.566189765930176
Epoch: 9, Steps: 70 | Train Loss: 1.312 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 19.497739553451538
Epoch: 10, Steps: 70 | Train Loss: 1.806 Vali Loss: 1.424 Vali Acc: 0.500 Test Loss: 1.424 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.182188749313354
Epoch: 11, Steps: 70 | Train Loss: 1.133 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 1460574
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.643281698226929
Epoch: 1, Steps: 70 | Train Loss: 1.058 Vali Loss: 1.372 Vali Acc: 0.480 Test Loss: 1.372 Test Acc: 0.480
Validation loss decreased (inf --> -0.479986).  Saving model ...
Epoch: 2 cost time: 19.800608158111572
Epoch: 2, Steps: 70 | Train Loss: 1.774 Vali Loss: 3.203 Vali Acc: 0.500 Test Loss: 3.203 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499968).  Saving model ...
Epoch: 3 cost time: 17.461434841156006
Epoch: 3, Steps: 70 | Train Loss: 1.725 Vali Loss: 1.105 Vali Acc: 0.490 Test Loss: 1.105 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.244611978530884
Epoch: 4, Steps: 70 | Train Loss: 1.417 Vali Loss: 3.401 Vali Acc: 0.500 Test Loss: 3.401 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.360154628753662
Epoch: 5, Steps: 70 | Train Loss: 2.283 Vali Loss: 2.460 Vali Acc: 0.500 Test Loss: 2.460 Test Acc: 0.500
Validation loss decreased (-0.499968 --> -0.499975).  Saving model ...
Epoch: 6 cost time: 14.875429391860962
Epoch: 6, Steps: 70 | Train Loss: 1.881 Vali Loss: 4.569 Vali Acc: 0.500 Test Loss: 4.569 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.75638484954834
Epoch: 7, Steps: 70 | Train Loss: 1.932 Vali Loss: 2.317 Vali Acc: 0.500 Test Loss: 2.317 Test Acc: 0.500
Validation loss decreased (-0.499975 --> -0.499977).  Saving model ...
Epoch: 8 cost time: 16.617629766464233
Epoch: 8, Steps: 70 | Train Loss: 1.292 Vali Loss: 1.513 Vali Acc: 0.470 Test Loss: 1.513 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.646456956863403
Epoch: 9, Steps: 70 | Train Loss: 1.504 Vali Loss: 1.298 Vali Acc: 0.540 Test Loss: 1.298 Test Acc: 0.540
Validation loss decreased (-0.499977 --> -0.539987).  Saving model ...
Epoch: 10 cost time: 16.30630850791931
Epoch: 10, Steps: 70 | Train Loss: 2.337 Vali Loss: 1.154 Vali Acc: 0.520 Test Loss: 1.154 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.9189510345459
Epoch: 11, Steps: 70 | Train Loss: 1.117 Vali Loss: 0.824 Vali Acc: 0.580 Test Loss: 0.824 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579992).  Saving model ...
Epoch: 12 cost time: 15.403824090957642
Epoch: 12, Steps: 70 | Train Loss: 1.250 Vali Loss: 4.047 Vali Acc: 0.540 Test Loss: 4.047 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.367238998413086
Epoch: 13, Steps: 70 | Train Loss: 1.207 Vali Loss: 2.768 Vali Acc: 0.570 Test Loss: 2.768 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.022242307662964
Epoch: 14, Steps: 70 | Train Loss: 1.346 Vali Loss: 3.592 Vali Acc: 0.520 Test Loss: 3.592 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.928361177444458
Epoch: 15, Steps: 70 | Train Loss: 2.038 Vali Loss: 1.723 Vali Acc: 0.550 Test Loss: 1.723 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.423661708831787
Epoch: 16, Steps: 70 | Train Loss: 1.094 Vali Loss: 2.322 Vali Acc: 0.480 Test Loss: 2.322 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.382853031158447
Epoch: 17, Steps: 70 | Train Loss: 0.940 Vali Loss: 2.840 Vali Acc: 0.560 Test Loss: 2.840 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 21.9065158367157
Epoch: 18, Steps: 70 | Train Loss: 0.835 Vali Loss: 3.115 Vali Acc: 0.470 Test Loss: 3.115 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 22.965466737747192
Epoch: 19, Steps: 70 | Train Loss: 1.621 Vali Loss: 2.370 Vali Acc: 0.510 Test Loss: 2.370 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 23.350995540618896
Epoch: 20, Steps: 70 | Train Loss: 1.178 Vali Loss: 2.142 Vali Acc: 0.580 Test Loss: 2.142 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 24.48506474494934
Epoch: 21, Steps: 70 | Train Loss: 1.019 Vali Loss: 2.861 Vali Acc: 0.460 Test Loss: 2.861 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1445534
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.606430053710938
Epoch: 1, Steps: 70 | Train Loss: 1.390 Vali Loss: 1.129 Vali Acc: 0.410 Test Loss: 1.129 Test Acc: 0.410
Validation loss decreased (inf --> -0.409989).  Saving model ...
Epoch: 2 cost time: 21.236466884613037
Epoch: 2, Steps: 70 | Train Loss: 1.872 Vali Loss: 1.422 Vali Acc: 0.500 Test Loss: 1.422 Test Acc: 0.500
Validation loss decreased (-0.409989 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 22.52387499809265
Epoch: 3, Steps: 70 | Train Loss: 2.762 Vali Loss: 2.756 Vali Acc: 0.540 Test Loss: 2.756 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539972).  Saving model ...
Epoch: 4 cost time: 19.1508686542511
Epoch: 4, Steps: 70 | Train Loss: 2.268 Vali Loss: 2.103 Vali Acc: 0.550 Test Loss: 2.103 Test Acc: 0.550
Validation loss decreased (-0.539972 --> -0.549979).  Saving model ...
Epoch: 5 cost time: 16.22230887413025
Epoch: 5, Steps: 70 | Train Loss: 1.952 Vali Loss: 2.373 Vali Acc: 0.570 Test Loss: 2.373 Test Acc: 0.570
Validation loss decreased (-0.549979 --> -0.569976).  Saving model ...
Epoch: 6 cost time: 19.254648447036743
Epoch: 6, Steps: 70 | Train Loss: 1.985 Vali Loss: 1.634 Vali Acc: 0.560 Test Loss: 1.634 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.743707180023193
Epoch: 7, Steps: 70 | Train Loss: 1.917 Vali Loss: 3.116 Vali Acc: 0.530 Test Loss: 3.116 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.816098928451538
Epoch: 8, Steps: 70 | Train Loss: 1.597 Vali Loss: 1.563 Vali Acc: 0.510 Test Loss: 1.563 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.969354391098022
Epoch: 9, Steps: 70 | Train Loss: 1.226 Vali Loss: 1.856 Vali Acc: 0.510 Test Loss: 1.856 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.70398736000061
Epoch: 10, Steps: 70 | Train Loss: 1.331 Vali Loss: 4.599 Vali Acc: 0.450 Test Loss: 4.599 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.55818223953247
Epoch: 11, Steps: 70 | Train Loss: 1.264 Vali Loss: 3.065 Vali Acc: 0.490 Test Loss: 3.065 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.33415389060974
Epoch: 12, Steps: 70 | Train Loss: 0.902 Vali Loss: 4.995 Vali Acc: 0.470 Test Loss: 4.995 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.925097227096558
Epoch: 13, Steps: 70 | Train Loss: 1.061 Vali Loss: 3.321 Vali Acc: 0.490 Test Loss: 3.321 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.892102003097534
Epoch: 14, Steps: 70 | Train Loss: 1.697 Vali Loss: 2.877 Vali Acc: 0.470 Test Loss: 2.877 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 22.09589982032776
Epoch: 15, Steps: 70 | Train Loss: 1.389 Vali Loss: 1.462 Vali Acc: 0.600 Test Loss: 1.462 Test Acc: 0.600
Validation loss decreased (-0.569976 --> -0.599985).  Saving model ...
Epoch: 16 cost time: 13.05954360961914
Epoch: 16, Steps: 70 | Train Loss: 1.660 Vali Loss: 3.872 Vali Acc: 0.480 Test Loss: 3.872 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.3492271900177
Epoch: 17, Steps: 70 | Train Loss: 1.572 Vali Loss: 2.105 Vali Acc: 0.560 Test Loss: 2.105 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.438613653182983
Epoch: 18, Steps: 70 | Train Loss: 0.988 Vali Loss: 4.950 Vali Acc: 0.510 Test Loss: 4.950 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.14403486251831
Epoch: 19, Steps: 70 | Train Loss: 0.995 Vali Loss: 3.340 Vali Acc: 0.510 Test Loss: 3.340 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.567458152770996
Epoch: 20, Steps: 70 | Train Loss: 0.805 Vali Loss: 2.963 Vali Acc: 0.520 Test Loss: 2.963 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 19.07540225982666
Epoch: 21, Steps: 70 | Train Loss: 1.143 Vali Loss: 3.149 Vali Acc: 0.530 Test Loss: 3.149 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 20.580971240997314
Epoch: 22, Steps: 70 | Train Loss: 0.872 Vali Loss: 3.494 Vali Acc: 0.480 Test Loss: 3.494 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.756410121917725
Epoch: 23, Steps: 70 | Train Loss: 0.911 Vali Loss: 4.276 Vali Acc: 0.430 Test Loss: 4.276 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.511370420455933
Epoch: 24, Steps: 70 | Train Loss: 0.349 Vali Loss: 3.384 Vali Acc: 0.510 Test Loss: 3.384 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 19.063091039657593
Epoch: 25, Steps: 70 | Train Loss: 0.340 Vali Loss: 4.627 Vali Acc: 0.540 Test Loss: 4.627 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1430494
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.82087230682373
Epoch: 1, Steps: 70 | Train Loss: 1.737 Vali Loss: 4.539 Vali Acc: 0.500 Test Loss: 4.539 Test Acc: 0.500
Validation loss decreased (inf --> -0.499955).  Saving model ...
Epoch: 2 cost time: 16.50015616416931
Epoch: 2, Steps: 70 | Train Loss: 2.217 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 19.35687565803528
Epoch: 3, Steps: 70 | Train Loss: 1.657 Vali Loss: 3.735 Vali Acc: 0.500 Test Loss: 3.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.326035976409912
Epoch: 4, Steps: 70 | Train Loss: 1.393 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 20.1083984375
Epoch: 5, Steps: 70 | Train Loss: 1.902 Vali Loss: 2.882 Vali Acc: 0.500 Test Loss: 2.882 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.943920135498047
Epoch: 6, Steps: 70 | Train Loss: 2.120 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.948559045791626
Epoch: 7, Steps: 70 | Train Loss: 1.388 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.35205388069153
Epoch: 8, Steps: 70 | Train Loss: 2.344 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.420408010482788
Epoch: 9, Steps: 70 | Train Loss: 2.277 Vali Loss: 1.059 Vali Acc: 0.470 Test Loss: 1.059 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.670642137527466
Epoch: 10, Steps: 70 | Train Loss: 1.567 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.320413827896118
Epoch: 11, Steps: 70 | Train Loss: 1.225 Vali Loss: 2.128 Vali Acc: 0.500 Test Loss: 2.128 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.517197132110596
Epoch: 12, Steps: 70 | Train Loss: 1.734 Vali Loss: 1.528 Vali Acc: 0.560 Test Loss: 1.528 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559985).  Saving model ...
Epoch: 13 cost time: 15.269542694091797
Epoch: 13, Steps: 70 | Train Loss: 1.416 Vali Loss: 2.929 Vali Acc: 0.500 Test Loss: 2.929 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.660706043243408
Epoch: 14, Steps: 70 | Train Loss: 1.468 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.286120176315308
Epoch: 15, Steps: 70 | Train Loss: 1.894 Vali Loss: 2.069 Vali Acc: 0.500 Test Loss: 2.069 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.542196035385132
Epoch: 16, Steps: 70 | Train Loss: 1.394 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.261216163635254
Epoch: 17, Steps: 70 | Train Loss: 1.175 Vali Loss: 1.280 Vali Acc: 0.440 Test Loss: 1.280 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 17.583032369613647
Epoch: 18, Steps: 70 | Train Loss: 1.092 Vali Loss: 1.012 Vali Acc: 0.450 Test Loss: 1.012 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 17.213053464889526
Epoch: 19, Steps: 70 | Train Loss: 1.270 Vali Loss: 2.440 Vali Acc: 0.490 Test Loss: 2.440 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.082963228225708
Epoch: 20, Steps: 70 | Train Loss: 0.899 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.034356594085693
Epoch: 21, Steps: 70 | Train Loss: 0.837 Vali Loss: 2.538 Vali Acc: 0.480 Test Loss: 2.538 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 16.9453067779541
Epoch: 22, Steps: 70 | Train Loss: 1.430 Vali Loss: 1.969 Vali Acc: 0.470 Test Loss: 1.969 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1415454
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.873479843139648
Epoch: 1, Steps: 70 | Train Loss: 1.164 Vali Loss: 1.073 Vali Acc: 0.430 Test Loss: 1.073 Test Acc: 0.430
Validation loss decreased (inf --> -0.429989).  Saving model ...
Epoch: 2 cost time: 13.148777961730957
Epoch: 2, Steps: 70 | Train Loss: 1.268 Vali Loss: 2.626 Vali Acc: 0.500 Test Loss: 2.626 Test Acc: 0.500
Validation loss decreased (-0.429989 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 15.971891403198242
Epoch: 3, Steps: 70 | Train Loss: 1.517 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
Validation loss decreased (-0.499974 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 14.448739290237427
Epoch: 4, Steps: 70 | Train Loss: 1.812 Vali Loss: 2.249 Vali Acc: 0.500 Test Loss: 2.249 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.801151514053345
Epoch: 5, Steps: 70 | Train Loss: 1.234 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 13.134648084640503
Epoch: 6, Steps: 70 | Train Loss: 1.023 Vali Loss: 1.606 Vali Acc: 0.500 Test Loss: 1.606 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.847955703735352
Epoch: 7, Steps: 70 | Train Loss: 2.692 Vali Loss: 3.923 Vali Acc: 0.500 Test Loss: 3.923 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.832818031311035
Epoch: 8, Steps: 70 | Train Loss: 1.237 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.569949865341187
Epoch: 9, Steps: 70 | Train Loss: 1.709 Vali Loss: 0.901 Vali Acc: 0.470 Test Loss: 0.901 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.811804056167603
Epoch: 10, Steps: 70 | Train Loss: 1.819 Vali Loss: 0.915 Vali Acc: 0.500 Test Loss: 0.915 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.153376817703247
Epoch: 11, Steps: 70 | Train Loss: 1.268 Vali Loss: 2.929 Vali Acc: 0.500 Test Loss: 2.929 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.030091524124146
Epoch: 12, Steps: 70 | Train Loss: 1.580 Vali Loss: 2.807 Vali Acc: 0.500 Test Loss: 2.807 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 15.176939487457275
Epoch: 13, Steps: 70 | Train Loss: 1.081 Vali Loss: 1.503 Vali Acc: 0.550 Test Loss: 1.503 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549985).  Saving model ...
Epoch: 14 cost time: 15.161430597305298
Epoch: 14, Steps: 70 | Train Loss: 0.999 Vali Loss: 1.278 Vali Acc: 0.420 Test Loss: 1.278 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.680192947387695
Epoch: 15, Steps: 70 | Train Loss: 0.972 Vali Loss: 3.860 Vali Acc: 0.500 Test Loss: 3.860 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.588834762573242
Epoch: 16, Steps: 70 | Train Loss: 1.780 Vali Loss: 2.790 Vali Acc: 0.500 Test Loss: 2.790 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.772964239120483
Epoch: 17, Steps: 70 | Train Loss: 0.833 Vali Loss: 2.339 Vali Acc: 0.520 Test Loss: 2.339 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.970910787582397
Epoch: 18, Steps: 70 | Train Loss: 0.770 Vali Loss: 1.881 Vali Acc: 0.500 Test Loss: 1.881 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.546830654144287
Epoch: 19, Steps: 70 | Train Loss: 1.080 Vali Loss: 0.956 Vali Acc: 0.500 Test Loss: 0.956 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.646929502487183
Epoch: 20, Steps: 70 | Train Loss: 1.140 Vali Loss: 1.474 Vali Acc: 0.470 Test Loss: 1.474 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.396217346191406
Epoch: 21, Steps: 70 | Train Loss: 1.111 Vali Loss: 0.956 Vali Acc: 0.500 Test Loss: 0.956 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.207329511642456
Epoch: 22, Steps: 70 | Train Loss: 1.013 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 14.536473989486694
Epoch: 23, Steps: 70 | Train Loss: 0.994 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1161054
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.449561595916748
Epoch: 1, Steps: 70 | Train Loss: 1.356 Vali Loss: 2.102 Vali Acc: 0.490 Test Loss: 2.102 Test Acc: 0.490
Validation loss decreased (inf --> -0.489979).  Saving model ...
Epoch: 2 cost time: 14.912046194076538
Epoch: 2, Steps: 70 | Train Loss: 2.316 Vali Loss: 3.446 Vali Acc: 0.500 Test Loss: 3.446 Test Acc: 0.500
Validation loss decreased (-0.489979 --> -0.499966).  Saving model ...
Epoch: 3 cost time: 14.354022979736328
Epoch: 3, Steps: 70 | Train Loss: 2.164 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
Validation loss decreased (-0.499966 --> -0.499990).  Saving model ...
Epoch: 4 cost time: 14.71573781967163
Epoch: 4, Steps: 70 | Train Loss: 1.158 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.681110382080078
Epoch: 5, Steps: 70 | Train Loss: 1.435 Vali Loss: 1.357 Vali Acc: 0.500 Test Loss: 1.357 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.808544397354126
Epoch: 6, Steps: 70 | Train Loss: 2.044 Vali Loss: 1.031 Vali Acc: 0.500 Test Loss: 1.031 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.649524688720703
Epoch: 7, Steps: 70 | Train Loss: 1.649 Vali Loss: 1.633 Vali Acc: 0.500 Test Loss: 1.633 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.7682785987854
Epoch: 8, Steps: 70 | Train Loss: 1.570 Vali Loss: 0.955 Vali Acc: 0.500 Test Loss: 0.955 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 9 cost time: 14.343384981155396
Epoch: 9, Steps: 70 | Train Loss: 2.554 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499993).  Saving model ...
Epoch: 10 cost time: 12.066025733947754
Epoch: 10, Steps: 70 | Train Loss: 1.176 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.278120994567871
Epoch: 11, Steps: 70 | Train Loss: 1.534 Vali Loss: 1.225 Vali Acc: 0.520 Test Loss: 1.225 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519988).  Saving model ...
Epoch: 12 cost time: 14.733235836029053
Epoch: 12, Steps: 70 | Train Loss: 1.069 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.850887537002563
Epoch: 13, Steps: 70 | Train Loss: 1.213 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 13.875010251998901
Epoch: 14, Steps: 70 | Train Loss: 1.086 Vali Loss: 1.701 Vali Acc: 0.540 Test Loss: 1.701 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.223794937133789
Epoch: 15, Steps: 70 | Train Loss: 1.046 Vali Loss: 2.333 Vali Acc: 0.570 Test Loss: 2.333 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569977).  Saving model ...
Epoch: 16 cost time: 14.412359476089478
Epoch: 16, Steps: 70 | Train Loss: 1.342 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.85771918296814
Epoch: 17, Steps: 70 | Train Loss: 1.144 Vali Loss: 1.828 Vali Acc: 0.500 Test Loss: 1.828 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.866443157196045
Epoch: 18, Steps: 70 | Train Loss: 0.903 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.557889461517334
Epoch: 19, Steps: 70 | Train Loss: 1.025 Vali Loss: 1.436 Vali Acc: 0.570 Test Loss: 1.436 Test Acc: 0.570
Validation loss decreased (-0.569977 --> -0.569986).  Saving model ...
Epoch: 20 cost time: 12.463918685913086
Epoch: 20, Steps: 70 | Train Loss: 0.837 Vali Loss: 4.524 Vali Acc: 0.490 Test Loss: 4.524 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.723392486572266
Epoch: 21, Steps: 70 | Train Loss: 0.945 Vali Loss: 1.733 Vali Acc: 0.630 Test Loss: 1.733 Test Acc: 0.630
Validation loss decreased (-0.569986 --> -0.629983).  Saving model ...
Epoch: 22 cost time: 14.321656465530396
Epoch: 22, Steps: 70 | Train Loss: 0.663 Vali Loss: 2.372 Vali Acc: 0.520 Test Loss: 2.372 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 14.902383804321289
Epoch: 23, Steps: 70 | Train Loss: 0.635 Vali Loss: 1.546 Vali Acc: 0.570 Test Loss: 1.546 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.304138660430908
Epoch: 24, Steps: 70 | Train Loss: 0.324 Vali Loss: 2.636 Vali Acc: 0.560 Test Loss: 2.636 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.551796913146973
Epoch: 25, Steps: 70 | Train Loss: 0.423 Vali Loss: 3.476 Vali Acc: 0.540 Test Loss: 3.476 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.896130800247192
Epoch: 26, Steps: 70 | Train Loss: 0.146 Vali Loss: 4.465 Vali Acc: 0.500 Test Loss: 4.465 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.675699234008789
Epoch: 27, Steps: 70 | Train Loss: 0.366 Vali Loss: 4.639 Vali Acc: 0.500 Test Loss: 4.639 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.236072063446045
Epoch: 28, Steps: 70 | Train Loss: 0.514 Vali Loss: 3.870 Vali Acc: 0.480 Test Loss: 3.870 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.10657262802124
Epoch: 29, Steps: 70 | Train Loss: 0.356 Vali Loss: 4.883 Vali Acc: 0.460 Test Loss: 4.883 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 14.72419548034668
Epoch: 30, Steps: 70 | Train Loss: 0.312 Vali Loss: 5.109 Vali Acc: 0.500 Test Loss: 5.109 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 14.754904747009277
Epoch: 31, Steps: 70 | Train Loss: 0.191 Vali Loss: 4.321 Vali Acc: 0.510 Test Loss: 4.321 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1146014
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.276639938354492
Epoch: 1, Steps: 70 | Train Loss: 1.839 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 13.036524772644043
Epoch: 2, Steps: 70 | Train Loss: 1.404 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.34737753868103
Epoch: 3, Steps: 70 | Train Loss: 1.063 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.699939250946045
Epoch: 4, Steps: 70 | Train Loss: 1.143 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 14.32673692703247
Epoch: 5, Steps: 70 | Train Loss: 1.010 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 11.914086818695068
Epoch: 6, Steps: 70 | Train Loss: 1.663 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.150580167770386
Epoch: 7, Steps: 70 | Train Loss: 1.562 Vali Loss: 1.438 Vali Acc: 0.500 Test Loss: 1.438 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.259639739990234
Epoch: 8, Steps: 70 | Train Loss: 1.653 Vali Loss: 2.302 Vali Acc: 0.500 Test Loss: 2.302 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.548390865325928
Epoch: 9, Steps: 70 | Train Loss: 1.231 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.472746849060059
Epoch: 10, Steps: 70 | Train Loss: 1.412 Vali Loss: 1.179 Vali Acc: 0.520 Test Loss: 1.179 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.016940355300903
Epoch: 11, Steps: 70 | Train Loss: 1.046 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 12 cost time: 14.572539806365967
Epoch: 12, Steps: 70 | Train Loss: 1.766 Vali Loss: 0.841 Vali Acc: 0.580 Test Loss: 0.841 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 14.358092308044434
Epoch: 13, Steps: 70 | Train Loss: 1.481 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.257065057754517
Epoch: 14, Steps: 70 | Train Loss: 1.123 Vali Loss: 2.264 Vali Acc: 0.480 Test Loss: 2.264 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.494316101074219
Epoch: 15, Steps: 70 | Train Loss: 0.807 Vali Loss: 3.138 Vali Acc: 0.520 Test Loss: 3.138 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.100300788879395
Epoch: 16, Steps: 70 | Train Loss: 0.876 Vali Loss: 1.772 Vali Acc: 0.460 Test Loss: 1.772 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.289346933364868
Epoch: 17, Steps: 70 | Train Loss: 0.979 Vali Loss: 4.147 Vali Acc: 0.500 Test Loss: 4.147 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.741671562194824
Epoch: 18, Steps: 70 | Train Loss: 0.666 Vali Loss: 3.281 Vali Acc: 0.550 Test Loss: 3.281 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.434566020965576
Epoch: 19, Steps: 70 | Train Loss: 0.664 Vali Loss: 2.702 Vali Acc: 0.500 Test Loss: 2.702 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.132630586624146
Epoch: 20, Steps: 70 | Train Loss: 0.540 Vali Loss: 6.854 Vali Acc: 0.500 Test Loss: 6.854 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.692168951034546
Epoch: 21, Steps: 70 | Train Loss: 1.018 Vali Loss: 3.163 Vali Acc: 0.540 Test Loss: 3.163 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.73742938041687
Epoch: 22, Steps: 70 | Train Loss: 0.680 Vali Loss: 2.000 Vali Acc: 0.530 Test Loss: 2.000 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1130974
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.02560806274414
Epoch: 1, Steps: 70 | Train Loss: 1.807 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 11.54281997680664
Epoch: 2, Steps: 70 | Train Loss: 1.770 Vali Loss: 2.473 Vali Acc: 0.500 Test Loss: 2.473 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.761986017227173
Epoch: 3, Steps: 70 | Train Loss: 2.270 Vali Loss: 2.496 Vali Acc: 0.490 Test Loss: 2.496 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.127516269683838
Epoch: 4, Steps: 70 | Train Loss: 1.614 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.130131483078003
Epoch: 5, Steps: 70 | Train Loss: 1.714 Vali Loss: 1.109 Vali Acc: 0.490 Test Loss: 1.109 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.204848766326904
Epoch: 6, Steps: 70 | Train Loss: 2.789 Vali Loss: 5.030 Vali Acc: 0.500 Test Loss: 5.030 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.421900510787964
Epoch: 7, Steps: 70 | Train Loss: 1.507 Vali Loss: 1.527 Vali Acc: 0.510 Test Loss: 1.527 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.175354242324829
Epoch: 8, Steps: 70 | Train Loss: 1.898 Vali Loss: 5.423 Vali Acc: 0.500 Test Loss: 5.423 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.510052919387817
Epoch: 9, Steps: 70 | Train Loss: 1.703 Vali Loss: 1.504 Vali Acc: 0.580 Test Loss: 1.504 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579985).  Saving model ...
Epoch: 10 cost time: 13.645516157150269
Epoch: 10, Steps: 70 | Train Loss: 1.474 Vali Loss: 2.747 Vali Acc: 0.490 Test Loss: 2.747 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.962753057479858
Epoch: 11, Steps: 70 | Train Loss: 0.946 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.493857383728027
Epoch: 12, Steps: 70 | Train Loss: 1.002 Vali Loss: 4.027 Vali Acc: 0.460 Test Loss: 4.027 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.59561014175415
Epoch: 13, Steps: 70 | Train Loss: 0.703 Vali Loss: 3.038 Vali Acc: 0.510 Test Loss: 3.038 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.471179008483887
Epoch: 14, Steps: 70 | Train Loss: 1.047 Vali Loss: 3.915 Vali Acc: 0.500 Test Loss: 3.915 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.89123797416687
Epoch: 15, Steps: 70 | Train Loss: 0.972 Vali Loss: 3.322 Vali Acc: 0.490 Test Loss: 3.322 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.95345163345337
Epoch: 16, Steps: 70 | Train Loss: 0.374 Vali Loss: 5.913 Vali Acc: 0.480 Test Loss: 5.913 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.519857406616211
Epoch: 17, Steps: 70 | Train Loss: 0.327 Vali Loss: 3.639 Vali Acc: 0.490 Test Loss: 3.639 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.961035251617432
Epoch: 18, Steps: 70 | Train Loss: 0.200 Vali Loss: 4.745 Vali Acc: 0.450 Test Loss: 4.745 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.965060710906982
Epoch: 19, Steps: 70 | Train Loss: 0.411 Vali Loss: 3.671 Vali Acc: 0.530 Test Loss: 3.671 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1115934
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.11439847946167
Epoch: 1, Steps: 70 | Train Loss: 1.406 Vali Loss: 1.518 Vali Acc: 0.500 Test Loss: 1.518 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 13.211423635482788
Epoch: 2, Steps: 70 | Train Loss: 1.218 Vali Loss: 2.644 Vali Acc: 0.510 Test Loss: 2.644 Test Acc: 0.510
Validation loss decreased (-0.499985 --> -0.509974).  Saving model ...
Epoch: 3 cost time: 14.405453205108643
Epoch: 3, Steps: 70 | Train Loss: 1.224 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
Validation loss decreased (-0.509974 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 14.36018967628479
Epoch: 4, Steps: 70 | Train Loss: 1.205 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.76780652999878
Epoch: 5, Steps: 70 | Train Loss: 1.590 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.853422164916992
Epoch: 6, Steps: 70 | Train Loss: 1.376 Vali Loss: 1.068 Vali Acc: 0.490 Test Loss: 1.068 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.40566873550415
Epoch: 7, Steps: 70 | Train Loss: 1.364 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.075054168701172
Epoch: 8, Steps: 70 | Train Loss: 1.723 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.509992 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 14.442481756210327
Epoch: 9, Steps: 70 | Train Loss: 1.499 Vali Loss: 2.174 Vali Acc: 0.520 Test Loss: 2.174 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.738635778427124
Epoch: 10, Steps: 70 | Train Loss: 1.491 Vali Loss: 2.048 Vali Acc: 0.530 Test Loss: 2.048 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.844050884246826
Epoch: 11, Steps: 70 | Train Loss: 0.919 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.119710922241211
Epoch: 12, Steps: 70 | Train Loss: 1.474 Vali Loss: 3.528 Vali Acc: 0.520 Test Loss: 3.528 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.170089483261108
Epoch: 13, Steps: 70 | Train Loss: 0.859 Vali Loss: 2.792 Vali Acc: 0.580 Test Loss: 2.792 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.114579677581787
Epoch: 14, Steps: 70 | Train Loss: 1.550 Vali Loss: 5.562 Vali Acc: 0.540 Test Loss: 5.562 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.581398963928223
Epoch: 15, Steps: 70 | Train Loss: 1.441 Vali Loss: 3.388 Vali Acc: 0.520 Test Loss: 3.388 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.048307418823242
Epoch: 16, Steps: 70 | Train Loss: 0.824 Vali Loss: 3.516 Vali Acc: 0.500 Test Loss: 3.516 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.353870868682861
Epoch: 17, Steps: 70 | Train Loss: 0.320 Vali Loss: 3.825 Vali Acc: 0.580 Test Loss: 3.825 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.03393030166626
Epoch: 18, Steps: 70 | Train Loss: 0.156 Vali Loss: 4.880 Vali Acc: 0.490 Test Loss: 4.880 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1011294
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.818407773971558
Epoch: 1, Steps: 70 | Train Loss: 2.007 Vali Loss: 1.428 Vali Acc: 0.490 Test Loss: 1.428 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 11.382055044174194
Epoch: 2, Steps: 70 | Train Loss: 1.686 Vali Loss: 4.325 Vali Acc: 0.500 Test Loss: 4.325 Test Acc: 0.500
Validation loss decreased (-0.489986 --> -0.499957).  Saving model ...
Epoch: 3 cost time: 13.278446674346924
Epoch: 3, Steps: 70 | Train Loss: 2.277 Vali Loss: 3.327 Vali Acc: 0.500 Test Loss: 3.327 Test Acc: 0.500
Validation loss decreased (-0.499957 --> -0.499967).  Saving model ...
Epoch: 4 cost time: 13.328290939331055
Epoch: 4, Steps: 70 | Train Loss: 1.367 Vali Loss: 0.734 Vali Acc: 0.410 Test Loss: 0.734 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.322893857955933
Epoch: 5, Steps: 70 | Train Loss: 1.770 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 11.653855562210083
Epoch: 6, Steps: 70 | Train Loss: 1.593 Vali Loss: 2.698 Vali Acc: 0.500 Test Loss: 2.698 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.110700368881226
Epoch: 7, Steps: 70 | Train Loss: 1.874 Vali Loss: 2.748 Vali Acc: 0.500 Test Loss: 2.748 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.653275728225708
Epoch: 8, Steps: 70 | Train Loss: 1.492 Vali Loss: 5.827 Vali Acc: 0.500 Test Loss: 5.827 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.706438064575195
Epoch: 9, Steps: 70 | Train Loss: 1.057 Vali Loss: 2.485 Vali Acc: 0.490 Test Loss: 2.485 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.438395261764526
Epoch: 10, Steps: 70 | Train Loss: 1.459 Vali Loss: 5.129 Vali Acc: 0.500 Test Loss: 5.129 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.240047454833984
Epoch: 11, Steps: 70 | Train Loss: 2.414 Vali Loss: 2.114 Vali Acc: 0.550 Test Loss: 2.114 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549979).  Saving model ...
Epoch: 12 cost time: 13.450191259384155
Epoch: 12, Steps: 70 | Train Loss: 0.869 Vali Loss: 2.473 Vali Acc: 0.500 Test Loss: 2.473 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.499953746795654
Epoch: 13, Steps: 70 | Train Loss: 0.960 Vali Loss: 1.322 Vali Acc: 0.490 Test Loss: 1.322 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.880241394042969
Epoch: 14, Steps: 70 | Train Loss: 1.092 Vali Loss: 4.829 Vali Acc: 0.520 Test Loss: 4.829 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.197219371795654
Epoch: 15, Steps: 70 | Train Loss: 0.997 Vali Loss: 3.422 Vali Acc: 0.490 Test Loss: 3.422 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.943699598312378
Epoch: 16, Steps: 70 | Train Loss: 0.796 Vali Loss: 8.962 Vali Acc: 0.510 Test Loss: 8.962 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.10850739479065
Epoch: 17, Steps: 70 | Train Loss: 0.696 Vali Loss: 4.047 Vali Acc: 0.560 Test Loss: 4.047 Test Acc: 0.560
Validation loss decreased (-0.549979 --> -0.559960).  Saving model ...
Epoch: 18 cost time: 13.75192403793335
Epoch: 18, Steps: 70 | Train Loss: 0.409 Vali Loss: 10.397 Vali Acc: 0.380 Test Loss: 10.397 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.293083190917969
Epoch: 19, Steps: 70 | Train Loss: 0.161 Vali Loss: 6.323 Vali Acc: 0.470 Test Loss: 6.323 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.699328899383545
Epoch: 20, Steps: 70 | Train Loss: 0.107 Vali Loss: 5.736 Vali Acc: 0.510 Test Loss: 5.736 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.748936891555786
Epoch: 21, Steps: 70 | Train Loss: 0.125 Vali Loss: 8.249 Vali Acc: 0.460 Test Loss: 8.249 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 13.698399066925049
Epoch: 22, Steps: 70 | Train Loss: 0.088 Vali Loss: 8.475 Vali Acc: 0.460 Test Loss: 8.475 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.141613960266113
Epoch: 23, Steps: 70 | Train Loss: 0.116 Vali Loss: 13.311 Vali Acc: 0.420 Test Loss: 13.311 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.35867691040039
Epoch: 24, Steps: 70 | Train Loss: 0.158 Vali Loss: 8.935 Vali Acc: 0.450 Test Loss: 8.935 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.853852033615112
Epoch: 25, Steps: 70 | Train Loss: 0.074 Vali Loss: 7.657 Vali Acc: 0.450 Test Loss: 7.657 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 13.911182403564453
Epoch: 26, Steps: 70 | Train Loss: 0.172 Vali Loss: 8.531 Vali Acc: 0.420 Test Loss: 8.531 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 12.502929925918579
Epoch: 27, Steps: 70 | Train Loss: 0.096 Vali Loss: 11.937 Vali Acc: 0.450 Test Loss: 11.937 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 996254
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.573764562606812
Epoch: 1, Steps: 70 | Train Loss: 1.656 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 13.263946294784546
Epoch: 2, Steps: 70 | Train Loss: 2.144 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.066777467727661
Epoch: 3, Steps: 70 | Train Loss: 2.020 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.502471208572388
Epoch: 4, Steps: 70 | Train Loss: 3.222 Vali Loss: 1.996 Vali Acc: 0.500 Test Loss: 1.996 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.490346908569336
Epoch: 5, Steps: 70 | Train Loss: 2.392 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.544271230697632
Epoch: 6, Steps: 70 | Train Loss: 1.743 Vali Loss: 2.557 Vali Acc: 0.500 Test Loss: 2.557 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.672762155532837
Epoch: 7, Steps: 70 | Train Loss: 1.491 Vali Loss: 2.438 Vali Acc: 0.490 Test Loss: 2.438 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.04529070854187
Epoch: 8, Steps: 70 | Train Loss: 1.536 Vali Loss: 2.614 Vali Acc: 0.530 Test Loss: 2.614 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529974).  Saving model ...
Epoch: 9 cost time: 13.222857236862183
Epoch: 9, Steps: 70 | Train Loss: 1.526 Vali Loss: 3.164 Vali Acc: 0.570 Test Loss: 3.164 Test Acc: 0.570
Validation loss decreased (-0.529974 --> -0.569968).  Saving model ...
Epoch: 10 cost time: 13.67348837852478
Epoch: 10, Steps: 70 | Train Loss: 1.463 Vali Loss: 2.008 Vali Acc: 0.570 Test Loss: 2.008 Test Acc: 0.570
Validation loss decreased (-0.569968 --> -0.569980).  Saving model ...
Epoch: 11 cost time: 12.185657262802124
Epoch: 11, Steps: 70 | Train Loss: 1.130 Vali Loss: 1.789 Vali Acc: 0.550 Test Loss: 1.789 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.24752402305603
Epoch: 12, Steps: 70 | Train Loss: 0.581 Vali Loss: 2.510 Vali Acc: 0.600 Test Loss: 2.510 Test Acc: 0.600
Validation loss decreased (-0.569980 --> -0.599975).  Saving model ...
Epoch: 13 cost time: 13.3166983127594
Epoch: 13, Steps: 70 | Train Loss: 0.348 Vali Loss: 5.449 Vali Acc: 0.480 Test Loss: 5.449 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.228777408599854
Epoch: 14, Steps: 70 | Train Loss: 0.440 Vali Loss: 6.037 Vali Acc: 0.500 Test Loss: 6.037 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.276943922042847
Epoch: 15, Steps: 70 | Train Loss: 0.206 Vali Loss: 4.707 Vali Acc: 0.510 Test Loss: 4.707 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.053319454193115
Epoch: 16, Steps: 70 | Train Loss: 0.295 Vali Loss: 8.017 Vali Acc: 0.550 Test Loss: 8.017 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.628580093383789
Epoch: 17, Steps: 70 | Train Loss: 0.620 Vali Loss: 4.880 Vali Acc: 0.540 Test Loss: 4.880 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.491400241851807
Epoch: 18, Steps: 70 | Train Loss: 0.199 Vali Loss: 3.877 Vali Acc: 0.530 Test Loss: 3.877 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.563360214233398
Epoch: 19, Steps: 70 | Train Loss: 0.254 Vali Loss: 8.132 Vali Acc: 0.520 Test Loss: 8.132 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.2156400680542
Epoch: 20, Steps: 70 | Train Loss: 0.521 Vali Loss: 8.318 Vali Acc: 0.500 Test Loss: 8.318 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.028212070465088
Epoch: 21, Steps: 70 | Train Loss: 0.705 Vali Loss: 4.467 Vali Acc: 0.560 Test Loss: 4.467 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.629584074020386
Epoch: 22, Steps: 70 | Train Loss: 0.066 Vali Loss: 5.333 Vali Acc: 0.600 Test Loss: 5.333 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 981214
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.195853233337402
Epoch: 1, Steps: 70 | Train Loss: 1.591 Vali Loss: 1.356 Vali Acc: 0.510 Test Loss: 1.356 Test Acc: 0.510
Validation loss decreased (inf --> -0.509986).  Saving model ...
Epoch: 2 cost time: 13.096943140029907
Epoch: 2, Steps: 70 | Train Loss: 2.561 Vali Loss: 2.398 Vali Acc: 0.500 Test Loss: 2.398 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.030795097351074
Epoch: 3, Steps: 70 | Train Loss: 1.949 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
Validation loss decreased (-0.509986 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 12.826191663742065
Epoch: 4, Steps: 70 | Train Loss: 2.077 Vali Loss: 2.916 Vali Acc: 0.500 Test Loss: 2.916 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.773145914077759
Epoch: 5, Steps: 70 | Train Loss: 1.744 Vali Loss: 1.527 Vali Acc: 0.500 Test Loss: 1.527 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.880838632583618
Epoch: 6, Steps: 70 | Train Loss: 2.006 Vali Loss: 1.477 Vali Acc: 0.500 Test Loss: 1.477 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.016655445098877
Epoch: 7, Steps: 70 | Train Loss: 1.744 Vali Loss: 2.953 Vali Acc: 0.500 Test Loss: 2.953 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.912658929824829
Epoch: 8, Steps: 70 | Train Loss: 1.346 Vali Loss: 2.690 Vali Acc: 0.500 Test Loss: 2.690 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.90600848197937
Epoch: 9, Steps: 70 | Train Loss: 2.395 Vali Loss: 2.576 Vali Acc: 0.500 Test Loss: 2.576 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.782778978347778
Epoch: 10, Steps: 70 | Train Loss: 2.155 Vali Loss: 2.059 Vali Acc: 0.490 Test Loss: 2.059 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.683984518051147
Epoch: 11, Steps: 70 | Train Loss: 1.122 Vali Loss: 1.405 Vali Acc: 0.530 Test Loss: 1.405 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529986).  Saving model ...
Epoch: 12 cost time: 12.5779869556427
Epoch: 12, Steps: 70 | Train Loss: 1.220 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.221792221069336
Epoch: 13, Steps: 70 | Train Loss: 1.387 Vali Loss: 1.574 Vali Acc: 0.560 Test Loss: 1.574 Test Acc: 0.560
Validation loss decreased (-0.529986 --> -0.559984).  Saving model ...
Epoch: 14 cost time: 10.71308946609497
Epoch: 14, Steps: 70 | Train Loss: 0.966 Vali Loss: 3.701 Vali Acc: 0.570 Test Loss: 3.701 Test Acc: 0.570
Validation loss decreased (-0.559984 --> -0.569963).  Saving model ...
Epoch: 15 cost time: 12.589611768722534
Epoch: 15, Steps: 70 | Train Loss: 0.686 Vali Loss: 5.553 Vali Acc: 0.550 Test Loss: 5.553 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.68051290512085
Epoch: 16, Steps: 70 | Train Loss: 0.630 Vali Loss: 4.090 Vali Acc: 0.530 Test Loss: 4.090 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.634243965148926
Epoch: 17, Steps: 70 | Train Loss: 1.163 Vali Loss: 6.220 Vali Acc: 0.520 Test Loss: 6.220 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.680908441543579
Epoch: 18, Steps: 70 | Train Loss: 0.483 Vali Loss: 5.885 Vali Acc: 0.580 Test Loss: 5.885 Test Acc: 0.580
Validation loss decreased (-0.569963 --> -0.579941).  Saving model ...
Epoch: 19 cost time: 11.257463216781616
Epoch: 19, Steps: 70 | Train Loss: 0.576 Vali Loss: 6.164 Vali Acc: 0.540 Test Loss: 6.164 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.820813417434692
Epoch: 20, Steps: 70 | Train Loss: 0.564 Vali Loss: 6.673 Vali Acc: 0.530 Test Loss: 6.673 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.8757004737854
Epoch: 21, Steps: 70 | Train Loss: 0.230 Vali Loss: 5.802 Vali Acc: 0.540 Test Loss: 5.802 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 12.317838191986084
Epoch: 22, Steps: 70 | Train Loss: 0.567 Vali Loss: 11.664 Vali Acc: 0.560 Test Loss: 11.664 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.690682172775269
Epoch: 23, Steps: 70 | Train Loss: 0.429 Vali Loss: 5.126 Vali Acc: 0.470 Test Loss: 5.126 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 12.449316024780273
Epoch: 24, Steps: 70 | Train Loss: 0.085 Vali Loss: 6.151 Vali Acc: 0.480 Test Loss: 6.151 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.934680461883545
Epoch: 25, Steps: 70 | Train Loss: 0.160 Vali Loss: 5.918 Vali Acc: 0.440 Test Loss: 5.918 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.736495018005371
Epoch: 26, Steps: 70 | Train Loss: 0.121 Vali Loss: 5.534 Vali Acc: 0.470 Test Loss: 5.534 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.031044483184814
Epoch: 27, Steps: 70 | Train Loss: 0.122 Vali Loss: 6.566 Vali Acc: 0.550 Test Loss: 6.566 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.493126153945923
Epoch: 28, Steps: 70 | Train Loss: 0.453 Vali Loss: 5.570 Vali Acc: 0.560 Test Loss: 5.570 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 966174
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.933909893035889
Epoch: 1, Steps: 70 | Train Loss: 1.425 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 11.539209604263306
Epoch: 2, Steps: 70 | Train Loss: 2.421 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.599336862564087
Epoch: 3, Steps: 70 | Train Loss: 1.204 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 13.39385724067688
Epoch: 4, Steps: 70 | Train Loss: 1.197 Vali Loss: 1.569 Vali Acc: 0.500 Test Loss: 1.569 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.614168643951416
Epoch: 5, Steps: 70 | Train Loss: 1.418 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.978806495666504
Epoch: 6, Steps: 70 | Train Loss: 1.007 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 11.299284219741821
Epoch: 7, Steps: 70 | Train Loss: 1.477 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 13.430576086044312
Epoch: 8, Steps: 70 | Train Loss: 2.022 Vali Loss: 3.011 Vali Acc: 0.510 Test Loss: 3.011 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.352015495300293
Epoch: 9, Steps: 70 | Train Loss: 1.572 Vali Loss: 4.023 Vali Acc: 0.500 Test Loss: 4.023 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.303028345108032
Epoch: 10, Steps: 70 | Train Loss: 1.326 Vali Loss: 4.839 Vali Acc: 0.500 Test Loss: 4.839 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.342066049575806
Epoch: 11, Steps: 70 | Train Loss: 1.153 Vali Loss: 1.276 Vali Acc: 0.540 Test Loss: 1.276 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539987).  Saving model ...
Epoch: 12 cost time: 12.925121545791626
Epoch: 12, Steps: 70 | Train Loss: 1.086 Vali Loss: 3.270 Vali Acc: 0.520 Test Loss: 3.270 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.285705804824829
Epoch: 13, Steps: 70 | Train Loss: 1.089 Vali Loss: 1.898 Vali Acc: 0.530 Test Loss: 1.898 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.507890224456787
Epoch: 14, Steps: 70 | Train Loss: 0.733 Vali Loss: 4.014 Vali Acc: 0.470 Test Loss: 4.014 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.0386643409729
Epoch: 15, Steps: 70 | Train Loss: 0.876 Vali Loss: 2.773 Vali Acc: 0.570 Test Loss: 2.773 Test Acc: 0.570
Validation loss decreased (-0.539987 --> -0.569972).  Saving model ...
Epoch: 16 cost time: 11.497758150100708
Epoch: 16, Steps: 70 | Train Loss: 0.306 Vali Loss: 3.196 Vali Acc: 0.590 Test Loss: 3.196 Test Acc: 0.590
Validation loss decreased (-0.569972 --> -0.589968).  Saving model ...
Epoch: 17 cost time: 13.325976848602295
Epoch: 17, Steps: 70 | Train Loss: 0.819 Vali Loss: 4.056 Vali Acc: 0.540 Test Loss: 4.056 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.677648067474365
Epoch: 18, Steps: 70 | Train Loss: 0.370 Vali Loss: 4.784 Vali Acc: 0.600 Test Loss: 4.784 Test Acc: 0.600
Validation loss decreased (-0.589968 --> -0.599952).  Saving model ...
Epoch: 19 cost time: 13.005234956741333
Epoch: 19, Steps: 70 | Train Loss: 0.354 Vali Loss: 7.808 Vali Acc: 0.570 Test Loss: 7.808 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.27823781967163
Epoch: 20, Steps: 70 | Train Loss: 0.356 Vali Loss: 6.962 Vali Acc: 0.450 Test Loss: 6.962 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.453290224075317
Epoch: 21, Steps: 70 | Train Loss: 0.122 Vali Loss: 5.596 Vali Acc: 0.510 Test Loss: 5.596 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.445189237594604
Epoch: 22, Steps: 70 | Train Loss: 0.404 Vali Loss: 12.788 Vali Acc: 0.520 Test Loss: 12.788 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.447123050689697
Epoch: 23, Steps: 70 | Train Loss: 0.568 Vali Loss: 6.818 Vali Acc: 0.550 Test Loss: 6.818 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.346928358078003
Epoch: 24, Steps: 70 | Train Loss: 0.157 Vali Loss: 4.313 Vali Acc: 0.580 Test Loss: 4.313 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.80636715888977
Epoch: 25, Steps: 70 | Train Loss: 0.233 Vali Loss: 4.834 Vali Acc: 0.560 Test Loss: 4.834 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.637455940246582
Epoch: 26, Steps: 70 | Train Loss: 0.109 Vali Loss: 9.147 Vali Acc: 0.530 Test Loss: 9.147 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.72330641746521
Epoch: 27, Steps: 70 | Train Loss: 0.047 Vali Loss: 6.555 Vali Acc: 0.520 Test Loss: 6.555 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.56803846359253
Epoch: 28, Steps: 70 | Train Loss: 0.097 Vali Loss: 9.227 Vali Acc: 0.570 Test Loss: 9.227 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 936414
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.081431150436401
Epoch: 1, Steps: 70 | Train Loss: 1.122 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 13.35006046295166
Epoch: 2, Steps: 70 | Train Loss: 2.345 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
Validation loss decreased (-0.499987 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 11.16088080406189
Epoch: 3, Steps: 70 | Train Loss: 1.505 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.848915338516235
Epoch: 4, Steps: 70 | Train Loss: 1.706 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.871829509735107
Epoch: 5, Steps: 70 | Train Loss: 1.325 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.77027416229248
Epoch: 6, Steps: 70 | Train Loss: 1.111 Vali Loss: 2.186 Vali Acc: 0.500 Test Loss: 2.186 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.421312808990479
Epoch: 7, Steps: 70 | Train Loss: 1.739 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.876807451248169
Epoch: 8, Steps: 70 | Train Loss: 2.481 Vali Loss: 2.486 Vali Acc: 0.500 Test Loss: 2.486 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.549307107925415
Epoch: 9, Steps: 70 | Train Loss: 1.264 Vali Loss: 3.672 Vali Acc: 0.500 Test Loss: 3.672 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.833682775497437
Epoch: 10, Steps: 70 | Train Loss: 1.869 Vali Loss: 2.847 Vali Acc: 0.500 Test Loss: 2.847 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.36670470237732
Epoch: 11, Steps: 70 | Train Loss: 1.225 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.020045518875122
Epoch: 12, Steps: 70 | Train Loss: 1.494 Vali Loss: 1.764 Vali Acc: 0.520 Test Loss: 1.764 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 921374
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.037067890167236
Epoch: 1, Steps: 70 | Train Loss: 1.309 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 11.20819354057312
Epoch: 2, Steps: 70 | Train Loss: 1.536 Vali Loss: 6.279 Vali Acc: 0.500 Test Loss: 6.279 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499937).  Saving model ...
Epoch: 3 cost time: 8.820470571517944
Epoch: 3, Steps: 70 | Train Loss: 3.711 Vali Loss: 2.480 Vali Acc: 0.500 Test Loss: 2.480 Test Acc: 0.500
Validation loss decreased (-0.499937 --> -0.499975).  Saving model ...
Epoch: 4 cost time: 11.961263656616211
Epoch: 4, Steps: 70 | Train Loss: 1.397 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (-0.499975 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 12.89855670928955
Epoch: 5, Steps: 70 | Train Loss: 1.154 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.114952087402344
Epoch: 6, Steps: 70 | Train Loss: 1.125 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.410502195358276
Epoch: 7, Steps: 70 | Train Loss: 1.805 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.512297868728638
Epoch: 8, Steps: 70 | Train Loss: 1.314 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.837374925613403
Epoch: 9, Steps: 70 | Train Loss: 1.462 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.475263595581055
Epoch: 10, Steps: 70 | Train Loss: 1.220 Vali Loss: 2.135 Vali Acc: 0.500 Test Loss: 2.135 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.497001647949219
Epoch: 11, Steps: 70 | Train Loss: 1.870 Vali Loss: 1.440 Vali Acc: 0.520 Test Loss: 1.440 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 12.664347648620605
Epoch: 12, Steps: 70 | Train Loss: 1.239 Vali Loss: 2.390 Vali Acc: 0.540 Test Loss: 2.390 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539976).  Saving model ...
Epoch: 13 cost time: 12.682924509048462
Epoch: 13, Steps: 70 | Train Loss: 0.975 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.751282691955566
Epoch: 14, Steps: 70 | Train Loss: 0.870 Vali Loss: 1.946 Vali Acc: 0.580 Test Loss: 1.946 Test Acc: 0.580
Validation loss decreased (-0.539976 --> -0.579981).  Saving model ...
Epoch: 15 cost time: 12.588092803955078
Epoch: 15, Steps: 70 | Train Loss: 0.453 Vali Loss: 3.402 Vali Acc: 0.530 Test Loss: 3.402 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.758555889129639
Epoch: 16, Steps: 70 | Train Loss: 0.565 Vali Loss: 6.642 Vali Acc: 0.480 Test Loss: 6.642 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.909671783447266
Epoch: 17, Steps: 70 | Train Loss: 0.873 Vali Loss: 10.610 Vali Acc: 0.500 Test Loss: 10.610 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.77199935913086
Epoch: 18, Steps: 70 | Train Loss: 0.810 Vali Loss: 6.186 Vali Acc: 0.430 Test Loss: 6.186 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.651272296905518
Epoch: 19, Steps: 70 | Train Loss: 0.331 Vali Loss: 6.691 Vali Acc: 0.550 Test Loss: 6.691 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.776899576187134
Epoch: 20, Steps: 70 | Train Loss: 0.406 Vali Loss: 5.316 Vali Acc: 0.540 Test Loss: 5.316 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.850934743881226
Epoch: 21, Steps: 70 | Train Loss: 0.135 Vali Loss: 6.838 Vali Acc: 0.520 Test Loss: 6.838 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.232329368591309
Epoch: 22, Steps: 70 | Train Loss: 0.082 Vali Loss: 6.539 Vali Acc: 0.440 Test Loss: 6.539 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.460063934326172
Epoch: 23, Steps: 70 | Train Loss: 0.201 Vali Loss: 7.832 Vali Acc: 0.540 Test Loss: 7.832 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 12.662390947341919
Epoch: 24, Steps: 70 | Train Loss: 0.128 Vali Loss: 6.811 Vali Acc: 0.450 Test Loss: 6.811 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 906334
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.352169036865234
Epoch: 1, Steps: 70 | Train Loss: 1.353 Vali Loss: 1.437 Vali Acc: 0.540 Test Loss: 1.437 Test Acc: 0.540
Validation loss decreased (inf --> -0.539986).  Saving model ...
Epoch: 2 cost time: 11.823454141616821
Epoch: 2, Steps: 70 | Train Loss: 1.998 Vali Loss: 1.614 Vali Acc: 0.510 Test Loss: 1.614 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.259469032287598
Epoch: 3, Steps: 70 | Train Loss: 2.306 Vali Loss: 6.011 Vali Acc: 0.500 Test Loss: 6.011 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.25426197052002
Epoch: 4, Steps: 70 | Train Loss: 1.999 Vali Loss: 1.899 Vali Acc: 0.500 Test Loss: 1.899 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.41186237335205
Epoch: 5, Steps: 70 | Train Loss: 1.796 Vali Loss: 3.031 Vali Acc: 0.500 Test Loss: 3.031 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.11796498298645
Epoch: 6, Steps: 70 | Train Loss: 1.714 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.836594104766846
Epoch: 7, Steps: 70 | Train Loss: 1.907 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 12.32945990562439
Epoch: 8, Steps: 70 | Train Loss: 1.308 Vali Loss: 1.446 Vali Acc: 0.530 Test Loss: 1.446 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.318646669387817
Epoch: 9, Steps: 70 | Train Loss: 1.982 Vali Loss: 3.965 Vali Acc: 0.490 Test Loss: 3.965 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.409977197647095
Epoch: 10, Steps: 70 | Train Loss: 1.422 Vali Loss: 2.897 Vali Acc: 0.500 Test Loss: 2.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.428540706634521
Epoch: 11, Steps: 70 | Train Loss: 0.941 Vali Loss: 3.105 Vali Acc: 0.500 Test Loss: 3.105 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.535351753234863
Epoch: 12, Steps: 70 | Train Loss: 1.220 Vali Loss: 7.122 Vali Acc: 0.500 Test Loss: 7.122 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.47195029258728
Epoch: 13, Steps: 70 | Train Loss: 1.009 Vali Loss: 3.986 Vali Acc: 0.500 Test Loss: 3.986 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.309078693389893
Epoch: 14, Steps: 70 | Train Loss: 0.504 Vali Loss: 5.380 Vali Acc: 0.520 Test Loss: 5.380 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.551312923431396
Epoch: 15, Steps: 70 | Train Loss: 0.318 Vali Loss: 3.746 Vali Acc: 0.520 Test Loss: 3.746 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.389132738113403
Epoch: 16, Steps: 70 | Train Loss: 0.320 Vali Loss: 6.491 Vali Acc: 0.490 Test Loss: 6.491 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.536975383758545
Epoch: 17, Steps: 70 | Train Loss: 0.563 Vali Loss: 6.362 Vali Acc: 0.470 Test Loss: 6.362 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 891294
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.26300358772278
Epoch: 1, Steps: 70 | Train Loss: 13.016 Vali Loss: 10.992 Vali Acc: 0.500 Test Loss: 10.992 Test Acc: 0.500
Validation loss decreased (inf --> -0.499890).  Saving model ...
Epoch: 2 cost time: 30.545920610427856
Epoch: 2, Steps: 70 | Train Loss: 7.762 Vali Loss: 3.561 Vali Acc: 0.500 Test Loss: 3.561 Test Acc: 0.500
Validation loss decreased (-0.499890 --> -0.499964).  Saving model ...
Epoch: 3 cost time: 26.07816195487976
Epoch: 3, Steps: 70 | Train Loss: 5.627 Vali Loss: 26.318 Vali Acc: 0.500 Test Loss: 26.318 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.87489151954651
Epoch: 4, Steps: 70 | Train Loss: 6.584 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
Validation loss decreased (-0.499964 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 28.77177596092224
Epoch: 5, Steps: 70 | Train Loss: 10.732 Vali Loss: 8.401 Vali Acc: 0.500 Test Loss: 8.401 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.307750463485718
Epoch: 6, Steps: 70 | Train Loss: 16.586 Vali Loss: 4.426 Vali Acc: 0.500 Test Loss: 4.426 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.193653106689453
Epoch: 7, Steps: 70 | Train Loss: 5.455 Vali Loss: 5.259 Vali Acc: 0.500 Test Loss: 5.259 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.553320169448853
Epoch: 8, Steps: 70 | Train Loss: 5.142 Vali Loss: 7.240 Vali Acc: 0.500 Test Loss: 7.240 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 31.050505876541138
Epoch: 9, Steps: 70 | Train Loss: 6.031 Vali Loss: 9.112 Vali Acc: 0.500 Test Loss: 9.112 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 27.996015548706055
Epoch: 10, Steps: 70 | Train Loss: 19.734 Vali Loss: 15.229 Vali Acc: 0.500 Test Loss: 15.229 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 28.811489820480347
Epoch: 11, Steps: 70 | Train Loss: 15.526 Vali Loss: 39.975 Vali Acc: 0.500 Test Loss: 39.975 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 30.3747820854187
Epoch: 12, Steps: 70 | Train Loss: 6.682 Vali Loss: 4.040 Vali Acc: 0.500 Test Loss: 4.040 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 26.810463666915894
Epoch: 13, Steps: 70 | Train Loss: 10.550 Vali Loss: 10.658 Vali Acc: 0.500 Test Loss: 10.658 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 30.986945629119873
Epoch: 14, Steps: 70 | Train Loss: 6.251 Vali Loss: 8.058 Vali Acc: 0.500 Test Loss: 8.058 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 17694258
model size : 72.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.65426540374756
Epoch: 1, Steps: 70 | Train Loss: 21.965 Vali Loss: 34.604 Vali Acc: 0.500 Test Loss: 34.604 Test Acc: 0.500
Validation loss decreased (inf --> -0.499654).  Saving model ...
Epoch: 2 cost time: 30.63827681541443
Epoch: 2, Steps: 70 | Train Loss: 18.228 Vali Loss: 12.538 Vali Acc: 0.510 Test Loss: 12.538 Test Acc: 0.510
Validation loss decreased (-0.499654 --> -0.509875).  Saving model ...
Epoch: 3 cost time: 26.197362899780273
Epoch: 3, Steps: 70 | Train Loss: 10.857 Vali Loss: 4.489 Vali Acc: 0.500 Test Loss: 4.489 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.93554377555847
Epoch: 4, Steps: 70 | Train Loss: 6.148 Vali Loss: 2.501 Vali Acc: 0.500 Test Loss: 2.501 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.68930745124817
Epoch: 5, Steps: 70 | Train Loss: 4.557 Vali Loss: 7.640 Vali Acc: 0.500 Test Loss: 7.640 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.739871978759766
Epoch: 6, Steps: 70 | Train Loss: 4.755 Vali Loss: 1.566 Vali Acc: 0.510 Test Loss: 1.566 Test Acc: 0.510
Validation loss decreased (-0.509875 --> -0.509984).  Saving model ...
Epoch: 7 cost time: 30.06439232826233
Epoch: 7, Steps: 70 | Train Loss: 8.868 Vali Loss: 16.029 Vali Acc: 0.500 Test Loss: 16.029 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.243894577026367
Epoch: 8, Steps: 70 | Train Loss: 5.403 Vali Loss: 5.953 Vali Acc: 0.500 Test Loss: 5.953 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 30.968207359313965
Epoch: 9, Steps: 70 | Train Loss: 5.411 Vali Loss: 5.422 Vali Acc: 0.500 Test Loss: 5.422 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.124239206314087
Epoch: 10, Steps: 70 | Train Loss: 5.881 Vali Loss: 14.903 Vali Acc: 0.500 Test Loss: 14.903 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 30.6734459400177
Epoch: 11, Steps: 70 | Train Loss: 5.940 Vali Loss: 1.871 Vali Acc: 0.470 Test Loss: 1.871 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 29.241714239120483
Epoch: 12, Steps: 70 | Train Loss: 5.994 Vali Loss: 2.787 Vali Acc: 0.500 Test Loss: 2.787 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 28.28499174118042
Epoch: 13, Steps: 70 | Train Loss: 5.112 Vali Loss: 2.644 Vali Acc: 0.500 Test Loss: 2.644 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.74038290977478
Epoch: 14, Steps: 70 | Train Loss: 5.874 Vali Loss: 6.628 Vali Acc: 0.500 Test Loss: 6.628 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 27.483081340789795
Epoch: 15, Steps: 70 | Train Loss: 5.227 Vali Loss: 9.881 Vali Acc: 0.500 Test Loss: 9.881 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 28.70528292655945
Epoch: 16, Steps: 70 | Train Loss: 5.561 Vali Loss: 4.032 Vali Acc: 0.500 Test Loss: 4.032 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 17582130
model size : 72.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.246208667755127
Epoch: 1, Steps: 70 | Train Loss: 12.637 Vali Loss: 10.603 Vali Acc: 0.510 Test Loss: 10.603 Test Acc: 0.510
Validation loss decreased (inf --> -0.509894).  Saving model ...
Epoch: 2 cost time: 27.745253324508667
Epoch: 2, Steps: 70 | Train Loss: 27.537 Vali Loss: 37.136 Vali Acc: 0.500 Test Loss: 37.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.840900897979736
Epoch: 3, Steps: 70 | Train Loss: 8.432 Vali Loss: 3.496 Vali Acc: 0.500 Test Loss: 3.496 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 26.069152355194092
Epoch: 4, Steps: 70 | Train Loss: 4.899 Vali Loss: 9.506 Vali Acc: 0.500 Test Loss: 9.506 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 26.060694456100464
Epoch: 5, Steps: 70 | Train Loss: 4.785 Vali Loss: 15.089 Vali Acc: 0.500 Test Loss: 15.089 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 27.868400812149048
Epoch: 6, Steps: 70 | Train Loss: 8.988 Vali Loss: 3.253 Vali Acc: 0.500 Test Loss: 3.253 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 28.711403369903564
Epoch: 7, Steps: 70 | Train Loss: 9.354 Vali Loss: 20.040 Vali Acc: 0.500 Test Loss: 20.040 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 26.25000786781311
Epoch: 8, Steps: 70 | Train Loss: 7.996 Vali Loss: 15.666 Vali Acc: 0.500 Test Loss: 15.666 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 25.616815328598022
Epoch: 9, Steps: 70 | Train Loss: 6.116 Vali Loss: 8.625 Vali Acc: 0.500 Test Loss: 8.625 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 27.593351364135742
Epoch: 10, Steps: 70 | Train Loss: 10.754 Vali Loss: 1.461 Vali Acc: 0.510 Test Loss: 1.461 Test Acc: 0.510
Validation loss decreased (-0.509894 --> -0.509985).  Saving model ...
Epoch: 11 cost time: 28.684629678726196
Epoch: 11, Steps: 70 | Train Loss: 8.075 Vali Loss: 4.517 Vali Acc: 0.500 Test Loss: 4.517 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.261351346969604
Epoch: 12, Steps: 70 | Train Loss: 6.919 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.20711922645569
Epoch: 13, Steps: 70 | Train Loss: 6.458 Vali Loss: 10.443 Vali Acc: 0.500 Test Loss: 10.443 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.70352530479431
Epoch: 14, Steps: 70 | Train Loss: 5.198 Vali Loss: 9.609 Vali Acc: 0.500 Test Loss: 9.609 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.185431480407715
Epoch: 15, Steps: 70 | Train Loss: 8.169 Vali Loss: 2.570 Vali Acc: 0.500 Test Loss: 2.570 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 26.462705373764038
Epoch: 16, Steps: 70 | Train Loss: 6.454 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 24.907273292541504
Epoch: 17, Steps: 70 | Train Loss: 4.877 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 26.98483943939209
Epoch: 18, Steps: 70 | Train Loss: 4.369 Vali Loss: 8.441 Vali Acc: 0.500 Test Loss: 8.441 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 28.621077299118042
Epoch: 19, Steps: 70 | Train Loss: 4.609 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 26.68655037879944
Epoch: 20, Steps: 70 | Train Loss: 6.169 Vali Loss: 22.445 Vali Acc: 0.500 Test Loss: 22.445 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 17470002
model size : 71.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.23675537109375
Epoch: 1, Steps: 70 | Train Loss: 9.720 Vali Loss: 16.007 Vali Acc: 0.500 Test Loss: 16.007 Test Acc: 0.500
Validation loss decreased (inf --> -0.499840).  Saving model ...
Epoch: 2 cost time: 28.20163917541504
Epoch: 2, Steps: 70 | Train Loss: 4.821 Vali Loss: 3.943 Vali Acc: 0.500 Test Loss: 3.943 Test Acc: 0.500
Validation loss decreased (-0.499840 --> -0.499961).  Saving model ...
Epoch: 3 cost time: 28.11001181602478
Epoch: 3, Steps: 70 | Train Loss: 3.157 Vali Loss: 32.080 Vali Acc: 0.500 Test Loss: 32.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.999408721923828
Epoch: 4, Steps: 70 | Train Loss: 6.782 Vali Loss: 4.313 Vali Acc: 0.500 Test Loss: 4.313 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.943630933761597
Epoch: 5, Steps: 70 | Train Loss: 4.676 Vali Loss: 3.814 Vali Acc: 0.500 Test Loss: 3.814 Test Acc: 0.500
Validation loss decreased (-0.499961 --> -0.499962).  Saving model ...
Epoch: 6 cost time: 29.524259090423584
Epoch: 6, Steps: 70 | Train Loss: 8.767 Vali Loss: 2.064 Vali Acc: 0.500 Test Loss: 2.064 Test Acc: 0.500
Validation loss decreased (-0.499962 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 27.546234130859375
Epoch: 7, Steps: 70 | Train Loss: 6.570 Vali Loss: 3.355 Vali Acc: 0.500 Test Loss: 3.355 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 28.764798402786255
Epoch: 8, Steps: 70 | Train Loss: 4.285 Vali Loss: 5.465 Vali Acc: 0.500 Test Loss: 5.465 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.35152006149292
Epoch: 9, Steps: 70 | Train Loss: 5.476 Vali Loss: 5.161 Vali Acc: 0.500 Test Loss: 5.161 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.670643091201782
Epoch: 10, Steps: 70 | Train Loss: 9.960 Vali Loss: 3.456 Vali Acc: 0.500 Test Loss: 3.456 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.28313183784485
Epoch: 11, Steps: 70 | Train Loss: 4.502 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 26.241642713546753
Epoch: 12, Steps: 70 | Train Loss: 4.017 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499991).  Saving model ...
Epoch: 13 cost time: 29.06877565383911
Epoch: 13, Steps: 70 | Train Loss: 6.594 Vali Loss: 2.965 Vali Acc: 0.500 Test Loss: 2.965 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.36548399925232
Epoch: 14, Steps: 70 | Train Loss: 4.487 Vali Loss: 11.838 Vali Acc: 0.500 Test Loss: 11.838 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.48351001739502
Epoch: 15, Steps: 70 | Train Loss: 7.713 Vali Loss: 12.728 Vali Acc: 0.500 Test Loss: 12.728 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 28.829858541488647
Epoch: 16, Steps: 70 | Train Loss: 6.309 Vali Loss: 10.995 Vali Acc: 0.500 Test Loss: 10.995 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.98236060142517
Epoch: 17, Steps: 70 | Train Loss: 7.083 Vali Loss: 3.454 Vali Acc: 0.500 Test Loss: 3.454 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 28.19895339012146
Epoch: 18, Steps: 70 | Train Loss: 3.467 Vali Loss: 8.594 Vali Acc: 0.500 Test Loss: 8.594 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 29.274742364883423
Epoch: 19, Steps: 70 | Train Loss: 4.253 Vali Loss: 1.890 Vali Acc: 0.500 Test Loss: 1.890 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.280178785324097
Epoch: 20, Steps: 70 | Train Loss: 4.488 Vali Loss: 4.572 Vali Acc: 0.500 Test Loss: 4.572 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 29.30631399154663
Epoch: 21, Steps: 70 | Train Loss: 4.339 Vali Loss: 21.092 Vali Acc: 0.500 Test Loss: 21.092 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 27.207754611968994
Epoch: 22, Steps: 70 | Train Loss: 4.482 Vali Loss: 3.286 Vali Acc: 0.500 Test Loss: 3.286 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 17357874
model size : 71.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.99222183227539
Epoch: 1, Steps: 70 | Train Loss: 9.018 Vali Loss: 13.056 Vali Acc: 0.500 Test Loss: 13.056 Test Acc: 0.500
Validation loss decreased (inf --> -0.499869).  Saving model ...
Epoch: 2 cost time: 24.591041088104248
Epoch: 2, Steps: 70 | Train Loss: 6.657 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (-0.499869 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 28.110690355300903
Epoch: 3, Steps: 70 | Train Loss: 6.541 Vali Loss: 17.737 Vali Acc: 0.500 Test Loss: 17.737 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.168879985809326
Epoch: 4, Steps: 70 | Train Loss: 7.280 Vali Loss: 5.967 Vali Acc: 0.500 Test Loss: 5.967 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.406105518341064
Epoch: 5, Steps: 70 | Train Loss: 5.167 Vali Loss: 2.670 Vali Acc: 0.500 Test Loss: 2.670 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.218921184539795
Epoch: 6, Steps: 70 | Train Loss: 4.173 Vali Loss: 19.664 Vali Acc: 0.500 Test Loss: 19.664 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.24569797515869
Epoch: 7, Steps: 70 | Train Loss: 7.729 Vali Loss: 11.593 Vali Acc: 0.500 Test Loss: 11.593 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 26.732094764709473
Epoch: 8, Steps: 70 | Train Loss: 9.223 Vali Loss: 16.490 Vali Acc: 0.500 Test Loss: 16.490 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 25.90921449661255
Epoch: 9, Steps: 70 | Train Loss: 7.334 Vali Loss: 1.947 Vali Acc: 0.500 Test Loss: 1.947 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.990240573883057
Epoch: 10, Steps: 70 | Train Loss: 4.044 Vali Loss: 3.272 Vali Acc: 0.500 Test Loss: 3.272 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 26.7477548122406
Epoch: 11, Steps: 70 | Train Loss: 8.604 Vali Loss: 10.005 Vali Acc: 0.500 Test Loss: 10.005 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 26.48458695411682
Epoch: 12, Steps: 70 | Train Loss: 5.024 Vali Loss: 8.644 Vali Acc: 0.500 Test Loss: 8.644 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15855666
model size : 65.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.586305141448975
Epoch: 1, Steps: 70 | Train Loss: 14.148 Vali Loss: 44.439 Vali Acc: 0.500 Test Loss: 44.439 Test Acc: 0.500
Validation loss decreased (inf --> -0.499556).  Saving model ...
Epoch: 2 cost time: 26.140103101730347
Epoch: 2, Steps: 70 | Train Loss: 10.237 Vali Loss: 5.346 Vali Acc: 0.500 Test Loss: 5.346 Test Acc: 0.500
Validation loss decreased (-0.499556 --> -0.499947).  Saving model ...
Epoch: 3 cost time: 22.81430721282959
Epoch: 3, Steps: 70 | Train Loss: 8.263 Vali Loss: 1.665 Vali Acc: 0.500 Test Loss: 1.665 Test Acc: 0.500
Validation loss decreased (-0.499947 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 25.236361503601074
Epoch: 4, Steps: 70 | Train Loss: 6.408 Vali Loss: 3.763 Vali Acc: 0.500 Test Loss: 3.763 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.505341291427612
Epoch: 5, Steps: 70 | Train Loss: 6.104 Vali Loss: 5.593 Vali Acc: 0.500 Test Loss: 5.593 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.973137617111206
Epoch: 6, Steps: 70 | Train Loss: 4.408 Vali Loss: 9.646 Vali Acc: 0.500 Test Loss: 9.646 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.031538486480713
Epoch: 7, Steps: 70 | Train Loss: 6.016 Vali Loss: 3.837 Vali Acc: 0.500 Test Loss: 3.837 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.01449203491211
Epoch: 8, Steps: 70 | Train Loss: 7.200 Vali Loss: 8.143 Vali Acc: 0.500 Test Loss: 8.143 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.602303981781006
Epoch: 9, Steps: 70 | Train Loss: 4.442 Vali Loss: 10.472 Vali Acc: 0.500 Test Loss: 10.472 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.28754210472107
Epoch: 10, Steps: 70 | Train Loss: 7.815 Vali Loss: 1.596 Vali Acc: 0.450 Test Loss: 1.596 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 26.1847140789032
Epoch: 11, Steps: 70 | Train Loss: 5.386 Vali Loss: 11.683 Vali Acc: 0.500 Test Loss: 11.683 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.7881076335907
Epoch: 12, Steps: 70 | Train Loss: 6.493 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 25.529890060424805
Epoch: 13, Steps: 70 | Train Loss: 5.196 Vali Loss: 9.013 Vali Acc: 0.500 Test Loss: 9.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.77865982055664
Epoch: 14, Steps: 70 | Train Loss: 4.329 Vali Loss: 3.262 Vali Acc: 0.500 Test Loss: 3.262 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.740583181381226
Epoch: 15, Steps: 70 | Train Loss: 3.537 Vali Loss: 2.316 Vali Acc: 0.500 Test Loss: 2.316 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.188152074813843
Epoch: 16, Steps: 70 | Train Loss: 4.190 Vali Loss: 4.727 Vali Acc: 0.500 Test Loss: 4.727 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.47485661506653
Epoch: 17, Steps: 70 | Train Loss: 4.288 Vali Loss: 2.274 Vali Acc: 0.500 Test Loss: 2.274 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 24.0727596282959
Epoch: 18, Steps: 70 | Train Loss: 3.615 Vali Loss: 7.749 Vali Acc: 0.500 Test Loss: 7.749 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.53484296798706
Epoch: 19, Steps: 70 | Train Loss: 3.482 Vali Loss: 3.275 Vali Acc: 0.500 Test Loss: 3.275 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.55808711051941
Epoch: 20, Steps: 70 | Train Loss: 3.514 Vali Loss: 1.826 Vali Acc: 0.500 Test Loss: 1.826 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 24.658740520477295
Epoch: 21, Steps: 70 | Train Loss: 3.252 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499992).  Saving model ...
Epoch: 22 cost time: 24.925178050994873
Epoch: 22, Steps: 70 | Train Loss: 3.672 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 25.697192668914795
Epoch: 23, Steps: 70 | Train Loss: 3.870 Vali Loss: 2.092 Vali Acc: 0.500 Test Loss: 2.092 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 24.84994339942932
Epoch: 24, Steps: 70 | Train Loss: 3.468 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 24.191189527511597
Epoch: 25, Steps: 70 | Train Loss: 3.716 Vali Loss: 2.379 Vali Acc: 0.500 Test Loss: 2.379 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 26.207413911819458
Epoch: 26, Steps: 70 | Train Loss: 2.136 Vali Loss: 3.480 Vali Acc: 0.500 Test Loss: 3.480 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 25.708865880966187
Epoch: 27, Steps: 70 | Train Loss: 2.007 Vali Loss: 2.635 Vali Acc: 0.500 Test Loss: 2.635 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 24.911527633666992
Epoch: 28, Steps: 70 | Train Loss: 1.664 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 25.969073057174683
Epoch: 29, Steps: 70 | Train Loss: 1.835 Vali Loss: 4.305 Vali Acc: 0.500 Test Loss: 4.305 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 25.83083152770996
Epoch: 30, Steps: 70 | Train Loss: 2.715 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 26.989498376846313
Epoch: 31, Steps: 70 | Train Loss: 2.557 Vali Loss: 3.630 Vali Acc: 0.500 Test Loss: 3.630 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15743538
model size : 65.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.515204191207886
Epoch: 1, Steps: 70 | Train Loss: 11.194 Vali Loss: 30.028 Vali Acc: 0.500 Test Loss: 30.028 Test Acc: 0.500
Validation loss decreased (inf --> -0.499700).  Saving model ...
Epoch: 2 cost time: 25.795875072479248
Epoch: 2, Steps: 70 | Train Loss: 11.788 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
Validation loss decreased (-0.499700 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 25.254498958587646
Epoch: 3, Steps: 70 | Train Loss: 10.468 Vali Loss: 6.184 Vali Acc: 0.500 Test Loss: 6.184 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.18289065361023
Epoch: 4, Steps: 70 | Train Loss: 6.690 Vali Loss: 15.540 Vali Acc: 0.500 Test Loss: 15.540 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.050391674041748
Epoch: 5, Steps: 70 | Train Loss: 9.564 Vali Loss: 6.643 Vali Acc: 0.500 Test Loss: 6.643 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.27048373222351
Epoch: 6, Steps: 70 | Train Loss: 5.419 Vali Loss: 4.612 Vali Acc: 0.500 Test Loss: 4.612 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.999871969223022
Epoch: 7, Steps: 70 | Train Loss: 5.485 Vali Loss: 34.869 Vali Acc: 0.500 Test Loss: 34.869 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.734244108200073
Epoch: 8, Steps: 70 | Train Loss: 6.664 Vali Loss: 17.633 Vali Acc: 0.500 Test Loss: 17.633 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.156046390533447
Epoch: 9, Steps: 70 | Train Loss: 9.981 Vali Loss: 5.679 Vali Acc: 0.500 Test Loss: 5.679 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.581185817718506
Epoch: 10, Steps: 70 | Train Loss: 5.503 Vali Loss: 5.080 Vali Acc: 0.500 Test Loss: 5.080 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.706247091293335
Epoch: 11, Steps: 70 | Train Loss: 4.200 Vali Loss: 6.767 Vali Acc: 0.500 Test Loss: 6.767 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 24.606942176818848
Epoch: 12, Steps: 70 | Train Loss: 5.089 Vali Loss: 2.067 Vali Acc: 0.500 Test Loss: 2.067 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 15631410
model size : 64.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.02044916152954
Epoch: 1, Steps: 70 | Train Loss: 10.040 Vali Loss: 1.317 Vali Acc: 0.570 Test Loss: 1.317 Test Acc: 0.570
Validation loss decreased (inf --> -0.569987).  Saving model ...
Epoch: 2 cost time: 24.480286121368408
Epoch: 2, Steps: 70 | Train Loss: 9.162 Vali Loss: 6.958 Vali Acc: 0.500 Test Loss: 6.958 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.21062970161438
Epoch: 3, Steps: 70 | Train Loss: 5.555 Vali Loss: 8.744 Vali Acc: 0.500 Test Loss: 8.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.742908239364624
Epoch: 4, Steps: 70 | Train Loss: 6.863 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 24.808492183685303
Epoch: 5, Steps: 70 | Train Loss: 7.773 Vali Loss: 1.743 Vali Acc: 0.500 Test Loss: 1.743 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 24.40054941177368
Epoch: 6, Steps: 70 | Train Loss: 6.468 Vali Loss: 16.774 Vali Acc: 0.500 Test Loss: 16.774 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.078317880630493
Epoch: 7, Steps: 70 | Train Loss: 6.152 Vali Loss: 6.263 Vali Acc: 0.500 Test Loss: 6.263 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.718153476715088
Epoch: 8, Steps: 70 | Train Loss: 6.959 Vali Loss: 6.525 Vali Acc: 0.500 Test Loss: 6.525 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 20.87653374671936
Epoch: 9, Steps: 70 | Train Loss: 5.665 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 22.734559297561646
Epoch: 10, Steps: 70 | Train Loss: 3.916 Vali Loss: 1.975 Vali Acc: 0.500 Test Loss: 1.975 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.547580242156982
Epoch: 11, Steps: 70 | Train Loss: 4.273 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 15519282
model size : 64.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.670031547546387
Epoch: 1, Steps: 70 | Train Loss: 12.757 Vali Loss: 9.377 Vali Acc: 0.510 Test Loss: 9.377 Test Acc: 0.510
Validation loss decreased (inf --> -0.509906).  Saving model ...
Epoch: 2 cost time: 22.53608751296997
Epoch: 2, Steps: 70 | Train Loss: 7.095 Vali Loss: 10.587 Vali Acc: 0.500 Test Loss: 10.587 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.775312185287476
Epoch: 3, Steps: 70 | Train Loss: 5.449 Vali Loss: 12.733 Vali Acc: 0.500 Test Loss: 12.733 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.617391109466553
Epoch: 4, Steps: 70 | Train Loss: 12.312 Vali Loss: 9.599 Vali Acc: 0.500 Test Loss: 9.599 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.356308460235596
Epoch: 5, Steps: 70 | Train Loss: 7.943 Vali Loss: 8.003 Vali Acc: 0.500 Test Loss: 8.003 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.879293203353882
Epoch: 6, Steps: 70 | Train Loss: 5.904 Vali Loss: 4.107 Vali Acc: 0.500 Test Loss: 4.107 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 21.09239172935486
Epoch: 7, Steps: 70 | Train Loss: 9.641 Vali Loss: 8.697 Vali Acc: 0.500 Test Loss: 8.697 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 22.31977343559265
Epoch: 8, Steps: 70 | Train Loss: 8.746 Vali Loss: 3.643 Vali Acc: 0.500 Test Loss: 3.643 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.99614381790161
Epoch: 9, Steps: 70 | Train Loss: 5.119 Vali Loss: 7.791 Vali Acc: 0.500 Test Loss: 7.791 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 23.83363652229309
Epoch: 10, Steps: 70 | Train Loss: 5.132 Vali Loss: 2.870 Vali Acc: 0.500 Test Loss: 2.870 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 21.96286416053772
Epoch: 11, Steps: 70 | Train Loss: 8.121 Vali Loss: 3.889 Vali Acc: 0.500 Test Loss: 3.889 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 14936370
model size : 62.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.21254825592041
Epoch: 1, Steps: 70 | Train Loss: 6.363 Vali Loss: 15.421 Vali Acc: 0.500 Test Loss: 15.421 Test Acc: 0.500
Validation loss decreased (inf --> -0.499846).  Saving model ...
Epoch: 2 cost time: 21.8883855342865
Epoch: 2, Steps: 70 | Train Loss: 12.555 Vali Loss: 7.869 Vali Acc: 0.500 Test Loss: 7.869 Test Acc: 0.500
Validation loss decreased (-0.499846 --> -0.499921).  Saving model ...
Epoch: 3 cost time: 22.94062566757202
Epoch: 3, Steps: 70 | Train Loss: 6.192 Vali Loss: 13.887 Vali Acc: 0.500 Test Loss: 13.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.39561915397644
Epoch: 4, Steps: 70 | Train Loss: 10.448 Vali Loss: 13.270 Vali Acc: 0.500 Test Loss: 13.270 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.317309856414795
Epoch: 5, Steps: 70 | Train Loss: 3.483 Vali Loss: 7.516 Vali Acc: 0.500 Test Loss: 7.516 Test Acc: 0.500
Validation loss decreased (-0.499921 --> -0.499925).  Saving model ...
Epoch: 6 cost time: 21.532037496566772
Epoch: 6, Steps: 70 | Train Loss: 6.959 Vali Loss: 6.014 Vali Acc: 0.500 Test Loss: 6.014 Test Acc: 0.500
Validation loss decreased (-0.499925 --> -0.499940).  Saving model ...
Epoch: 7 cost time: 22.00711679458618
Epoch: 7, Steps: 70 | Train Loss: 7.990 Vali Loss: 10.044 Vali Acc: 0.500 Test Loss: 10.044 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.359224796295166
Epoch: 8, Steps: 70 | Train Loss: 5.122 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.69612979888916
Epoch: 9, Steps: 70 | Train Loss: 3.864 Vali Loss: 5.464 Vali Acc: 0.500 Test Loss: 5.464 Test Acc: 0.500
Validation loss decreased (-0.499940 --> -0.499945).  Saving model ...
Epoch: 10 cost time: 22.11469268798828
Epoch: 10, Steps: 70 | Train Loss: 4.172 Vali Loss: 10.405 Vali Acc: 0.500 Test Loss: 10.405 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.008163928985596
Epoch: 11, Steps: 70 | Train Loss: 4.929 Vali Loss: 3.947 Vali Acc: 0.500 Test Loss: 3.947 Test Acc: 0.500
Validation loss decreased (-0.499945 --> -0.499961).  Saving model ...
Epoch: 12 cost time: 23.024445056915283
Epoch: 12, Steps: 70 | Train Loss: 4.859 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
Validation loss decreased (-0.499961 --> -0.499992).  Saving model ...
Epoch: 13 cost time: 23.039767503738403
Epoch: 13, Steps: 70 | Train Loss: 4.790 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.701683521270752
Epoch: 14, Steps: 70 | Train Loss: 5.239 Vali Loss: 4.990 Vali Acc: 0.500 Test Loss: 4.990 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.924505710601807
Epoch: 15, Steps: 70 | Train Loss: 4.198 Vali Loss: 3.775 Vali Acc: 0.500 Test Loss: 3.775 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.778963327407837
Epoch: 16, Steps: 70 | Train Loss: 4.150 Vali Loss: 5.553 Vali Acc: 0.500 Test Loss: 5.553 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 24.199060916900635
Epoch: 17, Steps: 70 | Train Loss: 3.481 Vali Loss: 3.510 Vali Acc: 0.500 Test Loss: 3.510 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 21.489652633666992
Epoch: 18, Steps: 70 | Train Loss: 2.754 Vali Loss: 2.224 Vali Acc: 0.500 Test Loss: 2.224 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.140810012817383
Epoch: 19, Steps: 70 | Train Loss: 2.702 Vali Loss: 1.987 Vali Acc: 0.500 Test Loss: 1.987 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 23.692473649978638
Epoch: 20, Steps: 70 | Train Loss: 2.055 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.073113679885864
Epoch: 21, Steps: 70 | Train Loss: 1.851 Vali Loss: 3.259 Vali Acc: 0.500 Test Loss: 3.259 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.96128797531128
Epoch: 22, Steps: 70 | Train Loss: 7.559 Vali Loss: 17.864 Vali Acc: 0.500 Test Loss: 17.864 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14824242
model size : 61.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.704477787017822
Epoch: 1, Steps: 70 | Train Loss: 12.518 Vali Loss: 10.759 Vali Acc: 0.510 Test Loss: 10.759 Test Acc: 0.510
Validation loss decreased (inf --> -0.509892).  Saving model ...
Epoch: 2 cost time: 22.356920957565308
Epoch: 2, Steps: 70 | Train Loss: 15.983 Vali Loss: 13.810 Vali Acc: 0.500 Test Loss: 13.810 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.64688992500305
Epoch: 3, Steps: 70 | Train Loss: 6.264 Vali Loss: 6.937 Vali Acc: 0.500 Test Loss: 6.937 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.557747840881348
Epoch: 4, Steps: 70 | Train Loss: 5.071 Vali Loss: 4.864 Vali Acc: 0.500 Test Loss: 4.864 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.13055181503296
Epoch: 5, Steps: 70 | Train Loss: 9.767 Vali Loss: 8.961 Vali Acc: 0.500 Test Loss: 8.961 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.046948671340942
Epoch: 6, Steps: 70 | Train Loss: 7.582 Vali Loss: 8.270 Vali Acc: 0.500 Test Loss: 8.270 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.25376272201538
Epoch: 7, Steps: 70 | Train Loss: 7.845 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.44082283973694
Epoch: 8, Steps: 70 | Train Loss: 4.509 Vali Loss: 13.191 Vali Acc: 0.500 Test Loss: 13.191 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.166620016098022
Epoch: 9, Steps: 70 | Train Loss: 4.729 Vali Loss: 4.226 Vali Acc: 0.500 Test Loss: 4.226 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.552449703216553
Epoch: 10, Steps: 70 | Train Loss: 7.913 Vali Loss: 8.518 Vali Acc: 0.500 Test Loss: 8.518 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 21.4135799407959
Epoch: 11, Steps: 70 | Train Loss: 5.272 Vali Loss: 0.838 Vali Acc: 0.450 Test Loss: 0.838 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 14712114
model size : 61.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.102258443832397
Epoch: 1, Steps: 70 | Train Loss: 13.043 Vali Loss: 8.818 Vali Acc: 0.470 Test Loss: 8.818 Test Acc: 0.470
Validation loss decreased (inf --> -0.469912).  Saving model ...
Epoch: 2 cost time: 22.37495756149292
Epoch: 2, Steps: 70 | Train Loss: 12.750 Vali Loss: 2.552 Vali Acc: 0.510 Test Loss: 2.552 Test Acc: 0.510
Validation loss decreased (-0.469912 --> -0.509974).  Saving model ...
Epoch: 3 cost time: 23.02022886276245
Epoch: 3, Steps: 70 | Train Loss: 8.752 Vali Loss: 11.281 Vali Acc: 0.500 Test Loss: 11.281 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.91239881515503
Epoch: 4, Steps: 70 | Train Loss: 3.310 Vali Loss: 3.382 Vali Acc: 0.500 Test Loss: 3.382 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.48834490776062
Epoch: 5, Steps: 70 | Train Loss: 7.046 Vali Loss: 6.114 Vali Acc: 0.500 Test Loss: 6.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.57931089401245
Epoch: 6, Steps: 70 | Train Loss: 5.588 Vali Loss: 12.093 Vali Acc: 0.500 Test Loss: 12.093 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.904303312301636
Epoch: 7, Steps: 70 | Train Loss: 4.877 Vali Loss: 11.108 Vali Acc: 0.500 Test Loss: 11.108 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.56542205810547
Epoch: 8, Steps: 70 | Train Loss: 5.634 Vali Loss: 5.114 Vali Acc: 0.500 Test Loss: 5.114 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.229459285736084
Epoch: 9, Steps: 70 | Train Loss: 6.375 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.592193841934204
Epoch: 10, Steps: 70 | Train Loss: 3.894 Vali Loss: 14.110 Vali Acc: 0.500 Test Loss: 14.110 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.425269603729248
Epoch: 11, Steps: 70 | Train Loss: 9.263 Vali Loss: 0.980 Vali Acc: 0.500 Test Loss: 0.980 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 22.065457820892334
Epoch: 12, Steps: 70 | Train Loss: 6.076 Vali Loss: 2.708 Vali Acc: 0.500 Test Loss: 2.708 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 14599986
model size : 60.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.2339448928833
Epoch: 1, Steps: 70 | Train Loss: 12.822 Vali Loss: 20.958 Vali Acc: 0.500 Test Loss: 20.958 Test Acc: 0.500
Validation loss decreased (inf --> -0.499790).  Saving model ...
Epoch: 2 cost time: 23.51000714302063
Epoch: 2, Steps: 70 | Train Loss: 7.341 Vali Loss: 4.540 Vali Acc: 0.500 Test Loss: 4.540 Test Acc: 0.500
Validation loss decreased (-0.499790 --> -0.499955).  Saving model ...
Epoch: 3 cost time: 22.842247009277344
Epoch: 3, Steps: 70 | Train Loss: 6.111 Vali Loss: 1.999 Vali Acc: 0.500 Test Loss: 1.999 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 21.832428455352783
Epoch: 4, Steps: 70 | Train Loss: 2.754 Vali Loss: 2.882 Vali Acc: 0.500 Test Loss: 2.882 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.153028964996338
Epoch: 5, Steps: 70 | Train Loss: 3.088 Vali Loss: 1.727 Vali Acc: 0.500 Test Loss: 1.727 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499983).  Saving model ...
Epoch: 6 cost time: 22.76673197746277
Epoch: 6, Steps: 70 | Train Loss: 4.140 Vali Loss: 5.479 Vali Acc: 0.500 Test Loss: 5.479 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.90988850593567
Epoch: 7, Steps: 70 | Train Loss: 4.280 Vali Loss: 14.778 Vali Acc: 0.500 Test Loss: 14.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.051685333251953
Epoch: 8, Steps: 70 | Train Loss: 7.322 Vali Loss: 26.456 Vali Acc: 0.500 Test Loss: 26.456 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.06295919418335
Epoch: 9, Steps: 70 | Train Loss: 8.652 Vali Loss: 0.688 Vali Acc: 0.540 Test Loss: 0.688 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 23.826488256454468
Epoch: 10, Steps: 70 | Train Loss: 4.800 Vali Loss: 5.925 Vali Acc: 0.500 Test Loss: 5.925 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.91133713722229
Epoch: 11, Steps: 70 | Train Loss: 6.986 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.72605061531067
Epoch: 12, Steps: 70 | Train Loss: 4.601 Vali Loss: 9.209 Vali Acc: 0.500 Test Loss: 9.209 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.71029019355774
Epoch: 13, Steps: 70 | Train Loss: 4.412 Vali Loss: 1.571 Vali Acc: 0.500 Test Loss: 1.571 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.64604878425598
Epoch: 14, Steps: 70 | Train Loss: 5.572 Vali Loss: 3.659 Vali Acc: 0.500 Test Loss: 3.659 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.886385917663574
Epoch: 15, Steps: 70 | Train Loss: 7.784 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 22.56009840965271
Epoch: 16, Steps: 70 | Train Loss: 5.379 Vali Loss: 16.363 Vali Acc: 0.500 Test Loss: 16.363 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.554731607437134
Epoch: 17, Steps: 70 | Train Loss: 4.519 Vali Loss: 6.725 Vali Acc: 0.500 Test Loss: 6.725 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.36746883392334
Epoch: 18, Steps: 70 | Train Loss: 4.234 Vali Loss: 2.230 Vali Acc: 0.500 Test Loss: 2.230 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 22.343249082565308
Epoch: 19, Steps: 70 | Train Loss: 3.984 Vali Loss: 1.993 Vali Acc: 0.500 Test Loss: 1.993 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 14476722
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.00495171546936
Epoch: 1, Steps: 70 | Train Loss: 10.327 Vali Loss: 37.808 Vali Acc: 0.480 Test Loss: 37.808 Test Acc: 0.480
Validation loss decreased (inf --> -0.479622).  Saving model ...
Epoch: 2 cost time: 23.572117805480957
Epoch: 2, Steps: 70 | Train Loss: 16.634 Vali Loss: 1.549 Vali Acc: 0.500 Test Loss: 1.549 Test Acc: 0.500
Validation loss decreased (-0.479622 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 22.137021780014038
Epoch: 3, Steps: 70 | Train Loss: 7.296 Vali Loss: 4.111 Vali Acc: 0.510 Test Loss: 4.111 Test Acc: 0.510
Validation loss decreased (-0.499985 --> -0.509959).  Saving model ...
Epoch: 4 cost time: 22.77479386329651
Epoch: 4, Steps: 70 | Train Loss: 7.439 Vali Loss: 2.746 Vali Acc: 0.520 Test Loss: 2.746 Test Acc: 0.520
Validation loss decreased (-0.509959 --> -0.519973).  Saving model ...
Epoch: 5 cost time: 23.759734869003296
Epoch: 5, Steps: 70 | Train Loss: 6.886 Vali Loss: 11.840 Vali Acc: 0.500 Test Loss: 11.840 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.93868112564087
Epoch: 6, Steps: 70 | Train Loss: 5.552 Vali Loss: 3.254 Vali Acc: 0.500 Test Loss: 3.254 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.528444528579712
Epoch: 7, Steps: 70 | Train Loss: 5.042 Vali Loss: 0.946 Vali Acc: 0.500 Test Loss: 0.946 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.530385732650757
Epoch: 8, Steps: 70 | Train Loss: 5.528 Vali Loss: 9.322 Vali Acc: 0.500 Test Loss: 9.322 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.001309156417847
Epoch: 9, Steps: 70 | Train Loss: 4.608 Vali Loss: 8.344 Vali Acc: 0.500 Test Loss: 8.344 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.5178279876709
Epoch: 10, Steps: 70 | Train Loss: 7.103 Vali Loss: 4.367 Vali Acc: 0.500 Test Loss: 4.367 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.981180906295776
Epoch: 11, Steps: 70 | Train Loss: 7.086 Vali Loss: 5.970 Vali Acc: 0.500 Test Loss: 5.970 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 22.309630155563354
Epoch: 12, Steps: 70 | Train Loss: 6.525 Vali Loss: 5.844 Vali Acc: 0.500 Test Loss: 5.844 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.356008052825928
Epoch: 13, Steps: 70 | Train Loss: 4.778 Vali Loss: 6.455 Vali Acc: 0.500 Test Loss: 6.455 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 21.189011812210083
Epoch: 14, Steps: 70 | Train Loss: 4.022 Vali Loss: 1.932 Vali Acc: 0.500 Test Loss: 1.932 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 14364594
model size : 59.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.448488473892212
Epoch: 1, Steps: 70 | Train Loss: 18.427 Vali Loss: 22.049 Vali Acc: 0.540 Test Loss: 22.049 Test Acc: 0.540
Validation loss decreased (inf --> -0.539780).  Saving model ...
Epoch: 2 cost time: 20.46525478363037
Epoch: 2, Steps: 70 | Train Loss: 10.097 Vali Loss: 10.842 Vali Acc: 0.500 Test Loss: 10.842 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.17542052268982
Epoch: 3, Steps: 70 | Train Loss: 3.322 Vali Loss: 4.421 Vali Acc: 0.500 Test Loss: 4.421 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.208609580993652
Epoch: 4, Steps: 70 | Train Loss: 5.978 Vali Loss: 28.935 Vali Acc: 0.500 Test Loss: 28.935 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.097135305404663
Epoch: 5, Steps: 70 | Train Loss: 6.202 Vali Loss: 11.991 Vali Acc: 0.500 Test Loss: 11.991 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.474425554275513
Epoch: 6, Steps: 70 | Train Loss: 6.940 Vali Loss: 14.213 Vali Acc: 0.500 Test Loss: 14.213 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 21.624884605407715
Epoch: 7, Steps: 70 | Train Loss: 5.205 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
Validation loss decreased (-0.539780 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 22.00662612915039
Epoch: 8, Steps: 70 | Train Loss: 3.868 Vali Loss: 4.901 Vali Acc: 0.500 Test Loss: 4.901 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.13934302330017
Epoch: 9, Steps: 70 | Train Loss: 5.714 Vali Loss: 10.362 Vali Acc: 0.500 Test Loss: 10.362 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.957736253738403
Epoch: 10, Steps: 70 | Train Loss: 9.247 Vali Loss: 15.699 Vali Acc: 0.500 Test Loss: 15.699 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.826647996902466
Epoch: 11, Steps: 70 | Train Loss: 8.556 Vali Loss: 6.573 Vali Acc: 0.500 Test Loss: 6.573 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.5890531539917
Epoch: 12, Steps: 70 | Train Loss: 7.572 Vali Loss: 12.516 Vali Acc: 0.500 Test Loss: 12.516 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.37204122543335
Epoch: 13, Steps: 70 | Train Loss: 8.187 Vali Loss: 8.172 Vali Acc: 0.500 Test Loss: 8.172 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.612846612930298
Epoch: 14, Steps: 70 | Train Loss: 17.145 Vali Loss: 14.502 Vali Acc: 0.500 Test Loss: 14.502 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.32280397415161
Epoch: 15, Steps: 70 | Train Loss: 10.815 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.51499342918396
Epoch: 16, Steps: 70 | Train Loss: 7.685 Vali Loss: 9.147 Vali Acc: 0.500 Test Loss: 9.147 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 22.037121057510376
Epoch: 17, Steps: 70 | Train Loss: 6.116 Vali Loss: 3.648 Vali Acc: 0.500 Test Loss: 3.648 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14252466
model size : 59.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.493804454803467
Epoch: 1, Steps: 70 | Train Loss: 16.273 Vali Loss: 20.785 Vali Acc: 0.500 Test Loss: 20.785 Test Acc: 0.500
Validation loss decreased (inf --> -0.499792).  Saving model ...
Epoch: 2 cost time: 21.309982299804688
Epoch: 2, Steps: 70 | Train Loss: 13.805 Vali Loss: 9.031 Vali Acc: 0.500 Test Loss: 9.031 Test Acc: 0.500
Validation loss decreased (-0.499792 --> -0.499910).  Saving model ...
Epoch: 3 cost time: 20.62178611755371
Epoch: 3, Steps: 70 | Train Loss: 7.986 Vali Loss: 20.976 Vali Acc: 0.500 Test Loss: 20.976 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.2844181060791
Epoch: 4, Steps: 70 | Train Loss: 8.386 Vali Loss: 0.754 Vali Acc: 0.430 Test Loss: 0.754 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.841934204101562
Epoch: 5, Steps: 70 | Train Loss: 7.251 Vali Loss: 6.470 Vali Acc: 0.500 Test Loss: 6.470 Test Acc: 0.500
Validation loss decreased (-0.499910 --> -0.499935).  Saving model ...
Epoch: 6 cost time: 20.019702196121216
Epoch: 6, Steps: 70 | Train Loss: 6.973 Vali Loss: 20.013 Vali Acc: 0.500 Test Loss: 20.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.649910926818848
Epoch: 7, Steps: 70 | Train Loss: 6.599 Vali Loss: 8.148 Vali Acc: 0.500 Test Loss: 8.148 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.78689980506897
Epoch: 8, Steps: 70 | Train Loss: 5.202 Vali Loss: 8.006 Vali Acc: 0.500 Test Loss: 8.006 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.009859085083008
Epoch: 9, Steps: 70 | Train Loss: 6.970 Vali Loss: 1.799 Vali Acc: 0.500 Test Loss: 1.799 Test Acc: 0.500
Validation loss decreased (-0.499935 --> -0.499982).  Saving model ...
Epoch: 10 cost time: 20.416595220565796
Epoch: 10, Steps: 70 | Train Loss: 7.016 Vali Loss: 10.397 Vali Acc: 0.500 Test Loss: 10.397 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.620057106018066
Epoch: 11, Steps: 70 | Train Loss: 7.879 Vali Loss: 21.313 Vali Acc: 0.500 Test Loss: 21.313 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.033544301986694
Epoch: 12, Steps: 70 | Train Loss: 9.782 Vali Loss: 0.692 Vali Acc: 0.490 Test Loss: 0.692 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.81841278076172
Epoch: 13, Steps: 70 | Train Loss: 9.973 Vali Loss: 5.073 Vali Acc: 0.500 Test Loss: 5.073 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.262834310531616
Epoch: 14, Steps: 70 | Train Loss: 4.597 Vali Loss: 2.942 Vali Acc: 0.500 Test Loss: 2.942 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.095736503601074
Epoch: 15, Steps: 70 | Train Loss: 7.762 Vali Loss: 5.104 Vali Acc: 0.500 Test Loss: 5.104 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.769329071044922
Epoch: 16, Steps: 70 | Train Loss: 5.752 Vali Loss: 4.619 Vali Acc: 0.500 Test Loss: 4.619 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 20.99536633491516
Epoch: 17, Steps: 70 | Train Loss: 5.215 Vali Loss: 1.455 Vali Acc: 0.500 Test Loss: 1.455 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499985).  Saving model ...
Epoch: 18 cost time: 22.04853868484497
Epoch: 18, Steps: 70 | Train Loss: 5.239 Vali Loss: 12.779 Vali Acc: 0.500 Test Loss: 12.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.70327377319336
Epoch: 19, Steps: 70 | Train Loss: 6.124 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 20.383647918701172
Epoch: 20, Steps: 70 | Train Loss: 5.969 Vali Loss: 4.111 Vali Acc: 0.500 Test Loss: 4.111 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.920768976211548
Epoch: 21, Steps: 70 | Train Loss: 3.875 Vali Loss: 8.712 Vali Acc: 0.500 Test Loss: 8.712 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.655805349349976
Epoch: 22, Steps: 70 | Train Loss: 5.238 Vali Loss: 2.350 Vali Acc: 0.500 Test Loss: 2.350 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 21.202353954315186
Epoch: 23, Steps: 70 | Train Loss: 8.999 Vali Loss: 19.215 Vali Acc: 0.500 Test Loss: 19.215 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 20.335471630096436
Epoch: 24, Steps: 70 | Train Loss: 9.685 Vali Loss: 9.275 Vali Acc: 0.500 Test Loss: 9.275 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.240299940109253
Epoch: 25, Steps: 70 | Train Loss: 5.123 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.005820274353027
Epoch: 26, Steps: 70 | Train Loss: 4.723 Vali Loss: 9.715 Vali Acc: 0.500 Test Loss: 9.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 20.510577917099
Epoch: 27, Steps: 70 | Train Loss: 3.896 Vali Loss: 11.294 Vali Acc: 0.500 Test Loss: 11.294 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.154982566833496
Epoch: 28, Steps: 70 | Train Loss: 3.227 Vali Loss: 6.272 Vali Acc: 0.500 Test Loss: 6.272 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 22.617656230926514
Epoch: 29, Steps: 70 | Train Loss: 3.368 Vali Loss: 8.204 Vali Acc: 0.500 Test Loss: 8.204 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14140338
model size : 58.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.37549352645874
Epoch: 1, Steps: 70 | Train Loss: 7.272 Vali Loss: 9.288 Vali Acc: 0.500 Test Loss: 9.288 Test Acc: 0.500
Validation loss decreased (inf --> -0.499907).  Saving model ...
Epoch: 2 cost time: 17.47423768043518
Epoch: 2, Steps: 70 | Train Loss: 5.829 Vali Loss: 5.177 Vali Acc: 0.500 Test Loss: 5.177 Test Acc: 0.500
Validation loss decreased (-0.499907 --> -0.499948).  Saving model ...
Epoch: 3 cost time: 17.596237421035767
Epoch: 3, Steps: 70 | Train Loss: 3.889 Vali Loss: 8.395 Vali Acc: 0.500 Test Loss: 8.395 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.10452389717102
Epoch: 4, Steps: 70 | Train Loss: 7.204 Vali Loss: 1.012 Vali Acc: 0.500 Test Loss: 1.012 Test Acc: 0.500
Validation loss decreased (-0.499948 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 18.66520929336548
Epoch: 5, Steps: 70 | Train Loss: 3.474 Vali Loss: 2.732 Vali Acc: 0.500 Test Loss: 2.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.97537875175476
Epoch: 6, Steps: 70 | Train Loss: 4.473 Vali Loss: 4.728 Vali Acc: 0.500 Test Loss: 4.728 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.788400650024414
Epoch: 7, Steps: 70 | Train Loss: 3.569 Vali Loss: 13.369 Vali Acc: 0.500 Test Loss: 13.369 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.639198780059814
Epoch: 8, Steps: 70 | Train Loss: 4.878 Vali Loss: 1.707 Vali Acc: 0.500 Test Loss: 1.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.45726442337036
Epoch: 9, Steps: 70 | Train Loss: 4.060 Vali Loss: 3.725 Vali Acc: 0.500 Test Loss: 3.725 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 33.63364338874817
Epoch: 10, Steps: 70 | Train Loss: 2.996 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499992).  Saving model ...
Epoch: 11 cost time: 33.00490427017212
Epoch: 11, Steps: 70 | Train Loss: 4.402 Vali Loss: 1.718 Vali Acc: 0.500 Test Loss: 1.718 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.2701997756958
Epoch: 12, Steps: 70 | Train Loss: 5.363 Vali Loss: 9.356 Vali Acc: 0.500 Test Loss: 9.356 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 32.69738841056824
Epoch: 13, Steps: 70 | Train Loss: 4.344 Vali Loss: 7.008 Vali Acc: 0.500 Test Loss: 7.008 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 35.61061882972717
Epoch: 14, Steps: 70 | Train Loss: 4.100 Vali Loss: 2.555 Vali Acc: 0.500 Test Loss: 2.555 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 32.36175608634949
Epoch: 15, Steps: 70 | Train Loss: 3.022 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 16 cost time: 34.15048909187317
Epoch: 16, Steps: 70 | Train Loss: 3.235 Vali Loss: 3.202 Vali Acc: 0.500 Test Loss: 3.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 32.89293169975281
Epoch: 17, Steps: 70 | Train Loss: 3.490 Vali Loss: 3.431 Vali Acc: 0.500 Test Loss: 3.431 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.696423053741455
Epoch: 18, Steps: 70 | Train Loss: 3.187 Vali Loss: 2.123 Vali Acc: 0.500 Test Loss: 2.123 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 18.873663187026978
Epoch: 19, Steps: 70 | Train Loss: 2.783 Vali Loss: 5.368 Vali Acc: 0.500 Test Loss: 5.368 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.361582279205322
Epoch: 20, Steps: 70 | Train Loss: 2.739 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 21 cost time: 16.96334218978882
Epoch: 21, Steps: 70 | Train Loss: 2.938 Vali Loss: 5.412 Vali Acc: 0.500 Test Loss: 5.412 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.577744007110596
Epoch: 22, Steps: 70 | Train Loss: 3.530 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 18.61741065979004
Epoch: 23, Steps: 70 | Train Loss: 2.519 Vali Loss: 2.539 Vali Acc: 0.500 Test Loss: 2.539 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.44957971572876
Epoch: 24, Steps: 70 | Train Loss: 2.212 Vali Loss: 2.083 Vali Acc: 0.500 Test Loss: 2.083 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 18.630733966827393
Epoch: 25, Steps: 70 | Train Loss: 1.886 Vali Loss: 2.389 Vali Acc: 0.500 Test Loss: 2.389 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 17.65204381942749
Epoch: 26, Steps: 70 | Train Loss: 2.959 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 17.87595009803772
Epoch: 27, Steps: 70 | Train Loss: 1.642 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 19.02238702774048
Epoch: 28, Steps: 70 | Train Loss: 1.396 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 16.98703646659851
Epoch: 29, Steps: 70 | Train Loss: 2.571 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 18.760732889175415
Epoch: 30, Steps: 70 | Train Loss: 1.337 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 7015730
model size : 29.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.85833191871643
Epoch: 1, Steps: 70 | Train Loss: 3.867 Vali Loss: 27.722 Vali Acc: 0.500 Test Loss: 27.722 Test Acc: 0.500
Validation loss decreased (inf --> -0.499723).  Saving model ...
Epoch: 2 cost time: 17.793676614761353
Epoch: 2, Steps: 70 | Train Loss: 9.711 Vali Loss: 6.589 Vali Acc: 0.510 Test Loss: 6.589 Test Acc: 0.510
Validation loss decreased (-0.499723 --> -0.509934).  Saving model ...
Epoch: 3 cost time: 18.439448595046997
Epoch: 3, Steps: 70 | Train Loss: 4.209 Vali Loss: 1.867 Vali Acc: 0.500 Test Loss: 1.867 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.276406288146973
Epoch: 4, Steps: 70 | Train Loss: 3.172 Vali Loss: 3.091 Vali Acc: 0.500 Test Loss: 3.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.59774160385132
Epoch: 5, Steps: 70 | Train Loss: 3.470 Vali Loss: 1.751 Vali Acc: 0.500 Test Loss: 1.751 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.457987308502197
Epoch: 6, Steps: 70 | Train Loss: 3.056 Vali Loss: 3.089 Vali Acc: 0.500 Test Loss: 3.089 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.5750789642334
Epoch: 7, Steps: 70 | Train Loss: 2.202 Vali Loss: 6.440 Vali Acc: 0.500 Test Loss: 6.440 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.381662130355835
Epoch: 8, Steps: 70 | Train Loss: 4.723 Vali Loss: 11.290 Vali Acc: 0.500 Test Loss: 11.290 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 18.288490295410156
Epoch: 9, Steps: 70 | Train Loss: 4.029 Vali Loss: 11.550 Vali Acc: 0.500 Test Loss: 11.550 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 18.046177864074707
Epoch: 10, Steps: 70 | Train Loss: 3.929 Vali Loss: 8.036 Vali Acc: 0.500 Test Loss: 8.036 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.60509157180786
Epoch: 11, Steps: 70 | Train Loss: 5.037 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.581799507141113
Epoch: 12, Steps: 70 | Train Loss: 4.635 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 6959666
model size : 29.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.32910132408142
Epoch: 1, Steps: 70 | Train Loss: 6.055 Vali Loss: 9.844 Vali Acc: 0.490 Test Loss: 9.844 Test Acc: 0.490
Validation loss decreased (inf --> -0.489902).  Saving model ...
Epoch: 2 cost time: 17.5501708984375
Epoch: 2, Steps: 70 | Train Loss: 5.911 Vali Loss: 5.029 Vali Acc: 0.500 Test Loss: 5.029 Test Acc: 0.500
Validation loss decreased (-0.489902 --> -0.499950).  Saving model ...
Epoch: 3 cost time: 18.35482168197632
Epoch: 3, Steps: 70 | Train Loss: 5.997 Vali Loss: 2.202 Vali Acc: 0.500 Test Loss: 2.202 Test Acc: 0.500
Validation loss decreased (-0.499950 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 16.51878786087036
Epoch: 4, Steps: 70 | Train Loss: 4.060 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
Validation loss decreased (-0.499978 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 18.402097463607788
Epoch: 5, Steps: 70 | Train Loss: 3.318 Vali Loss: 1.476 Vali Acc: 0.500 Test Loss: 1.476 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.01818037033081
Epoch: 6, Steps: 70 | Train Loss: 4.807 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.519015550613403
Epoch: 7, Steps: 70 | Train Loss: 3.026 Vali Loss: 4.469 Vali Acc: 0.500 Test Loss: 4.469 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.818027019500732
Epoch: 8, Steps: 70 | Train Loss: 5.516 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.78769087791443
Epoch: 9, Steps: 70 | Train Loss: 3.455 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 18.23639726638794
Epoch: 10, Steps: 70 | Train Loss: 2.936 Vali Loss: 2.936 Vali Acc: 0.480 Test Loss: 2.936 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 16.452946662902832
Epoch: 11, Steps: 70 | Train Loss: 3.845 Vali Loss: 3.404 Vali Acc: 0.500 Test Loss: 3.404 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.922557592391968
Epoch: 12, Steps: 70 | Train Loss: 4.211 Vali Loss: 3.436 Vali Acc: 0.500 Test Loss: 3.436 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 16.74040722846985
Epoch: 13, Steps: 70 | Train Loss: 4.588 Vali Loss: 8.023 Vali Acc: 0.500 Test Loss: 8.023 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 18.58958673477173
Epoch: 14, Steps: 70 | Train Loss: 4.625 Vali Loss: 11.636 Vali Acc: 0.500 Test Loss: 11.636 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 6903602
model size : 28.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.92058038711548
Epoch: 1, Steps: 70 | Train Loss: 6.009 Vali Loss: 8.542 Vali Acc: 0.500 Test Loss: 8.542 Test Acc: 0.500
Validation loss decreased (inf --> -0.499915).  Saving model ...
Epoch: 2 cost time: 15.992345333099365
Epoch: 2, Steps: 70 | Train Loss: 5.464 Vali Loss: 1.757 Vali Acc: 0.510 Test Loss: 1.757 Test Acc: 0.510
Validation loss decreased (-0.499915 --> -0.509982).  Saving model ...
Epoch: 3 cost time: 17.898327112197876
Epoch: 3, Steps: 70 | Train Loss: 4.443 Vali Loss: 7.502 Vali Acc: 0.500 Test Loss: 7.502 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.646161794662476
Epoch: 4, Steps: 70 | Train Loss: 3.393 Vali Loss: 1.743 Vali Acc: 0.500 Test Loss: 1.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.72129988670349
Epoch: 5, Steps: 70 | Train Loss: 3.685 Vali Loss: 2.456 Vali Acc: 0.500 Test Loss: 2.456 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.108764171600342
Epoch: 6, Steps: 70 | Train Loss: 3.138 Vali Loss: 5.148 Vali Acc: 0.500 Test Loss: 5.148 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.285525798797607
Epoch: 7, Steps: 70 | Train Loss: 3.608 Vali Loss: 9.038 Vali Acc: 0.500 Test Loss: 9.038 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.686701774597168
Epoch: 8, Steps: 70 | Train Loss: 3.368 Vali Loss: 2.477 Vali Acc: 0.500 Test Loss: 2.477 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.148741722106934
Epoch: 9, Steps: 70 | Train Loss: 3.016 Vali Loss: 3.798 Vali Acc: 0.500 Test Loss: 3.798 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 18.432079792022705
Epoch: 10, Steps: 70 | Train Loss: 3.356 Vali Loss: 7.262 Vali Acc: 0.500 Test Loss: 7.262 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.99612545967102
Epoch: 11, Steps: 70 | Train Loss: 7.186 Vali Loss: 3.059 Vali Acc: 0.500 Test Loss: 3.059 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.688424587249756
Epoch: 12, Steps: 70 | Train Loss: 3.635 Vali Loss: 7.190 Vali Acc: 0.500 Test Loss: 7.190 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 6847538
model size : 28.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.23601007461548
Epoch: 1, Steps: 70 | Train Loss: 5.814 Vali Loss: 8.647 Vali Acc: 0.490 Test Loss: 8.647 Test Acc: 0.490
Validation loss decreased (inf --> -0.489914).  Saving model ...
Epoch: 2 cost time: 17.699486255645752
Epoch: 2, Steps: 70 | Train Loss: 5.951 Vali Loss: 6.643 Vali Acc: 0.500 Test Loss: 6.643 Test Acc: 0.500
Validation loss decreased (-0.489914 --> -0.499934).  Saving model ...
Epoch: 3 cost time: 16.878581762313843
Epoch: 3, Steps: 70 | Train Loss: 4.221 Vali Loss: 1.524 Vali Acc: 0.500 Test Loss: 1.524 Test Acc: 0.500
Validation loss decreased (-0.499934 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 17.61130690574646
Epoch: 4, Steps: 70 | Train Loss: 2.625 Vali Loss: 4.798 Vali Acc: 0.500 Test Loss: 4.798 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.20317816734314
Epoch: 5, Steps: 70 | Train Loss: 4.019 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 17.37376642227173
Epoch: 6, Steps: 70 | Train Loss: 5.384 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 17.346965074539185
Epoch: 7, Steps: 70 | Train Loss: 2.830 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.617182731628418
Epoch: 8, Steps: 70 | Train Loss: 5.381 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.78863024711609
Epoch: 9, Steps: 70 | Train Loss: 3.458 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.79808473587036
Epoch: 10, Steps: 70 | Train Loss: 2.756 Vali Loss: 5.775 Vali Acc: 0.500 Test Loss: 5.775 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.788801670074463
Epoch: 11, Steps: 70 | Train Loss: 6.296 Vali Loss: 15.532 Vali Acc: 0.500 Test Loss: 15.532 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.468583822250366
Epoch: 12, Steps: 70 | Train Loss: 7.759 Vali Loss: 7.386 Vali Acc: 0.480 Test Loss: 7.386 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.092774629592896
Epoch: 13, Steps: 70 | Train Loss: 1.996 Vali Loss: 3.969 Vali Acc: 0.500 Test Loss: 3.969 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.115920305252075
Epoch: 14, Steps: 70 | Train Loss: 3.290 Vali Loss: 6.202 Vali Acc: 0.500 Test Loss: 6.202 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.355621814727783
Epoch: 15, Steps: 70 | Train Loss: 3.242 Vali Loss: 8.179 Vali Acc: 0.500 Test Loss: 8.179 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.15406084060669
Epoch: 16, Steps: 70 | Train Loss: 3.015 Vali Loss: 6.161 Vali Acc: 0.500 Test Loss: 6.161 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 6094642
model size : 25.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.033714056015015
Epoch: 1, Steps: 70 | Train Loss: 5.241 Vali Loss: 16.358 Vali Acc: 0.500 Test Loss: 16.358 Test Acc: 0.500
Validation loss decreased (inf --> -0.499836).  Saving model ...
Epoch: 2 cost time: 17.9485445022583
Epoch: 2, Steps: 70 | Train Loss: 10.199 Vali Loss: 11.518 Vali Acc: 0.500 Test Loss: 11.518 Test Acc: 0.500
Validation loss decreased (-0.499836 --> -0.499885).  Saving model ...
Epoch: 3 cost time: 15.99565839767456
Epoch: 3, Steps: 70 | Train Loss: 6.573 Vali Loss: 4.870 Vali Acc: 0.500 Test Loss: 4.870 Test Acc: 0.500
Validation loss decreased (-0.499885 --> -0.499951).  Saving model ...
Epoch: 4 cost time: 17.473079442977905
Epoch: 4, Steps: 70 | Train Loss: 4.844 Vali Loss: 12.606 Vali Acc: 0.500 Test Loss: 12.606 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.59724235534668
Epoch: 5, Steps: 70 | Train Loss: 6.856 Vali Loss: 2.562 Vali Acc: 0.500 Test Loss: 2.562 Test Acc: 0.500
Validation loss decreased (-0.499951 --> -0.499974).  Saving model ...
Epoch: 6 cost time: 18.264861822128296
Epoch: 6, Steps: 70 | Train Loss: 6.310 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.499974 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 15.974140167236328
Epoch: 7, Steps: 70 | Train Loss: 7.765 Vali Loss: 3.435 Vali Acc: 0.500 Test Loss: 3.435 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.022563457489014
Epoch: 8, Steps: 70 | Train Loss: 4.357 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 18.789777994155884
Epoch: 9, Steps: 70 | Train Loss: 5.231 Vali Loss: 5.680 Vali Acc: 0.500 Test Loss: 5.680 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.56416964530945
Epoch: 10, Steps: 70 | Train Loss: 5.860 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.933436393737793
Epoch: 11, Steps: 70 | Train Loss: 2.988 Vali Loss: 4.874 Vali Acc: 0.500 Test Loss: 4.874 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 17.98669147491455
Epoch: 12, Steps: 70 | Train Loss: 3.833 Vali Loss: 12.170 Vali Acc: 0.500 Test Loss: 12.170 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.43108820915222
Epoch: 13, Steps: 70 | Train Loss: 6.283 Vali Loss: 4.833 Vali Acc: 0.500 Test Loss: 4.833 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 18.30094575881958
Epoch: 14, Steps: 70 | Train Loss: 4.645 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.09121870994568
Epoch: 15, Steps: 70 | Train Loss: 3.747 Vali Loss: 7.316 Vali Acc: 0.500 Test Loss: 7.316 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.77293062210083
Epoch: 16, Steps: 70 | Train Loss: 5.143 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.871296405792236
Epoch: 17, Steps: 70 | Train Loss: 3.480 Vali Loss: 9.680 Vali Acc: 0.500 Test Loss: 9.680 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 18.144479751586914
Epoch: 18, Steps: 70 | Train Loss: 5.376 Vali Loss: 3.926 Vali Acc: 0.500 Test Loss: 3.926 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 6038578
model size : 25.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.060540914535522
Epoch: 1, Steps: 70 | Train Loss: 8.126 Vali Loss: 13.115 Vali Acc: 0.500 Test Loss: 13.115 Test Acc: 0.500
Validation loss decreased (inf --> -0.499869).  Saving model ...
Epoch: 2 cost time: 18.254528284072876
Epoch: 2, Steps: 70 | Train Loss: 7.382 Vali Loss: 9.078 Vali Acc: 0.500 Test Loss: 9.078 Test Acc: 0.500
Validation loss decreased (-0.499869 --> -0.499909).  Saving model ...
Epoch: 3 cost time: 16.641514539718628
Epoch: 3, Steps: 70 | Train Loss: 4.942 Vali Loss: 6.660 Vali Acc: 0.500 Test Loss: 6.660 Test Acc: 0.500
Validation loss decreased (-0.499909 --> -0.499933).  Saving model ...
Epoch: 4 cost time: 16.256786108016968
Epoch: 4, Steps: 70 | Train Loss: 4.168 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.499933 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 18.449945211410522
Epoch: 5, Steps: 70 | Train Loss: 2.812 Vali Loss: 10.830 Vali Acc: 0.500 Test Loss: 10.830 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.990412712097168
Epoch: 6, Steps: 70 | Train Loss: 4.274 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 17.564669847488403
Epoch: 7, Steps: 70 | Train Loss: 3.223 Vali Loss: 3.032 Vali Acc: 0.500 Test Loss: 3.032 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.055011749267578
Epoch: 8, Steps: 70 | Train Loss: 4.535 Vali Loss: 1.716 Vali Acc: 0.500 Test Loss: 1.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.258795261383057
Epoch: 9, Steps: 70 | Train Loss: 4.271 Vali Loss: 15.486 Vali Acc: 0.500 Test Loss: 15.486 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.013842821121216
Epoch: 10, Steps: 70 | Train Loss: 6.315 Vali Loss: 8.444 Vali Acc: 0.500 Test Loss: 8.444 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.201165914535522
Epoch: 11, Steps: 70 | Train Loss: 4.187 Vali Loss: 0.910 Vali Acc: 0.480 Test Loss: 0.910 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.189379692077637
Epoch: 12, Steps: 70 | Train Loss: 2.439 Vali Loss: 6.125 Vali Acc: 0.500 Test Loss: 6.125 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.159586668014526
Epoch: 13, Steps: 70 | Train Loss: 3.563 Vali Loss: 2.632 Vali Acc: 0.560 Test Loss: 2.632 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559974).  Saving model ...
Epoch: 14 cost time: 18.07038903236389
Epoch: 14, Steps: 70 | Train Loss: 2.464 Vali Loss: 8.389 Vali Acc: 0.500 Test Loss: 8.389 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.362088203430176
Epoch: 15, Steps: 70 | Train Loss: 4.626 Vali Loss: 2.075 Vali Acc: 0.460 Test Loss: 2.075 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.08715271949768
Epoch: 16, Steps: 70 | Train Loss: 2.457 Vali Loss: 2.524 Vali Acc: 0.500 Test Loss: 2.524 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.431341648101807
Epoch: 17, Steps: 70 | Train Loss: 3.735 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.541972398757935
Epoch: 18, Steps: 70 | Train Loss: 2.516 Vali Loss: 6.858 Vali Acc: 0.500 Test Loss: 6.858 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.960395336151123
Epoch: 19, Steps: 70 | Train Loss: 3.259 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.666671991348267
Epoch: 20, Steps: 70 | Train Loss: 2.003 Vali Loss: 1.922 Vali Acc: 0.500 Test Loss: 1.922 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.30440592765808
Epoch: 21, Steps: 70 | Train Loss: 2.556 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.945332527160645
Epoch: 22, Steps: 70 | Train Loss: 2.834 Vali Loss: 3.589 Vali Acc: 0.500 Test Loss: 3.589 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 18.383146286010742
Epoch: 23, Steps: 70 | Train Loss: 3.035 Vali Loss: 2.278 Vali Acc: 0.500 Test Loss: 2.278 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5982514
model size : 25.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.06216597557068
Epoch: 1, Steps: 70 | Train Loss: 6.154 Vali Loss: 7.425 Vali Acc: 0.480 Test Loss: 7.425 Test Acc: 0.480
Validation loss decreased (inf --> -0.479926).  Saving model ...
Epoch: 2 cost time: 17.213294982910156
Epoch: 2, Steps: 70 | Train Loss: 9.125 Vali Loss: 11.097 Vali Acc: 0.500 Test Loss: 11.097 Test Acc: 0.500
Validation loss decreased (-0.479926 --> -0.499889).  Saving model ...
Epoch: 3 cost time: 17.62058997154236
Epoch: 3, Steps: 70 | Train Loss: 3.710 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.499889 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 15.219834089279175
Epoch: 4, Steps: 70 | Train Loss: 4.699 Vali Loss: 8.664 Vali Acc: 0.500 Test Loss: 8.664 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.862518072128296
Epoch: 5, Steps: 70 | Train Loss: 5.575 Vali Loss: 6.492 Vali Acc: 0.500 Test Loss: 6.492 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.654594659805298
Epoch: 6, Steps: 70 | Train Loss: 6.070 Vali Loss: 2.193 Vali Acc: 0.500 Test Loss: 2.193 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.531463623046875
Epoch: 7, Steps: 70 | Train Loss: 2.639 Vali Loss: 6.920 Vali Acc: 0.500 Test Loss: 6.920 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.5319242477417
Epoch: 8, Steps: 70 | Train Loss: 6.992 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.11261796951294
Epoch: 9, Steps: 70 | Train Loss: 3.886 Vali Loss: 2.502 Vali Acc: 0.500 Test Loss: 2.502 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.588215351104736
Epoch: 10, Steps: 70 | Train Loss: 3.686 Vali Loss: 5.851 Vali Acc: 0.500 Test Loss: 5.851 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.875874519348145
Epoch: 11, Steps: 70 | Train Loss: 3.814 Vali Loss: 5.530 Vali Acc: 0.500 Test Loss: 5.530 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.72295117378235
Epoch: 12, Steps: 70 | Train Loss: 2.897 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499992).  Saving model ...
Epoch: 13 cost time: 15.33761739730835
Epoch: 13, Steps: 70 | Train Loss: 3.881 Vali Loss: 3.260 Vali Acc: 0.500 Test Loss: 3.260 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.216521501541138
Epoch: 14, Steps: 70 | Train Loss: 2.389 Vali Loss: 4.685 Vali Acc: 0.500 Test Loss: 4.685 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.207658529281616
Epoch: 15, Steps: 70 | Train Loss: 3.950 Vali Loss: 3.195 Vali Acc: 0.500 Test Loss: 3.195 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.298611402511597
Epoch: 16, Steps: 70 | Train Loss: 2.195 Vali Loss: 3.809 Vali Acc: 0.500 Test Loss: 3.809 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.97784161567688
Epoch: 17, Steps: 70 | Train Loss: 3.177 Vali Loss: 4.864 Vali Acc: 0.500 Test Loss: 4.864 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.728524446487427
Epoch: 18, Steps: 70 | Train Loss: 3.387 Vali Loss: 4.335 Vali Acc: 0.500 Test Loss: 4.335 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 17.044331312179565
Epoch: 19, Steps: 70 | Train Loss: 2.137 Vali Loss: 7.435 Vali Acc: 0.500 Test Loss: 7.435 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 17.493709087371826
Epoch: 20, Steps: 70 | Train Loss: 2.837 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 17.499080896377563
Epoch: 21, Steps: 70 | Train Loss: 3.168 Vali Loss: 5.491 Vali Acc: 0.500 Test Loss: 5.491 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.41037917137146
Epoch: 22, Steps: 70 | Train Loss: 2.053 Vali Loss: 3.067 Vali Acc: 0.500 Test Loss: 3.067 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 5926450
model size : 25.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.588886737823486
Epoch: 1, Steps: 70 | Train Loss: 6.993 Vali Loss: 13.018 Vali Acc: 0.530 Test Loss: 13.018 Test Acc: 0.530
Validation loss decreased (inf --> -0.529870).  Saving model ...
Epoch: 2 cost time: 17.543384075164795
Epoch: 2, Steps: 70 | Train Loss: 7.962 Vali Loss: 17.179 Vali Acc: 0.500 Test Loss: 17.179 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.52953577041626
Epoch: 3, Steps: 70 | Train Loss: 10.171 Vali Loss: 3.361 Vali Acc: 0.500 Test Loss: 3.361 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.397912979125977
Epoch: 4, Steps: 70 | Train Loss: 4.721 Vali Loss: 16.527 Vali Acc: 0.500 Test Loss: 16.527 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.11563014984131
Epoch: 5, Steps: 70 | Train Loss: 5.598 Vali Loss: 10.303 Vali Acc: 0.500 Test Loss: 10.303 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.03299379348755
Epoch: 6, Steps: 70 | Train Loss: 4.924 Vali Loss: 7.956 Vali Acc: 0.500 Test Loss: 7.956 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.563457012176514
Epoch: 7, Steps: 70 | Train Loss: 6.469 Vali Loss: 12.610 Vali Acc: 0.500 Test Loss: 12.610 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.163177967071533
Epoch: 8, Steps: 70 | Train Loss: 5.474 Vali Loss: 13.506 Vali Acc: 0.500 Test Loss: 13.506 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.698792219161987
Epoch: 9, Steps: 70 | Train Loss: 4.390 Vali Loss: 3.856 Vali Acc: 0.500 Test Loss: 3.856 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.225533485412598
Epoch: 10, Steps: 70 | Train Loss: 4.013 Vali Loss: 1.753 Vali Acc: 0.500 Test Loss: 1.753 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.43562364578247
Epoch: 11, Steps: 70 | Train Loss: 3.422 Vali Loss: 11.316 Vali Acc: 0.500 Test Loss: 11.316 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 5634098
model size : 24.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.11356806755066
Epoch: 1, Steps: 70 | Train Loss: 8.766 Vali Loss: 1.337 Vali Acc: 0.490 Test Loss: 1.337 Test Acc: 0.490
Validation loss decreased (inf --> -0.489987).  Saving model ...
Epoch: 2 cost time: 17.03409719467163
Epoch: 2, Steps: 70 | Train Loss: 8.855 Vali Loss: 21.294 Vali Acc: 0.500 Test Loss: 21.294 Test Acc: 0.500
Validation loss decreased (-0.489987 --> -0.499787).  Saving model ...
Epoch: 3 cost time: 16.44949984550476
Epoch: 3, Steps: 70 | Train Loss: 4.387 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
Validation loss decreased (-0.499787 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 15.867554903030396
Epoch: 4, Steps: 70 | Train Loss: 5.623 Vali Loss: 4.299 Vali Acc: 0.500 Test Loss: 4.299 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.041281700134277
Epoch: 5, Steps: 70 | Train Loss: 3.976 Vali Loss: 2.675 Vali Acc: 0.500 Test Loss: 2.675 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.5540554523468
Epoch: 6, Steps: 70 | Train Loss: 3.805 Vali Loss: 7.243 Vali Acc: 0.500 Test Loss: 7.243 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.379673719406128
Epoch: 7, Steps: 70 | Train Loss: 3.092 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 17.39202904701233
Epoch: 8, Steps: 70 | Train Loss: 4.632 Vali Loss: 15.104 Vali Acc: 0.500 Test Loss: 15.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.149258613586426
Epoch: 9, Steps: 70 | Train Loss: 3.053 Vali Loss: 8.135 Vali Acc: 0.500 Test Loss: 8.135 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.211737394332886
Epoch: 10, Steps: 70 | Train Loss: 7.985 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.3316068649292
Epoch: 11, Steps: 70 | Train Loss: 2.439 Vali Loss: 5.410 Vali Acc: 0.500 Test Loss: 5.410 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.463768005371094
Epoch: 12, Steps: 70 | Train Loss: 5.076 Vali Loss: 7.661 Vali Acc: 0.500 Test Loss: 7.661 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.59672212600708
Epoch: 13, Steps: 70 | Train Loss: 2.833 Vali Loss: 3.300 Vali Acc: 0.500 Test Loss: 3.300 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.121577739715576
Epoch: 14, Steps: 70 | Train Loss: 3.594 Vali Loss: 1.775 Vali Acc: 0.490 Test Loss: 1.775 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.76480746269226
Epoch: 15, Steps: 70 | Train Loss: 2.255 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.23742699623108
Epoch: 16, Steps: 70 | Train Loss: 3.484 Vali Loss: 5.324 Vali Acc: 0.500 Test Loss: 5.324 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.056643962860107
Epoch: 17, Steps: 70 | Train Loss: 2.691 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5578034
model size : 23.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.529914617538452
Epoch: 1, Steps: 70 | Train Loss: 6.661 Vali Loss: 17.346 Vali Acc: 0.500 Test Loss: 17.346 Test Acc: 0.500
Validation loss decreased (inf --> -0.499827).  Saving model ...
Epoch: 2 cost time: 16.565418481826782
Epoch: 2, Steps: 70 | Train Loss: 7.374 Vali Loss: 2.531 Vali Acc: 0.500 Test Loss: 2.531 Test Acc: 0.500
Validation loss decreased (-0.499827 --> -0.499975).  Saving model ...
Epoch: 3 cost time: 14.945421934127808
Epoch: 3, Steps: 70 | Train Loss: 2.664 Vali Loss: 3.824 Vali Acc: 0.500 Test Loss: 3.824 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.809648752212524
Epoch: 4, Steps: 70 | Train Loss: 2.539 Vali Loss: 14.306 Vali Acc: 0.500 Test Loss: 14.306 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.105494022369385
Epoch: 5, Steps: 70 | Train Loss: 7.394 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
Validation loss decreased (-0.499975 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 15.909623146057129
Epoch: 6, Steps: 70 | Train Loss: 7.576 Vali Loss: 3.064 Vali Acc: 0.500 Test Loss: 3.064 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.47978377342224
Epoch: 7, Steps: 70 | Train Loss: 4.464 Vali Loss: 2.079 Vali Acc: 0.500 Test Loss: 2.079 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.149280548095703
Epoch: 8, Steps: 70 | Train Loss: 5.673 Vali Loss: 3.750 Vali Acc: 0.500 Test Loss: 3.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.535987854003906
Epoch: 9, Steps: 70 | Train Loss: 5.004 Vali Loss: 2.127 Vali Acc: 0.500 Test Loss: 2.127 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.063321113586426
Epoch: 10, Steps: 70 | Train Loss: 3.808 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
Validation loss decreased (-0.499986 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 17.420346975326538
Epoch: 11, Steps: 70 | Train Loss: 2.982 Vali Loss: 4.317 Vali Acc: 0.500 Test Loss: 4.317 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.32058620452881
Epoch: 12, Steps: 70 | Train Loss: 3.185 Vali Loss: 4.234 Vali Acc: 0.500 Test Loss: 4.234 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.613580465316772
Epoch: 13, Steps: 70 | Train Loss: 2.862 Vali Loss: 4.436 Vali Acc: 0.500 Test Loss: 4.436 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.91962456703186
Epoch: 14, Steps: 70 | Train Loss: 3.172 Vali Loss: 5.604 Vali Acc: 0.500 Test Loss: 5.604 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 17.601950645446777
Epoch: 15, Steps: 70 | Train Loss: 3.325 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.644568920135498
Epoch: 16, Steps: 70 | Train Loss: 2.857 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.341967821121216
Epoch: 17, Steps: 70 | Train Loss: 2.846 Vali Loss: 8.258 Vali Acc: 0.500 Test Loss: 8.258 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.431563138961792
Epoch: 18, Steps: 70 | Train Loss: 3.756 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.55329656600952
Epoch: 19, Steps: 70 | Train Loss: 2.484 Vali Loss: 1.383 Vali Acc: 0.520 Test Loss: 1.383 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.118740797042847
Epoch: 20, Steps: 70 | Train Loss: 2.076 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5521970
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.48144555091858
Epoch: 1, Steps: 70 | Train Loss: 8.481 Vali Loss: 15.908 Vali Acc: 0.500 Test Loss: 15.908 Test Acc: 0.500
Validation loss decreased (inf --> -0.499841).  Saving model ...
Epoch: 2 cost time: 15.250922679901123
Epoch: 2, Steps: 70 | Train Loss: 6.903 Vali Loss: 4.521 Vali Acc: 0.500 Test Loss: 4.521 Test Acc: 0.500
Validation loss decreased (-0.499841 --> -0.499955).  Saving model ...
Epoch: 3 cost time: 15.861064195632935
Epoch: 3, Steps: 70 | Train Loss: 3.366 Vali Loss: 2.732 Vali Acc: 0.500 Test Loss: 2.732 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499973).  Saving model ...
Epoch: 4 cost time: 16.898979425430298
Epoch: 4, Steps: 70 | Train Loss: 4.253 Vali Loss: 2.054 Vali Acc: 0.500 Test Loss: 2.054 Test Acc: 0.500
Validation loss decreased (-0.499973 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 17.11337900161743
Epoch: 5, Steps: 70 | Train Loss: 3.481 Vali Loss: 7.734 Vali Acc: 0.500 Test Loss: 7.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.626540899276733
Epoch: 6, Steps: 70 | Train Loss: 4.085 Vali Loss: 4.841 Vali Acc: 0.500 Test Loss: 4.841 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.0053231716156
Epoch: 7, Steps: 70 | Train Loss: 3.513 Vali Loss: 3.343 Vali Acc: 0.510 Test Loss: 3.343 Test Acc: 0.510
Validation loss decreased (-0.499979 --> -0.509967).  Saving model ...
Epoch: 8 cost time: 17.19947862625122
Epoch: 8, Steps: 70 | Train Loss: 4.298 Vali Loss: 6.300 Vali Acc: 0.500 Test Loss: 6.300 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.228294849395752
Epoch: 9, Steps: 70 | Train Loss: 4.586 Vali Loss: 12.610 Vali Acc: 0.500 Test Loss: 12.610 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.156716108322144
Epoch: 10, Steps: 70 | Train Loss: 4.007 Vali Loss: 3.349 Vali Acc: 0.500 Test Loss: 3.349 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.016372442245483
Epoch: 11, Steps: 70 | Train Loss: 3.116 Vali Loss: 26.746 Vali Acc: 0.500 Test Loss: 26.746 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.659411430358887
Epoch: 12, Steps: 70 | Train Loss: 4.048 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.845569372177124
Epoch: 13, Steps: 70 | Train Loss: 2.975 Vali Loss: 5.847 Vali Acc: 0.500 Test Loss: 5.847 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.042124032974243
Epoch: 14, Steps: 70 | Train Loss: 2.731 Vali Loss: 1.477 Vali Acc: 0.600 Test Loss: 1.477 Test Acc: 0.600
Validation loss decreased (-0.509967 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 17.39982581138611
Epoch: 15, Steps: 70 | Train Loss: 3.630 Vali Loss: 4.042 Vali Acc: 0.500 Test Loss: 4.042 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.850683689117432
Epoch: 16, Steps: 70 | Train Loss: 3.439 Vali Loss: 3.773 Vali Acc: 0.500 Test Loss: 3.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.20858907699585
Epoch: 17, Steps: 70 | Train Loss: 2.267 Vali Loss: 5.144 Vali Acc: 0.500 Test Loss: 5.144 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.00384831428528
Epoch: 18, Steps: 70 | Train Loss: 2.680 Vali Loss: 2.070 Vali Acc: 0.500 Test Loss: 2.070 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.882792472839355
Epoch: 19, Steps: 70 | Train Loss: 3.113 Vali Loss: 0.973 Vali Acc: 0.500 Test Loss: 0.973 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.58300518989563
Epoch: 20, Steps: 70 | Train Loss: 1.928 Vali Loss: 5.092 Vali Acc: 0.500 Test Loss: 5.092 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.12175703048706
Epoch: 21, Steps: 70 | Train Loss: 1.837 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 16.947201251983643
Epoch: 22, Steps: 70 | Train Loss: 3.309 Vali Loss: 2.389 Vali Acc: 0.500 Test Loss: 2.389 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.810237884521484
Epoch: 23, Steps: 70 | Train Loss: 2.648 Vali Loss: 5.733 Vali Acc: 0.500 Test Loss: 5.733 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 16.96291708946228
Epoch: 24, Steps: 70 | Train Loss: 1.854 Vali Loss: 3.074 Vali Acc: 0.500 Test Loss: 3.074 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5465906
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.906047344207764
Epoch: 1, Steps: 70 | Train Loss: 9.146 Vali Loss: 6.657 Vali Acc: 0.500 Test Loss: 6.657 Test Acc: 0.500
Validation loss decreased (inf --> -0.499933).  Saving model ...
Epoch: 2 cost time: 16.78969979286194
Epoch: 2, Steps: 70 | Train Loss: 8.428 Vali Loss: 2.309 Vali Acc: 0.500 Test Loss: 2.309 Test Acc: 0.500
Validation loss decreased (-0.499933 --> -0.499977).  Saving model ...
Epoch: 3 cost time: 16.97567653656006
Epoch: 3, Steps: 70 | Train Loss: 3.632 Vali Loss: 7.089 Vali Acc: 0.500 Test Loss: 7.089 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.496886014938354
Epoch: 4, Steps: 70 | Train Loss: 4.054 Vali Loss: 3.081 Vali Acc: 0.500 Test Loss: 3.081 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.976228475570679
Epoch: 5, Steps: 70 | Train Loss: 5.404 Vali Loss: 9.325 Vali Acc: 0.500 Test Loss: 9.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.000298500061035
Epoch: 6, Steps: 70 | Train Loss: 4.226 Vali Loss: 2.355 Vali Acc: 0.500 Test Loss: 2.355 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.892722368240356
Epoch: 7, Steps: 70 | Train Loss: 4.969 Vali Loss: 6.623 Vali Acc: 0.500 Test Loss: 6.623 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.604229211807251
Epoch: 8, Steps: 70 | Train Loss: 3.180 Vali Loss: 4.863 Vali Acc: 0.500 Test Loss: 4.863 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.200698375701904
Epoch: 9, Steps: 70 | Train Loss: 3.607 Vali Loss: 1.805 Vali Acc: 0.500 Test Loss: 1.805 Test Acc: 0.500
Validation loss decreased (-0.499977 --> -0.499982).  Saving model ...
Epoch: 10 cost time: 17.439688444137573
Epoch: 10, Steps: 70 | Train Loss: 3.097 Vali Loss: 0.971 Vali Acc: 0.500 Test Loss: 0.971 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499990).  Saving model ...
Epoch: 11 cost time: 14.800314903259277
Epoch: 11, Steps: 70 | Train Loss: 3.349 Vali Loss: 1.639 Vali Acc: 0.500 Test Loss: 1.639 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.993419885635376
Epoch: 12, Steps: 70 | Train Loss: 3.021 Vali Loss: 4.156 Vali Acc: 0.500 Test Loss: 4.156 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.2019784450531
Epoch: 13, Steps: 70 | Train Loss: 2.368 Vali Loss: 7.224 Vali Acc: 0.520 Test Loss: 7.224 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519928).  Saving model ...
Epoch: 14 cost time: 15.302513122558594
Epoch: 14, Steps: 70 | Train Loss: 3.545 Vali Loss: 3.893 Vali Acc: 0.500 Test Loss: 3.893 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.67850089073181
Epoch: 15, Steps: 70 | Train Loss: 3.569 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
Validation loss decreased (-0.519928 --> -0.549991).  Saving model ...
Epoch: 16 cost time: 17.313056230545044
Epoch: 16, Steps: 70 | Train Loss: 2.208 Vali Loss: 3.762 Vali Acc: 0.500 Test Loss: 3.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.103655099868774
Epoch: 17, Steps: 70 | Train Loss: 4.291 Vali Loss: 0.683 Vali Acc: 0.580 Test Loss: 0.683 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579993).  Saving model ...
Epoch: 18 cost time: 16.028074502944946
Epoch: 18, Steps: 70 | Train Loss: 2.332 Vali Loss: 1.445 Vali Acc: 0.560 Test Loss: 1.445 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.25058674812317
Epoch: 19, Steps: 70 | Train Loss: 2.365 Vali Loss: 8.367 Vali Acc: 0.500 Test Loss: 8.367 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 16.77273941040039
Epoch: 20, Steps: 70 | Train Loss: 2.330 Vali Loss: 2.084 Vali Acc: 0.500 Test Loss: 2.084 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 14.935689926147461
Epoch: 21, Steps: 70 | Train Loss: 2.869 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 17.078948497772217
Epoch: 22, Steps: 70 | Train Loss: 1.907 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 17.060068368911743
Epoch: 23, Steps: 70 | Train Loss: 1.697 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 14.851629972457886
Epoch: 24, Steps: 70 | Train Loss: 2.202 Vali Loss: 9.562 Vali Acc: 0.500 Test Loss: 9.562 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.1667218208313
Epoch: 25, Steps: 70 | Train Loss: 12.354 Vali Loss: 8.379 Vali Acc: 0.500 Test Loss: 8.379 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 17.151974201202393
Epoch: 26, Steps: 70 | Train Loss: 6.731 Vali Loss: 5.402 Vali Acc: 0.500 Test Loss: 5.402 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 15.891704320907593
Epoch: 27, Steps: 70 | Train Loss: 5.271 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5403826
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.3669171333313
Epoch: 1, Steps: 70 | Train Loss: 7.629 Vali Loss: 1.189 Vali Acc: 0.590 Test Loss: 1.189 Test Acc: 0.590
Validation loss decreased (inf --> -0.589988).  Saving model ...
Epoch: 2 cost time: 15.487252235412598
Epoch: 2, Steps: 70 | Train Loss: 4.396 Vali Loss: 3.987 Vali Acc: 0.490 Test Loss: 3.987 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.482142448425293
Epoch: 3, Steps: 70 | Train Loss: 2.750 Vali Loss: 3.020 Vali Acc: 0.500 Test Loss: 3.020 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.651245594024658
Epoch: 4, Steps: 70 | Train Loss: 4.976 Vali Loss: 5.292 Vali Acc: 0.500 Test Loss: 5.292 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.70629096031189
Epoch: 5, Steps: 70 | Train Loss: 3.350 Vali Loss: 6.010 Vali Acc: 0.500 Test Loss: 6.010 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.545647382736206
Epoch: 6, Steps: 70 | Train Loss: 2.806 Vali Loss: 7.145 Vali Acc: 0.500 Test Loss: 7.145 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.76272487640381
Epoch: 7, Steps: 70 | Train Loss: 3.694 Vali Loss: 5.117 Vali Acc: 0.500 Test Loss: 5.117 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.55462908744812
Epoch: 8, Steps: 70 | Train Loss: 4.266 Vali Loss: 2.143 Vali Acc: 0.500 Test Loss: 2.143 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.617708444595337
Epoch: 9, Steps: 70 | Train Loss: 3.850 Vali Loss: 0.915 Vali Acc: 0.510 Test Loss: 0.915 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.633310079574585
Epoch: 10, Steps: 70 | Train Loss: 3.067 Vali Loss: 3.166 Vali Acc: 0.500 Test Loss: 3.166 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.20450735092163
Epoch: 11, Steps: 70 | Train Loss: 3.085 Vali Loss: 3.409 Vali Acc: 0.500 Test Loss: 3.409 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5347762
model size : 22.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.863998413085938
Epoch: 1, Steps: 70 | Train Loss: 10.445 Vali Loss: 25.220 Vali Acc: 0.500 Test Loss: 25.220 Test Acc: 0.500
Validation loss decreased (inf --> -0.499748).  Saving model ...
Epoch: 2 cost time: 14.28333830833435
Epoch: 2, Steps: 70 | Train Loss: 12.101 Vali Loss: 10.227 Vali Acc: 0.500 Test Loss: 10.227 Test Acc: 0.500
Validation loss decreased (-0.499748 --> -0.499898).  Saving model ...
Epoch: 3 cost time: 16.308254957199097
Epoch: 3, Steps: 70 | Train Loss: 5.320 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.499898 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 15.907471418380737
Epoch: 4, Steps: 70 | Train Loss: 3.311 Vali Loss: 1.692 Vali Acc: 0.500 Test Loss: 1.692 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.56551456451416
Epoch: 5, Steps: 70 | Train Loss: 3.013 Vali Loss: 3.030 Vali Acc: 0.500 Test Loss: 3.030 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.122743844985962
Epoch: 6, Steps: 70 | Train Loss: 3.831 Vali Loss: 4.401 Vali Acc: 0.500 Test Loss: 4.401 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.13127064704895
Epoch: 7, Steps: 70 | Train Loss: 3.080 Vali Loss: 2.800 Vali Acc: 0.500 Test Loss: 2.800 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.26293444633484
Epoch: 8, Steps: 70 | Train Loss: 3.258 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 16.612781524658203
Epoch: 9, Steps: 70 | Train Loss: 3.387 Vali Loss: 6.104 Vali Acc: 0.500 Test Loss: 6.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.272414684295654
Epoch: 10, Steps: 70 | Train Loss: 4.803 Vali Loss: 3.025 Vali Acc: 0.500 Test Loss: 3.025 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.5651752948761
Epoch: 11, Steps: 70 | Train Loss: 3.210 Vali Loss: 10.374 Vali Acc: 0.500 Test Loss: 10.374 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.623948574066162
Epoch: 12, Steps: 70 | Train Loss: 3.409 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.494563579559326
Epoch: 13, Steps: 70 | Train Loss: 3.841 Vali Loss: 1.416 Vali Acc: 0.560 Test Loss: 1.416 Test Acc: 0.560
Validation loss decreased (-0.499988 --> -0.559986).  Saving model ...
Epoch: 14 cost time: 16.595649480819702
Epoch: 14, Steps: 70 | Train Loss: 2.761 Vali Loss: 1.976 Vali Acc: 0.500 Test Loss: 1.976 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.975029706954956
Epoch: 15, Steps: 70 | Train Loss: 3.681 Vali Loss: 1.776 Vali Acc: 0.500 Test Loss: 1.776 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.002611637115479
Epoch: 16, Steps: 70 | Train Loss: 2.382 Vali Loss: 6.112 Vali Acc: 0.500 Test Loss: 6.112 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 16.634408712387085
Epoch: 17, Steps: 70 | Train Loss: 3.312 Vali Loss: 2.872 Vali Acc: 0.500 Test Loss: 2.872 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.662343978881836
Epoch: 18, Steps: 70 | Train Loss: 12.494 Vali Loss: 14.301 Vali Acc: 0.500 Test Loss: 14.301 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.377147912979126
Epoch: 19, Steps: 70 | Train Loss: 5.961 Vali Loss: 3.486 Vali Acc: 0.500 Test Loss: 3.486 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.50835680961609
Epoch: 20, Steps: 70 | Train Loss: 5.082 Vali Loss: 10.594 Vali Acc: 0.500 Test Loss: 10.594 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.925521850585938
Epoch: 21, Steps: 70 | Train Loss: 4.105 Vali Loss: 3.978 Vali Acc: 0.500 Test Loss: 3.978 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.351961374282837
Epoch: 22, Steps: 70 | Train Loss: 3.738 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.410619974136353
Epoch: 23, Steps: 70 | Train Loss: 1.835 Vali Loss: 3.512 Vali Acc: 0.500 Test Loss: 3.512 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5291698
model size : 22.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.043336868286133
Epoch: 1, Steps: 70 | Train Loss: 9.188 Vali Loss: 4.935 Vali Acc: 0.500 Test Loss: 4.935 Test Acc: 0.500
Validation loss decreased (inf --> -0.499951).  Saving model ...
Epoch: 2 cost time: 14.98828911781311
Epoch: 2, Steps: 70 | Train Loss: 9.107 Vali Loss: 1.188 Vali Acc: 0.480 Test Loss: 1.188 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.898591756820679
Epoch: 3, Steps: 70 | Train Loss: 2.797 Vali Loss: 2.897 Vali Acc: 0.500 Test Loss: 2.897 Test Acc: 0.500
Validation loss decreased (-0.499951 --> -0.499971).  Saving model ...
Epoch: 4 cost time: 15.656336784362793
Epoch: 4, Steps: 70 | Train Loss: 1.918 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
Validation loss decreased (-0.499971 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 14.975008010864258
Epoch: 5, Steps: 70 | Train Loss: 3.308 Vali Loss: 13.834 Vali Acc: 0.500 Test Loss: 13.834 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.845213890075684
Epoch: 6, Steps: 70 | Train Loss: 3.842 Vali Loss: 2.055 Vali Acc: 0.500 Test Loss: 2.055 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.05676531791687
Epoch: 7, Steps: 70 | Train Loss: 3.102 Vali Loss: 5.406 Vali Acc: 0.500 Test Loss: 5.406 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.541254997253418
Epoch: 8, Steps: 70 | Train Loss: 3.851 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 14.88260531425476
Epoch: 9, Steps: 70 | Train Loss: 4.450 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 15.762355089187622
Epoch: 10, Steps: 70 | Train Loss: 2.980 Vali Loss: 6.613 Vali Acc: 0.500 Test Loss: 6.613 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.917740106582642
Epoch: 11, Steps: 70 | Train Loss: 4.468 Vali Loss: 2.401 Vali Acc: 0.500 Test Loss: 2.401 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.963149547576904
Epoch: 12, Steps: 70 | Train Loss: 2.574 Vali Loss: 4.897 Vali Acc: 0.500 Test Loss: 4.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.786479949951172
Epoch: 13, Steps: 70 | Train Loss: 2.852 Vali Loss: 3.458 Vali Acc: 0.500 Test Loss: 3.458 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.78571367263794
Epoch: 14, Steps: 70 | Train Loss: 3.392 Vali Loss: 1.146 Vali Acc: 0.540 Test Loss: 1.146 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.974402904510498
Epoch: 15, Steps: 70 | Train Loss: 2.951 Vali Loss: 6.126 Vali Acc: 0.500 Test Loss: 6.126 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.90720009803772
Epoch: 16, Steps: 70 | Train Loss: 2.536 Vali Loss: 1.231 Vali Acc: 0.550 Test Loss: 1.231 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 14.866753101348877
Epoch: 17, Steps: 70 | Train Loss: 2.056 Vali Loss: 1.892 Vali Acc: 0.500 Test Loss: 1.892 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.430511713027954
Epoch: 18, Steps: 70 | Train Loss: 1.980 Vali Loss: 1.929 Vali Acc: 0.530 Test Loss: 1.929 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.949598789215088
Epoch: 19, Steps: 70 | Train Loss: 2.007 Vali Loss: 4.818 Vali Acc: 0.500 Test Loss: 4.818 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.233464479446411
Epoch: 20, Steps: 70 | Train Loss: 7.373 Vali Loss: 27.474 Vali Acc: 0.500 Test Loss: 27.474 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.41532850265503
Epoch: 21, Steps: 70 | Train Loss: 16.964 Vali Loss: 17.604 Vali Acc: 0.500 Test Loss: 17.604 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 15.865336418151855
Epoch: 22, Steps: 70 | Train Loss: 10.384 Vali Loss: 2.120 Vali Acc: 0.510 Test Loss: 2.120 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.952787399291992
Epoch: 23, Steps: 70 | Train Loss: 7.055 Vali Loss: 6.922 Vali Acc: 0.500 Test Loss: 6.922 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 16.131855249404907
Epoch: 24, Steps: 70 | Train Loss: 6.037 Vali Loss: 11.237 Vali Acc: 0.500 Test Loss: 11.237 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 16.14026951789856
Epoch: 25, Steps: 70 | Train Loss: 4.980 Vali Loss: 5.188 Vali Acc: 0.500 Test Loss: 5.188 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.958387613296509
Epoch: 26, Steps: 70 | Train Loss: 6.541 Vali Loss: 10.361 Vali Acc: 0.500 Test Loss: 10.361 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 5235634
model size : 22.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.29118037223816
Epoch: 1, Steps: 70 | Train Loss: 4.150 Vali Loss: 6.948 Vali Acc: 0.460 Test Loss: 6.948 Test Acc: 0.460
Validation loss decreased (inf --> -0.459931).  Saving model ...
Epoch: 2 cost time: 15.337543487548828
Epoch: 2, Steps: 70 | Train Loss: 5.820 Vali Loss: 10.869 Vali Acc: 0.500 Test Loss: 10.869 Test Acc: 0.500
Validation loss decreased (-0.459931 --> -0.499891).  Saving model ...
Epoch: 3 cost time: 15.374579429626465
Epoch: 3, Steps: 70 | Train Loss: 5.172 Vali Loss: 7.270 Vali Acc: 0.500 Test Loss: 7.270 Test Acc: 0.500
Validation loss decreased (-0.499891 --> -0.499927).  Saving model ...
Epoch: 4 cost time: 12.970897674560547
Epoch: 4, Steps: 70 | Train Loss: 4.132 Vali Loss: 4.149 Vali Acc: 0.500 Test Loss: 4.149 Test Acc: 0.500
Validation loss decreased (-0.499927 --> -0.499959).  Saving model ...
Epoch: 5 cost time: 15.218465328216553
Epoch: 5, Steps: 70 | Train Loss: 2.259 Vali Loss: 5.193 Vali Acc: 0.500 Test Loss: 5.193 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.254164218902588
Epoch: 6, Steps: 70 | Train Loss: 3.063 Vali Loss: 1.519 Vali Acc: 0.510 Test Loss: 1.519 Test Acc: 0.510
Validation loss decreased (-0.499959 --> -0.509985).  Saving model ...
Epoch: 7 cost time: 13.687494039535522
Epoch: 7, Steps: 70 | Train Loss: 2.929 Vali Loss: 8.924 Vali Acc: 0.500 Test Loss: 8.924 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.099197387695312
Epoch: 8, Steps: 70 | Train Loss: 3.741 Vali Loss: 5.622 Vali Acc: 0.500 Test Loss: 5.622 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.510539531707764
Epoch: 9, Steps: 70 | Train Loss: 2.952 Vali Loss: 5.793 Vali Acc: 0.500 Test Loss: 5.793 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.230096817016602
Epoch: 10, Steps: 70 | Train Loss: 5.292 Vali Loss: 3.766 Vali Acc: 0.500 Test Loss: 3.766 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.25450325012207
Epoch: 11, Steps: 70 | Train Loss: 2.777 Vali Loss: 8.827 Vali Acc: 0.500 Test Loss: 8.827 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.1283438205719
Epoch: 12, Steps: 70 | Train Loss: 2.634 Vali Loss: 4.269 Vali Acc: 0.500 Test Loss: 4.269 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.727756977081299
Epoch: 13, Steps: 70 | Train Loss: 2.529 Vali Loss: 6.700 Vali Acc: 0.500 Test Loss: 6.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.658998489379883
Epoch: 14, Steps: 70 | Train Loss: 3.302 Vali Loss: 4.112 Vali Acc: 0.500 Test Loss: 4.112 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.495452404022217
Epoch: 15, Steps: 70 | Train Loss: 2.047 Vali Loss: 1.655 Vali Acc: 0.560 Test Loss: 1.655 Test Acc: 0.560
Validation loss decreased (-0.509985 --> -0.559983).  Saving model ...
Epoch: 16 cost time: 12.969305038452148
Epoch: 16, Steps: 70 | Train Loss: 2.448 Vali Loss: 2.028 Vali Acc: 0.480 Test Loss: 2.028 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.895622253417969
Epoch: 17, Steps: 70 | Train Loss: 2.984 Vali Loss: 3.230 Vali Acc: 0.500 Test Loss: 3.230 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.796977758407593
Epoch: 18, Steps: 70 | Train Loss: 2.533 Vali Loss: 3.657 Vali Acc: 0.500 Test Loss: 3.657 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.742449045181274
Epoch: 19, Steps: 70 | Train Loss: 1.912 Vali Loss: 5.189 Vali Acc: 0.540 Test Loss: 5.189 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.10203742980957
Epoch: 20, Steps: 70 | Train Loss: 1.591 Vali Loss: 2.357 Vali Acc: 0.580 Test Loss: 2.357 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579976).  Saving model ...
Epoch: 21 cost time: 14.427527666091919
Epoch: 21, Steps: 70 | Train Loss: 2.014 Vali Loss: 3.535 Vali Acc: 0.500 Test Loss: 3.535 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.457228899002075
Epoch: 22, Steps: 70 | Train Loss: 2.039 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 14.811527013778687
Epoch: 23, Steps: 70 | Train Loss: 2.164 Vali Loss: 2.916 Vali Acc: 0.500 Test Loss: 2.916 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.849525690078735
Epoch: 24, Steps: 70 | Train Loss: 2.003 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.241943836212158
Epoch: 25, Steps: 70 | Train Loss: 1.744 Vali Loss: 2.007 Vali Acc: 0.500 Test Loss: 2.007 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.389195919036865
Epoch: 26, Steps: 70 | Train Loss: 1.534 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 13.90684723854065
Epoch: 27, Steps: 70 | Train Loss: 1.475 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.812634944915771
Epoch: 28, Steps: 70 | Train Loss: 1.475 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 13.358229398727417
Epoch: 29, Steps: 70 | Train Loss: 1.542 Vali Loss: 2.897 Vali Acc: 0.500 Test Loss: 2.897 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.722188949584961
Epoch: 30, Steps: 70 | Train Loss: 1.368 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3052722
model size : 13.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.105870008468628
Epoch: 1, Steps: 70 | Train Loss: 3.630 Vali Loss: 8.698 Vali Acc: 0.500 Test Loss: 8.698 Test Acc: 0.500
Validation loss decreased (inf --> -0.499913).  Saving model ...
Epoch: 2 cost time: 14.662034511566162
Epoch: 2, Steps: 70 | Train Loss: 3.870 Vali Loss: 4.828 Vali Acc: 0.500 Test Loss: 4.828 Test Acc: 0.500
Validation loss decreased (-0.499913 --> -0.499952).  Saving model ...
Epoch: 3 cost time: 13.900115489959717
Epoch: 3, Steps: 70 | Train Loss: 3.692 Vali Loss: 4.226 Vali Acc: 0.500 Test Loss: 4.226 Test Acc: 0.500
Validation loss decreased (-0.499952 --> -0.499958).  Saving model ...
Epoch: 4 cost time: 14.151984214782715
Epoch: 4, Steps: 70 | Train Loss: 3.045 Vali Loss: 4.666 Vali Acc: 0.500 Test Loss: 4.666 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.445402145385742
Epoch: 5, Steps: 70 | Train Loss: 3.068 Vali Loss: 3.675 Vali Acc: 0.500 Test Loss: 3.675 Test Acc: 0.500
Validation loss decreased (-0.499958 --> -0.499963).  Saving model ...
Epoch: 6 cost time: 13.916553735733032
Epoch: 6, Steps: 70 | Train Loss: 4.742 Vali Loss: 11.831 Vali Acc: 0.500 Test Loss: 11.831 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.884483575820923
Epoch: 7, Steps: 70 | Train Loss: 3.129 Vali Loss: 6.026 Vali Acc: 0.500 Test Loss: 6.026 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.6067636013031
Epoch: 8, Steps: 70 | Train Loss: 2.558 Vali Loss: 6.186 Vali Acc: 0.500 Test Loss: 6.186 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.921010971069336
Epoch: 9, Steps: 70 | Train Loss: 3.200 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.055700540542603
Epoch: 10, Steps: 70 | Train Loss: 2.268 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
Validation loss decreased (-0.499963 --> -0.499981).  Saving model ...
Epoch: 11 cost time: 14.876097679138184
Epoch: 11, Steps: 70 | Train Loss: 2.267 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519990).  Saving model ...
Epoch: 12 cost time: 12.730778217315674
Epoch: 12, Steps: 70 | Train Loss: 2.304 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.75868844985962
Epoch: 13, Steps: 70 | Train Loss: 4.153 Vali Loss: 20.382 Vali Acc: 0.500 Test Loss: 20.382 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.122512340545654
Epoch: 14, Steps: 70 | Train Loss: 6.690 Vali Loss: 2.868 Vali Acc: 0.500 Test Loss: 2.868 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.014485359191895
Epoch: 15, Steps: 70 | Train Loss: 1.783 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.582053899765015
Epoch: 16, Steps: 70 | Train Loss: 2.891 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.81955623626709
Epoch: 17, Steps: 70 | Train Loss: 2.411 Vali Loss: 6.845 Vali Acc: 0.500 Test Loss: 6.845 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.953153133392334
Epoch: 18, Steps: 70 | Train Loss: 2.591 Vali Loss: 0.913 Vali Acc: 0.490 Test Loss: 0.913 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 14.354251384735107
Epoch: 19, Steps: 70 | Train Loss: 1.478 Vali Loss: 1.161 Vali Acc: 0.530 Test Loss: 1.161 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529988).  Saving model ...
Epoch: 20 cost time: 14.349832773208618
Epoch: 20, Steps: 70 | Train Loss: 1.789 Vali Loss: 1.439 Vali Acc: 0.490 Test Loss: 1.439 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.00144910812378
Epoch: 21, Steps: 70 | Train Loss: 2.993 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 14.456316232681274
Epoch: 22, Steps: 70 | Train Loss: 1.657 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.847918033599854
Epoch: 23, Steps: 70 | Train Loss: 2.741 Vali Loss: 2.454 Vali Acc: 0.500 Test Loss: 2.454 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 14.96025824546814
Epoch: 24, Steps: 70 | Train Loss: 1.714 Vali Loss: 2.473 Vali Acc: 0.500 Test Loss: 2.473 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.430851221084595
Epoch: 25, Steps: 70 | Train Loss: 1.869 Vali Loss: 3.057 Vali Acc: 0.500 Test Loss: 3.057 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 14.799593448638916
Epoch: 26, Steps: 70 | Train Loss: 1.622 Vali Loss: 1.942 Vali Acc: 0.500 Test Loss: 1.942 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.012914419174194
Epoch: 27, Steps: 70 | Train Loss: 1.371 Vali Loss: 1.012 Vali Acc: 0.500 Test Loss: 1.012 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.802788019180298
Epoch: 28, Steps: 70 | Train Loss: 1.439 Vali Loss: 2.661 Vali Acc: 0.500 Test Loss: 2.661 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 13.024736642837524
Epoch: 29, Steps: 70 | Train Loss: 1.723 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 3024690
model size : 12.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.72932243347168
Epoch: 1, Steps: 70 | Train Loss: 3.551 Vali Loss: 8.729 Vali Acc: 0.500 Test Loss: 8.729 Test Acc: 0.500
Validation loss decreased (inf --> -0.499913).  Saving model ...
Epoch: 2 cost time: 14.393352746963501
Epoch: 2, Steps: 70 | Train Loss: 7.607 Vali Loss: 6.243 Vali Acc: 0.520 Test Loss: 6.243 Test Acc: 0.520
Validation loss decreased (-0.499913 --> -0.519938).  Saving model ...
Epoch: 3 cost time: 12.614145517349243
Epoch: 3, Steps: 70 | Train Loss: 4.881 Vali Loss: 2.545 Vali Acc: 0.500 Test Loss: 2.545 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.626874923706055
Epoch: 4, Steps: 70 | Train Loss: 3.668 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.653889894485474
Epoch: 5, Steps: 70 | Train Loss: 2.705 Vali Loss: 3.074 Vali Acc: 0.500 Test Loss: 3.074 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.277753829956055
Epoch: 6, Steps: 70 | Train Loss: 2.818 Vali Loss: 4.602 Vali Acc: 0.500 Test Loss: 4.602 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.961199522018433
Epoch: 7, Steps: 70 | Train Loss: 3.603 Vali Loss: 5.889 Vali Acc: 0.500 Test Loss: 5.889 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.204515933990479
Epoch: 8, Steps: 70 | Train Loss: 4.258 Vali Loss: 4.101 Vali Acc: 0.500 Test Loss: 4.101 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.621021032333374
Epoch: 9, Steps: 70 | Train Loss: 4.709 Vali Loss: 6.523 Vali Acc: 0.500 Test Loss: 6.523 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 18.019809246063232
Epoch: 10, Steps: 70 | Train Loss: 2.793 Vali Loss: 8.891 Vali Acc: 0.500 Test Loss: 8.891 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.05375623703003
Epoch: 11, Steps: 70 | Train Loss: 4.165 Vali Loss: 4.349 Vali Acc: 0.500 Test Loss: 4.349 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.147677421569824
Epoch: 12, Steps: 70 | Train Loss: 2.945 Vali Loss: 6.692 Vali Acc: 0.500 Test Loss: 6.692 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 2996658
model size : 12.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.499464750289917
Epoch: 1, Steps: 70 | Train Loss: 3.994 Vali Loss: 8.996 Vali Acc: 0.500 Test Loss: 8.996 Test Acc: 0.500
Validation loss decreased (inf --> -0.499910).  Saving model ...
Epoch: 2 cost time: 18.184162616729736
Epoch: 2, Steps: 70 | Train Loss: 4.166 Vali Loss: 8.088 Vali Acc: 0.500 Test Loss: 8.088 Test Acc: 0.500
Validation loss decreased (-0.499910 --> -0.499919).  Saving model ...
Epoch: 3 cost time: 16.052938222885132
Epoch: 3, Steps: 70 | Train Loss: 3.086 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
Validation loss decreased (-0.499919 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 15.37552809715271
Epoch: 4, Steps: 70 | Train Loss: 4.161 Vali Loss: 2.059 Vali Acc: 0.500 Test Loss: 2.059 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.86967444419861
Epoch: 5, Steps: 70 | Train Loss: 2.596 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 18.288436889648438
Epoch: 6, Steps: 70 | Train Loss: 3.022 Vali Loss: 6.682 Vali Acc: 0.500 Test Loss: 6.682 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.101590871810913
Epoch: 7, Steps: 70 | Train Loss: 4.753 Vali Loss: 7.144 Vali Acc: 0.500 Test Loss: 7.144 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.452231645584106
Epoch: 8, Steps: 70 | Train Loss: 3.205 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.293649673461914
Epoch: 9, Steps: 70 | Train Loss: 3.208 Vali Loss: 8.701 Vali Acc: 0.500 Test Loss: 8.701 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.932470560073853
Epoch: 10, Steps: 70 | Train Loss: 5.930 Vali Loss: 2.095 Vali Acc: 0.500 Test Loss: 2.095 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.869529485702515
Epoch: 11, Steps: 70 | Train Loss: 1.991 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.558501243591309
Epoch: 12, Steps: 70 | Train Loss: 5.293 Vali Loss: 3.475 Vali Acc: 0.500 Test Loss: 3.475 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.52617859840393
Epoch: 13, Steps: 70 | Train Loss: 2.754 Vali Loss: 2.928 Vali Acc: 0.590 Test Loss: 2.928 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589971).  Saving model ...
Epoch: 14 cost time: 18.188369750976562
Epoch: 14, Steps: 70 | Train Loss: 2.517 Vali Loss: 1.661 Vali Acc: 0.510 Test Loss: 1.661 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.462903022766113
Epoch: 15, Steps: 70 | Train Loss: 2.571 Vali Loss: 4.415 Vali Acc: 0.500 Test Loss: 4.415 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.451582908630371
Epoch: 16, Steps: 70 | Train Loss: 2.171 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.789288997650146
Epoch: 17, Steps: 70 | Train Loss: 3.976 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.266207218170166
Epoch: 18, Steps: 70 | Train Loss: 2.154 Vali Loss: 2.970 Vali Acc: 0.500 Test Loss: 2.970 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.126854181289673
Epoch: 19, Steps: 70 | Train Loss: 1.834 Vali Loss: 2.925 Vali Acc: 0.500 Test Loss: 2.925 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.881416082382202
Epoch: 20, Steps: 70 | Train Loss: 1.923 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.766592979431152
Epoch: 21, Steps: 70 | Train Loss: 2.108 Vali Loss: 3.422 Vali Acc: 0.500 Test Loss: 3.422 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 18.186522006988525
Epoch: 22, Steps: 70 | Train Loss: 2.185 Vali Loss: 1.712 Vali Acc: 0.500 Test Loss: 1.712 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 18.528221368789673
Epoch: 23, Steps: 70 | Train Loss: 1.898 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2968626
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.10649561882019
Epoch: 1, Steps: 70 | Train Loss: 4.358 Vali Loss: 0.764 Vali Acc: 0.600 Test Loss: 0.764 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 17.71752095222473
Epoch: 2, Steps: 70 | Train Loss: 4.771 Vali Loss: 0.947 Vali Acc: 0.480 Test Loss: 0.947 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.68584442138672
Epoch: 3, Steps: 70 | Train Loss: 1.620 Vali Loss: 0.751 Vali Acc: 0.620 Test Loss: 0.751 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 4 cost time: 13.871254205703735
Epoch: 4, Steps: 70 | Train Loss: 2.544 Vali Loss: 7.287 Vali Acc: 0.500 Test Loss: 7.287 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.387792825698853
Epoch: 5, Steps: 70 | Train Loss: 2.294 Vali Loss: 0.871 Vali Acc: 0.460 Test Loss: 0.871 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.650841236114502
Epoch: 6, Steps: 70 | Train Loss: 2.387 Vali Loss: 8.581 Vali Acc: 0.500 Test Loss: 8.581 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.941656827926636
Epoch: 7, Steps: 70 | Train Loss: 4.074 Vali Loss: 1.734 Vali Acc: 0.520 Test Loss: 1.734 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.231168508529663
Epoch: 8, Steps: 70 | Train Loss: 3.475 Vali Loss: 5.361 Vali Acc: 0.500 Test Loss: 5.361 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.814387798309326
Epoch: 9, Steps: 70 | Train Loss: 3.636 Vali Loss: 7.718 Vali Acc: 0.500 Test Loss: 7.718 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.131825923919678
Epoch: 10, Steps: 70 | Train Loss: 2.627 Vali Loss: 9.058 Vali Acc: 0.500 Test Loss: 9.058 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.78724431991577
Epoch: 11, Steps: 70 | Train Loss: 2.384 Vali Loss: 3.158 Vali Acc: 0.520 Test Loss: 3.158 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.757355213165283
Epoch: 12, Steps: 70 | Train Loss: 2.171 Vali Loss: 2.216 Vali Acc: 0.550 Test Loss: 2.216 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.042580366134644
Epoch: 13, Steps: 70 | Train Loss: 1.721 Vali Loss: 2.923 Vali Acc: 0.500 Test Loss: 2.923 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2590386
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.111863613128662
Epoch: 1, Steps: 70 | Train Loss: 4.704 Vali Loss: 3.429 Vali Acc: 0.510 Test Loss: 3.429 Test Acc: 0.510
Validation loss decreased (inf --> -0.509966).  Saving model ...
Epoch: 2 cost time: 16.92289662361145
Epoch: 2, Steps: 70 | Train Loss: 4.094 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.844297647476196
Epoch: 3, Steps: 70 | Train Loss: 3.490 Vali Loss: 3.008 Vali Acc: 0.500 Test Loss: 3.008 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.966028690338135
Epoch: 4, Steps: 70 | Train Loss: 3.749 Vali Loss: 3.999 Vali Acc: 0.500 Test Loss: 3.999 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.597835779190063
Epoch: 5, Steps: 70 | Train Loss: 1.543 Vali Loss: 2.052 Vali Acc: 0.500 Test Loss: 2.052 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.67946195602417
Epoch: 6, Steps: 70 | Train Loss: 2.188 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.20701813697815
Epoch: 7, Steps: 70 | Train Loss: 2.608 Vali Loss: 1.254 Vali Acc: 0.620 Test Loss: 1.254 Test Acc: 0.620
Validation loss decreased (-0.509966 --> -0.619987).  Saving model ...
Epoch: 8 cost time: 17.24478769302368
Epoch: 8, Steps: 70 | Train Loss: 2.228 Vali Loss: 2.598 Vali Acc: 0.500 Test Loss: 2.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.78828763961792
Epoch: 9, Steps: 70 | Train Loss: 3.442 Vali Loss: 3.879 Vali Acc: 0.500 Test Loss: 3.879 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.737531185150146
Epoch: 10, Steps: 70 | Train Loss: 1.868 Vali Loss: 3.637 Vali Acc: 0.520 Test Loss: 3.637 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.468423128128052
Epoch: 11, Steps: 70 | Train Loss: 3.303 Vali Loss: 10.587 Vali Acc: 0.500 Test Loss: 10.587 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.105860471725464
Epoch: 12, Steps: 70 | Train Loss: 1.683 Vali Loss: 2.425 Vali Acc: 0.510 Test Loss: 2.425 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.72134041786194
Epoch: 13, Steps: 70 | Train Loss: 2.211 Vali Loss: 5.936 Vali Acc: 0.500 Test Loss: 5.936 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.778269052505493
Epoch: 14, Steps: 70 | Train Loss: 2.075 Vali Loss: 2.923 Vali Acc: 0.490 Test Loss: 2.923 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 15.900142431259155
Epoch: 15, Steps: 70 | Train Loss: 2.356 Vali Loss: 5.133 Vali Acc: 0.520 Test Loss: 5.133 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.058619737625122
Epoch: 16, Steps: 70 | Train Loss: 1.428 Vali Loss: 2.502 Vali Acc: 0.580 Test Loss: 2.502 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 17.734652757644653
Epoch: 17, Steps: 70 | Train Loss: 1.255 Vali Loss: 3.053 Vali Acc: 0.500 Test Loss: 3.053 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2562354
model size : 11.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.02159285545349
Epoch: 1, Steps: 70 | Train Loss: 6.378 Vali Loss: 18.413 Vali Acc: 0.500 Test Loss: 18.413 Test Acc: 0.500
Validation loss decreased (inf --> -0.499816).  Saving model ...
Epoch: 2 cost time: 13.715863227844238
Epoch: 2, Steps: 70 | Train Loss: 4.950 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.499816 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 16.814277410507202
Epoch: 3, Steps: 70 | Train Loss: 1.525 Vali Loss: 2.010 Vali Acc: 0.500 Test Loss: 2.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.000259160995483
Epoch: 4, Steps: 70 | Train Loss: 3.401 Vali Loss: 4.111 Vali Acc: 0.500 Test Loss: 4.111 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.101872205734253
Epoch: 5, Steps: 70 | Train Loss: 3.420 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519988).  Saving model ...
Epoch: 6 cost time: 13.736274719238281
Epoch: 6, Steps: 70 | Train Loss: 3.111 Vali Loss: 4.216 Vali Acc: 0.500 Test Loss: 4.216 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.069648504257202
Epoch: 7, Steps: 70 | Train Loss: 2.631 Vali Loss: 5.121 Vali Acc: 0.500 Test Loss: 5.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.264102935791016
Epoch: 8, Steps: 70 | Train Loss: 4.521 Vali Loss: 6.110 Vali Acc: 0.500 Test Loss: 6.110 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.359694719314575
Epoch: 9, Steps: 70 | Train Loss: 3.707 Vali Loss: 6.377 Vali Acc: 0.500 Test Loss: 6.377 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.309103965759277
Epoch: 10, Steps: 70 | Train Loss: 3.216 Vali Loss: 1.772 Vali Acc: 0.520 Test Loss: 1.772 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.691354274749756
Epoch: 11, Steps: 70 | Train Loss: 2.107 Vali Loss: 3.754 Vali Acc: 0.500 Test Loss: 3.754 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.25195288658142
Epoch: 12, Steps: 70 | Train Loss: 2.217 Vali Loss: 1.691 Vali Acc: 0.490 Test Loss: 1.691 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.064117193222046
Epoch: 13, Steps: 70 | Train Loss: 1.807 Vali Loss: 4.370 Vali Acc: 0.460 Test Loss: 4.370 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.156397342681885
Epoch: 14, Steps: 70 | Train Loss: 2.496 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.719425678253174
Epoch: 15, Steps: 70 | Train Loss: 1.765 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
Validation loss decreased (-0.519988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 13.609818696975708
Epoch: 16, Steps: 70 | Train Loss: 3.850 Vali Loss: 1.383 Vali Acc: 0.440 Test Loss: 1.383 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.998944759368896
Epoch: 17, Steps: 70 | Train Loss: 1.996 Vali Loss: 1.530 Vali Acc: 0.570 Test Loss: 1.530 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.770211219787598
Epoch: 18, Steps: 70 | Train Loss: 1.847 Vali Loss: 18.568 Vali Acc: 0.500 Test Loss: 18.568 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.631552934646606
Epoch: 19, Steps: 70 | Train Loss: 2.731 Vali Loss: 8.389 Vali Acc: 0.500 Test Loss: 8.389 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.887512922286987
Epoch: 20, Steps: 70 | Train Loss: 1.431 Vali Loss: 3.226 Vali Acc: 0.480 Test Loss: 3.226 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.998195171356201
Epoch: 21, Steps: 70 | Train Loss: 2.754 Vali Loss: 2.383 Vali Acc: 0.500 Test Loss: 2.383 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.528475046157837
Epoch: 22, Steps: 70 | Train Loss: 2.221 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.280402898788452
Epoch: 23, Steps: 70 | Train Loss: 1.866 Vali Loss: 0.883 Vali Acc: 0.490 Test Loss: 0.883 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 13.329057455062866
Epoch: 24, Steps: 70 | Train Loss: 1.535 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 15.695083618164062
Epoch: 25, Steps: 70 | Train Loss: 2.403 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2534322
model size : 11.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.94679069519043
Epoch: 1, Steps: 70 | Train Loss: 4.116 Vali Loss: 3.299 Vali Acc: 0.540 Test Loss: 3.299 Test Acc: 0.540
Validation loss decreased (inf --> -0.539967).  Saving model ...
Epoch: 2 cost time: 13.00112009048462
Epoch: 2, Steps: 70 | Train Loss: 2.845 Vali Loss: 0.995 Vali Acc: 0.630 Test Loss: 0.995 Test Acc: 0.630
Validation loss decreased (-0.539967 --> -0.629990).  Saving model ...
Epoch: 3 cost time: 16.31566333770752
Epoch: 3, Steps: 70 | Train Loss: 3.599 Vali Loss: 4.333 Vali Acc: 0.500 Test Loss: 4.333 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.17216682434082
Epoch: 4, Steps: 70 | Train Loss: 5.706 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.378579139709473
Epoch: 5, Steps: 70 | Train Loss: 1.970 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.981345415115356
Epoch: 6, Steps: 70 | Train Loss: 2.130 Vali Loss: 2.671 Vali Acc: 0.500 Test Loss: 2.671 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.59375548362732
Epoch: 7, Steps: 70 | Train Loss: 4.459 Vali Loss: 8.375 Vali Acc: 0.500 Test Loss: 8.375 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.52565026283264
Epoch: 8, Steps: 70 | Train Loss: 3.006 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.625608921051025
Epoch: 9, Steps: 70 | Train Loss: 2.881 Vali Loss: 2.363 Vali Acc: 0.500 Test Loss: 2.363 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.368271589279175
Epoch: 10, Steps: 70 | Train Loss: 3.550 Vali Loss: 7.319 Vali Acc: 0.500 Test Loss: 7.319 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.381686687469482
Epoch: 11, Steps: 70 | Train Loss: 2.815 Vali Loss: 5.388 Vali Acc: 0.500 Test Loss: 5.388 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.42852759361267
Epoch: 12, Steps: 70 | Train Loss: 4.706 Vali Loss: 2.562 Vali Acc: 0.500 Test Loss: 2.562 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2506290
model size : 10.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.901169776916504
Epoch: 1, Steps: 70 | Train Loss: 3.364 Vali Loss: 2.958 Vali Acc: 0.490 Test Loss: 2.958 Test Acc: 0.490
Validation loss decreased (inf --> -0.489970).  Saving model ...
Epoch: 2 cost time: 15.90732717514038
Epoch: 2, Steps: 70 | Train Loss: 4.718 Vali Loss: 8.523 Vali Acc: 0.500 Test Loss: 8.523 Test Acc: 0.500
Validation loss decreased (-0.489970 --> -0.499915).  Saving model ...
Epoch: 3 cost time: 12.690926551818848
Epoch: 3, Steps: 70 | Train Loss: 4.489 Vali Loss: 4.510 Vali Acc: 0.500 Test Loss: 4.510 Test Acc: 0.500
Validation loss decreased (-0.499915 --> -0.499955).  Saving model ...
Epoch: 4 cost time: 14.738287925720215
Epoch: 4, Steps: 70 | Train Loss: 2.823 Vali Loss: 3.900 Vali Acc: 0.500 Test Loss: 3.900 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499961).  Saving model ...
Epoch: 5 cost time: 15.82748007774353
Epoch: 5, Steps: 70 | Train Loss: 2.348 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
Validation loss decreased (-0.499961 --> -0.499990).  Saving model ...
Epoch: 6 cost time: 15.997841596603394
Epoch: 6, Steps: 70 | Train Loss: 4.325 Vali Loss: 5.072 Vali Acc: 0.500 Test Loss: 5.072 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.785489320755005
Epoch: 7, Steps: 70 | Train Loss: 2.553 Vali Loss: 1.968 Vali Acc: 0.500 Test Loss: 1.968 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.590120792388916
Epoch: 8, Steps: 70 | Train Loss: 2.190 Vali Loss: 3.261 Vali Acc: 0.500 Test Loss: 3.261 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.871151685714722
Epoch: 9, Steps: 70 | Train Loss: 3.435 Vali Loss: 7.239 Vali Acc: 0.500 Test Loss: 7.239 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.954265117645264
Epoch: 10, Steps: 70 | Train Loss: 2.892 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.6194748878479
Epoch: 11, Steps: 70 | Train Loss: 3.008 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 15.917358636856079
Epoch: 12, Steps: 70 | Train Loss: 1.659 Vali Loss: 2.552 Vali Acc: 0.500 Test Loss: 2.552 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.993892669677734
Epoch: 13, Steps: 70 | Train Loss: 2.228 Vali Loss: 1.817 Vali Acc: 0.500 Test Loss: 1.817 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.46640133857727
Epoch: 14, Steps: 70 | Train Loss: 3.244 Vali Loss: 5.192 Vali Acc: 0.500 Test Loss: 5.192 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.673012971878052
Epoch: 15, Steps: 70 | Train Loss: 1.585 Vali Loss: 5.950 Vali Acc: 0.500 Test Loss: 5.950 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.02985382080078
Epoch: 16, Steps: 70 | Train Loss: 2.837 Vali Loss: 4.397 Vali Acc: 0.500 Test Loss: 4.397 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.007505655288696
Epoch: 17, Steps: 70 | Train Loss: 2.185 Vali Loss: 4.701 Vali Acc: 0.500 Test Loss: 4.701 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.748371839523315
Epoch: 18, Steps: 70 | Train Loss: 1.831 Vali Loss: 1.308 Vali Acc: 0.540 Test Loss: 1.308 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539987).  Saving model ...
Epoch: 19 cost time: 13.594531774520874
Epoch: 19, Steps: 70 | Train Loss: 2.125 Vali Loss: 11.610 Vali Acc: 0.510 Test Loss: 11.610 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 16.11076283454895
Epoch: 20, Steps: 70 | Train Loss: 1.702 Vali Loss: 3.097 Vali Acc: 0.510 Test Loss: 3.097 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 16.173479557037354
Epoch: 21, Steps: 70 | Train Loss: 1.274 Vali Loss: 4.142 Vali Acc: 0.510 Test Loss: 4.142 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.475632190704346
Epoch: 22, Steps: 70 | Train Loss: 0.798 Vali Loss: 2.457 Vali Acc: 0.540 Test Loss: 2.457 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.600194454193115
Epoch: 23, Steps: 70 | Train Loss: 0.496 Vali Loss: 9.455 Vali Acc: 0.440 Test Loss: 9.455 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 16.17981195449829
Epoch: 24, Steps: 70 | Train Loss: 0.981 Vali Loss: 9.800 Vali Acc: 0.510 Test Loss: 9.800 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 16.337462902069092
Epoch: 25, Steps: 70 | Train Loss: 1.013 Vali Loss: 2.377 Vali Acc: 0.490 Test Loss: 2.377 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.068778276443481
Epoch: 26, Steps: 70 | Train Loss: 0.798 Vali Loss: 5.952 Vali Acc: 0.460 Test Loss: 5.952 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 16.435654878616333
Epoch: 27, Steps: 70 | Train Loss: 1.538 Vali Loss: 8.227 Vali Acc: 0.480 Test Loss: 8.227 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 16.317375898361206
Epoch: 28, Steps: 70 | Train Loss: 0.766 Vali Loss: 5.837 Vali Acc: 0.500 Test Loss: 5.837 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 2359218
model size : 10.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.30458378791809
Epoch: 1, Steps: 70 | Train Loss: 4.060 Vali Loss: 2.949 Vali Acc: 0.510 Test Loss: 2.949 Test Acc: 0.510
Validation loss decreased (inf --> -0.509971).  Saving model ...
Epoch: 2 cost time: 16.4056396484375
Epoch: 2, Steps: 70 | Train Loss: 7.309 Vali Loss: 5.589 Vali Acc: 0.510 Test Loss: 5.589 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.559215068817139
Epoch: 3, Steps: 70 | Train Loss: 6.224 Vali Loss: 7.315 Vali Acc: 0.500 Test Loss: 7.315 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.568211317062378
Epoch: 4, Steps: 70 | Train Loss: 3.200 Vali Loss: 7.953 Vali Acc: 0.500 Test Loss: 7.953 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.632580518722534
Epoch: 5, Steps: 70 | Train Loss: 2.823 Vali Loss: 2.901 Vali Acc: 0.500 Test Loss: 2.901 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.59603500366211
Epoch: 6, Steps: 70 | Train Loss: 3.809 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
Validation loss decreased (-0.509971 --> -0.509990).  Saving model ...
Epoch: 7 cost time: 15.28192663192749
Epoch: 7, Steps: 70 | Train Loss: 2.770 Vali Loss: 6.246 Vali Acc: 0.500 Test Loss: 6.246 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.218499660491943
Epoch: 8, Steps: 70 | Train Loss: 2.910 Vali Loss: 10.310 Vali Acc: 0.500 Test Loss: 10.310 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.713505268096924
Epoch: 9, Steps: 70 | Train Loss: 2.935 Vali Loss: 10.553 Vali Acc: 0.500 Test Loss: 10.553 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.153908252716064
Epoch: 10, Steps: 70 | Train Loss: 5.380 Vali Loss: 6.445 Vali Acc: 0.500 Test Loss: 6.445 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.358912944793701
Epoch: 11, Steps: 70 | Train Loss: 1.910 Vali Loss: 5.314 Vali Acc: 0.500 Test Loss: 5.314 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.312682628631592
Epoch: 12, Steps: 70 | Train Loss: 3.053 Vali Loss: 2.547 Vali Acc: 0.500 Test Loss: 2.547 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.342948913574219
Epoch: 13, Steps: 70 | Train Loss: 2.040 Vali Loss: 6.746 Vali Acc: 0.460 Test Loss: 6.746 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.641423463821411
Epoch: 14, Steps: 70 | Train Loss: 2.250 Vali Loss: 12.156 Vali Acc: 0.500 Test Loss: 12.156 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.967703342437744
Epoch: 15, Steps: 70 | Train Loss: 1.617 Vali Loss: 3.648 Vali Acc: 0.530 Test Loss: 3.648 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529964).  Saving model ...
Epoch: 16 cost time: 15.180509090423584
Epoch: 16, Steps: 70 | Train Loss: 1.783 Vali Loss: 6.818 Vali Acc: 0.520 Test Loss: 6.818 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.652385950088501
Epoch: 17, Steps: 70 | Train Loss: 1.887 Vali Loss: 5.971 Vali Acc: 0.510 Test Loss: 5.971 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.14402151107788
Epoch: 18, Steps: 70 | Train Loss: 1.023 Vali Loss: 4.140 Vali Acc: 0.630 Test Loss: 4.140 Test Acc: 0.630
Validation loss decreased (-0.529964 --> -0.629959).  Saving model ...
Epoch: 19 cost time: 15.365649461746216
Epoch: 19, Steps: 70 | Train Loss: 0.745 Vali Loss: 4.387 Vali Acc: 0.500 Test Loss: 4.387 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.669606924057007
Epoch: 20, Steps: 70 | Train Loss: 0.667 Vali Loss: 5.432 Vali Acc: 0.510 Test Loss: 5.432 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.284834146499634
Epoch: 21, Steps: 70 | Train Loss: 1.004 Vali Loss: 7.819 Vali Acc: 0.470 Test Loss: 7.819 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 15.18213152885437
Epoch: 22, Steps: 70 | Train Loss: 0.812 Vali Loss: 6.325 Vali Acc: 0.530 Test Loss: 6.325 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.858171463012695
Epoch: 23, Steps: 70 | Train Loss: 0.446 Vali Loss: 5.202 Vali Acc: 0.520 Test Loss: 5.202 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.64803671836853
Epoch: 24, Steps: 70 | Train Loss: 0.277 Vali Loss: 11.378 Vali Acc: 0.480 Test Loss: 11.378 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 15.073378086090088
Epoch: 25, Steps: 70 | Train Loss: 0.884 Vali Loss: 8.852 Vali Acc: 0.490 Test Loss: 8.852 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.21095061302185
Epoch: 26, Steps: 70 | Train Loss: 0.321 Vali Loss: 11.034 Vali Acc: 0.500 Test Loss: 11.034 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.362670660018921
Epoch: 27, Steps: 70 | Train Loss: 0.419 Vali Loss: 7.587 Vali Acc: 0.470 Test Loss: 7.587 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 15.134533166885376
Epoch: 28, Steps: 70 | Train Loss: 0.875 Vali Loss: 9.645 Vali Acc: 0.510 Test Loss: 9.645 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2331186
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.551609754562378
Epoch: 1, Steps: 70 | Train Loss: 2.522 Vali Loss: 5.019 Vali Acc: 0.460 Test Loss: 5.019 Test Acc: 0.460
Validation loss decreased (inf --> -0.459950).  Saving model ...
Epoch: 2 cost time: 13.895626783370972
Epoch: 2, Steps: 70 | Train Loss: 4.944 Vali Loss: 1.610 Vali Acc: 0.490 Test Loss: 1.610 Test Acc: 0.490
Validation loss decreased (-0.459950 --> -0.489984).  Saving model ...
Epoch: 3 cost time: 11.696640491485596
Epoch: 3, Steps: 70 | Train Loss: 2.530 Vali Loss: 4.419 Vali Acc: 0.500 Test Loss: 4.419 Test Acc: 0.500
Validation loss decreased (-0.489984 --> -0.499956).  Saving model ...
Epoch: 4 cost time: 14.407128810882568
Epoch: 4, Steps: 70 | Train Loss: 3.279 Vali Loss: 3.829 Vali Acc: 0.500 Test Loss: 3.829 Test Acc: 0.500
Validation loss decreased (-0.499956 --> -0.499962).  Saving model ...
Epoch: 5 cost time: 14.17200231552124
Epoch: 5, Steps: 70 | Train Loss: 2.903 Vali Loss: 3.632 Vali Acc: 0.500 Test Loss: 3.632 Test Acc: 0.500
Validation loss decreased (-0.499962 --> -0.499964).  Saving model ...
Epoch: 6 cost time: 12.749314785003662
Epoch: 6, Steps: 70 | Train Loss: 1.895 Vali Loss: 1.595 Vali Acc: 0.500 Test Loss: 1.595 Test Acc: 0.500
Validation loss decreased (-0.499964 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 13.432343006134033
Epoch: 7, Steps: 70 | Train Loss: 3.161 Vali Loss: 6.440 Vali Acc: 0.500 Test Loss: 6.440 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.40005898475647
Epoch: 8, Steps: 70 | Train Loss: 3.286 Vali Loss: 4.549 Vali Acc: 0.500 Test Loss: 4.549 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.501348495483398
Epoch: 9, Steps: 70 | Train Loss: 2.491 Vali Loss: 2.385 Vali Acc: 0.500 Test Loss: 2.385 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.852785348892212
Epoch: 10, Steps: 70 | Train Loss: 3.779 Vali Loss: 3.911 Vali Acc: 0.500 Test Loss: 3.911 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.53232741355896
Epoch: 11, Steps: 70 | Train Loss: 2.577 Vali Loss: 2.555 Vali Acc: 0.500 Test Loss: 2.555 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.20668649673462
Epoch: 12, Steps: 70 | Train Loss: 3.052 Vali Loss: 4.561 Vali Acc: 0.500 Test Loss: 4.561 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.974052906036377
Epoch: 13, Steps: 70 | Train Loss: 2.114 Vali Loss: 5.624 Vali Acc: 0.500 Test Loss: 5.624 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.12070083618164
Epoch: 14, Steps: 70 | Train Loss: 1.675 Vali Loss: 2.817 Vali Acc: 0.500 Test Loss: 2.817 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 15.364753723144531
Epoch: 15, Steps: 70 | Train Loss: 1.453 Vali Loss: 2.710 Vali Acc: 0.470 Test Loss: 2.710 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.830081462860107
Epoch: 16, Steps: 70 | Train Loss: 1.225 Vali Loss: 1.810 Vali Acc: 0.510 Test Loss: 1.810 Test Acc: 0.510
Validation loss decreased (-0.499984 --> -0.509982).  Saving model ...
Epoch: 17 cost time: 15.127443790435791
Epoch: 17, Steps: 70 | Train Loss: 2.271 Vali Loss: 3.225 Vali Acc: 0.500 Test Loss: 3.225 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.151975393295288
Epoch: 18, Steps: 70 | Train Loss: 1.798 Vali Loss: 2.671 Vali Acc: 0.560 Test Loss: 2.671 Test Acc: 0.560
Validation loss decreased (-0.509982 --> -0.559973).  Saving model ...
Epoch: 19 cost time: 11.955641269683838
Epoch: 19, Steps: 70 | Train Loss: 1.214 Vali Loss: 2.075 Vali Acc: 0.590 Test Loss: 2.075 Test Acc: 0.590
Validation loss decreased (-0.559973 --> -0.589979).  Saving model ...
Epoch: 20 cost time: 15.094854831695557
Epoch: 20, Steps: 70 | Train Loss: 0.782 Vali Loss: 1.891 Vali Acc: 0.560 Test Loss: 1.891 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 15.202122688293457
Epoch: 21, Steps: 70 | Train Loss: 0.972 Vali Loss: 4.101 Vali Acc: 0.460 Test Loss: 4.101 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.039700269699097
Epoch: 22, Steps: 70 | Train Loss: 1.599 Vali Loss: 3.899 Vali Acc: 0.540 Test Loss: 3.899 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 15.184179306030273
Epoch: 23, Steps: 70 | Train Loss: 0.857 Vali Loss: 1.342 Vali Acc: 0.540 Test Loss: 1.342 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 14.982897281646729
Epoch: 24, Steps: 70 | Train Loss: 1.239 Vali Loss: 8.802 Vali Acc: 0.510 Test Loss: 8.802 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 12.11327075958252
Epoch: 25, Steps: 70 | Train Loss: 0.785 Vali Loss: 3.163 Vali Acc: 0.540 Test Loss: 3.163 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 14.88254714012146
Epoch: 26, Steps: 70 | Train Loss: 0.576 Vali Loss: 4.778 Vali Acc: 0.580 Test Loss: 4.778 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 15.233965158462524
Epoch: 27, Steps: 70 | Train Loss: 0.446 Vali Loss: 4.415 Vali Acc: 0.560 Test Loss: 4.415 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 12.139931440353394
Epoch: 28, Steps: 70 | Train Loss: 0.148 Vali Loss: 3.789 Vali Acc: 0.640 Test Loss: 3.789 Test Acc: 0.640
Validation loss decreased (-0.589979 --> -0.639962).  Saving model ...
Epoch: 29 cost time: 14.574665546417236
Epoch: 29, Steps: 70 | Train Loss: 0.317 Vali Loss: 4.947 Vali Acc: 0.580 Test Loss: 4.947 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 15.165066957473755
Epoch: 30, Steps: 70 | Train Loss: 0.124 Vali Loss: 6.967 Vali Acc: 0.580 Test Loss: 6.967 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 12.697616577148438
Epoch: 31, Steps: 70 | Train Loss: 0.161 Vali Loss: 10.629 Vali Acc: 0.600 Test Loss: 10.629 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 13.712157487869263
Epoch: 32, Steps: 70 | Train Loss: 0.290 Vali Loss: 5.461 Vali Acc: 0.570 Test Loss: 5.461 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 14.99301290512085
Epoch: 33, Steps: 70 | Train Loss: 0.159 Vali Loss: 8.180 Vali Acc: 0.560 Test Loss: 8.180 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 13.418937921524048
Epoch: 34, Steps: 70 | Train Loss: 0.438 Vali Loss: 14.475 Vali Acc: 0.580 Test Loss: 14.475 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 12.646758556365967
Epoch: 35, Steps: 70 | Train Loss: 0.496 Vali Loss: 7.882 Vali Acc: 0.570 Test Loss: 7.882 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 15.368871688842773
Epoch: 36, Steps: 70 | Train Loss: 0.219 Vali Loss: 5.776 Vali Acc: 0.470 Test Loss: 5.776 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 14.464889764785767
Epoch: 37, Steps: 70 | Train Loss: 0.039 Vali Loss: 9.766 Vali Acc: 0.550 Test Loss: 9.766 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 12.970871925354004
Epoch: 38, Steps: 70 | Train Loss: 0.000 Vali Loss: 10.958 Vali Acc: 0.520 Test Loss: 10.958 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 2303154
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.467254161834717
Epoch: 1, Steps: 70 | Train Loss: 3.386 Vali Loss: 2.579 Vali Acc: 0.520 Test Loss: 2.579 Test Acc: 0.520
Validation loss decreased (inf --> -0.519974).  Saving model ...
Epoch: 2 cost time: 14.655498743057251
Epoch: 2, Steps: 70 | Train Loss: 5.618 Vali Loss: 3.360 Vali Acc: 0.520 Test Loss: 3.360 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.117653608322144
Epoch: 3, Steps: 70 | Train Loss: 6.409 Vali Loss: 7.205 Vali Acc: 0.500 Test Loss: 7.205 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.491549730300903
Epoch: 4, Steps: 70 | Train Loss: 5.268 Vali Loss: 6.549 Vali Acc: 0.500 Test Loss: 6.549 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.378253698348999
Epoch: 5, Steps: 70 | Train Loss: 4.576 Vali Loss: 3.580 Vali Acc: 0.500 Test Loss: 3.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.989592552185059
Epoch: 6, Steps: 70 | Train Loss: 3.070 Vali Loss: 5.004 Vali Acc: 0.500 Test Loss: 5.004 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.83215069770813
Epoch: 7, Steps: 70 | Train Loss: 3.850 Vali Loss: 3.364 Vali Acc: 0.500 Test Loss: 3.364 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.36975646018982
Epoch: 8, Steps: 70 | Train Loss: 3.213 Vali Loss: 10.168 Vali Acc: 0.500 Test Loss: 10.168 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.03222393989563
Epoch: 9, Steps: 70 | Train Loss: 2.998 Vali Loss: 4.060 Vali Acc: 0.500 Test Loss: 4.060 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.31259274482727
Epoch: 10, Steps: 70 | Train Loss: 3.680 Vali Loss: 2.564 Vali Acc: 0.420 Test Loss: 2.564 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.091289281845093
Epoch: 11, Steps: 70 | Train Loss: 3.684 Vali Loss: 10.293 Vali Acc: 0.470 Test Loss: 10.293 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 2275122
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.425200939178467
Epoch: 1, Steps: 70 | Train Loss: 4.083 Vali Loss: 8.711 Vali Acc: 0.500 Test Loss: 8.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499913).  Saving model ...
Epoch: 2 cost time: 13.94063925743103
Epoch: 2, Steps: 70 | Train Loss: 5.643 Vali Loss: 6.749 Vali Acc: 0.500 Test Loss: 6.749 Test Acc: 0.500
Validation loss decreased (-0.499913 --> -0.499933).  Saving model ...
Epoch: 3 cost time: 13.825103759765625
Epoch: 3, Steps: 70 | Train Loss: 7.939 Vali Loss: 9.817 Vali Acc: 0.500 Test Loss: 9.817 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.909286499023438
Epoch: 4, Steps: 70 | Train Loss: 3.371 Vali Loss: 1.205 Vali Acc: 0.450 Test Loss: 1.205 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.295398950576782
Epoch: 5, Steps: 70 | Train Loss: 4.618 Vali Loss: 13.611 Vali Acc: 0.500 Test Loss: 13.611 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.812413454055786
Epoch: 6, Steps: 70 | Train Loss: 3.919 Vali Loss: 6.665 Vali Acc: 0.500 Test Loss: 6.665 Test Acc: 0.500
Validation loss decreased (-0.499933 --> -0.499933).  Saving model ...
Epoch: 7 cost time: 14.455224990844727
Epoch: 7, Steps: 70 | Train Loss: 3.446 Vali Loss: 2.237 Vali Acc: 0.510 Test Loss: 2.237 Test Acc: 0.510
Validation loss decreased (-0.499933 --> -0.509978).  Saving model ...
Epoch: 8 cost time: 11.864594221115112
Epoch: 8, Steps: 70 | Train Loss: 4.023 Vali Loss: 1.135 Vali Acc: 0.510 Test Loss: 1.135 Test Acc: 0.510
Validation loss decreased (-0.509978 --> -0.509989).  Saving model ...
Epoch: 9 cost time: 14.46068263053894
Epoch: 9, Steps: 70 | Train Loss: 3.377 Vali Loss: 2.637 Vali Acc: 0.500 Test Loss: 2.637 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.93441915512085
Epoch: 10, Steps: 70 | Train Loss: 3.582 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.921068668365479
Epoch: 11, Steps: 70 | Train Loss: 2.751 Vali Loss: 6.070 Vali Acc: 0.440 Test Loss: 6.070 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.256577730178833
Epoch: 12, Steps: 70 | Train Loss: 1.979 Vali Loss: 2.035 Vali Acc: 0.520 Test Loss: 2.035 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519980).  Saving model ...
Epoch: 13 cost time: 13.576311349868774
Epoch: 13, Steps: 70 | Train Loss: 2.355 Vali Loss: 2.807 Vali Acc: 0.500 Test Loss: 2.807 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.57757043838501
Epoch: 14, Steps: 70 | Train Loss: 1.184 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
Validation loss decreased (-0.519980 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 12.596055746078491
Epoch: 15, Steps: 70 | Train Loss: 1.572 Vali Loss: 2.423 Vali Acc: 0.520 Test Loss: 2.423 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.676095724105835
Epoch: 16, Steps: 70 | Train Loss: 1.457 Vali Loss: 1.816 Vali Acc: 0.500 Test Loss: 1.816 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.476884365081787
Epoch: 17, Steps: 70 | Train Loss: 1.682 Vali Loss: 5.358 Vali Acc: 0.460 Test Loss: 5.358 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.579808473587036
Epoch: 18, Steps: 70 | Train Loss: 1.064 Vali Loss: 8.503 Vali Acc: 0.530 Test Loss: 8.503 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.081775188446045
Epoch: 19, Steps: 70 | Train Loss: 1.358 Vali Loss: 4.725 Vali Acc: 0.460 Test Loss: 4.725 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.419730186462402
Epoch: 20, Steps: 70 | Train Loss: 0.892 Vali Loss: 8.426 Vali Acc: 0.460 Test Loss: 8.426 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 13.235932350158691
Epoch: 21, Steps: 70 | Train Loss: 0.635 Vali Loss: 14.185 Vali Acc: 0.470 Test Loss: 14.185 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.317763328552246
Epoch: 22, Steps: 70 | Train Loss: 0.818 Vali Loss: 3.046 Vali Acc: 0.480 Test Loss: 3.046 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 13.779716491699219
Epoch: 23, Steps: 70 | Train Loss: 0.421 Vali Loss: 4.934 Vali Acc: 0.520 Test Loss: 4.934 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.691450834274292
Epoch: 24, Steps: 70 | Train Loss: 0.493 Vali Loss: 8.602 Vali Acc: 0.440 Test Loss: 8.602 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2243634
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.735292434692383
Epoch: 1, Steps: 70 | Train Loss: 2.108 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 11.860128402709961
Epoch: 2, Steps: 70 | Train Loss: 5.437 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 14.70605754852295
Epoch: 3, Steps: 70 | Train Loss: 2.978 Vali Loss: 0.902 Vali Acc: 0.470 Test Loss: 0.902 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.792933464050293
Epoch: 4, Steps: 70 | Train Loss: 3.977 Vali Loss: 2.291 Vali Acc: 0.500 Test Loss: 2.291 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.311480283737183
Epoch: 5, Steps: 70 | Train Loss: 3.859 Vali Loss: 2.068 Vali Acc: 0.500 Test Loss: 2.068 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.723140716552734
Epoch: 6, Steps: 70 | Train Loss: 2.508 Vali Loss: 7.448 Vali Acc: 0.500 Test Loss: 7.448 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.24004340171814
Epoch: 7, Steps: 70 | Train Loss: 3.250 Vali Loss: 9.920 Vali Acc: 0.500 Test Loss: 9.920 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.124247074127197
Epoch: 8, Steps: 70 | Train Loss: 3.450 Vali Loss: 2.740 Vali Acc: 0.500 Test Loss: 2.740 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.905977725982666
Epoch: 9, Steps: 70 | Train Loss: 3.239 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 14.47958254814148
Epoch: 10, Steps: 70 | Train Loss: 3.833 Vali Loss: 4.642 Vali Acc: 0.500 Test Loss: 4.642 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.379384756088257
Epoch: 11, Steps: 70 | Train Loss: 2.377 Vali Loss: 6.963 Vali Acc: 0.500 Test Loss: 6.963 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.946086883544922
Epoch: 12, Steps: 70 | Train Loss: 2.539 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529989).  Saving model ...
Epoch: 13 cost time: 12.680298328399658
Epoch: 13, Steps: 70 | Train Loss: 3.037 Vali Loss: 6.908 Vali Acc: 0.500 Test Loss: 6.908 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.70633053779602
Epoch: 14, Steps: 70 | Train Loss: 2.523 Vali Loss: 5.089 Vali Acc: 0.500 Test Loss: 5.089 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.973982810974121
Epoch: 15, Steps: 70 | Train Loss: 2.074 Vali Loss: 4.347 Vali Acc: 0.500 Test Loss: 4.347 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.890253782272339
Epoch: 16, Steps: 70 | Train Loss: 2.309 Vali Loss: 8.091 Vali Acc: 0.500 Test Loss: 8.091 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.786624908447266
Epoch: 17, Steps: 70 | Train Loss: 1.189 Vali Loss: 1.363 Vali Acc: 0.570 Test Loss: 1.363 Test Acc: 0.570
Validation loss decreased (-0.529989 --> -0.569986).  Saving model ...
Epoch: 18 cost time: 14.77771282196045
Epoch: 18, Steps: 70 | Train Loss: 1.513 Vali Loss: 9.160 Vali Acc: 0.500 Test Loss: 9.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.657966613769531
Epoch: 19, Steps: 70 | Train Loss: 1.477 Vali Loss: 3.906 Vali Acc: 0.500 Test Loss: 3.906 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.362735986709595
Epoch: 20, Steps: 70 | Train Loss: 0.625 Vali Loss: 4.535 Vali Acc: 0.460 Test Loss: 4.535 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 14.248969554901123
Epoch: 21, Steps: 70 | Train Loss: 0.625 Vali Loss: 4.466 Vali Acc: 0.490 Test Loss: 4.466 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 15.351840496063232
Epoch: 22, Steps: 70 | Train Loss: 0.803 Vali Loss: 4.639 Vali Acc: 0.520 Test Loss: 4.639 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 15.231055974960327
Epoch: 23, Steps: 70 | Train Loss: 0.618 Vali Loss: 6.040 Vali Acc: 0.460 Test Loss: 6.040 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.842993259429932
Epoch: 24, Steps: 70 | Train Loss: 0.277 Vali Loss: 3.956 Vali Acc: 0.540 Test Loss: 3.956 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.078014850616455
Epoch: 25, Steps: 70 | Train Loss: 0.383 Vali Loss: 3.025 Vali Acc: 0.560 Test Loss: 3.025 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 14.976039409637451
Epoch: 26, Steps: 70 | Train Loss: 0.164 Vali Loss: 4.503 Vali Acc: 0.470 Test Loss: 4.503 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 14.814449548721313
Epoch: 27, Steps: 70 | Train Loss: 0.101 Vali Loss: 3.995 Vali Acc: 0.550 Test Loss: 3.995 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2215602
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.82984185218811
Epoch: 1, Steps: 70 | Train Loss: 4.144 Vali Loss: 10.944 Vali Acc: 0.500 Test Loss: 10.944 Test Acc: 0.500
Validation loss decreased (inf --> -0.499891).  Saving model ...
Epoch: 2 cost time: 14.615039825439453
Epoch: 2, Steps: 70 | Train Loss: 6.337 Vali Loss: 3.366 Vali Acc: 0.500 Test Loss: 3.366 Test Acc: 0.500
Validation loss decreased (-0.499891 --> -0.499966).  Saving model ...
Epoch: 3 cost time: 14.702966690063477
Epoch: 3, Steps: 70 | Train Loss: 10.674 Vali Loss: 19.458 Vali Acc: 0.500 Test Loss: 19.458 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.967203140258789
Epoch: 4, Steps: 70 | Train Loss: 4.764 Vali Loss: 6.030 Vali Acc: 0.500 Test Loss: 6.030 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.02333688735962
Epoch: 5, Steps: 70 | Train Loss: 2.964 Vali Loss: 1.232 Vali Acc: 0.490 Test Loss: 1.232 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.343176364898682
Epoch: 6, Steps: 70 | Train Loss: 2.671 Vali Loss: 6.942 Vali Acc: 0.500 Test Loss: 6.942 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.643335819244385
Epoch: 7, Steps: 70 | Train Loss: 2.808 Vali Loss: 1.312 Vali Acc: 0.490 Test Loss: 1.312 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.496418237686157
Epoch: 8, Steps: 70 | Train Loss: 2.879 Vali Loss: 3.147 Vali Acc: 0.500 Test Loss: 3.147 Test Acc: 0.500
Validation loss decreased (-0.499966 --> -0.499969).  Saving model ...
Epoch: 9 cost time: 12.178508281707764
Epoch: 9, Steps: 70 | Train Loss: 2.594 Vali Loss: 8.151 Vali Acc: 0.500 Test Loss: 8.151 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.387572050094604
Epoch: 10, Steps: 70 | Train Loss: 3.651 Vali Loss: 5.326 Vali Acc: 0.500 Test Loss: 5.326 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.463859796524048
Epoch: 11, Steps: 70 | Train Loss: 2.583 Vali Loss: 5.370 Vali Acc: 0.500 Test Loss: 5.370 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.369741678237915
Epoch: 12, Steps: 70 | Train Loss: 3.376 Vali Loss: 1.343 Vali Acc: 0.630 Test Loss: 1.343 Test Acc: 0.630
Validation loss decreased (-0.499969 --> -0.629987).  Saving model ...
Epoch: 13 cost time: 13.866997241973877
Epoch: 13, Steps: 70 | Train Loss: 3.294 Vali Loss: 1.534 Vali Acc: 0.580 Test Loss: 1.534 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.036670207977295
Epoch: 14, Steps: 70 | Train Loss: 1.901 Vali Loss: 1.227 Vali Acc: 0.600 Test Loss: 1.227 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.518097400665283
Epoch: 15, Steps: 70 | Train Loss: 1.336 Vali Loss: 8.219 Vali Acc: 0.500 Test Loss: 8.219 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.569421529769897
Epoch: 16, Steps: 70 | Train Loss: 3.025 Vali Loss: 1.307 Vali Acc: 0.490 Test Loss: 1.307 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.53991436958313
Epoch: 17, Steps: 70 | Train Loss: 2.065 Vali Loss: 1.730 Vali Acc: 0.580 Test Loss: 1.730 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.974941730499268
Epoch: 18, Steps: 70 | Train Loss: 1.242 Vali Loss: 2.936 Vali Acc: 0.500 Test Loss: 2.936 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.278640747070312
Epoch: 19, Steps: 70 | Train Loss: 1.012 Vali Loss: 6.830 Vali Acc: 0.540 Test Loss: 6.830 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.406537532806396
Epoch: 20, Steps: 70 | Train Loss: 0.814 Vali Loss: 6.636 Vali Acc: 0.520 Test Loss: 6.636 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.46359896659851
Epoch: 21, Steps: 70 | Train Loss: 1.050 Vali Loss: 8.592 Vali Acc: 0.460 Test Loss: 8.592 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.948151111602783
Epoch: 22, Steps: 70 | Train Loss: 0.751 Vali Loss: 5.144 Vali Acc: 0.550 Test Loss: 5.144 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2187570
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.641652345657349
Epoch: 1, Steps: 70 | Train Loss: 3.905 Vali Loss: 6.356 Vali Acc: 0.500 Test Loss: 6.356 Test Acc: 0.500
Validation loss decreased (inf --> -0.499936).  Saving model ...
Epoch: 2 cost time: 14.62283444404602
Epoch: 2, Steps: 70 | Train Loss: 9.494 Vali Loss: 3.494 Vali Acc: 0.530 Test Loss: 3.494 Test Acc: 0.530
Validation loss decreased (-0.499936 --> -0.529965).  Saving model ...
Epoch: 3 cost time: 13.39104151725769
Epoch: 3, Steps: 70 | Train Loss: 6.051 Vali Loss: 3.116 Vali Acc: 0.500 Test Loss: 3.116 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.831059694290161
Epoch: 4, Steps: 70 | Train Loss: 3.356 Vali Loss: 3.031 Vali Acc: 0.500 Test Loss: 3.031 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.489484071731567
Epoch: 5, Steps: 70 | Train Loss: 4.312 Vali Loss: 7.198 Vali Acc: 0.500 Test Loss: 7.198 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.364556312561035
Epoch: 6, Steps: 70 | Train Loss: 4.584 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.538400650024414
Epoch: 7, Steps: 70 | Train Loss: 2.291 Vali Loss: 1.375 Vali Acc: 0.490 Test Loss: 1.375 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.909644842147827
Epoch: 8, Steps: 70 | Train Loss: 2.167 Vali Loss: 5.025 Vali Acc: 0.500 Test Loss: 5.025 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.786378622055054
Epoch: 9, Steps: 70 | Train Loss: 2.878 Vali Loss: 0.715 Vali Acc: 0.590 Test Loss: 0.715 Test Acc: 0.590
Validation loss decreased (-0.529965 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 14.829163551330566
Epoch: 10, Steps: 70 | Train Loss: 3.074 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.564133882522583
Epoch: 11, Steps: 70 | Train Loss: 1.963 Vali Loss: 2.668 Vali Acc: 0.500 Test Loss: 2.668 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.892016649246216
Epoch: 12, Steps: 70 | Train Loss: 1.972 Vali Loss: 4.790 Vali Acc: 0.500 Test Loss: 4.790 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.909801721572876
Epoch: 13, Steps: 70 | Train Loss: 2.138 Vali Loss: 6.785 Vali Acc: 0.500 Test Loss: 6.785 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.204495906829834
Epoch: 14, Steps: 70 | Train Loss: 3.836 Vali Loss: 3.549 Vali Acc: 0.500 Test Loss: 3.549 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.614448308944702
Epoch: 15, Steps: 70 | Train Loss: 3.129 Vali Loss: 2.376 Vali Acc: 0.530 Test Loss: 2.376 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.350845575332642
Epoch: 16, Steps: 70 | Train Loss: 2.383 Vali Loss: 2.115 Vali Acc: 0.580 Test Loss: 2.115 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.900635004043579
Epoch: 17, Steps: 70 | Train Loss: 2.223 Vali Loss: 0.873 Vali Acc: 0.600 Test Loss: 0.873 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 18 cost time: 13.691538333892822
Epoch: 18, Steps: 70 | Train Loss: 1.169 Vali Loss: 2.679 Vali Acc: 0.570 Test Loss: 2.679 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 14.150264739990234
Epoch: 19, Steps: 70 | Train Loss: 1.450 Vali Loss: 2.372 Vali Acc: 0.570 Test Loss: 2.372 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.301180362701416
Epoch: 20, Steps: 70 | Train Loss: 1.073 Vali Loss: 4.710 Vali Acc: 0.540 Test Loss: 4.710 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.88875126838684
Epoch: 21, Steps: 70 | Train Loss: 0.917 Vali Loss: 3.806 Vali Acc: 0.540 Test Loss: 3.806 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.966796875
Epoch: 22, Steps: 70 | Train Loss: 1.171 Vali Loss: 4.169 Vali Acc: 0.570 Test Loss: 4.169 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 14.583135604858398
Epoch: 23, Steps: 70 | Train Loss: 0.557 Vali Loss: 4.107 Vali Acc: 0.600 Test Loss: 4.107 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 14.727113246917725
Epoch: 24, Steps: 70 | Train Loss: 0.778 Vali Loss: 6.268 Vali Acc: 0.590 Test Loss: 6.268 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 14.549582958221436
Epoch: 25, Steps: 70 | Train Loss: 0.587 Vali Loss: 4.187 Vali Acc: 0.610 Test Loss: 4.187 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609958).  Saving model ...
Epoch: 26 cost time: 12.001964092254639
Epoch: 26, Steps: 70 | Train Loss: 0.367 Vali Loss: 10.345 Vali Acc: 0.560 Test Loss: 10.345 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 13.675163984298706
Epoch: 27, Steps: 70 | Train Loss: 0.709 Vali Loss: 4.261 Vali Acc: 0.530 Test Loss: 4.261 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 14.487046957015991
Epoch: 28, Steps: 70 | Train Loss: 0.226 Vali Loss: 9.851 Vali Acc: 0.500 Test Loss: 9.851 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 14.45297908782959
Epoch: 29, Steps: 70 | Train Loss: 0.241 Vali Loss: 5.781 Vali Acc: 0.520 Test Loss: 5.781 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 13.332773447036743
Epoch: 30, Steps: 70 | Train Loss: 0.269 Vali Loss: 8.931 Vali Acc: 0.560 Test Loss: 8.931 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 11.885193347930908
Epoch: 31, Steps: 70 | Train Loss: 0.273 Vali Loss: 15.657 Vali Acc: 0.470 Test Loss: 15.657 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 14.434701204299927
Epoch: 32, Steps: 70 | Train Loss: 0.263 Vali Loss: 8.757 Vali Acc: 0.520 Test Loss: 8.757 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 14.659054279327393
Epoch: 33, Steps: 70 | Train Loss: 0.386 Vali Loss: 14.657 Vali Acc: 0.490 Test Loss: 14.657 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 14.715338468551636
Epoch: 34, Steps: 70 | Train Loss: 0.665 Vali Loss: 11.594 Vali Acc: 0.540 Test Loss: 11.594 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 11.820774793624878
Epoch: 35, Steps: 70 | Train Loss: 0.387 Vali Loss: 19.181 Vali Acc: 0.460 Test Loss: 19.181 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2159538
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.681923389434814
Epoch: 1, Steps: 70 | Train Loss: 4.297 Vali Loss: 11.332 Vali Acc: 0.500 Test Loss: 11.332 Test Acc: 0.500
Validation loss decreased (inf --> -0.499887).  Saving model ...
Epoch: 2 cost time: 14.332047939300537
Epoch: 2, Steps: 70 | Train Loss: 2.300 Vali Loss: 5.885 Vali Acc: 0.500 Test Loss: 5.885 Test Acc: 0.500
Validation loss decreased (-0.499887 --> -0.499941).  Saving model ...
Epoch: 3 cost time: 12.136220216751099
Epoch: 3, Steps: 70 | Train Loss: 2.530 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
Validation loss decreased (-0.499941 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 12.865578651428223
Epoch: 4, Steps: 70 | Train Loss: 1.864 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.448214054107666
Epoch: 5, Steps: 70 | Train Loss: 3.160 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.430079221725464
Epoch: 6, Steps: 70 | Train Loss: 2.181 Vali Loss: 1.578 Vali Acc: 0.500 Test Loss: 1.578 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.388585567474365
Epoch: 7, Steps: 70 | Train Loss: 2.262 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499990).  Saving model ...
Epoch: 8 cost time: 11.719271183013916
Epoch: 8, Steps: 70 | Train Loss: 3.169 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499991).  Saving model ...
Epoch: 9 cost time: 13.731016635894775
Epoch: 9, Steps: 70 | Train Loss: 2.424 Vali Loss: 6.067 Vali Acc: 0.500 Test Loss: 6.067 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.388347625732422
Epoch: 10, Steps: 70 | Train Loss: 2.660 Vali Loss: 3.805 Vali Acc: 0.500 Test Loss: 3.805 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.546292543411255
Epoch: 11, Steps: 70 | Train Loss: 1.953 Vali Loss: 4.382 Vali Acc: 0.500 Test Loss: 4.382 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.148375988006592
Epoch: 12, Steps: 70 | Train Loss: 2.381 Vali Loss: 8.324 Vali Acc: 0.500 Test Loss: 8.324 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.817630052566528
Epoch: 13, Steps: 70 | Train Loss: 3.842 Vali Loss: 1.392 Vali Acc: 0.530 Test Loss: 1.392 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529986).  Saving model ...
Epoch: 14 cost time: 13.96750783920288
Epoch: 14, Steps: 70 | Train Loss: 0.984 Vali Loss: 1.458 Vali Acc: 0.640 Test Loss: 1.458 Test Acc: 0.640
Validation loss decreased (-0.529986 --> -0.639985).  Saving model ...
Epoch: 15 cost time: 14.447977781295776
Epoch: 15, Steps: 70 | Train Loss: 2.044 Vali Loss: 5.715 Vali Acc: 0.500 Test Loss: 5.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.574219226837158
Epoch: 16, Steps: 70 | Train Loss: 2.313 Vali Loss: 3.773 Vali Acc: 0.490 Test Loss: 3.773 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.628003597259521
Epoch: 17, Steps: 70 | Train Loss: 1.743 Vali Loss: 4.932 Vali Acc: 0.490 Test Loss: 4.932 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.96765685081482
Epoch: 18, Steps: 70 | Train Loss: 1.066 Vali Loss: 3.059 Vali Acc: 0.600 Test Loss: 3.059 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.320953130722046
Epoch: 19, Steps: 70 | Train Loss: 0.661 Vali Loss: 2.449 Vali Acc: 0.570 Test Loss: 2.449 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.48510456085205
Epoch: 20, Steps: 70 | Train Loss: 0.634 Vali Loss: 6.294 Vali Acc: 0.510 Test Loss: 6.294 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.622251510620117
Epoch: 21, Steps: 70 | Train Loss: 1.003 Vali Loss: 5.192 Vali Acc: 0.520 Test Loss: 5.192 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.753169298171997
Epoch: 22, Steps: 70 | Train Loss: 0.751 Vali Loss: 7.112 Vali Acc: 0.560 Test Loss: 7.112 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.927047967910767
Epoch: 23, Steps: 70 | Train Loss: 0.290 Vali Loss: 8.144 Vali Acc: 0.560 Test Loss: 8.144 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.247825145721436
Epoch: 24, Steps: 70 | Train Loss: 0.344 Vali Loss: 6.375 Vali Acc: 0.550 Test Loss: 6.375 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1415282
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.175408363342285
Epoch: 1, Steps: 70 | Train Loss: 1.887 Vali Loss: 2.822 Vali Acc: 0.490 Test Loss: 2.822 Test Acc: 0.490
Validation loss decreased (inf --> -0.489972).  Saving model ...
Epoch: 2 cost time: 12.522630453109741
Epoch: 2, Steps: 70 | Train Loss: 1.898 Vali Loss: 5.954 Vali Acc: 0.500 Test Loss: 5.954 Test Acc: 0.500
Validation loss decreased (-0.489972 --> -0.499940).  Saving model ...
Epoch: 3 cost time: 12.116131782531738
Epoch: 3, Steps: 70 | Train Loss: 1.913 Vali Loss: 1.718 Vali Acc: 0.500 Test Loss: 1.718 Test Acc: 0.500
Validation loss decreased (-0.499940 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 13.813571214675903
Epoch: 4, Steps: 70 | Train Loss: 3.517 Vali Loss: 8.260 Vali Acc: 0.500 Test Loss: 8.260 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.633309125900269
Epoch: 5, Steps: 70 | Train Loss: 4.156 Vali Loss: 2.673 Vali Acc: 0.500 Test Loss: 2.673 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.92493748664856
Epoch: 6, Steps: 70 | Train Loss: 2.580 Vali Loss: 2.079 Vali Acc: 0.500 Test Loss: 2.079 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.869079828262329
Epoch: 7, Steps: 70 | Train Loss: 1.981 Vali Loss: 0.910 Vali Acc: 0.480 Test Loss: 0.910 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.963425397872925
Epoch: 8, Steps: 70 | Train Loss: 3.356 Vali Loss: 8.903 Vali Acc: 0.500 Test Loss: 8.903 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.013333559036255
Epoch: 9, Steps: 70 | Train Loss: 2.517 Vali Loss: 1.034 Vali Acc: 0.430 Test Loss: 1.034 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.711621761322021
Epoch: 10, Steps: 70 | Train Loss: 2.129 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 11.482810258865356
Epoch: 11, Steps: 70 | Train Loss: 2.096 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 12 cost time: 13.707524538040161
Epoch: 12, Steps: 70 | Train Loss: 1.802 Vali Loss: 3.936 Vali Acc: 0.500 Test Loss: 3.936 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.914313316345215
Epoch: 13, Steps: 70 | Train Loss: 3.205 Vali Loss: 1.962 Vali Acc: 0.500 Test Loss: 1.962 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.139104127883911
Epoch: 14, Steps: 70 | Train Loss: 2.372 Vali Loss: 4.727 Vali Acc: 0.500 Test Loss: 4.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.498568773269653
Epoch: 15, Steps: 70 | Train Loss: 1.752 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.499986 --> -0.509993).  Saving model ...
Epoch: 16 cost time: 13.966308116912842
Epoch: 16, Steps: 70 | Train Loss: 1.668 Vali Loss: 3.430 Vali Acc: 0.500 Test Loss: 3.430 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.390801191329956
Epoch: 17, Steps: 70 | Train Loss: 2.477 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.229492902755737
Epoch: 18, Steps: 70 | Train Loss: 1.434 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.33031702041626
Epoch: 19, Steps: 70 | Train Loss: 1.294 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.71704626083374
Epoch: 20, Steps: 70 | Train Loss: 1.209 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.994970321655273
Epoch: 21, Steps: 70 | Train Loss: 1.137 Vali Loss: 0.730 Vali Acc: 0.570 Test Loss: 0.730 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 22 cost time: 13.769791603088379
Epoch: 22, Steps: 70 | Train Loss: 1.067 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.4815673828125
Epoch: 23, Steps: 70 | Train Loss: 1.202 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.826419353485107
Epoch: 24, Steps: 70 | Train Loss: 1.265 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.757002830505371
Epoch: 25, Steps: 70 | Train Loss: 0.934 Vali Loss: 1.046 Vali Acc: 0.530 Test Loss: 1.046 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.9139404296875
Epoch: 26, Steps: 70 | Train Loss: 1.052 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.413820505142212
Epoch: 27, Steps: 70 | Train Loss: 0.669 Vali Loss: 1.523 Vali Acc: 0.500 Test Loss: 1.523 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.00204086303711
Epoch: 28, Steps: 70 | Train Loss: 0.685 Vali Loss: 0.895 Vali Acc: 0.570 Test Loss: 0.895 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 14.049400329589844
Epoch: 29, Steps: 70 | Train Loss: 0.594 Vali Loss: 1.992 Vali Acc: 0.520 Test Loss: 1.992 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 13.660520553588867
Epoch: 30, Steps: 70 | Train Loss: 0.687 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 11.425904035568237
Epoch: 31, Steps: 70 | Train Loss: 0.423 Vali Loss: 1.640 Vali Acc: 0.510 Test Loss: 1.640 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1401266
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.749135971069336
Epoch: 1, Steps: 70 | Train Loss: 1.844 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 12.283529996871948
Epoch: 2, Steps: 70 | Train Loss: 3.047 Vali Loss: 2.224 Vali Acc: 0.500 Test Loss: 2.224 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.750904083251953
Epoch: 3, Steps: 70 | Train Loss: 2.962 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.416780233383179
Epoch: 4, Steps: 70 | Train Loss: 2.540 Vali Loss: 4.057 Vali Acc: 0.500 Test Loss: 4.057 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.686074018478394
Epoch: 5, Steps: 70 | Train Loss: 1.821 Vali Loss: 5.900 Vali Acc: 0.500 Test Loss: 5.900 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.809897422790527
Epoch: 6, Steps: 70 | Train Loss: 2.787 Vali Loss: 2.453 Vali Acc: 0.500 Test Loss: 2.453 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.321285724639893
Epoch: 7, Steps: 70 | Train Loss: 1.794 Vali Loss: 4.427 Vali Acc: 0.500 Test Loss: 4.427 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.593679904937744
Epoch: 8, Steps: 70 | Train Loss: 1.832 Vali Loss: 1.203 Vali Acc: 0.530 Test Loss: 1.203 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529988).  Saving model ...
Epoch: 9 cost time: 13.660459041595459
Epoch: 9, Steps: 70 | Train Loss: 2.551 Vali Loss: 1.387 Vali Acc: 0.580 Test Loss: 1.387 Test Acc: 0.580
Validation loss decreased (-0.529988 --> -0.579986).  Saving model ...
Epoch: 10 cost time: 12.98283076286316
Epoch: 10, Steps: 70 | Train Loss: 1.706 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.286123514175415
Epoch: 11, Steps: 70 | Train Loss: 2.330 Vali Loss: 2.625 Vali Acc: 0.560 Test Loss: 2.625 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.718498945236206
Epoch: 12, Steps: 70 | Train Loss: 2.717 Vali Loss: 5.888 Vali Acc: 0.570 Test Loss: 5.888 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.461297035217285
Epoch: 13, Steps: 70 | Train Loss: 2.063 Vali Loss: 6.839 Vali Acc: 0.500 Test Loss: 6.839 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.506552934646606
Epoch: 14, Steps: 70 | Train Loss: 1.591 Vali Loss: 2.770 Vali Acc: 0.640 Test Loss: 2.770 Test Acc: 0.640
Validation loss decreased (-0.579986 --> -0.639972).  Saving model ...
Epoch: 15 cost time: 11.413330078125
Epoch: 15, Steps: 70 | Train Loss: 1.370 Vali Loss: 3.378 Vali Acc: 0.520 Test Loss: 3.378 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.578379392623901
Epoch: 16, Steps: 70 | Train Loss: 1.872 Vali Loss: 4.698 Vali Acc: 0.520 Test Loss: 4.698 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.551879405975342
Epoch: 17, Steps: 70 | Train Loss: 1.300 Vali Loss: 3.894 Vali Acc: 0.560 Test Loss: 3.894 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.246530532836914
Epoch: 18, Steps: 70 | Train Loss: 0.685 Vali Loss: 8.059 Vali Acc: 0.540 Test Loss: 8.059 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.31643033027649
Epoch: 19, Steps: 70 | Train Loss: 0.603 Vali Loss: 5.070 Vali Acc: 0.530 Test Loss: 5.070 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 13.723336696624756
Epoch: 20, Steps: 70 | Train Loss: 0.583 Vali Loss: 8.026 Vali Acc: 0.530 Test Loss: 8.026 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 13.680739402770996
Epoch: 21, Steps: 70 | Train Loss: 0.754 Vali Loss: 3.925 Vali Acc: 0.540 Test Loss: 3.925 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 13.25204849243164
Epoch: 22, Steps: 70 | Train Loss: 0.761 Vali Loss: 6.869 Vali Acc: 0.530 Test Loss: 6.869 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.360231399536133
Epoch: 23, Steps: 70 | Train Loss: 0.336 Vali Loss: 10.072 Vali Acc: 0.530 Test Loss: 10.072 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.676792621612549
Epoch: 24, Steps: 70 | Train Loss: 0.481 Vali Loss: 6.045 Vali Acc: 0.560 Test Loss: 6.045 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1387250
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.753186464309692
Epoch: 1, Steps: 70 | Train Loss: 1.746 Vali Loss: 7.319 Vali Acc: 0.500 Test Loss: 7.319 Test Acc: 0.500
Validation loss decreased (inf --> -0.499927).  Saving model ...
Epoch: 2 cost time: 11.991554975509644
Epoch: 2, Steps: 70 | Train Loss: 3.578 Vali Loss: 6.263 Vali Acc: 0.500 Test Loss: 6.263 Test Acc: 0.500
Validation loss decreased (-0.499927 --> -0.499937).  Saving model ...
Epoch: 3 cost time: 13.299851417541504
Epoch: 3, Steps: 70 | Train Loss: 3.096 Vali Loss: 7.070 Vali Acc: 0.500 Test Loss: 7.070 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.319657802581787
Epoch: 4, Steps: 70 | Train Loss: 2.980 Vali Loss: 2.116 Vali Acc: 0.500 Test Loss: 2.116 Test Acc: 0.500
Validation loss decreased (-0.499937 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 11.485206604003906
Epoch: 5, Steps: 70 | Train Loss: 2.945 Vali Loss: 6.352 Vali Acc: 0.500 Test Loss: 6.352 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.544788122177124
Epoch: 6, Steps: 70 | Train Loss: 2.867 Vali Loss: 2.510 Vali Acc: 0.500 Test Loss: 2.510 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.272580862045288
Epoch: 7, Steps: 70 | Train Loss: 2.862 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 13.479987144470215
Epoch: 8, Steps: 70 | Train Loss: 1.419 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 12.040745973587036
Epoch: 9, Steps: 70 | Train Loss: 1.634 Vali Loss: 1.224 Vali Acc: 0.510 Test Loss: 1.224 Test Acc: 0.510
Validation loss decreased (-0.499987 --> -0.509988).  Saving model ...
Epoch: 10 cost time: 11.721459865570068
Epoch: 10, Steps: 70 | Train Loss: 2.719 Vali Loss: 4.558 Vali Acc: 0.500 Test Loss: 4.558 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.404467344284058
Epoch: 11, Steps: 70 | Train Loss: 2.263 Vali Loss: 6.074 Vali Acc: 0.500 Test Loss: 6.074 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.136157989501953
Epoch: 12, Steps: 70 | Train Loss: 2.427 Vali Loss: 3.946 Vali Acc: 0.500 Test Loss: 3.946 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.187119960784912
Epoch: 13, Steps: 70 | Train Loss: 2.129 Vali Loss: 2.356 Vali Acc: 0.550 Test Loss: 2.356 Test Acc: 0.550
Validation loss decreased (-0.509988 --> -0.549976).  Saving model ...
Epoch: 14 cost time: 10.898629903793335
Epoch: 14, Steps: 70 | Train Loss: 0.978 Vali Loss: 1.677 Vali Acc: 0.570 Test Loss: 1.677 Test Acc: 0.570
Validation loss decreased (-0.549976 --> -0.569983).  Saving model ...
Epoch: 15 cost time: 9.193474769592285
Epoch: 15, Steps: 70 | Train Loss: 1.908 Vali Loss: 2.080 Vali Acc: 0.530 Test Loss: 2.080 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.218604803085327
Epoch: 16, Steps: 70 | Train Loss: 1.822 Vali Loss: 4.659 Vali Acc: 0.550 Test Loss: 4.659 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.787911891937256
Epoch: 17, Steps: 70 | Train Loss: 1.549 Vali Loss: 6.034 Vali Acc: 0.480 Test Loss: 6.034 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.05053424835205
Epoch: 18, Steps: 70 | Train Loss: 1.737 Vali Loss: 6.444 Vali Acc: 0.540 Test Loss: 6.444 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.552979230880737
Epoch: 19, Steps: 70 | Train Loss: 0.691 Vali Loss: 5.495 Vali Acc: 0.520 Test Loss: 5.495 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.896692037582397
Epoch: 20, Steps: 70 | Train Loss: 0.582 Vali Loss: 5.437 Vali Acc: 0.580 Test Loss: 5.437 Test Acc: 0.580
Validation loss decreased (-0.569983 --> -0.579946).  Saving model ...
Epoch: 21 cost time: 12.825544357299805
Epoch: 21, Steps: 70 | Train Loss: 0.767 Vali Loss: 5.442 Vali Acc: 0.500 Test Loss: 5.442 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.886598587036133
Epoch: 22, Steps: 70 | Train Loss: 1.569 Vali Loss: 4.757 Vali Acc: 0.540 Test Loss: 4.757 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.942173957824707
Epoch: 23, Steps: 70 | Train Loss: 0.650 Vali Loss: 4.240 Vali Acc: 0.520 Test Loss: 4.240 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.871205806732178
Epoch: 24, Steps: 70 | Train Loss: 0.303 Vali Loss: 5.452 Vali Acc: 0.530 Test Loss: 5.452 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.602221012115479
Epoch: 25, Steps: 70 | Train Loss: 0.119 Vali Loss: 7.581 Vali Acc: 0.510 Test Loss: 7.581 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 12.744003772735596
Epoch: 26, Steps: 70 | Train Loss: 0.145 Vali Loss: 8.986 Vali Acc: 0.500 Test Loss: 8.986 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.713451862335205
Epoch: 27, Steps: 70 | Train Loss: 0.224 Vali Loss: 8.173 Vali Acc: 0.540 Test Loss: 8.173 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.675112009048462
Epoch: 28, Steps: 70 | Train Loss: 0.405 Vali Loss: 9.536 Vali Acc: 0.560 Test Loss: 9.536 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.653074264526367
Epoch: 29, Steps: 70 | Train Loss: 0.253 Vali Loss: 8.669 Vali Acc: 0.500 Test Loss: 8.669 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 12.895785570144653
Epoch: 30, Steps: 70 | Train Loss: 0.091 Vali Loss: 9.157 Vali Acc: 0.520 Test Loss: 9.157 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1373234
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.960484981536865
Epoch: 1, Steps: 70 | Train Loss: 1.952 Vali Loss: 4.191 Vali Acc: 0.500 Test Loss: 4.191 Test Acc: 0.500
Validation loss decreased (inf --> -0.499958).  Saving model ...
Epoch: 2 cost time: 12.130140781402588
Epoch: 2, Steps: 70 | Train Loss: 2.427 Vali Loss: 6.155 Vali Acc: 0.500 Test Loss: 6.155 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.005690574645996
Epoch: 3, Steps: 70 | Train Loss: 4.315 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
Validation loss decreased (-0.499958 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 11.181833267211914
Epoch: 4, Steps: 70 | Train Loss: 2.363 Vali Loss: 3.802 Vali Acc: 0.500 Test Loss: 3.802 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.218642950057983
Epoch: 5, Steps: 70 | Train Loss: 2.706 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.25124716758728
Epoch: 6, Steps: 70 | Train Loss: 3.668 Vali Loss: 0.894 Vali Acc: 0.420 Test Loss: 0.894 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.19615125656128
Epoch: 7, Steps: 70 | Train Loss: 3.132 Vali Loss: 2.051 Vali Acc: 0.500 Test Loss: 2.051 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.185624361038208
Epoch: 8, Steps: 70 | Train Loss: 2.366 Vali Loss: 1.750 Vali Acc: 0.500 Test Loss: 1.750 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.069720983505249
Epoch: 9, Steps: 70 | Train Loss: 1.858 Vali Loss: 2.072 Vali Acc: 0.500 Test Loss: 2.072 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.834102869033813
Epoch: 10, Steps: 70 | Train Loss: 2.642 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.250785112380981
Epoch: 11, Steps: 70 | Train Loss: 1.249 Vali Loss: 4.141 Vali Acc: 0.470 Test Loss: 4.141 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.02639102935791
Epoch: 12, Steps: 70 | Train Loss: 2.632 Vali Loss: 1.187 Vali Acc: 0.510 Test Loss: 1.187 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509988).  Saving model ...
Epoch: 13 cost time: 12.083755493164062
Epoch: 13, Steps: 70 | Train Loss: 2.524 Vali Loss: 1.686 Vali Acc: 0.510 Test Loss: 1.686 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.259709596633911
Epoch: 14, Steps: 70 | Train Loss: 0.943 Vali Loss: 2.758 Vali Acc: 0.530 Test Loss: 2.758 Test Acc: 0.530
Validation loss decreased (-0.509988 --> -0.529972).  Saving model ...
Epoch: 15 cost time: 12.209246397018433
Epoch: 15, Steps: 70 | Train Loss: 1.423 Vali Loss: 3.580 Vali Acc: 0.500 Test Loss: 3.580 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.103606939315796
Epoch: 16, Steps: 70 | Train Loss: 1.822 Vali Loss: 3.126 Vali Acc: 0.540 Test Loss: 3.126 Test Acc: 0.540
Validation loss decreased (-0.529972 --> -0.539969).  Saving model ...
Epoch: 17 cost time: 11.017481088638306
Epoch: 17, Steps: 70 | Train Loss: 1.132 Vali Loss: 3.847 Vali Acc: 0.600 Test Loss: 3.847 Test Acc: 0.600
Validation loss decreased (-0.539969 --> -0.599962).  Saving model ...
Epoch: 18 cost time: 11.01380729675293
Epoch: 18, Steps: 70 | Train Loss: 1.244 Vali Loss: 6.458 Vali Acc: 0.540 Test Loss: 6.458 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.18224811553955
Epoch: 19, Steps: 70 | Train Loss: 0.469 Vali Loss: 7.904 Vali Acc: 0.540 Test Loss: 7.904 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.212260007858276
Epoch: 20, Steps: 70 | Train Loss: 0.637 Vali Loss: 7.371 Vali Acc: 0.520 Test Loss: 7.371 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.220641613006592
Epoch: 21, Steps: 70 | Train Loss: 0.607 Vali Loss: 7.602 Vali Acc: 0.550 Test Loss: 7.602 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.244178056716919
Epoch: 22, Steps: 70 | Train Loss: 0.485 Vali Loss: 6.567 Vali Acc: 0.570 Test Loss: 6.567 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.377193689346313
Epoch: 23, Steps: 70 | Train Loss: 0.243 Vali Loss: 8.856 Vali Acc: 0.540 Test Loss: 8.856 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.911106586456299
Epoch: 24, Steps: 70 | Train Loss: 0.513 Vali Loss: 5.803 Vali Acc: 0.550 Test Loss: 5.803 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.896928787231445
Epoch: 25, Steps: 70 | Train Loss: 0.472 Vali Loss: 9.368 Vali Acc: 0.470 Test Loss: 9.368 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.999200105667114
Epoch: 26, Steps: 70 | Train Loss: 0.172 Vali Loss: 7.071 Vali Acc: 0.530 Test Loss: 7.071 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 12.352765560150146
Epoch: 27, Steps: 70 | Train Loss: 0.526 Vali Loss: 8.174 Vali Acc: 0.520 Test Loss: 8.174 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1182322
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.431029796600342
Epoch: 1, Steps: 70 | Train Loss: 1.928 Vali Loss: 1.883 Vali Acc: 0.490 Test Loss: 1.883 Test Acc: 0.490
Validation loss decreased (inf --> -0.489981).  Saving model ...
Epoch: 2 cost time: 11.530358791351318
Epoch: 2, Steps: 70 | Train Loss: 3.275 Vali Loss: 2.428 Vali Acc: 0.470 Test Loss: 2.428 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.079893112182617
Epoch: 3, Steps: 70 | Train Loss: 4.245 Vali Loss: 6.002 Vali Acc: 0.500 Test Loss: 6.002 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499940).  Saving model ...
Epoch: 4 cost time: 12.008743524551392
Epoch: 4, Steps: 70 | Train Loss: 2.853 Vali Loss: 2.701 Vali Acc: 0.500 Test Loss: 2.701 Test Acc: 0.500
Validation loss decreased (-0.499940 --> -0.499973).  Saving model ...
Epoch: 5 cost time: 12.22786259651184
Epoch: 5, Steps: 70 | Train Loss: 2.229 Vali Loss: 2.158 Vali Acc: 0.500 Test Loss: 2.158 Test Acc: 0.500
Validation loss decreased (-0.499973 --> -0.499978).  Saving model ...
Epoch: 6 cost time: 9.939806461334229
Epoch: 6, Steps: 70 | Train Loss: 2.925 Vali Loss: 1.516 Vali Acc: 0.520 Test Loss: 1.516 Test Acc: 0.520
Validation loss decreased (-0.499978 --> -0.519985).  Saving model ...
Epoch: 7 cost time: 11.85683274269104
Epoch: 7, Steps: 70 | Train Loss: 3.422 Vali Loss: 1.917 Vali Acc: 0.570 Test Loss: 1.917 Test Acc: 0.570
Validation loss decreased (-0.519985 --> -0.569981).  Saving model ...
Epoch: 8 cost time: 12.116557121276855
Epoch: 8, Steps: 70 | Train Loss: 3.134 Vali Loss: 5.530 Vali Acc: 0.500 Test Loss: 5.530 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.496415615081787
Epoch: 9, Steps: 70 | Train Loss: 2.673 Vali Loss: 8.805 Vali Acc: 0.500 Test Loss: 8.805 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.351144790649414
Epoch: 10, Steps: 70 | Train Loss: 3.417 Vali Loss: 8.358 Vali Acc: 0.480 Test Loss: 8.358 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.076685428619385
Epoch: 11, Steps: 70 | Train Loss: 4.129 Vali Loss: 3.611 Vali Acc: 0.560 Test Loss: 3.611 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.02504587173462
Epoch: 12, Steps: 70 | Train Loss: 2.027 Vali Loss: 2.771 Vali Acc: 0.520 Test Loss: 2.771 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.014246940612793
Epoch: 13, Steps: 70 | Train Loss: 1.408 Vali Loss: 4.633 Vali Acc: 0.520 Test Loss: 4.633 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.784849405288696
Epoch: 14, Steps: 70 | Train Loss: 0.758 Vali Loss: 3.540 Vali Acc: 0.560 Test Loss: 3.540 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.123579263687134
Epoch: 15, Steps: 70 | Train Loss: 0.567 Vali Loss: 5.161 Vali Acc: 0.480 Test Loss: 5.161 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.643552541732788
Epoch: 16, Steps: 70 | Train Loss: 1.042 Vali Loss: 3.286 Vali Acc: 0.600 Test Loss: 3.286 Test Acc: 0.600
Validation loss decreased (-0.569981 --> -0.599967).  Saving model ...
Epoch: 17 cost time: 10.287007331848145
Epoch: 17, Steps: 70 | Train Loss: 1.310 Vali Loss: 7.104 Vali Acc: 0.540 Test Loss: 7.104 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.989206314086914
Epoch: 18, Steps: 70 | Train Loss: 0.478 Vali Loss: 5.252 Vali Acc: 0.500 Test Loss: 5.252 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.232343673706055
Epoch: 19, Steps: 70 | Train Loss: 0.950 Vali Loss: 6.528 Vali Acc: 0.480 Test Loss: 6.528 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.019409656524658
Epoch: 20, Steps: 70 | Train Loss: 0.645 Vali Loss: 7.873 Vali Acc: 0.490 Test Loss: 7.873 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.008001565933228
Epoch: 21, Steps: 70 | Train Loss: 0.174 Vali Loss: 8.441 Vali Acc: 0.500 Test Loss: 8.441 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.459574460983276
Epoch: 22, Steps: 70 | Train Loss: 0.558 Vali Loss: 6.520 Vali Acc: 0.530 Test Loss: 6.520 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.564872026443481
Epoch: 23, Steps: 70 | Train Loss: 0.346 Vali Loss: 8.066 Vali Acc: 0.530 Test Loss: 8.066 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.014579057693481
Epoch: 24, Steps: 70 | Train Loss: 0.164 Vali Loss: 11.748 Vali Acc: 0.550 Test Loss: 11.748 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 10.69989538192749
Epoch: 25, Steps: 70 | Train Loss: 0.528 Vali Loss: 7.964 Vali Acc: 0.510 Test Loss: 7.964 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.6408212184906
Epoch: 26, Steps: 70 | Train Loss: 0.120 Vali Loss: 7.806 Vali Acc: 0.520 Test Loss: 7.806 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1168306
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.05784273147583
Epoch: 1, Steps: 70 | Train Loss: 3.716 Vali Loss: 2.698 Vali Acc: 0.390 Test Loss: 2.698 Test Acc: 0.390
Validation loss decreased (inf --> -0.389973).  Saving model ...
Epoch: 2 cost time: 10.178980827331543
Epoch: 2, Steps: 70 | Train Loss: 2.239 Vali Loss: 6.109 Vali Acc: 0.500 Test Loss: 6.109 Test Acc: 0.500
Validation loss decreased (-0.389973 --> -0.499939).  Saving model ...
Epoch: 3 cost time: 11.371732234954834
Epoch: 3, Steps: 70 | Train Loss: 3.819 Vali Loss: 3.981 Vali Acc: 0.500 Test Loss: 3.981 Test Acc: 0.500
Validation loss decreased (-0.499939 --> -0.499960).  Saving model ...
Epoch: 4 cost time: 9.535176277160645
Epoch: 4, Steps: 70 | Train Loss: 3.329 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
Validation loss decreased (-0.499960 --> -0.499991).  Saving model ...
Epoch: 5 cost time: 11.418718338012695
Epoch: 5, Steps: 70 | Train Loss: 2.698 Vali Loss: 2.095 Vali Acc: 0.500 Test Loss: 2.095 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.167730331420898
Epoch: 6, Steps: 70 | Train Loss: 2.234 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.499607801437378
Epoch: 7, Steps: 70 | Train Loss: 2.105 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519989).  Saving model ...
Epoch: 8 cost time: 11.44986629486084
Epoch: 8, Steps: 70 | Train Loss: 2.534 Vali Loss: 3.171 Vali Acc: 0.510 Test Loss: 3.171 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.474482774734497
Epoch: 9, Steps: 70 | Train Loss: 2.816 Vali Loss: 3.689 Vali Acc: 0.500 Test Loss: 3.689 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.336292505264282
Epoch: 10, Steps: 70 | Train Loss: 1.788 Vali Loss: 4.111 Vali Acc: 0.570 Test Loss: 4.111 Test Acc: 0.570
Validation loss decreased (-0.519989 --> -0.569959).  Saving model ...
Epoch: 11 cost time: 11.043723821640015
Epoch: 11, Steps: 70 | Train Loss: 1.457 Vali Loss: 8.685 Vali Acc: 0.500 Test Loss: 8.685 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.313861608505249
Epoch: 12, Steps: 70 | Train Loss: 2.609 Vali Loss: 3.209 Vali Acc: 0.550 Test Loss: 3.209 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.309222221374512
Epoch: 13, Steps: 70 | Train Loss: 2.393 Vali Loss: 9.521 Vali Acc: 0.500 Test Loss: 9.521 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.445268630981445
Epoch: 14, Steps: 70 | Train Loss: 1.356 Vali Loss: 7.806 Vali Acc: 0.530 Test Loss: 7.806 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.314036130905151
Epoch: 15, Steps: 70 | Train Loss: 0.972 Vali Loss: 16.569 Vali Acc: 0.490 Test Loss: 16.569 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.58504343032837
Epoch: 16, Steps: 70 | Train Loss: 0.648 Vali Loss: 9.416 Vali Acc: 0.480 Test Loss: 9.416 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.388364315032959
Epoch: 17, Steps: 70 | Train Loss: 0.426 Vali Loss: 9.722 Vali Acc: 0.440 Test Loss: 9.722 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.19577169418335
Epoch: 18, Steps: 70 | Train Loss: 0.372 Vali Loss: 12.097 Vali Acc: 0.470 Test Loss: 12.097 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.688843965530396
Epoch: 19, Steps: 70 | Train Loss: 0.608 Vali Loss: 9.648 Vali Acc: 0.470 Test Loss: 9.648 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.357728958129883
Epoch: 20, Steps: 70 | Train Loss: 0.364 Vali Loss: 15.877 Vali Acc: 0.470 Test Loss: 15.877 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1154290
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.084928512573242
Epoch: 1, Steps: 70 | Train Loss: 2.128 Vali Loss: 11.158 Vali Acc: 0.500 Test Loss: 11.158 Test Acc: 0.500
Validation loss decreased (inf --> -0.499888).  Saving model ...
Epoch: 2 cost time: 10.973965644836426
Epoch: 2, Steps: 70 | Train Loss: 4.938 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
Validation loss decreased (-0.499888 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 9.134758234024048
Epoch: 3, Steps: 70 | Train Loss: 2.973 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 10.853577375411987
Epoch: 4, Steps: 70 | Train Loss: 4.442 Vali Loss: 3.228 Vali Acc: 0.500 Test Loss: 3.228 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.56199836730957
Epoch: 5, Steps: 70 | Train Loss: 1.983 Vali Loss: 3.974 Vali Acc: 0.500 Test Loss: 3.974 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.895034790039062
Epoch: 6, Steps: 70 | Train Loss: 3.133 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.499989 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 11.091091394424438
Epoch: 7, Steps: 70 | Train Loss: 2.463 Vali Loss: 9.218 Vali Acc: 0.500 Test Loss: 9.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.371579647064209
Epoch: 8, Steps: 70 | Train Loss: 2.206 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.918613910675049
Epoch: 9, Steps: 70 | Train Loss: 2.383 Vali Loss: 3.198 Vali Acc: 0.500 Test Loss: 3.198 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.095716714859009
Epoch: 10, Steps: 70 | Train Loss: 2.478 Vali Loss: 6.265 Vali Acc: 0.500 Test Loss: 6.265 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.640052556991577
Epoch: 11, Steps: 70 | Train Loss: 2.197 Vali Loss: 4.219 Vali Acc: 0.500 Test Loss: 4.219 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.061758756637573
Epoch: 12, Steps: 70 | Train Loss: 3.915 Vali Loss: 3.507 Vali Acc: 0.470 Test Loss: 3.507 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.686598777770996
Epoch: 13, Steps: 70 | Train Loss: 1.475 Vali Loss: 2.254 Vali Acc: 0.550 Test Loss: 2.254 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.94277048110962
Epoch: 14, Steps: 70 | Train Loss: 1.362 Vali Loss: 6.436 Vali Acc: 0.520 Test Loss: 6.436 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.107541561126709
Epoch: 15, Steps: 70 | Train Loss: 2.008 Vali Loss: 3.554 Vali Acc: 0.470 Test Loss: 3.554 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.66860294342041
Epoch: 16, Steps: 70 | Train Loss: 1.271 Vali Loss: 4.826 Vali Acc: 0.500 Test Loss: 4.826 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1140274
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.353745937347412
Epoch: 1, Steps: 70 | Train Loss: 1.822 Vali Loss: 2.209 Vali Acc: 0.530 Test Loss: 2.209 Test Acc: 0.530
Validation loss decreased (inf --> -0.529978).  Saving model ...
Epoch: 2 cost time: 9.89861536026001
Epoch: 2, Steps: 70 | Train Loss: 4.618 Vali Loss: 4.937 Vali Acc: 0.510 Test Loss: 4.937 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.343426942825317
Epoch: 3, Steps: 70 | Train Loss: 3.169 Vali Loss: 10.398 Vali Acc: 0.500 Test Loss: 10.398 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.737423181533813
Epoch: 4, Steps: 70 | Train Loss: 4.425 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.806379318237305
Epoch: 5, Steps: 70 | Train Loss: 3.400 Vali Loss: 4.446 Vali Acc: 0.500 Test Loss: 4.446 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.887508392333984
Epoch: 6, Steps: 70 | Train Loss: 3.458 Vali Loss: 1.968 Vali Acc: 0.500 Test Loss: 1.968 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.022875785827637
Epoch: 7, Steps: 70 | Train Loss: 4.928 Vali Loss: 2.103 Vali Acc: 0.500 Test Loss: 2.103 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.275864124298096
Epoch: 8, Steps: 70 | Train Loss: 2.527 Vali Loss: 2.262 Vali Acc: 0.500 Test Loss: 2.262 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.899562120437622
Epoch: 9, Steps: 70 | Train Loss: 2.543 Vali Loss: 1.471 Vali Acc: 0.530 Test Loss: 1.471 Test Acc: 0.530
Validation loss decreased (-0.529978 --> -0.529985).  Saving model ...
Epoch: 10 cost time: 11.682196140289307
Epoch: 10, Steps: 70 | Train Loss: 4.776 Vali Loss: 2.707 Vali Acc: 0.580 Test Loss: 2.707 Test Acc: 0.580
Validation loss decreased (-0.529985 --> -0.579973).  Saving model ...
Epoch: 11 cost time: 11.758558750152588
Epoch: 11, Steps: 70 | Train Loss: 2.298 Vali Loss: 3.859 Vali Acc: 0.500 Test Loss: 3.859 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.917092561721802
Epoch: 12, Steps: 70 | Train Loss: 2.750 Vali Loss: 7.126 Vali Acc: 0.550 Test Loss: 7.126 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.995792388916016
Epoch: 13, Steps: 70 | Train Loss: 1.496 Vali Loss: 3.531 Vali Acc: 0.590 Test Loss: 3.531 Test Acc: 0.590
Validation loss decreased (-0.579973 --> -0.589965).  Saving model ...
Epoch: 14 cost time: 11.825130939483643
Epoch: 14, Steps: 70 | Train Loss: 1.263 Vali Loss: 2.795 Vali Acc: 0.580 Test Loss: 2.795 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.532606363296509
Epoch: 15, Steps: 70 | Train Loss: 0.804 Vali Loss: 11.752 Vali Acc: 0.500 Test Loss: 11.752 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.715221405029297
Epoch: 16, Steps: 70 | Train Loss: 1.965 Vali Loss: 5.073 Vali Acc: 0.550 Test Loss: 5.073 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.830289840698242
Epoch: 17, Steps: 70 | Train Loss: 0.903 Vali Loss: 7.942 Vali Acc: 0.530 Test Loss: 7.942 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.971176385879517
Epoch: 18, Steps: 70 | Train Loss: 0.660 Vali Loss: 11.631 Vali Acc: 0.500 Test Loss: 11.631 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.067707300186157
Epoch: 19, Steps: 70 | Train Loss: 0.581 Vali Loss: 6.894 Vali Acc: 0.580 Test Loss: 6.894 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.835144758224487
Epoch: 20, Steps: 70 | Train Loss: 0.636 Vali Loss: 8.045 Vali Acc: 0.600 Test Loss: 8.045 Test Acc: 0.600
Validation loss decreased (-0.589965 --> -0.599920).  Saving model ...
Epoch: 21 cost time: 12.006561994552612
Epoch: 21, Steps: 70 | Train Loss: 0.487 Vali Loss: 7.693 Vali Acc: 0.610 Test Loss: 7.693 Test Acc: 0.610
Validation loss decreased (-0.599920 --> -0.609923).  Saving model ...
Epoch: 22 cost time: 11.827051877975464
Epoch: 22, Steps: 70 | Train Loss: 0.137 Vali Loss: 7.034 Vali Acc: 0.600 Test Loss: 7.034 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.0039644241333
Epoch: 23, Steps: 70 | Train Loss: 0.282 Vali Loss: 6.786 Vali Acc: 0.580 Test Loss: 6.786 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.218950510025024
Epoch: 24, Steps: 70 | Train Loss: 0.392 Vali Loss: 9.397 Vali Acc: 0.560 Test Loss: 9.397 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.652391910552979
Epoch: 25, Steps: 70 | Train Loss: 0.512 Vali Loss: 9.283 Vali Acc: 0.570 Test Loss: 9.283 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.668344974517822
Epoch: 26, Steps: 70 | Train Loss: 0.387 Vali Loss: 8.716 Vali Acc: 0.520 Test Loss: 8.716 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.712913513183594
Epoch: 27, Steps: 70 | Train Loss: 0.125 Vali Loss: 9.029 Vali Acc: 0.600 Test Loss: 9.029 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.959425449371338
Epoch: 28, Steps: 70 | Train Loss: 0.298 Vali Loss: 9.208 Vali Acc: 0.600 Test Loss: 9.208 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.95124888420105
Epoch: 29, Steps: 70 | Train Loss: 0.305 Vali Loss: 7.513 Vali Acc: 0.610 Test Loss: 7.513 Test Acc: 0.610
Validation loss decreased (-0.609923 --> -0.609925).  Saving model ...
Epoch: 30 cost time: 11.62501859664917
Epoch: 30, Steps: 70 | Train Loss: 0.054 Vali Loss: 8.787 Vali Acc: 0.600 Test Loss: 8.787 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 11.646982192993164
Epoch: 31, Steps: 70 | Train Loss: 0.086 Vali Loss: 7.899 Vali Acc: 0.600 Test Loss: 7.899 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 11.738577604293823
Epoch: 32, Steps: 70 | Train Loss: 0.131 Vali Loss: 8.404 Vali Acc: 0.580 Test Loss: 8.404 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 11.809747457504272
Epoch: 33, Steps: 70 | Train Loss: 0.152 Vali Loss: 10.846 Vali Acc: 0.550 Test Loss: 10.846 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 10.01634693145752
Epoch: 34, Steps: 70 | Train Loss: 0.141 Vali Loss: 15.905 Vali Acc: 0.520 Test Loss: 15.905 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 10.506652355194092
Epoch: 35, Steps: 70 | Train Loss: 0.271 Vali Loss: 13.372 Vali Acc: 0.540 Test Loss: 13.372 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 11.753535509109497
Epoch: 36, Steps: 70 | Train Loss: 0.524 Vali Loss: 9.701 Vali Acc: 0.580 Test Loss: 9.701 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 11.815000057220459
Epoch: 37, Steps: 70 | Train Loss: 0.134 Vali Loss: 9.568 Vali Acc: 0.530 Test Loss: 9.568 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 11.804872751235962
Epoch: 38, Steps: 70 | Train Loss: 0.156 Vali Loss: 5.986 Vali Acc: 0.530 Test Loss: 5.986 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 10.5435950756073
Epoch: 39, Steps: 70 | Train Loss: 0.153 Vali Loss: 7.499 Vali Acc: 0.460 Test Loss: 7.499 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1065842
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.940611600875854
Epoch: 1, Steps: 70 | Train Loss: 3.727 Vali Loss: 11.125 Vali Acc: 0.500 Test Loss: 11.125 Test Acc: 0.500
Validation loss decreased (inf --> -0.499889).  Saving model ...
Epoch: 2 cost time: 11.559897184371948
Epoch: 2, Steps: 70 | Train Loss: 4.628 Vali Loss: 1.907 Vali Acc: 0.500 Test Loss: 1.907 Test Acc: 0.500
Validation loss decreased (-0.499889 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 11.754066228866577
Epoch: 3, Steps: 70 | Train Loss: 3.900 Vali Loss: 0.906 Vali Acc: 0.580 Test Loss: 0.906 Test Acc: 0.580
Validation loss decreased (-0.499981 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 9.792923927307129
Epoch: 4, Steps: 70 | Train Loss: 2.335 Vali Loss: 1.243 Vali Acc: 0.520 Test Loss: 1.243 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.034621000289917
Epoch: 5, Steps: 70 | Train Loss: 2.023 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.591232299804688
Epoch: 6, Steps: 70 | Train Loss: 1.869 Vali Loss: 2.964 Vali Acc: 0.470 Test Loss: 2.964 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.722452402114868
Epoch: 7, Steps: 70 | Train Loss: 2.877 Vali Loss: 1.904 Vali Acc: 0.520 Test Loss: 1.904 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.820680618286133
Epoch: 8, Steps: 70 | Train Loss: 3.083 Vali Loss: 1.408 Vali Acc: 0.490 Test Loss: 1.408 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.857547044754028
Epoch: 9, Steps: 70 | Train Loss: 2.563 Vali Loss: 3.585 Vali Acc: 0.470 Test Loss: 3.585 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.057830572128296
Epoch: 10, Steps: 70 | Train Loss: 2.416 Vali Loss: 2.986 Vali Acc: 0.500 Test Loss: 2.986 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.68403673171997
Epoch: 11, Steps: 70 | Train Loss: 2.347 Vali Loss: 4.623 Vali Acc: 0.500 Test Loss: 4.623 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.61378026008606
Epoch: 12, Steps: 70 | Train Loss: 2.133 Vali Loss: 5.595 Vali Acc: 0.480 Test Loss: 5.595 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.698994874954224
Epoch: 13, Steps: 70 | Train Loss: 2.306 Vali Loss: 14.194 Vali Acc: 0.500 Test Loss: 14.194 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1051826
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.301430225372314
Epoch: 1, Steps: 70 | Train Loss: 2.586 Vali Loss: 2.657 Vali Acc: 0.510 Test Loss: 2.657 Test Acc: 0.510
Validation loss decreased (inf --> -0.509973).  Saving model ...
Epoch: 2 cost time: 11.405532360076904
Epoch: 2, Steps: 70 | Train Loss: 4.159 Vali Loss: 5.231 Vali Acc: 0.500 Test Loss: 5.231 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.29934573173523
Epoch: 3, Steps: 70 | Train Loss: 2.713 Vali Loss: 4.233 Vali Acc: 0.500 Test Loss: 4.233 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.31900668144226
Epoch: 4, Steps: 70 | Train Loss: 3.052 Vali Loss: 0.677 Vali Acc: 0.630 Test Loss: 0.677 Test Acc: 0.630
Validation loss decreased (-0.509973 --> -0.629993).  Saving model ...
Epoch: 5 cost time: 9.692421197891235
Epoch: 5, Steps: 70 | Train Loss: 4.314 Vali Loss: 2.611 Vali Acc: 0.500 Test Loss: 2.611 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.68582272529602
Epoch: 6, Steps: 70 | Train Loss: 3.380 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.367922067642212
Epoch: 7, Steps: 70 | Train Loss: 3.025 Vali Loss: 6.828 Vali Acc: 0.500 Test Loss: 6.828 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.35082221031189
Epoch: 8, Steps: 70 | Train Loss: 3.027 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.351078271865845
Epoch: 9, Steps: 70 | Train Loss: 1.558 Vali Loss: 1.287 Vali Acc: 0.580 Test Loss: 1.287 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.750591516494751
Epoch: 10, Steps: 70 | Train Loss: 2.450 Vali Loss: 5.130 Vali Acc: 0.500 Test Loss: 5.130 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.640846490859985
Epoch: 11, Steps: 70 | Train Loss: 2.499 Vali Loss: 3.385 Vali Acc: 0.490 Test Loss: 3.385 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.57405138015747
Epoch: 12, Steps: 70 | Train Loss: 1.894 Vali Loss: 3.775 Vali Acc: 0.490 Test Loss: 3.775 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.358939170837402
Epoch: 13, Steps: 70 | Train Loss: 0.986 Vali Loss: 3.722 Vali Acc: 0.540 Test Loss: 3.722 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.399528980255127
Epoch: 14, Steps: 70 | Train Loss: 0.780 Vali Loss: 5.440 Vali Acc: 0.460 Test Loss: 5.440 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1037810
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.851905345916748
Epoch: 1, Steps: 70 | Train Loss: 2.196 Vali Loss: 4.310 Vali Acc: 0.500 Test Loss: 4.310 Test Acc: 0.500
Validation loss decreased (inf --> -0.499957).  Saving model ...
Epoch: 2 cost time: 11.037339925765991
Epoch: 2, Steps: 70 | Train Loss: 2.486 Vali Loss: 2.234 Vali Acc: 0.500 Test Loss: 2.234 Test Acc: 0.500
Validation loss decreased (-0.499957 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 10.913658618927002
Epoch: 3, Steps: 70 | Train Loss: 3.598 Vali Loss: 6.069 Vali Acc: 0.500 Test Loss: 6.069 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.017754077911377
Epoch: 4, Steps: 70 | Train Loss: 3.604 Vali Loss: 1.967 Vali Acc: 0.520 Test Loss: 1.967 Test Acc: 0.520
Validation loss decreased (-0.499978 --> -0.519980).  Saving model ...
Epoch: 5 cost time: 10.447738409042358
Epoch: 5, Steps: 70 | Train Loss: 4.615 Vali Loss: 7.800 Vali Acc: 0.500 Test Loss: 7.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.13649606704712
Epoch: 6, Steps: 70 | Train Loss: 2.709 Vali Loss: 1.602 Vali Acc: 0.520 Test Loss: 1.602 Test Acc: 0.520
Validation loss decreased (-0.519980 --> -0.519984).  Saving model ...
Epoch: 7 cost time: 10.677641868591309
Epoch: 7, Steps: 70 | Train Loss: 2.515 Vali Loss: 2.534 Vali Acc: 0.580 Test Loss: 2.534 Test Acc: 0.580
Validation loss decreased (-0.519984 --> -0.579975).  Saving model ...
Epoch: 8 cost time: 11.089365005493164
Epoch: 8, Steps: 70 | Train Loss: 1.878 Vali Loss: 2.991 Vali Acc: 0.500 Test Loss: 2.991 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.936653137207031
Epoch: 9, Steps: 70 | Train Loss: 1.718 Vali Loss: 6.465 Vali Acc: 0.510 Test Loss: 6.465 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.956140756607056
Epoch: 10, Steps: 70 | Train Loss: 1.652 Vali Loss: 4.168 Vali Acc: 0.510 Test Loss: 4.168 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.341551303863525
Epoch: 11, Steps: 70 | Train Loss: 1.747 Vali Loss: 11.224 Vali Acc: 0.520 Test Loss: 11.224 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.223572492599487
Epoch: 12, Steps: 70 | Train Loss: 2.501 Vali Loss: 13.548 Vali Acc: 0.500 Test Loss: 13.548 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.110466003417969
Epoch: 13, Steps: 70 | Train Loss: 2.076 Vali Loss: 5.932 Vali Acc: 0.570 Test Loss: 5.932 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.997063875198364
Epoch: 14, Steps: 70 | Train Loss: 2.594 Vali Loss: 4.523 Vali Acc: 0.660 Test Loss: 4.523 Test Acc: 0.660
Validation loss decreased (-0.579975 --> -0.659955).  Saving model ...
Epoch: 15 cost time: 11.027217388153076
Epoch: 15, Steps: 70 | Train Loss: 1.662 Vali Loss: 5.911 Vali Acc: 0.540 Test Loss: 5.911 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.859451055526733
Epoch: 16, Steps: 70 | Train Loss: 0.429 Vali Loss: 4.944 Vali Acc: 0.530 Test Loss: 4.944 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.379749298095703
Epoch: 17, Steps: 70 | Train Loss: 0.755 Vali Loss: 5.534 Vali Acc: 0.520 Test Loss: 5.534 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.500694274902344
Epoch: 18, Steps: 70 | Train Loss: 0.434 Vali Loss: 5.955 Vali Acc: 0.570 Test Loss: 5.955 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.163468360900879
Epoch: 19, Steps: 70 | Train Loss: 0.247 Vali Loss: 4.933 Vali Acc: 0.520 Test Loss: 4.933 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.0268714427948
Epoch: 20, Steps: 70 | Train Loss: 0.183 Vali Loss: 9.280 Vali Acc: 0.550 Test Loss: 9.280 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.96346926689148
Epoch: 21, Steps: 70 | Train Loss: 0.694 Vali Loss: 6.713 Vali Acc: 0.560 Test Loss: 6.713 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.542218685150146
Epoch: 22, Steps: 70 | Train Loss: 0.419 Vali Loss: 6.378 Vali Acc: 0.540 Test Loss: 6.378 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.42534327507019
Epoch: 23, Steps: 70 | Train Loss: 0.224 Vali Loss: 7.850 Vali Acc: 0.580 Test Loss: 7.850 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.114942073822021
Epoch: 24, Steps: 70 | Train Loss: 0.477 Vali Loss: 9.065 Vali Acc: 0.600 Test Loss: 9.065 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 1023794
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.796724081039429
Epoch: 1, Steps: 70 | Train Loss: 1.823 Vali Loss: 3.938 Vali Acc: 0.500 Test Loss: 3.938 Test Acc: 0.500
Validation loss decreased (inf --> -0.499961).  Saving model ...
Epoch: 2 cost time: 9.892746210098267
Epoch: 2, Steps: 70 | Train Loss: 2.794 Vali Loss: 9.503 Vali Acc: 0.500 Test Loss: 9.503 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.798633575439453
Epoch: 3, Steps: 70 | Train Loss: 2.735 Vali Loss: 1.788 Vali Acc: 0.500 Test Loss: 1.788 Test Acc: 0.500
Validation loss decreased (-0.499961 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 11.437650680541992
Epoch: 4, Steps: 70 | Train Loss: 2.456 Vali Loss: 3.259 Vali Acc: 0.500 Test Loss: 3.259 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.568893194198608
Epoch: 5, Steps: 70 | Train Loss: 3.547 Vali Loss: 3.701 Vali Acc: 0.500 Test Loss: 3.701 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.515881299972534
Epoch: 6, Steps: 70 | Train Loss: 4.587 Vali Loss: 4.111 Vali Acc: 0.500 Test Loss: 4.111 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.315059661865234
Epoch: 7, Steps: 70 | Train Loss: 1.755 Vali Loss: 3.274 Vali Acc: 0.500 Test Loss: 3.274 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.715359449386597
Epoch: 8, Steps: 70 | Train Loss: 2.319 Vali Loss: 2.616 Vali Acc: 0.500 Test Loss: 2.616 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.468131303787231
Epoch: 9, Steps: 70 | Train Loss: 2.498 Vali Loss: 12.334 Vali Acc: 0.500 Test Loss: 12.334 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.507243871688843
Epoch: 10, Steps: 70 | Train Loss: 2.081 Vali Loss: 2.985 Vali Acc: 0.570 Test Loss: 2.985 Test Acc: 0.570
Validation loss decreased (-0.499982 --> -0.569970).  Saving model ...
Epoch: 11 cost time: 11.55120325088501
Epoch: 11, Steps: 70 | Train Loss: 1.316 Vali Loss: 6.983 Vali Acc: 0.500 Test Loss: 6.983 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.565568923950195
Epoch: 12, Steps: 70 | Train Loss: 1.973 Vali Loss: 2.775 Vali Acc: 0.580 Test Loss: 2.775 Test Acc: 0.580
Validation loss decreased (-0.569970 --> -0.579972).  Saving model ...
Epoch: 13 cost time: 9.744903802871704
Epoch: 13, Steps: 70 | Train Loss: 1.205 Vali Loss: 2.627 Vali Acc: 0.550 Test Loss: 2.627 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.86520791053772
Epoch: 14, Steps: 70 | Train Loss: 0.814 Vali Loss: 4.245 Vali Acc: 0.530 Test Loss: 4.245 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.091213703155518
Epoch: 15, Steps: 70 | Train Loss: 1.155 Vali Loss: 5.333 Vali Acc: 0.530 Test Loss: 5.333 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.808298349380493
Epoch: 16, Steps: 70 | Train Loss: 0.678 Vali Loss: 6.157 Vali Acc: 0.530 Test Loss: 6.157 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.025015592575073
Epoch: 17, Steps: 70 | Train Loss: 0.459 Vali Loss: 7.450 Vali Acc: 0.520 Test Loss: 7.450 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.044209241867065
Epoch: 18, Steps: 70 | Train Loss: 0.377 Vali Loss: 11.963 Vali Acc: 0.530 Test Loss: 11.963 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.104150295257568
Epoch: 19, Steps: 70 | Train Loss: 0.364 Vali Loss: 10.014 Vali Acc: 0.570 Test Loss: 10.014 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.564039945602417
Epoch: 20, Steps: 70 | Train Loss: 1.499 Vali Loss: 10.589 Vali Acc: 0.560 Test Loss: 10.589 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.079447507858276
Epoch: 21, Steps: 70 | Train Loss: 0.718 Vali Loss: 13.256 Vali Acc: 0.570 Test Loss: 13.256 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.136693000793457
Epoch: 22, Steps: 70 | Train Loss: 0.530 Vali Loss: 6.726 Vali Acc: 0.550 Test Loss: 6.726 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1007602
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.473519325256348
Epoch: 1, Steps: 70 | Train Loss: 2.879 Vali Loss: 3.630 Vali Acc: 0.500 Test Loss: 3.630 Test Acc: 0.500
Validation loss decreased (inf --> -0.499964).  Saving model ...
Epoch: 2 cost time: 10.49165964126587
Epoch: 2, Steps: 70 | Train Loss: 3.896 Vali Loss: 4.710 Vali Acc: 0.520 Test Loss: 4.710 Test Acc: 0.520
Validation loss decreased (-0.499964 --> -0.519953).  Saving model ...
Epoch: 3 cost time: 10.782595872879028
Epoch: 3, Steps: 70 | Train Loss: 3.032 Vali Loss: 2.754 Vali Acc: 0.500 Test Loss: 2.754 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.073204755783081
Epoch: 4, Steps: 70 | Train Loss: 2.060 Vali Loss: 4.946 Vali Acc: 0.500 Test Loss: 4.946 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.649792432785034
Epoch: 5, Steps: 70 | Train Loss: 2.041 Vali Loss: 7.035 Vali Acc: 0.500 Test Loss: 7.035 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.381444454193115
Epoch: 6, Steps: 70 | Train Loss: 2.666 Vali Loss: 1.506 Vali Acc: 0.490 Test Loss: 1.506 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.93721866607666
Epoch: 7, Steps: 70 | Train Loss: 2.168 Vali Loss: 1.298 Vali Acc: 0.530 Test Loss: 1.298 Test Acc: 0.530
Validation loss decreased (-0.519953 --> -0.529987).  Saving model ...
Epoch: 8 cost time: 11.148648500442505
Epoch: 8, Steps: 70 | Train Loss: 2.722 Vali Loss: 1.817 Vali Acc: 0.520 Test Loss: 1.817 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.023858070373535
Epoch: 9, Steps: 70 | Train Loss: 3.768 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.035745620727539
Epoch: 10, Steps: 70 | Train Loss: 1.517 Vali Loss: 2.405 Vali Acc: 0.540 Test Loss: 2.405 Test Acc: 0.540
Validation loss decreased (-0.529987 --> -0.539976).  Saving model ...
Epoch: 11 cost time: 9.46144986152649
Epoch: 11, Steps: 70 | Train Loss: 2.920 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
Validation loss decreased (-0.539976 --> -0.539986).  Saving model ...
Epoch: 12 cost time: 10.962608575820923
Epoch: 12, Steps: 70 | Train Loss: 1.051 Vali Loss: 1.912 Vali Acc: 0.550 Test Loss: 1.912 Test Acc: 0.550
Validation loss decreased (-0.539986 --> -0.549981).  Saving model ...
Epoch: 13 cost time: 10.913040399551392
Epoch: 13, Steps: 70 | Train Loss: 2.620 Vali Loss: 2.736 Vali Acc: 0.580 Test Loss: 2.736 Test Acc: 0.580
Validation loss decreased (-0.549981 --> -0.579973).  Saving model ...
Epoch: 14 cost time: 10.939827680587769
Epoch: 14, Steps: 70 | Train Loss: 2.452 Vali Loss: 8.214 Vali Acc: 0.520 Test Loss: 8.214 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.63119649887085
Epoch: 15, Steps: 70 | Train Loss: 1.118 Vali Loss: 4.136 Vali Acc: 0.620 Test Loss: 4.136 Test Acc: 0.620
Validation loss decreased (-0.579973 --> -0.619959).  Saving model ...
Epoch: 16 cost time: 9.851709365844727
Epoch: 16, Steps: 70 | Train Loss: 1.462 Vali Loss: 5.732 Vali Acc: 0.560 Test Loss: 5.732 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.03944993019104
Epoch: 17, Steps: 70 | Train Loss: 0.904 Vali Loss: 5.129 Vali Acc: 0.540 Test Loss: 5.129 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.968990325927734
Epoch: 18, Steps: 70 | Train Loss: 1.177 Vali Loss: 3.826 Vali Acc: 0.520 Test Loss: 3.826 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.792474031448364
Epoch: 19, Steps: 70 | Train Loss: 0.538 Vali Loss: 5.074 Vali Acc: 0.530 Test Loss: 5.074 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.468976974487305
Epoch: 20, Steps: 70 | Train Loss: 0.255 Vali Loss: 6.253 Vali Acc: 0.540 Test Loss: 6.253 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.44144868850708
Epoch: 21, Steps: 70 | Train Loss: 0.391 Vali Loss: 5.497 Vali Acc: 0.540 Test Loss: 5.497 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.848405361175537
Epoch: 22, Steps: 70 | Train Loss: 0.363 Vali Loss: 6.052 Vali Acc: 0.540 Test Loss: 6.052 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.91706395149231
Epoch: 23, Steps: 70 | Train Loss: 0.138 Vali Loss: 5.552 Vali Acc: 0.520 Test Loss: 5.552 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.73433542251587
Epoch: 24, Steps: 70 | Train Loss: 0.028 Vali Loss: 6.603 Vali Acc: 0.550 Test Loss: 6.603 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.294515609741211
Epoch: 25, Steps: 70 | Train Loss: 0.147 Vali Loss: 8.750 Vali Acc: 0.470 Test Loss: 8.750 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 993586
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.76665711402893
Epoch: 1, Steps: 70 | Train Loss: 1.549 Vali Loss: 1.661 Vali Acc: 0.460 Test Loss: 1.661 Test Acc: 0.460
Validation loss decreased (inf --> -0.459983).  Saving model ...
Epoch: 2 cost time: 10.41377329826355
Epoch: 2, Steps: 70 | Train Loss: 2.086 Vali Loss: 7.651 Vali Acc: 0.500 Test Loss: 7.651 Test Acc: 0.500
Validation loss decreased (-0.459983 --> -0.499923).  Saving model ...
Epoch: 3 cost time: 9.10255217552185
Epoch: 3, Steps: 70 | Train Loss: 3.348 Vali Loss: 2.073 Vali Acc: 0.500 Test Loss: 2.073 Test Acc: 0.500
Validation loss decreased (-0.499923 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 9.993540048599243
Epoch: 4, Steps: 70 | Train Loss: 3.814 Vali Loss: 3.818 Vali Acc: 0.500 Test Loss: 3.818 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.610015153884888
Epoch: 5, Steps: 70 | Train Loss: 3.631 Vali Loss: 11.071 Vali Acc: 0.500 Test Loss: 11.071 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.668128252029419
Epoch: 6, Steps: 70 | Train Loss: 5.154 Vali Loss: 2.147 Vali Acc: 0.500 Test Loss: 2.147 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.515348672866821
Epoch: 7, Steps: 70 | Train Loss: 2.013 Vali Loss: 9.737 Vali Acc: 0.500 Test Loss: 9.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.319665431976318
Epoch: 8, Steps: 70 | Train Loss: 4.871 Vali Loss: 12.962 Vali Acc: 0.500 Test Loss: 12.962 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.740599393844604
Epoch: 9, Steps: 70 | Train Loss: 2.766 Vali Loss: 4.953 Vali Acc: 0.500 Test Loss: 4.953 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.882357120513916
Epoch: 10, Steps: 70 | Train Loss: 1.747 Vali Loss: 2.191 Vali Acc: 0.500 Test Loss: 2.191 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.604542016983032
Epoch: 11, Steps: 70 | Train Loss: 0.935 Vali Loss: 2.886 Vali Acc: 0.560 Test Loss: 2.886 Test Acc: 0.560
Validation loss decreased (-0.499979 --> -0.559971).  Saving model ...
Epoch: 12 cost time: 10.777434349060059
Epoch: 12, Steps: 70 | Train Loss: 1.376 Vali Loss: 8.961 Vali Acc: 0.520 Test Loss: 8.961 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.275245428085327
Epoch: 13, Steps: 70 | Train Loss: 1.804 Vali Loss: 3.990 Vali Acc: 0.530 Test Loss: 3.990 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.072721719741821
Epoch: 14, Steps: 70 | Train Loss: 1.197 Vali Loss: 3.718 Vali Acc: 0.600 Test Loss: 3.718 Test Acc: 0.600
Validation loss decreased (-0.559971 --> -0.599963).  Saving model ...
Epoch: 15 cost time: 10.723053216934204
Epoch: 15, Steps: 70 | Train Loss: 0.994 Vali Loss: 3.592 Vali Acc: 0.560 Test Loss: 3.592 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.783519983291626
Epoch: 16, Steps: 70 | Train Loss: 1.601 Vali Loss: 6.696 Vali Acc: 0.570 Test Loss: 6.696 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.865797519683838
Epoch: 17, Steps: 70 | Train Loss: 1.943 Vali Loss: 5.804 Vali Acc: 0.560 Test Loss: 5.804 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.222271919250488
Epoch: 18, Steps: 70 | Train Loss: 0.407 Vali Loss: 5.619 Vali Acc: 0.480 Test Loss: 5.619 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.401832580566406
Epoch: 19, Steps: 70 | Train Loss: 0.418 Vali Loss: 6.495 Vali Acc: 0.520 Test Loss: 6.495 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.59213638305664
Epoch: 20, Steps: 70 | Train Loss: 0.465 Vali Loss: 7.066 Vali Acc: 0.520 Test Loss: 7.066 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.811569452285767
Epoch: 21, Steps: 70 | Train Loss: 0.598 Vali Loss: 8.089 Vali Acc: 0.470 Test Loss: 8.089 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.258764743804932
Epoch: 22, Steps: 70 | Train Loss: 0.159 Vali Loss: 9.430 Vali Acc: 0.500 Test Loss: 9.430 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.218268871307373
Epoch: 23, Steps: 70 | Train Loss: 0.312 Vali Loss: 11.900 Vali Acc: 0.440 Test Loss: 11.900 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.869446754455566
Epoch: 24, Steps: 70 | Train Loss: 0.433 Vali Loss: 9.738 Vali Acc: 0.490 Test Loss: 9.738 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 979570
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.998110294342041
Epoch: 1, Steps: 70 | Train Loss: 2.215 Vali Loss: 6.224 Vali Acc: 0.500 Test Loss: 6.224 Test Acc: 0.500
Validation loss decreased (inf --> -0.499938).  Saving model ...
Epoch: 2 cost time: 8.824651718139648
Epoch: 2, Steps: 70 | Train Loss: 3.851 Vali Loss: 1.242 Vali Acc: 0.530 Test Loss: 1.242 Test Acc: 0.530
Validation loss decreased (-0.499938 --> -0.529988).  Saving model ...
Epoch: 3 cost time: 10.267350196838379
Epoch: 3, Steps: 70 | Train Loss: 2.406 Vali Loss: 3.166 Vali Acc: 0.500 Test Loss: 3.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.3044114112854
Epoch: 4, Steps: 70 | Train Loss: 5.256 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.304316520690918
Epoch: 5, Steps: 70 | Train Loss: 2.004 Vali Loss: 2.255 Vali Acc: 0.500 Test Loss: 2.255 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.802483081817627
Epoch: 6, Steps: 70 | Train Loss: 2.348 Vali Loss: 5.268 Vali Acc: 0.500 Test Loss: 5.268 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.073094606399536
Epoch: 7, Steps: 70 | Train Loss: 1.914 Vali Loss: 3.701 Vali Acc: 0.500 Test Loss: 3.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.295305490493774
Epoch: 8, Steps: 70 | Train Loss: 2.889 Vali Loss: 3.359 Vali Acc: 0.500 Test Loss: 3.359 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.401078939437866
Epoch: 9, Steps: 70 | Train Loss: 2.650 Vali Loss: 9.595 Vali Acc: 0.500 Test Loss: 9.595 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.718880891799927
Epoch: 10, Steps: 70 | Train Loss: 2.941 Vali Loss: 7.156 Vali Acc: 0.500 Test Loss: 7.156 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.825922966003418
Epoch: 11, Steps: 70 | Train Loss: 2.712 Vali Loss: 5.062 Vali Acc: 0.500 Test Loss: 5.062 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.200444221496582
Epoch: 12, Steps: 70 | Train Loss: 1.817 Vali Loss: 2.162 Vali Acc: 0.600 Test Loss: 2.162 Test Acc: 0.600
Validation loss decreased (-0.529988 --> -0.599978).  Saving model ...
Epoch: 13 cost time: 10.641845464706421
Epoch: 13, Steps: 70 | Train Loss: 1.275 Vali Loss: 1.801 Vali Acc: 0.620 Test Loss: 1.801 Test Acc: 0.620
Validation loss decreased (-0.599978 --> -0.619982).  Saving model ...
Epoch: 14 cost time: 10.472383260726929
Epoch: 14, Steps: 70 | Train Loss: 2.510 Vali Loss: 3.165 Vali Acc: 0.540 Test Loss: 3.165 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.51332139968872
Epoch: 15, Steps: 70 | Train Loss: 3.485 Vali Loss: 3.923 Vali Acc: 0.570 Test Loss: 3.923 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.202971935272217
Epoch: 16, Steps: 70 | Train Loss: 0.527 Vali Loss: 5.163 Vali Acc: 0.520 Test Loss: 5.163 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.610065221786499
Epoch: 17, Steps: 70 | Train Loss: 0.994 Vali Loss: 7.315 Vali Acc: 0.500 Test Loss: 7.315 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.289021015167236
Epoch: 18, Steps: 70 | Train Loss: 0.836 Vali Loss: 4.195 Vali Acc: 0.550 Test Loss: 4.195 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.39385461807251
Epoch: 19, Steps: 70 | Train Loss: 0.623 Vali Loss: 6.989 Vali Acc: 0.500 Test Loss: 6.989 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.464171886444092
Epoch: 20, Steps: 70 | Train Loss: 0.384 Vali Loss: 4.292 Vali Acc: 0.510 Test Loss: 4.292 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.362188577651978
Epoch: 21, Steps: 70 | Train Loss: 0.333 Vali Loss: 8.320 Vali Acc: 0.520 Test Loss: 8.320 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.782267808914185
Epoch: 22, Steps: 70 | Train Loss: 0.198 Vali Loss: 6.525 Vali Acc: 0.530 Test Loss: 6.525 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.486973762512207
Epoch: 23, Steps: 70 | Train Loss: 0.089 Vali Loss: 6.418 Vali Acc: 0.540 Test Loss: 6.418 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 965554
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.13681411743164
Epoch: 1, Steps: 70 | Train Loss: 21.911 Vali Loss: 5.179 Vali Acc: 0.510 Test Loss: 5.179 Test Acc: 0.510
Validation loss decreased (inf --> -0.509948).  Saving model ...
Epoch: 2 cost time: 24.471911668777466
Epoch: 2, Steps: 70 | Train Loss: 14.722 Vali Loss: 5.701 Vali Acc: 0.500 Test Loss: 5.701 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.29229974746704
Epoch: 3, Steps: 70 | Train Loss: 10.565 Vali Loss: 6.590 Vali Acc: 0.500 Test Loss: 6.590 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.981966257095337
Epoch: 4, Steps: 70 | Train Loss: 7.134 Vali Loss: 24.349 Vali Acc: 0.500 Test Loss: 24.349 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 24.676461219787598
Epoch: 5, Steps: 70 | Train Loss: 13.412 Vali Loss: 5.140 Vali Acc: 0.500 Test Loss: 5.140 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.111806392669678
Epoch: 6, Steps: 70 | Train Loss: 6.740 Vali Loss: 8.426 Vali Acc: 0.500 Test Loss: 8.426 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.72185754776001
Epoch: 7, Steps: 70 | Train Loss: 7.797 Vali Loss: 9.679 Vali Acc: 0.500 Test Loss: 9.679 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 22.11380624771118
Epoch: 8, Steps: 70 | Train Loss: 12.336 Vali Loss: 2.044 Vali Acc: 0.490 Test Loss: 2.044 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 24.670944213867188
Epoch: 9, Steps: 70 | Train Loss: 17.157 Vali Loss: 5.428 Vali Acc: 0.500 Test Loss: 5.428 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 24.2242591381073
Epoch: 10, Steps: 70 | Train Loss: 6.347 Vali Loss: 21.863 Vali Acc: 0.500 Test Loss: 21.863 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.190669536590576
Epoch: 11, Steps: 70 | Train Loss: 8.512 Vali Loss: 11.580 Vali Acc: 0.500 Test Loss: 11.580 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 16495398
model size : 67.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.64390778541565
Epoch: 1, Steps: 70 | Train Loss: 25.109 Vali Loss: 29.611 Vali Acc: 0.500 Test Loss: 29.611 Test Acc: 0.500
Validation loss decreased (inf --> -0.499704).  Saving model ...
Epoch: 2 cost time: 24.26513648033142
Epoch: 2, Steps: 70 | Train Loss: 24.920 Vali Loss: 15.358 Vali Acc: 0.500 Test Loss: 15.358 Test Acc: 0.500
Validation loss decreased (-0.499704 --> -0.499846).  Saving model ...
Epoch: 3 cost time: 23.858715534210205
Epoch: 3, Steps: 70 | Train Loss: 9.241 Vali Loss: 10.776 Vali Acc: 0.500 Test Loss: 10.776 Test Acc: 0.500
Validation loss decreased (-0.499846 --> -0.499892).  Saving model ...
Epoch: 4 cost time: 23.571626663208008
Epoch: 4, Steps: 70 | Train Loss: 5.552 Vali Loss: 2.452 Vali Acc: 0.510 Test Loss: 2.452 Test Acc: 0.510
Validation loss decreased (-0.499892 --> -0.509975).  Saving model ...
Epoch: 5 cost time: 24.35096549987793
Epoch: 5, Steps: 70 | Train Loss: 10.853 Vali Loss: 6.270 Vali Acc: 0.500 Test Loss: 6.270 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.5689594745636
Epoch: 6, Steps: 70 | Train Loss: 10.849 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
Validation loss decreased (-0.509975 --> -0.509990).  Saving model ...
Epoch: 7 cost time: 24.663010358810425
Epoch: 7, Steps: 70 | Train Loss: 17.074 Vali Loss: 30.284 Vali Acc: 0.500 Test Loss: 30.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.391289472579956
Epoch: 8, Steps: 70 | Train Loss: 8.516 Vali Loss: 4.549 Vali Acc: 0.500 Test Loss: 4.549 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.93039298057556
Epoch: 9, Steps: 70 | Train Loss: 11.393 Vali Loss: 9.243 Vali Acc: 0.500 Test Loss: 9.243 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.133355617523193
Epoch: 10, Steps: 70 | Train Loss: 8.167 Vali Loss: 9.169 Vali Acc: 0.580 Test Loss: 9.169 Test Acc: 0.580
Validation loss decreased (-0.509990 --> -0.579908).  Saving model ...
Epoch: 11 cost time: 23.217618227005005
Epoch: 11, Steps: 70 | Train Loss: 7.533 Vali Loss: 1.051 Vali Acc: 0.460 Test Loss: 1.051 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.956477642059326
Epoch: 12, Steps: 70 | Train Loss: 10.238 Vali Loss: 11.543 Vali Acc: 0.500 Test Loss: 11.543 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.463584423065186
Epoch: 13, Steps: 70 | Train Loss: 6.506 Vali Loss: 10.739 Vali Acc: 0.500 Test Loss: 10.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.586466073989868
Epoch: 14, Steps: 70 | Train Loss: 8.169 Vali Loss: 8.928 Vali Acc: 0.500 Test Loss: 8.928 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.756277799606323
Epoch: 15, Steps: 70 | Train Loss: 7.823 Vali Loss: 5.176 Vali Acc: 0.500 Test Loss: 5.176 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 24.503027200698853
Epoch: 16, Steps: 70 | Train Loss: 8.643 Vali Loss: 13.376 Vali Acc: 0.500 Test Loss: 13.376 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 24.654229640960693
Epoch: 17, Steps: 70 | Train Loss: 6.981 Vali Loss: 14.394 Vali Acc: 0.500 Test Loss: 14.394 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 21.185739755630493
Epoch: 18, Steps: 70 | Train Loss: 14.886 Vali Loss: 7.727 Vali Acc: 0.500 Test Loss: 7.727 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 21.43920874595642
Epoch: 19, Steps: 70 | Train Loss: 5.319 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 23.850400924682617
Epoch: 20, Steps: 70 | Train Loss: 5.466 Vali Loss: 6.174 Vali Acc: 0.500 Test Loss: 6.174 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 16399398
model size : 67.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.85005521774292
Epoch: 1, Steps: 70 | Train Loss: 33.026 Vali Loss: 99.112 Vali Acc: 0.510 Test Loss: 99.112 Test Acc: 0.510
Validation loss decreased (inf --> -0.509009).  Saving model ...
Epoch: 2 cost time: 23.29763102531433
Epoch: 2, Steps: 70 | Train Loss: 53.796 Vali Loss: 114.233 Vali Acc: 0.420 Test Loss: 114.233 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.80486011505127
Epoch: 3, Steps: 70 | Train Loss: 29.279 Vali Loss: 41.711 Vali Acc: 0.440 Test Loss: 41.711 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.443938970565796
Epoch: 4, Steps: 70 | Train Loss: 21.159 Vali Loss: 43.955 Vali Acc: 0.450 Test Loss: 43.955 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.76234269142151
Epoch: 5, Steps: 70 | Train Loss: 14.483 Vali Loss: 33.090 Vali Acc: 0.470 Test Loss: 33.090 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.610792875289917
Epoch: 6, Steps: 70 | Train Loss: 28.507 Vali Loss: 44.204 Vali Acc: 0.530 Test Loss: 44.204 Test Acc: 0.530
Validation loss decreased (-0.509009 --> -0.529558).  Saving model ...
Epoch: 7 cost time: 22.153379917144775
Epoch: 7, Steps: 70 | Train Loss: 16.318 Vali Loss: 17.281 Vali Acc: 0.620 Test Loss: 17.281 Test Acc: 0.620
Validation loss decreased (-0.529558 --> -0.619827).  Saving model ...
Epoch: 8 cost time: 24.10910391807556
Epoch: 8, Steps: 70 | Train Loss: 21.811 Vali Loss: 14.933 Vali Acc: 0.480 Test Loss: 14.933 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.05666184425354
Epoch: 9, Steps: 70 | Train Loss: 27.720 Vali Loss: 48.257 Vali Acc: 0.500 Test Loss: 48.257 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.48702836036682
Epoch: 10, Steps: 70 | Train Loss: 20.055 Vali Loss: 20.779 Vali Acc: 0.500 Test Loss: 20.779 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.633399724960327
Epoch: 11, Steps: 70 | Train Loss: 18.753 Vali Loss: 12.376 Vali Acc: 0.500 Test Loss: 12.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.04937505722046
Epoch: 12, Steps: 70 | Train Loss: 19.328 Vali Loss: 10.507 Vali Acc: 0.500 Test Loss: 10.507 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.26880145072937
Epoch: 13, Steps: 70 | Train Loss: 10.633 Vali Loss: 5.854 Vali Acc: 0.500 Test Loss: 5.854 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.746684312820435
Epoch: 14, Steps: 70 | Train Loss: 12.885 Vali Loss: 19.450 Vali Acc: 0.500 Test Loss: 19.450 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.146549940109253
Epoch: 15, Steps: 70 | Train Loss: 29.764 Vali Loss: 7.968 Vali Acc: 0.500 Test Loss: 7.968 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 23.718639850616455
Epoch: 16, Steps: 70 | Train Loss: 12.227 Vali Loss: 18.515 Vali Acc: 0.500 Test Loss: 18.515 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 22.449991464614868
Epoch: 17, Steps: 70 | Train Loss: 8.360 Vali Loss: 29.178 Vali Acc: 0.500 Test Loss: 29.178 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 16303398
model size : 67.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.603211402893066
Epoch: 1, Steps: 70 | Train Loss: 19.422 Vali Loss: 14.263 Vali Acc: 0.510 Test Loss: 14.263 Test Acc: 0.510
Validation loss decreased (inf --> -0.509857).  Saving model ...
Epoch: 2 cost time: 22.973651885986328
Epoch: 2, Steps: 70 | Train Loss: 18.481 Vali Loss: 3.691 Vali Acc: 0.490 Test Loss: 3.691 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.357065439224243
Epoch: 3, Steps: 70 | Train Loss: 10.722 Vali Loss: 4.531 Vali Acc: 0.500 Test Loss: 4.531 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.547571659088135
Epoch: 4, Steps: 70 | Train Loss: 9.394 Vali Loss: 11.791 Vali Acc: 0.500 Test Loss: 11.791 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.27434515953064
Epoch: 5, Steps: 70 | Train Loss: 8.384 Vali Loss: 2.431 Vali Acc: 0.500 Test Loss: 2.431 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.558475255966187
Epoch: 6, Steps: 70 | Train Loss: 11.495 Vali Loss: 8.374 Vali Acc: 0.500 Test Loss: 8.374 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.200934410095215
Epoch: 7, Steps: 70 | Train Loss: 15.599 Vali Loss: 6.625 Vali Acc: 0.500 Test Loss: 6.625 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.598097801208496
Epoch: 8, Steps: 70 | Train Loss: 5.685 Vali Loss: 1.232 Vali Acc: 0.620 Test Loss: 1.232 Test Acc: 0.620
Validation loss decreased (-0.509857 --> -0.619988).  Saving model ...
Epoch: 9 cost time: 21.866869688034058
Epoch: 9, Steps: 70 | Train Loss: 13.475 Vali Loss: 5.654 Vali Acc: 0.500 Test Loss: 5.654 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.818193674087524
Epoch: 10, Steps: 70 | Train Loss: 8.228 Vali Loss: 22.861 Vali Acc: 0.500 Test Loss: 22.861 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.915294408798218
Epoch: 11, Steps: 70 | Train Loss: 11.771 Vali Loss: 16.485 Vali Acc: 0.500 Test Loss: 16.485 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.61331558227539
Epoch: 12, Steps: 70 | Train Loss: 9.072 Vali Loss: 5.099 Vali Acc: 0.500 Test Loss: 5.099 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.751667737960815
Epoch: 13, Steps: 70 | Train Loss: 8.949 Vali Loss: 4.812 Vali Acc: 0.500 Test Loss: 4.812 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.898315906524658
Epoch: 14, Steps: 70 | Train Loss: 10.854 Vali Loss: 5.816 Vali Acc: 0.500 Test Loss: 5.816 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.59268307685852
Epoch: 15, Steps: 70 | Train Loss: 10.505 Vali Loss: 15.753 Vali Acc: 0.500 Test Loss: 15.753 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 24.170089960098267
Epoch: 16, Steps: 70 | Train Loss: 11.793 Vali Loss: 16.654 Vali Acc: 0.500 Test Loss: 16.654 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 21.52427339553833
Epoch: 17, Steps: 70 | Train Loss: 12.564 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 23.826894521713257
Epoch: 18, Steps: 70 | Train Loss: 6.244 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 16207398
model size : 66.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.023131370544434
Epoch: 1, Steps: 70 | Train Loss: 27.104 Vali Loss: 41.013 Vali Acc: 0.510 Test Loss: 41.013 Test Acc: 0.510
Validation loss decreased (inf --> -0.509590).  Saving model ...
Epoch: 2 cost time: 18.96855616569519
Epoch: 2, Steps: 70 | Train Loss: 23.903 Vali Loss: 27.345 Vali Acc: 0.500 Test Loss: 27.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.391835689544678
Epoch: 3, Steps: 70 | Train Loss: 15.241 Vali Loss: 11.200 Vali Acc: 0.500 Test Loss: 11.200 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.6531081199646
Epoch: 4, Steps: 70 | Train Loss: 9.357 Vali Loss: 4.692 Vali Acc: 0.500 Test Loss: 4.692 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.277840852737427
Epoch: 5, Steps: 70 | Train Loss: 9.339 Vali Loss: 23.485 Vali Acc: 0.500 Test Loss: 23.485 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.254413843154907
Epoch: 6, Steps: 70 | Train Loss: 12.131 Vali Loss: 11.014 Vali Acc: 0.500 Test Loss: 11.014 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.16062831878662
Epoch: 7, Steps: 70 | Train Loss: 7.155 Vali Loss: 13.562 Vali Acc: 0.500 Test Loss: 13.562 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.7666654586792
Epoch: 8, Steps: 70 | Train Loss: 8.678 Vali Loss: 5.065 Vali Acc: 0.500 Test Loss: 5.065 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.101980924606323
Epoch: 9, Steps: 70 | Train Loss: 6.148 Vali Loss: 25.500 Vali Acc: 0.500 Test Loss: 25.500 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 21.039863348007202
Epoch: 10, Steps: 70 | Train Loss: 13.241 Vali Loss: 25.531 Vali Acc: 0.500 Test Loss: 25.531 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 21.714004516601562
Epoch: 11, Steps: 70 | Train Loss: 13.465 Vali Loss: 2.865 Vali Acc: 0.500 Test Loss: 2.865 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 15182118
model size : 62.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.92202639579773
Epoch: 1, Steps: 70 | Train Loss: 17.134 Vali Loss: 28.062 Vali Acc: 0.500 Test Loss: 28.062 Test Acc: 0.500
Validation loss decreased (inf --> -0.499719).  Saving model ...
Epoch: 2 cost time: 20.837807416915894
Epoch: 2, Steps: 70 | Train Loss: 59.989 Vali Loss: 3.669 Vali Acc: 0.490 Test Loss: 3.669 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.390117406845093
Epoch: 3, Steps: 70 | Train Loss: 10.322 Vali Loss: 5.217 Vali Acc: 0.500 Test Loss: 5.217 Test Acc: 0.500
Validation loss decreased (-0.499719 --> -0.499948).  Saving model ...
Epoch: 4 cost time: 21.27251696586609
Epoch: 4, Steps: 70 | Train Loss: 8.483 Vali Loss: 4.536 Vali Acc: 0.500 Test Loss: 4.536 Test Acc: 0.500
Validation loss decreased (-0.499948 --> -0.499955).  Saving model ...
Epoch: 5 cost time: 21.604400634765625
Epoch: 5, Steps: 70 | Train Loss: 6.230 Vali Loss: 3.330 Vali Acc: 0.500 Test Loss: 3.330 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499967).  Saving model ...
Epoch: 6 cost time: 21.39426589012146
Epoch: 6, Steps: 70 | Train Loss: 7.669 Vali Loss: 5.921 Vali Acc: 0.500 Test Loss: 5.921 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.50773286819458
Epoch: 7, Steps: 70 | Train Loss: 6.791 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
Validation loss decreased (-0.499967 --> -0.499990).  Saving model ...
Epoch: 8 cost time: 20.41201615333557
Epoch: 8, Steps: 70 | Train Loss: 9.222 Vali Loss: 0.957 Vali Acc: 0.550 Test Loss: 0.957 Test Acc: 0.550
Validation loss decreased (-0.499990 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 18.895376682281494
Epoch: 9, Steps: 70 | Train Loss: 14.264 Vali Loss: 17.284 Vali Acc: 0.500 Test Loss: 17.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.297927856445312
Epoch: 10, Steps: 70 | Train Loss: 13.683 Vali Loss: 22.568 Vali Acc: 0.500 Test Loss: 22.568 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.22440481185913
Epoch: 11, Steps: 70 | Train Loss: 19.845 Vali Loss: 18.341 Vali Acc: 0.500 Test Loss: 18.341 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.32634139060974
Epoch: 12, Steps: 70 | Train Loss: 9.191 Vali Loss: 6.408 Vali Acc: 0.500 Test Loss: 6.408 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.364414930343628
Epoch: 13, Steps: 70 | Train Loss: 10.171 Vali Loss: 6.716 Vali Acc: 0.500 Test Loss: 6.716 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 20.000824451446533
Epoch: 14, Steps: 70 | Train Loss: 9.807 Vali Loss: 8.560 Vali Acc: 0.500 Test Loss: 8.560 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 19.537490367889404
Epoch: 15, Steps: 70 | Train Loss: 6.522 Vali Loss: 10.272 Vali Acc: 0.500 Test Loss: 10.272 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 21.34286403656006
Epoch: 16, Steps: 70 | Train Loss: 7.926 Vali Loss: 10.768 Vali Acc: 0.500 Test Loss: 10.768 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 19.53514075279236
Epoch: 17, Steps: 70 | Train Loss: 10.136 Vali Loss: 22.137 Vali Acc: 0.500 Test Loss: 22.137 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 20.266313552856445
Epoch: 18, Steps: 70 | Train Loss: 6.887 Vali Loss: 5.064 Vali Acc: 0.500 Test Loss: 5.064 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 15086118
model size : 62.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.009562253952026
Epoch: 1, Steps: 70 | Train Loss: 36.473 Vali Loss: 141.221 Vali Acc: 0.500 Test Loss: 141.221 Test Acc: 0.500
Validation loss decreased (inf --> -0.498588).  Saving model ...
Epoch: 2 cost time: 19.927681922912598
Epoch: 2, Steps: 70 | Train Loss: 61.245 Vali Loss: 31.883 Vali Acc: 0.500 Test Loss: 31.883 Test Acc: 0.500
Validation loss decreased (-0.498588 --> -0.499681).  Saving model ...
Epoch: 3 cost time: 20.78722643852234
Epoch: 3, Steps: 70 | Train Loss: 20.724 Vali Loss: 47.114 Vali Acc: 0.500 Test Loss: 47.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.413269519805908
Epoch: 4, Steps: 70 | Train Loss: 12.246 Vali Loss: 5.496 Vali Acc: 0.500 Test Loss: 5.496 Test Acc: 0.500
Validation loss decreased (-0.499681 --> -0.499945).  Saving model ...
Epoch: 5 cost time: 21.087266206741333
Epoch: 5, Steps: 70 | Train Loss: 8.110 Vali Loss: 14.429 Vali Acc: 0.500 Test Loss: 14.429 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.80026364326477
Epoch: 6, Steps: 70 | Train Loss: 11.848 Vali Loss: 2.465 Vali Acc: 0.500 Test Loss: 2.465 Test Acc: 0.500
Validation loss decreased (-0.499945 --> -0.499975).  Saving model ...
Epoch: 7 cost time: 19.250933170318604
Epoch: 7, Steps: 70 | Train Loss: 7.903 Vali Loss: 4.715 Vali Acc: 0.500 Test Loss: 4.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.369207859039307
Epoch: 8, Steps: 70 | Train Loss: 12.634 Vali Loss: 6.986 Vali Acc: 0.500 Test Loss: 6.986 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.728073835372925
Epoch: 9, Steps: 70 | Train Loss: 16.066 Vali Loss: 21.789 Vali Acc: 0.500 Test Loss: 21.789 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.61312460899353
Epoch: 10, Steps: 70 | Train Loss: 15.180 Vali Loss: 15.190 Vali Acc: 0.500 Test Loss: 15.190 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.200852394104004
Epoch: 11, Steps: 70 | Train Loss: 7.475 Vali Loss: 0.901 Vali Acc: 0.660 Test Loss: 0.901 Test Acc: 0.660
Validation loss decreased (-0.499975 --> -0.659991).  Saving model ...
Epoch: 12 cost time: 19.267788648605347
Epoch: 12, Steps: 70 | Train Loss: 8.419 Vali Loss: 3.446 Vali Acc: 0.500 Test Loss: 3.446 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.02886152267456
Epoch: 13, Steps: 70 | Train Loss: 10.642 Vali Loss: 8.477 Vali Acc: 0.500 Test Loss: 8.477 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 21.071845293045044
Epoch: 14, Steps: 70 | Train Loss: 14.853 Vali Loss: 16.640 Vali Acc: 0.500 Test Loss: 16.640 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.78328824043274
Epoch: 15, Steps: 70 | Train Loss: 17.522 Vali Loss: 6.802 Vali Acc: 0.500 Test Loss: 6.802 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.483362436294556
Epoch: 16, Steps: 70 | Train Loss: 7.651 Vali Loss: 3.836 Vali Acc: 0.470 Test Loss: 3.836 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.705429792404175
Epoch: 17, Steps: 70 | Train Loss: 7.504 Vali Loss: 15.200 Vali Acc: 0.500 Test Loss: 15.200 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.75194001197815
Epoch: 18, Steps: 70 | Train Loss: 12.700 Vali Loss: 8.447 Vali Acc: 0.500 Test Loss: 8.447 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.147388458251953
Epoch: 19, Steps: 70 | Train Loss: 12.574 Vali Loss: 30.218 Vali Acc: 0.500 Test Loss: 30.218 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.370661735534668
Epoch: 20, Steps: 70 | Train Loss: 8.817 Vali Loss: 2.360 Vali Acc: 0.500 Test Loss: 2.360 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.911699056625366
Epoch: 21, Steps: 70 | Train Loss: 8.891 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 14990118
model size : 62.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.709496021270752
Epoch: 1, Steps: 70 | Train Loss: 20.251 Vali Loss: 13.602 Vali Acc: 0.500 Test Loss: 13.602 Test Acc: 0.500
Validation loss decreased (inf --> -0.499864).  Saving model ...
Epoch: 2 cost time: 19.052781105041504
Epoch: 2, Steps: 70 | Train Loss: 19.352 Vali Loss: 12.822 Vali Acc: 0.500 Test Loss: 12.822 Test Acc: 0.500
Validation loss decreased (-0.499864 --> -0.499872).  Saving model ...
Epoch: 3 cost time: 19.62755823135376
Epoch: 3, Steps: 70 | Train Loss: 13.848 Vali Loss: 17.227 Vali Acc: 0.500 Test Loss: 17.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.73790407180786
Epoch: 4, Steps: 70 | Train Loss: 7.120 Vali Loss: 1.938 Vali Acc: 0.500 Test Loss: 1.938 Test Acc: 0.500
Validation loss decreased (-0.499872 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 18.899889945983887
Epoch: 5, Steps: 70 | Train Loss: 7.424 Vali Loss: 22.002 Vali Acc: 0.500 Test Loss: 22.002 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.833030223846436
Epoch: 6, Steps: 70 | Train Loss: 9.101 Vali Loss: 19.054 Vali Acc: 0.500 Test Loss: 19.054 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.80661106109619
Epoch: 7, Steps: 70 | Train Loss: 16.816 Vali Loss: 13.365 Vali Acc: 0.500 Test Loss: 13.365 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.372175693511963
Epoch: 8, Steps: 70 | Train Loss: 20.634 Vali Loss: 48.758 Vali Acc: 0.500 Test Loss: 48.758 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.626742124557495
Epoch: 9, Steps: 70 | Train Loss: 17.532 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 20.429996728897095
Epoch: 10, Steps: 70 | Train Loss: 10.355 Vali Loss: 1.331 Vali Acc: 0.530 Test Loss: 1.331 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529987).  Saving model ...
Epoch: 11 cost time: 18.51150107383728
Epoch: 11, Steps: 70 | Train Loss: 7.488 Vali Loss: 26.806 Vali Acc: 0.500 Test Loss: 26.806 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.653175592422485
Epoch: 12, Steps: 70 | Train Loss: 12.722 Vali Loss: 4.921 Vali Acc: 0.500 Test Loss: 4.921 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.91062879562378
Epoch: 13, Steps: 70 | Train Loss: 7.389 Vali Loss: 4.436 Vali Acc: 0.500 Test Loss: 4.436 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 22.258995532989502
Epoch: 14, Steps: 70 | Train Loss: 9.624 Vali Loss: 5.143 Vali Acc: 0.500 Test Loss: 5.143 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.119378805160522
Epoch: 15, Steps: 70 | Train Loss: 10.319 Vali Loss: 2.455 Vali Acc: 0.500 Test Loss: 2.455 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 18.626512050628662
Epoch: 16, Steps: 70 | Train Loss: 7.867 Vali Loss: 9.188 Vali Acc: 0.500 Test Loss: 9.188 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.849836587905884
Epoch: 17, Steps: 70 | Train Loss: 11.640 Vali Loss: 22.178 Vali Acc: 0.500 Test Loss: 22.178 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 22.14707612991333
Epoch: 18, Steps: 70 | Train Loss: 11.972 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 18.905393362045288
Epoch: 19, Steps: 70 | Train Loss: 9.697 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 22.163333892822266
Epoch: 20, Steps: 70 | Train Loss: 5.840 Vali Loss: 12.108 Vali Acc: 0.500 Test Loss: 12.108 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 14894118
model size : 61.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.445791006088257
Epoch: 1, Steps: 70 | Train Loss: 24.235 Vali Loss: 33.512 Vali Acc: 0.500 Test Loss: 33.512 Test Acc: 0.500
Validation loss decreased (inf --> -0.499665).  Saving model ...
Epoch: 2 cost time: 21.776004314422607
Epoch: 2, Steps: 70 | Train Loss: 20.700 Vali Loss: 32.623 Vali Acc: 0.500 Test Loss: 32.623 Test Acc: 0.500
Validation loss decreased (-0.499665 --> -0.499674).  Saving model ...
Epoch: 3 cost time: 21.87742257118225
Epoch: 3, Steps: 70 | Train Loss: 14.213 Vali Loss: 19.165 Vali Acc: 0.500 Test Loss: 19.165 Test Acc: 0.500
Validation loss decreased (-0.499674 --> -0.499808).  Saving model ...
Epoch: 4 cost time: 18.818920373916626
Epoch: 4, Steps: 70 | Train Loss: 8.886 Vali Loss: 23.306 Vali Acc: 0.500 Test Loss: 23.306 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.212255001068115
Epoch: 5, Steps: 70 | Train Loss: 13.391 Vali Loss: 41.136 Vali Acc: 0.500 Test Loss: 41.136 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.94474744796753
Epoch: 6, Steps: 70 | Train Loss: 14.260 Vali Loss: 19.409 Vali Acc: 0.500 Test Loss: 19.409 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.706095457077026
Epoch: 7, Steps: 70 | Train Loss: 9.874 Vali Loss: 16.509 Vali Acc: 0.500 Test Loss: 16.509 Test Acc: 0.500
Validation loss decreased (-0.499808 --> -0.499835).  Saving model ...
Epoch: 8 cost time: 21.809521675109863
Epoch: 8, Steps: 70 | Train Loss: 12.931 Vali Loss: 22.353 Vali Acc: 0.500 Test Loss: 22.353 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.22136425971985
Epoch: 9, Steps: 70 | Train Loss: 11.041 Vali Loss: 19.897 Vali Acc: 0.500 Test Loss: 19.897 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.018744468688965
Epoch: 10, Steps: 70 | Train Loss: 9.021 Vali Loss: 9.665 Vali Acc: 0.500 Test Loss: 9.665 Test Acc: 0.500
Validation loss decreased (-0.499835 --> -0.499903).  Saving model ...
Epoch: 11 cost time: 22.108787298202515
Epoch: 11, Steps: 70 | Train Loss: 6.393 Vali Loss: 9.804 Vali Acc: 0.500 Test Loss: 9.804 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.8117778301239
Epoch: 12, Steps: 70 | Train Loss: 10.133 Vali Loss: 18.732 Vali Acc: 0.500 Test Loss: 18.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.95998239517212
Epoch: 13, Steps: 70 | Train Loss: 7.704 Vali Loss: 17.737 Vali Acc: 0.500 Test Loss: 17.737 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 22.169509887695312
Epoch: 14, Steps: 70 | Train Loss: 8.887 Vali Loss: 11.245 Vali Acc: 0.500 Test Loss: 11.245 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 21.96919274330139
Epoch: 15, Steps: 70 | Train Loss: 11.638 Vali Loss: 14.502 Vali Acc: 0.500 Test Loss: 14.502 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 18.78175926208496
Epoch: 16, Steps: 70 | Train Loss: 10.605 Vali Loss: 8.777 Vali Acc: 0.500 Test Loss: 8.777 Test Acc: 0.500
Validation loss decreased (-0.499903 --> -0.499912).  Saving model ...
Epoch: 17 cost time: 21.88667345046997
Epoch: 17, Steps: 70 | Train Loss: 7.660 Vali Loss: 20.871 Vali Acc: 0.500 Test Loss: 20.871 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.584498643875122
Epoch: 18, Steps: 70 | Train Loss: 4.317 Vali Loss: 3.704 Vali Acc: 0.500 Test Loss: 3.704 Test Acc: 0.500
Validation loss decreased (-0.499912 --> -0.499963).  Saving model ...
Epoch: 19 cost time: 19.909695386886597
Epoch: 19, Steps: 70 | Train Loss: 8.536 Vali Loss: 3.237 Vali Acc: 0.500 Test Loss: 3.237 Test Acc: 0.500
Validation loss decreased (-0.499963 --> -0.499968).  Saving model ...
Epoch: 20 cost time: 21.90978980064392
Epoch: 20, Steps: 70 | Train Loss: 2.864 Vali Loss: 4.896 Vali Acc: 0.500 Test Loss: 4.896 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.19067907333374
Epoch: 21, Steps: 70 | Train Loss: 3.275 Vali Loss: 5.793 Vali Acc: 0.500 Test Loss: 5.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 20.484745025634766
Epoch: 22, Steps: 70 | Train Loss: 5.099 Vali Loss: 3.310 Vali Acc: 0.500 Test Loss: 3.310 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.01516056060791
Epoch: 23, Steps: 70 | Train Loss: 4.404 Vali Loss: 14.698 Vali Acc: 0.500 Test Loss: 14.698 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 20.832288026809692
Epoch: 24, Steps: 70 | Train Loss: 4.815 Vali Loss: 4.701 Vali Acc: 0.500 Test Loss: 4.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 20.98191213607788
Epoch: 25, Steps: 70 | Train Loss: 4.687 Vali Loss: 9.879 Vali Acc: 0.500 Test Loss: 9.879 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.023536443710327
Epoch: 26, Steps: 70 | Train Loss: 1.948 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
Validation loss decreased (-0.499968 --> -0.499990).  Saving model ...
Epoch: 27 cost time: 20.240906476974487
Epoch: 27, Steps: 70 | Train Loss: 2.887 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499993).  Saving model ...
Epoch: 28 cost time: 21.51339316368103
Epoch: 28, Steps: 70 | Train Loss: 1.825 Vali Loss: 5.182 Vali Acc: 0.500 Test Loss: 5.182 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 22.443509578704834
Epoch: 29, Steps: 70 | Train Loss: 13.176 Vali Loss: 150.521 Vali Acc: 0.500 Test Loss: 150.521 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 19.178120374679565
Epoch: 30, Steps: 70 | Train Loss: 36.651 Vali Loss: 36.863 Vali Acc: 0.500 Test Loss: 36.863 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 21.9046950340271
Epoch: 31, Steps: 70 | Train Loss: 29.293 Vali Loss: 9.691 Vali Acc: 0.500 Test Loss: 9.691 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 22.09384250640869
Epoch: 32, Steps: 70 | Train Loss: 15.472 Vali Loss: 10.674 Vali Acc: 0.500 Test Loss: 10.674 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 19.360185861587524
Epoch: 33, Steps: 70 | Train Loss: 12.938 Vali Loss: 21.526 Vali Acc: 0.500 Test Loss: 21.526 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 22.39215612411499
Epoch: 34, Steps: 70 | Train Loss: 9.846 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 21.915579557418823
Epoch: 35, Steps: 70 | Train Loss: 5.964 Vali Loss: 7.908 Vali Acc: 0.500 Test Loss: 7.908 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 19.11033320426941
Epoch: 36, Steps: 70 | Train Loss: 12.953 Vali Loss: 17.125 Vali Acc: 0.500 Test Loss: 17.125 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 22.272626876831055
Epoch: 37, Steps: 70 | Train Loss: 12.619 Vali Loss: 11.611 Vali Acc: 0.500 Test Loss: 11.611 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14525478
model size : 60.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.461849451065063
Epoch: 1, Steps: 70 | Train Loss: 15.188 Vali Loss: 15.056 Vali Acc: 0.500 Test Loss: 15.056 Test Acc: 0.500
Validation loss decreased (inf --> -0.499849).  Saving model ...
Epoch: 2 cost time: 21.444098711013794
Epoch: 2, Steps: 70 | Train Loss: 21.738 Vali Loss: 1.194 Vali Acc: 0.490 Test Loss: 1.194 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.097932815551758
Epoch: 3, Steps: 70 | Train Loss: 6.528 Vali Loss: 12.033 Vali Acc: 0.500 Test Loss: 12.033 Test Acc: 0.500
Validation loss decreased (-0.499849 --> -0.499880).  Saving model ...
Epoch: 4 cost time: 18.871914863586426
Epoch: 4, Steps: 70 | Train Loss: 9.894 Vali Loss: 7.347 Vali Acc: 0.500 Test Loss: 7.347 Test Acc: 0.500
Validation loss decreased (-0.499880 --> -0.499927).  Saving model ...
Epoch: 5 cost time: 22.345510244369507
Epoch: 5, Steps: 70 | Train Loss: 13.799 Vali Loss: 49.169 Vali Acc: 0.500 Test Loss: 49.169 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.719613790512085
Epoch: 6, Steps: 70 | Train Loss: 18.819 Vali Loss: 24.000 Vali Acc: 0.500 Test Loss: 24.000 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.65861940383911
Epoch: 7, Steps: 70 | Train Loss: 15.849 Vali Loss: 6.173 Vali Acc: 0.500 Test Loss: 6.173 Test Acc: 0.500
Validation loss decreased (-0.499927 --> -0.499938).  Saving model ...
Epoch: 8 cost time: 22.023651599884033
Epoch: 8, Steps: 70 | Train Loss: 10.059 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
Validation loss decreased (-0.499938 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 22.13331389427185
Epoch: 9, Steps: 70 | Train Loss: 14.648 Vali Loss: 13.907 Vali Acc: 0.500 Test Loss: 13.907 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.694663524627686
Epoch: 10, Steps: 70 | Train Loss: 10.421 Vali Loss: 8.570 Vali Acc: 0.500 Test Loss: 8.570 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.527485370635986
Epoch: 11, Steps: 70 | Train Loss: 6.793 Vali Loss: 7.192 Vali Acc: 0.500 Test Loss: 7.192 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.048419713974
Epoch: 12, Steps: 70 | Train Loss: 11.961 Vali Loss: 30.154 Vali Acc: 0.500 Test Loss: 30.154 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.611480951309204
Epoch: 13, Steps: 70 | Train Loss: 13.391 Vali Loss: 12.272 Vali Acc: 0.500 Test Loss: 12.272 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.9858980178833
Epoch: 14, Steps: 70 | Train Loss: 7.045 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 21.828648328781128
Epoch: 15, Steps: 70 | Train Loss: 14.673 Vali Loss: 8.031 Vali Acc: 0.500 Test Loss: 8.031 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.837843418121338
Epoch: 16, Steps: 70 | Train Loss: 7.107 Vali Loss: 1.917 Vali Acc: 0.500 Test Loss: 1.917 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.71289563179016
Epoch: 17, Steps: 70 | Train Loss: 5.618 Vali Loss: 6.168 Vali Acc: 0.500 Test Loss: 6.168 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.126290798187256
Epoch: 18, Steps: 70 | Train Loss: 6.256 Vali Loss: 6.977 Vali Acc: 0.500 Test Loss: 6.977 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 18.990579843521118
Epoch: 19, Steps: 70 | Train Loss: 6.065 Vali Loss: 2.665 Vali Acc: 0.500 Test Loss: 2.665 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 22.128641366958618
Epoch: 20, Steps: 70 | Train Loss: 6.159 Vali Loss: 1.061 Vali Acc: 0.510 Test Loss: 1.061 Test Acc: 0.510
Validation loss decreased (-0.499989 --> -0.509989).  Saving model ...
Epoch: 21 cost time: 21.807429552078247
Epoch: 21, Steps: 70 | Train Loss: 5.020 Vali Loss: 5.934 Vali Acc: 0.500 Test Loss: 5.934 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.752740144729614
Epoch: 22, Steps: 70 | Train Loss: 5.469 Vali Loss: 2.918 Vali Acc: 0.500 Test Loss: 2.918 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 22.382131814956665
Epoch: 23, Steps: 70 | Train Loss: 11.855 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 21.4367196559906
Epoch: 24, Steps: 70 | Train Loss: 10.549 Vali Loss: 4.461 Vali Acc: 0.500 Test Loss: 4.461 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 20.206660509109497
Epoch: 25, Steps: 70 | Train Loss: 4.235 Vali Loss: 4.724 Vali Acc: 0.500 Test Loss: 4.724 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 21.918787002563477
Epoch: 26, Steps: 70 | Train Loss: 2.751 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 21.39476752281189
Epoch: 27, Steps: 70 | Train Loss: 3.490 Vali Loss: 1.522 Vali Acc: 0.500 Test Loss: 1.522 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 19.222329139709473
Epoch: 28, Steps: 70 | Train Loss: 4.298 Vali Loss: 14.907 Vali Acc: 0.500 Test Loss: 14.907 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 18.1145076751709
Epoch: 29, Steps: 70 | Train Loss: 2.797 Vali Loss: 2.852 Vali Acc: 0.500 Test Loss: 2.852 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 21.605427026748657
Epoch: 30, Steps: 70 | Train Loss: 2.520 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 14429478
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.107537031173706
Epoch: 1, Steps: 70 | Train Loss: 17.945 Vali Loss: 75.273 Vali Acc: 0.500 Test Loss: 75.273 Test Acc: 0.500
Validation loss decreased (inf --> -0.499247).  Saving model ...
Epoch: 2 cost time: 20.29755663871765
Epoch: 2, Steps: 70 | Train Loss: 21.907 Vali Loss: 28.147 Vali Acc: 0.500 Test Loss: 28.147 Test Acc: 0.500
Validation loss decreased (-0.499247 --> -0.499719).  Saving model ...
Epoch: 3 cost time: 20.390676736831665
Epoch: 3, Steps: 70 | Train Loss: 20.291 Vali Loss: 3.128 Vali Acc: 0.500 Test Loss: 3.128 Test Acc: 0.500
Validation loss decreased (-0.499719 --> -0.499969).  Saving model ...
Epoch: 4 cost time: 21.375195741653442
Epoch: 4, Steps: 70 | Train Loss: 12.335 Vali Loss: 19.828 Vali Acc: 0.500 Test Loss: 19.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.443544387817383
Epoch: 5, Steps: 70 | Train Loss: 11.694 Vali Loss: 20.839 Vali Acc: 0.500 Test Loss: 20.839 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.534693956375122
Epoch: 6, Steps: 70 | Train Loss: 9.719 Vali Loss: 12.795 Vali Acc: 0.500 Test Loss: 12.795 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.80595850944519
Epoch: 7, Steps: 70 | Train Loss: 10.940 Vali Loss: 28.534 Vali Acc: 0.500 Test Loss: 28.534 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.161151885986328
Epoch: 8, Steps: 70 | Train Loss: 8.260 Vali Loss: 2.697 Vali Acc: 0.500 Test Loss: 2.697 Test Acc: 0.500
Validation loss decreased (-0.499969 --> -0.499973).  Saving model ...
Epoch: 9 cost time: 21.031144380569458
Epoch: 9, Steps: 70 | Train Loss: 10.339 Vali Loss: 22.248 Vali Acc: 0.500 Test Loss: 22.248 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.56272792816162
Epoch: 10, Steps: 70 | Train Loss: 13.303 Vali Loss: 4.263 Vali Acc: 0.500 Test Loss: 4.263 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.353866815567017
Epoch: 11, Steps: 70 | Train Loss: 9.400 Vali Loss: 6.076 Vali Acc: 0.500 Test Loss: 6.076 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.25715661048889
Epoch: 12, Steps: 70 | Train Loss: 12.528 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
Validation loss decreased (-0.499973 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 19.41436243057251
Epoch: 13, Steps: 70 | Train Loss: 13.757 Vali Loss: 20.937 Vali Acc: 0.500 Test Loss: 20.937 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.153778314590454
Epoch: 14, Steps: 70 | Train Loss: 13.258 Vali Loss: 26.987 Vali Acc: 0.500 Test Loss: 26.987 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.52586007118225
Epoch: 15, Steps: 70 | Train Loss: 19.637 Vali Loss: 23.071 Vali Acc: 0.500 Test Loss: 23.071 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.225815296173096
Epoch: 16, Steps: 70 | Train Loss: 19.487 Vali Loss: 6.532 Vali Acc: 0.500 Test Loss: 6.532 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 21.61458706855774
Epoch: 17, Steps: 70 | Train Loss: 15.805 Vali Loss: 30.126 Vali Acc: 0.500 Test Loss: 30.126 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.557055950164795
Epoch: 18, Steps: 70 | Train Loss: 9.299 Vali Loss: 2.938 Vali Acc: 0.500 Test Loss: 2.938 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 21.30532741546631
Epoch: 19, Steps: 70 | Train Loss: 5.586 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 20.28489923477173
Epoch: 20, Steps: 70 | Train Loss: 5.103 Vali Loss: 2.519 Vali Acc: 0.500 Test Loss: 2.519 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.749380111694336
Epoch: 21, Steps: 70 | Train Loss: 4.031 Vali Loss: 3.992 Vali Acc: 0.500 Test Loss: 3.992 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 21.341633796691895
Epoch: 22, Steps: 70 | Train Loss: 6.757 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 18.36644959449768
Epoch: 23, Steps: 70 | Train Loss: 4.530 Vali Loss: 1.667 Vali Acc: 0.500 Test Loss: 1.667 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 21.34143877029419
Epoch: 24, Steps: 70 | Train Loss: 3.312 Vali Loss: 2.153 Vali Acc: 0.500 Test Loss: 2.153 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 20.559211015701294
Epoch: 25, Steps: 70 | Train Loss: 3.857 Vali Loss: 6.544 Vali Acc: 0.500 Test Loss: 6.544 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 19.616055488586426
Epoch: 26, Steps: 70 | Train Loss: 5.247 Vali Loss: 10.565 Vali Acc: 0.500 Test Loss: 10.565 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 21.49761176109314
Epoch: 27, Steps: 70 | Train Loss: 4.209 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 18.718627452850342
Epoch: 28, Steps: 70 | Train Loss: 4.757 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 29 cost time: 21.181849718093872
Epoch: 29, Steps: 70 | Train Loss: 2.804 Vali Loss: 2.322 Vali Acc: 0.500 Test Loss: 2.322 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 21.286182403564453
Epoch: 30, Steps: 70 | Train Loss: 2.663 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499993).  Saving model ...
Epoch: 31 cost time: 19.149000644683838
Epoch: 31, Steps: 70 | Train Loss: 2.479 Vali Loss: 1.039 Vali Acc: 0.500 Test Loss: 1.039 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 21.43226718902588
Epoch: 32, Steps: 70 | Train Loss: 1.947 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 19.4853093624115
Epoch: 33, Steps: 70 | Train Loss: 2.452 Vali Loss: 6.236 Vali Acc: 0.500 Test Loss: 6.236 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 21.40690588951111
Epoch: 34, Steps: 70 | Train Loss: 3.863 Vali Loss: 4.131 Vali Acc: 0.500 Test Loss: 4.131 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 21.25965714454651
Epoch: 35, Steps: 70 | Train Loss: 1.874 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 18.50543713569641
Epoch: 36, Steps: 70 | Train Loss: 1.640 Vali Loss: 2.043 Vali Acc: 0.500 Test Loss: 2.043 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 21.34853982925415
Epoch: 37, Steps: 70 | Train Loss: 1.232 Vali Loss: 5.306 Vali Acc: 0.500 Test Loss: 5.306 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 20.036924123764038
Epoch: 38, Steps: 70 | Train Loss: 3.090 Vali Loss: 7.748 Vali Acc: 0.500 Test Loss: 7.748 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 19.95800256729126
Epoch: 39, Steps: 70 | Train Loss: 1.627 Vali Loss: 5.803 Vali Acc: 0.500 Test Loss: 5.803 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 21.39874768257141
Epoch: 40, Steps: 70 | Train Loss: 2.266 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14333478
model size : 59.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.61696982383728
Epoch: 1, Steps: 70 | Train Loss: 13.206 Vali Loss: 12.619 Vali Acc: 0.490 Test Loss: 12.619 Test Acc: 0.490
Validation loss decreased (inf --> -0.489874).  Saving model ...
Epoch: 2 cost time: 19.73120379447937
Epoch: 2, Steps: 70 | Train Loss: 19.394 Vali Loss: 12.896 Vali Acc: 0.500 Test Loss: 12.896 Test Acc: 0.500
Validation loss decreased (-0.489874 --> -0.499871).  Saving model ...
Epoch: 3 cost time: 20.354393243789673
Epoch: 3, Steps: 70 | Train Loss: 7.913 Vali Loss: 9.819 Vali Acc: 0.500 Test Loss: 9.819 Test Acc: 0.500
Validation loss decreased (-0.499871 --> -0.499902).  Saving model ...
Epoch: 4 cost time: 21.111253023147583
Epoch: 4, Steps: 70 | Train Loss: 6.291 Vali Loss: 10.300 Vali Acc: 0.500 Test Loss: 10.300 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.054786682128906
Epoch: 5, Steps: 70 | Train Loss: 12.634 Vali Loss: 2.178 Vali Acc: 0.500 Test Loss: 2.178 Test Acc: 0.500
Validation loss decreased (-0.499902 --> -0.499978).  Saving model ...
Epoch: 6 cost time: 20.741884469985962
Epoch: 6, Steps: 70 | Train Loss: 7.232 Vali Loss: 12.742 Vali Acc: 0.500 Test Loss: 12.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.164262771606445
Epoch: 7, Steps: 70 | Train Loss: 12.227 Vali Loss: 9.158 Vali Acc: 0.500 Test Loss: 9.158 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.692096710205078
Epoch: 8, Steps: 70 | Train Loss: 15.722 Vali Loss: 2.270 Vali Acc: 0.430 Test Loss: 2.270 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.8024160861969
Epoch: 9, Steps: 70 | Train Loss: 12.234 Vali Loss: 19.984 Vali Acc: 0.500 Test Loss: 19.984 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.492554187774658
Epoch: 10, Steps: 70 | Train Loss: 8.622 Vali Loss: 14.325 Vali Acc: 0.500 Test Loss: 14.325 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 20.950883865356445
Epoch: 11, Steps: 70 | Train Loss: 11.504 Vali Loss: 9.215 Vali Acc: 0.500 Test Loss: 9.215 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 21.038494110107422
Epoch: 12, Steps: 70 | Train Loss: 9.739 Vali Loss: 15.653 Vali Acc: 0.500 Test Loss: 15.653 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.31240200996399
Epoch: 13, Steps: 70 | Train Loss: 14.709 Vali Loss: 1.625 Vali Acc: 0.500 Test Loss: 1.625 Test Acc: 0.500
Validation loss decreased (-0.499978 --> -0.499984).  Saving model ...
Epoch: 14 cost time: 21.133168935775757
Epoch: 14, Steps: 70 | Train Loss: 16.205 Vali Loss: 17.525 Vali Acc: 0.500 Test Loss: 17.525 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.625696182250977
Epoch: 15, Steps: 70 | Train Loss: 8.331 Vali Loss: 11.556 Vali Acc: 0.500 Test Loss: 11.556 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.577351808547974
Epoch: 16, Steps: 70 | Train Loss: 11.651 Vali Loss: 4.225 Vali Acc: 0.500 Test Loss: 4.225 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 20.971416234970093
Epoch: 17, Steps: 70 | Train Loss: 7.731 Vali Loss: 3.239 Vali Acc: 0.500 Test Loss: 3.239 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.971633434295654
Epoch: 18, Steps: 70 | Train Loss: 8.168 Vali Loss: 9.022 Vali Acc: 0.500 Test Loss: 9.022 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.351195335388184
Epoch: 19, Steps: 70 | Train Loss: 6.098 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499991).  Saving model ...
Epoch: 20 cost time: 20.09069037437439
Epoch: 20, Steps: 70 | Train Loss: 5.834 Vali Loss: 10.609 Vali Acc: 0.500 Test Loss: 10.609 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.68450951576233
Epoch: 21, Steps: 70 | Train Loss: 7.340 Vali Loss: 9.041 Vali Acc: 0.500 Test Loss: 9.041 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.986014127731323
Epoch: 22, Steps: 70 | Train Loss: 4.808 Vali Loss: 3.039 Vali Acc: 0.500 Test Loss: 3.039 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 19.164195775985718
Epoch: 23, Steps: 70 | Train Loss: 7.094 Vali Loss: 12.262 Vali Acc: 0.500 Test Loss: 12.262 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 20.075735807418823
Epoch: 24, Steps: 70 | Train Loss: 6.068 Vali Loss: 2.295 Vali Acc: 0.500 Test Loss: 2.295 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 20.122657775878906
Epoch: 25, Steps: 70 | Train Loss: 3.173 Vali Loss: 5.057 Vali Acc: 0.500 Test Loss: 5.057 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 19.450154542922974
Epoch: 26, Steps: 70 | Train Loss: 4.100 Vali Loss: 2.357 Vali Acc: 0.500 Test Loss: 2.357 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 20.554396390914917
Epoch: 27, Steps: 70 | Train Loss: 3.423 Vali Loss: 4.294 Vali Acc: 0.500 Test Loss: 4.294 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 18.716012716293335
Epoch: 28, Steps: 70 | Train Loss: 3.498 Vali Loss: 2.358 Vali Acc: 0.500 Test Loss: 2.358 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 20.336087465286255
Epoch: 29, Steps: 70 | Train Loss: 3.920 Vali Loss: 7.077 Vali Acc: 0.500 Test Loss: 7.077 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14237478
model size : 59.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.47397232055664
Epoch: 1, Steps: 70 | Train Loss: 48.702 Vali Loss: 6.012 Vali Acc: 0.510 Test Loss: 6.012 Test Acc: 0.510
Validation loss decreased (inf --> -0.509940).  Saving model ...
Epoch: 2 cost time: 18.10026979446411
Epoch: 2, Steps: 70 | Train Loss: 35.640 Vali Loss: 19.862 Vali Acc: 0.500 Test Loss: 19.862 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.73753809928894
Epoch: 3, Steps: 70 | Train Loss: 14.789 Vali Loss: 3.401 Vali Acc: 0.500 Test Loss: 3.401 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.329753160476685
Epoch: 4, Steps: 70 | Train Loss: 10.534 Vali Loss: 9.133 Vali Acc: 0.500 Test Loss: 9.133 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 20.636770725250244
Epoch: 5, Steps: 70 | Train Loss: 13.264 Vali Loss: 1.624 Vali Acc: 0.500 Test Loss: 1.624 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.872381687164307
Epoch: 6, Steps: 70 | Train Loss: 10.244 Vali Loss: 4.790 Vali Acc: 0.500 Test Loss: 4.790 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.706440687179565
Epoch: 7, Steps: 70 | Train Loss: 7.748 Vali Loss: 14.595 Vali Acc: 0.500 Test Loss: 14.595 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 19.6160306930542
Epoch: 8, Steps: 70 | Train Loss: 8.401 Vali Loss: 10.667 Vali Acc: 0.500 Test Loss: 10.667 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 20.05449867248535
Epoch: 9, Steps: 70 | Train Loss: 10.559 Vali Loss: 19.762 Vali Acc: 0.500 Test Loss: 19.762 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.19062066078186
Epoch: 10, Steps: 70 | Train Loss: 11.037 Vali Loss: 14.207 Vali Acc: 0.500 Test Loss: 14.207 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 19.504462718963623
Epoch: 11, Steps: 70 | Train Loss: 7.409 Vali Loss: 0.896 Vali Acc: 0.550 Test Loss: 0.896 Test Acc: 0.550
Validation loss decreased (-0.509940 --> -0.549991).  Saving model ...
Epoch: 12 cost time: 20.469945430755615
Epoch: 12, Steps: 70 | Train Loss: 20.642 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.94952964782715
Epoch: 13, Steps: 70 | Train Loss: 14.073 Vali Loss: 8.637 Vali Acc: 0.500 Test Loss: 8.637 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.74195694923401
Epoch: 14, Steps: 70 | Train Loss: 11.969 Vali Loss: 18.347 Vali Acc: 0.500 Test Loss: 18.347 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.91039490699768
Epoch: 15, Steps: 70 | Train Loss: 8.828 Vali Loss: 9.574 Vali Acc: 0.500 Test Loss: 9.574 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.54709005355835
Epoch: 16, Steps: 70 | Train Loss: 6.993 Vali Loss: 12.841 Vali Acc: 0.500 Test Loss: 12.841 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 18.162112712860107
Epoch: 17, Steps: 70 | Train Loss: 14.479 Vali Loss: 7.821 Vali Acc: 0.500 Test Loss: 7.821 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.732699394226074
Epoch: 18, Steps: 70 | Train Loss: 6.396 Vali Loss: 2.910 Vali Acc: 0.500 Test Loss: 2.910 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.954787492752075
Epoch: 19, Steps: 70 | Train Loss: 11.388 Vali Loss: 2.750 Vali Acc: 0.500 Test Loss: 2.750 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.552410125732422
Epoch: 20, Steps: 70 | Train Loss: 6.385 Vali Loss: 3.813 Vali Acc: 0.500 Test Loss: 3.813 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.047312021255493
Epoch: 21, Steps: 70 | Train Loss: 9.202 Vali Loss: 4.631 Vali Acc: 0.500 Test Loss: 4.631 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 14197158
model size : 59.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.33992099761963
Epoch: 1, Steps: 70 | Train Loss: 41.412 Vali Loss: 64.919 Vali Acc: 0.460 Test Loss: 64.919 Test Acc: 0.460
Validation loss decreased (inf --> -0.459351).  Saving model ...
Epoch: 2 cost time: 19.176392555236816
Epoch: 2, Steps: 70 | Train Loss: 35.484 Vali Loss: 3.893 Vali Acc: 0.580 Test Loss: 3.893 Test Acc: 0.580
Validation loss decreased (-0.459351 --> -0.579961).  Saving model ...
Epoch: 3 cost time: 20.328571557998657
Epoch: 3, Steps: 70 | Train Loss: 14.181 Vali Loss: 8.851 Vali Acc: 0.500 Test Loss: 8.851 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.12053918838501
Epoch: 4, Steps: 70 | Train Loss: 9.779 Vali Loss: 6.949 Vali Acc: 0.510 Test Loss: 6.949 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.28925848007202
Epoch: 5, Steps: 70 | Train Loss: 16.335 Vali Loss: 17.912 Vali Acc: 0.500 Test Loss: 17.912 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.729615211486816
Epoch: 6, Steps: 70 | Train Loss: 12.685 Vali Loss: 2.480 Vali Acc: 0.510 Test Loss: 2.480 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.382014989852905
Epoch: 7, Steps: 70 | Train Loss: 14.690 Vali Loss: 1.600 Vali Acc: 0.530 Test Loss: 1.600 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.143945932388306
Epoch: 8, Steps: 70 | Train Loss: 9.953 Vali Loss: 20.172 Vali Acc: 0.500 Test Loss: 20.172 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.103801012039185
Epoch: 9, Steps: 70 | Train Loss: 10.593 Vali Loss: 9.196 Vali Acc: 0.500 Test Loss: 9.196 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.45650839805603
Epoch: 10, Steps: 70 | Train Loss: 11.989 Vali Loss: 28.102 Vali Acc: 0.500 Test Loss: 28.102 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 19.25026798248291
Epoch: 11, Steps: 70 | Train Loss: 15.325 Vali Loss: 25.589 Vali Acc: 0.500 Test Loss: 25.589 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.162288665771484
Epoch: 12, Steps: 70 | Train Loss: 29.776 Vali Loss: 19.298 Vali Acc: 0.500 Test Loss: 19.298 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14101158
model size : 58.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.224575757980347
Epoch: 1, Steps: 70 | Train Loss: 19.365 Vali Loss: 45.521 Vali Acc: 0.500 Test Loss: 45.521 Test Acc: 0.500
Validation loss decreased (inf --> -0.499545).  Saving model ...
Epoch: 2 cost time: 17.43139100074768
Epoch: 2, Steps: 70 | Train Loss: 22.715 Vali Loss: 21.388 Vali Acc: 0.500 Test Loss: 21.388 Test Acc: 0.500
Validation loss decreased (-0.499545 --> -0.499786).  Saving model ...
Epoch: 3 cost time: 18.948307037353516
Epoch: 3, Steps: 70 | Train Loss: 7.781 Vali Loss: 4.963 Vali Acc: 0.500 Test Loss: 4.963 Test Acc: 0.500
Validation loss decreased (-0.499786 --> -0.499950).  Saving model ...
Epoch: 4 cost time: 19.451123476028442
Epoch: 4, Steps: 70 | Train Loss: 11.839 Vali Loss: 20.449 Vali Acc: 0.500 Test Loss: 20.449 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.208420038223267
Epoch: 5, Steps: 70 | Train Loss: 15.925 Vali Loss: 10.772 Vali Acc: 0.500 Test Loss: 10.772 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.316113710403442
Epoch: 6, Steps: 70 | Train Loss: 7.806 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.66960120201111
Epoch: 7, Steps: 70 | Train Loss: 12.905 Vali Loss: 9.259 Vali Acc: 0.500 Test Loss: 9.259 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.036376476287842
Epoch: 8, Steps: 70 | Train Loss: 5.844 Vali Loss: 10.128 Vali Acc: 0.500 Test Loss: 10.128 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.2918484210968
Epoch: 9, Steps: 70 | Train Loss: 16.873 Vali Loss: 29.883 Vali Acc: 0.500 Test Loss: 29.883 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.69270372390747
Epoch: 10, Steps: 70 | Train Loss: 14.364 Vali Loss: 9.602 Vali Acc: 0.500 Test Loss: 9.602 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.08012890815735
Epoch: 11, Steps: 70 | Train Loss: 14.109 Vali Loss: 15.873 Vali Acc: 0.500 Test Loss: 15.873 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 18.90795087814331
Epoch: 12, Steps: 70 | Train Loss: 5.585 Vali Loss: 21.591 Vali Acc: 0.500 Test Loss: 21.591 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.502596855163574
Epoch: 13, Steps: 70 | Train Loss: 11.768 Vali Loss: 12.384 Vali Acc: 0.500 Test Loss: 12.384 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14005158
model size : 58.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.56737208366394
Epoch: 1, Steps: 70 | Train Loss: 31.975 Vali Loss: 6.820 Vali Acc: 0.650 Test Loss: 6.820 Test Acc: 0.650
Validation loss decreased (inf --> -0.649932).  Saving model ...
Epoch: 2 cost time: 16.537079095840454
Epoch: 2, Steps: 70 | Train Loss: 44.957 Vali Loss: 41.221 Vali Acc: 0.510 Test Loss: 41.221 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.07349181175232
Epoch: 3, Steps: 70 | Train Loss: 46.310 Vali Loss: 65.725 Vali Acc: 0.500 Test Loss: 65.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.88396453857422
Epoch: 4, Steps: 70 | Train Loss: 13.587 Vali Loss: 7.512 Vali Acc: 0.500 Test Loss: 7.512 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.92817997932434
Epoch: 5, Steps: 70 | Train Loss: 7.487 Vali Loss: 3.670 Vali Acc: 0.500 Test Loss: 3.670 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.095853805541992
Epoch: 6, Steps: 70 | Train Loss: 13.891 Vali Loss: 35.041 Vali Acc: 0.500 Test Loss: 35.041 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.699951887130737
Epoch: 7, Steps: 70 | Train Loss: 8.664 Vali Loss: 19.472 Vali Acc: 0.500 Test Loss: 19.472 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.714890480041504
Epoch: 8, Steps: 70 | Train Loss: 10.650 Vali Loss: 4.339 Vali Acc: 0.510 Test Loss: 4.339 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.526005029678345
Epoch: 9, Steps: 70 | Train Loss: 10.702 Vali Loss: 9.804 Vali Acc: 0.500 Test Loss: 9.804 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.40914034843445
Epoch: 10, Steps: 70 | Train Loss: 13.162 Vali Loss: 10.585 Vali Acc: 0.500 Test Loss: 10.585 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.834678173065186
Epoch: 11, Steps: 70 | Train Loss: 12.470 Vali Loss: 7.488 Vali Acc: 0.500 Test Loss: 7.488 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 13909158
model size : 58.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.555434942245483
Epoch: 1, Steps: 70 | Train Loss: 14.909 Vali Loss: 83.706 Vali Acc: 0.500 Test Loss: 83.706 Test Acc: 0.500
Validation loss decreased (inf --> -0.499163).  Saving model ...
Epoch: 2 cost time: 19.164421319961548
Epoch: 2, Steps: 70 | Train Loss: 39.354 Vali Loss: 7.858 Vali Acc: 0.500 Test Loss: 7.858 Test Acc: 0.500
Validation loss decreased (-0.499163 --> -0.499921).  Saving model ...
Epoch: 3 cost time: 19.453278064727783
Epoch: 3, Steps: 70 | Train Loss: 10.019 Vali Loss: 8.210 Vali Acc: 0.500 Test Loss: 8.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.436396598815918
Epoch: 4, Steps: 70 | Train Loss: 12.474 Vali Loss: 22.809 Vali Acc: 0.500 Test Loss: 22.809 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.364608764648438
Epoch: 5, Steps: 70 | Train Loss: 7.804 Vali Loss: 2.025 Vali Acc: 0.500 Test Loss: 2.025 Test Acc: 0.500
Validation loss decreased (-0.499921 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 19.75231647491455
Epoch: 6, Steps: 70 | Train Loss: 4.369 Vali Loss: 4.107 Vali Acc: 0.500 Test Loss: 4.107 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.46151876449585
Epoch: 7, Steps: 70 | Train Loss: 12.885 Vali Loss: 13.453 Vali Acc: 0.500 Test Loss: 13.453 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.186150550842285
Epoch: 8, Steps: 70 | Train Loss: 8.001 Vali Loss: 4.115 Vali Acc: 0.500 Test Loss: 4.115 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.75037169456482
Epoch: 9, Steps: 70 | Train Loss: 6.695 Vali Loss: 17.620 Vali Acc: 0.500 Test Loss: 17.620 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.696682691574097
Epoch: 10, Steps: 70 | Train Loss: 10.396 Vali Loss: 4.839 Vali Acc: 0.490 Test Loss: 4.839 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.967963457107544
Epoch: 11, Steps: 70 | Train Loss: 8.502 Vali Loss: 3.694 Vali Acc: 0.500 Test Loss: 3.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.345845699310303
Epoch: 12, Steps: 70 | Train Loss: 7.466 Vali Loss: 12.620 Vali Acc: 0.500 Test Loss: 12.620 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 19.824109315872192
Epoch: 13, Steps: 70 | Train Loss: 5.600 Vali Loss: 1.814 Vali Acc: 0.560 Test Loss: 1.814 Test Acc: 0.560
Validation loss decreased (-0.499980 --> -0.559982).  Saving model ...
Epoch: 14 cost time: 19.615248680114746
Epoch: 14, Steps: 70 | Train Loss: 6.192 Vali Loss: 17.198 Vali Acc: 0.500 Test Loss: 17.198 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.24961495399475
Epoch: 15, Steps: 70 | Train Loss: 4.522 Vali Loss: 4.904 Vali Acc: 0.520 Test Loss: 4.904 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.08937096595764
Epoch: 16, Steps: 70 | Train Loss: 5.770 Vali Loss: 24.908 Vali Acc: 0.500 Test Loss: 24.908 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.580339431762695
Epoch: 17, Steps: 70 | Train Loss: 6.473 Vali Loss: 13.322 Vali Acc: 0.500 Test Loss: 13.322 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.787938356399536
Epoch: 18, Steps: 70 | Train Loss: 21.917 Vali Loss: 27.915 Vali Acc: 0.500 Test Loss: 27.915 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.523786306381226
Epoch: 19, Steps: 70 | Train Loss: 16.226 Vali Loss: 17.139 Vali Acc: 0.500 Test Loss: 17.139 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 17.963196754455566
Epoch: 20, Steps: 70 | Train Loss: 10.144 Vali Loss: 6.232 Vali Acc: 0.500 Test Loss: 6.232 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 19.891479969024658
Epoch: 21, Steps: 70 | Train Loss: 8.248 Vali Loss: 12.563 Vali Acc: 0.500 Test Loss: 12.563 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 19.695146560668945
Epoch: 22, Steps: 70 | Train Loss: 9.949 Vali Loss: 6.192 Vali Acc: 0.500 Test Loss: 6.192 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.486061334609985
Epoch: 23, Steps: 70 | Train Loss: 7.663 Vali Loss: 4.607 Vali Acc: 0.500 Test Loss: 4.607 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 6939558
model size : 29.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.275407075881958
Epoch: 1, Steps: 70 | Train Loss: 10.512 Vali Loss: 24.604 Vali Acc: 0.500 Test Loss: 24.604 Test Acc: 0.500
Validation loss decreased (inf --> -0.499754).  Saving model ...
Epoch: 2 cost time: 18.630865812301636
Epoch: 2, Steps: 70 | Train Loss: 21.269 Vali Loss: 7.891 Vali Acc: 0.500 Test Loss: 7.891 Test Acc: 0.500
Validation loss decreased (-0.499754 --> -0.499921).  Saving model ...
Epoch: 3 cost time: 16.361713647842407
Epoch: 3, Steps: 70 | Train Loss: 8.038 Vali Loss: 12.656 Vali Acc: 0.500 Test Loss: 12.656 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.452953577041626
Epoch: 4, Steps: 70 | Train Loss: 5.917 Vali Loss: 5.061 Vali Acc: 0.500 Test Loss: 5.061 Test Acc: 0.500
Validation loss decreased (-0.499921 --> -0.499949).  Saving model ...
Epoch: 5 cost time: 19.51794672012329
Epoch: 5, Steps: 70 | Train Loss: 7.529 Vali Loss: 12.423 Vali Acc: 0.500 Test Loss: 12.423 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.774473667144775
Epoch: 6, Steps: 70 | Train Loss: 9.733 Vali Loss: 3.236 Vali Acc: 0.500 Test Loss: 3.236 Test Acc: 0.500
Validation loss decreased (-0.499949 --> -0.499968).  Saving model ...
Epoch: 7 cost time: 16.170533657073975
Epoch: 7, Steps: 70 | Train Loss: 7.607 Vali Loss: 11.883 Vali Acc: 0.500 Test Loss: 11.883 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.57728910446167
Epoch: 8, Steps: 70 | Train Loss: 8.424 Vali Loss: 16.363 Vali Acc: 0.500 Test Loss: 16.363 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.54526138305664
Epoch: 9, Steps: 70 | Train Loss: 11.912 Vali Loss: 2.053 Vali Acc: 0.540 Test Loss: 2.053 Test Acc: 0.540
Validation loss decreased (-0.499968 --> -0.539979).  Saving model ...
Epoch: 10 cost time: 17.855513095855713
Epoch: 10, Steps: 70 | Train Loss: 9.376 Vali Loss: 16.454 Vali Acc: 0.500 Test Loss: 16.454 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.985898971557617
Epoch: 11, Steps: 70 | Train Loss: 11.906 Vali Loss: 3.985 Vali Acc: 0.500 Test Loss: 3.985 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.800344228744507
Epoch: 12, Steps: 70 | Train Loss: 10.163 Vali Loss: 25.145 Vali Acc: 0.500 Test Loss: 25.145 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.712592840194702
Epoch: 13, Steps: 70 | Train Loss: 7.552 Vali Loss: 3.836 Vali Acc: 0.500 Test Loss: 3.836 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.235503673553467
Epoch: 14, Steps: 70 | Train Loss: 8.535 Vali Loss: 20.320 Vali Acc: 0.500 Test Loss: 20.320 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 17.873135328292847
Epoch: 15, Steps: 70 | Train Loss: 6.756 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.545271635055542
Epoch: 16, Steps: 70 | Train Loss: 6.967 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.55918288230896
Epoch: 17, Steps: 70 | Train Loss: 5.273 Vali Loss: 10.824 Vali Acc: 0.500 Test Loss: 10.824 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.63658118247986
Epoch: 18, Steps: 70 | Train Loss: 6.619 Vali Loss: 14.191 Vali Acc: 0.500 Test Loss: 14.191 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 18.643351316452026
Epoch: 19, Steps: 70 | Train Loss: 10.893 Vali Loss: 2.299 Vali Acc: 0.500 Test Loss: 2.299 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 6891558
model size : 28.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.633915901184082
Epoch: 1, Steps: 70 | Train Loss: 19.174 Vali Loss: 19.450 Vali Acc: 0.500 Test Loss: 19.450 Test Acc: 0.500
Validation loss decreased (inf --> -0.499805).  Saving model ...
Epoch: 2 cost time: 15.89966344833374
Epoch: 2, Steps: 70 | Train Loss: 16.757 Vali Loss: 9.944 Vali Acc: 0.500 Test Loss: 9.944 Test Acc: 0.500
Validation loss decreased (-0.499805 --> -0.499901).  Saving model ...
Epoch: 3 cost time: 19.134822607040405
Epoch: 3, Steps: 70 | Train Loss: 16.837 Vali Loss: 0.964 Vali Acc: 0.480 Test Loss: 0.964 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.490910530090332
Epoch: 4, Steps: 70 | Train Loss: 10.601 Vali Loss: 9.144 Vali Acc: 0.500 Test Loss: 9.144 Test Acc: 0.500
Validation loss decreased (-0.499901 --> -0.499909).  Saving model ...
Epoch: 5 cost time: 18.74884819984436
Epoch: 5, Steps: 70 | Train Loss: 11.736 Vali Loss: 37.190 Vali Acc: 0.500 Test Loss: 37.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.140727519989014
Epoch: 6, Steps: 70 | Train Loss: 8.470 Vali Loss: 5.200 Vali Acc: 0.500 Test Loss: 5.200 Test Acc: 0.500
Validation loss decreased (-0.499909 --> -0.499948).  Saving model ...
Epoch: 7 cost time: 19.304346084594727
Epoch: 7, Steps: 70 | Train Loss: 6.669 Vali Loss: 5.738 Vali Acc: 0.500 Test Loss: 5.738 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.273775339126587
Epoch: 8, Steps: 70 | Train Loss: 6.694 Vali Loss: 7.349 Vali Acc: 0.500 Test Loss: 7.349 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.228294849395752
Epoch: 9, Steps: 70 | Train Loss: 13.771 Vali Loss: 39.154 Vali Acc: 0.500 Test Loss: 39.154 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.422734260559082
Epoch: 10, Steps: 70 | Train Loss: 10.915 Vali Loss: 6.606 Vali Acc: 0.500 Test Loss: 6.606 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.297711610794067
Epoch: 11, Steps: 70 | Train Loss: 8.913 Vali Loss: 28.202 Vali Acc: 0.500 Test Loss: 28.202 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 19.21618127822876
Epoch: 12, Steps: 70 | Train Loss: 13.878 Vali Loss: 9.351 Vali Acc: 0.500 Test Loss: 9.351 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.691887855529785
Epoch: 13, Steps: 70 | Train Loss: 14.216 Vali Loss: 17.784 Vali Acc: 0.500 Test Loss: 17.784 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.340659141540527
Epoch: 14, Steps: 70 | Train Loss: 11.226 Vali Loss: 12.090 Vali Acc: 0.500 Test Loss: 12.090 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.317948818206787
Epoch: 15, Steps: 70 | Train Loss: 7.871 Vali Loss: 7.309 Vali Acc: 0.500 Test Loss: 7.309 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 19.40080165863037
Epoch: 16, Steps: 70 | Train Loss: 6.945 Vali Loss: 7.505 Vali Acc: 0.500 Test Loss: 7.505 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 6843558
model size : 28.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.255954265594482
Epoch: 1, Steps: 70 | Train Loss: 11.475 Vali Loss: 12.642 Vali Acc: 0.500 Test Loss: 12.642 Test Acc: 0.500
Validation loss decreased (inf --> -0.499874).  Saving model ...
Epoch: 2 cost time: 18.24974012374878
Epoch: 2, Steps: 70 | Train Loss: 8.959 Vali Loss: 14.570 Vali Acc: 0.500 Test Loss: 14.570 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.750394105911255
Epoch: 3, Steps: 70 | Train Loss: 6.403 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.543678283691406
Epoch: 4, Steps: 70 | Train Loss: 5.951 Vali Loss: 35.265 Vali Acc: 0.500 Test Loss: 35.265 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.024824380874634
Epoch: 5, Steps: 70 | Train Loss: 7.593 Vali Loss: 15.736 Vali Acc: 0.500 Test Loss: 15.736 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.82274317741394
Epoch: 6, Steps: 70 | Train Loss: 5.497 Vali Loss: 8.644 Vali Acc: 0.500 Test Loss: 8.644 Test Acc: 0.500
Validation loss decreased (-0.499874 --> -0.499914).  Saving model ...
Epoch: 7 cost time: 18.476531267166138
Epoch: 7, Steps: 70 | Train Loss: 10.611 Vali Loss: 6.286 Vali Acc: 0.500 Test Loss: 6.286 Test Acc: 0.500
Validation loss decreased (-0.499914 --> -0.499937).  Saving model ...
Epoch: 8 cost time: 15.575506448745728
Epoch: 8, Steps: 70 | Train Loss: 10.393 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.657557487487793
Epoch: 9, Steps: 70 | Train Loss: 8.584 Vali Loss: 8.525 Vali Acc: 0.500 Test Loss: 8.525 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.804069995880127
Epoch: 10, Steps: 70 | Train Loss: 5.341 Vali Loss: 2.837 Vali Acc: 0.500 Test Loss: 2.837 Test Acc: 0.500
Validation loss decreased (-0.499937 --> -0.499972).  Saving model ...
Epoch: 11 cost time: 18.286751747131348
Epoch: 11, Steps: 70 | Train Loss: 8.311 Vali Loss: 9.715 Vali Acc: 0.500 Test Loss: 9.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.610998153686523
Epoch: 12, Steps: 70 | Train Loss: 6.904 Vali Loss: 21.595 Vali Acc: 0.500 Test Loss: 21.595 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.96814274787903
Epoch: 13, Steps: 70 | Train Loss: 5.406 Vali Loss: 11.925 Vali Acc: 0.500 Test Loss: 11.925 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.778910875320435
Epoch: 14, Steps: 70 | Train Loss: 5.145 Vali Loss: 17.974 Vali Acc: 0.500 Test Loss: 17.974 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.22715473175049
Epoch: 15, Steps: 70 | Train Loss: 11.291 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
Validation loss decreased (-0.499972 --> -0.539984).  Saving model ...
Epoch: 16 cost time: 15.526305198669434
Epoch: 16, Steps: 70 | Train Loss: 4.908 Vali Loss: 7.986 Vali Acc: 0.500 Test Loss: 7.986 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.757807731628418
Epoch: 17, Steps: 70 | Train Loss: 5.441 Vali Loss: 2.209 Vali Acc: 0.490 Test Loss: 2.209 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 19.11849331855774
Epoch: 18, Steps: 70 | Train Loss: 3.756 Vali Loss: 1.971 Vali Acc: 0.510 Test Loss: 1.971 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.852004766464233
Epoch: 19, Steps: 70 | Train Loss: 3.432 Vali Loss: 5.744 Vali Acc: 0.500 Test Loss: 5.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.723858118057251
Epoch: 20, Steps: 70 | Train Loss: 4.973 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549986).  Saving model ...
Epoch: 21 cost time: 18.66212511062622
Epoch: 21, Steps: 70 | Train Loss: 6.060 Vali Loss: 19.815 Vali Acc: 0.500 Test Loss: 19.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 18.761603832244873
Epoch: 22, Steps: 70 | Train Loss: 5.294 Vali Loss: 3.160 Vali Acc: 0.500 Test Loss: 3.160 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 17.59861135482788
Epoch: 23, Steps: 70 | Train Loss: 3.316 Vali Loss: 3.031 Vali Acc: 0.500 Test Loss: 3.031 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.387053966522217
Epoch: 24, Steps: 70 | Train Loss: 3.516 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 18.807158946990967
Epoch: 25, Steps: 70 | Train Loss: 2.413 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 18.837376356124878
Epoch: 26, Steps: 70 | Train Loss: 3.957 Vali Loss: 4.489 Vali Acc: 0.500 Test Loss: 4.489 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 17.314168691635132
Epoch: 27, Steps: 70 | Train Loss: 2.387 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 16.496444702148438
Epoch: 28, Steps: 70 | Train Loss: 3.386 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 18.530632495880127
Epoch: 29, Steps: 70 | Train Loss: 1.697 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 18.865743398666382
Epoch: 30, Steps: 70 | Train Loss: 1.831 Vali Loss: 3.969 Vali Acc: 0.500 Test Loss: 3.969 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 6795558
model size : 28.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.636972427368164
Epoch: 1, Steps: 70 | Train Loss: 12.932 Vali Loss: 24.849 Vali Acc: 0.500 Test Loss: 24.849 Test Acc: 0.500
Validation loss decreased (inf --> -0.499752).  Saving model ...
Epoch: 2 cost time: 18.20691180229187
Epoch: 2, Steps: 70 | Train Loss: 26.756 Vali Loss: 33.791 Vali Acc: 0.500 Test Loss: 33.791 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.305533170700073
Epoch: 3, Steps: 70 | Train Loss: 13.282 Vali Loss: 10.264 Vali Acc: 0.500 Test Loss: 10.264 Test Acc: 0.500
Validation loss decreased (-0.499752 --> -0.499897).  Saving model ...
Epoch: 4 cost time: 15.095069885253906
Epoch: 4, Steps: 70 | Train Loss: 5.278 Vali Loss: 6.905 Vali Acc: 0.500 Test Loss: 6.905 Test Acc: 0.500
Validation loss decreased (-0.499897 --> -0.499931).  Saving model ...
Epoch: 5 cost time: 18.23336696624756
Epoch: 5, Steps: 70 | Train Loss: 11.165 Vali Loss: 5.867 Vali Acc: 0.500 Test Loss: 5.867 Test Acc: 0.500
Validation loss decreased (-0.499931 --> -0.499941).  Saving model ...
Epoch: 6 cost time: 18.304720640182495
Epoch: 6, Steps: 70 | Train Loss: 8.190 Vali Loss: 18.167 Vali Acc: 0.500 Test Loss: 18.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.884019136428833
Epoch: 7, Steps: 70 | Train Loss: 7.491 Vali Loss: 9.733 Vali Acc: 0.500 Test Loss: 9.733 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.183041334152222
Epoch: 8, Steps: 70 | Train Loss: 11.433 Vali Loss: 15.644 Vali Acc: 0.500 Test Loss: 15.644 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.52795147895813
Epoch: 9, Steps: 70 | Train Loss: 6.852 Vali Loss: 11.547 Vali Acc: 0.500 Test Loss: 11.547 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 16.73339056968689
Epoch: 10, Steps: 70 | Train Loss: 10.235 Vali Loss: 13.857 Vali Acc: 0.500 Test Loss: 13.857 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.732253074645996
Epoch: 11, Steps: 70 | Train Loss: 5.024 Vali Loss: 27.066 Vali Acc: 0.500 Test Loss: 27.066 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.195862293243408
Epoch: 12, Steps: 70 | Train Loss: 4.991 Vali Loss: 4.554 Vali Acc: 0.510 Test Loss: 4.554 Test Acc: 0.510
Validation loss decreased (-0.499941 --> -0.509954).  Saving model ...
Epoch: 13 cost time: 15.781416177749634
Epoch: 13, Steps: 70 | Train Loss: 9.673 Vali Loss: 10.883 Vali Acc: 0.500 Test Loss: 10.883 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.660884857177734
Epoch: 14, Steps: 70 | Train Loss: 6.036 Vali Loss: 10.474 Vali Acc: 0.490 Test Loss: 10.474 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.79017400741577
Epoch: 15, Steps: 70 | Train Loss: 3.734 Vali Loss: 6.782 Vali Acc: 0.530 Test Loss: 6.782 Test Acc: 0.530
Validation loss decreased (-0.509954 --> -0.529932).  Saving model ...
Epoch: 16 cost time: 14.905292987823486
Epoch: 16, Steps: 70 | Train Loss: 8.497 Vali Loss: 11.173 Vali Acc: 0.500 Test Loss: 11.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 17.802356004714966
Epoch: 17, Steps: 70 | Train Loss: 3.650 Vali Loss: 8.984 Vali Acc: 0.500 Test Loss: 8.984 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.657297372817993
Epoch: 18, Steps: 70 | Train Loss: 6.854 Vali Loss: 7.244 Vali Acc: 0.480 Test Loss: 7.244 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.154736280441284
Epoch: 19, Steps: 70 | Train Loss: 6.511 Vali Loss: 13.619 Vali Acc: 0.510 Test Loss: 13.619 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.39191770553589
Epoch: 20, Steps: 70 | Train Loss: 3.351 Vali Loss: 5.001 Vali Acc: 0.520 Test Loss: 5.001 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 17.936389923095703
Epoch: 21, Steps: 70 | Train Loss: 3.483 Vali Loss: 1.126 Vali Acc: 0.510 Test Loss: 1.126 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 17.725380659103394
Epoch: 22, Steps: 70 | Train Loss: 3.240 Vali Loss: 3.951 Vali Acc: 0.480 Test Loss: 3.951 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 14.985304832458496
Epoch: 23, Steps: 70 | Train Loss: 4.911 Vali Loss: 4.289 Vali Acc: 0.480 Test Loss: 4.289 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 17.940426349639893
Epoch: 24, Steps: 70 | Train Loss: 7.781 Vali Loss: 3.707 Vali Acc: 0.500 Test Loss: 3.707 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 17.8158118724823
Epoch: 25, Steps: 70 | Train Loss: 4.708 Vali Loss: 6.647 Vali Acc: 0.500 Test Loss: 6.647 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 6281638
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.662389755249023
Epoch: 1, Steps: 70 | Train Loss: 14.177 Vali Loss: 14.335 Vali Acc: 0.500 Test Loss: 14.335 Test Acc: 0.500
Validation loss decreased (inf --> -0.499857).  Saving model ...
Epoch: 2 cost time: 17.606565952301025
Epoch: 2, Steps: 70 | Train Loss: 13.440 Vali Loss: 11.075 Vali Acc: 0.500 Test Loss: 11.075 Test Acc: 0.500
Validation loss decreased (-0.499857 --> -0.499889).  Saving model ...
Epoch: 3 cost time: 14.647878885269165
Epoch: 3, Steps: 70 | Train Loss: 7.446 Vali Loss: 15.490 Vali Acc: 0.500 Test Loss: 15.490 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.63927149772644
Epoch: 4, Steps: 70 | Train Loss: 6.466 Vali Loss: 16.195 Vali Acc: 0.500 Test Loss: 16.195 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.7412748336792
Epoch: 5, Steps: 70 | Train Loss: 10.115 Vali Loss: 17.952 Vali Acc: 0.500 Test Loss: 17.952 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.36880588531494
Epoch: 6, Steps: 70 | Train Loss: 5.779 Vali Loss: 13.539 Vali Acc: 0.500 Test Loss: 13.539 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.661999702453613
Epoch: 7, Steps: 70 | Train Loss: 7.764 Vali Loss: 11.039 Vali Acc: 0.500 Test Loss: 11.039 Test Acc: 0.500
Validation loss decreased (-0.499889 --> -0.499890).  Saving model ...
Epoch: 8 cost time: 17.77754282951355
Epoch: 8, Steps: 70 | Train Loss: 5.620 Vali Loss: 19.728 Vali Acc: 0.500 Test Loss: 19.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.024219036102295
Epoch: 9, Steps: 70 | Train Loss: 8.637 Vali Loss: 5.791 Vali Acc: 0.500 Test Loss: 5.791 Test Acc: 0.500
Validation loss decreased (-0.499890 --> -0.499942).  Saving model ...
Epoch: 10 cost time: 14.978246688842773
Epoch: 10, Steps: 70 | Train Loss: 5.477 Vali Loss: 7.521 Vali Acc: 0.500 Test Loss: 7.521 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.03522300720215
Epoch: 11, Steps: 70 | Train Loss: 7.755 Vali Loss: 7.744 Vali Acc: 0.500 Test Loss: 7.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.075032711029053
Epoch: 12, Steps: 70 | Train Loss: 4.233 Vali Loss: 10.474 Vali Acc: 0.500 Test Loss: 10.474 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.096638679504395
Epoch: 13, Steps: 70 | Train Loss: 7.260 Vali Loss: 9.082 Vali Acc: 0.500 Test Loss: 9.082 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.70019245147705
Epoch: 14, Steps: 70 | Train Loss: 7.469 Vali Loss: 5.376 Vali Acc: 0.500 Test Loss: 5.376 Test Acc: 0.500
Validation loss decreased (-0.499942 --> -0.499946).  Saving model ...
Epoch: 15 cost time: 17.856497049331665
Epoch: 15, Steps: 70 | Train Loss: 4.278 Vali Loss: 6.470 Vali Acc: 0.500 Test Loss: 6.470 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.485939264297485
Epoch: 16, Steps: 70 | Train Loss: 4.199 Vali Loss: 3.990 Vali Acc: 0.510 Test Loss: 3.990 Test Acc: 0.510
Validation loss decreased (-0.499946 --> -0.509960).  Saving model ...
Epoch: 17 cost time: 16.519394397735596
Epoch: 17, Steps: 70 | Train Loss: 4.630 Vali Loss: 10.114 Vali Acc: 0.480 Test Loss: 10.114 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.74263644218445
Epoch: 18, Steps: 70 | Train Loss: 4.799 Vali Loss: 2.879 Vali Acc: 0.580 Test Loss: 2.879 Test Acc: 0.580
Validation loss decreased (-0.509960 --> -0.579971).  Saving model ...
Epoch: 19 cost time: 17.62925362586975
Epoch: 19, Steps: 70 | Train Loss: 3.724 Vali Loss: 6.912 Vali Acc: 0.460 Test Loss: 6.912 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.407711029052734
Epoch: 20, Steps: 70 | Train Loss: 4.168 Vali Loss: 17.706 Vali Acc: 0.440 Test Loss: 17.706 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 17.960923433303833
Epoch: 21, Steps: 70 | Train Loss: 6.401 Vali Loss: 5.321 Vali Acc: 0.490 Test Loss: 5.321 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 17.83405375480652
Epoch: 22, Steps: 70 | Train Loss: 2.224 Vali Loss: 10.781 Vali Acc: 0.530 Test Loss: 10.781 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 15.185198068618774
Epoch: 23, Steps: 70 | Train Loss: 3.730 Vali Loss: 5.599 Vali Acc: 0.500 Test Loss: 5.599 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 17.65113115310669
Epoch: 24, Steps: 70 | Train Loss: 4.828 Vali Loss: 2.274 Vali Acc: 0.500 Test Loss: 2.274 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 17.73413109779358
Epoch: 25, Steps: 70 | Train Loss: 1.776 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 16.132797241210938
Epoch: 26, Steps: 70 | Train Loss: 2.311 Vali Loss: 3.244 Vali Acc: 0.500 Test Loss: 3.244 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 16.733867168426514
Epoch: 27, Steps: 70 | Train Loss: 3.099 Vali Loss: 4.483 Vali Acc: 0.500 Test Loss: 4.483 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 17.68015718460083
Epoch: 28, Steps: 70 | Train Loss: 2.438 Vali Loss: 2.165 Vali Acc: 0.500 Test Loss: 2.165 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 6233638
model size : 26.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.779568433761597
Epoch: 1, Steps: 70 | Train Loss: 16.541 Vali Loss: 21.769 Vali Acc: 0.490 Test Loss: 21.769 Test Acc: 0.490
Validation loss decreased (inf --> -0.489782).  Saving model ...
Epoch: 2 cost time: 17.375260591506958
Epoch: 2, Steps: 70 | Train Loss: 21.101 Vali Loss: 6.199 Vali Acc: 0.500 Test Loss: 6.199 Test Acc: 0.500
Validation loss decreased (-0.489782 --> -0.499938).  Saving model ...
Epoch: 3 cost time: 17.19246768951416
Epoch: 3, Steps: 70 | Train Loss: 9.318 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
Validation loss decreased (-0.499938 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 14.901301860809326
Epoch: 4, Steps: 70 | Train Loss: 4.180 Vali Loss: 22.094 Vali Acc: 0.500 Test Loss: 22.094 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.369091987609863
Epoch: 5, Steps: 70 | Train Loss: 8.226 Vali Loss: 7.851 Vali Acc: 0.500 Test Loss: 7.851 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.29568600654602
Epoch: 6, Steps: 70 | Train Loss: 5.428 Vali Loss: 5.546 Vali Acc: 0.500 Test Loss: 5.546 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.192711114883423
Epoch: 7, Steps: 70 | Train Loss: 8.178 Vali Loss: 0.679 Vali Acc: 0.600 Test Loss: 0.679 Test Acc: 0.600
Validation loss decreased (-0.499991 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 16.67279839515686
Epoch: 8, Steps: 70 | Train Loss: 6.070 Vali Loss: 10.097 Vali Acc: 0.500 Test Loss: 10.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.506088256835938
Epoch: 9, Steps: 70 | Train Loss: 6.509 Vali Loss: 8.956 Vali Acc: 0.500 Test Loss: 8.956 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.235562324523926
Epoch: 10, Steps: 70 | Train Loss: 6.499 Vali Loss: 14.066 Vali Acc: 0.500 Test Loss: 14.066 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.134524822235107
Epoch: 11, Steps: 70 | Train Loss: 5.196 Vali Loss: 13.459 Vali Acc: 0.500 Test Loss: 13.459 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.23469114303589
Epoch: 12, Steps: 70 | Train Loss: 6.139 Vali Loss: 1.998 Vali Acc: 0.490 Test Loss: 1.998 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.502472162246704
Epoch: 13, Steps: 70 | Train Loss: 5.817 Vali Loss: 9.812 Vali Acc: 0.500 Test Loss: 9.812 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.133913516998291
Epoch: 14, Steps: 70 | Train Loss: 6.227 Vali Loss: 3.803 Vali Acc: 0.520 Test Loss: 3.803 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.479462146759033
Epoch: 15, Steps: 70 | Train Loss: 6.181 Vali Loss: 9.169 Vali Acc: 0.500 Test Loss: 9.169 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.538235425949097
Epoch: 16, Steps: 70 | Train Loss: 4.983 Vali Loss: 5.417 Vali Acc: 0.580 Test Loss: 5.417 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.775875091552734
Epoch: 17, Steps: 70 | Train Loss: 4.324 Vali Loss: 10.314 Vali Acc: 0.520 Test Loss: 10.314 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6185638
model size : 26.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.934621572494507
Epoch: 1, Steps: 70 | Train Loss: 11.142 Vali Loss: 17.489 Vali Acc: 0.510 Test Loss: 17.489 Test Acc: 0.510
Validation loss decreased (inf --> -0.509825).  Saving model ...
Epoch: 2 cost time: 15.440514326095581
Epoch: 2, Steps: 70 | Train Loss: 24.464 Vali Loss: 25.332 Vali Acc: 0.480 Test Loss: 25.332 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.369594097137451
Epoch: 3, Steps: 70 | Train Loss: 10.248 Vali Loss: 3.886 Vali Acc: 0.500 Test Loss: 3.886 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.90856432914734
Epoch: 4, Steps: 70 | Train Loss: 7.824 Vali Loss: 9.058 Vali Acc: 0.500 Test Loss: 9.058 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.6315438747406
Epoch: 5, Steps: 70 | Train Loss: 4.620 Vali Loss: 14.168 Vali Acc: 0.500 Test Loss: 14.168 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.29667854309082
Epoch: 6, Steps: 70 | Train Loss: 7.324 Vali Loss: 3.367 Vali Acc: 0.500 Test Loss: 3.367 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.697388410568237
Epoch: 7, Steps: 70 | Train Loss: 6.533 Vali Loss: 14.538 Vali Acc: 0.500 Test Loss: 14.538 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.242605209350586
Epoch: 8, Steps: 70 | Train Loss: 5.909 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.018815517425537
Epoch: 9, Steps: 70 | Train Loss: 4.671 Vali Loss: 1.173 Vali Acc: 0.390 Test Loss: 1.173 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.592671155929565
Epoch: 10, Steps: 70 | Train Loss: 4.620 Vali Loss: 4.243 Vali Acc: 0.500 Test Loss: 4.243 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.869033575057983
Epoch: 11, Steps: 70 | Train Loss: 7.611 Vali Loss: 27.695 Vali Acc: 0.500 Test Loss: 27.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 6137638
model size : 25.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.760266542434692
Epoch: 1, Steps: 70 | Train Loss: 16.063 Vali Loss: 20.779 Vali Acc: 0.500 Test Loss: 20.779 Test Acc: 0.500
Validation loss decreased (inf --> -0.499792).  Saving model ...
Epoch: 2 cost time: 16.82601499557495
Epoch: 2, Steps: 70 | Train Loss: 11.227 Vali Loss: 4.045 Vali Acc: 0.500 Test Loss: 4.045 Test Acc: 0.500
Validation loss decreased (-0.499792 --> -0.499960).  Saving model ...
Epoch: 3 cost time: 17.085697412490845
Epoch: 3, Steps: 70 | Train Loss: 7.154 Vali Loss: 10.755 Vali Acc: 0.500 Test Loss: 10.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.414004564285278
Epoch: 4, Steps: 70 | Train Loss: 7.065 Vali Loss: 8.305 Vali Acc: 0.500 Test Loss: 8.305 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.13391399383545
Epoch: 5, Steps: 70 | Train Loss: 6.452 Vali Loss: 2.953 Vali Acc: 0.500 Test Loss: 2.953 Test Acc: 0.500
Validation loss decreased (-0.499960 --> -0.499970).  Saving model ...
Epoch: 6 cost time: 17.036442041397095
Epoch: 6, Steps: 70 | Train Loss: 7.651 Vali Loss: 9.332 Vali Acc: 0.500 Test Loss: 9.332 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.531489372253418
Epoch: 7, Steps: 70 | Train Loss: 6.061 Vali Loss: 11.704 Vali Acc: 0.500 Test Loss: 11.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.782526969909668
Epoch: 8, Steps: 70 | Train Loss: 7.392 Vali Loss: 2.683 Vali Acc: 0.490 Test Loss: 2.683 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.108670234680176
Epoch: 9, Steps: 70 | Train Loss: 5.947 Vali Loss: 5.668 Vali Acc: 0.500 Test Loss: 5.668 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.29228401184082
Epoch: 10, Steps: 70 | Train Loss: 7.395 Vali Loss: 8.769 Vali Acc: 0.500 Test Loss: 8.769 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.412353754043579
Epoch: 11, Steps: 70 | Train Loss: 4.416 Vali Loss: 1.855 Vali Acc: 0.500 Test Loss: 1.855 Test Acc: 0.500
Validation loss decreased (-0.499970 --> -0.499981).  Saving model ...
Epoch: 12 cost time: 17.128122806549072
Epoch: 12, Steps: 70 | Train Loss: 3.906 Vali Loss: 9.072 Vali Acc: 0.500 Test Loss: 9.072 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.24578332901001
Epoch: 13, Steps: 70 | Train Loss: 3.493 Vali Loss: 18.261 Vali Acc: 0.500 Test Loss: 18.261 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.278404474258423
Epoch: 14, Steps: 70 | Train Loss: 23.499 Vali Loss: 54.394 Vali Acc: 0.500 Test Loss: 54.394 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.981528997421265
Epoch: 15, Steps: 70 | Train Loss: 11.971 Vali Loss: 3.320 Vali Acc: 0.500 Test Loss: 3.320 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.788862228393555
Epoch: 16, Steps: 70 | Train Loss: 5.783 Vali Loss: 5.221 Vali Acc: 0.500 Test Loss: 5.221 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.883415699005127
Epoch: 17, Steps: 70 | Train Loss: 8.206 Vali Loss: 10.511 Vali Acc: 0.500 Test Loss: 10.511 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.451204776763916
Epoch: 18, Steps: 70 | Train Loss: 4.977 Vali Loss: 3.152 Vali Acc: 0.500 Test Loss: 3.152 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.15248942375183
Epoch: 19, Steps: 70 | Train Loss: 5.611 Vali Loss: 1.828 Vali Acc: 0.500 Test Loss: 1.828 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499982).  Saving model ...
Epoch: 20 cost time: 16.912526845932007
Epoch: 20, Steps: 70 | Train Loss: 3.380 Vali Loss: 6.181 Vali Acc: 0.500 Test Loss: 6.181 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 15.481736898422241
Epoch: 21, Steps: 70 | Train Loss: 7.195 Vali Loss: 2.006 Vali Acc: 0.510 Test Loss: 2.006 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509980).  Saving model ...
Epoch: 22 cost time: 15.912689924240112
Epoch: 22, Steps: 70 | Train Loss: 2.301 Vali Loss: 1.808 Vali Acc: 0.500 Test Loss: 1.808 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 17.229736804962158
Epoch: 23, Steps: 70 | Train Loss: 2.549 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 17.003164052963257
Epoch: 24, Steps: 70 | Train Loss: 2.761 Vali Loss: 12.107 Vali Acc: 0.500 Test Loss: 12.107 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 14.404706478118896
Epoch: 25, Steps: 70 | Train Loss: 2.340 Vali Loss: 2.402 Vali Acc: 0.500 Test Loss: 2.402 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 12.316099405288696
Epoch: 26, Steps: 70 | Train Loss: 2.427 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 15.875365972518921
Epoch: 27, Steps: 70 | Train Loss: 2.048 Vali Loss: 2.144 Vali Acc: 0.500 Test Loss: 2.144 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 15.765710830688477
Epoch: 28, Steps: 70 | Train Loss: 1.518 Vali Loss: 3.469 Vali Acc: 0.500 Test Loss: 3.469 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 14.045299768447876
Epoch: 29, Steps: 70 | Train Loss: 1.522 Vali Loss: 2.116 Vali Acc: 0.500 Test Loss: 2.116 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 15.496836185455322
Epoch: 30, Steps: 70 | Train Loss: 1.649 Vali Loss: 2.530 Vali Acc: 0.500 Test Loss: 2.530 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 15.224823951721191
Epoch: 31, Steps: 70 | Train Loss: 1.770 Vali Loss: 2.756 Vali Acc: 0.500 Test Loss: 2.756 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5952678
model size : 25.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.509546041488647
Epoch: 1, Steps: 70 | Train Loss: 21.677 Vali Loss: 33.835 Vali Acc: 0.500 Test Loss: 33.835 Test Acc: 0.500
Validation loss decreased (inf --> -0.499662).  Saving model ...
Epoch: 2 cost time: 14.992509126663208
Epoch: 2, Steps: 70 | Train Loss: 14.206 Vali Loss: 8.917 Vali Acc: 0.500 Test Loss: 8.917 Test Acc: 0.500
Validation loss decreased (-0.499662 --> -0.499911).  Saving model ...
Epoch: 3 cost time: 14.46504545211792
Epoch: 3, Steps: 70 | Train Loss: 13.128 Vali Loss: 19.265 Vali Acc: 0.500 Test Loss: 19.265 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.62024188041687
Epoch: 4, Steps: 70 | Train Loss: 10.856 Vali Loss: 1.784 Vali Acc: 0.510 Test Loss: 1.784 Test Acc: 0.510
Validation loss decreased (-0.499911 --> -0.509982).  Saving model ...
Epoch: 5 cost time: 14.763318538665771
Epoch: 5, Steps: 70 | Train Loss: 5.953 Vali Loss: 5.184 Vali Acc: 0.500 Test Loss: 5.184 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.28781247138977
Epoch: 6, Steps: 70 | Train Loss: 10.232 Vali Loss: 12.671 Vali Acc: 0.500 Test Loss: 12.671 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.57556438446045
Epoch: 7, Steps: 70 | Train Loss: 5.429 Vali Loss: 11.440 Vali Acc: 0.500 Test Loss: 11.440 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.429569005966187
Epoch: 8, Steps: 70 | Train Loss: 3.013 Vali Loss: 13.069 Vali Acc: 0.500 Test Loss: 13.069 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.436306715011597
Epoch: 9, Steps: 70 | Train Loss: 8.453 Vali Loss: 1.513 Vali Acc: 0.490 Test Loss: 1.513 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.66782283782959
Epoch: 10, Steps: 70 | Train Loss: 6.050 Vali Loss: 3.716 Vali Acc: 0.510 Test Loss: 3.716 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.845504522323608
Epoch: 11, Steps: 70 | Train Loss: 6.175 Vali Loss: 16.279 Vali Acc: 0.500 Test Loss: 16.279 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.525524854660034
Epoch: 12, Steps: 70 | Train Loss: 7.197 Vali Loss: 3.907 Vali Acc: 0.510 Test Loss: 3.907 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.71874475479126
Epoch: 13, Steps: 70 | Train Loss: 4.508 Vali Loss: 2.204 Vali Acc: 0.510 Test Loss: 2.204 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.324538469314575
Epoch: 14, Steps: 70 | Train Loss: 5.153 Vali Loss: 3.736 Vali Acc: 0.510 Test Loss: 3.736 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5904678
model size : 25.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.676729679107666
Epoch: 1, Steps: 70 | Train Loss: 9.859 Vali Loss: 25.080 Vali Acc: 0.500 Test Loss: 25.080 Test Acc: 0.500
Validation loss decreased (inf --> -0.499749).  Saving model ...
Epoch: 2 cost time: 13.588349342346191
Epoch: 2, Steps: 70 | Train Loss: 29.651 Vali Loss: 4.800 Vali Acc: 0.500 Test Loss: 4.800 Test Acc: 0.500
Validation loss decreased (-0.499749 --> -0.499952).  Saving model ...
Epoch: 3 cost time: 15.965038299560547
Epoch: 3, Steps: 70 | Train Loss: 12.045 Vali Loss: 17.702 Vali Acc: 0.500 Test Loss: 17.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.946579456329346
Epoch: 4, Steps: 70 | Train Loss: 8.520 Vali Loss: 14.119 Vali Acc: 0.500 Test Loss: 14.119 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.62570333480835
Epoch: 5, Steps: 70 | Train Loss: 9.192 Vali Loss: 7.114 Vali Acc: 0.500 Test Loss: 7.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.863343238830566
Epoch: 6, Steps: 70 | Train Loss: 6.843 Vali Loss: 9.206 Vali Acc: 0.500 Test Loss: 9.206 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.76140308380127
Epoch: 7, Steps: 70 | Train Loss: 7.971 Vali Loss: 1.651 Vali Acc: 0.510 Test Loss: 1.651 Test Acc: 0.510
Validation loss decreased (-0.499952 --> -0.509983).  Saving model ...
Epoch: 8 cost time: 13.725683689117432
Epoch: 8, Steps: 70 | Train Loss: 5.649 Vali Loss: 5.056 Vali Acc: 0.500 Test Loss: 5.056 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.85068130493164
Epoch: 9, Steps: 70 | Train Loss: 2.909 Vali Loss: 16.172 Vali Acc: 0.500 Test Loss: 16.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.632546424865723
Epoch: 10, Steps: 70 | Train Loss: 7.970 Vali Loss: 12.669 Vali Acc: 0.500 Test Loss: 12.669 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.724231243133545
Epoch: 11, Steps: 70 | Train Loss: 5.762 Vali Loss: 9.840 Vali Acc: 0.500 Test Loss: 9.840 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.412834882736206
Epoch: 12, Steps: 70 | Train Loss: 9.334 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
Validation loss decreased (-0.509983 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 15.856434106826782
Epoch: 13, Steps: 70 | Train Loss: 4.526 Vali Loss: 1.244 Vali Acc: 0.610 Test Loss: 1.244 Test Acc: 0.610
Validation loss decreased (-0.599990 --> -0.609988).  Saving model ...
Epoch: 14 cost time: 13.609213590621948
Epoch: 14, Steps: 70 | Train Loss: 6.468 Vali Loss: 7.224 Vali Acc: 0.480 Test Loss: 7.224 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.50882625579834
Epoch: 15, Steps: 70 | Train Loss: 5.193 Vali Loss: 2.695 Vali Acc: 0.510 Test Loss: 2.695 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.509860754013062
Epoch: 16, Steps: 70 | Train Loss: 8.026 Vali Loss: 8.108 Vali Acc: 0.500 Test Loss: 8.108 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.858476638793945
Epoch: 17, Steps: 70 | Train Loss: 3.674 Vali Loss: 8.350 Vali Acc: 0.500 Test Loss: 8.350 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.53110408782959
Epoch: 18, Steps: 70 | Train Loss: 5.730 Vali Loss: 12.130 Vali Acc: 0.500 Test Loss: 12.130 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.737925291061401
Epoch: 19, Steps: 70 | Train Loss: 4.104 Vali Loss: 10.287 Vali Acc: 0.520 Test Loss: 10.287 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.930172681808472
Epoch: 20, Steps: 70 | Train Loss: 3.580 Vali Loss: 3.864 Vali Acc: 0.500 Test Loss: 3.864 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.917354583740234
Epoch: 21, Steps: 70 | Train Loss: 2.304 Vali Loss: 8.056 Vali Acc: 0.510 Test Loss: 8.056 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.535474061965942
Epoch: 22, Steps: 70 | Train Loss: 1.829 Vali Loss: 10.805 Vali Acc: 0.520 Test Loss: 10.805 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 14.193973779678345
Epoch: 23, Steps: 70 | Train Loss: 2.920 Vali Loss: 17.841 Vali Acc: 0.440 Test Loss: 17.841 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5856678
model size : 24.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.66613245010376
Epoch: 1, Steps: 70 | Train Loss: 12.224 Vali Loss: 16.009 Vali Acc: 0.520 Test Loss: 16.009 Test Acc: 0.520
Validation loss decreased (inf --> -0.519840).  Saving model ...
Epoch: 2 cost time: 15.145350933074951
Epoch: 2, Steps: 70 | Train Loss: 26.014 Vali Loss: 4.655 Vali Acc: 0.490 Test Loss: 4.655 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.343048334121704
Epoch: 3, Steps: 70 | Train Loss: 9.203 Vali Loss: 26.516 Vali Acc: 0.500 Test Loss: 26.516 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.564196586608887
Epoch: 4, Steps: 70 | Train Loss: 9.828 Vali Loss: 4.231 Vali Acc: 0.500 Test Loss: 4.231 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.81313943862915
Epoch: 5, Steps: 70 | Train Loss: 9.241 Vali Loss: 3.385 Vali Acc: 0.500 Test Loss: 3.385 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.244978189468384
Epoch: 6, Steps: 70 | Train Loss: 5.952 Vali Loss: 11.474 Vali Acc: 0.500 Test Loss: 11.474 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.983753681182861
Epoch: 7, Steps: 70 | Train Loss: 7.230 Vali Loss: 5.748 Vali Acc: 0.500 Test Loss: 5.748 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.430131673812866
Epoch: 8, Steps: 70 | Train Loss: 6.244 Vali Loss: 9.315 Vali Acc: 0.500 Test Loss: 9.315 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.97394323348999
Epoch: 9, Steps: 70 | Train Loss: 7.091 Vali Loss: 12.557 Vali Acc: 0.500 Test Loss: 12.557 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.257487535476685
Epoch: 10, Steps: 70 | Train Loss: 9.114 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.700844049453735
Epoch: 11, Steps: 70 | Train Loss: 8.077 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 5808678
model size : 24.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.417506694793701
Epoch: 1, Steps: 70 | Train Loss: 12.133 Vali Loss: 5.673 Vali Acc: 0.510 Test Loss: 5.673 Test Acc: 0.510
Validation loss decreased (inf --> -0.509943).  Saving model ...
Epoch: 2 cost time: 15.09218454360962
Epoch: 2, Steps: 70 | Train Loss: 14.677 Vali Loss: 14.247 Vali Acc: 0.450 Test Loss: 14.247 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.30355191230774
Epoch: 3, Steps: 70 | Train Loss: 16.278 Vali Loss: 2.823 Vali Acc: 0.500 Test Loss: 2.823 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.049477577209473
Epoch: 4, Steps: 70 | Train Loss: 13.286 Vali Loss: 18.329 Vali Acc: 0.500 Test Loss: 18.329 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.875503778457642
Epoch: 5, Steps: 70 | Train Loss: 5.982 Vali Loss: 9.888 Vali Acc: 0.500 Test Loss: 9.888 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.756900787353516
Epoch: 6, Steps: 70 | Train Loss: 7.592 Vali Loss: 5.611 Vali Acc: 0.500 Test Loss: 5.611 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.366334915161133
Epoch: 7, Steps: 70 | Train Loss: 11.608 Vali Loss: 15.526 Vali Acc: 0.500 Test Loss: 15.526 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.363797426223755
Epoch: 8, Steps: 70 | Train Loss: 7.621 Vali Loss: 29.918 Vali Acc: 0.500 Test Loss: 29.918 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.021530389785767
Epoch: 9, Steps: 70 | Train Loss: 10.602 Vali Loss: 11.159 Vali Acc: 0.500 Test Loss: 11.159 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.731134176254272
Epoch: 10, Steps: 70 | Train Loss: 9.502 Vali Loss: 20.993 Vali Acc: 0.500 Test Loss: 20.993 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.569515466690063
Epoch: 11, Steps: 70 | Train Loss: 5.538 Vali Loss: 10.008 Vali Acc: 0.500 Test Loss: 10.008 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5788198
model size : 24.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.366215705871582
Epoch: 1, Steps: 70 | Train Loss: 9.355 Vali Loss: 15.598 Vali Acc: 0.450 Test Loss: 15.598 Test Acc: 0.450
Validation loss decreased (inf --> -0.449844).  Saving model ...
Epoch: 2 cost time: 14.71155309677124
Epoch: 2, Steps: 70 | Train Loss: 26.770 Vali Loss: 27.619 Vali Acc: 0.500 Test Loss: 27.619 Test Acc: 0.500
Validation loss decreased (-0.449844 --> -0.499724).  Saving model ...
Epoch: 3 cost time: 15.062054634094238
Epoch: 3, Steps: 70 | Train Loss: 13.579 Vali Loss: 5.305 Vali Acc: 0.500 Test Loss: 5.305 Test Acc: 0.500
Validation loss decreased (-0.499724 --> -0.499947).  Saving model ...
Epoch: 4 cost time: 13.21509075164795
Epoch: 4, Steps: 70 | Train Loss: 7.094 Vali Loss: 4.102 Vali Acc: 0.500 Test Loss: 4.102 Test Acc: 0.500
Validation loss decreased (-0.499947 --> -0.499959).  Saving model ...
Epoch: 5 cost time: 14.985502481460571
Epoch: 5, Steps: 70 | Train Loss: 3.671 Vali Loss: 12.639 Vali Acc: 0.500 Test Loss: 12.639 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.30962586402893
Epoch: 6, Steps: 70 | Train Loss: 6.908 Vali Loss: 17.047 Vali Acc: 0.500 Test Loss: 17.047 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.1666259765625
Epoch: 7, Steps: 70 | Train Loss: 6.174 Vali Loss: 7.309 Vali Acc: 0.500 Test Loss: 7.309 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.045270204544067
Epoch: 8, Steps: 70 | Train Loss: 7.102 Vali Loss: 15.289 Vali Acc: 0.500 Test Loss: 15.289 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.87557864189148
Epoch: 9, Steps: 70 | Train Loss: 7.483 Vali Loss: 7.776 Vali Acc: 0.500 Test Loss: 7.776 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.058992862701416
Epoch: 10, Steps: 70 | Train Loss: 7.434 Vali Loss: 27.311 Vali Acc: 0.500 Test Loss: 27.311 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.77844524383545
Epoch: 11, Steps: 70 | Train Loss: 6.949 Vali Loss: 5.301 Vali Acc: 0.500 Test Loss: 5.301 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.208731889724731
Epoch: 12, Steps: 70 | Train Loss: 5.260 Vali Loss: 1.009 Vali Acc: 0.540 Test Loss: 1.009 Test Acc: 0.540
Validation loss decreased (-0.499959 --> -0.539990).  Saving model ...
Epoch: 13 cost time: 13.103612184524536
Epoch: 13, Steps: 70 | Train Loss: 7.118 Vali Loss: 3.972 Vali Acc: 0.500 Test Loss: 3.972 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.076665163040161
Epoch: 14, Steps: 70 | Train Loss: 5.823 Vali Loss: 3.149 Vali Acc: 0.510 Test Loss: 3.149 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 15.173856496810913
Epoch: 15, Steps: 70 | Train Loss: 3.580 Vali Loss: 13.876 Vali Acc: 0.500 Test Loss: 13.876 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.056610822677612
Epoch: 16, Steps: 70 | Train Loss: 5.976 Vali Loss: 6.714 Vali Acc: 0.520 Test Loss: 6.714 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.301482677459717
Epoch: 17, Steps: 70 | Train Loss: 4.083 Vali Loss: 12.624 Vali Acc: 0.500 Test Loss: 12.624 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.919123888015747
Epoch: 18, Steps: 70 | Train Loss: 3.722 Vali Loss: 8.823 Vali Acc: 0.500 Test Loss: 8.823 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.39749026298523
Epoch: 19, Steps: 70 | Train Loss: 7.633 Vali Loss: 3.180 Vali Acc: 0.500 Test Loss: 3.180 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.388414859771729
Epoch: 20, Steps: 70 | Train Loss: 3.583 Vali Loss: 4.137 Vali Acc: 0.500 Test Loss: 4.137 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.97325611114502
Epoch: 21, Steps: 70 | Train Loss: 2.522 Vali Loss: 2.427 Vali Acc: 0.590 Test Loss: 2.427 Test Acc: 0.590
Validation loss decreased (-0.539990 --> -0.589976).  Saving model ...
Epoch: 22 cost time: 14.034806489944458
Epoch: 22, Steps: 70 | Train Loss: 1.853 Vali Loss: 6.464 Vali Acc: 0.490 Test Loss: 6.464 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.607266664505005
Epoch: 23, Steps: 70 | Train Loss: 2.448 Vali Loss: 9.172 Vali Acc: 0.520 Test Loss: 9.172 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 14.95882511138916
Epoch: 24, Steps: 70 | Train Loss: 1.665 Vali Loss: 4.632 Vali Acc: 0.550 Test Loss: 4.632 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.616935729980469
Epoch: 25, Steps: 70 | Train Loss: 1.878 Vali Loss: 7.676 Vali Acc: 0.450 Test Loss: 7.676 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.48710036277771
Epoch: 26, Steps: 70 | Train Loss: 7.844 Vali Loss: 12.341 Vali Acc: 0.560 Test Loss: 12.341 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.102398157119751
Epoch: 27, Steps: 70 | Train Loss: 21.387 Vali Loss: 44.513 Vali Acc: 0.500 Test Loss: 44.513 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 13.778201341629028
Epoch: 28, Steps: 70 | Train Loss: 27.015 Vali Loss: 25.072 Vali Acc: 0.500 Test Loss: 25.072 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 14.989061117172241
Epoch: 29, Steps: 70 | Train Loss: 14.089 Vali Loss: 26.505 Vali Acc: 0.500 Test Loss: 26.505 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 13.238563776016235
Epoch: 30, Steps: 70 | Train Loss: 6.806 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 14.636619091033936
Epoch: 31, Steps: 70 | Train Loss: 5.254 Vali Loss: 1.805 Vali Acc: 0.500 Test Loss: 1.805 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5740198
model size : 24.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.93431282043457
Epoch: 1, Steps: 70 | Train Loss: 12.470 Vali Loss: 4.956 Vali Acc: 0.500 Test Loss: 4.956 Test Acc: 0.500
Validation loss decreased (inf --> -0.499950).  Saving model ...
Epoch: 2 cost time: 14.51382565498352
Epoch: 2, Steps: 70 | Train Loss: 14.097 Vali Loss: 8.528 Vali Acc: 0.500 Test Loss: 8.528 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.297385931015015
Epoch: 3, Steps: 70 | Train Loss: 6.654 Vali Loss: 14.232 Vali Acc: 0.500 Test Loss: 14.232 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.213658571243286
Epoch: 4, Steps: 70 | Train Loss: 7.091 Vali Loss: 14.844 Vali Acc: 0.500 Test Loss: 14.844 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.53783655166626
Epoch: 5, Steps: 70 | Train Loss: 9.104 Vali Loss: 10.399 Vali Acc: 0.500 Test Loss: 10.399 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.324692964553833
Epoch: 6, Steps: 70 | Train Loss: 6.767 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.499950 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 14.22034215927124
Epoch: 7, Steps: 70 | Train Loss: 7.184 Vali Loss: 3.112 Vali Acc: 0.510 Test Loss: 3.112 Test Acc: 0.510
Validation loss decreased (-0.499987 --> -0.509969).  Saving model ...
Epoch: 8 cost time: 12.902716875076294
Epoch: 8, Steps: 70 | Train Loss: 6.882 Vali Loss: 2.685 Vali Acc: 0.500 Test Loss: 2.685 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.094384908676147
Epoch: 9, Steps: 70 | Train Loss: 3.956 Vali Loss: 8.344 Vali Acc: 0.500 Test Loss: 8.344 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.7825345993042
Epoch: 10, Steps: 70 | Train Loss: 8.028 Vali Loss: 1.564 Vali Acc: 0.500 Test Loss: 1.564 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.573329210281372
Epoch: 11, Steps: 70 | Train Loss: 9.791 Vali Loss: 20.810 Vali Acc: 0.500 Test Loss: 20.810 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.843536615371704
Epoch: 12, Steps: 70 | Train Loss: 10.823 Vali Loss: 15.248 Vali Acc: 0.500 Test Loss: 15.248 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.362040996551514
Epoch: 13, Steps: 70 | Train Loss: 6.433 Vali Loss: 3.114 Vali Acc: 0.530 Test Loss: 3.114 Test Acc: 0.530
Validation loss decreased (-0.509969 --> -0.529969).  Saving model ...
Epoch: 14 cost time: 14.03052830696106
Epoch: 14, Steps: 70 | Train Loss: 4.550 Vali Loss: 5.157 Vali Acc: 0.550 Test Loss: 5.157 Test Acc: 0.550
Validation loss decreased (-0.529969 --> -0.549948).  Saving model ...
Epoch: 15 cost time: 14.235792636871338
Epoch: 15, Steps: 70 | Train Loss: 4.975 Vali Loss: 5.933 Vali Acc: 0.510 Test Loss: 5.933 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.146153450012207
Epoch: 16, Steps: 70 | Train Loss: 2.960 Vali Loss: 9.391 Vali Acc: 0.500 Test Loss: 9.391 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.5077805519104
Epoch: 17, Steps: 70 | Train Loss: 3.239 Vali Loss: 2.078 Vali Acc: 0.670 Test Loss: 2.078 Test Acc: 0.670
Validation loss decreased (-0.549948 --> -0.669979).  Saving model ...
Epoch: 18 cost time: 14.96225118637085
Epoch: 18, Steps: 70 | Train Loss: 3.810 Vali Loss: 5.482 Vali Acc: 0.500 Test Loss: 5.482 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.57719874382019
Epoch: 19, Steps: 70 | Train Loss: 3.259 Vali Loss: 14.562 Vali Acc: 0.550 Test Loss: 14.562 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.946275234222412
Epoch: 20, Steps: 70 | Train Loss: 2.962 Vali Loss: 5.100 Vali Acc: 0.500 Test Loss: 5.100 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.736249208450317
Epoch: 21, Steps: 70 | Train Loss: 3.344 Vali Loss: 3.372 Vali Acc: 0.500 Test Loss: 3.372 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 14.90787148475647
Epoch: 22, Steps: 70 | Train Loss: 1.374 Vali Loss: 6.401 Vali Acc: 0.510 Test Loss: 6.401 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.869833707809448
Epoch: 23, Steps: 70 | Train Loss: 3.030 Vali Loss: 5.272 Vali Acc: 0.500 Test Loss: 5.272 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 14.649894952774048
Epoch: 24, Steps: 70 | Train Loss: 1.836 Vali Loss: 14.464 Vali Acc: 0.500 Test Loss: 14.464 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.581249237060547
Epoch: 25, Steps: 70 | Train Loss: 2.481 Vali Loss: 3.647 Vali Acc: 0.510 Test Loss: 3.647 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 14.691704988479614
Epoch: 26, Steps: 70 | Train Loss: 2.195 Vali Loss: 2.946 Vali Acc: 0.500 Test Loss: 2.946 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 14.218283653259277
Epoch: 27, Steps: 70 | Train Loss: 2.374 Vali Loss: 1.049 Vali Acc: 0.520 Test Loss: 1.049 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 5692198
model size : 24.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.483999252319336
Epoch: 1, Steps: 70 | Train Loss: 11.377 Vali Loss: 13.318 Vali Acc: 0.500 Test Loss: 13.318 Test Acc: 0.500
Validation loss decreased (inf --> -0.499867).  Saving model ...
Epoch: 2 cost time: 13.849628210067749
Epoch: 2, Steps: 70 | Train Loss: 30.228 Vali Loss: 31.495 Vali Acc: 0.510 Test Loss: 31.495 Test Acc: 0.510
Validation loss decreased (-0.499867 --> -0.509685).  Saving model ...
Epoch: 3 cost time: 13.123967170715332
Epoch: 3, Steps: 70 | Train Loss: 16.729 Vali Loss: 21.887 Vali Acc: 0.500 Test Loss: 21.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.950230836868286
Epoch: 4, Steps: 70 | Train Loss: 5.856 Vali Loss: 9.327 Vali Acc: 0.500 Test Loss: 9.327 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.742077112197876
Epoch: 5, Steps: 70 | Train Loss: 6.499 Vali Loss: 13.001 Vali Acc: 0.500 Test Loss: 13.001 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.214879274368286
Epoch: 6, Steps: 70 | Train Loss: 3.807 Vali Loss: 1.486 Vali Acc: 0.500 Test Loss: 1.486 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.424891233444214
Epoch: 7, Steps: 70 | Train Loss: 7.085 Vali Loss: 13.479 Vali Acc: 0.500 Test Loss: 13.479 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.008175611495972
Epoch: 8, Steps: 70 | Train Loss: 4.748 Vali Loss: 8.645 Vali Acc: 0.500 Test Loss: 8.645 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.042585372924805
Epoch: 9, Steps: 70 | Train Loss: 13.353 Vali Loss: 6.617 Vali Acc: 0.500 Test Loss: 6.617 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.911887407302856
Epoch: 10, Steps: 70 | Train Loss: 8.216 Vali Loss: 1.853 Vali Acc: 0.480 Test Loss: 1.853 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.970714092254639
Epoch: 11, Steps: 70 | Train Loss: 6.249 Vali Loss: 26.602 Vali Acc: 0.470 Test Loss: 26.602 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.53432321548462
Epoch: 12, Steps: 70 | Train Loss: 8.436 Vali Loss: 7.767 Vali Acc: 0.430 Test Loss: 7.767 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5644198
model size : 24.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.058961153030396
Epoch: 1, Steps: 70 | Train Loss: 4.959 Vali Loss: 10.585 Vali Acc: 0.500 Test Loss: 10.585 Test Acc: 0.500
Validation loss decreased (inf --> -0.499894).  Saving model ...
Epoch: 2 cost time: 13.144617319107056
Epoch: 2, Steps: 70 | Train Loss: 10.826 Vali Loss: 3.736 Vali Acc: 0.500 Test Loss: 3.736 Test Acc: 0.500
Validation loss decreased (-0.499894 --> -0.499963).  Saving model ...
Epoch: 3 cost time: 11.986276149749756
Epoch: 3, Steps: 70 | Train Loss: 5.237 Vali Loss: 3.468 Vali Acc: 0.500 Test Loss: 3.468 Test Acc: 0.500
Validation loss decreased (-0.499963 --> -0.499965).  Saving model ...
Epoch: 4 cost time: 13.973150253295898
Epoch: 4, Steps: 70 | Train Loss: 4.713 Vali Loss: 8.700 Vali Acc: 0.500 Test Loss: 8.700 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.061123371124268
Epoch: 5, Steps: 70 | Train Loss: 9.275 Vali Loss: 6.068 Vali Acc: 0.500 Test Loss: 6.068 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.193344831466675
Epoch: 6, Steps: 70 | Train Loss: 5.853 Vali Loss: 8.323 Vali Acc: 0.500 Test Loss: 8.323 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.615687370300293
Epoch: 7, Steps: 70 | Train Loss: 6.627 Vali Loss: 4.388 Vali Acc: 0.500 Test Loss: 4.388 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.614544153213501
Epoch: 8, Steps: 70 | Train Loss: 4.654 Vali Loss: 5.922 Vali Acc: 0.500 Test Loss: 5.922 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.22445297241211
Epoch: 9, Steps: 70 | Train Loss: 3.124 Vali Loss: 3.741 Vali Acc: 0.500 Test Loss: 3.741 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.243080615997314
Epoch: 10, Steps: 70 | Train Loss: 5.575 Vali Loss: 2.696 Vali Acc: 0.500 Test Loss: 2.696 Test Acc: 0.500
Validation loss decreased (-0.499965 --> -0.499973).  Saving model ...
Epoch: 11 cost time: 14.322787761688232
Epoch: 11, Steps: 70 | Train Loss: 6.391 Vali Loss: 7.949 Vali Acc: 0.500 Test Loss: 7.949 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.133279800415039
Epoch: 12, Steps: 70 | Train Loss: 5.460 Vali Loss: 2.700 Vali Acc: 0.500 Test Loss: 2.700 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.372835874557495
Epoch: 13, Steps: 70 | Train Loss: 2.379 Vali Loss: 7.720 Vali Acc: 0.500 Test Loss: 7.720 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.132142543792725
Epoch: 14, Steps: 70 | Train Loss: 4.958 Vali Loss: 2.028 Vali Acc: 0.450 Test Loss: 2.028 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.26971960067749
Epoch: 15, Steps: 70 | Train Loss: 3.187 Vali Loss: 1.096 Vali Acc: 0.480 Test Loss: 1.096 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.803000450134277
Epoch: 16, Steps: 70 | Train Loss: 2.711 Vali Loss: 2.408 Vali Acc: 0.430 Test Loss: 2.408 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.03855013847351
Epoch: 17, Steps: 70 | Train Loss: 4.508 Vali Loss: 7.011 Vali Acc: 0.500 Test Loss: 7.011 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.165085077285767
Epoch: 18, Steps: 70 | Train Loss: 3.367 Vali Loss: 5.776 Vali Acc: 0.450 Test Loss: 5.776 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.224886178970337
Epoch: 19, Steps: 70 | Train Loss: 2.428 Vali Loss: 4.164 Vali Acc: 0.450 Test Loss: 4.164 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.29142451286316
Epoch: 20, Steps: 70 | Train Loss: 3.403 Vali Loss: 11.848 Vali Acc: 0.460 Test Loss: 11.848 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 3144678
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.543105602264404
Epoch: 1, Steps: 70 | Train Loss: 12.360 Vali Loss: 4.503 Vali Acc: 0.500 Test Loss: 4.503 Test Acc: 0.500
Validation loss decreased (inf --> -0.499955).  Saving model ...
Epoch: 2 cost time: 14.337733268737793
Epoch: 2, Steps: 70 | Train Loss: 7.908 Vali Loss: 17.729 Vali Acc: 0.500 Test Loss: 17.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.382781744003296
Epoch: 3, Steps: 70 | Train Loss: 6.608 Vali Loss: 7.687 Vali Acc: 0.500 Test Loss: 7.687 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.532286643981934
Epoch: 4, Steps: 70 | Train Loss: 3.460 Vali Loss: 2.052 Vali Acc: 0.500 Test Loss: 2.052 Test Acc: 0.500
Validation loss decreased (-0.499955 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 13.392097234725952
Epoch: 5, Steps: 70 | Train Loss: 6.085 Vali Loss: 21.402 Vali Acc: 0.500 Test Loss: 21.402 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.51421570777893
Epoch: 6, Steps: 70 | Train Loss: 6.829 Vali Loss: 20.911 Vali Acc: 0.500 Test Loss: 20.911 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.552804231643677
Epoch: 7, Steps: 70 | Train Loss: 8.223 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (-0.499979 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 14.135939598083496
Epoch: 8, Steps: 70 | Train Loss: 7.200 Vali Loss: 13.546 Vali Acc: 0.500 Test Loss: 13.546 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.354469537734985
Epoch: 9, Steps: 70 | Train Loss: 7.370 Vali Loss: 23.274 Vali Acc: 0.500 Test Loss: 23.274 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.6547110080719
Epoch: 10, Steps: 70 | Train Loss: 7.413 Vali Loss: 15.356 Vali Acc: 0.500 Test Loss: 15.356 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.426448583602905
Epoch: 11, Steps: 70 | Train Loss: 3.939 Vali Loss: 7.096 Vali Acc: 0.500 Test Loss: 7.096 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.409036636352539
Epoch: 12, Steps: 70 | Train Loss: 4.433 Vali Loss: 8.323 Vali Acc: 0.500 Test Loss: 8.323 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.81037974357605
Epoch: 13, Steps: 70 | Train Loss: 3.547 Vali Loss: 2.064 Vali Acc: 0.490 Test Loss: 2.064 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.565476655960083
Epoch: 14, Steps: 70 | Train Loss: 5.556 Vali Loss: 2.815 Vali Acc: 0.500 Test Loss: 2.815 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.413441896438599
Epoch: 15, Steps: 70 | Train Loss: 6.672 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 14.539797306060791
Epoch: 16, Steps: 70 | Train Loss: 3.779 Vali Loss: 1.986 Vali Acc: 0.530 Test Loss: 1.986 Test Acc: 0.530
Validation loss decreased (-0.499988 --> -0.529980).  Saving model ...
Epoch: 17 cost time: 14.632116794586182
Epoch: 17, Steps: 70 | Train Loss: 2.656 Vali Loss: 4.579 Vali Acc: 0.490 Test Loss: 4.579 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.318920612335205
Epoch: 18, Steps: 70 | Train Loss: 2.240 Vali Loss: 4.290 Vali Acc: 0.500 Test Loss: 4.290 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.092041015625
Epoch: 19, Steps: 70 | Train Loss: 3.199 Vali Loss: 2.088 Vali Acc: 0.510 Test Loss: 2.088 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.46376633644104
Epoch: 20, Steps: 70 | Train Loss: 2.040 Vali Loss: 2.428 Vali Acc: 0.510 Test Loss: 2.428 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 14.493942022323608
Epoch: 21, Steps: 70 | Train Loss: 3.623 Vali Loss: 3.931 Vali Acc: 0.510 Test Loss: 3.931 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.379018306732178
Epoch: 22, Steps: 70 | Train Loss: 2.767 Vali Loss: 11.332 Vali Acc: 0.540 Test Loss: 11.332 Test Acc: 0.540
Validation loss decreased (-0.529980 --> -0.539887).  Saving model ...
Epoch: 23 cost time: 12.218474388122559
Epoch: 23, Steps: 70 | Train Loss: 5.188 Vali Loss: 16.610 Vali Acc: 0.500 Test Loss: 16.610 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 14.308263063430786
Epoch: 24, Steps: 70 | Train Loss: 1.768 Vali Loss: 5.720 Vali Acc: 0.490 Test Loss: 5.720 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 14.268512487411499
Epoch: 25, Steps: 70 | Train Loss: 0.432 Vali Loss: 10.502 Vali Acc: 0.500 Test Loss: 10.502 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.377835035324097
Epoch: 26, Steps: 70 | Train Loss: 0.797 Vali Loss: 24.814 Vali Acc: 0.400 Test Loss: 24.814 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.630608558654785
Epoch: 27, Steps: 70 | Train Loss: 1.193 Vali Loss: 8.654 Vali Acc: 0.550 Test Loss: 8.654 Test Acc: 0.550
Validation loss decreased (-0.539887 --> -0.549913).  Saving model ...
Epoch: 28 cost time: 12.898049354553223
Epoch: 28, Steps: 70 | Train Loss: 0.442 Vali Loss: 22.740 Vali Acc: 0.430 Test Loss: 22.740 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 14.272804975509644
Epoch: 29, Steps: 70 | Train Loss: 0.342 Vali Loss: 11.394 Vali Acc: 0.530 Test Loss: 11.394 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 14.23204231262207
Epoch: 30, Steps: 70 | Train Loss: 0.259 Vali Loss: 8.810 Vali Acc: 0.570 Test Loss: 8.810 Test Acc: 0.570
Validation loss decreased (-0.549913 --> -0.569912).  Saving model ...
Epoch: 31 cost time: 14.048541784286499
Epoch: 31, Steps: 70 | Train Loss: 0.501 Vali Loss: 25.977 Vali Acc: 0.510 Test Loss: 25.977 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 12.37310242652893
Epoch: 32, Steps: 70 | Train Loss: 0.587 Vali Loss: 28.787 Vali Acc: 0.460 Test Loss: 28.787 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 13.824622631072998
Epoch: 33, Steps: 70 | Train Loss: 0.287 Vali Loss: 28.613 Vali Acc: 0.450 Test Loss: 28.613 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 14.361112833023071
Epoch: 34, Steps: 70 | Train Loss: 0.393 Vali Loss: 23.203 Vali Acc: 0.510 Test Loss: 23.203 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 14.218315601348877
Epoch: 35, Steps: 70 | Train Loss: 0.234 Vali Loss: 39.433 Vali Acc: 0.460 Test Loss: 39.433 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 13.89966869354248
Epoch: 36, Steps: 70 | Train Loss: 0.501 Vali Loss: 43.416 Vali Acc: 0.450 Test Loss: 43.416 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 12.2315993309021
Epoch: 37, Steps: 70 | Train Loss: 0.031 Vali Loss: 23.835 Vali Acc: 0.490 Test Loss: 23.835 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 14.726551294326782
Epoch: 38, Steps: 70 | Train Loss: 0.064 Vali Loss: 23.908 Vali Acc: 0.480 Test Loss: 23.908 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 14.625033855438232
Epoch: 39, Steps: 70 | Train Loss: 0.314 Vali Loss: 25.437 Vali Acc: 0.540 Test Loss: 25.437 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 14.712402820587158
Epoch: 40, Steps: 70 | Train Loss: 0.273 Vali Loss: 34.833 Vali Acc: 0.440 Test Loss: 34.833 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3120678
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.209671258926392
Epoch: 1, Steps: 70 | Train Loss: 5.042 Vali Loss: 9.091 Vali Acc: 0.500 Test Loss: 9.091 Test Acc: 0.500
Validation loss decreased (inf --> -0.499909).  Saving model ...
Epoch: 2 cost time: 13.85920000076294
Epoch: 2, Steps: 70 | Train Loss: 13.349 Vali Loss: 10.165 Vali Acc: 0.490 Test Loss: 10.165 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.018070459365845
Epoch: 3, Steps: 70 | Train Loss: 10.146 Vali Loss: 5.111 Vali Acc: 0.500 Test Loss: 5.111 Test Acc: 0.500
Validation loss decreased (-0.499909 --> -0.499949).  Saving model ...
Epoch: 4 cost time: 12.253906726837158
Epoch: 4, Steps: 70 | Train Loss: 3.820 Vali Loss: 12.039 Vali Acc: 0.500 Test Loss: 12.039 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.33551287651062
Epoch: 5, Steps: 70 | Train Loss: 7.343 Vali Loss: 12.280 Vali Acc: 0.500 Test Loss: 12.280 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.876112222671509
Epoch: 6, Steps: 70 | Train Loss: 8.199 Vali Loss: 16.904 Vali Acc: 0.500 Test Loss: 16.904 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.003801107406616
Epoch: 7, Steps: 70 | Train Loss: 4.595 Vali Loss: 9.707 Vali Acc: 0.500 Test Loss: 9.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.95466136932373
Epoch: 8, Steps: 70 | Train Loss: 6.881 Vali Loss: 6.148 Vali Acc: 0.500 Test Loss: 6.148 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.043762922286987
Epoch: 9, Steps: 70 | Train Loss: 3.360 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
Validation loss decreased (-0.499949 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 12.557641506195068
Epoch: 10, Steps: 70 | Train Loss: 4.335 Vali Loss: 3.820 Vali Acc: 0.500 Test Loss: 3.820 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.735889196395874
Epoch: 11, Steps: 70 | Train Loss: 3.692 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.819113731384277
Epoch: 12, Steps: 70 | Train Loss: 2.935 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539984).  Saving model ...
Epoch: 13 cost time: 13.956019163131714
Epoch: 13, Steps: 70 | Train Loss: 3.131 Vali Loss: 7.065 Vali Acc: 0.500 Test Loss: 7.065 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.848726749420166
Epoch: 14, Steps: 70 | Train Loss: 5.965 Vali Loss: 8.197 Vali Acc: 0.520 Test Loss: 8.197 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.140068054199219
Epoch: 15, Steps: 70 | Train Loss: 5.029 Vali Loss: 5.710 Vali Acc: 0.510 Test Loss: 5.710 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.845065832138062
Epoch: 16, Steps: 70 | Train Loss: 4.360 Vali Loss: 3.190 Vali Acc: 0.420 Test Loss: 3.190 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.031598806381226
Epoch: 17, Steps: 70 | Train Loss: 4.732 Vali Loss: 5.794 Vali Acc: 0.470 Test Loss: 5.794 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.762473344802856
Epoch: 18, Steps: 70 | Train Loss: 3.916 Vali Loss: 1.586 Vali Acc: 0.560 Test Loss: 1.586 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559984).  Saving model ...
Epoch: 19 cost time: 11.93814992904663
Epoch: 19, Steps: 70 | Train Loss: 1.867 Vali Loss: 2.845 Vali Acc: 0.530 Test Loss: 2.845 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.710533142089844
Epoch: 20, Steps: 70 | Train Loss: 2.257 Vali Loss: 4.423 Vali Acc: 0.590 Test Loss: 4.423 Test Acc: 0.590
Validation loss decreased (-0.559984 --> -0.589956).  Saving model ...
Epoch: 21 cost time: 10.570046186447144
Epoch: 21, Steps: 70 | Train Loss: 2.050 Vali Loss: 10.446 Vali Acc: 0.500 Test Loss: 10.446 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.39733362197876
Epoch: 22, Steps: 70 | Train Loss: 1.659 Vali Loss: 7.378 Vali Acc: 0.490 Test Loss: 7.378 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 13.440057754516602
Epoch: 23, Steps: 70 | Train Loss: 1.345 Vali Loss: 9.295 Vali Acc: 0.400 Test Loss: 9.295 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.986736297607422
Epoch: 24, Steps: 70 | Train Loss: 1.213 Vali Loss: 7.471 Vali Acc: 0.520 Test Loss: 7.471 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.710664987564087
Epoch: 25, Steps: 70 | Train Loss: 0.269 Vali Loss: 14.727 Vali Acc: 0.500 Test Loss: 14.727 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 13.47573184967041
Epoch: 26, Steps: 70 | Train Loss: 0.318 Vali Loss: 24.593 Vali Acc: 0.410 Test Loss: 24.593 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 13.3929762840271
Epoch: 27, Steps: 70 | Train Loss: 0.543 Vali Loss: 13.654 Vali Acc: 0.420 Test Loss: 13.654 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.438655853271484
Epoch: 28, Steps: 70 | Train Loss: 0.317 Vali Loss: 16.969 Vali Acc: 0.470 Test Loss: 16.969 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.717123985290527
Epoch: 29, Steps: 70 | Train Loss: 0.493 Vali Loss: 14.351 Vali Acc: 0.510 Test Loss: 14.351 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 13.527724742889404
Epoch: 30, Steps: 70 | Train Loss: 0.344 Vali Loss: 31.516 Vali Acc: 0.430 Test Loss: 31.516 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3096678
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.715436697006226
Epoch: 1, Steps: 70 | Train Loss: 4.172 Vali Loss: 14.922 Vali Acc: 0.500 Test Loss: 14.922 Test Acc: 0.500
Validation loss decreased (inf --> -0.499851).  Saving model ...
Epoch: 2 cost time: 11.667128086090088
Epoch: 2, Steps: 70 | Train Loss: 7.093 Vali Loss: 22.728 Vali Acc: 0.500 Test Loss: 22.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.367257595062256
Epoch: 3, Steps: 70 | Train Loss: 10.686 Vali Loss: 15.220 Vali Acc: 0.500 Test Loss: 15.220 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.348331928253174
Epoch: 4, Steps: 70 | Train Loss: 7.667 Vali Loss: 11.374 Vali Acc: 0.500 Test Loss: 11.374 Test Acc: 0.500
Validation loss decreased (-0.499851 --> -0.499886).  Saving model ...
Epoch: 5 cost time: 13.303231477737427
Epoch: 5, Steps: 70 | Train Loss: 5.235 Vali Loss: 10.054 Vali Acc: 0.500 Test Loss: 10.054 Test Acc: 0.500
Validation loss decreased (-0.499886 --> -0.499899).  Saving model ...
Epoch: 6 cost time: 11.82196593284607
Epoch: 6, Steps: 70 | Train Loss: 4.237 Vali Loss: 11.009 Vali Acc: 0.500 Test Loss: 11.009 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.466609239578247
Epoch: 7, Steps: 70 | Train Loss: 4.394 Vali Loss: 3.117 Vali Acc: 0.500 Test Loss: 3.117 Test Acc: 0.500
Validation loss decreased (-0.499899 --> -0.499969).  Saving model ...
Epoch: 8 cost time: 13.444682598114014
Epoch: 8, Steps: 70 | Train Loss: 4.412 Vali Loss: 8.867 Vali Acc: 0.500 Test Loss: 8.867 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.382284879684448
Epoch: 9, Steps: 70 | Train Loss: 5.032 Vali Loss: 6.090 Vali Acc: 0.500 Test Loss: 6.090 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.678332567214966
Epoch: 10, Steps: 70 | Train Loss: 3.379 Vali Loss: 3.823 Vali Acc: 0.450 Test Loss: 3.823 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.379402160644531
Epoch: 11, Steps: 70 | Train Loss: 4.837 Vali Loss: 3.078 Vali Acc: 0.510 Test Loss: 3.078 Test Acc: 0.510
Validation loss decreased (-0.499969 --> -0.509969).  Saving model ...
Epoch: 12 cost time: 13.40398907661438
Epoch: 12, Steps: 70 | Train Loss: 3.341 Vali Loss: 11.857 Vali Acc: 0.500 Test Loss: 11.857 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.333897113800049
Epoch: 13, Steps: 70 | Train Loss: 3.363 Vali Loss: 5.503 Vali Acc: 0.500 Test Loss: 5.503 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.765079736709595
Epoch: 14, Steps: 70 | Train Loss: 4.938 Vali Loss: 6.849 Vali Acc: 0.440 Test Loss: 6.849 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.27348804473877
Epoch: 15, Steps: 70 | Train Loss: 2.206 Vali Loss: 2.292 Vali Acc: 0.510 Test Loss: 2.292 Test Acc: 0.510
Validation loss decreased (-0.509969 --> -0.509977).  Saving model ...
Epoch: 16 cost time: 13.180054426193237
Epoch: 16, Steps: 70 | Train Loss: 1.751 Vali Loss: 18.483 Vali Acc: 0.450 Test Loss: 18.483 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.378875017166138
Epoch: 17, Steps: 70 | Train Loss: 2.984 Vali Loss: 5.729 Vali Acc: 0.520 Test Loss: 5.729 Test Acc: 0.520
Validation loss decreased (-0.509977 --> -0.519943).  Saving model ...
Epoch: 18 cost time: 11.673031330108643
Epoch: 18, Steps: 70 | Train Loss: 5.843 Vali Loss: 8.565 Vali Acc: 0.500 Test Loss: 8.565 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.085866689682007
Epoch: 19, Steps: 70 | Train Loss: 2.520 Vali Loss: 6.375 Vali Acc: 0.540 Test Loss: 6.375 Test Acc: 0.540
Validation loss decreased (-0.519943 --> -0.539936).  Saving model ...
Epoch: 20 cost time: 13.49064326286316
Epoch: 20, Steps: 70 | Train Loss: 2.527 Vali Loss: 18.111 Vali Acc: 0.510 Test Loss: 18.111 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.499306201934814
Epoch: 21, Steps: 70 | Train Loss: 2.134 Vali Loss: 8.831 Vali Acc: 0.470 Test Loss: 8.831 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.507257461547852
Epoch: 22, Steps: 70 | Train Loss: 2.029 Vali Loss: 52.802 Vali Acc: 0.420 Test Loss: 52.802 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.647414207458496
Epoch: 23, Steps: 70 | Train Loss: 1.662 Vali Loss: 22.226 Vali Acc: 0.510 Test Loss: 22.226 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.426279067993164
Epoch: 24, Steps: 70 | Train Loss: 2.568 Vali Loss: 12.889 Vali Acc: 0.550 Test Loss: 12.889 Test Acc: 0.550
Validation loss decreased (-0.539936 --> -0.549871).  Saving model ...
Epoch: 25 cost time: 13.363165616989136
Epoch: 25, Steps: 70 | Train Loss: 3.314 Vali Loss: 24.355 Vali Acc: 0.490 Test Loss: 24.355 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 12.071687459945679
Epoch: 26, Steps: 70 | Train Loss: 1.013 Vali Loss: 7.745 Vali Acc: 0.520 Test Loss: 7.745 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 12.371315717697144
Epoch: 27, Steps: 70 | Train Loss: 0.298 Vali Loss: 17.346 Vali Acc: 0.530 Test Loss: 17.346 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 13.221837997436523
Epoch: 28, Steps: 70 | Train Loss: 0.379 Vali Loss: 15.820 Vali Acc: 0.520 Test Loss: 15.820 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 13.450606107711792
Epoch: 29, Steps: 70 | Train Loss: 0.588 Vali Loss: 11.254 Vali Acc: 0.530 Test Loss: 11.254 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 12.51207447052002
Epoch: 30, Steps: 70 | Train Loss: 0.371 Vali Loss: 14.890 Vali Acc: 0.520 Test Loss: 14.890 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 12.026832580566406
Epoch: 31, Steps: 70 | Train Loss: 0.147 Vali Loss: 20.152 Vali Acc: 0.540 Test Loss: 20.152 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 13.442222118377686
Epoch: 32, Steps: 70 | Train Loss: 0.223 Vali Loss: 9.936 Vali Acc: 0.560 Test Loss: 9.936 Test Acc: 0.560
Validation loss decreased (-0.549871 --> -0.559901).  Saving model ...
Epoch: 33 cost time: 13.405096769332886
Epoch: 33, Steps: 70 | Train Loss: 0.892 Vali Loss: 15.378 Vali Acc: 0.520 Test Loss: 15.378 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 12.617512226104736
Epoch: 34, Steps: 70 | Train Loss: 0.386 Vali Loss: 24.921 Vali Acc: 0.440 Test Loss: 24.921 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 11.566945314407349
Epoch: 35, Steps: 70 | Train Loss: 1.054 Vali Loss: 24.703 Vali Acc: 0.460 Test Loss: 24.703 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 13.24199104309082
Epoch: 36, Steps: 70 | Train Loss: 1.523 Vali Loss: 30.204 Vali Acc: 0.440 Test Loss: 30.204 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 13.316619396209717
Epoch: 37, Steps: 70 | Train Loss: 1.354 Vali Loss: 18.383 Vali Acc: 0.480 Test Loss: 18.383 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 13.296997308731079
Epoch: 38, Steps: 70 | Train Loss: 0.411 Vali Loss: 31.464 Vali Acc: 0.480 Test Loss: 31.464 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 11.494291067123413
Epoch: 39, Steps: 70 | Train Loss: 0.262 Vali Loss: 20.477 Vali Acc: 0.570 Test Loss: 20.477 Test Acc: 0.570
Validation loss decreased (-0.559901 --> -0.569795).  Saving model ...
Epoch: 40 cost time: 13.168819189071655
Epoch: 40, Steps: 70 | Train Loss: 0.545 Vali Loss: 33.725 Vali Acc: 0.500 Test Loss: 33.725 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 13.342618227005005
Epoch: 41, Steps: 70 | Train Loss: 0.000 Vali Loss: 33.110 Vali Acc: 0.460 Test Loss: 33.110 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 13.357390642166138
Epoch: 42, Steps: 70 | Train Loss: 0.088 Vali Loss: 38.735 Vali Acc: 0.450 Test Loss: 38.735 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 11.684491395950317
Epoch: 43, Steps: 70 | Train Loss: 0.354 Vali Loss: 23.405 Vali Acc: 0.500 Test Loss: 23.405 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 13.413504838943481
Epoch: 44, Steps: 70 | Train Loss: 0.379 Vali Loss: 27.402 Vali Acc: 0.430 Test Loss: 27.402 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 13.503991842269897
Epoch: 45, Steps: 70 | Train Loss: 0.000 Vali Loss: 30.976 Vali Acc: 0.450 Test Loss: 30.976 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 13.505974531173706
Epoch: 46, Steps: 70 | Train Loss: 0.001 Vali Loss: 37.069 Vali Acc: 0.410 Test Loss: 37.069 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 11.599018573760986
Epoch: 47, Steps: 70 | Train Loss: 0.222 Vali Loss: 39.428 Vali Acc: 0.440 Test Loss: 39.428 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 12.982736349105835
Epoch: 48, Steps: 70 | Train Loss: 0.233 Vali Loss: 32.600 Vali Acc: 0.470 Test Loss: 32.600 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 13.24931812286377
Epoch: 49, Steps: 70 | Train Loss: 0.655 Vali Loss: 22.085 Vali Acc: 0.460 Test Loss: 22.085 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3072678
model size : 13.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.211751461029053
Epoch: 1, Steps: 70 | Train Loss: 7.038 Vali Loss: 18.830 Vali Acc: 0.490 Test Loss: 18.830 Test Acc: 0.490
Validation loss decreased (inf --> -0.489812).  Saving model ...
Epoch: 2 cost time: 12.77147650718689
Epoch: 2, Steps: 70 | Train Loss: 5.502 Vali Loss: 12.862 Vali Acc: 0.500 Test Loss: 12.862 Test Acc: 0.500
Validation loss decreased (-0.489812 --> -0.499871).  Saving model ...
Epoch: 3 cost time: 12.970224142074585
Epoch: 3, Steps: 70 | Train Loss: 4.927 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
Validation loss decreased (-0.499871 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 13.063932180404663
Epoch: 4, Steps: 70 | Train Loss: 4.225 Vali Loss: 2.686 Vali Acc: 0.500 Test Loss: 2.686 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.431587219238281
Epoch: 5, Steps: 70 | Train Loss: 7.458 Vali Loss: 0.873 Vali Acc: 0.500 Test Loss: 0.873 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.058768272399902
Epoch: 6, Steps: 70 | Train Loss: 4.920 Vali Loss: 7.694 Vali Acc: 0.500 Test Loss: 7.694 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.934820652008057
Epoch: 7, Steps: 70 | Train Loss: 7.094 Vali Loss: 3.207 Vali Acc: 0.500 Test Loss: 3.207 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.365736246109009
Epoch: 8, Steps: 70 | Train Loss: 4.825 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.475478172302246
Epoch: 9, Steps: 70 | Train Loss: 4.356 Vali Loss: 1.594 Vali Acc: 0.620 Test Loss: 1.594 Test Acc: 0.620
Validation loss decreased (-0.539992 --> -0.619984).  Saving model ...
Epoch: 10 cost time: 13.318121194839478
Epoch: 10, Steps: 70 | Train Loss: 6.105 Vali Loss: 1.003 Vali Acc: 0.560 Test Loss: 1.003 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.313445806503296
Epoch: 11, Steps: 70 | Train Loss: 3.552 Vali Loss: 6.782 Vali Acc: 0.500 Test Loss: 6.782 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.354055643081665
Epoch: 12, Steps: 70 | Train Loss: 6.074 Vali Loss: 1.037 Vali Acc: 0.520 Test Loss: 1.037 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.487928628921509
Epoch: 13, Steps: 70 | Train Loss: 4.875 Vali Loss: 2.195 Vali Acc: 0.500 Test Loss: 2.195 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.201399326324463
Epoch: 14, Steps: 70 | Train Loss: 3.758 Vali Loss: 4.475 Vali Acc: 0.480 Test Loss: 4.475 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.239013433456421
Epoch: 15, Steps: 70 | Train Loss: 2.529 Vali Loss: 2.835 Vali Acc: 0.580 Test Loss: 2.835 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.19575023651123
Epoch: 16, Steps: 70 | Train Loss: 4.892 Vali Loss: 2.249 Vali Acc: 0.620 Test Loss: 2.249 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.42465615272522
Epoch: 17, Steps: 70 | Train Loss: 1.895 Vali Loss: 7.868 Vali Acc: 0.500 Test Loss: 7.868 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.855618476867676
Epoch: 18, Steps: 70 | Train Loss: 1.183 Vali Loss: 5.697 Vali Acc: 0.430 Test Loss: 5.697 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.699492692947388
Epoch: 19, Steps: 70 | Train Loss: 1.691 Vali Loss: 2.139 Vali Acc: 0.520 Test Loss: 2.139 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2814438
model size : 12.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.351237297058105
Epoch: 1, Steps: 70 | Train Loss: 7.338 Vali Loss: 25.052 Vali Acc: 0.500 Test Loss: 25.052 Test Acc: 0.500
Validation loss decreased (inf --> -0.499749).  Saving model ...
Epoch: 2 cost time: 12.140822172164917
Epoch: 2, Steps: 70 | Train Loss: 13.216 Vali Loss: 9.978 Vali Acc: 0.500 Test Loss: 9.978 Test Acc: 0.500
Validation loss decreased (-0.499749 --> -0.499900).  Saving model ...
Epoch: 3 cost time: 12.751744985580444
Epoch: 3, Steps: 70 | Train Loss: 8.194 Vali Loss: 4.177 Vali Acc: 0.490 Test Loss: 4.177 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.484755992889404
Epoch: 4, Steps: 70 | Train Loss: 3.587 Vali Loss: 3.100 Vali Acc: 0.500 Test Loss: 3.100 Test Acc: 0.500
Validation loss decreased (-0.499900 --> -0.499969).  Saving model ...
Epoch: 5 cost time: 11.41553521156311
Epoch: 5, Steps: 70 | Train Loss: 4.840 Vali Loss: 5.998 Vali Acc: 0.500 Test Loss: 5.998 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.652925729751587
Epoch: 6, Steps: 70 | Train Loss: 3.907 Vali Loss: 0.843 Vali Acc: 0.450 Test Loss: 0.843 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.65982961654663
Epoch: 7, Steps: 70 | Train Loss: 4.200 Vali Loss: 13.821 Vali Acc: 0.500 Test Loss: 13.821 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.264346837997437
Epoch: 8, Steps: 70 | Train Loss: 4.843 Vali Loss: 7.881 Vali Acc: 0.500 Test Loss: 7.881 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.734660625457764
Epoch: 9, Steps: 70 | Train Loss: 4.799 Vali Loss: 5.336 Vali Acc: 0.500 Test Loss: 5.336 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.761736869812012
Epoch: 10, Steps: 70 | Train Loss: 4.105 Vali Loss: 7.922 Vali Acc: 0.500 Test Loss: 7.922 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.824065446853638
Epoch: 11, Steps: 70 | Train Loss: 4.509 Vali Loss: 7.145 Vali Acc: 0.500 Test Loss: 7.145 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.134947299957275
Epoch: 12, Steps: 70 | Train Loss: 2.369 Vali Loss: 3.609 Vali Acc: 0.490 Test Loss: 3.609 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.834145307540894
Epoch: 13, Steps: 70 | Train Loss: 6.195 Vali Loss: 4.710 Vali Acc: 0.500 Test Loss: 4.710 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.619526863098145
Epoch: 14, Steps: 70 | Train Loss: 4.341 Vali Loss: 4.915 Vali Acc: 0.590 Test Loss: 4.915 Test Acc: 0.590
Validation loss decreased (-0.499969 --> -0.589951).  Saving model ...
Epoch: 15 cost time: 11.252708673477173
Epoch: 15, Steps: 70 | Train Loss: 4.559 Vali Loss: 8.943 Vali Acc: 0.500 Test Loss: 8.943 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.61152458190918
Epoch: 16, Steps: 70 | Train Loss: 5.087 Vali Loss: 9.463 Vali Acc: 0.510 Test Loss: 9.463 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.923733234405518
Epoch: 17, Steps: 70 | Train Loss: 2.988 Vali Loss: 10.622 Vali Acc: 0.520 Test Loss: 10.622 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.262937307357788
Epoch: 18, Steps: 70 | Train Loss: 2.764 Vali Loss: 5.709 Vali Acc: 0.540 Test Loss: 5.709 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.49217176437378
Epoch: 19, Steps: 70 | Train Loss: 1.432 Vali Loss: 3.847 Vali Acc: 0.540 Test Loss: 3.847 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.650681734085083
Epoch: 20, Steps: 70 | Train Loss: 3.944 Vali Loss: 27.884 Vali Acc: 0.460 Test Loss: 27.884 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.128895044326782
Epoch: 21, Steps: 70 | Train Loss: 9.623 Vali Loss: 30.152 Vali Acc: 0.470 Test Loss: 30.152 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.640139102935791
Epoch: 22, Steps: 70 | Train Loss: 5.781 Vali Loss: 3.202 Vali Acc: 0.450 Test Loss: 3.202 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.523733854293823
Epoch: 23, Steps: 70 | Train Loss: 22.246 Vali Loss: 11.877 Vali Acc: 0.500 Test Loss: 11.877 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 12.588958024978638
Epoch: 24, Steps: 70 | Train Loss: 6.789 Vali Loss: 2.946 Vali Acc: 0.500 Test Loss: 2.946 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2790438
model size : 11.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.298407316207886
Epoch: 1, Steps: 70 | Train Loss: 7.736 Vali Loss: 14.226 Vali Acc: 0.500 Test Loss: 14.226 Test Acc: 0.500
Validation loss decreased (inf --> -0.499858).  Saving model ...
Epoch: 2 cost time: 11.55924129486084
Epoch: 2, Steps: 70 | Train Loss: 7.864 Vali Loss: 18.345 Vali Acc: 0.500 Test Loss: 18.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.160140752792358
Epoch: 3, Steps: 70 | Train Loss: 5.634 Vali Loss: 7.887 Vali Acc: 0.500 Test Loss: 7.887 Test Acc: 0.500
Validation loss decreased (-0.499858 --> -0.499921).  Saving model ...
Epoch: 4 cost time: 12.184664011001587
Epoch: 4, Steps: 70 | Train Loss: 5.510 Vali Loss: 1.841 Vali Acc: 0.500 Test Loss: 1.841 Test Acc: 0.500
Validation loss decreased (-0.499921 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 12.393081903457642
Epoch: 5, Steps: 70 | Train Loss: 6.637 Vali Loss: 17.416 Vali Acc: 0.500 Test Loss: 17.416 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.922461986541748
Epoch: 6, Steps: 70 | Train Loss: 6.957 Vali Loss: 15.261 Vali Acc: 0.500 Test Loss: 15.261 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.271536588668823
Epoch: 7, Steps: 70 | Train Loss: 4.561 Vali Loss: 4.631 Vali Acc: 0.500 Test Loss: 4.631 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.324782133102417
Epoch: 8, Steps: 70 | Train Loss: 5.278 Vali Loss: 7.493 Vali Acc: 0.500 Test Loss: 7.493 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.523905992507935
Epoch: 9, Steps: 70 | Train Loss: 6.069 Vali Loss: 3.846 Vali Acc: 0.510 Test Loss: 3.846 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509962).  Saving model ...
Epoch: 10 cost time: 11.322139501571655
Epoch: 10, Steps: 70 | Train Loss: 6.041 Vali Loss: 16.475 Vali Acc: 0.500 Test Loss: 16.475 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.07674527168274
Epoch: 11, Steps: 70 | Train Loss: 8.089 Vali Loss: 11.269 Vali Acc: 0.500 Test Loss: 11.269 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.29978060722351
Epoch: 12, Steps: 70 | Train Loss: 3.124 Vali Loss: 1.729 Vali Acc: 0.490 Test Loss: 1.729 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.982436418533325
Epoch: 13, Steps: 70 | Train Loss: 2.333 Vali Loss: 3.703 Vali Acc: 0.450 Test Loss: 3.703 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.318256378173828
Epoch: 14, Steps: 70 | Train Loss: 1.677 Vali Loss: 3.989 Vali Acc: 0.470 Test Loss: 3.989 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.35592246055603
Epoch: 15, Steps: 70 | Train Loss: 3.356 Vali Loss: 7.615 Vali Acc: 0.500 Test Loss: 7.615 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.385245561599731
Epoch: 16, Steps: 70 | Train Loss: 3.698 Vali Loss: 13.026 Vali Acc: 0.500 Test Loss: 13.026 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.690387964248657
Epoch: 17, Steps: 70 | Train Loss: 2.473 Vali Loss: 4.941 Vali Acc: 0.550 Test Loss: 4.941 Test Acc: 0.550
Validation loss decreased (-0.509962 --> -0.549951).  Saving model ...
Epoch: 18 cost time: 12.171622276306152
Epoch: 18, Steps: 70 | Train Loss: 3.233 Vali Loss: 13.793 Vali Acc: 0.430 Test Loss: 13.793 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.250504493713379
Epoch: 19, Steps: 70 | Train Loss: 2.617 Vali Loss: 16.660 Vali Acc: 0.530 Test Loss: 16.660 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.884562253952026
Epoch: 20, Steps: 70 | Train Loss: 2.007 Vali Loss: 5.098 Vali Acc: 0.490 Test Loss: 5.098 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.186256408691406
Epoch: 21, Steps: 70 | Train Loss: 1.434 Vali Loss: 7.377 Vali Acc: 0.510 Test Loss: 7.377 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.161286354064941
Epoch: 22, Steps: 70 | Train Loss: 1.577 Vali Loss: 17.925 Vali Acc: 0.510 Test Loss: 17.925 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.888583898544312
Epoch: 23, Steps: 70 | Train Loss: 1.596 Vali Loss: 27.198 Vali Acc: 0.480 Test Loss: 27.198 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.894916296005249
Epoch: 24, Steps: 70 | Train Loss: 0.703 Vali Loss: 12.389 Vali Acc: 0.500 Test Loss: 12.389 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.465410232543945
Epoch: 25, Steps: 70 | Train Loss: 0.888 Vali Loss: 25.427 Vali Acc: 0.490 Test Loss: 25.427 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.995933294296265
Epoch: 26, Steps: 70 | Train Loss: 1.027 Vali Loss: 12.944 Vali Acc: 0.540 Test Loss: 12.944 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.849634408950806
Epoch: 27, Steps: 70 | Train Loss: 0.567 Vali Loss: 16.221 Vali Acc: 0.510 Test Loss: 16.221 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2766438
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.34535527229309
Epoch: 1, Steps: 70 | Train Loss: 7.834 Vali Loss: 3.457 Vali Acc: 0.510 Test Loss: 3.457 Test Acc: 0.510
Validation loss decreased (inf --> -0.509965).  Saving model ...
Epoch: 2 cost time: 11.380265235900879
Epoch: 2, Steps: 70 | Train Loss: 8.513 Vali Loss: 17.414 Vali Acc: 0.500 Test Loss: 17.414 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.012042760848999
Epoch: 3, Steps: 70 | Train Loss: 10.339 Vali Loss: 13.667 Vali Acc: 0.500 Test Loss: 13.667 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.086806535720825
Epoch: 4, Steps: 70 | Train Loss: 6.504 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.807967185974121
Epoch: 5, Steps: 70 | Train Loss: 5.268 Vali Loss: 7.006 Vali Acc: 0.500 Test Loss: 7.006 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.293166399002075
Epoch: 6, Steps: 70 | Train Loss: 8.448 Vali Loss: 1.988 Vali Acc: 0.500 Test Loss: 1.988 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.278717517852783
Epoch: 7, Steps: 70 | Train Loss: 3.425 Vali Loss: 3.254 Vali Acc: 0.500 Test Loss: 3.254 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.82900595664978
Epoch: 8, Steps: 70 | Train Loss: 4.938 Vali Loss: 7.743 Vali Acc: 0.500 Test Loss: 7.743 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.113279104232788
Epoch: 9, Steps: 70 | Train Loss: 5.043 Vali Loss: 5.265 Vali Acc: 0.490 Test Loss: 5.265 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.167899131774902
Epoch: 10, Steps: 70 | Train Loss: 3.225 Vali Loss: 9.503 Vali Acc: 0.500 Test Loss: 9.503 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.812799215316772
Epoch: 11, Steps: 70 | Train Loss: 3.781 Vali Loss: 5.191 Vali Acc: 0.500 Test Loss: 5.191 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 2742438
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.813962697982788
Epoch: 1, Steps: 70 | Train Loss: 8.821 Vali Loss: 11.449 Vali Acc: 0.500 Test Loss: 11.449 Test Acc: 0.500
Validation loss decreased (inf --> -0.499886).  Saving model ...
Epoch: 2 cost time: 10.259208917617798
Epoch: 2, Steps: 70 | Train Loss: 7.723 Vali Loss: 4.627 Vali Acc: 0.490 Test Loss: 4.627 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.221205234527588
Epoch: 3, Steps: 70 | Train Loss: 10.630 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
Validation loss decreased (-0.499886 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 11.501641988754272
Epoch: 4, Steps: 70 | Train Loss: 2.820 Vali Loss: 2.313 Vali Acc: 0.500 Test Loss: 2.313 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.559064149856567
Epoch: 5, Steps: 70 | Train Loss: 6.141 Vali Loss: 8.057 Vali Acc: 0.500 Test Loss: 8.057 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.403272151947021
Epoch: 6, Steps: 70 | Train Loss: 5.730 Vali Loss: 22.209 Vali Acc: 0.500 Test Loss: 22.209 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.605177879333496
Epoch: 7, Steps: 70 | Train Loss: 4.179 Vali Loss: 1.846 Vali Acc: 0.500 Test Loss: 1.846 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.788466691970825
Epoch: 8, Steps: 70 | Train Loss: 5.609 Vali Loss: 1.125 Vali Acc: 0.480 Test Loss: 1.125 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.865846872329712
Epoch: 9, Steps: 70 | Train Loss: 3.017 Vali Loss: 3.334 Vali Acc: 0.480 Test Loss: 3.334 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.336819410324097
Epoch: 10, Steps: 70 | Train Loss: 3.940 Vali Loss: 3.807 Vali Acc: 0.520 Test Loss: 3.807 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519962).  Saving model ...
Epoch: 11 cost time: 11.77329969406128
Epoch: 11, Steps: 70 | Train Loss: 4.472 Vali Loss: 9.233 Vali Acc: 0.500 Test Loss: 9.233 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.844934463500977
Epoch: 12, Steps: 70 | Train Loss: 6.094 Vali Loss: 4.743 Vali Acc: 0.510 Test Loss: 4.743 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.25022292137146
Epoch: 13, Steps: 70 | Train Loss: 5.071 Vali Loss: 4.237 Vali Acc: 0.480 Test Loss: 4.237 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.729657411575317
Epoch: 14, Steps: 70 | Train Loss: 4.002 Vali Loss: 10.384 Vali Acc: 0.500 Test Loss: 10.384 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.741470336914062
Epoch: 15, Steps: 70 | Train Loss: 5.273 Vali Loss: 1.951 Vali Acc: 0.560 Test Loss: 1.951 Test Acc: 0.560
Validation loss decreased (-0.519962 --> -0.559980).  Saving model ...
Epoch: 16 cost time: 10.488344669342041
Epoch: 16, Steps: 70 | Train Loss: 1.869 Vali Loss: 8.906 Vali Acc: 0.500 Test Loss: 8.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.469189643859863
Epoch: 17, Steps: 70 | Train Loss: 1.067 Vali Loss: 9.014 Vali Acc: 0.570 Test Loss: 9.014 Test Acc: 0.570
Validation loss decreased (-0.559980 --> -0.569910).  Saving model ...
Epoch: 18 cost time: 11.695462226867676
Epoch: 18, Steps: 70 | Train Loss: 1.755 Vali Loss: 7.981 Vali Acc: 0.560 Test Loss: 7.981 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.381357669830322
Epoch: 19, Steps: 70 | Train Loss: 2.306 Vali Loss: 16.219 Vali Acc: 0.580 Test Loss: 16.219 Test Acc: 0.580
Validation loss decreased (-0.569910 --> -0.579838).  Saving model ...
Epoch: 20 cost time: 10.774741888046265
Epoch: 20, Steps: 70 | Train Loss: 2.777 Vali Loss: 11.386 Vali Acc: 0.490 Test Loss: 11.386 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.672797918319702
Epoch: 21, Steps: 70 | Train Loss: 1.132 Vali Loss: 5.813 Vali Acc: 0.500 Test Loss: 5.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.817008972167969
Epoch: 22, Steps: 70 | Train Loss: 1.354 Vali Loss: 15.774 Vali Acc: 0.490 Test Loss: 15.774 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.468392610549927
Epoch: 23, Steps: 70 | Train Loss: 0.504 Vali Loss: 9.396 Vali Acc: 0.550 Test Loss: 9.396 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.624039649963379
Epoch: 24, Steps: 70 | Train Loss: 0.228 Vali Loss: 7.471 Vali Acc: 0.550 Test Loss: 7.471 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.715670585632324
Epoch: 25, Steps: 70 | Train Loss: 0.908 Vali Loss: 11.658 Vali Acc: 0.540 Test Loss: 11.658 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.176194429397583
Epoch: 26, Steps: 70 | Train Loss: 0.594 Vali Loss: 13.485 Vali Acc: 0.520 Test Loss: 13.485 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.598786115646362
Epoch: 27, Steps: 70 | Train Loss: 0.383 Vali Loss: 10.459 Vali Acc: 0.520 Test Loss: 10.459 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.630632638931274
Epoch: 28, Steps: 70 | Train Loss: 0.761 Vali Loss: 11.396 Vali Acc: 0.480 Test Loss: 11.396 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.712745428085327
Epoch: 29, Steps: 70 | Train Loss: 0.258 Vali Loss: 28.070 Vali Acc: 0.520 Test Loss: 28.070 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2649318
model size : 11.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.948596715927124
Epoch: 1, Steps: 70 | Train Loss: 6.641 Vali Loss: 28.776 Vali Acc: 0.490 Test Loss: 28.776 Test Acc: 0.490
Validation loss decreased (inf --> -0.489712).  Saving model ...
Epoch: 2 cost time: 11.474936962127686
Epoch: 2, Steps: 70 | Train Loss: 13.604 Vali Loss: 9.285 Vali Acc: 0.510 Test Loss: 9.285 Test Acc: 0.510
Validation loss decreased (-0.489712 --> -0.509907).  Saving model ...
Epoch: 3 cost time: 10.315378904342651
Epoch: 3, Steps: 70 | Train Loss: 10.702 Vali Loss: 8.709 Vali Acc: 0.500 Test Loss: 8.709 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.977605104446411
Epoch: 4, Steps: 70 | Train Loss: 14.969 Vali Loss: 8.800 Vali Acc: 0.490 Test Loss: 8.800 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.052837133407593
Epoch: 5, Steps: 70 | Train Loss: 7.501 Vali Loss: 23.518 Vali Acc: 0.500 Test Loss: 23.518 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.481317043304443
Epoch: 6, Steps: 70 | Train Loss: 9.885 Vali Loss: 11.796 Vali Acc: 0.500 Test Loss: 11.796 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.398969888687134
Epoch: 7, Steps: 70 | Train Loss: 10.712 Vali Loss: 3.934 Vali Acc: 0.520 Test Loss: 3.934 Test Acc: 0.520
Validation loss decreased (-0.509907 --> -0.519961).  Saving model ...
Epoch: 8 cost time: 10.47866439819336
Epoch: 8, Steps: 70 | Train Loss: 5.179 Vali Loss: 4.114 Vali Acc: 0.510 Test Loss: 4.114 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.821899175643921
Epoch: 9, Steps: 70 | Train Loss: 11.163 Vali Loss: 19.453 Vali Acc: 0.500 Test Loss: 19.453 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.376392602920532
Epoch: 10, Steps: 70 | Train Loss: 7.206 Vali Loss: 4.788 Vali Acc: 0.510 Test Loss: 4.788 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.751795768737793
Epoch: 11, Steps: 70 | Train Loss: 2.750 Vali Loss: 6.864 Vali Acc: 0.510 Test Loss: 6.864 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.862851858139038
Epoch: 12, Steps: 70 | Train Loss: 2.244 Vali Loss: 12.360 Vali Acc: 0.490 Test Loss: 12.360 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.04996395111084
Epoch: 13, Steps: 70 | Train Loss: 4.225 Vali Loss: 6.618 Vali Acc: 0.510 Test Loss: 6.618 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.944925785064697
Epoch: 14, Steps: 70 | Train Loss: 3.550 Vali Loss: 10.293 Vali Acc: 0.510 Test Loss: 10.293 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.906038284301758
Epoch: 15, Steps: 70 | Train Loss: 6.134 Vali Loss: 14.309 Vali Acc: 0.450 Test Loss: 14.309 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.244495391845703
Epoch: 16, Steps: 70 | Train Loss: 2.318 Vali Loss: 4.996 Vali Acc: 0.540 Test Loss: 4.996 Test Acc: 0.540
Validation loss decreased (-0.519961 --> -0.539950).  Saving model ...
Epoch: 17 cost time: 11.055092573165894
Epoch: 17, Steps: 70 | Train Loss: 0.740 Vali Loss: 17.176 Vali Acc: 0.410 Test Loss: 17.176 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.89074969291687
Epoch: 18, Steps: 70 | Train Loss: 2.259 Vali Loss: 16.466 Vali Acc: 0.490 Test Loss: 16.466 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.780449867248535
Epoch: 19, Steps: 70 | Train Loss: 1.468 Vali Loss: 8.465 Vali Acc: 0.500 Test Loss: 8.465 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.120747566223145
Epoch: 20, Steps: 70 | Train Loss: 1.091 Vali Loss: 14.633 Vali Acc: 0.580 Test Loss: 14.633 Test Acc: 0.580
Validation loss decreased (-0.539950 --> -0.579854).  Saving model ...
Epoch: 21 cost time: 10.26700210571289
Epoch: 21, Steps: 70 | Train Loss: 2.237 Vali Loss: 11.702 Vali Acc: 0.480 Test Loss: 11.702 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.234257459640503
Epoch: 22, Steps: 70 | Train Loss: 0.264 Vali Loss: 15.235 Vali Acc: 0.510 Test Loss: 15.235 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.105500221252441
Epoch: 23, Steps: 70 | Train Loss: 0.901 Vali Loss: 18.871 Vali Acc: 0.490 Test Loss: 18.871 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.28836989402771
Epoch: 24, Steps: 70 | Train Loss: 2.531 Vali Loss: 25.770 Vali Acc: 0.510 Test Loss: 25.770 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.216086149215698
Epoch: 25, Steps: 70 | Train Loss: 1.478 Vali Loss: 22.677 Vali Acc: 0.450 Test Loss: 22.677 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.801397800445557
Epoch: 26, Steps: 70 | Train Loss: 0.658 Vali Loss: 7.586 Vali Acc: 0.560 Test Loss: 7.586 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.13361144065857
Epoch: 27, Steps: 70 | Train Loss: 0.638 Vali Loss: 25.427 Vali Acc: 0.490 Test Loss: 25.427 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.245834589004517
Epoch: 28, Steps: 70 | Train Loss: 0.723 Vali Loss: 10.462 Vali Acc: 0.520 Test Loss: 10.462 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.158001184463501
Epoch: 29, Steps: 70 | Train Loss: 0.467 Vali Loss: 16.440 Vali Acc: 0.530 Test Loss: 16.440 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.159915685653687
Epoch: 30, Steps: 70 | Train Loss: 0.179 Vali Loss: 13.472 Vali Acc: 0.440 Test Loss: 13.472 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2625318
model size : 11.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.570510864257812
Epoch: 1, Steps: 70 | Train Loss: 5.006 Vali Loss: 5.846 Vali Acc: 0.500 Test Loss: 5.846 Test Acc: 0.500
Validation loss decreased (inf --> -0.499942).  Saving model ...
Epoch: 2 cost time: 9.826792001724243
Epoch: 2, Steps: 70 | Train Loss: 17.292 Vali Loss: 19.420 Vali Acc: 0.500 Test Loss: 19.420 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.685596704483032
Epoch: 3, Steps: 70 | Train Loss: 19.137 Vali Loss: 1.735 Vali Acc: 0.480 Test Loss: 1.735 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.873373031616211
Epoch: 4, Steps: 70 | Train Loss: 11.632 Vali Loss: 23.426 Vali Acc: 0.500 Test Loss: 23.426 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.939523220062256
Epoch: 5, Steps: 70 | Train Loss: 8.411 Vali Loss: 7.377 Vali Acc: 0.500 Test Loss: 7.377 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.912299394607544
Epoch: 6, Steps: 70 | Train Loss: 4.152 Vali Loss: 11.123 Vali Acc: 0.500 Test Loss: 11.123 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.426165103912354
Epoch: 7, Steps: 70 | Train Loss: 4.082 Vali Loss: 2.425 Vali Acc: 0.500 Test Loss: 2.425 Test Acc: 0.500
Validation loss decreased (-0.499942 --> -0.499976).  Saving model ...
Epoch: 8 cost time: 10.682733535766602
Epoch: 8, Steps: 70 | Train Loss: 5.062 Vali Loss: 18.518 Vali Acc: 0.500 Test Loss: 18.518 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.077465057373047
Epoch: 9, Steps: 70 | Train Loss: 6.024 Vali Loss: 20.094 Vali Acc: 0.500 Test Loss: 20.094 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.84798288345337
Epoch: 10, Steps: 70 | Train Loss: 3.748 Vali Loss: 25.325 Vali Acc: 0.500 Test Loss: 25.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.006009101867676
Epoch: 11, Steps: 70 | Train Loss: 6.403 Vali Loss: 2.761 Vali Acc: 0.530 Test Loss: 2.761 Test Acc: 0.530
Validation loss decreased (-0.499976 --> -0.529972).  Saving model ...
Epoch: 12 cost time: 11.052941083908081
Epoch: 12, Steps: 70 | Train Loss: 3.714 Vali Loss: 9.030 Vali Acc: 0.460 Test Loss: 9.030 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.21410059928894
Epoch: 13, Steps: 70 | Train Loss: 2.694 Vali Loss: 13.025 Vali Acc: 0.450 Test Loss: 13.025 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.163205623626709
Epoch: 14, Steps: 70 | Train Loss: 2.708 Vali Loss: 5.934 Vali Acc: 0.530 Test Loss: 5.934 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.252433776855469
Epoch: 15, Steps: 70 | Train Loss: 2.884 Vali Loss: 7.772 Vali Acc: 0.530 Test Loss: 7.772 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.957006692886353
Epoch: 16, Steps: 70 | Train Loss: 3.392 Vali Loss: 13.664 Vali Acc: 0.520 Test Loss: 13.664 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.981032133102417
Epoch: 17, Steps: 70 | Train Loss: 2.866 Vali Loss: 13.595 Vali Acc: 0.480 Test Loss: 13.595 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.870072841644287
Epoch: 18, Steps: 70 | Train Loss: 1.719 Vali Loss: 14.543 Vali Acc: 0.520 Test Loss: 14.543 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.984081268310547
Epoch: 19, Steps: 70 | Train Loss: 0.915 Vali Loss: 11.734 Vali Acc: 0.440 Test Loss: 11.734 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.694672346115112
Epoch: 20, Steps: 70 | Train Loss: 1.811 Vali Loss: 11.080 Vali Acc: 0.610 Test Loss: 11.080 Test Acc: 0.610
Validation loss decreased (-0.529972 --> -0.609889).  Saving model ...
Epoch: 21 cost time: 10.515073537826538
Epoch: 21, Steps: 70 | Train Loss: 2.473 Vali Loss: 6.582 Vali Acc: 0.470 Test Loss: 6.582 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.987025022506714
Epoch: 22, Steps: 70 | Train Loss: 2.847 Vali Loss: 18.393 Vali Acc: 0.510 Test Loss: 18.393 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.012051105499268
Epoch: 23, Steps: 70 | Train Loss: 1.293 Vali Loss: 43.301 Vali Acc: 0.470 Test Loss: 43.301 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.186409711837769
Epoch: 24, Steps: 70 | Train Loss: 1.613 Vali Loss: 28.132 Vali Acc: 0.530 Test Loss: 28.132 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.085532665252686
Epoch: 25, Steps: 70 | Train Loss: 0.803 Vali Loss: 13.191 Vali Acc: 0.490 Test Loss: 13.191 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.180179834365845
Epoch: 26, Steps: 70 | Train Loss: 1.369 Vali Loss: 19.002 Vali Acc: 0.510 Test Loss: 19.002 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.075541496276855
Epoch: 27, Steps: 70 | Train Loss: 0.603 Vali Loss: 23.020 Vali Acc: 0.440 Test Loss: 23.020 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.249265670776367
Epoch: 28, Steps: 70 | Train Loss: 0.578 Vali Loss: 27.284 Vali Acc: 0.530 Test Loss: 27.284 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.858077049255371
Epoch: 29, Steps: 70 | Train Loss: 2.154 Vali Loss: 39.574 Vali Acc: 0.450 Test Loss: 39.574 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.975683450698853
Epoch: 30, Steps: 70 | Train Loss: 0.857 Vali Loss: 21.703 Vali Acc: 0.510 Test Loss: 21.703 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2601318
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.250661611557007
Epoch: 1, Steps: 70 | Train Loss: 6.479 Vali Loss: 13.243 Vali Acc: 0.500 Test Loss: 13.243 Test Acc: 0.500
Validation loss decreased (inf --> -0.499868).  Saving model ...
Epoch: 2 cost time: 10.615732192993164
Epoch: 2, Steps: 70 | Train Loss: 10.454 Vali Loss: 18.310 Vali Acc: 0.500 Test Loss: 18.310 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.751320123672485
Epoch: 3, Steps: 70 | Train Loss: 10.982 Vali Loss: 10.572 Vali Acc: 0.500 Test Loss: 10.572 Test Acc: 0.500
Validation loss decreased (-0.499868 --> -0.499894).  Saving model ...
Epoch: 4 cost time: 9.805945634841919
Epoch: 4, Steps: 70 | Train Loss: 6.773 Vali Loss: 12.207 Vali Acc: 0.500 Test Loss: 12.207 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.853491067886353
Epoch: 5, Steps: 70 | Train Loss: 7.853 Vali Loss: 9.383 Vali Acc: 0.500 Test Loss: 9.383 Test Acc: 0.500
Validation loss decreased (-0.499894 --> -0.499906).  Saving model ...
Epoch: 6 cost time: 10.475581169128418
Epoch: 6, Steps: 70 | Train Loss: 3.421 Vali Loss: 5.738 Vali Acc: 0.500 Test Loss: 5.738 Test Acc: 0.500
Validation loss decreased (-0.499906 --> -0.499943).  Saving model ...
Epoch: 7 cost time: 10.422849655151367
Epoch: 7, Steps: 70 | Train Loss: 4.170 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
Validation loss decreased (-0.499943 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 10.973527669906616
Epoch: 8, Steps: 70 | Train Loss: 3.287 Vali Loss: 8.774 Vali Acc: 0.500 Test Loss: 8.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.717626810073853
Epoch: 9, Steps: 70 | Train Loss: 3.791 Vali Loss: 8.185 Vali Acc: 0.500 Test Loss: 8.185 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.996217727661133
Epoch: 10, Steps: 70 | Train Loss: 4.986 Vali Loss: 1.363 Vali Acc: 0.550 Test Loss: 1.363 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549986).  Saving model ...
Epoch: 11 cost time: 10.922105312347412
Epoch: 11, Steps: 70 | Train Loss: 2.885 Vali Loss: 5.356 Vali Acc: 0.500 Test Loss: 5.356 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.056819438934326
Epoch: 12, Steps: 70 | Train Loss: 4.505 Vali Loss: 6.953 Vali Acc: 0.500 Test Loss: 6.953 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.85694670677185
Epoch: 13, Steps: 70 | Train Loss: 4.624 Vali Loss: 8.948 Vali Acc: 0.500 Test Loss: 8.948 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.216270446777344
Epoch: 14, Steps: 70 | Train Loss: 2.138 Vali Loss: 6.760 Vali Acc: 0.490 Test Loss: 6.760 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.754444360733032
Epoch: 15, Steps: 70 | Train Loss: 2.949 Vali Loss: 8.050 Vali Acc: 0.540 Test Loss: 8.050 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.833085536956787
Epoch: 16, Steps: 70 | Train Loss: 2.752 Vali Loss: 24.136 Vali Acc: 0.500 Test Loss: 24.136 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.946350336074829
Epoch: 17, Steps: 70 | Train Loss: 3.625 Vali Loss: 7.599 Vali Acc: 0.530 Test Loss: 7.599 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.944565296173096
Epoch: 18, Steps: 70 | Train Loss: 5.080 Vali Loss: 10.770 Vali Acc: 0.560 Test Loss: 10.770 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559892).  Saving model ...
Epoch: 19 cost time: 10.687122583389282
Epoch: 19, Steps: 70 | Train Loss: 0.576 Vali Loss: 7.845 Vali Acc: 0.470 Test Loss: 7.845 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.974738597869873
Epoch: 20, Steps: 70 | Train Loss: 3.057 Vali Loss: 5.880 Vali Acc: 0.480 Test Loss: 5.880 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.688745975494385
Epoch: 21, Steps: 70 | Train Loss: 1.071 Vali Loss: 6.271 Vali Acc: 0.470 Test Loss: 6.271 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.69563913345337
Epoch: 22, Steps: 70 | Train Loss: 1.649 Vali Loss: 14.566 Vali Acc: 0.470 Test Loss: 14.566 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.805498838424683
Epoch: 23, Steps: 70 | Train Loss: 1.197 Vali Loss: 3.365 Vali Acc: 0.550 Test Loss: 3.365 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.888305902481079
Epoch: 24, Steps: 70 | Train Loss: 0.934 Vali Loss: 12.174 Vali Acc: 0.580 Test Loss: 12.174 Test Acc: 0.580
Validation loss decreased (-0.559892 --> -0.579878).  Saving model ...
Epoch: 25 cost time: 11.408378601074219
Epoch: 25, Steps: 70 | Train Loss: 0.848 Vali Loss: 9.695 Vali Acc: 0.510 Test Loss: 9.695 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.582701444625854
Epoch: 26, Steps: 70 | Train Loss: 0.426 Vali Loss: 15.878 Vali Acc: 0.500 Test Loss: 15.878 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 11.818962335586548
Epoch: 27, Steps: 70 | Train Loss: 1.669 Vali Loss: 15.298 Vali Acc: 0.560 Test Loss: 15.298 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 11.895019054412842
Epoch: 28, Steps: 70 | Train Loss: 0.235 Vali Loss: 11.842 Vali Acc: 0.560 Test Loss: 11.842 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 11.814938306808472
Epoch: 29, Steps: 70 | Train Loss: 0.141 Vali Loss: 10.094 Vali Acc: 0.530 Test Loss: 10.094 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 11.361103296279907
Epoch: 30, Steps: 70 | Train Loss: 0.191 Vali Loss: 7.252 Vali Acc: 0.530 Test Loss: 7.252 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.442315340042114
Epoch: 31, Steps: 70 | Train Loss: 0.365 Vali Loss: 8.967 Vali Acc: 0.530 Test Loss: 8.967 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 11.829444408416748
Epoch: 32, Steps: 70 | Train Loss: 0.042 Vali Loss: 8.636 Vali Acc: 0.550 Test Loss: 8.636 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 11.834087133407593
Epoch: 33, Steps: 70 | Train Loss: 0.164 Vali Loss: 14.965 Vali Acc: 0.460 Test Loss: 14.965 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 11.840341567993164
Epoch: 34, Steps: 70 | Train Loss: 0.046 Vali Loss: 10.940 Vali Acc: 0.500 Test Loss: 10.940 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2577318
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.924011945724487
Epoch: 1, Steps: 70 | Train Loss: 4.824 Vali Loss: 10.202 Vali Acc: 0.510 Test Loss: 10.202 Test Acc: 0.510
Validation loss decreased (inf --> -0.509898).  Saving model ...
Epoch: 2 cost time: 11.701538324356079
Epoch: 2, Steps: 70 | Train Loss: 11.352 Vali Loss: 10.421 Vali Acc: 0.500 Test Loss: 10.421 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.61797571182251
Epoch: 3, Steps: 70 | Train Loss: 8.721 Vali Loss: 17.630 Vali Acc: 0.500 Test Loss: 17.630 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.615032434463501
Epoch: 4, Steps: 70 | Train Loss: 8.783 Vali Loss: 7.269 Vali Acc: 0.500 Test Loss: 7.269 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.672922611236572
Epoch: 5, Steps: 70 | Train Loss: 7.037 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
Validation loss decreased (-0.509898 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 10.51833701133728
Epoch: 6, Steps: 70 | Train Loss: 6.094 Vali Loss: 8.938 Vali Acc: 0.500 Test Loss: 8.938 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.696605682373047
Epoch: 7, Steps: 70 | Train Loss: 3.945 Vali Loss: 16.250 Vali Acc: 0.500 Test Loss: 16.250 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.843042612075806
Epoch: 8, Steps: 70 | Train Loss: 5.874 Vali Loss: 8.527 Vali Acc: 0.500 Test Loss: 8.527 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.827309846878052
Epoch: 9, Steps: 70 | Train Loss: 4.938 Vali Loss: 10.086 Vali Acc: 0.500 Test Loss: 10.086 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.395626068115234
Epoch: 10, Steps: 70 | Train Loss: 5.671 Vali Loss: 9.276 Vali Acc: 0.480 Test Loss: 9.276 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.43477463722229
Epoch: 11, Steps: 70 | Train Loss: 3.900 Vali Loss: 4.362 Vali Acc: 0.490 Test Loss: 4.362 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.53128457069397
Epoch: 12, Steps: 70 | Train Loss: 4.401 Vali Loss: 6.358 Vali Acc: 0.500 Test Loss: 6.358 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.68772554397583
Epoch: 13, Steps: 70 | Train Loss: 2.478 Vali Loss: 13.359 Vali Acc: 0.500 Test Loss: 13.359 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.867486000061035
Epoch: 14, Steps: 70 | Train Loss: 2.948 Vali Loss: 7.121 Vali Acc: 0.500 Test Loss: 7.121 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.906156778335571
Epoch: 15, Steps: 70 | Train Loss: 1.893 Vali Loss: 4.304 Vali Acc: 0.550 Test Loss: 4.304 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2566758
model size : 11.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.833193302154541
Epoch: 1, Steps: 70 | Train Loss: 5.137 Vali Loss: 3.689 Vali Acc: 0.500 Test Loss: 3.689 Test Acc: 0.500
Validation loss decreased (inf --> -0.499963).  Saving model ...
Epoch: 2 cost time: 11.744482517242432
Epoch: 2, Steps: 70 | Train Loss: 5.939 Vali Loss: 4.558 Vali Acc: 0.500 Test Loss: 4.558 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.804664611816406
Epoch: 3, Steps: 70 | Train Loss: 6.563 Vali Loss: 2.955 Vali Acc: 0.500 Test Loss: 2.955 Test Acc: 0.500
Validation loss decreased (-0.499963 --> -0.499970).  Saving model ...
Epoch: 4 cost time: 10.744856357574463
Epoch: 4, Steps: 70 | Train Loss: 2.520 Vali Loss: 2.421 Vali Acc: 0.500 Test Loss: 2.421 Test Acc: 0.500
Validation loss decreased (-0.499970 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 10.756697416305542
Epoch: 5, Steps: 70 | Train Loss: 4.384 Vali Loss: 0.891 Vali Acc: 0.430 Test Loss: 0.891 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.967912673950195
Epoch: 6, Steps: 70 | Train Loss: 4.838 Vali Loss: 3.697 Vali Acc: 0.500 Test Loss: 3.697 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.158873796463013
Epoch: 7, Steps: 70 | Train Loss: 3.304 Vali Loss: 15.157 Vali Acc: 0.500 Test Loss: 15.157 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.944253206253052
Epoch: 8, Steps: 70 | Train Loss: 5.579 Vali Loss: 1.226 Vali Acc: 0.490 Test Loss: 1.226 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.184766292572021
Epoch: 9, Steps: 70 | Train Loss: 5.746 Vali Loss: 5.232 Vali Acc: 0.500 Test Loss: 5.232 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.542126178741455
Epoch: 10, Steps: 70 | Train Loss: 4.076 Vali Loss: 1.771 Vali Acc: 0.500 Test Loss: 1.771 Test Acc: 0.500
Validation loss decreased (-0.499976 --> -0.499982).  Saving model ...
Epoch: 11 cost time: 11.954019546508789
Epoch: 11, Steps: 70 | Train Loss: 5.304 Vali Loss: 3.605 Vali Acc: 0.490 Test Loss: 3.605 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.033117055892944
Epoch: 12, Steps: 70 | Train Loss: 3.911 Vali Loss: 6.820 Vali Acc: 0.500 Test Loss: 6.820 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.928433418273926
Epoch: 13, Steps: 70 | Train Loss: 3.379 Vali Loss: 4.554 Vali Acc: 0.500 Test Loss: 4.554 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.589943647384644
Epoch: 14, Steps: 70 | Train Loss: 1.984 Vali Loss: 8.294 Vali Acc: 0.500 Test Loss: 8.294 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.777799606323242
Epoch: 15, Steps: 70 | Train Loss: 2.915 Vali Loss: 8.093 Vali Acc: 0.500 Test Loss: 8.093 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.063268899917603
Epoch: 16, Steps: 70 | Train Loss: 3.156 Vali Loss: 13.152 Vali Acc: 0.500 Test Loss: 13.152 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.182655334472656
Epoch: 17, Steps: 70 | Train Loss: 3.750 Vali Loss: 8.091 Vali Acc: 0.500 Test Loss: 8.091 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.884712219238281
Epoch: 18, Steps: 70 | Train Loss: 1.805 Vali Loss: 5.002 Vali Acc: 0.530 Test Loss: 5.002 Test Acc: 0.530
Validation loss decreased (-0.499982 --> -0.529950).  Saving model ...
Epoch: 19 cost time: 11.656312227249146
Epoch: 19, Steps: 70 | Train Loss: 0.681 Vali Loss: 3.921 Vali Acc: 0.530 Test Loss: 3.921 Test Acc: 0.530
Validation loss decreased (-0.529950 --> -0.529961).  Saving model ...
Epoch: 20 cost time: 10.594657897949219
Epoch: 20, Steps: 70 | Train Loss: 0.789 Vali Loss: 8.862 Vali Acc: 0.530 Test Loss: 8.862 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.003987312316895
Epoch: 21, Steps: 70 | Train Loss: 0.865 Vali Loss: 6.121 Vali Acc: 0.550 Test Loss: 6.121 Test Acc: 0.550
Validation loss decreased (-0.529961 --> -0.549939).  Saving model ...
Epoch: 22 cost time: 11.989673852920532
Epoch: 22, Steps: 70 | Train Loss: 0.954 Vali Loss: 9.006 Vali Acc: 0.520 Test Loss: 9.006 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.051096677780151
Epoch: 23, Steps: 70 | Train Loss: 0.890 Vali Loss: 7.012 Vali Acc: 0.500 Test Loss: 7.012 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.964689254760742
Epoch: 24, Steps: 70 | Train Loss: 0.639 Vali Loss: 14.969 Vali Acc: 0.480 Test Loss: 14.969 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.701186656951904
Epoch: 25, Steps: 70 | Train Loss: 0.654 Vali Loss: 14.314 Vali Acc: 0.470 Test Loss: 14.314 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.771559238433838
Epoch: 26, Steps: 70 | Train Loss: 1.244 Vali Loss: 10.111 Vali Acc: 0.480 Test Loss: 10.111 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.905839443206787
Epoch: 27, Steps: 70 | Train Loss: 0.893 Vali Loss: 13.712 Vali Acc: 0.540 Test Loss: 13.712 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 12.080779314041138
Epoch: 28, Steps: 70 | Train Loss: 0.408 Vali Loss: 7.421 Vali Acc: 0.500 Test Loss: 7.421 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.04080080986023
Epoch: 29, Steps: 70 | Train Loss: 0.159 Vali Loss: 9.548 Vali Acc: 0.530 Test Loss: 9.548 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.685110092163086
Epoch: 30, Steps: 70 | Train Loss: 0.203 Vali Loss: 15.571 Vali Acc: 0.480 Test Loss: 15.571 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 11.323530197143555
Epoch: 31, Steps: 70 | Train Loss: 0.043 Vali Loss: 9.538 Vali Acc: 0.510 Test Loss: 9.538 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2542758
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.50644588470459
Epoch: 1, Steps: 70 | Train Loss: 4.702 Vali Loss: 6.744 Vali Acc: 0.510 Test Loss: 6.744 Test Acc: 0.510
Validation loss decreased (inf --> -0.509933).  Saving model ...
Epoch: 2 cost time: 11.274511337280273
Epoch: 2, Steps: 70 | Train Loss: 12.367 Vali Loss: 13.023 Vali Acc: 0.500 Test Loss: 13.023 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.299438953399658
Epoch: 3, Steps: 70 | Train Loss: 7.051 Vali Loss: 10.817 Vali Acc: 0.500 Test Loss: 10.817 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.453317165374756
Epoch: 4, Steps: 70 | Train Loss: 5.330 Vali Loss: 7.901 Vali Acc: 0.500 Test Loss: 7.901 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.86694884300232
Epoch: 5, Steps: 70 | Train Loss: 4.713 Vali Loss: 2.484 Vali Acc: 0.500 Test Loss: 2.484 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.701087713241577
Epoch: 6, Steps: 70 | Train Loss: 4.218 Vali Loss: 2.561 Vali Acc: 0.500 Test Loss: 2.561 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.879776000976562
Epoch: 7, Steps: 70 | Train Loss: 4.127 Vali Loss: 0.751 Vali Acc: 0.560 Test Loss: 0.751 Test Acc: 0.560
Validation loss decreased (-0.509933 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 10.467877388000488
Epoch: 8, Steps: 70 | Train Loss: 6.469 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.380055665969849
Epoch: 9, Steps: 70 | Train Loss: 4.367 Vali Loss: 10.809 Vali Acc: 0.500 Test Loss: 10.809 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.790013551712036
Epoch: 10, Steps: 70 | Train Loss: 4.117 Vali Loss: 10.809 Vali Acc: 0.500 Test Loss: 10.809 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.67167615890503
Epoch: 11, Steps: 70 | Train Loss: 5.081 Vali Loss: 2.316 Vali Acc: 0.500 Test Loss: 2.316 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.871712446212769
Epoch: 12, Steps: 70 | Train Loss: 5.249 Vali Loss: 5.462 Vali Acc: 0.500 Test Loss: 5.462 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.573483228683472
Epoch: 13, Steps: 70 | Train Loss: 4.394 Vali Loss: 2.384 Vali Acc: 0.480 Test Loss: 2.384 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.011033773422241
Epoch: 14, Steps: 70 | Train Loss: 4.031 Vali Loss: 6.069 Vali Acc: 0.460 Test Loss: 6.069 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.750811576843262
Epoch: 15, Steps: 70 | Train Loss: 2.808 Vali Loss: 1.712 Vali Acc: 0.500 Test Loss: 1.712 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.904681205749512
Epoch: 16, Steps: 70 | Train Loss: 3.379 Vali Loss: 8.724 Vali Acc: 0.500 Test Loss: 8.724 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.819692373275757
Epoch: 17, Steps: 70 | Train Loss: 1.209 Vali Loss: 6.460 Vali Acc: 0.470 Test Loss: 6.460 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2518758
model size : 10.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.584176301956177
Epoch: 1, Steps: 70 | Train Loss: 10.356 Vali Loss: 11.094 Vali Acc: 0.460 Test Loss: 11.094 Test Acc: 0.460
Validation loss decreased (inf --> -0.459889).  Saving model ...
Epoch: 2 cost time: 11.572342872619629
Epoch: 2, Steps: 70 | Train Loss: 12.473 Vali Loss: 35.601 Vali Acc: 0.500 Test Loss: 35.601 Test Acc: 0.500
Validation loss decreased (-0.459889 --> -0.499644).  Saving model ...
Epoch: 3 cost time: 11.406662940979004
Epoch: 3, Steps: 70 | Train Loss: 14.811 Vali Loss: 1.860 Vali Acc: 0.500 Test Loss: 1.860 Test Acc: 0.500
Validation loss decreased (-0.499644 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 11.10202169418335
Epoch: 4, Steps: 70 | Train Loss: 10.335 Vali Loss: 9.459 Vali Acc: 0.500 Test Loss: 9.459 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.167712926864624
Epoch: 5, Steps: 70 | Train Loss: 3.966 Vali Loss: 0.862 Vali Acc: 0.520 Test Loss: 0.862 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519991).  Saving model ...
Epoch: 6 cost time: 11.636373281478882
Epoch: 6, Steps: 70 | Train Loss: 6.817 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.540926218032837
Epoch: 7, Steps: 70 | Train Loss: 7.950 Vali Loss: 6.606 Vali Acc: 0.500 Test Loss: 6.606 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.482320785522461
Epoch: 8, Steps: 70 | Train Loss: 5.013 Vali Loss: 16.161 Vali Acc: 0.500 Test Loss: 16.161 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.666583061218262
Epoch: 9, Steps: 70 | Train Loss: 4.975 Vali Loss: 4.033 Vali Acc: 0.500 Test Loss: 4.033 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.110449314117432
Epoch: 10, Steps: 70 | Train Loss: 6.707 Vali Loss: 7.523 Vali Acc: 0.500 Test Loss: 7.523 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.749251127243042
Epoch: 11, Steps: 70 | Train Loss: 5.649 Vali Loss: 15.778 Vali Acc: 0.500 Test Loss: 15.778 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.825785875320435
Epoch: 12, Steps: 70 | Train Loss: 8.961 Vali Loss: 8.795 Vali Acc: 0.500 Test Loss: 8.795 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.666124105453491
Epoch: 13, Steps: 70 | Train Loss: 5.711 Vali Loss: 4.168 Vali Acc: 0.550 Test Loss: 4.168 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549958).  Saving model ...
Epoch: 14 cost time: 11.750715255737305
Epoch: 14, Steps: 70 | Train Loss: 4.067 Vali Loss: 3.296 Vali Acc: 0.520 Test Loss: 3.296 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.319963693618774
Epoch: 15, Steps: 70 | Train Loss: 3.175 Vali Loss: 11.120 Vali Acc: 0.500 Test Loss: 11.120 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.58564305305481
Epoch: 16, Steps: 70 | Train Loss: 3.985 Vali Loss: 4.230 Vali Acc: 0.500 Test Loss: 4.230 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.725025653839111
Epoch: 17, Steps: 70 | Train Loss: 3.165 Vali Loss: 7.648 Vali Acc: 0.500 Test Loss: 7.648 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.713803768157959
Epoch: 18, Steps: 70 | Train Loss: 1.455 Vali Loss: 10.046 Vali Acc: 0.490 Test Loss: 10.046 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.818156957626343
Epoch: 19, Steps: 70 | Train Loss: 1.954 Vali Loss: 9.179 Vali Acc: 0.530 Test Loss: 9.179 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.760631084442139
Epoch: 20, Steps: 70 | Train Loss: 1.114 Vali Loss: 4.869 Vali Acc: 0.570 Test Loss: 4.869 Test Acc: 0.570
Validation loss decreased (-0.549958 --> -0.569951).  Saving model ...
Epoch: 21 cost time: 10.357632637023926
Epoch: 21, Steps: 70 | Train Loss: 0.738 Vali Loss: 5.545 Vali Acc: 0.510 Test Loss: 5.545 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.803188562393188
Epoch: 22, Steps: 70 | Train Loss: 1.046 Vali Loss: 11.435 Vali Acc: 0.500 Test Loss: 11.435 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.798480749130249
Epoch: 23, Steps: 70 | Train Loss: 0.566 Vali Loss: 10.638 Vali Acc: 0.450 Test Loss: 10.638 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.633810758590698
Epoch: 24, Steps: 70 | Train Loss: 0.953 Vali Loss: 3.401 Vali Acc: 0.560 Test Loss: 3.401 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.013925313949585
Epoch: 25, Steps: 70 | Train Loss: 1.112 Vali Loss: 8.478 Vali Acc: 0.520 Test Loss: 8.478 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.231356859207153
Epoch: 26, Steps: 70 | Train Loss: 0.971 Vali Loss: 9.517 Vali Acc: 0.480 Test Loss: 9.517 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.797279357910156
Epoch: 27, Steps: 70 | Train Loss: 0.637 Vali Loss: 9.103 Vali Acc: 0.520 Test Loss: 9.103 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.847412347793579
Epoch: 28, Steps: 70 | Train Loss: 0.471 Vali Loss: 7.747 Vali Acc: 0.550 Test Loss: 7.747 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.611336708068848
Epoch: 29, Steps: 70 | Train Loss: 0.615 Vali Loss: 8.715 Vali Acc: 0.540 Test Loss: 8.715 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.28812289237976
Epoch: 30, Steps: 70 | Train Loss: 0.035 Vali Loss: 8.510 Vali Acc: 0.560 Test Loss: 8.510 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2494758
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.595855236053467
Epoch: 1, Steps: 70 | Train Loss: 4.725 Vali Loss: 12.604 Vali Acc: 0.500 Test Loss: 12.604 Test Acc: 0.500
Validation loss decreased (inf --> -0.499874).  Saving model ...
Epoch: 2 cost time: 11.522458791732788
Epoch: 2, Steps: 70 | Train Loss: 8.170 Vali Loss: 12.694 Vali Acc: 0.500 Test Loss: 12.694 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.393453359603882
Epoch: 3, Steps: 70 | Train Loss: 6.393 Vali Loss: 3.167 Vali Acc: 0.500 Test Loss: 3.167 Test Acc: 0.500
Validation loss decreased (-0.499874 --> -0.499968).  Saving model ...
Epoch: 4 cost time: 10.20952320098877
Epoch: 4, Steps: 70 | Train Loss: 7.748 Vali Loss: 10.461 Vali Acc: 0.500 Test Loss: 10.461 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.144401550292969
Epoch: 5, Steps: 70 | Train Loss: 5.255 Vali Loss: 0.921 Vali Acc: 0.460 Test Loss: 0.921 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.365132093429565
Epoch: 6, Steps: 70 | Train Loss: 3.059 Vali Loss: 3.714 Vali Acc: 0.500 Test Loss: 3.714 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.65365982055664
Epoch: 7, Steps: 70 | Train Loss: 3.469 Vali Loss: 2.209 Vali Acc: 0.500 Test Loss: 2.209 Test Acc: 0.500
Validation loss decreased (-0.499968 --> -0.499978).  Saving model ...
Epoch: 8 cost time: 11.573657512664795
Epoch: 8, Steps: 70 | Train Loss: 2.179 Vali Loss: 3.264 Vali Acc: 0.500 Test Loss: 3.264 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.061600923538208
Epoch: 9, Steps: 70 | Train Loss: 3.890 Vali Loss: 5.318 Vali Acc: 0.500 Test Loss: 5.318 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.037425518035889
Epoch: 10, Steps: 70 | Train Loss: 3.483 Vali Loss: 3.503 Vali Acc: 0.500 Test Loss: 3.503 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.26145339012146
Epoch: 11, Steps: 70 | Train Loss: 2.871 Vali Loss: 1.606 Vali Acc: 0.440 Test Loss: 1.606 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.39084267616272
Epoch: 12, Steps: 70 | Train Loss: 3.133 Vali Loss: 7.129 Vali Acc: 0.500 Test Loss: 7.129 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.434942722320557
Epoch: 13, Steps: 70 | Train Loss: 4.006 Vali Loss: 4.240 Vali Acc: 0.500 Test Loss: 4.240 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.405407428741455
Epoch: 14, Steps: 70 | Train Loss: 2.164 Vali Loss: 7.951 Vali Acc: 0.500 Test Loss: 7.951 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.077282190322876
Epoch: 15, Steps: 70 | Train Loss: 3.274 Vali Loss: 5.594 Vali Acc: 0.480 Test Loss: 5.594 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.11217737197876
Epoch: 16, Steps: 70 | Train Loss: 3.037 Vali Loss: 3.057 Vali Acc: 0.530 Test Loss: 3.057 Test Acc: 0.530
Validation loss decreased (-0.499978 --> -0.529969).  Saving model ...
Epoch: 17 cost time: 11.431296825408936
Epoch: 17, Steps: 70 | Train Loss: 2.111 Vali Loss: 12.954 Vali Acc: 0.470 Test Loss: 12.954 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.366504907608032
Epoch: 18, Steps: 70 | Train Loss: 2.459 Vali Loss: 7.413 Vali Acc: 0.410 Test Loss: 7.413 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.485584259033203
Epoch: 19, Steps: 70 | Train Loss: 1.000 Vali Loss: 12.214 Vali Acc: 0.480 Test Loss: 12.214 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.251715421676636
Epoch: 20, Steps: 70 | Train Loss: 0.392 Vali Loss: 9.110 Vali Acc: 0.480 Test Loss: 9.110 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.062716960906982
Epoch: 21, Steps: 70 | Train Loss: 0.851 Vali Loss: 9.767 Vali Acc: 0.530 Test Loss: 9.767 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.947211265563965
Epoch: 22, Steps: 70 | Train Loss: 0.549 Vali Loss: 8.107 Vali Acc: 0.570 Test Loss: 8.107 Test Acc: 0.570
Validation loss decreased (-0.529969 --> -0.569919).  Saving model ...
Epoch: 23 cost time: 11.414108037948608
Epoch: 23, Steps: 70 | Train Loss: 0.763 Vali Loss: 10.352 Vali Acc: 0.450 Test Loss: 10.352 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.39633584022522
Epoch: 24, Steps: 70 | Train Loss: 0.671 Vali Loss: 15.876 Vali Acc: 0.490 Test Loss: 15.876 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.636506080627441
Epoch: 25, Steps: 70 | Train Loss: 1.009 Vali Loss: 11.352 Vali Acc: 0.500 Test Loss: 11.352 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.421660900115967
Epoch: 26, Steps: 70 | Train Loss: 0.231 Vali Loss: 13.374 Vali Acc: 0.440 Test Loss: 13.374 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.042238235473633
Epoch: 27, Steps: 70 | Train Loss: 0.372 Vali Loss: 13.387 Vali Acc: 0.420 Test Loss: 13.387 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.498263359069824
Epoch: 28, Steps: 70 | Train Loss: 0.170 Vali Loss: 26.422 Vali Acc: 0.500 Test Loss: 26.422 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 11.446284770965576
Epoch: 29, Steps: 70 | Train Loss: 0.415 Vali Loss: 15.675 Vali Acc: 0.510 Test Loss: 15.675 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.429254531860352
Epoch: 30, Steps: 70 | Train Loss: 0.145 Vali Loss: 15.560 Vali Acc: 0.440 Test Loss: 15.560 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 11.374386072158813
Epoch: 31, Steps: 70 | Train Loss: 0.194 Vali Loss: 14.296 Vali Acc: 0.450 Test Loss: 14.296 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.069991111755371
Epoch: 32, Steps: 70 | Train Loss: 0.497 Vali Loss: 19.600 Vali Acc: 0.500 Test Loss: 19.600 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1492998
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.568977355957031
Epoch: 1, Steps: 70 | Train Loss: 3.922 Vali Loss: 8.673 Vali Acc: 0.510 Test Loss: 8.673 Test Acc: 0.510
Validation loss decreased (inf --> -0.509913).  Saving model ...
Epoch: 2 cost time: 11.309407711029053
Epoch: 2, Steps: 70 | Train Loss: 8.887 Vali Loss: 3.105 Vali Acc: 0.500 Test Loss: 3.105 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.123786211013794
Epoch: 3, Steps: 70 | Train Loss: 7.687 Vali Loss: 5.023 Vali Acc: 0.500 Test Loss: 5.023 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.943145751953125
Epoch: 4, Steps: 70 | Train Loss: 2.484 Vali Loss: 2.676 Vali Acc: 0.500 Test Loss: 2.676 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.011373519897461
Epoch: 5, Steps: 70 | Train Loss: 6.492 Vali Loss: 5.179 Vali Acc: 0.500 Test Loss: 5.179 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.238417387008667
Epoch: 6, Steps: 70 | Train Loss: 2.651 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.449690580368042
Epoch: 7, Steps: 70 | Train Loss: 5.009 Vali Loss: 10.084 Vali Acc: 0.500 Test Loss: 10.084 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.528113603591919
Epoch: 8, Steps: 70 | Train Loss: 6.109 Vali Loss: 4.843 Vali Acc: 0.500 Test Loss: 4.843 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.403244733810425
Epoch: 9, Steps: 70 | Train Loss: 4.537 Vali Loss: 5.324 Vali Acc: 0.500 Test Loss: 5.324 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.093665838241577
Epoch: 10, Steps: 70 | Train Loss: 4.607 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
Validation loss decreased (-0.509913 --> -0.509992).  Saving model ...
Epoch: 11 cost time: 9.870053052902222
Epoch: 11, Steps: 70 | Train Loss: 3.799 Vali Loss: 9.489 Vali Acc: 0.500 Test Loss: 9.489 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.62793493270874
Epoch: 12, Steps: 70 | Train Loss: 4.264 Vali Loss: 3.297 Vali Acc: 0.500 Test Loss: 3.297 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.952836275100708
Epoch: 13, Steps: 70 | Train Loss: 2.254 Vali Loss: 2.493 Vali Acc: 0.460 Test Loss: 2.493 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.104154348373413
Epoch: 14, Steps: 70 | Train Loss: 3.573 Vali Loss: 10.446 Vali Acc: 0.500 Test Loss: 10.446 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.999011754989624
Epoch: 15, Steps: 70 | Train Loss: 2.574 Vali Loss: 9.991 Vali Acc: 0.480 Test Loss: 9.991 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.011316537857056
Epoch: 16, Steps: 70 | Train Loss: 2.501 Vali Loss: 3.518 Vali Acc: 0.520 Test Loss: 3.518 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519965).  Saving model ...
Epoch: 17 cost time: 9.92612075805664
Epoch: 17, Steps: 70 | Train Loss: 2.238 Vali Loss: 6.469 Vali Acc: 0.540 Test Loss: 6.469 Test Acc: 0.540
Validation loss decreased (-0.519965 --> -0.539935).  Saving model ...
Epoch: 18 cost time: 11.047706365585327
Epoch: 18, Steps: 70 | Train Loss: 0.857 Vali Loss: 4.271 Vali Acc: 0.510 Test Loss: 4.271 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.940603971481323
Epoch: 19, Steps: 70 | Train Loss: 0.458 Vali Loss: 13.870 Vali Acc: 0.450 Test Loss: 13.870 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.813879489898682
Epoch: 20, Steps: 70 | Train Loss: 0.546 Vali Loss: 10.764 Vali Acc: 0.450 Test Loss: 10.764 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.225927829742432
Epoch: 21, Steps: 70 | Train Loss: 0.426 Vali Loss: 10.913 Vali Acc: 0.430 Test Loss: 10.913 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.177216053009033
Epoch: 22, Steps: 70 | Train Loss: 0.369 Vali Loss: 8.315 Vali Acc: 0.440 Test Loss: 8.315 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.136637210845947
Epoch: 23, Steps: 70 | Train Loss: 0.545 Vali Loss: 6.999 Vali Acc: 0.450 Test Loss: 6.999 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.034815788269043
Epoch: 24, Steps: 70 | Train Loss: 0.525 Vali Loss: 15.786 Vali Acc: 0.480 Test Loss: 15.786 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.86027717590332
Epoch: 25, Steps: 70 | Train Loss: 0.366 Vali Loss: 12.352 Vali Acc: 0.530 Test Loss: 12.352 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.916846513748169
Epoch: 26, Steps: 70 | Train Loss: 0.551 Vali Loss: 7.572 Vali Acc: 0.470 Test Loss: 7.572 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.275272846221924
Epoch: 27, Steps: 70 | Train Loss: 0.511 Vali Loss: 11.907 Vali Acc: 0.520 Test Loss: 11.907 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1480998
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.815688133239746
Epoch: 1, Steps: 70 | Train Loss: 2.395 Vali Loss: 5.389 Vali Acc: 0.500 Test Loss: 5.389 Test Acc: 0.500
Validation loss decreased (inf --> -0.499946).  Saving model ...
Epoch: 2 cost time: 9.842655181884766
Epoch: 2, Steps: 70 | Train Loss: 4.243 Vali Loss: 5.574 Vali Acc: 0.500 Test Loss: 5.574 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.67788577079773
Epoch: 3, Steps: 70 | Train Loss: 4.579 Vali Loss: 5.200 Vali Acc: 0.510 Test Loss: 5.200 Test Acc: 0.510
Validation loss decreased (-0.499946 --> -0.509948).  Saving model ...
Epoch: 4 cost time: 10.835016965866089
Epoch: 4, Steps: 70 | Train Loss: 8.453 Vali Loss: 15.136 Vali Acc: 0.480 Test Loss: 15.136 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.819006443023682
Epoch: 5, Steps: 70 | Train Loss: 6.757 Vali Loss: 4.994 Vali Acc: 0.590 Test Loss: 4.994 Test Acc: 0.590
Validation loss decreased (-0.509948 --> -0.589950).  Saving model ...
Epoch: 6 cost time: 10.674837112426758
Epoch: 6, Steps: 70 | Train Loss: 6.379 Vali Loss: 2.418 Vali Acc: 0.530 Test Loss: 2.418 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.679869890213013
Epoch: 7, Steps: 70 | Train Loss: 6.866 Vali Loss: 12.980 Vali Acc: 0.480 Test Loss: 12.980 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.915751218795776
Epoch: 8, Steps: 70 | Train Loss: 9.409 Vali Loss: 20.657 Vali Acc: 0.500 Test Loss: 20.657 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.571227788925171
Epoch: 9, Steps: 70 | Train Loss: 5.283 Vali Loss: 9.887 Vali Acc: 0.520 Test Loss: 9.887 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.742459774017334
Epoch: 10, Steps: 70 | Train Loss: 4.614 Vali Loss: 27.021 Vali Acc: 0.500 Test Loss: 27.021 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.819399356842041
Epoch: 11, Steps: 70 | Train Loss: 1.703 Vali Loss: 13.182 Vali Acc: 0.510 Test Loss: 13.182 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.617790699005127
Epoch: 12, Steps: 70 | Train Loss: 2.217 Vali Loss: 6.141 Vali Acc: 0.520 Test Loss: 6.141 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.00412130355835
Epoch: 13, Steps: 70 | Train Loss: 1.290 Vali Loss: 16.728 Vali Acc: 0.450 Test Loss: 16.728 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.760641813278198
Epoch: 14, Steps: 70 | Train Loss: 1.033 Vali Loss: 6.366 Vali Acc: 0.550 Test Loss: 6.366 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.76999545097351
Epoch: 15, Steps: 70 | Train Loss: 1.098 Vali Loss: 11.295 Vali Acc: 0.500 Test Loss: 11.295 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1468998
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.011626243591309
Epoch: 1, Steps: 70 | Train Loss: 2.309 Vali Loss: 2.277 Vali Acc: 0.520 Test Loss: 2.277 Test Acc: 0.520
Validation loss decreased (inf --> -0.519977).  Saving model ...
Epoch: 2 cost time: 10.197150707244873
Epoch: 2, Steps: 70 | Train Loss: 7.475 Vali Loss: 18.419 Vali Acc: 0.500 Test Loss: 18.419 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.263932704925537
Epoch: 3, Steps: 70 | Train Loss: 5.796 Vali Loss: 4.627 Vali Acc: 0.500 Test Loss: 4.627 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.360252618789673
Epoch: 4, Steps: 70 | Train Loss: 5.315 Vali Loss: 13.500 Vali Acc: 0.500 Test Loss: 13.500 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.275792360305786
Epoch: 5, Steps: 70 | Train Loss: 4.604 Vali Loss: 0.919 Vali Acc: 0.430 Test Loss: 0.919 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.073735475540161
Epoch: 6, Steps: 70 | Train Loss: 3.585 Vali Loss: 4.464 Vali Acc: 0.500 Test Loss: 4.464 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.495070934295654
Epoch: 7, Steps: 70 | Train Loss: 2.634 Vali Loss: 7.230 Vali Acc: 0.500 Test Loss: 7.230 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.632540225982666
Epoch: 8, Steps: 70 | Train Loss: 5.025 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
Validation loss decreased (-0.519977 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 10.281284809112549
Epoch: 9, Steps: 70 | Train Loss: 4.187 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.336513042449951
Epoch: 10, Steps: 70 | Train Loss: 4.238 Vali Loss: 2.204 Vali Acc: 0.500 Test Loss: 2.204 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.6086745262146
Epoch: 11, Steps: 70 | Train Loss: 1.985 Vali Loss: 3.064 Vali Acc: 0.500 Test Loss: 3.064 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.573554039001465
Epoch: 12, Steps: 70 | Train Loss: 4.159 Vali Loss: 3.151 Vali Acc: 0.500 Test Loss: 3.151 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.589574813842773
Epoch: 13, Steps: 70 | Train Loss: 3.687 Vali Loss: 5.509 Vali Acc: 0.500 Test Loss: 5.509 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.718545198440552
Epoch: 14, Steps: 70 | Train Loss: 3.410 Vali Loss: 3.185 Vali Acc: 0.480 Test Loss: 3.185 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.561116933822632
Epoch: 15, Steps: 70 | Train Loss: 1.698 Vali Loss: 3.713 Vali Acc: 0.500 Test Loss: 3.713 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.570391416549683
Epoch: 16, Steps: 70 | Train Loss: 1.758 Vali Loss: 9.607 Vali Acc: 0.500 Test Loss: 9.607 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.541136026382446
Epoch: 17, Steps: 70 | Train Loss: 2.116 Vali Loss: 4.665 Vali Acc: 0.480 Test Loss: 4.665 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.579195737838745
Epoch: 18, Steps: 70 | Train Loss: 1.714 Vali Loss: 7.951 Vali Acc: 0.480 Test Loss: 7.951 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1456998
model size : 6.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.043383836746216
Epoch: 1, Steps: 70 | Train Loss: 2.611 Vali Loss: 10.187 Vali Acc: 0.500 Test Loss: 10.187 Test Acc: 0.500
Validation loss decreased (inf --> -0.499898).  Saving model ...
Epoch: 2 cost time: 9.860053300857544
Epoch: 2, Steps: 70 | Train Loss: 5.275 Vali Loss: 1.054 Vali Acc: 0.490 Test Loss: 1.054 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.986828804016113
Epoch: 3, Steps: 70 | Train Loss: 6.323 Vali Loss: 4.492 Vali Acc: 0.510 Test Loss: 4.492 Test Acc: 0.510
Validation loss decreased (-0.499898 --> -0.509955).  Saving model ...
Epoch: 4 cost time: 8.89790415763855
Epoch: 4, Steps: 70 | Train Loss: 7.846 Vali Loss: 11.516 Vali Acc: 0.500 Test Loss: 11.516 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.046342611312866
Epoch: 5, Steps: 70 | Train Loss: 3.558 Vali Loss: 8.631 Vali Acc: 0.500 Test Loss: 8.631 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.978516340255737
Epoch: 6, Steps: 70 | Train Loss: 3.716 Vali Loss: 15.268 Vali Acc: 0.500 Test Loss: 15.268 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.1341712474823
Epoch: 7, Steps: 70 | Train Loss: 7.457 Vali Loss: 4.366 Vali Acc: 0.480 Test Loss: 4.366 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.220116376876831
Epoch: 8, Steps: 70 | Train Loss: 2.599 Vali Loss: 1.329 Vali Acc: 0.540 Test Loss: 1.329 Test Acc: 0.540
Validation loss decreased (-0.509955 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 8.915911674499512
Epoch: 9, Steps: 70 | Train Loss: 2.037 Vali Loss: 2.160 Vali Acc: 0.510 Test Loss: 2.160 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.18222689628601
Epoch: 10, Steps: 70 | Train Loss: 3.877 Vali Loss: 4.151 Vali Acc: 0.500 Test Loss: 4.151 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.99590015411377
Epoch: 11, Steps: 70 | Train Loss: 4.632 Vali Loss: 3.998 Vali Acc: 0.510 Test Loss: 3.998 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.183544635772705
Epoch: 12, Steps: 70 | Train Loss: 2.277 Vali Loss: 2.331 Vali Acc: 0.480 Test Loss: 2.331 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.236442565917969
Epoch: 13, Steps: 70 | Train Loss: 4.442 Vali Loss: 7.319 Vali Acc: 0.480 Test Loss: 7.319 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.184545755386353
Epoch: 14, Steps: 70 | Train Loss: 1.312 Vali Loss: 4.460 Vali Acc: 0.540 Test Loss: 4.460 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.671767950057983
Epoch: 15, Steps: 70 | Train Loss: 1.878 Vali Loss: 5.652 Vali Acc: 0.500 Test Loss: 5.652 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.19313645362854
Epoch: 16, Steps: 70 | Train Loss: 1.464 Vali Loss: 10.547 Vali Acc: 0.500 Test Loss: 10.547 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.301170349121094
Epoch: 17, Steps: 70 | Train Loss: 2.579 Vali Loss: 4.154 Vali Acc: 0.520 Test Loss: 4.154 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.20294451713562
Epoch: 18, Steps: 70 | Train Loss: 0.819 Vali Loss: 9.126 Vali Acc: 0.470 Test Loss: 9.126 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1326598
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.180049419403076
Epoch: 1, Steps: 70 | Train Loss: 2.469 Vali Loss: 1.292 Vali Acc: 0.510 Test Loss: 1.292 Test Acc: 0.510
Validation loss decreased (inf --> -0.509987).  Saving model ...
Epoch: 2 cost time: 9.972941160202026
Epoch: 2, Steps: 70 | Train Loss: 6.595 Vali Loss: 5.038 Vali Acc: 0.480 Test Loss: 5.038 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.905065059661865
Epoch: 3, Steps: 70 | Train Loss: 5.926 Vali Loss: 9.152 Vali Acc: 0.500 Test Loss: 9.152 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.745710134506226
Epoch: 4, Steps: 70 | Train Loss: 5.513 Vali Loss: 10.345 Vali Acc: 0.500 Test Loss: 10.345 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.746805191040039
Epoch: 5, Steps: 70 | Train Loss: 5.397 Vali Loss: 5.234 Vali Acc: 0.500 Test Loss: 5.234 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.929615259170532
Epoch: 6, Steps: 70 | Train Loss: 4.208 Vali Loss: 7.827 Vali Acc: 0.500 Test Loss: 7.827 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.972768068313599
Epoch: 7, Steps: 70 | Train Loss: 5.077 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.872921705245972
Epoch: 8, Steps: 70 | Train Loss: 6.054 Vali Loss: 4.951 Vali Acc: 0.500 Test Loss: 4.951 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.830791234970093
Epoch: 9, Steps: 70 | Train Loss: 4.870 Vali Loss: 3.987 Vali Acc: 0.530 Test Loss: 3.987 Test Acc: 0.530
Validation loss decreased (-0.509987 --> -0.529960).  Saving model ...
Epoch: 10 cost time: 9.383326768875122
Epoch: 10, Steps: 70 | Train Loss: 3.471 Vali Loss: 5.591 Vali Acc: 0.610 Test Loss: 5.591 Test Acc: 0.610
Validation loss decreased (-0.529960 --> -0.609944).  Saving model ...
Epoch: 11 cost time: 9.938437461853027
Epoch: 11, Steps: 70 | Train Loss: 4.123 Vali Loss: 4.231 Vali Acc: 0.520 Test Loss: 4.231 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.049771308898926
Epoch: 12, Steps: 70 | Train Loss: 2.887 Vali Loss: 4.749 Vali Acc: 0.500 Test Loss: 4.749 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.069175958633423
Epoch: 13, Steps: 70 | Train Loss: 0.937 Vali Loss: 6.131 Vali Acc: 0.500 Test Loss: 6.131 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.958904504776001
Epoch: 14, Steps: 70 | Train Loss: 1.676 Vali Loss: 4.998 Vali Acc: 0.620 Test Loss: 4.998 Test Acc: 0.620
Validation loss decreased (-0.609944 --> -0.619950).  Saving model ...
Epoch: 15 cost time: 9.097707509994507
Epoch: 15, Steps: 70 | Train Loss: 1.114 Vali Loss: 7.894 Vali Acc: 0.530 Test Loss: 7.894 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.8837571144104
Epoch: 16, Steps: 70 | Train Loss: 0.590 Vali Loss: 8.551 Vali Acc: 0.470 Test Loss: 8.551 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.114754676818848
Epoch: 17, Steps: 70 | Train Loss: 0.231 Vali Loss: 9.771 Vali Acc: 0.410 Test Loss: 9.771 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.855945587158203
Epoch: 18, Steps: 70 | Train Loss: 0.330 Vali Loss: 7.375 Vali Acc: 0.470 Test Loss: 7.375 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.094136714935303
Epoch: 19, Steps: 70 | Train Loss: 0.217 Vali Loss: 6.873 Vali Acc: 0.520 Test Loss: 6.873 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.01416015625
Epoch: 20, Steps: 70 | Train Loss: 0.389 Vali Loss: 9.078 Vali Acc: 0.460 Test Loss: 9.078 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.920347929000854
Epoch: 21, Steps: 70 | Train Loss: 0.227 Vali Loss: 12.795 Vali Acc: 0.500 Test Loss: 12.795 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.144895315170288
Epoch: 22, Steps: 70 | Train Loss: 0.440 Vali Loss: 11.162 Vali Acc: 0.510 Test Loss: 11.162 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.122501611709595
Epoch: 23, Steps: 70 | Train Loss: 0.373 Vali Loss: 9.911 Vali Acc: 0.500 Test Loss: 9.911 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.387300491333008
Epoch: 24, Steps: 70 | Train Loss: 0.523 Vali Loss: 11.059 Vali Acc: 0.470 Test Loss: 11.059 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1314598
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.668416261672974
Epoch: 1, Steps: 70 | Train Loss: 2.556 Vali Loss: 12.020 Vali Acc: 0.500 Test Loss: 12.020 Test Acc: 0.500
Validation loss decreased (inf --> -0.499880).  Saving model ...
Epoch: 2 cost time: 9.850135803222656
Epoch: 2, Steps: 70 | Train Loss: 5.395 Vali Loss: 3.503 Vali Acc: 0.470 Test Loss: 3.503 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.244322538375854
Epoch: 3, Steps: 70 | Train Loss: 7.583 Vali Loss: 3.355 Vali Acc: 0.500 Test Loss: 3.355 Test Acc: 0.500
Validation loss decreased (-0.499880 --> -0.499966).  Saving model ...
Epoch: 4 cost time: 8.654073715209961
Epoch: 4, Steps: 70 | Train Loss: 5.702 Vali Loss: 3.180 Vali Acc: 0.500 Test Loss: 3.180 Test Acc: 0.500
Validation loss decreased (-0.499966 --> -0.499968).  Saving model ...
Epoch: 5 cost time: 9.691984176635742
Epoch: 5, Steps: 70 | Train Loss: 4.581 Vali Loss: 21.783 Vali Acc: 0.500 Test Loss: 21.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.578893423080444
Epoch: 6, Steps: 70 | Train Loss: 11.790 Vali Loss: 1.379 Vali Acc: 0.600 Test Loss: 1.379 Test Acc: 0.600
Validation loss decreased (-0.499968 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 9.649046182632446
Epoch: 7, Steps: 70 | Train Loss: 3.825 Vali Loss: 4.430 Vali Acc: 0.500 Test Loss: 4.430 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.419283866882324
Epoch: 8, Steps: 70 | Train Loss: 6.415 Vali Loss: 2.512 Vali Acc: 0.500 Test Loss: 2.512 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.60650110244751
Epoch: 9, Steps: 70 | Train Loss: 3.231 Vali Loss: 4.981 Vali Acc: 0.480 Test Loss: 4.981 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.659955978393555
Epoch: 10, Steps: 70 | Train Loss: 1.949 Vali Loss: 2.856 Vali Acc: 0.500 Test Loss: 2.856 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.692088842391968
Epoch: 11, Steps: 70 | Train Loss: 3.342 Vali Loss: 7.141 Vali Acc: 0.530 Test Loss: 7.141 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.64769983291626
Epoch: 12, Steps: 70 | Train Loss: 2.683 Vali Loss: 13.086 Vali Acc: 0.500 Test Loss: 13.086 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.865385055541992
Epoch: 13, Steps: 70 | Train Loss: 3.733 Vali Loss: 10.177 Vali Acc: 0.510 Test Loss: 10.177 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.696375370025635
Epoch: 14, Steps: 70 | Train Loss: 2.259 Vali Loss: 1.932 Vali Acc: 0.590 Test Loss: 1.932 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.428287744522095
Epoch: 15, Steps: 70 | Train Loss: 1.327 Vali Loss: 5.699 Vali Acc: 0.540 Test Loss: 5.699 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.63689923286438
Epoch: 16, Steps: 70 | Train Loss: 1.719 Vali Loss: 7.268 Vali Acc: 0.470 Test Loss: 7.268 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1302598
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.36601209640503
Epoch: 1, Steps: 70 | Train Loss: 2.257 Vali Loss: 1.986 Vali Acc: 0.500 Test Loss: 1.986 Test Acc: 0.500
Validation loss decreased (inf --> -0.499980).  Saving model ...
Epoch: 2 cost time: 8.240161895751953
Epoch: 2, Steps: 70 | Train Loss: 3.447 Vali Loss: 6.760 Vali Acc: 0.500 Test Loss: 6.760 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.374397039413452
Epoch: 3, Steps: 70 | Train Loss: 6.952 Vali Loss: 25.577 Vali Acc: 0.500 Test Loss: 25.577 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.24626636505127
Epoch: 4, Steps: 70 | Train Loss: 6.118 Vali Loss: 2.960 Vali Acc: 0.420 Test Loss: 2.960 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.354806423187256
Epoch: 5, Steps: 70 | Train Loss: 5.629 Vali Loss: 5.725 Vali Acc: 0.500 Test Loss: 5.725 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.00551962852478
Epoch: 6, Steps: 70 | Train Loss: 3.859 Vali Loss: 7.392 Vali Acc: 0.500 Test Loss: 7.392 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.238770008087158
Epoch: 7, Steps: 70 | Train Loss: 5.266 Vali Loss: 20.260 Vali Acc: 0.500 Test Loss: 20.260 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.362138271331787
Epoch: 8, Steps: 70 | Train Loss: 6.155 Vali Loss: 7.863 Vali Acc: 0.500 Test Loss: 7.863 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.319218158721924
Epoch: 9, Steps: 70 | Train Loss: 3.928 Vali Loss: 2.198 Vali Acc: 0.520 Test Loss: 2.198 Test Acc: 0.520
Validation loss decreased (-0.499980 --> -0.519978).  Saving model ...
Epoch: 10 cost time: 9.371987581253052
Epoch: 10, Steps: 70 | Train Loss: 2.457 Vali Loss: 6.943 Vali Acc: 0.500 Test Loss: 6.943 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.385472774505615
Epoch: 11, Steps: 70 | Train Loss: 3.139 Vali Loss: 2.241 Vali Acc: 0.580 Test Loss: 2.241 Test Acc: 0.580
Validation loss decreased (-0.519978 --> -0.579978).  Saving model ...
Epoch: 12 cost time: 8.269077777862549
Epoch: 12, Steps: 70 | Train Loss: 1.807 Vali Loss: 3.052 Vali Acc: 0.420 Test Loss: 3.052 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.814796924591064
Epoch: 13, Steps: 70 | Train Loss: 1.879 Vali Loss: 8.602 Vali Acc: 0.510 Test Loss: 8.602 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.383762836456299
Epoch: 14, Steps: 70 | Train Loss: 2.637 Vali Loss: 33.433 Vali Acc: 0.500 Test Loss: 33.433 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.401689052581787
Epoch: 15, Steps: 70 | Train Loss: 2.401 Vali Loss: 8.665 Vali Acc: 0.470 Test Loss: 8.665 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.344908714294434
Epoch: 16, Steps: 70 | Train Loss: 2.025 Vali Loss: 9.188 Vali Acc: 0.520 Test Loss: 9.188 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.287237167358398
Epoch: 17, Steps: 70 | Train Loss: 0.707 Vali Loss: 9.722 Vali Acc: 0.550 Test Loss: 9.722 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.255418539047241
Epoch: 18, Steps: 70 | Train Loss: 0.771 Vali Loss: 6.353 Vali Acc: 0.560 Test Loss: 6.353 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.525230884552002
Epoch: 19, Steps: 70 | Train Loss: 0.870 Vali Loss: 14.198 Vali Acc: 0.520 Test Loss: 14.198 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.386276245117188
Epoch: 20, Steps: 70 | Train Loss: 0.748 Vali Loss: 18.671 Vali Acc: 0.540 Test Loss: 18.671 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.432249069213867
Epoch: 21, Steps: 70 | Train Loss: 0.451 Vali Loss: 7.807 Vali Acc: 0.570 Test Loss: 7.807 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1290598
model size : 5.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.481258630752563
Epoch: 1, Steps: 70 | Train Loss: 2.975 Vali Loss: 3.980 Vali Acc: 0.510 Test Loss: 3.980 Test Acc: 0.510
Validation loss decreased (inf --> -0.509960).  Saving model ...
Epoch: 2 cost time: 9.688822984695435
Epoch: 2, Steps: 70 | Train Loss: 3.904 Vali Loss: 14.857 Vali Acc: 0.500 Test Loss: 14.857 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.616167306900024
Epoch: 3, Steps: 70 | Train Loss: 10.038 Vali Loss: 8.107 Vali Acc: 0.490 Test Loss: 8.107 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.734470844268799
Epoch: 4, Steps: 70 | Train Loss: 4.124 Vali Loss: 2.513 Vali Acc: 0.520 Test Loss: 2.513 Test Acc: 0.520
Validation loss decreased (-0.509960 --> -0.519975).  Saving model ...
Epoch: 5 cost time: 8.63120436668396
Epoch: 5, Steps: 70 | Train Loss: 7.064 Vali Loss: 4.911 Vali Acc: 0.500 Test Loss: 4.911 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.779904842376709
Epoch: 6, Steps: 70 | Train Loss: 4.672 Vali Loss: 1.727 Vali Acc: 0.520 Test Loss: 1.727 Test Acc: 0.520
Validation loss decreased (-0.519975 --> -0.519983).  Saving model ...
Epoch: 7 cost time: 9.7371084690094
Epoch: 7, Steps: 70 | Train Loss: 4.538 Vali Loss: 7.379 Vali Acc: 0.500 Test Loss: 7.379 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.722294330596924
Epoch: 8, Steps: 70 | Train Loss: 2.831 Vali Loss: 3.263 Vali Acc: 0.500 Test Loss: 3.263 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.806320667266846
Epoch: 9, Steps: 70 | Train Loss: 6.107 Vali Loss: 1.918 Vali Acc: 0.480 Test Loss: 1.918 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.59918475151062
Epoch: 10, Steps: 70 | Train Loss: 3.868 Vali Loss: 3.140 Vali Acc: 0.510 Test Loss: 3.140 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.67196249961853
Epoch: 11, Steps: 70 | Train Loss: 5.891 Vali Loss: 2.010 Vali Acc: 0.490 Test Loss: 2.010 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.827044486999512
Epoch: 12, Steps: 70 | Train Loss: 2.386 Vali Loss: 5.807 Vali Acc: 0.510 Test Loss: 5.807 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.27724814414978
Epoch: 13, Steps: 70 | Train Loss: 3.233 Vali Loss: 19.673 Vali Acc: 0.500 Test Loss: 19.673 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.234874725341797
Epoch: 14, Steps: 70 | Train Loss: 3.713 Vali Loss: 5.057 Vali Acc: 0.510 Test Loss: 5.057 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.158335447311401
Epoch: 15, Steps: 70 | Train Loss: 1.623 Vali Loss: 7.028 Vali Acc: 0.510 Test Loss: 7.028 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.388664245605469
Epoch: 16, Steps: 70 | Train Loss: 0.668 Vali Loss: 6.992 Vali Acc: 0.560 Test Loss: 6.992 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559930).  Saving model ...
Epoch: 17 cost time: 9.238455057144165
Epoch: 17, Steps: 70 | Train Loss: 1.899 Vali Loss: 12.184 Vali Acc: 0.550 Test Loss: 12.184 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.269215106964111
Epoch: 18, Steps: 70 | Train Loss: 1.381 Vali Loss: 7.262 Vali Acc: 0.590 Test Loss: 7.262 Test Acc: 0.590
Validation loss decreased (-0.559930 --> -0.589927).  Saving model ...
Epoch: 19 cost time: 9.222121000289917
Epoch: 19, Steps: 70 | Train Loss: 0.899 Vali Loss: 5.018 Vali Acc: 0.550 Test Loss: 5.018 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.323004484176636
Epoch: 20, Steps: 70 | Train Loss: 0.333 Vali Loss: 7.357 Vali Acc: 0.530 Test Loss: 7.357 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.910491228103638
Epoch: 21, Steps: 70 | Train Loss: 0.355 Vali Loss: 12.554 Vali Acc: 0.520 Test Loss: 12.554 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.191131591796875
Epoch: 22, Steps: 70 | Train Loss: 1.059 Vali Loss: 8.935 Vali Acc: 0.450 Test Loss: 8.935 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.19981598854065
Epoch: 23, Steps: 70 | Train Loss: 1.272 Vali Loss: 12.984 Vali Acc: 0.450 Test Loss: 12.984 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.598182678222656
Epoch: 24, Steps: 70 | Train Loss: 0.316 Vali Loss: 9.370 Vali Acc: 0.540 Test Loss: 9.370 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.406642436981201
Epoch: 25, Steps: 70 | Train Loss: 0.551 Vali Loss: 13.551 Vali Acc: 0.530 Test Loss: 13.551 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.250072956085205
Epoch: 26, Steps: 70 | Train Loss: 0.558 Vali Loss: 25.619 Vali Acc: 0.520 Test Loss: 25.619 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.07671570777893
Epoch: 27, Steps: 70 | Train Loss: 0.514 Vali Loss: 13.979 Vali Acc: 0.510 Test Loss: 13.979 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.209928035736084
Epoch: 28, Steps: 70 | Train Loss: 0.197 Vali Loss: 14.431 Vali Acc: 0.550 Test Loss: 14.431 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1243398
model size : 5.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.062265634536743
Epoch: 1, Steps: 70 | Train Loss: 4.146 Vali Loss: 3.105 Vali Acc: 0.490 Test Loss: 3.105 Test Acc: 0.490
Validation loss decreased (inf --> -0.489969).  Saving model ...
Epoch: 2 cost time: 8.928296327590942
Epoch: 2, Steps: 70 | Train Loss: 5.266 Vali Loss: 3.713 Vali Acc: 0.500 Test Loss: 3.713 Test Acc: 0.500
Validation loss decreased (-0.489969 --> -0.499963).  Saving model ...
Epoch: 3 cost time: 8.276800155639648
Epoch: 3, Steps: 70 | Train Loss: 4.635 Vali Loss: 9.865 Vali Acc: 0.500 Test Loss: 9.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.43222713470459
Epoch: 4, Steps: 70 | Train Loss: 4.887 Vali Loss: 6.167 Vali Acc: 0.500 Test Loss: 6.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.999590635299683
Epoch: 5, Steps: 70 | Train Loss: 10.201 Vali Loss: 9.180 Vali Acc: 0.510 Test Loss: 9.180 Test Acc: 0.510
Validation loss decreased (-0.499963 --> -0.509908).  Saving model ...
Epoch: 6 cost time: 9.035293102264404
Epoch: 6, Steps: 70 | Train Loss: 2.893 Vali Loss: 3.622 Vali Acc: 0.500 Test Loss: 3.622 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.98711085319519
Epoch: 7, Steps: 70 | Train Loss: 4.518 Vali Loss: 9.103 Vali Acc: 0.540 Test Loss: 9.103 Test Acc: 0.540
Validation loss decreased (-0.509908 --> -0.539909).  Saving model ...
Epoch: 8 cost time: 8.336018562316895
Epoch: 8, Steps: 70 | Train Loss: 6.469 Vali Loss: 16.588 Vali Acc: 0.500 Test Loss: 16.588 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.228054285049438
Epoch: 9, Steps: 70 | Train Loss: 6.240 Vali Loss: 14.391 Vali Acc: 0.550 Test Loss: 14.391 Test Acc: 0.550
Validation loss decreased (-0.539909 --> -0.549856).  Saving model ...
Epoch: 10 cost time: 9.073646068572998
Epoch: 10, Steps: 70 | Train Loss: 3.386 Vali Loss: 11.514 Vali Acc: 0.540 Test Loss: 11.514 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.082346677780151
Epoch: 11, Steps: 70 | Train Loss: 2.148 Vali Loss: 11.099 Vali Acc: 0.500 Test Loss: 11.099 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.505244493484497
Epoch: 12, Steps: 70 | Train Loss: 2.054 Vali Loss: 10.050 Vali Acc: 0.540 Test Loss: 10.050 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.60507082939148
Epoch: 13, Steps: 70 | Train Loss: 0.875 Vali Loss: 20.540 Vali Acc: 0.540 Test Loss: 20.540 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.116178750991821
Epoch: 14, Steps: 70 | Train Loss: 1.688 Vali Loss: 9.639 Vali Acc: 0.510 Test Loss: 9.639 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.126680135726929
Epoch: 15, Steps: 70 | Train Loss: 1.368 Vali Loss: 5.853 Vali Acc: 0.590 Test Loss: 5.853 Test Acc: 0.590
Validation loss decreased (-0.549856 --> -0.589941).  Saving model ...
Epoch: 16 cost time: 8.929450273513794
Epoch: 16, Steps: 70 | Train Loss: 0.647 Vali Loss: 11.473 Vali Acc: 0.460 Test Loss: 11.473 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.34663701057434
Epoch: 17, Steps: 70 | Train Loss: 0.139 Vali Loss: 13.644 Vali Acc: 0.460 Test Loss: 13.644 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.143303632736206
Epoch: 18, Steps: 70 | Train Loss: 0.420 Vali Loss: 21.646 Vali Acc: 0.510 Test Loss: 21.646 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.070326566696167
Epoch: 19, Steps: 70 | Train Loss: 0.637 Vali Loss: 10.853 Vali Acc: 0.560 Test Loss: 10.853 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.309818744659424
Epoch: 20, Steps: 70 | Train Loss: 1.172 Vali Loss: 21.624 Vali Acc: 0.530 Test Loss: 21.624 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.334218978881836
Epoch: 21, Steps: 70 | Train Loss: 1.271 Vali Loss: 36.368 Vali Acc: 0.510 Test Loss: 36.368 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.014279842376709
Epoch: 22, Steps: 70 | Train Loss: 3.029 Vali Loss: 19.556 Vali Acc: 0.540 Test Loss: 19.556 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.225260019302368
Epoch: 23, Steps: 70 | Train Loss: 0.178 Vali Loss: 16.978 Vali Acc: 0.480 Test Loss: 16.978 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.047562599182129
Epoch: 24, Steps: 70 | Train Loss: 0.154 Vali Loss: 22.375 Vali Acc: 0.410 Test Loss: 22.375 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.61549186706543
Epoch: 25, Steps: 70 | Train Loss: 0.203 Vali Loss: 30.667 Vali Acc: 0.490 Test Loss: 30.667 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1231398
model size : 5.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.040074586868286
Epoch: 1, Steps: 70 | Train Loss: 3.287 Vali Loss: 3.741 Vali Acc: 0.520 Test Loss: 3.741 Test Acc: 0.520
Validation loss decreased (inf --> -0.519963).  Saving model ...
Epoch: 2 cost time: 8.604340076446533
Epoch: 2, Steps: 70 | Train Loss: 4.747 Vali Loss: 5.060 Vali Acc: 0.500 Test Loss: 5.060 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.173609972000122
Epoch: 3, Steps: 70 | Train Loss: 7.544 Vali Loss: 3.143 Vali Acc: 0.500 Test Loss: 3.143 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.96795129776001
Epoch: 4, Steps: 70 | Train Loss: 4.994 Vali Loss: 5.190 Vali Acc: 0.500 Test Loss: 5.190 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.90016484260559
Epoch: 5, Steps: 70 | Train Loss: 3.176 Vali Loss: 14.163 Vali Acc: 0.500 Test Loss: 14.163 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.918465852737427
Epoch: 6, Steps: 70 | Train Loss: 7.185 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.054551839828491
Epoch: 7, Steps: 70 | Train Loss: 4.794 Vali Loss: 4.846 Vali Acc: 0.500 Test Loss: 4.846 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.846028566360474
Epoch: 8, Steps: 70 | Train Loss: 5.703 Vali Loss: 10.898 Vali Acc: 0.500 Test Loss: 10.898 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.085102081298828
Epoch: 9, Steps: 70 | Train Loss: 4.928 Vali Loss: 7.916 Vali Acc: 0.500 Test Loss: 7.916 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.070400714874268
Epoch: 10, Steps: 70 | Train Loss: 3.665 Vali Loss: 7.089 Vali Acc: 0.500 Test Loss: 7.089 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.43840503692627
Epoch: 11, Steps: 70 | Train Loss: 2.050 Vali Loss: 7.280 Vali Acc: 0.500 Test Loss: 7.280 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 1219398
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.565759658813477
Epoch: 1, Steps: 70 | Train Loss: 3.765 Vali Loss: 17.884 Vali Acc: 0.500 Test Loss: 17.884 Test Acc: 0.500
Validation loss decreased (inf --> -0.499821).  Saving model ...
Epoch: 2 cost time: 8.046249628067017
Epoch: 2, Steps: 70 | Train Loss: 8.275 Vali Loss: 7.961 Vali Acc: 0.490 Test Loss: 7.961 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.789926528930664
Epoch: 3, Steps: 70 | Train Loss: 4.613 Vali Loss: 11.251 Vali Acc: 0.500 Test Loss: 11.251 Test Acc: 0.500
Validation loss decreased (-0.499821 --> -0.499887).  Saving model ...
Epoch: 4 cost time: 8.588234901428223
Epoch: 4, Steps: 70 | Train Loss: 5.915 Vali Loss: 1.658 Vali Acc: 0.470 Test Loss: 1.658 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.61462688446045
Epoch: 5, Steps: 70 | Train Loss: 3.894 Vali Loss: 5.189 Vali Acc: 0.500 Test Loss: 5.189 Test Acc: 0.500
Validation loss decreased (-0.499887 --> -0.499948).  Saving model ...
Epoch: 6 cost time: 8.67382550239563
Epoch: 6, Steps: 70 | Train Loss: 6.906 Vali Loss: 9.081 Vali Acc: 0.500 Test Loss: 9.081 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.939443111419678
Epoch: 7, Steps: 70 | Train Loss: 8.603 Vali Loss: 2.077 Vali Acc: 0.470 Test Loss: 2.077 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.596419334411621
Epoch: 8, Steps: 70 | Train Loss: 3.446 Vali Loss: 6.503 Vali Acc: 0.500 Test Loss: 6.503 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.38495922088623
Epoch: 9, Steps: 70 | Train Loss: 4.214 Vali Loss: 13.641 Vali Acc: 0.500 Test Loss: 13.641 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.55330514907837
Epoch: 10, Steps: 70 | Train Loss: 8.203 Vali Loss: 1.352 Vali Acc: 0.520 Test Loss: 1.352 Test Acc: 0.520
Validation loss decreased (-0.499948 --> -0.519986).  Saving model ...
Epoch: 11 cost time: 8.355964660644531
Epoch: 11, Steps: 70 | Train Loss: 2.304 Vali Loss: 3.105 Vali Acc: 0.510 Test Loss: 3.105 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.7798261642456055
Epoch: 12, Steps: 70 | Train Loss: 3.458 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.60717511177063
Epoch: 13, Steps: 70 | Train Loss: 2.360 Vali Loss: 3.593 Vali Acc: 0.490 Test Loss: 3.593 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.62070083618164
Epoch: 14, Steps: 70 | Train Loss: 2.438 Vali Loss: 2.666 Vali Acc: 0.570 Test Loss: 2.666 Test Acc: 0.570
Validation loss decreased (-0.519986 --> -0.569973).  Saving model ...
Epoch: 15 cost time: 8.612936973571777
Epoch: 15, Steps: 70 | Train Loss: 1.543 Vali Loss: 3.431 Vali Acc: 0.560 Test Loss: 3.431 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.795880079269409
Epoch: 16, Steps: 70 | Train Loss: 3.301 Vali Loss: 2.408 Vali Acc: 0.510 Test Loss: 2.408 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.03375768661499
Epoch: 17, Steps: 70 | Train Loss: 2.911 Vali Loss: 6.537 Vali Acc: 0.490 Test Loss: 6.537 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.65345549583435
Epoch: 18, Steps: 70 | Train Loss: 1.187 Vali Loss: 8.459 Vali Acc: 0.440 Test Loss: 8.459 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.5896315574646
Epoch: 19, Steps: 70 | Train Loss: 0.288 Vali Loss: 6.576 Vali Acc: 0.420 Test Loss: 6.576 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.405623197555542
Epoch: 20, Steps: 70 | Train Loss: 0.364 Vali Loss: 6.120 Vali Acc: 0.520 Test Loss: 6.120 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.7399351596832275
Epoch: 21, Steps: 70 | Train Loss: 0.477 Vali Loss: 8.183 Vali Acc: 0.550 Test Loss: 8.183 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.473118543624878
Epoch: 22, Steps: 70 | Train Loss: 0.216 Vali Loss: 17.552 Vali Acc: 0.450 Test Loss: 17.552 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.680907249450684
Epoch: 23, Steps: 70 | Train Loss: 0.299 Vali Loss: 13.398 Vali Acc: 0.490 Test Loss: 13.398 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.625284910202026
Epoch: 24, Steps: 70 | Train Loss: 0.300 Vali Loss: 14.454 Vali Acc: 0.450 Test Loss: 14.454 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1207398
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.130727052688599
Epoch: 1, Steps: 70 | Train Loss: 3.701 Vali Loss: 7.921 Vali Acc: 0.500 Test Loss: 7.921 Test Acc: 0.500
Validation loss decreased (inf --> -0.499921).  Saving model ...
Epoch: 2 cost time: 9.144063472747803
Epoch: 2, Steps: 70 | Train Loss: 4.927 Vali Loss: 13.949 Vali Acc: 0.500 Test Loss: 13.949 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.790215730667114
Epoch: 3, Steps: 70 | Train Loss: 6.575 Vali Loss: 9.438 Vali Acc: 0.500 Test Loss: 9.438 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.197451829910278
Epoch: 4, Steps: 70 | Train Loss: 6.474 Vali Loss: 1.752 Vali Acc: 0.580 Test Loss: 1.752 Test Acc: 0.580
Validation loss decreased (-0.499921 --> -0.579982).  Saving model ...
Epoch: 5 cost time: 7.412776947021484
Epoch: 5, Steps: 70 | Train Loss: 12.185 Vali Loss: 26.098 Vali Acc: 0.500 Test Loss: 26.098 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.467775821685791
Epoch: 6, Steps: 70 | Train Loss: 10.045 Vali Loss: 6.416 Vali Acc: 0.510 Test Loss: 6.416 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.10723066329956
Epoch: 7, Steps: 70 | Train Loss: 11.090 Vali Loss: 7.499 Vali Acc: 0.480 Test Loss: 7.499 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.190248012542725
Epoch: 8, Steps: 70 | Train Loss: 9.907 Vali Loss: 11.739 Vali Acc: 0.520 Test Loss: 11.739 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.070408344268799
Epoch: 9, Steps: 70 | Train Loss: 4.734 Vali Loss: 9.324 Vali Acc: 0.490 Test Loss: 9.324 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.082530498504639
Epoch: 10, Steps: 70 | Train Loss: 2.939 Vali Loss: 8.109 Vali Acc: 0.520 Test Loss: 8.109 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.383624076843262
Epoch: 11, Steps: 70 | Train Loss: 1.980 Vali Loss: 13.746 Vali Acc: 0.460 Test Loss: 13.746 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.593779802322388
Epoch: 12, Steps: 70 | Train Loss: 1.476 Vali Loss: 18.317 Vali Acc: 0.510 Test Loss: 18.317 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.942031621932983
Epoch: 13, Steps: 70 | Train Loss: 2.995 Vali Loss: 24.122 Vali Acc: 0.540 Test Loss: 24.122 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.815311431884766
Epoch: 14, Steps: 70 | Train Loss: 2.744 Vali Loss: 10.786 Vali Acc: 0.510 Test Loss: 10.786 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1201798
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.011644124984741
Epoch: 1, Steps: 70 | Train Loss: 3.341 Vali Loss: 14.395 Vali Acc: 0.500 Test Loss: 14.395 Test Acc: 0.500
Validation loss decreased (inf --> -0.499856).  Saving model ...
Epoch: 2 cost time: 8.567659139633179
Epoch: 2, Steps: 70 | Train Loss: 8.395 Vali Loss: 2.758 Vali Acc: 0.500 Test Loss: 2.758 Test Acc: 0.500
Validation loss decreased (-0.499856 --> -0.499972).  Saving model ...
Epoch: 3 cost time: 8.438522577285767
Epoch: 3, Steps: 70 | Train Loss: 7.633 Vali Loss: 3.696 Vali Acc: 0.500 Test Loss: 3.696 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.950607299804688
Epoch: 4, Steps: 70 | Train Loss: 4.484 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 8.498255014419556
Epoch: 5, Steps: 70 | Train Loss: 3.242 Vali Loss: 1.818 Vali Acc: 0.490 Test Loss: 1.818 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.38467288017273
Epoch: 6, Steps: 70 | Train Loss: 3.773 Vali Loss: 3.128 Vali Acc: 0.500 Test Loss: 3.128 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.11346697807312
Epoch: 7, Steps: 70 | Train Loss: 3.267 Vali Loss: 6.034 Vali Acc: 0.500 Test Loss: 6.034 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.469113111495972
Epoch: 8, Steps: 70 | Train Loss: 2.942 Vali Loss: 1.180 Vali Acc: 0.580 Test Loss: 1.180 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579988).  Saving model ...
Epoch: 9 cost time: 8.560523271560669
Epoch: 9, Steps: 70 | Train Loss: 5.664 Vali Loss: 3.906 Vali Acc: 0.500 Test Loss: 3.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.229480028152466
Epoch: 10, Steps: 70 | Train Loss: 2.038 Vali Loss: 1.238 Vali Acc: 0.570 Test Loss: 1.238 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.466727018356323
Epoch: 11, Steps: 70 | Train Loss: 3.022 Vali Loss: 1.866 Vali Acc: 0.590 Test Loss: 1.866 Test Acc: 0.590
Validation loss decreased (-0.579988 --> -0.589981).  Saving model ...
Epoch: 12 cost time: 8.797223567962646
Epoch: 12, Steps: 70 | Train Loss: 3.754 Vali Loss: 9.371 Vali Acc: 0.510 Test Loss: 9.371 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.02756404876709
Epoch: 13, Steps: 70 | Train Loss: 4.898 Vali Loss: 6.231 Vali Acc: 0.500 Test Loss: 6.231 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.199836730957031
Epoch: 14, Steps: 70 | Train Loss: 1.949 Vali Loss: 2.498 Vali Acc: 0.560 Test Loss: 2.498 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.913959741592407
Epoch: 15, Steps: 70 | Train Loss: 2.595 Vali Loss: 6.738 Vali Acc: 0.500 Test Loss: 6.738 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.048055410385132
Epoch: 16, Steps: 70 | Train Loss: 1.005 Vali Loss: 7.101 Vali Acc: 0.480 Test Loss: 7.101 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.070887804031372
Epoch: 17, Steps: 70 | Train Loss: 1.471 Vali Loss: 6.094 Vali Acc: 0.520 Test Loss: 6.094 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.785753726959229
Epoch: 18, Steps: 70 | Train Loss: 1.649 Vali Loss: 7.642 Vali Acc: 0.540 Test Loss: 7.642 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.969829797744751
Epoch: 19, Steps: 70 | Train Loss: 1.874 Vali Loss: 4.200 Vali Acc: 0.600 Test Loss: 4.200 Test Acc: 0.600
Validation loss decreased (-0.589981 --> -0.599958).  Saving model ...
Epoch: 20 cost time: 8.171255588531494
Epoch: 20, Steps: 70 | Train Loss: 0.746 Vali Loss: 5.891 Vali Acc: 0.470 Test Loss: 5.891 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.637928485870361
Epoch: 21, Steps: 70 | Train Loss: 0.587 Vali Loss: 4.663 Vali Acc: 0.540 Test Loss: 4.663 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.939877271652222
Epoch: 22, Steps: 70 | Train Loss: 0.123 Vali Loss: 7.172 Vali Acc: 0.500 Test Loss: 7.172 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.204672574996948
Epoch: 23, Steps: 70 | Train Loss: 0.285 Vali Loss: 11.546 Vali Acc: 0.490 Test Loss: 11.546 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.57965612411499
Epoch: 24, Steps: 70 | Train Loss: 0.709 Vali Loss: 11.479 Vali Acc: 0.550 Test Loss: 11.479 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.898274421691895
Epoch: 25, Steps: 70 | Train Loss: 0.392 Vali Loss: 10.429 Vali Acc: 0.490 Test Loss: 10.429 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.570508480072021
Epoch: 26, Steps: 70 | Train Loss: 0.672 Vali Loss: 8.989 Vali Acc: 0.570 Test Loss: 8.989 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.419390439987183
Epoch: 27, Steps: 70 | Train Loss: 0.407 Vali Loss: 11.237 Vali Acc: 0.510 Test Loss: 11.237 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.091747045516968
Epoch: 28, Steps: 70 | Train Loss: 0.101 Vali Loss: 8.269 Vali Acc: 0.550 Test Loss: 8.269 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.490105628967285
Epoch: 29, Steps: 70 | Train Loss: 0.129 Vali Loss: 11.523 Vali Acc: 0.540 Test Loss: 11.523 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1189798
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.107714653015137
Epoch: 1, Steps: 70 | Train Loss: 4.906 Vali Loss: 8.219 Vali Acc: 0.500 Test Loss: 8.219 Test Acc: 0.500
Validation loss decreased (inf --> -0.499918).  Saving model ...
Epoch: 2 cost time: 8.401380777359009
Epoch: 2, Steps: 70 | Train Loss: 6.902 Vali Loss: 2.868 Vali Acc: 0.390 Test Loss: 2.868 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.76257061958313
Epoch: 3, Steps: 70 | Train Loss: 4.678 Vali Loss: 19.273 Vali Acc: 0.500 Test Loss: 19.273 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.062944412231445
Epoch: 4, Steps: 70 | Train Loss: 11.004 Vali Loss: 8.008 Vali Acc: 0.500 Test Loss: 8.008 Test Acc: 0.500
Validation loss decreased (-0.499918 --> -0.499920).  Saving model ...
Epoch: 5 cost time: 8.286045551300049
Epoch: 5, Steps: 70 | Train Loss: 6.493 Vali Loss: 16.040 Vali Acc: 0.500 Test Loss: 16.040 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.55578351020813
Epoch: 6, Steps: 70 | Train Loss: 4.957 Vali Loss: 8.637 Vali Acc: 0.500 Test Loss: 8.637 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.205776929855347
Epoch: 7, Steps: 70 | Train Loss: 5.535 Vali Loss: 4.634 Vali Acc: 0.450 Test Loss: 4.634 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.144892930984497
Epoch: 8, Steps: 70 | Train Loss: 3.706 Vali Loss: 2.614 Vali Acc: 0.480 Test Loss: 2.614 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.762624502182007
Epoch: 9, Steps: 70 | Train Loss: 2.553 Vali Loss: 8.569 Vali Acc: 0.500 Test Loss: 8.569 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.327510356903076
Epoch: 10, Steps: 70 | Train Loss: 2.946 Vali Loss: 4.013 Vali Acc: 0.490 Test Loss: 4.013 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.008090019226074
Epoch: 11, Steps: 70 | Train Loss: 3.325 Vali Loss: 19.101 Vali Acc: 0.500 Test Loss: 19.101 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.623069047927856
Epoch: 12, Steps: 70 | Train Loss: 5.046 Vali Loss: 3.399 Vali Acc: 0.550 Test Loss: 3.399 Test Acc: 0.550
Validation loss decreased (-0.499920 --> -0.549966).  Saving model ...
Epoch: 13 cost time: 8.583739757537842
Epoch: 13, Steps: 70 | Train Loss: 2.565 Vali Loss: 4.211 Vali Acc: 0.570 Test Loss: 4.211 Test Acc: 0.570
Validation loss decreased (-0.549966 --> -0.569958).  Saving model ...
Epoch: 14 cost time: 7.766877889633179
Epoch: 14, Steps: 70 | Train Loss: 1.554 Vali Loss: 8.466 Vali Acc: 0.510 Test Loss: 8.466 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.593606233596802
Epoch: 15, Steps: 70 | Train Loss: 2.115 Vali Loss: 15.886 Vali Acc: 0.460 Test Loss: 15.886 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.72862982749939
Epoch: 16, Steps: 70 | Train Loss: 1.314 Vali Loss: 33.822 Vali Acc: 0.500 Test Loss: 33.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.76408314704895
Epoch: 17, Steps: 70 | Train Loss: 1.542 Vali Loss: 8.803 Vali Acc: 0.490 Test Loss: 8.803 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.621569156646729
Epoch: 18, Steps: 70 | Train Loss: 1.172 Vali Loss: 17.340 Vali Acc: 0.500 Test Loss: 17.340 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.735486507415771
Epoch: 19, Steps: 70 | Train Loss: 1.678 Vali Loss: 9.971 Vali Acc: 0.490 Test Loss: 9.971 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.731769323348999
Epoch: 20, Steps: 70 | Train Loss: 0.243 Vali Loss: 6.487 Vali Acc: 0.490 Test Loss: 6.487 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.666374206542969
Epoch: 21, Steps: 70 | Train Loss: 0.296 Vali Loss: 16.888 Vali Acc: 0.480 Test Loss: 16.888 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.516093015670776
Epoch: 22, Steps: 70 | Train Loss: 0.857 Vali Loss: 23.525 Vali Acc: 0.520 Test Loss: 23.525 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.606820821762085
Epoch: 23, Steps: 70 | Train Loss: 0.366 Vali Loss: 17.738 Vali Acc: 0.480 Test Loss: 17.738 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1177798
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.976733207702637
Epoch: 1, Steps: 70 | Train Loss: 3.208 Vali Loss: 2.002 Vali Acc: 0.490 Test Loss: 2.002 Test Acc: 0.490
Validation loss decreased (inf --> -0.489980).  Saving model ...
Epoch: 2 cost time: 8.641365051269531
Epoch: 2, Steps: 70 | Train Loss: 5.538 Vali Loss: 1.819 Vali Acc: 0.430 Test Loss: 1.819 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.710747241973877
Epoch: 3, Steps: 70 | Train Loss: 4.661 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.489980 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 8.7326078414917
Epoch: 4, Steps: 70 | Train Loss: 5.491 Vali Loss: 10.221 Vali Acc: 0.500 Test Loss: 10.221 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.998783826828003
Epoch: 5, Steps: 70 | Train Loss: 3.880 Vali Loss: 3.799 Vali Acc: 0.500 Test Loss: 3.799 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.703807353973389
Epoch: 6, Steps: 70 | Train Loss: 3.794 Vali Loss: 1.418 Vali Acc: 0.570 Test Loss: 1.418 Test Acc: 0.570
Validation loss decreased (-0.499988 --> -0.569986).  Saving model ...
Epoch: 7 cost time: 8.515568971633911
Epoch: 7, Steps: 70 | Train Loss: 4.415 Vali Loss: 8.934 Vali Acc: 0.500 Test Loss: 8.934 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.702855348587036
Epoch: 8, Steps: 70 | Train Loss: 6.117 Vali Loss: 1.119 Vali Acc: 0.480 Test Loss: 1.119 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.817780256271362
Epoch: 9, Steps: 70 | Train Loss: 3.896 Vali Loss: 7.614 Vali Acc: 0.500 Test Loss: 7.614 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.809741258621216
Epoch: 10, Steps: 70 | Train Loss: 3.915 Vali Loss: 2.103 Vali Acc: 0.480 Test Loss: 2.103 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.740070819854736
Epoch: 11, Steps: 70 | Train Loss: 4.083 Vali Loss: 6.084 Vali Acc: 0.500 Test Loss: 6.084 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.731485366821289
Epoch: 12, Steps: 70 | Train Loss: 2.508 Vali Loss: 9.019 Vali Acc: 0.500 Test Loss: 9.019 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.697725296020508
Epoch: 13, Steps: 70 | Train Loss: 3.112 Vali Loss: 9.924 Vali Acc: 0.500 Test Loss: 9.924 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.80189299583435
Epoch: 14, Steps: 70 | Train Loss: 2.108 Vali Loss: 5.094 Vali Acc: 0.540 Test Loss: 5.094 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.86353349685669
Epoch: 15, Steps: 70 | Train Loss: 1.366 Vali Loss: 5.484 Vali Acc: 0.520 Test Loss: 5.484 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.978126287460327
Epoch: 16, Steps: 70 | Train Loss: 2.059 Vali Loss: 8.601 Vali Acc: 0.540 Test Loss: 8.601 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1165798
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.742462635040283
Epoch: 1, Steps: 70 | Train Loss: 54.659 Vali Loss: 51.583 Vali Acc: 0.510 Test Loss: 51.583 Test Acc: 0.510
Validation loss decreased (inf --> -0.509484).  Saving model ...
Epoch: 2 cost time: 17.43372416496277
Epoch: 2, Steps: 70 | Train Loss: 39.324 Vali Loss: 33.901 Vali Acc: 0.500 Test Loss: 33.901 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.64491558074951
Epoch: 3, Steps: 70 | Train Loss: 20.555 Vali Loss: 38.813 Vali Acc: 0.500 Test Loss: 38.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.96061658859253
Epoch: 4, Steps: 70 | Train Loss: 13.947 Vali Loss: 21.798 Vali Acc: 0.500 Test Loss: 21.798 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.01024055480957
Epoch: 5, Steps: 70 | Train Loss: 23.929 Vali Loss: 11.288 Vali Acc: 0.500 Test Loss: 11.288 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.901044130325317
Epoch: 6, Steps: 70 | Train Loss: 22.062 Vali Loss: 16.283 Vali Acc: 0.500 Test Loss: 16.283 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.79439067840576
Epoch: 7, Steps: 70 | Train Loss: 33.197 Vali Loss: 16.245 Vali Acc: 0.500 Test Loss: 16.245 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.076083421707153
Epoch: 8, Steps: 70 | Train Loss: 14.797 Vali Loss: 11.220 Vali Acc: 0.500 Test Loss: 11.220 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.082945108413696
Epoch: 9, Steps: 70 | Train Loss: 19.123 Vali Loss: 11.209 Vali Acc: 0.500 Test Loss: 11.209 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.189030647277832
Epoch: 10, Steps: 70 | Train Loss: 16.104 Vali Loss: 37.596 Vali Acc: 0.500 Test Loss: 37.596 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.979461431503296
Epoch: 11, Steps: 70 | Train Loss: 18.155 Vali Loss: 17.625 Vali Acc: 0.500 Test Loss: 17.625 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 17297434
model size : 70.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.428349494934082
Epoch: 1, Steps: 70 | Train Loss: 36.269 Vali Loss: 65.747 Vali Acc: 0.500 Test Loss: 65.747 Test Acc: 0.500
Validation loss decreased (inf --> -0.499343).  Saving model ...
Epoch: 2 cost time: 15.972590208053589
Epoch: 2, Steps: 70 | Train Loss: 95.551 Vali Loss: 4.285 Vali Acc: 0.490 Test Loss: 4.285 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.24183750152588
Epoch: 3, Steps: 70 | Train Loss: 30.765 Vali Loss: 15.250 Vali Acc: 0.500 Test Loss: 15.250 Test Acc: 0.500
Validation loss decreased (-0.499343 --> -0.499848).  Saving model ...
Epoch: 4 cost time: 17.836154460906982
Epoch: 4, Steps: 70 | Train Loss: 15.843 Vali Loss: 10.957 Vali Acc: 0.500 Test Loss: 10.957 Test Acc: 0.500
Validation loss decreased (-0.499848 --> -0.499890).  Saving model ...
Epoch: 5 cost time: 17.39218258857727
Epoch: 5, Steps: 70 | Train Loss: 11.898 Vali Loss: 37.595 Vali Acc: 0.500 Test Loss: 37.595 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.307669162750244
Epoch: 6, Steps: 70 | Train Loss: 14.033 Vali Loss: 1.490 Vali Acc: 0.570 Test Loss: 1.490 Test Acc: 0.570
Validation loss decreased (-0.499890 --> -0.569985).  Saving model ...
Epoch: 7 cost time: 17.924886465072632
Epoch: 7, Steps: 70 | Train Loss: 31.630 Vali Loss: 169.814 Vali Acc: 0.500 Test Loss: 169.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.850860834121704
Epoch: 8, Steps: 70 | Train Loss: 55.516 Vali Loss: 55.131 Vali Acc: 0.500 Test Loss: 55.131 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.817813158035278
Epoch: 9, Steps: 70 | Train Loss: 17.473 Vali Loss: 10.185 Vali Acc: 0.500 Test Loss: 10.185 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.04785990715027
Epoch: 10, Steps: 70 | Train Loss: 17.788 Vali Loss: 3.118 Vali Acc: 0.500 Test Loss: 3.118 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.006186485290527
Epoch: 11, Steps: 70 | Train Loss: 13.958 Vali Loss: 13.880 Vali Acc: 0.500 Test Loss: 13.880 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.11026382446289
Epoch: 12, Steps: 70 | Train Loss: 37.408 Vali Loss: 11.474 Vali Acc: 0.500 Test Loss: 11.474 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.493474006652832
Epoch: 13, Steps: 70 | Train Loss: 28.738 Vali Loss: 20.392 Vali Acc: 0.500 Test Loss: 20.392 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.947548866271973
Epoch: 14, Steps: 70 | Train Loss: 24.544 Vali Loss: 22.435 Vali Acc: 0.500 Test Loss: 22.435 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.85981559753418
Epoch: 15, Steps: 70 | Train Loss: 34.015 Vali Loss: 23.804 Vali Acc: 0.460 Test Loss: 23.804 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 15.817114114761353
Epoch: 16, Steps: 70 | Train Loss: 33.057 Vali Loss: 42.369 Vali Acc: 0.460 Test Loss: 42.369 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 17233434
model size : 70.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.549818992614746
Epoch: 1, Steps: 70 | Train Loss: 48.016 Vali Loss: 146.511 Vali Acc: 0.500 Test Loss: 146.511 Test Acc: 0.500
Validation loss decreased (inf --> -0.498535).  Saving model ...
Epoch: 2 cost time: 16.660624980926514
Epoch: 2, Steps: 70 | Train Loss: 86.918 Vali Loss: 10.125 Vali Acc: 0.490 Test Loss: 10.125 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.50426721572876
Epoch: 3, Steps: 70 | Train Loss: 32.811 Vali Loss: 11.881 Vali Acc: 0.510 Test Loss: 11.881 Test Acc: 0.510
Validation loss decreased (-0.498535 --> -0.509881).  Saving model ...
Epoch: 4 cost time: 17.80366611480713
Epoch: 4, Steps: 70 | Train Loss: 25.843 Vali Loss: 17.555 Vali Acc: 0.500 Test Loss: 17.555 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.905893802642822
Epoch: 5, Steps: 70 | Train Loss: 10.842 Vali Loss: 2.872 Vali Acc: 0.490 Test Loss: 2.872 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.889597415924072
Epoch: 6, Steps: 70 | Train Loss: 25.533 Vali Loss: 6.061 Vali Acc: 0.500 Test Loss: 6.061 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.01883864402771
Epoch: 7, Steps: 70 | Train Loss: 13.723 Vali Loss: 4.640 Vali Acc: 0.480 Test Loss: 4.640 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.964712142944336
Epoch: 8, Steps: 70 | Train Loss: 13.866 Vali Loss: 13.051 Vali Acc: 0.500 Test Loss: 13.051 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.69711709022522
Epoch: 9, Steps: 70 | Train Loss: 23.393 Vali Loss: 6.905 Vali Acc: 0.450 Test Loss: 6.905 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.200121641159058
Epoch: 10, Steps: 70 | Train Loss: 27.128 Vali Loss: 38.781 Vali Acc: 0.500 Test Loss: 38.781 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.02478528022766
Epoch: 11, Steps: 70 | Train Loss: 11.979 Vali Loss: 11.916 Vali Acc: 0.500 Test Loss: 11.916 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.700352668762207
Epoch: 12, Steps: 70 | Train Loss: 44.496 Vali Loss: 18.093 Vali Acc: 0.500 Test Loss: 18.093 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.97042465209961
Epoch: 13, Steps: 70 | Train Loss: 17.372 Vali Loss: 49.971 Vali Acc: 0.500 Test Loss: 49.971 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 17169434
model size : 70.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.55880856513977
Epoch: 1, Steps: 70 | Train Loss: 84.353 Vali Loss: 118.794 Vali Acc: 0.500 Test Loss: 118.794 Test Acc: 0.500
Validation loss decreased (inf --> -0.498812).  Saving model ...
Epoch: 2 cost time: 15.171236276626587
Epoch: 2, Steps: 70 | Train Loss: 77.793 Vali Loss: 150.581 Vali Acc: 0.500 Test Loss: 150.581 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.355329275131226
Epoch: 3, Steps: 70 | Train Loss: 53.201 Vali Loss: 47.424 Vali Acc: 0.500 Test Loss: 47.424 Test Acc: 0.500
Validation loss decreased (-0.498812 --> -0.499526).  Saving model ...
Epoch: 4 cost time: 17.255417346954346
Epoch: 4, Steps: 70 | Train Loss: 13.917 Vali Loss: 15.111 Vali Acc: 0.500 Test Loss: 15.111 Test Acc: 0.500
Validation loss decreased (-0.499526 --> -0.499849).  Saving model ...
Epoch: 5 cost time: 16.954591274261475
Epoch: 5, Steps: 70 | Train Loss: 20.466 Vali Loss: 3.333 Vali Acc: 0.500 Test Loss: 3.333 Test Acc: 0.500
Validation loss decreased (-0.499849 --> -0.499967).  Saving model ...
Epoch: 6 cost time: 16.09217357635498
Epoch: 6, Steps: 70 | Train Loss: 15.396 Vali Loss: 47.843 Vali Acc: 0.500 Test Loss: 47.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.56524109840393
Epoch: 7, Steps: 70 | Train Loss: 25.231 Vali Loss: 8.299 Vali Acc: 0.500 Test Loss: 8.299 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.596791982650757
Epoch: 8, Steps: 70 | Train Loss: 25.752 Vali Loss: 27.219 Vali Acc: 0.500 Test Loss: 27.219 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.522823333740234
Epoch: 9, Steps: 70 | Train Loss: 17.267 Vali Loss: 15.210 Vali Acc: 0.500 Test Loss: 15.210 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.545002937316895
Epoch: 10, Steps: 70 | Train Loss: 12.270 Vali Loss: 26.148 Vali Acc: 0.500 Test Loss: 26.148 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.6165931224823
Epoch: 11, Steps: 70 | Train Loss: 34.758 Vali Loss: 35.840 Vali Acc: 0.500 Test Loss: 35.840 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.90039348602295
Epoch: 12, Steps: 70 | Train Loss: 20.985 Vali Loss: 8.374 Vali Acc: 0.510 Test Loss: 8.374 Test Acc: 0.510
Validation loss decreased (-0.499967 --> -0.509916).  Saving model ...
Epoch: 13 cost time: 15.982292175292969
Epoch: 13, Steps: 70 | Train Loss: 17.868 Vali Loss: 6.673 Vali Acc: 0.560 Test Loss: 6.673 Test Acc: 0.560
Validation loss decreased (-0.509916 --> -0.559933).  Saving model ...
Epoch: 14 cost time: 17.390404224395752
Epoch: 14, Steps: 70 | Train Loss: 14.497 Vali Loss: 33.469 Vali Acc: 0.500 Test Loss: 33.469 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.777506351470947
Epoch: 15, Steps: 70 | Train Loss: 20.259 Vali Loss: 7.854 Vali Acc: 0.480 Test Loss: 7.854 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.548933744430542
Epoch: 16, Steps: 70 | Train Loss: 13.540 Vali Loss: 67.403 Vali Acc: 0.500 Test Loss: 67.403 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.66117811203003
Epoch: 17, Steps: 70 | Train Loss: 27.542 Vali Loss: 23.491 Vali Acc: 0.480 Test Loss: 23.491 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.498043298721313
Epoch: 18, Steps: 70 | Train Loss: 24.091 Vali Loss: 27.404 Vali Acc: 0.500 Test Loss: 27.404 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 16.744068145751953
Epoch: 19, Steps: 70 | Train Loss: 46.305 Vali Loss: 92.546 Vali Acc: 0.500 Test Loss: 92.546 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.48739266395569
Epoch: 20, Steps: 70 | Train Loss: 31.347 Vali Loss: 18.909 Vali Acc: 0.500 Test Loss: 18.909 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.895691871643066
Epoch: 21, Steps: 70 | Train Loss: 20.218 Vali Loss: 45.843 Vali Acc: 0.500 Test Loss: 45.843 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.581242322921753
Epoch: 22, Steps: 70 | Train Loss: 24.514 Vali Loss: 5.600 Vali Acc: 0.500 Test Loss: 5.600 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 15.594255208969116
Epoch: 23, Steps: 70 | Train Loss: 22.813 Vali Loss: 10.179 Vali Acc: 0.500 Test Loss: 10.179 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 17105434
model size : 70.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.638442993164062
Epoch: 1, Steps: 70 | Train Loss: 46.854 Vali Loss: 127.769 Vali Acc: 0.500 Test Loss: 127.769 Test Acc: 0.500
Validation loss decreased (inf --> -0.498722).  Saving model ...
Epoch: 2 cost time: 15.097151041030884
Epoch: 2, Steps: 70 | Train Loss: 69.478 Vali Loss: 214.887 Vali Acc: 0.500 Test Loss: 214.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.44062328338623
Epoch: 3, Steps: 70 | Train Loss: 47.461 Vali Loss: 62.106 Vali Acc: 0.500 Test Loss: 62.106 Test Acc: 0.500
Validation loss decreased (-0.498722 --> -0.499379).  Saving model ...
Epoch: 4 cost time: 16.522322416305542
Epoch: 4, Steps: 70 | Train Loss: 24.171 Vali Loss: 56.760 Vali Acc: 0.500 Test Loss: 56.760 Test Acc: 0.500
Validation loss decreased (-0.499379 --> -0.499432).  Saving model ...
Epoch: 5 cost time: 16.627045154571533
Epoch: 5, Steps: 70 | Train Loss: 28.607 Vali Loss: 8.645 Vali Acc: 0.500 Test Loss: 8.645 Test Acc: 0.500
Validation loss decreased (-0.499432 --> -0.499914).  Saving model ...
Epoch: 6 cost time: 14.471156120300293
Epoch: 6, Steps: 70 | Train Loss: 14.093 Vali Loss: 26.983 Vali Acc: 0.500 Test Loss: 26.983 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.615676403045654
Epoch: 7, Steps: 70 | Train Loss: 19.103 Vali Loss: 70.543 Vali Acc: 0.500 Test Loss: 70.543 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.716588497161865
Epoch: 8, Steps: 70 | Train Loss: 22.021 Vali Loss: 16.714 Vali Acc: 0.500 Test Loss: 16.714 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.631739616394043
Epoch: 9, Steps: 70 | Train Loss: 16.899 Vali Loss: 10.628 Vali Acc: 0.500 Test Loss: 10.628 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.478190660476685
Epoch: 10, Steps: 70 | Train Loss: 18.218 Vali Loss: 38.838 Vali Acc: 0.500 Test Loss: 38.838 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.79529047012329
Epoch: 11, Steps: 70 | Train Loss: 14.659 Vali Loss: 27.653 Vali Acc: 0.500 Test Loss: 27.653 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.70686435699463
Epoch: 12, Steps: 70 | Train Loss: 19.053 Vali Loss: 16.868 Vali Acc: 0.500 Test Loss: 16.868 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.523942470550537
Epoch: 13, Steps: 70 | Train Loss: 18.203 Vali Loss: 29.405 Vali Acc: 0.500 Test Loss: 29.405 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.142780065536499
Epoch: 14, Steps: 70 | Train Loss: 14.007 Vali Loss: 8.041 Vali Acc: 0.500 Test Loss: 8.041 Test Acc: 0.500
Validation loss decreased (-0.499914 --> -0.499920).  Saving model ...
Epoch: 15 cost time: 14.874691724777222
Epoch: 15, Steps: 70 | Train Loss: 20.778 Vali Loss: 64.067 Vali Acc: 0.500 Test Loss: 64.067 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.977487087249756
Epoch: 16, Steps: 70 | Train Loss: 25.429 Vali Loss: 30.617 Vali Acc: 0.500 Test Loss: 30.617 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.531651020050049
Epoch: 17, Steps: 70 | Train Loss: 13.113 Vali Loss: 16.872 Vali Acc: 0.500 Test Loss: 16.872 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.8939790725708
Epoch: 18, Steps: 70 | Train Loss: 14.375 Vali Loss: 3.207 Vali Acc: 0.500 Test Loss: 3.207 Test Acc: 0.500
Validation loss decreased (-0.499920 --> -0.499968).  Saving model ...
Epoch: 19 cost time: 15.868318796157837
Epoch: 19, Steps: 70 | Train Loss: 13.140 Vali Loss: 34.846 Vali Acc: 0.500 Test Loss: 34.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 16.09307026863098
Epoch: 20, Steps: 70 | Train Loss: 23.609 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
Validation loss decreased (-0.499968 --> -0.499992).  Saving model ...
Epoch: 21 cost time: 14.31504774093628
Epoch: 21, Steps: 70 | Train Loss: 11.625 Vali Loss: 4.937 Vali Acc: 0.500 Test Loss: 4.937 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 16.10850739479065
Epoch: 22, Steps: 70 | Train Loss: 16.228 Vali Loss: 21.591 Vali Acc: 0.500 Test Loss: 21.591 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 16.13413143157959
Epoch: 23, Steps: 70 | Train Loss: 12.177 Vali Loss: 2.487 Vali Acc: 0.500 Test Loss: 2.487 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.412253141403198
Epoch: 24, Steps: 70 | Train Loss: 13.131 Vali Loss: 1.950 Vali Acc: 0.500 Test Loss: 1.950 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 15.987321615219116
Epoch: 25, Steps: 70 | Train Loss: 9.647 Vali Loss: 7.047 Vali Acc: 0.500 Test Loss: 7.047 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 16.11928415298462
Epoch: 26, Steps: 70 | Train Loss: 13.297 Vali Loss: 7.308 Vali Acc: 0.500 Test Loss: 7.308 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.418092489242554
Epoch: 27, Steps: 70 | Train Loss: 10.462 Vali Loss: 5.422 Vali Acc: 0.500 Test Loss: 5.422 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 16.078227281570435
Epoch: 28, Steps: 70 | Train Loss: 6.027 Vali Loss: 2.951 Vali Acc: 0.500 Test Loss: 2.951 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 16.10022807121277
Epoch: 29, Steps: 70 | Train Loss: 6.233 Vali Loss: 6.275 Vali Acc: 0.500 Test Loss: 6.275 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.856393098831177
Epoch: 30, Steps: 70 | Train Loss: 5.305 Vali Loss: 5.606 Vali Acc: 0.500 Test Loss: 5.606 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 16509466
model size : 67.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.933934450149536
Epoch: 1, Steps: 70 | Train Loss: 61.700 Vali Loss: 80.353 Vali Acc: 0.500 Test Loss: 80.353 Test Acc: 0.500
Validation loss decreased (inf --> -0.499196).  Saving model ...
Epoch: 2 cost time: 14.453482151031494
Epoch: 2, Steps: 70 | Train Loss: 90.591 Vali Loss: 17.812 Vali Acc: 0.590 Test Loss: 17.812 Test Acc: 0.590
Validation loss decreased (-0.499196 --> -0.589822).  Saving model ...
Epoch: 3 cost time: 16.04204535484314
Epoch: 3, Steps: 70 | Train Loss: 74.778 Vali Loss: 48.067 Vali Acc: 0.500 Test Loss: 48.067 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.981181859970093
Epoch: 4, Steps: 70 | Train Loss: 28.175 Vali Loss: 94.545 Vali Acc: 0.500 Test Loss: 94.545 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.880608797073364
Epoch: 5, Steps: 70 | Train Loss: 21.090 Vali Loss: 36.963 Vali Acc: 0.500 Test Loss: 36.963 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.458999633789062
Epoch: 6, Steps: 70 | Train Loss: 19.141 Vali Loss: 18.245 Vali Acc: 0.500 Test Loss: 18.245 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.009421348571777
Epoch: 7, Steps: 70 | Train Loss: 19.128 Vali Loss: 26.618 Vali Acc: 0.500 Test Loss: 26.618 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.709397315979004
Epoch: 8, Steps: 70 | Train Loss: 27.123 Vali Loss: 22.141 Vali Acc: 0.500 Test Loss: 22.141 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.363455533981323
Epoch: 9, Steps: 70 | Train Loss: 24.805 Vali Loss: 22.770 Vali Acc: 0.500 Test Loss: 22.770 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.2703959941864
Epoch: 10, Steps: 70 | Train Loss: 12.000 Vali Loss: 34.226 Vali Acc: 0.500 Test Loss: 34.226 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.76565670967102
Epoch: 11, Steps: 70 | Train Loss: 20.679 Vali Loss: 66.959 Vali Acc: 0.500 Test Loss: 66.959 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.977009296417236
Epoch: 12, Steps: 70 | Train Loss: 18.245 Vali Loss: 8.039 Vali Acc: 0.520 Test Loss: 8.039 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 16445466
model size : 67.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.411296606063843
Epoch: 1, Steps: 70 | Train Loss: 36.406 Vali Loss: 30.671 Vali Acc: 0.500 Test Loss: 30.671 Test Acc: 0.500
Validation loss decreased (inf --> -0.499693).  Saving model ...
Epoch: 2 cost time: 14.845903873443604
Epoch: 2, Steps: 70 | Train Loss: 72.985 Vali Loss: 150.149 Vali Acc: 0.510 Test Loss: 150.149 Test Acc: 0.510
Validation loss decreased (-0.499693 --> -0.508499).  Saving model ...
Epoch: 3 cost time: 15.9677095413208
Epoch: 3, Steps: 70 | Train Loss: 76.674 Vali Loss: 17.677 Vali Acc: 0.500 Test Loss: 17.677 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.54776668548584
Epoch: 4, Steps: 70 | Train Loss: 16.041 Vali Loss: 11.681 Vali Acc: 0.500 Test Loss: 11.681 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.42592191696167
Epoch: 5, Steps: 70 | Train Loss: 15.192 Vali Loss: 8.119 Vali Acc: 0.500 Test Loss: 8.119 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.914005994796753
Epoch: 6, Steps: 70 | Train Loss: 25.500 Vali Loss: 52.203 Vali Acc: 0.500 Test Loss: 52.203 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.95910930633545
Epoch: 7, Steps: 70 | Train Loss: 18.523 Vali Loss: 29.113 Vali Acc: 0.500 Test Loss: 29.113 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.170629739761353
Epoch: 8, Steps: 70 | Train Loss: 18.215 Vali Loss: 3.698 Vali Acc: 0.500 Test Loss: 3.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.909636974334717
Epoch: 9, Steps: 70 | Train Loss: 18.310 Vali Loss: 30.679 Vali Acc: 0.500 Test Loss: 30.679 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.09447741508484
Epoch: 10, Steps: 70 | Train Loss: 19.057 Vali Loss: 4.921 Vali Acc: 0.500 Test Loss: 4.921 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.316093921661377
Epoch: 11, Steps: 70 | Train Loss: 25.611 Vali Loss: 50.050 Vali Acc: 0.500 Test Loss: 50.050 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.097325325012207
Epoch: 12, Steps: 70 | Train Loss: 35.443 Vali Loss: 19.849 Vali Acc: 0.500 Test Loss: 19.849 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 16381466
model size : 67.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.02315878868103
Epoch: 1, Steps: 70 | Train Loss: 69.663 Vali Loss: 47.249 Vali Acc: 0.500 Test Loss: 47.249 Test Acc: 0.500
Validation loss decreased (inf --> -0.499528).  Saving model ...
Epoch: 2 cost time: 15.595346927642822
Epoch: 2, Steps: 70 | Train Loss: 81.467 Vali Loss: 123.655 Vali Acc: 0.500 Test Loss: 123.655 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.773617506027222
Epoch: 3, Steps: 70 | Train Loss: 34.523 Vali Loss: 38.597 Vali Acc: 0.500 Test Loss: 38.597 Test Acc: 0.500
Validation loss decreased (-0.499528 --> -0.499614).  Saving model ...
Epoch: 4 cost time: 14.56770372390747
Epoch: 4, Steps: 70 | Train Loss: 22.714 Vali Loss: 27.812 Vali Acc: 0.500 Test Loss: 27.812 Test Acc: 0.500
Validation loss decreased (-0.499614 --> -0.499722).  Saving model ...
Epoch: 5 cost time: 15.499730348587036
Epoch: 5, Steps: 70 | Train Loss: 17.250 Vali Loss: 27.293 Vali Acc: 0.500 Test Loss: 27.293 Test Acc: 0.500
Validation loss decreased (-0.499722 --> -0.499727).  Saving model ...
Epoch: 6 cost time: 15.726526498794556
Epoch: 6, Steps: 70 | Train Loss: 21.934 Vali Loss: 2.335 Vali Acc: 0.440 Test Loss: 2.335 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.91612458229065
Epoch: 7, Steps: 70 | Train Loss: 33.189 Vali Loss: 16.627 Vali Acc: 0.500 Test Loss: 16.627 Test Acc: 0.500
Validation loss decreased (-0.499727 --> -0.499834).  Saving model ...
Epoch: 8 cost time: 15.37815237045288
Epoch: 8, Steps: 70 | Train Loss: 30.862 Vali Loss: 3.614 Vali Acc: 0.400 Test Loss: 3.614 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.664952754974365
Epoch: 9, Steps: 70 | Train Loss: 21.411 Vali Loss: 18.104 Vali Acc: 0.500 Test Loss: 18.104 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.312347173690796
Epoch: 10, Steps: 70 | Train Loss: 39.049 Vali Loss: 14.553 Vali Acc: 0.500 Test Loss: 14.553 Test Acc: 0.500
Validation loss decreased (-0.499834 --> -0.499854).  Saving model ...
Epoch: 11 cost time: 14.490072965621948
Epoch: 11, Steps: 70 | Train Loss: 18.645 Vali Loss: 12.496 Vali Acc: 0.500 Test Loss: 12.496 Test Acc: 0.500
Validation loss decreased (-0.499854 --> -0.499875).  Saving model ...
Epoch: 12 cost time: 15.65686559677124
Epoch: 12, Steps: 70 | Train Loss: 19.861 Vali Loss: 17.357 Vali Acc: 0.500 Test Loss: 17.357 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.651969194412231
Epoch: 13, Steps: 70 | Train Loss: 20.816 Vali Loss: 2.353 Vali Acc: 0.450 Test Loss: 2.353 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.92999792098999
Epoch: 14, Steps: 70 | Train Loss: 22.091 Vali Loss: 12.396 Vali Acc: 0.500 Test Loss: 12.396 Test Acc: 0.500
Validation loss decreased (-0.499875 --> -0.499876).  Saving model ...
Epoch: 15 cost time: 15.709051847457886
Epoch: 15, Steps: 70 | Train Loss: 55.141 Vali Loss: 31.925 Vali Acc: 0.500 Test Loss: 31.925 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.719653606414795
Epoch: 16, Steps: 70 | Train Loss: 29.865 Vali Loss: 15.045 Vali Acc: 0.500 Test Loss: 15.045 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.952132225036621
Epoch: 17, Steps: 70 | Train Loss: 24.540 Vali Loss: 42.120 Vali Acc: 0.500 Test Loss: 42.120 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.764822006225586
Epoch: 18, Steps: 70 | Train Loss: 22.284 Vali Loss: 11.458 Vali Acc: 0.490 Test Loss: 11.458 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.60436725616455
Epoch: 19, Steps: 70 | Train Loss: 15.595 Vali Loss: 17.338 Vali Acc: 0.500 Test Loss: 17.338 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.69766116142273
Epoch: 20, Steps: 70 | Train Loss: 23.054 Vali Loss: 45.868 Vali Acc: 0.500 Test Loss: 45.868 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.272530317306519
Epoch: 21, Steps: 70 | Train Loss: 27.924 Vali Loss: 64.518 Vali Acc: 0.500 Test Loss: 64.518 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.658495903015137
Epoch: 22, Steps: 70 | Train Loss: 29.603 Vali Loss: 11.910 Vali Acc: 0.500 Test Loss: 11.910 Test Acc: 0.500
Validation loss decreased (-0.499876 --> -0.499881).  Saving model ...
Epoch: 23 cost time: 15.01347541809082
Epoch: 23, Steps: 70 | Train Loss: 18.366 Vali Loss: 11.881 Vali Acc: 0.500 Test Loss: 11.881 Test Acc: 0.500
Validation loss decreased (-0.499881 --> -0.499881).  Saving model ...
Epoch: 24 cost time: 14.181657314300537
Epoch: 24, Steps: 70 | Train Loss: 16.168 Vali Loss: 18.329 Vali Acc: 0.500 Test Loss: 18.329 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 13.162687063217163
Epoch: 25, Steps: 70 | Train Loss: 27.908 Vali Loss: 50.371 Vali Acc: 0.500 Test Loss: 50.371 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 15.403204441070557
Epoch: 26, Steps: 70 | Train Loss: 20.311 Vali Loss: 15.631 Vali Acc: 0.500 Test Loss: 15.631 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 14.651930809020996
Epoch: 27, Steps: 70 | Train Loss: 11.514 Vali Loss: 3.677 Vali Acc: 0.500 Test Loss: 3.677 Test Acc: 0.500
Validation loss decreased (-0.499881 --> -0.499963).  Saving model ...
Epoch: 28 cost time: 15.099708795547485
Epoch: 28, Steps: 70 | Train Loss: 13.729 Vali Loss: 15.708 Vali Acc: 0.500 Test Loss: 15.708 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 15.343697547912598
Epoch: 29, Steps: 70 | Train Loss: 14.004 Vali Loss: 4.408 Vali Acc: 0.500 Test Loss: 4.408 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 14.10895037651062
Epoch: 30, Steps: 70 | Train Loss: 17.758 Vali Loss: 4.139 Vali Acc: 0.490 Test Loss: 4.139 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 15.237804889678955
Epoch: 31, Steps: 70 | Train Loss: 8.376 Vali Loss: 2.223 Vali Acc: 0.500 Test Loss: 2.223 Test Acc: 0.500
Validation loss decreased (-0.499963 --> -0.499978).  Saving model ...
Epoch: 32 cost time: 15.194758653640747
Epoch: 32, Steps: 70 | Train Loss: 7.467 Vali Loss: 8.954 Vali Acc: 0.500 Test Loss: 8.954 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 14.160977125167847
Epoch: 33, Steps: 70 | Train Loss: 14.848 Vali Loss: 17.853 Vali Acc: 0.500 Test Loss: 17.853 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 15.275171756744385
Epoch: 34, Steps: 70 | Train Loss: 7.520 Vali Loss: 4.445 Vali Acc: 0.500 Test Loss: 4.445 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 14.829188585281372
Epoch: 35, Steps: 70 | Train Loss: 11.717 Vali Loss: 11.834 Vali Acc: 0.500 Test Loss: 11.834 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 14.630120038986206
Epoch: 36, Steps: 70 | Train Loss: 7.249 Vali Loss: 3.910 Vali Acc: 0.500 Test Loss: 3.910 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 15.227996826171875
Epoch: 37, Steps: 70 | Train Loss: 7.154 Vali Loss: 24.430 Vali Acc: 0.500 Test Loss: 24.430 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 14.357645750045776
Epoch: 38, Steps: 70 | Train Loss: 8.618 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 15.375799417495728
Epoch: 39, Steps: 70 | Train Loss: 7.306 Vali Loss: 4.252 Vali Acc: 0.500 Test Loss: 4.252 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 15.306195735931396
Epoch: 40, Steps: 70 | Train Loss: 5.982 Vali Loss: 3.148 Vali Acc: 0.500 Test Loss: 3.148 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 14.077150821685791
Epoch: 41, Steps: 70 | Train Loss: 5.258 Vali Loss: 6.117 Vali Acc: 0.500 Test Loss: 6.117 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 16317466
model size : 67.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.329821348190308
Epoch: 1, Steps: 70 | Train Loss: 116.999 Vali Loss: 92.180 Vali Acc: 0.500 Test Loss: 92.180 Test Acc: 0.500
Validation loss decreased (inf --> -0.499078).  Saving model ...
Epoch: 2 cost time: 15.046849489212036
Epoch: 2, Steps: 70 | Train Loss: 142.698 Vali Loss: 12.017 Vali Acc: 0.490 Test Loss: 12.017 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.080605268478394
Epoch: 3, Steps: 70 | Train Loss: 61.716 Vali Loss: 75.977 Vali Acc: 0.500 Test Loss: 75.977 Test Acc: 0.500
Validation loss decreased (-0.499078 --> -0.499240).  Saving model ...
Epoch: 4 cost time: 13.973501443862915
Epoch: 4, Steps: 70 | Train Loss: 22.982 Vali Loss: 21.853 Vali Acc: 0.500 Test Loss: 21.853 Test Acc: 0.500
Validation loss decreased (-0.499240 --> -0.499781).  Saving model ...
Epoch: 5 cost time: 15.149775505065918
Epoch: 5, Steps: 70 | Train Loss: 24.017 Vali Loss: 23.022 Vali Acc: 0.500 Test Loss: 23.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.915647983551025
Epoch: 6, Steps: 70 | Train Loss: 14.792 Vali Loss: 22.568 Vali Acc: 0.500 Test Loss: 22.568 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.6477792263031
Epoch: 7, Steps: 70 | Train Loss: 16.643 Vali Loss: 14.098 Vali Acc: 0.490 Test Loss: 14.098 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.30570101737976
Epoch: 8, Steps: 70 | Train Loss: 28.456 Vali Loss: 17.342 Vali Acc: 0.500 Test Loss: 17.342 Test Acc: 0.500
Validation loss decreased (-0.499781 --> -0.499827).  Saving model ...
Epoch: 9 cost time: 13.994545221328735
Epoch: 9, Steps: 70 | Train Loss: 12.774 Vali Loss: 4.379 Vali Acc: 0.490 Test Loss: 4.379 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.322678804397583
Epoch: 10, Steps: 70 | Train Loss: 55.467 Vali Loss: 46.557 Vali Acc: 0.500 Test Loss: 46.557 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.419201850891113
Epoch: 11, Steps: 70 | Train Loss: 21.788 Vali Loss: 39.091 Vali Acc: 0.500 Test Loss: 39.091 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.293057441711426
Epoch: 12, Steps: 70 | Train Loss: 18.463 Vali Loss: 14.379 Vali Acc: 0.500 Test Loss: 14.379 Test Acc: 0.500
Validation loss decreased (-0.499827 --> -0.499856).  Saving model ...
Epoch: 13 cost time: 15.267434120178223
Epoch: 13, Steps: 70 | Train Loss: 19.212 Vali Loss: 12.137 Vali Acc: 0.500 Test Loss: 12.137 Test Acc: 0.500
Validation loss decreased (-0.499856 --> -0.499879).  Saving model ...
Epoch: 14 cost time: 14.23612093925476
Epoch: 14, Steps: 70 | Train Loss: 17.574 Vali Loss: 20.920 Vali Acc: 0.500 Test Loss: 20.920 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.235340118408203
Epoch: 15, Steps: 70 | Train Loss: 21.919 Vali Loss: 18.987 Vali Acc: 0.500 Test Loss: 18.987 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.294524431228638
Epoch: 16, Steps: 70 | Train Loss: 19.041 Vali Loss: 28.583 Vali Acc: 0.500 Test Loss: 28.583 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.311115503311157
Epoch: 17, Steps: 70 | Train Loss: 23.222 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
Validation loss decreased (-0.499879 --> -0.549991).  Saving model ...
Epoch: 18 cost time: 15.313644886016846
Epoch: 18, Steps: 70 | Train Loss: 21.939 Vali Loss: 7.003 Vali Acc: 0.500 Test Loss: 7.003 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 14.504407167434692
Epoch: 19, Steps: 70 | Train Loss: 16.764 Vali Loss: 19.148 Vali Acc: 0.500 Test Loss: 19.148 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 15.173726081848145
Epoch: 20, Steps: 70 | Train Loss: 21.245 Vali Loss: 32.960 Vali Acc: 0.500 Test Loss: 32.960 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 15.289450407028198
Epoch: 21, Steps: 70 | Train Loss: 15.509 Vali Loss: 7.160 Vali Acc: 0.500 Test Loss: 7.160 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 14.085792779922485
Epoch: 22, Steps: 70 | Train Loss: 22.300 Vali Loss: 20.014 Vali Acc: 0.500 Test Loss: 20.014 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 15.458488464355469
Epoch: 23, Steps: 70 | Train Loss: 18.278 Vali Loss: 3.843 Vali Acc: 0.500 Test Loss: 3.843 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 15.063850402832031
Epoch: 24, Steps: 70 | Train Loss: 12.540 Vali Loss: 25.606 Vali Acc: 0.500 Test Loss: 25.606 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 14.842336177825928
Epoch: 25, Steps: 70 | Train Loss: 14.306 Vali Loss: 10.775 Vali Acc: 0.500 Test Loss: 10.775 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 15.224103450775146
Epoch: 26, Steps: 70 | Train Loss: 14.060 Vali Loss: 3.234 Vali Acc: 0.490 Test Loss: 3.234 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 14.08041524887085
Epoch: 27, Steps: 70 | Train Loss: 10.385 Vali Loss: 4.067 Vali Acc: 0.430 Test Loss: 4.067 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 16115482
model size : 66.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.300961256027222
Epoch: 1, Steps: 70 | Train Loss: 48.028 Vali Loss: 46.779 Vali Acc: 0.480 Test Loss: 46.779 Test Acc: 0.480
Validation loss decreased (inf --> -0.479532).  Saving model ...
Epoch: 2 cost time: 14.46532917022705
Epoch: 2, Steps: 70 | Train Loss: 68.575 Vali Loss: 55.104 Vali Acc: 0.500 Test Loss: 55.104 Test Acc: 0.500
Validation loss decreased (-0.479532 --> -0.499449).  Saving model ...
Epoch: 3 cost time: 15.082078695297241
Epoch: 3, Steps: 70 | Train Loss: 128.144 Vali Loss: 47.452 Vali Acc: 0.490 Test Loss: 47.452 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.897318840026855
Epoch: 4, Steps: 70 | Train Loss: 46.241 Vali Loss: 46.561 Vali Acc: 0.500 Test Loss: 46.561 Test Acc: 0.500
Validation loss decreased (-0.499449 --> -0.499534).  Saving model ...
Epoch: 5 cost time: 15.063445329666138
Epoch: 5, Steps: 70 | Train Loss: 26.922 Vali Loss: 38.755 Vali Acc: 0.500 Test Loss: 38.755 Test Acc: 0.500
Validation loss decreased (-0.499534 --> -0.499612).  Saving model ...
Epoch: 6 cost time: 15.019209384918213
Epoch: 6, Steps: 70 | Train Loss: 36.529 Vali Loss: 53.768 Vali Acc: 0.500 Test Loss: 53.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.804595708847046
Epoch: 7, Steps: 70 | Train Loss: 24.610 Vali Loss: 2.917 Vali Acc: 0.530 Test Loss: 2.917 Test Acc: 0.530
Validation loss decreased (-0.499612 --> -0.529971).  Saving model ...
Epoch: 8 cost time: 14.944374561309814
Epoch: 8, Steps: 70 | Train Loss: 13.936 Vali Loss: 5.077 Vali Acc: 0.510 Test Loss: 5.077 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.148751258850098
Epoch: 9, Steps: 70 | Train Loss: 17.165 Vali Loss: 5.634 Vali Acc: 0.630 Test Loss: 5.634 Test Acc: 0.630
Validation loss decreased (-0.529971 --> -0.629944).  Saving model ...
Epoch: 10 cost time: 13.582972526550293
Epoch: 10, Steps: 70 | Train Loss: 33.782 Vali Loss: 27.061 Vali Acc: 0.490 Test Loss: 27.061 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.075139999389648
Epoch: 11, Steps: 70 | Train Loss: 18.658 Vali Loss: 16.386 Vali Acc: 0.510 Test Loss: 16.386 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.305096864700317
Epoch: 12, Steps: 70 | Train Loss: 24.082 Vali Loss: 96.258 Vali Acc: 0.500 Test Loss: 96.258 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.796345233917236
Epoch: 13, Steps: 70 | Train Loss: 14.463 Vali Loss: 8.998 Vali Acc: 0.550 Test Loss: 8.998 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.248918294906616
Epoch: 14, Steps: 70 | Train Loss: 12.406 Vali Loss: 42.995 Vali Acc: 0.500 Test Loss: 42.995 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.081112146377563
Epoch: 15, Steps: 70 | Train Loss: 13.419 Vali Loss: 12.940 Vali Acc: 0.500 Test Loss: 12.940 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.287142038345337
Epoch: 16, Steps: 70 | Train Loss: 16.648 Vali Loss: 27.830 Vali Acc: 0.470 Test Loss: 27.830 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.435863494873047
Epoch: 17, Steps: 70 | Train Loss: 19.293 Vali Loss: 9.240 Vali Acc: 0.500 Test Loss: 9.240 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.383874654769897
Epoch: 18, Steps: 70 | Train Loss: 16.131 Vali Loss: 25.954 Vali Acc: 0.500 Test Loss: 25.954 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 14.481659173965454
Epoch: 19, Steps: 70 | Train Loss: 17.810 Vali Loss: 110.772 Vali Acc: 0.520 Test Loss: 110.772 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 16051482
model size : 66.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.482200145721436
Epoch: 1, Steps: 70 | Train Loss: 30.707 Vali Loss: 68.516 Vali Acc: 0.500 Test Loss: 68.516 Test Acc: 0.500
Validation loss decreased (inf --> -0.499315).  Saving model ...
Epoch: 2 cost time: 14.245920896530151
Epoch: 2, Steps: 70 | Train Loss: 109.381 Vali Loss: 163.934 Vali Acc: 0.490 Test Loss: 163.934 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.45811676979065
Epoch: 3, Steps: 70 | Train Loss: 111.630 Vali Loss: 82.225 Vali Acc: 0.500 Test Loss: 82.225 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.363343715667725
Epoch: 4, Steps: 70 | Train Loss: 32.664 Vali Loss: 14.096 Vali Acc: 0.500 Test Loss: 14.096 Test Acc: 0.500
Validation loss decreased (-0.499315 --> -0.499859).  Saving model ...
Epoch: 5 cost time: 13.716678142547607
Epoch: 5, Steps: 70 | Train Loss: 21.179 Vali Loss: 7.003 Vali Acc: 0.480 Test Loss: 7.003 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.298732995986938
Epoch: 6, Steps: 70 | Train Loss: 52.116 Vali Loss: 13.112 Vali Acc: 0.500 Test Loss: 13.112 Test Acc: 0.500
Validation loss decreased (-0.499859 --> -0.499869).  Saving model ...
Epoch: 7 cost time: 13.988361835479736
Epoch: 7, Steps: 70 | Train Loss: 18.362 Vali Loss: 73.984 Vali Acc: 0.500 Test Loss: 73.984 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.558701038360596
Epoch: 8, Steps: 70 | Train Loss: 43.535 Vali Loss: 75.199 Vali Acc: 0.500 Test Loss: 75.199 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.06115436553955
Epoch: 9, Steps: 70 | Train Loss: 32.665 Vali Loss: 18.788 Vali Acc: 0.500 Test Loss: 18.788 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.57624363899231
Epoch: 10, Steps: 70 | Train Loss: 28.418 Vali Loss: 44.860 Vali Acc: 0.500 Test Loss: 44.860 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.113446712493896
Epoch: 11, Steps: 70 | Train Loss: 18.506 Vali Loss: 27.025 Vali Acc: 0.500 Test Loss: 27.025 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.579725980758667
Epoch: 12, Steps: 70 | Train Loss: 22.984 Vali Loss: 16.571 Vali Acc: 0.500 Test Loss: 16.571 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.193565368652344
Epoch: 13, Steps: 70 | Train Loss: 19.786 Vali Loss: 41.258 Vali Acc: 0.500 Test Loss: 41.258 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.395474195480347
Epoch: 14, Steps: 70 | Train Loss: 38.921 Vali Loss: 19.825 Vali Acc: 0.500 Test Loss: 19.825 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.26652455329895
Epoch: 15, Steps: 70 | Train Loss: 25.084 Vali Loss: 23.612 Vali Acc: 0.500 Test Loss: 23.612 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.25374174118042
Epoch: 16, Steps: 70 | Train Loss: 16.670 Vali Loss: 7.102 Vali Acc: 0.500 Test Loss: 7.102 Test Acc: 0.500
Validation loss decreased (-0.499869 --> -0.499929).  Saving model ...
Epoch: 17 cost time: 14.25503420829773
Epoch: 17, Steps: 70 | Train Loss: 24.764 Vali Loss: 29.473 Vali Acc: 0.500 Test Loss: 29.473 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.029450416564941
Epoch: 18, Steps: 70 | Train Loss: 40.797 Vali Loss: 12.158 Vali Acc: 0.500 Test Loss: 12.158 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.63267469406128
Epoch: 19, Steps: 70 | Train Loss: 11.296 Vali Loss: 22.193 Vali Acc: 0.500 Test Loss: 22.193 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.887671947479248
Epoch: 20, Steps: 70 | Train Loss: 14.240 Vali Loss: 8.530 Vali Acc: 0.500 Test Loss: 8.530 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 14.545148372650146
Epoch: 21, Steps: 70 | Train Loss: 20.158 Vali Loss: 74.838 Vali Acc: 0.500 Test Loss: 74.838 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.637168169021606
Epoch: 22, Steps: 70 | Train Loss: 14.345 Vali Loss: 33.052 Vali Acc: 0.500 Test Loss: 33.052 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 14.429049730300903
Epoch: 23, Steps: 70 | Train Loss: 24.600 Vali Loss: 46.485 Vali Acc: 0.500 Test Loss: 46.485 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 13.514694213867188
Epoch: 24, Steps: 70 | Train Loss: 15.515 Vali Loss: 36.669 Vali Acc: 0.500 Test Loss: 36.669 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 14.47394871711731
Epoch: 25, Steps: 70 | Train Loss: 12.342 Vali Loss: 3.535 Vali Acc: 0.430 Test Loss: 3.535 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.881381750106812
Epoch: 26, Steps: 70 | Train Loss: 18.916 Vali Loss: 44.917 Vali Acc: 0.500 Test Loss: 44.917 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 15987482
model size : 65.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.215147495269775
Epoch: 1, Steps: 70 | Train Loss: 60.449 Vali Loss: 106.459 Vali Acc: 0.520 Test Loss: 106.459 Test Acc: 0.520
Validation loss decreased (inf --> -0.518935).  Saving model ...
Epoch: 2 cost time: 21.571057319641113
Epoch: 2, Steps: 70 | Train Loss: 66.965 Vali Loss: 15.787 Vali Acc: 0.490 Test Loss: 15.787 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.299452781677246
Epoch: 3, Steps: 70 | Train Loss: 21.736 Vali Loss: 2.701 Vali Acc: 0.500 Test Loss: 2.701 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.57178020477295
Epoch: 4, Steps: 70 | Train Loss: 15.543 Vali Loss: 22.533 Vali Acc: 0.500 Test Loss: 22.533 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 21.647183656692505
Epoch: 5, Steps: 70 | Train Loss: 29.130 Vali Loss: 3.740 Vali Acc: 0.490 Test Loss: 3.740 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.519450187683105
Epoch: 6, Steps: 70 | Train Loss: 23.109 Vali Loss: 14.467 Vali Acc: 0.500 Test Loss: 14.467 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.197148323059082
Epoch: 7, Steps: 70 | Train Loss: 25.673 Vali Loss: 5.429 Vali Acc: 0.510 Test Loss: 5.429 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 19.679617881774902
Epoch: 8, Steps: 70 | Train Loss: 11.682 Vali Loss: 60.788 Vali Acc: 0.500 Test Loss: 60.788 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 21.52256727218628
Epoch: 9, Steps: 70 | Train Loss: 33.366 Vali Loss: 87.313 Vali Acc: 0.500 Test Loss: 87.313 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 21.469870567321777
Epoch: 10, Steps: 70 | Train Loss: 29.543 Vali Loss: 14.662 Vali Acc: 0.500 Test Loss: 14.662 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.964912176132202
Epoch: 11, Steps: 70 | Train Loss: 19.270 Vali Loss: 3.717 Vali Acc: 0.510 Test Loss: 3.717 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 15923482
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.8516628742218
Epoch: 1, Steps: 70 | Train Loss: 43.482 Vali Loss: 116.490 Vali Acc: 0.490 Test Loss: 116.490 Test Acc: 0.490
Validation loss decreased (inf --> -0.488835).  Saving model ...
Epoch: 2 cost time: 20.31454086303711
Epoch: 2, Steps: 70 | Train Loss: 56.314 Vali Loss: 146.347 Vali Acc: 0.490 Test Loss: 146.347 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.199332237243652
Epoch: 3, Steps: 70 | Train Loss: 61.719 Vali Loss: 25.630 Vali Acc: 0.550 Test Loss: 25.630 Test Acc: 0.550
Validation loss decreased (-0.488835 --> -0.549744).  Saving model ...
Epoch: 4 cost time: 21.759066343307495
Epoch: 4, Steps: 70 | Train Loss: 63.546 Vali Loss: 75.343 Vali Acc: 0.500 Test Loss: 75.343 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.83484411239624
Epoch: 5, Steps: 70 | Train Loss: 71.750 Vali Loss: 54.360 Vali Acc: 0.500 Test Loss: 54.360 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.159141302108765
Epoch: 6, Steps: 70 | Train Loss: 33.577 Vali Loss: 55.608 Vali Acc: 0.500 Test Loss: 55.608 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.065685272216797
Epoch: 7, Steps: 70 | Train Loss: 15.837 Vali Loss: 35.456 Vali Acc: 0.500 Test Loss: 35.456 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.894811868667603
Epoch: 8, Steps: 70 | Train Loss: 18.759 Vali Loss: 31.201 Vali Acc: 0.500 Test Loss: 31.201 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.950777053833008
Epoch: 9, Steps: 70 | Train Loss: 18.397 Vali Loss: 29.385 Vali Acc: 0.500 Test Loss: 29.385 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.148859977722168
Epoch: 10, Steps: 70 | Train Loss: 20.624 Vali Loss: 68.268 Vali Acc: 0.500 Test Loss: 68.268 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.888080835342407
Epoch: 11, Steps: 70 | Train Loss: 20.939 Vali Loss: 59.016 Vali Acc: 0.500 Test Loss: 59.016 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.82489037513733
Epoch: 12, Steps: 70 | Train Loss: 21.853 Vali Loss: 37.166 Vali Acc: 0.500 Test Loss: 37.166 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.137779474258423
Epoch: 13, Steps: 70 | Train Loss: 38.657 Vali Loss: 25.412 Vali Acc: 0.500 Test Loss: 25.412 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 15918490
model size : 65.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.767442226409912
Epoch: 1, Steps: 70 | Train Loss: 66.222 Vali Loss: 133.788 Vali Acc: 0.500 Test Loss: 133.788 Test Acc: 0.500
Validation loss decreased (inf --> -0.498662).  Saving model ...
Epoch: 2 cost time: 21.365162134170532
Epoch: 2, Steps: 70 | Train Loss: 114.476 Vali Loss: 47.484 Vali Acc: 0.500 Test Loss: 47.484 Test Acc: 0.500
Validation loss decreased (-0.498662 --> -0.499525).  Saving model ...
Epoch: 3 cost time: 18.099127292633057
Epoch: 3, Steps: 70 | Train Loss: 25.864 Vali Loss: 9.571 Vali Acc: 0.520 Test Loss: 9.571 Test Acc: 0.520
Validation loss decreased (-0.499525 --> -0.519904).  Saving model ...
Epoch: 4 cost time: 21.911917209625244
Epoch: 4, Steps: 70 | Train Loss: 37.331 Vali Loss: 34.644 Vali Acc: 0.500 Test Loss: 34.644 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.743363618850708
Epoch: 5, Steps: 70 | Train Loss: 23.999 Vali Loss: 7.374 Vali Acc: 0.500 Test Loss: 7.374 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.505489826202393
Epoch: 6, Steps: 70 | Train Loss: 16.426 Vali Loss: 13.227 Vali Acc: 0.500 Test Loss: 13.227 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.169660329818726
Epoch: 7, Steps: 70 | Train Loss: 23.955 Vali Loss: 6.479 Vali Acc: 0.510 Test Loss: 6.479 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.847859144210815
Epoch: 8, Steps: 70 | Train Loss: 23.493 Vali Loss: 6.424 Vali Acc: 0.500 Test Loss: 6.424 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.71499752998352
Epoch: 9, Steps: 70 | Train Loss: 22.713 Vali Loss: 13.456 Vali Acc: 0.500 Test Loss: 13.456 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.269380569458008
Epoch: 10, Steps: 70 | Train Loss: 18.395 Vali Loss: 7.307 Vali Acc: 0.500 Test Loss: 7.307 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.72368288040161
Epoch: 11, Steps: 70 | Train Loss: 17.410 Vali Loss: 30.854 Vali Acc: 0.500 Test Loss: 30.854 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.680026531219482
Epoch: 12, Steps: 70 | Train Loss: 25.742 Vali Loss: 29.795 Vali Acc: 0.500 Test Loss: 29.795 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.53014588356018
Epoch: 13, Steps: 70 | Train Loss: 23.932 Vali Loss: 23.280 Vali Acc: 0.500 Test Loss: 23.280 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 15854490
model size : 65.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.58469843864441
Epoch: 1, Steps: 70 | Train Loss: 46.630 Vali Loss: 189.311 Vali Acc: 0.500 Test Loss: 189.311 Test Acc: 0.500
Validation loss decreased (inf --> -0.498107).  Saving model ...
Epoch: 2 cost time: 17.657440423965454
Epoch: 2, Steps: 70 | Train Loss: 87.805 Vali Loss: 15.020 Vali Acc: 0.430 Test Loss: 15.020 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.644386768341064
Epoch: 3, Steps: 70 | Train Loss: 39.324 Vali Loss: 7.089 Vali Acc: 0.500 Test Loss: 7.089 Test Acc: 0.500
Validation loss decreased (-0.498107 --> -0.499929).  Saving model ...
Epoch: 4 cost time: 21.9128201007843
Epoch: 4, Steps: 70 | Train Loss: 19.622 Vali Loss: 18.631 Vali Acc: 0.500 Test Loss: 18.631 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.216422080993652
Epoch: 5, Steps: 70 | Train Loss: 11.839 Vali Loss: 44.631 Vali Acc: 0.500 Test Loss: 44.631 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.8322856426239
Epoch: 6, Steps: 70 | Train Loss: 20.603 Vali Loss: 32.775 Vali Acc: 0.500 Test Loss: 32.775 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.311320066452026
Epoch: 7, Steps: 70 | Train Loss: 26.381 Vali Loss: 13.290 Vali Acc: 0.500 Test Loss: 13.290 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.18834924697876
Epoch: 8, Steps: 70 | Train Loss: 19.349 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (-0.499929 --> -0.499986).  Saving model ...
Epoch: 9 cost time: 21.30804419517517
Epoch: 9, Steps: 70 | Train Loss: 13.858 Vali Loss: 19.332 Vali Acc: 0.500 Test Loss: 19.332 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.953287601470947
Epoch: 10, Steps: 70 | Train Loss: 28.864 Vali Loss: 4.025 Vali Acc: 0.500 Test Loss: 4.025 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.289083003997803
Epoch: 11, Steps: 70 | Train Loss: 21.335 Vali Loss: 28.483 Vali Acc: 0.500 Test Loss: 28.483 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.34182071685791
Epoch: 12, Steps: 70 | Train Loss: 24.773 Vali Loss: 26.891 Vali Acc: 0.500 Test Loss: 26.891 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.721031665802002
Epoch: 13, Steps: 70 | Train Loss: 22.133 Vali Loss: 12.644 Vali Acc: 0.500 Test Loss: 12.644 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.342644929885864
Epoch: 14, Steps: 70 | Train Loss: 15.839 Vali Loss: 25.794 Vali Acc: 0.480 Test Loss: 25.794 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.361655950546265
Epoch: 15, Steps: 70 | Train Loss: 31.300 Vali Loss: 45.337 Vali Acc: 0.510 Test Loss: 45.337 Test Acc: 0.510
Validation loss decreased (-0.499986 --> -0.509547).  Saving model ...
Epoch: 16 cost time: 17.84958791732788
Epoch: 16, Steps: 70 | Train Loss: 19.551 Vali Loss: 7.339 Vali Acc: 0.500 Test Loss: 7.339 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.227537631988525
Epoch: 17, Steps: 70 | Train Loss: 20.835 Vali Loss: 41.634 Vali Acc: 0.500 Test Loss: 41.634 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.427794933319092
Epoch: 18, Steps: 70 | Train Loss: 28.112 Vali Loss: 4.700 Vali Acc: 0.500 Test Loss: 4.700 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.956530809402466
Epoch: 19, Steps: 70 | Train Loss: 18.456 Vali Loss: 1.872 Vali Acc: 0.490 Test Loss: 1.872 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.343144416809082
Epoch: 20, Steps: 70 | Train Loss: 27.124 Vali Loss: 3.876 Vali Acc: 0.500 Test Loss: 3.876 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.471096992492676
Epoch: 21, Steps: 70 | Train Loss: 16.725 Vali Loss: 16.126 Vali Acc: 0.500 Test Loss: 16.126 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 17.956432342529297
Epoch: 22, Steps: 70 | Train Loss: 14.622 Vali Loss: 18.322 Vali Acc: 0.500 Test Loss: 18.322 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.45166540145874
Epoch: 23, Steps: 70 | Train Loss: 13.852 Vali Loss: 3.686 Vali Acc: 0.500 Test Loss: 3.686 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 21.451436042785645
Epoch: 24, Steps: 70 | Train Loss: 15.218 Vali Loss: 9.781 Vali Acc: 0.500 Test Loss: 9.781 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 18.220860242843628
Epoch: 25, Steps: 70 | Train Loss: 14.084 Vali Loss: 8.663 Vali Acc: 0.500 Test Loss: 8.663 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 15790490
model size : 65.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.267048835754395
Epoch: 1, Steps: 70 | Train Loss: 61.601 Vali Loss: 83.313 Vali Acc: 0.500 Test Loss: 83.313 Test Acc: 0.500
Validation loss decreased (inf --> -0.499167).  Saving model ...
Epoch: 2 cost time: 19.363438844680786
Epoch: 2, Steps: 70 | Train Loss: 113.538 Vali Loss: 251.451 Vali Acc: 0.510 Test Loss: 251.451 Test Acc: 0.510
Validation loss decreased (-0.499167 --> -0.507485).  Saving model ...
Epoch: 3 cost time: 20.736021518707275
Epoch: 3, Steps: 70 | Train Loss: 48.429 Vali Loss: 25.826 Vali Acc: 0.500 Test Loss: 25.826 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.39270043373108
Epoch: 4, Steps: 70 | Train Loss: 20.901 Vali Loss: 55.602 Vali Acc: 0.500 Test Loss: 55.602 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.850001096725464
Epoch: 5, Steps: 70 | Train Loss: 32.587 Vali Loss: 23.418 Vali Acc: 0.500 Test Loss: 23.418 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.771074056625366
Epoch: 6, Steps: 70 | Train Loss: 17.748 Vali Loss: 5.873 Vali Acc: 0.500 Test Loss: 5.873 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.14644169807434
Epoch: 7, Steps: 70 | Train Loss: 39.279 Vali Loss: 22.212 Vali Acc: 0.500 Test Loss: 22.212 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.338334560394287
Epoch: 8, Steps: 70 | Train Loss: 24.651 Vali Loss: 25.382 Vali Acc: 0.500 Test Loss: 25.382 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.8300142288208
Epoch: 9, Steps: 70 | Train Loss: 21.528 Vali Loss: 45.003 Vali Acc: 0.500 Test Loss: 45.003 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.638803243637085
Epoch: 10, Steps: 70 | Train Loss: 39.784 Vali Loss: 16.672 Vali Acc: 0.500 Test Loss: 16.672 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.622532606124878
Epoch: 11, Steps: 70 | Train Loss: 24.860 Vali Loss: 25.506 Vali Acc: 0.500 Test Loss: 25.506 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 20.831010818481445
Epoch: 12, Steps: 70 | Train Loss: 27.094 Vali Loss: 54.269 Vali Acc: 0.500 Test Loss: 54.269 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 15726490
model size : 64.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.996097087860107
Epoch: 1, Steps: 70 | Train Loss: 45.252 Vali Loss: 61.555 Vali Acc: 0.500 Test Loss: 61.555 Test Acc: 0.500
Validation loss decreased (inf --> -0.499384).  Saving model ...
Epoch: 2 cost time: 17.220027685165405
Epoch: 2, Steps: 70 | Train Loss: 41.870 Vali Loss: 13.034 Vali Acc: 0.510 Test Loss: 13.034 Test Acc: 0.510
Validation loss decreased (-0.499384 --> -0.509870).  Saving model ...
Epoch: 3 cost time: 17.394381046295166
Epoch: 3, Steps: 70 | Train Loss: 36.234 Vali Loss: 29.775 Vali Acc: 0.500 Test Loss: 29.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.157685279846191
Epoch: 4, Steps: 70 | Train Loss: 22.205 Vali Loss: 3.571 Vali Acc: 0.500 Test Loss: 3.571 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.35157012939453
Epoch: 5, Steps: 70 | Train Loss: 8.501 Vali Loss: 18.139 Vali Acc: 0.500 Test Loss: 18.139 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.384894847869873
Epoch: 6, Steps: 70 | Train Loss: 12.763 Vali Loss: 6.998 Vali Acc: 0.500 Test Loss: 6.998 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.708099842071533
Epoch: 7, Steps: 70 | Train Loss: 20.153 Vali Loss: 6.165 Vali Acc: 0.500 Test Loss: 6.165 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.542644500732422
Epoch: 8, Steps: 70 | Train Loss: 10.002 Vali Loss: 28.036 Vali Acc: 0.500 Test Loss: 28.036 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.296239137649536
Epoch: 9, Steps: 70 | Train Loss: 12.089 Vali Loss: 4.891 Vali Acc: 0.500 Test Loss: 4.891 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.323693990707397
Epoch: 10, Steps: 70 | Train Loss: 10.407 Vali Loss: 22.884 Vali Acc: 0.500 Test Loss: 22.884 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.67140507698059
Epoch: 11, Steps: 70 | Train Loss: 30.488 Vali Loss: 17.822 Vali Acc: 0.500 Test Loss: 17.822 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.37921142578125
Epoch: 12, Steps: 70 | Train Loss: 8.535 Vali Loss: 23.448 Vali Acc: 0.500 Test Loss: 23.448 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 7863834
model size : 32.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.240999937057495
Epoch: 1, Steps: 70 | Train Loss: 32.541 Vali Loss: 40.566 Vali Acc: 0.510 Test Loss: 40.566 Test Acc: 0.510
Validation loss decreased (inf --> -0.509594).  Saving model ...
Epoch: 2 cost time: 14.901044845581055
Epoch: 2, Steps: 70 | Train Loss: 46.613 Vali Loss: 89.741 Vali Acc: 0.500 Test Loss: 89.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.319422006607056
Epoch: 3, Steps: 70 | Train Loss: 64.728 Vali Loss: 5.436 Vali Acc: 0.500 Test Loss: 5.436 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.53548240661621
Epoch: 4, Steps: 70 | Train Loss: 14.378 Vali Loss: 72.469 Vali Acc: 0.500 Test Loss: 72.469 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.853331089019775
Epoch: 5, Steps: 70 | Train Loss: 35.686 Vali Loss: 7.269 Vali Acc: 0.500 Test Loss: 7.269 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.111571788787842
Epoch: 6, Steps: 70 | Train Loss: 9.732 Vali Loss: 5.463 Vali Acc: 0.500 Test Loss: 5.463 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.420682907104492
Epoch: 7, Steps: 70 | Train Loss: 8.175 Vali Loss: 18.741 Vali Acc: 0.500 Test Loss: 18.741 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.47437047958374
Epoch: 8, Steps: 70 | Train Loss: 7.985 Vali Loss: 11.161 Vali Acc: 0.470 Test Loss: 11.161 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.426384449005127
Epoch: 9, Steps: 70 | Train Loss: 10.474 Vali Loss: 36.204 Vali Acc: 0.500 Test Loss: 36.204 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.39042377471924
Epoch: 10, Steps: 70 | Train Loss: 13.735 Vali Loss: 16.282 Vali Acc: 0.540 Test Loss: 16.282 Test Acc: 0.540
Validation loss decreased (-0.509594 --> -0.539837).  Saving model ...
Epoch: 11 cost time: 17.410322904586792
Epoch: 11, Steps: 70 | Train Loss: 14.900 Vali Loss: 16.537 Vali Acc: 0.520 Test Loss: 16.537 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.209007024765015
Epoch: 12, Steps: 70 | Train Loss: 6.257 Vali Loss: 48.741 Vali Acc: 0.520 Test Loss: 48.741 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.646378755569458
Epoch: 13, Steps: 70 | Train Loss: 14.878 Vali Loss: 102.067 Vali Acc: 0.500 Test Loss: 102.067 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 17.403624534606934
Epoch: 14, Steps: 70 | Train Loss: 21.059 Vali Loss: 34.056 Vali Acc: 0.490 Test Loss: 34.056 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 17.447981119155884
Epoch: 15, Steps: 70 | Train Loss: 21.028 Vali Loss: 9.236 Vali Acc: 0.500 Test Loss: 9.236 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.97905683517456
Epoch: 16, Steps: 70 | Train Loss: 25.119 Vali Loss: 4.501 Vali Acc: 0.510 Test Loss: 4.501 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.23791193962097
Epoch: 17, Steps: 70 | Train Loss: 15.987 Vali Loss: 16.366 Vali Acc: 0.500 Test Loss: 16.366 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.378498792648315
Epoch: 18, Steps: 70 | Train Loss: 21.201 Vali Loss: 6.608 Vali Acc: 0.560 Test Loss: 6.608 Test Acc: 0.560
Validation loss decreased (-0.539837 --> -0.559934).  Saving model ...
Epoch: 19 cost time: 17.468858003616333
Epoch: 19, Steps: 70 | Train Loss: 15.413 Vali Loss: 9.855 Vali Acc: 0.500 Test Loss: 9.855 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.329454183578491
Epoch: 20, Steps: 70 | Train Loss: 11.366 Vali Loss: 16.172 Vali Acc: 0.490 Test Loss: 16.172 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 17.35861873626709
Epoch: 21, Steps: 70 | Train Loss: 14.711 Vali Loss: 8.097 Vali Acc: 0.520 Test Loss: 8.097 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 17.38080143928528
Epoch: 22, Steps: 70 | Train Loss: 19.619 Vali Loss: 10.449 Vali Acc: 0.430 Test Loss: 10.449 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 16.417965412139893
Epoch: 23, Steps: 70 | Train Loss: 15.347 Vali Loss: 47.650 Vali Acc: 0.350 Test Loss: 47.650 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.602794885635376
Epoch: 24, Steps: 70 | Train Loss: 15.852 Vali Loss: 8.432 Vali Acc: 0.520 Test Loss: 8.432 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 17.492589473724365
Epoch: 25, Steps: 70 | Train Loss: 29.726 Vali Loss: 16.984 Vali Acc: 0.630 Test Loss: 16.984 Test Acc: 0.630
Validation loss decreased (-0.559934 --> -0.629830).  Saving model ...
Epoch: 26 cost time: 17.47838282585144
Epoch: 26, Steps: 70 | Train Loss: 24.062 Vali Loss: 44.264 Vali Acc: 0.420 Test Loss: 44.264 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 14.44786024093628
Epoch: 27, Steps: 70 | Train Loss: 22.234 Vali Loss: 18.747 Vali Acc: 0.550 Test Loss: 18.747 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 16.763070821762085
Epoch: 28, Steps: 70 | Train Loss: 20.012 Vali Loss: 11.654 Vali Acc: 0.530 Test Loss: 11.654 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 17.442665338516235
Epoch: 29, Steps: 70 | Train Loss: 34.927 Vali Loss: 17.977 Vali Acc: 0.500 Test Loss: 17.977 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 17.42674469947815
Epoch: 30, Steps: 70 | Train Loss: 25.185 Vali Loss: 9.661 Vali Acc: 0.530 Test Loss: 9.661 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 14.621428489685059
Epoch: 31, Steps: 70 | Train Loss: 9.014 Vali Loss: 14.187 Vali Acc: 0.490 Test Loss: 14.187 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 17.52676749229431
Epoch: 32, Steps: 70 | Train Loss: 11.918 Vali Loss: 25.828 Vali Acc: 0.490 Test Loss: 25.828 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 17.549296379089355
Epoch: 33, Steps: 70 | Train Loss: 15.106 Vali Loss: 5.824 Vali Acc: 0.480 Test Loss: 5.824 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 15.444120645523071
Epoch: 34, Steps: 70 | Train Loss: 10.090 Vali Loss: 9.405 Vali Acc: 0.530 Test Loss: 9.405 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 15.08877968788147
Epoch: 35, Steps: 70 | Train Loss: 6.627 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 7831834
model size : 32.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.043479442596436
Epoch: 1, Steps: 70 | Train Loss: 29.802 Vali Loss: 47.158 Vali Acc: 0.490 Test Loss: 47.158 Test Acc: 0.490
Validation loss decreased (inf --> -0.489528).  Saving model ...
Epoch: 2 cost time: 14.14854884147644
Epoch: 2, Steps: 70 | Train Loss: 26.388 Vali Loss: 67.726 Vali Acc: 0.500 Test Loss: 67.726 Test Acc: 0.500
Validation loss decreased (-0.489528 --> -0.499323).  Saving model ...
Epoch: 3 cost time: 15.469840288162231
Epoch: 3, Steps: 70 | Train Loss: 30.796 Vali Loss: 37.898 Vali Acc: 0.500 Test Loss: 37.898 Test Acc: 0.500
Validation loss decreased (-0.499323 --> -0.499621).  Saving model ...
Epoch: 4 cost time: 16.282042264938354
Epoch: 4, Steps: 70 | Train Loss: 27.059 Vali Loss: 9.802 Vali Acc: 0.510 Test Loss: 9.802 Test Acc: 0.510
Validation loss decreased (-0.499621 --> -0.509902).  Saving model ...
Epoch: 5 cost time: 14.119294881820679
Epoch: 5, Steps: 70 | Train Loss: 30.273 Vali Loss: 6.910 Vali Acc: 0.500 Test Loss: 6.910 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.789782047271729
Epoch: 6, Steps: 70 | Train Loss: 14.754 Vali Loss: 3.863 Vali Acc: 0.450 Test Loss: 3.863 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.161901235580444
Epoch: 7, Steps: 70 | Train Loss: 12.014 Vali Loss: 5.808 Vali Acc: 0.630 Test Loss: 5.808 Test Acc: 0.630
Validation loss decreased (-0.509902 --> -0.629942).  Saving model ...
Epoch: 8 cost time: 14.271482706069946
Epoch: 8, Steps: 70 | Train Loss: 9.032 Vali Loss: 22.747 Vali Acc: 0.500 Test Loss: 22.747 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.807801008224487
Epoch: 9, Steps: 70 | Train Loss: 13.043 Vali Loss: 19.454 Vali Acc: 0.500 Test Loss: 19.454 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.538564920425415
Epoch: 10, Steps: 70 | Train Loss: 13.897 Vali Loss: 32.807 Vali Acc: 0.430 Test Loss: 32.807 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.822584867477417
Epoch: 11, Steps: 70 | Train Loss: 21.765 Vali Loss: 34.015 Vali Acc: 0.580 Test Loss: 34.015 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.32991671562195
Epoch: 12, Steps: 70 | Train Loss: 16.358 Vali Loss: 40.875 Vali Acc: 0.510 Test Loss: 40.875 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.371472120285034
Epoch: 13, Steps: 70 | Train Loss: 16.604 Vali Loss: 12.476 Vali Acc: 0.430 Test Loss: 12.476 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.593716144561768
Epoch: 14, Steps: 70 | Train Loss: 7.959 Vali Loss: 13.003 Vali Acc: 0.560 Test Loss: 13.003 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.293702363967896
Epoch: 15, Steps: 70 | Train Loss: 12.393 Vali Loss: 27.100 Vali Acc: 0.510 Test Loss: 27.100 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.42481756210327
Epoch: 16, Steps: 70 | Train Loss: 4.960 Vali Loss: 9.953 Vali Acc: 0.500 Test Loss: 9.953 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.802162170410156
Epoch: 17, Steps: 70 | Train Loss: 2.278 Vali Loss: 39.430 Vali Acc: 0.530 Test Loss: 39.430 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 7799834
model size : 32.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.126385688781738
Epoch: 1, Steps: 70 | Train Loss: 17.286 Vali Loss: 19.626 Vali Acc: 0.460 Test Loss: 19.626 Test Acc: 0.460
Validation loss decreased (inf --> -0.459804).  Saving model ...
Epoch: 2 cost time: 15.128859519958496
Epoch: 2, Steps: 70 | Train Loss: 26.003 Vali Loss: 103.244 Vali Acc: 0.500 Test Loss: 103.244 Test Acc: 0.500
Validation loss decreased (-0.459804 --> -0.498968).  Saving model ...
Epoch: 3 cost time: 15.672229766845703
Epoch: 3, Steps: 70 | Train Loss: 27.028 Vali Loss: 12.822 Vali Acc: 0.500 Test Loss: 12.822 Test Acc: 0.500
Validation loss decreased (-0.498968 --> -0.499872).  Saving model ...
Epoch: 4 cost time: 14.266133069992065
Epoch: 4, Steps: 70 | Train Loss: 16.335 Vali Loss: 25.099 Vali Acc: 0.500 Test Loss: 25.099 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.776175498962402
Epoch: 5, Steps: 70 | Train Loss: 16.928 Vali Loss: 28.159 Vali Acc: 0.500 Test Loss: 28.159 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.91953730583191
Epoch: 6, Steps: 70 | Train Loss: 17.010 Vali Loss: 26.368 Vali Acc: 0.500 Test Loss: 26.368 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.366019248962402
Epoch: 7, Steps: 70 | Train Loss: 15.314 Vali Loss: 10.945 Vali Acc: 0.500 Test Loss: 10.945 Test Acc: 0.500
Validation loss decreased (-0.499872 --> -0.499891).  Saving model ...
Epoch: 8 cost time: 14.685747623443604
Epoch: 8, Steps: 70 | Train Loss: 9.203 Vali Loss: 19.080 Vali Acc: 0.500 Test Loss: 19.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.777733564376831
Epoch: 9, Steps: 70 | Train Loss: 11.502 Vali Loss: 8.412 Vali Acc: 0.500 Test Loss: 8.412 Test Acc: 0.500
Validation loss decreased (-0.499891 --> -0.499916).  Saving model ...
Epoch: 10 cost time: 14.322460412979126
Epoch: 10, Steps: 70 | Train Loss: 20.266 Vali Loss: 38.970 Vali Acc: 0.500 Test Loss: 38.970 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.758458375930786
Epoch: 11, Steps: 70 | Train Loss: 11.286 Vali Loss: 3.124 Vali Acc: 0.500 Test Loss: 3.124 Test Acc: 0.500
Validation loss decreased (-0.499916 --> -0.499969).  Saving model ...
Epoch: 12 cost time: 15.78110671043396
Epoch: 12, Steps: 70 | Train Loss: 9.340 Vali Loss: 14.750 Vali Acc: 0.500 Test Loss: 14.750 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.394292116165161
Epoch: 13, Steps: 70 | Train Loss: 13.092 Vali Loss: 36.080 Vali Acc: 0.500 Test Loss: 36.080 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.543782472610474
Epoch: 14, Steps: 70 | Train Loss: 20.808 Vali Loss: 16.021 Vali Acc: 0.500 Test Loss: 16.021 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.859724760055542
Epoch: 15, Steps: 70 | Train Loss: 12.758 Vali Loss: 3.355 Vali Acc: 0.500 Test Loss: 3.355 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.945070505142212
Epoch: 16, Steps: 70 | Train Loss: 10.542 Vali Loss: 14.652 Vali Acc: 0.500 Test Loss: 14.652 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.302981853485107
Epoch: 17, Steps: 70 | Train Loss: 12.160 Vali Loss: 5.732 Vali Acc: 0.500 Test Loss: 5.732 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.843610763549805
Epoch: 18, Steps: 70 | Train Loss: 6.682 Vali Loss: 17.926 Vali Acc: 0.500 Test Loss: 17.926 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.09609580039978
Epoch: 19, Steps: 70 | Train Loss: 9.855 Vali Loss: 20.605 Vali Acc: 0.500 Test Loss: 20.605 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.285972118377686
Epoch: 20, Steps: 70 | Train Loss: 12.601 Vali Loss: 22.794 Vali Acc: 0.500 Test Loss: 22.794 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.67747712135315
Epoch: 21, Steps: 70 | Train Loss: 5.509 Vali Loss: 11.833 Vali Acc: 0.530 Test Loss: 11.833 Test Acc: 0.530
Validation loss decreased (-0.499969 --> -0.529882).  Saving model ...
Epoch: 22 cost time: 14.976463317871094
Epoch: 22, Steps: 70 | Train Loss: 3.800 Vali Loss: 5.083 Vali Acc: 0.590 Test Loss: 5.083 Test Acc: 0.590
Validation loss decreased (-0.529882 --> -0.589949).  Saving model ...
Epoch: 23 cost time: 14.313097715377808
Epoch: 23, Steps: 70 | Train Loss: 4.541 Vali Loss: 12.157 Vali Acc: 0.480 Test Loss: 12.157 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 15.858174324035645
Epoch: 24, Steps: 70 | Train Loss: 3.658 Vali Loss: 17.690 Vali Acc: 0.470 Test Loss: 17.690 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 14.993390083312988
Epoch: 25, Steps: 70 | Train Loss: 2.810 Vali Loss: 24.129 Vali Acc: 0.460 Test Loss: 24.129 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.279065608978271
Epoch: 26, Steps: 70 | Train Loss: 2.940 Vali Loss: 17.723 Vali Acc: 0.520 Test Loss: 17.723 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 15.684952974319458
Epoch: 27, Steps: 70 | Train Loss: 1.653 Vali Loss: 56.968 Vali Acc: 0.520 Test Loss: 56.968 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 15.304824590682983
Epoch: 28, Steps: 70 | Train Loss: 3.355 Vali Loss: 18.531 Vali Acc: 0.520 Test Loss: 18.531 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.621062755584717
Epoch: 29, Steps: 70 | Train Loss: 2.925 Vali Loss: 62.669 Vali Acc: 0.510 Test Loss: 62.669 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 15.784660577774048
Epoch: 30, Steps: 70 | Train Loss: 2.903 Vali Loss: 35.980 Vali Acc: 0.450 Test Loss: 35.980 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 15.74967646598816
Epoch: 31, Steps: 70 | Train Loss: 1.053 Vali Loss: 21.713 Vali Acc: 0.550 Test Loss: 21.713 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 13.037290096282959
Epoch: 32, Steps: 70 | Train Loss: 0.599 Vali Loss: 51.704 Vali Acc: 0.440 Test Loss: 51.704 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7767834
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.867164611816406
Epoch: 1, Steps: 70 | Train Loss: 16.810 Vali Loss: 35.983 Vali Acc: 0.510 Test Loss: 35.983 Test Acc: 0.510
Validation loss decreased (inf --> -0.509640).  Saving model ...
Epoch: 2 cost time: 12.533409357070923
Epoch: 2, Steps: 70 | Train Loss: 30.434 Vali Loss: 35.402 Vali Acc: 0.500 Test Loss: 35.402 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.973429441452026
Epoch: 3, Steps: 70 | Train Loss: 56.591 Vali Loss: 43.100 Vali Acc: 0.520 Test Loss: 43.100 Test Acc: 0.520
Validation loss decreased (-0.509640 --> -0.519569).  Saving model ...
Epoch: 4 cost time: 12.216010570526123
Epoch: 4, Steps: 70 | Train Loss: 26.383 Vali Loss: 3.821 Vali Acc: 0.370 Test Loss: 3.821 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.019121646881104
Epoch: 5, Steps: 70 | Train Loss: 10.369 Vali Loss: 10.877 Vali Acc: 0.500 Test Loss: 10.877 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.347408771514893
Epoch: 6, Steps: 70 | Train Loss: 17.622 Vali Loss: 18.101 Vali Acc: 0.500 Test Loss: 18.101 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.200870275497437
Epoch: 7, Steps: 70 | Train Loss: 20.111 Vali Loss: 21.351 Vali Acc: 0.500 Test Loss: 21.351 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.93161940574646
Epoch: 8, Steps: 70 | Train Loss: 14.321 Vali Loss: 21.893 Vali Acc: 0.500 Test Loss: 21.893 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.872727870941162
Epoch: 9, Steps: 70 | Train Loss: 22.462 Vali Loss: 5.686 Vali Acc: 0.530 Test Loss: 5.686 Test Acc: 0.530
Validation loss decreased (-0.519569 --> -0.529943).  Saving model ...
Epoch: 10 cost time: 13.179942846298218
Epoch: 10, Steps: 70 | Train Loss: 28.449 Vali Loss: 36.568 Vali Acc: 0.500 Test Loss: 36.568 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.069205284118652
Epoch: 11, Steps: 70 | Train Loss: 27.483 Vali Loss: 14.199 Vali Acc: 0.520 Test Loss: 14.199 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.511454820632935
Epoch: 12, Steps: 70 | Train Loss: 10.333 Vali Loss: 20.094 Vali Acc: 0.470 Test Loss: 20.094 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.830693244934082
Epoch: 13, Steps: 70 | Train Loss: 7.656 Vali Loss: 6.208 Vali Acc: 0.530 Test Loss: 6.208 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.21070671081543
Epoch: 14, Steps: 70 | Train Loss: 10.998 Vali Loss: 50.504 Vali Acc: 0.500 Test Loss: 50.504 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.301279783248901
Epoch: 15, Steps: 70 | Train Loss: 11.910 Vali Loss: 20.295 Vali Acc: 0.490 Test Loss: 20.295 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.506587743759155
Epoch: 16, Steps: 70 | Train Loss: 10.658 Vali Loss: 21.142 Vali Acc: 0.510 Test Loss: 21.142 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.04668664932251
Epoch: 17, Steps: 70 | Train Loss: 4.392 Vali Loss: 24.409 Vali Acc: 0.460 Test Loss: 24.409 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.744796514511108
Epoch: 18, Steps: 70 | Train Loss: 0.887 Vali Loss: 12.946 Vali Acc: 0.570 Test Loss: 12.946 Test Acc: 0.570
Validation loss decreased (-0.529943 --> -0.569871).  Saving model ...
Epoch: 19 cost time: 14.185025215148926
Epoch: 19, Steps: 70 | Train Loss: 5.087 Vali Loss: 107.161 Vali Acc: 0.530 Test Loss: 107.161 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.605399370193481
Epoch: 20, Steps: 70 | Train Loss: 14.066 Vali Loss: 66.498 Vali Acc: 0.490 Test Loss: 66.498 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.0466787815094
Epoch: 21, Steps: 70 | Train Loss: 9.087 Vali Loss: 40.916 Vali Acc: 0.430 Test Loss: 40.916 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.59321117401123
Epoch: 22, Steps: 70 | Train Loss: 2.784 Vali Loss: 47.775 Vali Acc: 0.480 Test Loss: 47.775 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.985523462295532
Epoch: 23, Steps: 70 | Train Loss: 1.750 Vali Loss: 37.180 Vali Acc: 0.520 Test Loss: 37.180 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.932609796524048
Epoch: 24, Steps: 70 | Train Loss: 2.657 Vali Loss: 82.086 Vali Acc: 0.450 Test Loss: 82.086 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 13.136445045471191
Epoch: 25, Steps: 70 | Train Loss: 6.787 Vali Loss: 94.524 Vali Acc: 0.470 Test Loss: 94.524 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.902484893798828
Epoch: 26, Steps: 70 | Train Loss: 5.774 Vali Loss: 39.446 Vali Acc: 0.600 Test Loss: 39.446 Test Acc: 0.600
Validation loss decreased (-0.569871 --> -0.599606).  Saving model ...
Epoch: 27 cost time: 12.895108222961426
Epoch: 27, Steps: 70 | Train Loss: 0.652 Vali Loss: 87.342 Vali Acc: 0.530 Test Loss: 87.342 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 15.016700744628906
Epoch: 28, Steps: 70 | Train Loss: 2.266 Vali Loss: 86.472 Vali Acc: 0.480 Test Loss: 86.472 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.322449207305908
Epoch: 29, Steps: 70 | Train Loss: 1.723 Vali Loss: 83.167 Vali Acc: 0.460 Test Loss: 83.167 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 14.922626972198486
Epoch: 30, Steps: 70 | Train Loss: 2.956 Vali Loss: 48.163 Vali Acc: 0.490 Test Loss: 48.163 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 12.258378028869629
Epoch: 31, Steps: 70 | Train Loss: 3.442 Vali Loss: 70.706 Vali Acc: 0.520 Test Loss: 70.706 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 15.011828422546387
Epoch: 32, Steps: 70 | Train Loss: 0.583 Vali Loss: 57.928 Vali Acc: 0.440 Test Loss: 57.928 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 12.858629703521729
Epoch: 33, Steps: 70 | Train Loss: 0.008 Vali Loss: 57.605 Vali Acc: 0.470 Test Loss: 57.605 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 15.004834175109863
Epoch: 34, Steps: 70 | Train Loss: 0.713 Vali Loss: 56.644 Vali Acc: 0.480 Test Loss: 56.644 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 13.201871156692505
Epoch: 35, Steps: 70 | Train Loss: 0.679 Vali Loss: 82.586 Vali Acc: 0.420 Test Loss: 82.586 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 14.991642713546753
Epoch: 36, Steps: 70 | Train Loss: 0.281 Vali Loss: 64.044 Vali Acc: 0.450 Test Loss: 64.044 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 7469082
model size : 31.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.083334684371948
Epoch: 1, Steps: 70 | Train Loss: 23.841 Vali Loss: 20.408 Vali Acc: 0.540 Test Loss: 20.408 Test Acc: 0.540
Validation loss decreased (inf --> -0.539796).  Saving model ...
Epoch: 2 cost time: 14.325470209121704
Epoch: 2, Steps: 70 | Train Loss: 46.022 Vali Loss: 33.994 Vali Acc: 0.490 Test Loss: 33.994 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.24919867515564
Epoch: 3, Steps: 70 | Train Loss: 50.360 Vali Loss: 6.756 Vali Acc: 0.440 Test Loss: 6.756 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.028628826141357
Epoch: 4, Steps: 70 | Train Loss: 40.079 Vali Loss: 28.346 Vali Acc: 0.500 Test Loss: 28.346 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.934059858322144
Epoch: 5, Steps: 70 | Train Loss: 15.385 Vali Loss: 17.488 Vali Acc: 0.500 Test Loss: 17.488 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.613857984542847
Epoch: 6, Steps: 70 | Train Loss: 7.922 Vali Loss: 8.132 Vali Acc: 0.500 Test Loss: 8.132 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.784206628799438
Epoch: 7, Steps: 70 | Train Loss: 8.579 Vali Loss: 28.849 Vali Acc: 0.500 Test Loss: 28.849 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.993692636489868
Epoch: 8, Steps: 70 | Train Loss: 14.355 Vali Loss: 2.117 Vali Acc: 0.480 Test Loss: 2.117 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.7499361038208
Epoch: 9, Steps: 70 | Train Loss: 12.351 Vali Loss: 5.359 Vali Acc: 0.500 Test Loss: 5.359 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.849589824676514
Epoch: 10, Steps: 70 | Train Loss: 20.131 Vali Loss: 26.206 Vali Acc: 0.500 Test Loss: 26.206 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.734325885772705
Epoch: 11, Steps: 70 | Train Loss: 12.161 Vali Loss: 29.675 Vali Acc: 0.500 Test Loss: 29.675 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 7437082
model size : 30.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.875165462493896
Epoch: 1, Steps: 70 | Train Loss: 30.661 Vali Loss: 23.516 Vali Acc: 0.430 Test Loss: 23.516 Test Acc: 0.430
Validation loss decreased (inf --> -0.429765).  Saving model ...
Epoch: 2 cost time: 14.715059995651245
Epoch: 2, Steps: 70 | Train Loss: 70.723 Vali Loss: 129.820 Vali Acc: 0.500 Test Loss: 129.820 Test Acc: 0.500
Validation loss decreased (-0.429765 --> -0.498702).  Saving model ...
Epoch: 3 cost time: 13.2071533203125
Epoch: 3, Steps: 70 | Train Loss: 18.593 Vali Loss: 17.899 Vali Acc: 0.500 Test Loss: 17.899 Test Acc: 0.500
Validation loss decreased (-0.498702 --> -0.499821).  Saving model ...
Epoch: 4 cost time: 14.791822671890259
Epoch: 4, Steps: 70 | Train Loss: 11.231 Vali Loss: 60.465 Vali Acc: 0.500 Test Loss: 60.465 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.653306245803833
Epoch: 5, Steps: 70 | Train Loss: 16.383 Vali Loss: 5.795 Vali Acc: 0.500 Test Loss: 5.795 Test Acc: 0.500
Validation loss decreased (-0.499821 --> -0.499942).  Saving model ...
Epoch: 6 cost time: 14.448798894882202
Epoch: 6, Steps: 70 | Train Loss: 9.804 Vali Loss: 32.523 Vali Acc: 0.500 Test Loss: 32.523 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.169873476028442
Epoch: 7, Steps: 70 | Train Loss: 16.785 Vali Loss: 4.581 Vali Acc: 0.500 Test Loss: 4.581 Test Acc: 0.500
Validation loss decreased (-0.499942 --> -0.499954).  Saving model ...
Epoch: 8 cost time: 14.380626678466797
Epoch: 8, Steps: 70 | Train Loss: 13.034 Vali Loss: 9.620 Vali Acc: 0.460 Test Loss: 9.620 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.22498631477356
Epoch: 9, Steps: 70 | Train Loss: 9.013 Vali Loss: 11.842 Vali Acc: 0.500 Test Loss: 11.842 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.133295774459839
Epoch: 10, Steps: 70 | Train Loss: 10.754 Vali Loss: 14.980 Vali Acc: 0.500 Test Loss: 14.980 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.510523319244385
Epoch: 11, Steps: 70 | Train Loss: 22.087 Vali Loss: 6.271 Vali Acc: 0.520 Test Loss: 6.271 Test Acc: 0.520
Validation loss decreased (-0.499954 --> -0.519937).  Saving model ...
Epoch: 12 cost time: 11.692917585372925
Epoch: 12, Steps: 70 | Train Loss: 11.521 Vali Loss: 3.847 Vali Acc: 0.460 Test Loss: 3.847 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.174421310424805
Epoch: 13, Steps: 70 | Train Loss: 13.457 Vali Loss: 23.923 Vali Acc: 0.510 Test Loss: 23.923 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.436737060546875
Epoch: 14, Steps: 70 | Train Loss: 15.487 Vali Loss: 5.753 Vali Acc: 0.560 Test Loss: 5.753 Test Acc: 0.560
Validation loss decreased (-0.519937 --> -0.559942).  Saving model ...
Epoch: 15 cost time: 15.515300512313843
Epoch: 15, Steps: 70 | Train Loss: 9.054 Vali Loss: 10.734 Vali Acc: 0.500 Test Loss: 10.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.697662591934204
Epoch: 16, Steps: 70 | Train Loss: 4.786 Vali Loss: 22.971 Vali Acc: 0.550 Test Loss: 22.971 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.423466444015503
Epoch: 17, Steps: 70 | Train Loss: 7.292 Vali Loss: 9.104 Vali Acc: 0.590 Test Loss: 9.104 Test Acc: 0.590
Validation loss decreased (-0.559942 --> -0.589909).  Saving model ...
Epoch: 18 cost time: 15.124060869216919
Epoch: 18, Steps: 70 | Train Loss: 7.774 Vali Loss: 45.353 Vali Acc: 0.500 Test Loss: 45.353 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.489827394485474
Epoch: 19, Steps: 70 | Train Loss: 23.941 Vali Loss: 45.221 Vali Acc: 0.500 Test Loss: 45.221 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.495600938796997
Epoch: 20, Steps: 70 | Train Loss: 19.457 Vali Loss: 9.755 Vali Acc: 0.420 Test Loss: 9.755 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 14.424136638641357
Epoch: 21, Steps: 70 | Train Loss: 33.913 Vali Loss: 15.125 Vali Acc: 0.500 Test Loss: 15.125 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 15.636904239654541
Epoch: 22, Steps: 70 | Train Loss: 34.064 Vali Loss: 46.242 Vali Acc: 0.480 Test Loss: 46.242 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 15.54054307937622
Epoch: 23, Steps: 70 | Train Loss: 19.081 Vali Loss: 6.420 Vali Acc: 0.590 Test Loss: 6.420 Test Acc: 0.590
Validation loss decreased (-0.589909 --> -0.589936).  Saving model ...
Epoch: 24 cost time: 12.941970348358154
Epoch: 24, Steps: 70 | Train Loss: 11.578 Vali Loss: 22.628 Vali Acc: 0.480 Test Loss: 22.628 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 15.100192308425903
Epoch: 25, Steps: 70 | Train Loss: 12.086 Vali Loss: 38.986 Vali Acc: 0.500 Test Loss: 38.986 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 15.665661573410034
Epoch: 26, Steps: 70 | Train Loss: 19.846 Vali Loss: 31.119 Vali Acc: 0.480 Test Loss: 31.119 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 15.666353225708008
Epoch: 27, Steps: 70 | Train Loss: 26.166 Vali Loss: 26.973 Vali Acc: 0.450 Test Loss: 26.973 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 13.104206323623657
Epoch: 28, Steps: 70 | Train Loss: 17.849 Vali Loss: 46.023 Vali Acc: 0.500 Test Loss: 46.023 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 15.551289319992065
Epoch: 29, Steps: 70 | Train Loss: 23.639 Vali Loss: 32.496 Vali Acc: 0.500 Test Loss: 32.496 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 15.554234266281128
Epoch: 30, Steps: 70 | Train Loss: 17.325 Vali Loss: 29.211 Vali Acc: 0.500 Test Loss: 29.211 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 15.564868211746216
Epoch: 31, Steps: 70 | Train Loss: 25.287 Vali Loss: 41.039 Vali Acc: 0.460 Test Loss: 41.039 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 13.111098766326904
Epoch: 32, Steps: 70 | Train Loss: 14.956 Vali Loss: 19.328 Vali Acc: 0.460 Test Loss: 19.328 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 15.65751600265503
Epoch: 33, Steps: 70 | Train Loss: 14.398 Vali Loss: 15.718 Vali Acc: 0.450 Test Loss: 15.718 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7405082
model size : 30.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.278730630874634
Epoch: 1, Steps: 70 | Train Loss: 35.921 Vali Loss: 61.198 Vali Acc: 0.500 Test Loss: 61.198 Test Acc: 0.500
Validation loss decreased (inf --> -0.499388).  Saving model ...
Epoch: 2 cost time: 13.280732870101929
Epoch: 2, Steps: 70 | Train Loss: 51.804 Vali Loss: 69.201 Vali Acc: 0.420 Test Loss: 69.201 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.799048900604248
Epoch: 3, Steps: 70 | Train Loss: 65.528 Vali Loss: 12.600 Vali Acc: 0.530 Test Loss: 12.600 Test Acc: 0.530
Validation loss decreased (-0.499388 --> -0.529874).  Saving model ...
Epoch: 4 cost time: 15.09079885482788
Epoch: 4, Steps: 70 | Train Loss: 44.960 Vali Loss: 90.143 Vali Acc: 0.500 Test Loss: 90.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.49601936340332
Epoch: 5, Steps: 70 | Train Loss: 20.287 Vali Loss: 7.209 Vali Acc: 0.550 Test Loss: 7.209 Test Acc: 0.550
Validation loss decreased (-0.529874 --> -0.549928).  Saving model ...
Epoch: 6 cost time: 13.55984354019165
Epoch: 6, Steps: 70 | Train Loss: 16.173 Vali Loss: 3.165 Vali Acc: 0.480 Test Loss: 3.165 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.048521041870117
Epoch: 7, Steps: 70 | Train Loss: 8.385 Vali Loss: 13.887 Vali Acc: 0.420 Test Loss: 13.887 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.013590097427368
Epoch: 8, Steps: 70 | Train Loss: 16.179 Vali Loss: 16.782 Vali Acc: 0.570 Test Loss: 16.782 Test Acc: 0.570
Validation loss decreased (-0.549928 --> -0.569832).  Saving model ...
Epoch: 9 cost time: 13.672691822052002
Epoch: 9, Steps: 70 | Train Loss: 13.990 Vali Loss: 23.857 Vali Acc: 0.490 Test Loss: 23.857 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.485061407089233
Epoch: 10, Steps: 70 | Train Loss: 22.264 Vali Loss: 9.622 Vali Acc: 0.540 Test Loss: 9.622 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.882270336151123
Epoch: 11, Steps: 70 | Train Loss: 17.413 Vali Loss: 26.761 Vali Acc: 0.490 Test Loss: 26.761 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.224353790283203
Epoch: 12, Steps: 70 | Train Loss: 8.548 Vali Loss: 79.256 Vali Acc: 0.500 Test Loss: 79.256 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.528220653533936
Epoch: 13, Steps: 70 | Train Loss: 12.179 Vali Loss: 10.427 Vali Acc: 0.510 Test Loss: 10.427 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.3201162815094
Epoch: 14, Steps: 70 | Train Loss: 5.931 Vali Loss: 15.377 Vali Acc: 0.530 Test Loss: 15.377 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 15.07155466079712
Epoch: 15, Steps: 70 | Train Loss: 9.603 Vali Loss: 24.759 Vali Acc: 0.490 Test Loss: 24.759 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.861846446990967
Epoch: 16, Steps: 70 | Train Loss: 6.708 Vali Loss: 83.272 Vali Acc: 0.470 Test Loss: 83.272 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.828053951263428
Epoch: 17, Steps: 70 | Train Loss: 2.789 Vali Loss: 27.372 Vali Acc: 0.490 Test Loss: 27.372 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.351197957992554
Epoch: 18, Steps: 70 | Train Loss: 3.614 Vali Loss: 29.156 Vali Acc: 0.500 Test Loss: 29.156 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7373082
model size : 30.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.135242462158203
Epoch: 1, Steps: 70 | Train Loss: 24.368 Vali Loss: 24.782 Vali Acc: 0.390 Test Loss: 24.782 Test Acc: 0.390
Validation loss decreased (inf --> -0.389752).  Saving model ...
Epoch: 2 cost time: 12.515534400939941
Epoch: 2, Steps: 70 | Train Loss: 58.756 Vali Loss: 23.226 Vali Acc: 0.450 Test Loss: 23.226 Test Acc: 0.450
Validation loss decreased (-0.389752 --> -0.449768).  Saving model ...
Epoch: 3 cost time: 14.486089706420898
Epoch: 3, Steps: 70 | Train Loss: 33.311 Vali Loss: 64.390 Vali Acc: 0.510 Test Loss: 64.390 Test Acc: 0.510
Validation loss decreased (-0.449768 --> -0.509356).  Saving model ...
Epoch: 4 cost time: 15.038400173187256
Epoch: 4, Steps: 70 | Train Loss: 47.442 Vali Loss: 7.314 Vali Acc: 0.510 Test Loss: 7.314 Test Acc: 0.510
Validation loss decreased (-0.509356 --> -0.509927).  Saving model ...
Epoch: 5 cost time: 15.125951051712036
Epoch: 5, Steps: 70 | Train Loss: 8.384 Vali Loss: 17.365 Vali Acc: 0.500 Test Loss: 17.365 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.98081350326538
Epoch: 6, Steps: 70 | Train Loss: 20.582 Vali Loss: 19.969 Vali Acc: 0.500 Test Loss: 19.969 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.826687335968018
Epoch: 7, Steps: 70 | Train Loss: 15.220 Vali Loss: 5.353 Vali Acc: 0.530 Test Loss: 5.353 Test Acc: 0.530
Validation loss decreased (-0.509927 --> -0.529946).  Saving model ...
Epoch: 8 cost time: 15.185733079910278
Epoch: 8, Steps: 70 | Train Loss: 8.202 Vali Loss: 11.022 Vali Acc: 0.490 Test Loss: 11.022 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.029619216918945
Epoch: 9, Steps: 70 | Train Loss: 23.898 Vali Loss: 4.061 Vali Acc: 0.470 Test Loss: 4.061 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.84325385093689
Epoch: 10, Steps: 70 | Train Loss: 12.275 Vali Loss: 20.873 Vali Acc: 0.480 Test Loss: 20.873 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.383933305740356
Epoch: 11, Steps: 70 | Train Loss: 6.846 Vali Loss: 4.424 Vali Acc: 0.550 Test Loss: 4.424 Test Acc: 0.550
Validation loss decreased (-0.529946 --> -0.549956).  Saving model ...
Epoch: 12 cost time: 15.042295694351196
Epoch: 12, Steps: 70 | Train Loss: 11.759 Vali Loss: 24.531 Vali Acc: 0.480 Test Loss: 24.531 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.074630737304688
Epoch: 13, Steps: 70 | Train Loss: 12.166 Vali Loss: 9.451 Vali Acc: 0.530 Test Loss: 9.451 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.70483112335205
Epoch: 14, Steps: 70 | Train Loss: 13.893 Vali Loss: 36.054 Vali Acc: 0.500 Test Loss: 36.054 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.303437232971191
Epoch: 15, Steps: 70 | Train Loss: 9.839 Vali Loss: 41.847 Vali Acc: 0.500 Test Loss: 41.847 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.300644397735596
Epoch: 16, Steps: 70 | Train Loss: 8.674 Vali Loss: 46.139 Vali Acc: 0.540 Test Loss: 46.139 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.949441909790039
Epoch: 17, Steps: 70 | Train Loss: 8.551 Vali Loss: 9.350 Vali Acc: 0.510 Test Loss: 9.350 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.487488031387329
Epoch: 18, Steps: 70 | Train Loss: 5.519 Vali Loss: 107.058 Vali Acc: 0.500 Test Loss: 107.058 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 14.266111373901367
Epoch: 19, Steps: 70 | Train Loss: 2.880 Vali Loss: 82.814 Vali Acc: 0.430 Test Loss: 82.814 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.986509084701538
Epoch: 20, Steps: 70 | Train Loss: 2.414 Vali Loss: 46.859 Vali Acc: 0.450 Test Loss: 46.859 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 14.962095737457275
Epoch: 21, Steps: 70 | Train Loss: 1.800 Vali Loss: 75.882 Vali Acc: 0.430 Test Loss: 75.882 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 7271706
model size : 30.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.795175790786743
Epoch: 1, Steps: 70 | Train Loss: 20.147 Vali Loss: 28.852 Vali Acc: 0.500 Test Loss: 28.852 Test Acc: 0.500
Validation loss decreased (inf --> -0.499711).  Saving model ...
Epoch: 2 cost time: 15.161373615264893
Epoch: 2, Steps: 70 | Train Loss: 24.777 Vali Loss: 9.078 Vali Acc: 0.500 Test Loss: 9.078 Test Acc: 0.500
Validation loss decreased (-0.499711 --> -0.499909).  Saving model ...
Epoch: 3 cost time: 13.695489406585693
Epoch: 3, Steps: 70 | Train Loss: 32.778 Vali Loss: 15.585 Vali Acc: 0.460 Test Loss: 15.585 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.399162530899048
Epoch: 4, Steps: 70 | Train Loss: 56.739 Vali Loss: 26.406 Vali Acc: 0.500 Test Loss: 26.406 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.01332688331604
Epoch: 5, Steps: 70 | Train Loss: 27.081 Vali Loss: 42.461 Vali Acc: 0.500 Test Loss: 42.461 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.961481809616089
Epoch: 6, Steps: 70 | Train Loss: 12.692 Vali Loss: 8.766 Vali Acc: 0.500 Test Loss: 8.766 Test Acc: 0.500
Validation loss decreased (-0.499909 --> -0.499912).  Saving model ...
Epoch: 7 cost time: 13.857667684555054
Epoch: 7, Steps: 70 | Train Loss: 10.532 Vali Loss: 24.333 Vali Acc: 0.500 Test Loss: 24.333 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.60725450515747
Epoch: 8, Steps: 70 | Train Loss: 13.484 Vali Loss: 6.580 Vali Acc: 0.500 Test Loss: 6.580 Test Acc: 0.500
Validation loss decreased (-0.499912 --> -0.499934).  Saving model ...
Epoch: 9 cost time: 15.02176547050476
Epoch: 9, Steps: 70 | Train Loss: 10.100 Vali Loss: 10.893 Vali Acc: 0.510 Test Loss: 10.893 Test Acc: 0.510
Validation loss decreased (-0.499934 --> -0.509891).  Saving model ...
Epoch: 10 cost time: 14.916079759597778
Epoch: 10, Steps: 70 | Train Loss: 14.996 Vali Loss: 19.191 Vali Acc: 0.500 Test Loss: 19.191 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.653790712356567
Epoch: 11, Steps: 70 | Train Loss: 17.728 Vali Loss: 2.789 Vali Acc: 0.540 Test Loss: 2.789 Test Acc: 0.540
Validation loss decreased (-0.509891 --> -0.539972).  Saving model ...
Epoch: 12 cost time: 13.946720838546753
Epoch: 12, Steps: 70 | Train Loss: 23.532 Vali Loss: 73.065 Vali Acc: 0.500 Test Loss: 73.065 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.144037246704102
Epoch: 13, Steps: 70 | Train Loss: 14.287 Vali Loss: 23.057 Vali Acc: 0.510 Test Loss: 23.057 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.07357931137085
Epoch: 14, Steps: 70 | Train Loss: 7.633 Vali Loss: 22.348 Vali Acc: 0.500 Test Loss: 22.348 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.405259847640991
Epoch: 15, Steps: 70 | Train Loss: 17.213 Vali Loss: 51.396 Vali Acc: 0.500 Test Loss: 51.396 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.600182056427002
Epoch: 16, Steps: 70 | Train Loss: 11.398 Vali Loss: 17.040 Vali Acc: 0.460 Test Loss: 17.040 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.949164390563965
Epoch: 17, Steps: 70 | Train Loss: 5.274 Vali Loss: 11.118 Vali Acc: 0.450 Test Loss: 11.118 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.095348834991455
Epoch: 18, Steps: 70 | Train Loss: 5.401 Vali Loss: 24.763 Vali Acc: 0.540 Test Loss: 24.763 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.477067232131958
Epoch: 19, Steps: 70 | Train Loss: 6.729 Vali Loss: 7.213 Vali Acc: 0.480 Test Loss: 7.213 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 13.316394567489624
Epoch: 20, Steps: 70 | Train Loss: 3.775 Vali Loss: 16.593 Vali Acc: 0.520 Test Loss: 16.593 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.150436878204346
Epoch: 21, Steps: 70 | Train Loss: 2.254 Vali Loss: 20.805 Vali Acc: 0.580 Test Loss: 20.805 Test Acc: 0.580
Validation loss decreased (-0.539972 --> -0.579792).  Saving model ...
Epoch: 22 cost time: 15.074183225631714
Epoch: 22, Steps: 70 | Train Loss: 2.629 Vali Loss: 46.826 Vali Acc: 0.520 Test Loss: 46.826 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.454906940460205
Epoch: 23, Steps: 70 | Train Loss: 3.188 Vali Loss: 26.368 Vali Acc: 0.540 Test Loss: 26.368 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.527791500091553
Epoch: 24, Steps: 70 | Train Loss: 2.161 Vali Loss: 11.494 Vali Acc: 0.570 Test Loss: 11.494 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 15.024157285690308
Epoch: 25, Steps: 70 | Train Loss: 1.673 Vali Loss: 28.087 Vali Acc: 0.590 Test Loss: 28.087 Test Acc: 0.590
Validation loss decreased (-0.579792 --> -0.589719).  Saving model ...
Epoch: 26 cost time: 15.01254415512085
Epoch: 26, Steps: 70 | Train Loss: 0.811 Vali Loss: 28.600 Vali Acc: 0.560 Test Loss: 28.600 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 13.662650346755981
Epoch: 27, Steps: 70 | Train Loss: 0.528 Vali Loss: 26.738 Vali Acc: 0.480 Test Loss: 26.738 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 13.530024528503418
Epoch: 28, Steps: 70 | Train Loss: 3.533 Vali Loss: 36.304 Vali Acc: 0.580 Test Loss: 36.304 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 15.00105619430542
Epoch: 29, Steps: 70 | Train Loss: 2.943 Vali Loss: 148.921 Vali Acc: 0.530 Test Loss: 148.921 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 15.142115354537964
Epoch: 30, Steps: 70 | Train Loss: 3.658 Vali Loss: 77.525 Vali Acc: 0.550 Test Loss: 77.525 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 13.621974468231201
Epoch: 31, Steps: 70 | Train Loss: 3.087 Vali Loss: 19.628 Vali Acc: 0.510 Test Loss: 19.628 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 13.202829837799072
Epoch: 32, Steps: 70 | Train Loss: 4.678 Vali Loss: 74.775 Vali Acc: 0.480 Test Loss: 74.775 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 15.065269947052002
Epoch: 33, Steps: 70 | Train Loss: 2.461 Vali Loss: 61.498 Vali Acc: 0.520 Test Loss: 61.498 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 15.137228012084961
Epoch: 34, Steps: 70 | Train Loss: 1.327 Vali Loss: 79.887 Vali Acc: 0.390 Test Loss: 79.887 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 13.68182897567749
Epoch: 35, Steps: 70 | Train Loss: 0.163 Vali Loss: 44.786 Vali Acc: 0.480 Test Loss: 44.786 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7239706
model size : 30.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.775834798812866
Epoch: 1, Steps: 70 | Train Loss: 33.637 Vali Loss: 47.366 Vali Acc: 0.510 Test Loss: 47.366 Test Acc: 0.510
Validation loss decreased (inf --> -0.509526).  Saving model ...
Epoch: 2 cost time: 15.122838258743286
Epoch: 2, Steps: 70 | Train Loss: 50.665 Vali Loss: 58.063 Vali Acc: 0.500 Test Loss: 58.063 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.907885313034058
Epoch: 3, Steps: 70 | Train Loss: 61.907 Vali Loss: 5.520 Vali Acc: 0.570 Test Loss: 5.520 Test Acc: 0.570
Validation loss decreased (-0.509526 --> -0.569945).  Saving model ...
Epoch: 4 cost time: 15.02858567237854
Epoch: 4, Steps: 70 | Train Loss: 17.187 Vali Loss: 8.227 Vali Acc: 0.500 Test Loss: 8.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.04887318611145
Epoch: 5, Steps: 70 | Train Loss: 15.302 Vali Loss: 2.174 Vali Acc: 0.470 Test Loss: 2.174 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.312720775604248
Epoch: 6, Steps: 70 | Train Loss: 7.173 Vali Loss: 8.234 Vali Acc: 0.510 Test Loss: 8.234 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.671020269393921
Epoch: 7, Steps: 70 | Train Loss: 12.028 Vali Loss: 2.080 Vali Acc: 0.520 Test Loss: 2.080 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.377573728561401
Epoch: 8, Steps: 70 | Train Loss: 9.988 Vali Loss: 32.651 Vali Acc: 0.500 Test Loss: 32.651 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.142143964767456
Epoch: 9, Steps: 70 | Train Loss: 14.051 Vali Loss: 6.198 Vali Acc: 0.430 Test Loss: 6.198 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.927894353866577
Epoch: 10, Steps: 70 | Train Loss: 14.475 Vali Loss: 9.634 Vali Acc: 0.500 Test Loss: 9.634 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.78879189491272
Epoch: 11, Steps: 70 | Train Loss: 6.759 Vali Loss: 3.692 Vali Acc: 0.570 Test Loss: 3.692 Test Acc: 0.570
Validation loss decreased (-0.569945 --> -0.569963).  Saving model ...
Epoch: 12 cost time: 15.436147689819336
Epoch: 12, Steps: 70 | Train Loss: 14.969 Vali Loss: 20.202 Vali Acc: 0.500 Test Loss: 20.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.055899858474731
Epoch: 13, Steps: 70 | Train Loss: 7.230 Vali Loss: 35.303 Vali Acc: 0.500 Test Loss: 35.303 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.54648208618164
Epoch: 14, Steps: 70 | Train Loss: 17.033 Vali Loss: 15.669 Vali Acc: 0.500 Test Loss: 15.669 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.740689754486084
Epoch: 15, Steps: 70 | Train Loss: 22.262 Vali Loss: 28.263 Vali Acc: 0.510 Test Loss: 28.263 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.179640293121338
Epoch: 16, Steps: 70 | Train Loss: 9.728 Vali Loss: 8.531 Vali Acc: 0.590 Test Loss: 8.531 Test Acc: 0.590
Validation loss decreased (-0.569963 --> -0.589915).  Saving model ...
Epoch: 17 cost time: 14.911209344863892
Epoch: 17, Steps: 70 | Train Loss: 4.831 Vali Loss: 37.618 Vali Acc: 0.510 Test Loss: 37.618 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.022742748260498
Epoch: 18, Steps: 70 | Train Loss: 13.138 Vali Loss: 107.686 Vali Acc: 0.500 Test Loss: 107.686 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.49686050415039
Epoch: 19, Steps: 70 | Train Loss: 9.270 Vali Loss: 53.210 Vali Acc: 0.500 Test Loss: 53.210 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.501419305801392
Epoch: 20, Steps: 70 | Train Loss: 2.900 Vali Loss: 28.357 Vali Acc: 0.490 Test Loss: 28.357 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 14.840912103652954
Epoch: 21, Steps: 70 | Train Loss: 1.839 Vali Loss: 63.076 Vali Acc: 0.510 Test Loss: 63.076 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 14.141714572906494
Epoch: 22, Steps: 70 | Train Loss: 0.991 Vali Loss: 43.181 Vali Acc: 0.520 Test Loss: 43.181 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.373949766159058
Epoch: 23, Steps: 70 | Train Loss: 4.670 Vali Loss: 92.918 Vali Acc: 0.430 Test Loss: 92.918 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.887854099273682
Epoch: 24, Steps: 70 | Train Loss: 1.836 Vali Loss: 40.188 Vali Acc: 0.570 Test Loss: 40.188 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 14.951975107192993
Epoch: 25, Steps: 70 | Train Loss: 1.959 Vali Loss: 77.299 Vali Acc: 0.470 Test Loss: 77.299 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.749189853668213
Epoch: 26, Steps: 70 | Train Loss: 0.422 Vali Loss: 25.647 Vali Acc: 0.600 Test Loss: 25.647 Test Acc: 0.600
Validation loss decreased (-0.589915 --> -0.599744).  Saving model ...
Epoch: 27 cost time: 14.787856578826904
Epoch: 27, Steps: 70 | Train Loss: 0.000 Vali Loss: 31.826 Vali Acc: 0.570 Test Loss: 31.826 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 14.791059255599976
Epoch: 28, Steps: 70 | Train Loss: 1.182 Vali Loss: 38.010 Vali Acc: 0.570 Test Loss: 38.010 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.735949277877808
Epoch: 29, Steps: 70 | Train Loss: 1.253 Vali Loss: 138.788 Vali Acc: 0.460 Test Loss: 138.788 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 14.323472499847412
Epoch: 30, Steps: 70 | Train Loss: 4.292 Vali Loss: 54.093 Vali Acc: 0.480 Test Loss: 54.093 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 14.842212200164795
Epoch: 31, Steps: 70 | Train Loss: 3.982 Vali Loss: 89.190 Vali Acc: 0.470 Test Loss: 89.190 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 14.017261505126953
Epoch: 32, Steps: 70 | Train Loss: 1.232 Vali Loss: 79.329 Vali Acc: 0.490 Test Loss: 79.329 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 13.499658107757568
Epoch: 33, Steps: 70 | Train Loss: 0.762 Vali Loss: 81.174 Vali Acc: 0.480 Test Loss: 81.174 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 14.775444984436035
Epoch: 34, Steps: 70 | Train Loss: 1.775 Vali Loss: 88.813 Vali Acc: 0.430 Test Loss: 88.813 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 14.84125542640686
Epoch: 35, Steps: 70 | Train Loss: 1.157 Vali Loss: 22.846 Vali Acc: 0.460 Test Loss: 22.846 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 12.566612482070923
Epoch: 36, Steps: 70 | Train Loss: 0.393 Vali Loss: 40.511 Vali Acc: 0.520 Test Loss: 40.511 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 7207706
model size : 30.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.372419595718384
Epoch: 1, Steps: 70 | Train Loss: 25.218 Vali Loss: 14.643 Vali Acc: 0.500 Test Loss: 14.643 Test Acc: 0.500
Validation loss decreased (inf --> -0.499854).  Saving model ...
Epoch: 2 cost time: 12.142382383346558
Epoch: 2, Steps: 70 | Train Loss: 49.369 Vali Loss: 72.303 Vali Acc: 0.500 Test Loss: 72.303 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.373769998550415
Epoch: 3, Steps: 70 | Train Loss: 24.295 Vali Loss: 15.057 Vali Acc: 0.500 Test Loss: 15.057 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.506304502487183
Epoch: 4, Steps: 70 | Train Loss: 24.296 Vali Loss: 15.305 Vali Acc: 0.500 Test Loss: 15.305 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.80970287322998
Epoch: 5, Steps: 70 | Train Loss: 12.528 Vali Loss: 20.949 Vali Acc: 0.500 Test Loss: 20.949 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.685805320739746
Epoch: 6, Steps: 70 | Train Loss: 13.917 Vali Loss: 2.471 Vali Acc: 0.480 Test Loss: 2.471 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.59745478630066
Epoch: 7, Steps: 70 | Train Loss: 22.042 Vali Loss: 7.549 Vali Acc: 0.500 Test Loss: 7.549 Test Acc: 0.500
Validation loss decreased (-0.499854 --> -0.499925).  Saving model ...
Epoch: 8 cost time: 14.512634515762329
Epoch: 8, Steps: 70 | Train Loss: 13.880 Vali Loss: 26.305 Vali Acc: 0.500 Test Loss: 26.305 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.075268030166626
Epoch: 9, Steps: 70 | Train Loss: 12.619 Vali Loss: 13.833 Vali Acc: 0.500 Test Loss: 13.833 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.708967208862305
Epoch: 10, Steps: 70 | Train Loss: 12.426 Vali Loss: 13.850 Vali Acc: 0.500 Test Loss: 13.850 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.518994092941284
Epoch: 11, Steps: 70 | Train Loss: 31.744 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
Validation loss decreased (-0.499925 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 12.18250298500061
Epoch: 12, Steps: 70 | Train Loss: 15.892 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.384653091430664
Epoch: 13, Steps: 70 | Train Loss: 15.989 Vali Loss: 2.169 Vali Acc: 0.500 Test Loss: 2.169 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.662763595581055
Epoch: 14, Steps: 70 | Train Loss: 10.477 Vali Loss: 22.232 Vali Acc: 0.500 Test Loss: 22.232 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.902215480804443
Epoch: 15, Steps: 70 | Train Loss: 16.946 Vali Loss: 19.566 Vali Acc: 0.500 Test Loss: 19.566 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.832307577133179
Epoch: 16, Steps: 70 | Train Loss: 10.418 Vali Loss: 9.951 Vali Acc: 0.550 Test Loss: 9.951 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549900).  Saving model ...
Epoch: 17 cost time: 14.902364015579224
Epoch: 17, Steps: 70 | Train Loss: 14.052 Vali Loss: 18.820 Vali Acc: 0.500 Test Loss: 18.820 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.724146842956543
Epoch: 18, Steps: 70 | Train Loss: 11.301 Vali Loss: 11.734 Vali Acc: 0.480 Test Loss: 11.734 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.345325708389282
Epoch: 19, Steps: 70 | Train Loss: 9.445 Vali Loss: 42.890 Vali Acc: 0.500 Test Loss: 42.890 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.742386102676392
Epoch: 20, Steps: 70 | Train Loss: 9.177 Vali Loss: 17.614 Vali Acc: 0.580 Test Loss: 17.614 Test Acc: 0.580
Validation loss decreased (-0.549900 --> -0.579824).  Saving model ...
Epoch: 21 cost time: 14.715898275375366
Epoch: 21, Steps: 70 | Train Loss: 5.416 Vali Loss: 17.302 Vali Acc: 0.560 Test Loss: 17.302 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.31769347190857
Epoch: 22, Steps: 70 | Train Loss: 4.265 Vali Loss: 12.268 Vali Acc: 0.560 Test Loss: 12.268 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 14.487512111663818
Epoch: 23, Steps: 70 | Train Loss: 4.207 Vali Loss: 30.700 Vali Acc: 0.510 Test Loss: 30.700 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.571792602539062
Epoch: 24, Steps: 70 | Train Loss: 2.873 Vali Loss: 31.380 Vali Acc: 0.510 Test Loss: 31.380 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 13.68518877029419
Epoch: 25, Steps: 70 | Train Loss: 3.048 Vali Loss: 17.118 Vali Acc: 0.500 Test Loss: 17.118 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 13.359663009643555
Epoch: 26, Steps: 70 | Train Loss: 2.525 Vali Loss: 24.675 Vali Acc: 0.400 Test Loss: 24.675 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.568085432052612
Epoch: 27, Steps: 70 | Train Loss: 1.715 Vali Loss: 27.500 Vali Acc: 0.460 Test Loss: 27.500 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.583348989486694
Epoch: 28, Steps: 70 | Train Loss: 0.520 Vali Loss: 42.194 Vali Acc: 0.420 Test Loss: 42.194 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.25865364074707
Epoch: 29, Steps: 70 | Train Loss: 1.177 Vali Loss: 54.309 Vali Acc: 0.560 Test Loss: 54.309 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.60071849822998
Epoch: 30, Steps: 70 | Train Loss: 0.388 Vali Loss: 64.561 Vali Acc: 0.550 Test Loss: 64.561 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7175706
model size : 29.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.10766077041626
Epoch: 1, Steps: 70 | Train Loss: 13.471 Vali Loss: 22.638 Vali Acc: 0.510 Test Loss: 22.638 Test Acc: 0.510
Validation loss decreased (inf --> -0.509774).  Saving model ...
Epoch: 2 cost time: 14.604779481887817
Epoch: 2, Steps: 70 | Train Loss: 44.305 Vali Loss: 115.759 Vali Acc: 0.500 Test Loss: 115.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.731532573699951
Epoch: 3, Steps: 70 | Train Loss: 48.017 Vali Loss: 47.524 Vali Acc: 0.500 Test Loss: 47.524 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.1529221534729
Epoch: 4, Steps: 70 | Train Loss: 16.774 Vali Loss: 23.404 Vali Acc: 0.500 Test Loss: 23.404 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.668139696121216
Epoch: 5, Steps: 70 | Train Loss: 15.607 Vali Loss: 20.365 Vali Acc: 0.500 Test Loss: 20.365 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.749904870986938
Epoch: 6, Steps: 70 | Train Loss: 16.022 Vali Loss: 16.136 Vali Acc: 0.500 Test Loss: 16.136 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.53371548652649
Epoch: 7, Steps: 70 | Train Loss: 16.847 Vali Loss: 5.253 Vali Acc: 0.500 Test Loss: 5.253 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.334752559661865
Epoch: 8, Steps: 70 | Train Loss: 25.439 Vali Loss: 51.997 Vali Acc: 0.500 Test Loss: 51.997 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.471878290176392
Epoch: 9, Steps: 70 | Train Loss: 13.185 Vali Loss: 1.978 Vali Acc: 0.390 Test Loss: 1.978 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.738958835601807
Epoch: 10, Steps: 70 | Train Loss: 13.113 Vali Loss: 5.888 Vali Acc: 0.500 Test Loss: 5.888 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.784489393234253
Epoch: 11, Steps: 70 | Train Loss: 12.674 Vali Loss: 48.032 Vali Acc: 0.500 Test Loss: 48.032 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 7173018
model size : 29.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.995583534240723
Epoch: 1, Steps: 70 | Train Loss: 23.397 Vali Loss: 14.012 Vali Acc: 0.420 Test Loss: 14.012 Test Acc: 0.420
Validation loss decreased (inf --> -0.419860).  Saving model ...
Epoch: 2 cost time: 13.492546558380127
Epoch: 2, Steps: 70 | Train Loss: 39.564 Vali Loss: 87.331 Vali Acc: 0.500 Test Loss: 87.331 Test Acc: 0.500
Validation loss decreased (-0.419860 --> -0.499127).  Saving model ...
Epoch: 3 cost time: 14.638165712356567
Epoch: 3, Steps: 70 | Train Loss: 57.649 Vali Loss: 59.930 Vali Acc: 0.500 Test Loss: 59.930 Test Acc: 0.500
Validation loss decreased (-0.499127 --> -0.499401).  Saving model ...
Epoch: 4 cost time: 14.090256452560425
Epoch: 4, Steps: 70 | Train Loss: 74.412 Vali Loss: 64.240 Vali Acc: 0.500 Test Loss: 64.240 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.06221079826355
Epoch: 5, Steps: 70 | Train Loss: 30.850 Vali Loss: 4.911 Vali Acc: 0.450 Test Loss: 4.911 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.565160989761353
Epoch: 6, Steps: 70 | Train Loss: 13.923 Vali Loss: 10.444 Vali Acc: 0.500 Test Loss: 10.444 Test Acc: 0.500
Validation loss decreased (-0.499401 --> -0.499896).  Saving model ...
Epoch: 7 cost time: 14.630956888198853
Epoch: 7, Steps: 70 | Train Loss: 33.481 Vali Loss: 23.031 Vali Acc: 0.500 Test Loss: 23.031 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.160591840744019
Epoch: 8, Steps: 70 | Train Loss: 19.018 Vali Loss: 8.926 Vali Acc: 0.500 Test Loss: 8.926 Test Acc: 0.500
Validation loss decreased (-0.499896 --> -0.499911).  Saving model ...
Epoch: 9 cost time: 14.679168939590454
Epoch: 9, Steps: 70 | Train Loss: 14.010 Vali Loss: 55.023 Vali Acc: 0.500 Test Loss: 55.023 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.675029039382935
Epoch: 10, Steps: 70 | Train Loss: 19.086 Vali Loss: 34.703 Vali Acc: 0.500 Test Loss: 34.703 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.070556879043579
Epoch: 11, Steps: 70 | Train Loss: 18.779 Vali Loss: 53.146 Vali Acc: 0.500 Test Loss: 53.146 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.493589162826538
Epoch: 12, Steps: 70 | Train Loss: 22.817 Vali Loss: 11.073 Vali Acc: 0.540 Test Loss: 11.073 Test Acc: 0.540
Validation loss decreased (-0.499911 --> -0.539889).  Saving model ...
Epoch: 13 cost time: 14.622109174728394
Epoch: 13, Steps: 70 | Train Loss: 10.267 Vali Loss: 24.144 Vali Acc: 0.570 Test Loss: 24.144 Test Acc: 0.570
Validation loss decreased (-0.539889 --> -0.569759).  Saving model ...
Epoch: 14 cost time: 14.067144870758057
Epoch: 14, Steps: 70 | Train Loss: 5.171 Vali Loss: 32.689 Vali Acc: 0.530 Test Loss: 32.689 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.248945951461792
Epoch: 15, Steps: 70 | Train Loss: 6.568 Vali Loss: 26.008 Vali Acc: 0.450 Test Loss: 26.008 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.413354635238647
Epoch: 16, Steps: 70 | Train Loss: 5.692 Vali Loss: 26.149 Vali Acc: 0.480 Test Loss: 26.149 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.514050245285034
Epoch: 17, Steps: 70 | Train Loss: 6.594 Vali Loss: 32.537 Vali Acc: 0.550 Test Loss: 32.537 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.799951553344727
Epoch: 18, Steps: 70 | Train Loss: 6.907 Vali Loss: 59.093 Vali Acc: 0.510 Test Loss: 59.093 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.136915445327759
Epoch: 19, Steps: 70 | Train Loss: 3.314 Vali Loss: 16.182 Vali Acc: 0.540 Test Loss: 16.182 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.454647302627563
Epoch: 20, Steps: 70 | Train Loss: 4.781 Vali Loss: 62.894 Vali Acc: 0.460 Test Loss: 62.894 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.671719074249268
Epoch: 21, Steps: 70 | Train Loss: 4.811 Vali Loss: 92.984 Vali Acc: 0.470 Test Loss: 92.984 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.698497533798218
Epoch: 22, Steps: 70 | Train Loss: 3.701 Vali Loss: 27.916 Vali Acc: 0.580 Test Loss: 27.916 Test Acc: 0.580
Validation loss decreased (-0.569759 --> -0.579721).  Saving model ...
Epoch: 23 cost time: 14.41716980934143
Epoch: 23, Steps: 70 | Train Loss: 1.785 Vali Loss: 70.194 Vali Acc: 0.510 Test Loss: 70.194 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 14.593854188919067
Epoch: 24, Steps: 70 | Train Loss: 3.394 Vali Loss: 130.567 Vali Acc: 0.510 Test Loss: 130.567 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.076657056808472
Epoch: 25, Steps: 70 | Train Loss: 3.728 Vali Loss: 47.628 Vali Acc: 0.500 Test Loss: 47.628 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.370768547058105
Epoch: 26, Steps: 70 | Train Loss: 2.690 Vali Loss: 28.013 Vali Acc: 0.500 Test Loss: 28.013 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.052081108093262
Epoch: 27, Steps: 70 | Train Loss: 1.662 Vali Loss: 14.132 Vali Acc: 0.520 Test Loss: 14.132 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 13.8099844455719
Epoch: 28, Steps: 70 | Train Loss: 1.608 Vali Loss: 108.815 Vali Acc: 0.550 Test Loss: 108.815 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.30622124671936
Epoch: 29, Steps: 70 | Train Loss: 0.592 Vali Loss: 133.592 Vali Acc: 0.440 Test Loss: 133.592 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 13.101919651031494
Epoch: 30, Steps: 70 | Train Loss: 2.030 Vali Loss: 60.306 Vali Acc: 0.500 Test Loss: 60.306 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 13.770031452178955
Epoch: 31, Steps: 70 | Train Loss: 0.847 Vali Loss: 49.175 Vali Acc: 0.470 Test Loss: 49.175 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 11.652441024780273
Epoch: 32, Steps: 70 | Train Loss: 1.437 Vali Loss: 36.907 Vali Acc: 0.490 Test Loss: 36.907 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7141018
model size : 29.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.630902290344238
Epoch: 1, Steps: 70 | Train Loss: 17.670 Vali Loss: 24.379 Vali Acc: 0.500 Test Loss: 24.379 Test Acc: 0.500
Validation loss decreased (inf --> -0.499756).  Saving model ...
Epoch: 2 cost time: 12.592482328414917
Epoch: 2, Steps: 70 | Train Loss: 30.316 Vali Loss: 127.300 Vali Acc: 0.500 Test Loss: 127.300 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.67697811126709
Epoch: 3, Steps: 70 | Train Loss: 55.797 Vali Loss: 102.196 Vali Acc: 0.500 Test Loss: 102.196 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.231750011444092
Epoch: 4, Steps: 70 | Train Loss: 55.592 Vali Loss: 18.851 Vali Acc: 0.490 Test Loss: 18.851 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.977400302886963
Epoch: 5, Steps: 70 | Train Loss: 21.602 Vali Loss: 21.404 Vali Acc: 0.500 Test Loss: 21.404 Test Acc: 0.500
Validation loss decreased (-0.499756 --> -0.499786).  Saving model ...
Epoch: 6 cost time: 13.807771444320679
Epoch: 6, Steps: 70 | Train Loss: 9.822 Vali Loss: 5.411 Vali Acc: 0.500 Test Loss: 5.411 Test Acc: 0.500
Validation loss decreased (-0.499786 --> -0.499946).  Saving model ...
Epoch: 7 cost time: 11.354640483856201
Epoch: 7, Steps: 70 | Train Loss: 11.272 Vali Loss: 30.079 Vali Acc: 0.500 Test Loss: 30.079 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.883083820343018
Epoch: 8, Steps: 70 | Train Loss: 14.706 Vali Loss: 23.026 Vali Acc: 0.500 Test Loss: 23.026 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.908966064453125
Epoch: 9, Steps: 70 | Train Loss: 19.304 Vali Loss: 12.803 Vali Acc: 0.500 Test Loss: 12.803 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.51574182510376
Epoch: 10, Steps: 70 | Train Loss: 24.042 Vali Loss: 32.742 Vali Acc: 0.500 Test Loss: 32.742 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.816409587860107
Epoch: 11, Steps: 70 | Train Loss: 14.487 Vali Loss: 43.120 Vali Acc: 0.500 Test Loss: 43.120 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.693890571594238
Epoch: 12, Steps: 70 | Train Loss: 15.986 Vali Loss: 4.061 Vali Acc: 0.460 Test Loss: 4.061 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.26850438117981
Epoch: 13, Steps: 70 | Train Loss: 13.478 Vali Loss: 13.925 Vali Acc: 0.500 Test Loss: 13.925 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.844229221343994
Epoch: 14, Steps: 70 | Train Loss: 7.411 Vali Loss: 25.157 Vali Acc: 0.500 Test Loss: 25.157 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.586161375045776
Epoch: 15, Steps: 70 | Train Loss: 9.511 Vali Loss: 24.767 Vali Acc: 0.500 Test Loss: 24.767 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.335979461669922
Epoch: 16, Steps: 70 | Train Loss: 7.592 Vali Loss: 14.060 Vali Acc: 0.430 Test Loss: 14.060 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 7109018
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.597252368927002
Epoch: 1, Steps: 70 | Train Loss: 25.318 Vali Loss: 17.379 Vali Acc: 0.530 Test Loss: 17.379 Test Acc: 0.530
Validation loss decreased (inf --> -0.529826).  Saving model ...
Epoch: 2 cost time: 13.289026975631714
Epoch: 2, Steps: 70 | Train Loss: 33.854 Vali Loss: 38.997 Vali Acc: 0.500 Test Loss: 38.997 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.606822490692139
Epoch: 3, Steps: 70 | Train Loss: 28.700 Vali Loss: 3.987 Vali Acc: 0.490 Test Loss: 3.987 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.714571714401245
Epoch: 4, Steps: 70 | Train Loss: 15.470 Vali Loss: 31.057 Vali Acc: 0.500 Test Loss: 31.057 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.355459928512573
Epoch: 5, Steps: 70 | Train Loss: 15.044 Vali Loss: 12.812 Vali Acc: 0.500 Test Loss: 12.812 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.397385358810425
Epoch: 6, Steps: 70 | Train Loss: 9.724 Vali Loss: 18.790 Vali Acc: 0.500 Test Loss: 18.790 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.27079725265503
Epoch: 7, Steps: 70 | Train Loss: 13.468 Vali Loss: 9.740 Vali Acc: 0.500 Test Loss: 9.740 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.419792890548706
Epoch: 8, Steps: 70 | Train Loss: 8.446 Vali Loss: 3.252 Vali Acc: 0.500 Test Loss: 3.252 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.100355625152588
Epoch: 9, Steps: 70 | Train Loss: 20.476 Vali Loss: 46.452 Vali Acc: 0.500 Test Loss: 46.452 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.326470375061035
Epoch: 10, Steps: 70 | Train Loss: 20.124 Vali Loss: 22.634 Vali Acc: 0.500 Test Loss: 22.634 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.363600969314575
Epoch: 11, Steps: 70 | Train Loss: 18.613 Vali Loss: 9.822 Vali Acc: 0.510 Test Loss: 9.822 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 7077018
model size : 29.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.471930503845215
Epoch: 1, Steps: 70 | Train Loss: 14.964 Vali Loss: 24.898 Vali Acc: 0.510 Test Loss: 24.898 Test Acc: 0.510
Validation loss decreased (inf --> -0.509751).  Saving model ...
Epoch: 2 cost time: 10.515873432159424
Epoch: 2, Steps: 70 | Train Loss: 16.667 Vali Loss: 10.710 Vali Acc: 0.400 Test Loss: 10.710 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.752067565917969
Epoch: 3, Steps: 70 | Train Loss: 15.759 Vali Loss: 8.016 Vali Acc: 0.520 Test Loss: 8.016 Test Acc: 0.520
Validation loss decreased (-0.509751 --> -0.519920).  Saving model ...
Epoch: 4 cost time: 7.704918384552002
Epoch: 4, Steps: 70 | Train Loss: 15.924 Vali Loss: 7.409 Vali Acc: 0.450 Test Loss: 7.409 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.647184133529663
Epoch: 5, Steps: 70 | Train Loss: 18.673 Vali Loss: 5.043 Vali Acc: 0.490 Test Loss: 5.043 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.005679607391357
Epoch: 6, Steps: 70 | Train Loss: 14.051 Vali Loss: 11.441 Vali Acc: 0.500 Test Loss: 11.441 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.846508979797363
Epoch: 7, Steps: 70 | Train Loss: 6.000 Vali Loss: 18.170 Vali Acc: 0.500 Test Loss: 18.170 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.852843284606934
Epoch: 8, Steps: 70 | Train Loss: 10.228 Vali Loss: 24.006 Vali Acc: 0.500 Test Loss: 24.006 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.821464538574219
Epoch: 9, Steps: 70 | Train Loss: 9.395 Vali Loss: 9.401 Vali Acc: 0.570 Test Loss: 9.401 Test Acc: 0.570
Validation loss decreased (-0.519920 --> -0.569906).  Saving model ...
Epoch: 10 cost time: 11.18657374382019
Epoch: 10, Steps: 70 | Train Loss: 9.953 Vali Loss: 19.593 Vali Acc: 0.500 Test Loss: 19.593 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.162065982818604
Epoch: 11, Steps: 70 | Train Loss: 3.163 Vali Loss: 7.762 Vali Acc: 0.510 Test Loss: 7.762 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.780135869979858
Epoch: 12, Steps: 70 | Train Loss: 4.757 Vali Loss: 21.512 Vali Acc: 0.500 Test Loss: 21.512 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.442397594451904
Epoch: 13, Steps: 70 | Train Loss: 13.451 Vali Loss: 19.682 Vali Acc: 0.500 Test Loss: 19.682 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.679526805877686
Epoch: 14, Steps: 70 | Train Loss: 8.037 Vali Loss: 37.782 Vali Acc: 0.490 Test Loss: 37.782 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.898982048034668
Epoch: 15, Steps: 70 | Train Loss: 8.695 Vali Loss: 51.166 Vali Acc: 0.520 Test Loss: 51.166 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.820971250534058
Epoch: 16, Steps: 70 | Train Loss: 7.615 Vali Loss: 17.981 Vali Acc: 0.530 Test Loss: 17.981 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.058840274810791
Epoch: 17, Steps: 70 | Train Loss: 5.489 Vali Loss: 26.980 Vali Acc: 0.540 Test Loss: 26.980 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.729407548904419
Epoch: 18, Steps: 70 | Train Loss: 3.661 Vali Loss: 22.078 Vali Acc: 0.500 Test Loss: 22.078 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.801929473876953
Epoch: 19, Steps: 70 | Train Loss: 4.095 Vali Loss: 16.146 Vali Acc: 0.500 Test Loss: 16.146 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3736858
model size : 15.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.641974210739136
Epoch: 1, Steps: 70 | Train Loss: 14.253 Vali Loss: 26.715 Vali Acc: 0.500 Test Loss: 26.715 Test Acc: 0.500
Validation loss decreased (inf --> -0.499733).  Saving model ...
Epoch: 2 cost time: 11.370848655700684
Epoch: 2, Steps: 70 | Train Loss: 18.478 Vali Loss: 23.413 Vali Acc: 0.450 Test Loss: 23.413 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.554993629455566
Epoch: 3, Steps: 70 | Train Loss: 42.231 Vali Loss: 102.852 Vali Acc: 0.500 Test Loss: 102.852 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.502640724182129
Epoch: 4, Steps: 70 | Train Loss: 51.039 Vali Loss: 55.703 Vali Acc: 0.490 Test Loss: 55.703 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.379035472869873
Epoch: 5, Steps: 70 | Train Loss: 20.208 Vali Loss: 23.848 Vali Acc: 0.560 Test Loss: 23.848 Test Acc: 0.560
Validation loss decreased (-0.499733 --> -0.559762).  Saving model ...
Epoch: 6 cost time: 11.50507140159607
Epoch: 6, Steps: 70 | Train Loss: 28.562 Vali Loss: 66.075 Vali Acc: 0.500 Test Loss: 66.075 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.316654920578003
Epoch: 7, Steps: 70 | Train Loss: 15.860 Vali Loss: 27.821 Vali Acc: 0.450 Test Loss: 27.821 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.75559663772583
Epoch: 8, Steps: 70 | Train Loss: 20.477 Vali Loss: 33.199 Vali Acc: 0.500 Test Loss: 33.199 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.450582027435303
Epoch: 9, Steps: 70 | Train Loss: 15.020 Vali Loss: 20.107 Vali Acc: 0.530 Test Loss: 20.107 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.667354345321655
Epoch: 10, Steps: 70 | Train Loss: 4.128 Vali Loss: 9.876 Vali Acc: 0.610 Test Loss: 9.876 Test Acc: 0.610
Validation loss decreased (-0.559762 --> -0.609901).  Saving model ...
Epoch: 11 cost time: 11.52108383178711
Epoch: 11, Steps: 70 | Train Loss: 7.107 Vali Loss: 76.973 Vali Acc: 0.500 Test Loss: 76.973 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.222403764724731
Epoch: 12, Steps: 70 | Train Loss: 13.010 Vali Loss: 27.130 Vali Acc: 0.580 Test Loss: 27.130 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.432349920272827
Epoch: 13, Steps: 70 | Train Loss: 7.509 Vali Loss: 45.247 Vali Acc: 0.520 Test Loss: 45.247 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.389488935470581
Epoch: 14, Steps: 70 | Train Loss: 7.133 Vali Loss: 56.618 Vali Acc: 0.490 Test Loss: 56.618 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.096628189086914
Epoch: 15, Steps: 70 | Train Loss: 2.268 Vali Loss: 48.231 Vali Acc: 0.480 Test Loss: 48.231 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.742362976074219
Epoch: 16, Steps: 70 | Train Loss: 6.013 Vali Loss: 56.899 Vali Acc: 0.480 Test Loss: 56.899 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.344935178756714
Epoch: 17, Steps: 70 | Train Loss: 2.456 Vali Loss: 41.330 Vali Acc: 0.500 Test Loss: 41.330 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.667686223983765
Epoch: 18, Steps: 70 | Train Loss: 1.383 Vali Loss: 43.518 Vali Acc: 0.450 Test Loss: 43.518 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.689884901046753
Epoch: 19, Steps: 70 | Train Loss: 2.111 Vali Loss: 74.344 Vali Acc: 0.510 Test Loss: 74.344 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.625934600830078
Epoch: 20, Steps: 70 | Train Loss: 2.031 Vali Loss: 44.989 Vali Acc: 0.430 Test Loss: 44.989 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3720858
model size : 15.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.111249208450317
Epoch: 1, Steps: 70 | Train Loss: 15.113 Vali Loss: 35.648 Vali Acc: 0.500 Test Loss: 35.648 Test Acc: 0.500
Validation loss decreased (inf --> -0.499644).  Saving model ...
Epoch: 2 cost time: 12.255013465881348
Epoch: 2, Steps: 70 | Train Loss: 20.776 Vali Loss: 16.512 Vali Acc: 0.490 Test Loss: 16.512 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.16952395439148
Epoch: 3, Steps: 70 | Train Loss: 15.263 Vali Loss: 112.811 Vali Acc: 0.500 Test Loss: 112.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.988329648971558
Epoch: 4, Steps: 70 | Train Loss: 62.798 Vali Loss: 10.010 Vali Acc: 0.610 Test Loss: 10.010 Test Acc: 0.610
Validation loss decreased (-0.499644 --> -0.609900).  Saving model ...
Epoch: 5 cost time: 10.417470932006836
Epoch: 5, Steps: 70 | Train Loss: 20.241 Vali Loss: 30.071 Vali Acc: 0.500 Test Loss: 30.071 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.215064525604248
Epoch: 6, Steps: 70 | Train Loss: 17.953 Vali Loss: 29.736 Vali Acc: 0.500 Test Loss: 29.736 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.227748155593872
Epoch: 7, Steps: 70 | Train Loss: 16.178 Vali Loss: 3.838 Vali Acc: 0.590 Test Loss: 3.838 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.037558317184448
Epoch: 8, Steps: 70 | Train Loss: 7.700 Vali Loss: 14.265 Vali Acc: 0.520 Test Loss: 14.265 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.288429021835327
Epoch: 9, Steps: 70 | Train Loss: 11.487 Vali Loss: 11.270 Vali Acc: 0.520 Test Loss: 11.270 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.394657850265503
Epoch: 10, Steps: 70 | Train Loss: 15.352 Vali Loss: 19.066 Vali Acc: 0.460 Test Loss: 19.066 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.52462387084961
Epoch: 11, Steps: 70 | Train Loss: 7.866 Vali Loss: 6.970 Vali Acc: 0.570 Test Loss: 6.970 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.323307752609253
Epoch: 12, Steps: 70 | Train Loss: 11.774 Vali Loss: 36.920 Vali Acc: 0.490 Test Loss: 36.920 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.444379329681396
Epoch: 13, Steps: 70 | Train Loss: 17.251 Vali Loss: 54.309 Vali Acc: 0.500 Test Loss: 54.309 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.39863657951355
Epoch: 14, Steps: 70 | Train Loss: 8.938 Vali Loss: 14.977 Vali Acc: 0.550 Test Loss: 14.977 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3704858
model size : 15.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.670214414596558
Epoch: 1, Steps: 70 | Train Loss: 12.132 Vali Loss: 22.792 Vali Acc: 0.490 Test Loss: 22.792 Test Acc: 0.490
Validation loss decreased (inf --> -0.489772).  Saving model ...
Epoch: 2 cost time: 10.215305805206299
Epoch: 2, Steps: 70 | Train Loss: 14.753 Vali Loss: 18.830 Vali Acc: 0.500 Test Loss: 18.830 Test Acc: 0.500
Validation loss decreased (-0.489772 --> -0.499812).  Saving model ...
Epoch: 3 cost time: 11.801836252212524
Epoch: 3, Steps: 70 | Train Loss: 25.326 Vali Loss: 63.350 Vali Acc: 0.500 Test Loss: 63.350 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.778942346572876
Epoch: 4, Steps: 70 | Train Loss: 23.104 Vali Loss: 5.759 Vali Acc: 0.500 Test Loss: 5.759 Test Acc: 0.500
Validation loss decreased (-0.499812 --> -0.499942).  Saving model ...
Epoch: 5 cost time: 11.747181177139282
Epoch: 5, Steps: 70 | Train Loss: 10.106 Vali Loss: 22.649 Vali Acc: 0.500 Test Loss: 22.649 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.952385425567627
Epoch: 6, Steps: 70 | Train Loss: 13.546 Vali Loss: 2.852 Vali Acc: 0.510 Test Loss: 2.852 Test Acc: 0.510
Validation loss decreased (-0.499942 --> -0.509971).  Saving model ...
Epoch: 7 cost time: 11.828048706054688
Epoch: 7, Steps: 70 | Train Loss: 6.419 Vali Loss: 11.394 Vali Acc: 0.500 Test Loss: 11.394 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.923016548156738
Epoch: 8, Steps: 70 | Train Loss: 12.678 Vali Loss: 40.036 Vali Acc: 0.500 Test Loss: 40.036 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.802359342575073
Epoch: 9, Steps: 70 | Train Loss: 7.182 Vali Loss: 8.027 Vali Acc: 0.540 Test Loss: 8.027 Test Acc: 0.540
Validation loss decreased (-0.509971 --> -0.539920).  Saving model ...
Epoch: 10 cost time: 9.929731607437134
Epoch: 10, Steps: 70 | Train Loss: 10.456 Vali Loss: 8.518 Vali Acc: 0.520 Test Loss: 8.518 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.87882113456726
Epoch: 11, Steps: 70 | Train Loss: 13.986 Vali Loss: 24.921 Vali Acc: 0.420 Test Loss: 24.921 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.824317455291748
Epoch: 12, Steps: 70 | Train Loss: 6.663 Vali Loss: 6.259 Vali Acc: 0.590 Test Loss: 6.259 Test Acc: 0.590
Validation loss decreased (-0.539920 --> -0.589937).  Saving model ...
Epoch: 13 cost time: 11.849218130111694
Epoch: 13, Steps: 70 | Train Loss: 6.118 Vali Loss: 22.526 Vali Acc: 0.430 Test Loss: 22.526 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.848127841949463
Epoch: 14, Steps: 70 | Train Loss: 6.440 Vali Loss: 8.664 Vali Acc: 0.540 Test Loss: 8.664 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.970595836639404
Epoch: 15, Steps: 70 | Train Loss: 6.620 Vali Loss: 57.536 Vali Acc: 0.500 Test Loss: 57.536 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.93299651145935
Epoch: 16, Steps: 70 | Train Loss: 4.809 Vali Loss: 36.849 Vali Acc: 0.540 Test Loss: 36.849 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.735972881317139
Epoch: 17, Steps: 70 | Train Loss: 8.431 Vali Loss: 17.924 Vali Acc: 0.530 Test Loss: 17.924 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.674371719360352
Epoch: 18, Steps: 70 | Train Loss: 2.972 Vali Loss: 31.716 Vali Acc: 0.490 Test Loss: 31.716 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.864969253540039
Epoch: 19, Steps: 70 | Train Loss: 2.423 Vali Loss: 17.946 Vali Acc: 0.570 Test Loss: 17.946 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.325157880783081
Epoch: 20, Steps: 70 | Train Loss: 1.600 Vali Loss: 21.613 Vali Acc: 0.510 Test Loss: 21.613 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.691135883331299
Epoch: 21, Steps: 70 | Train Loss: 1.269 Vali Loss: 31.689 Vali Acc: 0.480 Test Loss: 31.689 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.817630052566528
Epoch: 22, Steps: 70 | Train Loss: 3.794 Vali Loss: 62.315 Vali Acc: 0.510 Test Loss: 62.315 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3688858
model size : 15.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.594191312789917
Epoch: 1, Steps: 70 | Train Loss: 13.461 Vali Loss: 26.961 Vali Acc: 0.500 Test Loss: 26.961 Test Acc: 0.500
Validation loss decreased (inf --> -0.499730).  Saving model ...
Epoch: 2 cost time: 11.871465921401978
Epoch: 2, Steps: 70 | Train Loss: 15.615 Vali Loss: 27.742 Vali Acc: 0.500 Test Loss: 27.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.759726524353027
Epoch: 3, Steps: 70 | Train Loss: 31.009 Vali Loss: 102.568 Vali Acc: 0.500 Test Loss: 102.568 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.776249170303345
Epoch: 4, Steps: 70 | Train Loss: 35.328 Vali Loss: 8.639 Vali Acc: 0.510 Test Loss: 8.639 Test Acc: 0.510
Validation loss decreased (-0.499730 --> -0.509914).  Saving model ...
Epoch: 5 cost time: 12.062469959259033
Epoch: 5, Steps: 70 | Train Loss: 14.593 Vali Loss: 18.869 Vali Acc: 0.500 Test Loss: 18.869 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.948872089385986
Epoch: 6, Steps: 70 | Train Loss: 9.798 Vali Loss: 8.317 Vali Acc: 0.500 Test Loss: 8.317 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.941455841064453
Epoch: 7, Steps: 70 | Train Loss: 10.178 Vali Loss: 70.032 Vali Acc: 0.500 Test Loss: 70.032 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.055743217468262
Epoch: 8, Steps: 70 | Train Loss: 16.738 Vali Loss: 17.271 Vali Acc: 0.510 Test Loss: 17.271 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.04335355758667
Epoch: 9, Steps: 70 | Train Loss: 14.188 Vali Loss: 23.825 Vali Acc: 0.500 Test Loss: 23.825 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.029776573181152
Epoch: 10, Steps: 70 | Train Loss: 6.825 Vali Loss: 6.128 Vali Acc: 0.460 Test Loss: 6.128 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.025048017501831
Epoch: 11, Steps: 70 | Train Loss: 7.174 Vali Loss: 37.205 Vali Acc: 0.470 Test Loss: 37.205 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.064038276672363
Epoch: 12, Steps: 70 | Train Loss: 10.321 Vali Loss: 38.854 Vali Acc: 0.500 Test Loss: 38.854 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.307878494262695
Epoch: 13, Steps: 70 | Train Loss: 4.436 Vali Loss: 17.142 Vali Acc: 0.510 Test Loss: 17.142 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.977786540985107
Epoch: 14, Steps: 70 | Train Loss: 3.452 Vali Loss: 33.657 Vali Acc: 0.500 Test Loss: 33.657 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 3538714
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.54152774810791
Epoch: 1, Steps: 70 | Train Loss: 16.284 Vali Loss: 14.189 Vali Acc: 0.560 Test Loss: 14.189 Test Acc: 0.560
Validation loss decreased (inf --> -0.559858).  Saving model ...
Epoch: 2 cost time: 11.6769278049469
Epoch: 2, Steps: 70 | Train Loss: 34.606 Vali Loss: 77.026 Vali Acc: 0.500 Test Loss: 77.026 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.841611862182617
Epoch: 3, Steps: 70 | Train Loss: 27.935 Vali Loss: 8.093 Vali Acc: 0.540 Test Loss: 8.093 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.902243852615356
Epoch: 4, Steps: 70 | Train Loss: 38.819 Vali Loss: 48.706 Vali Acc: 0.500 Test Loss: 48.706 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.753254890441895
Epoch: 5, Steps: 70 | Train Loss: 20.477 Vali Loss: 13.343 Vali Acc: 0.500 Test Loss: 13.343 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.113263845443726
Epoch: 6, Steps: 70 | Train Loss: 5.799 Vali Loss: 2.815 Vali Acc: 0.480 Test Loss: 2.815 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.827386856079102
Epoch: 7, Steps: 70 | Train Loss: 6.860 Vali Loss: 4.079 Vali Acc: 0.490 Test Loss: 4.079 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.851771831512451
Epoch: 8, Steps: 70 | Train Loss: 11.296 Vali Loss: 23.813 Vali Acc: 0.500 Test Loss: 23.813 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.528504371643066
Epoch: 9, Steps: 70 | Train Loss: 7.988 Vali Loss: 4.373 Vali Acc: 0.470 Test Loss: 4.373 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.209738969802856
Epoch: 10, Steps: 70 | Train Loss: 6.881 Vali Loss: 27.431 Vali Acc: 0.500 Test Loss: 27.431 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.936184883117676
Epoch: 11, Steps: 70 | Train Loss: 8.114 Vali Loss: 35.133 Vali Acc: 0.500 Test Loss: 35.133 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3522714
model size : 14.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.590898275375366
Epoch: 1, Steps: 70 | Train Loss: 27.038 Vali Loss: 61.758 Vali Acc: 0.510 Test Loss: 61.758 Test Acc: 0.510
Validation loss decreased (inf --> -0.509382).  Saving model ...
Epoch: 2 cost time: 10.643482208251953
Epoch: 2, Steps: 70 | Train Loss: 50.866 Vali Loss: 23.930 Vali Acc: 0.440 Test Loss: 23.930 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.702342510223389
Epoch: 3, Steps: 70 | Train Loss: 30.403 Vali Loss: 45.710 Vali Acc: 0.510 Test Loss: 45.710 Test Acc: 0.510
Validation loss decreased (-0.509382 --> -0.509543).  Saving model ...
Epoch: 4 cost time: 11.612343788146973
Epoch: 4, Steps: 70 | Train Loss: 50.322 Vali Loss: 58.560 Vali Acc: 0.500 Test Loss: 58.560 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.67044734954834
Epoch: 5, Steps: 70 | Train Loss: 36.169 Vali Loss: 52.312 Vali Acc: 0.470 Test Loss: 52.312 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.644990921020508
Epoch: 6, Steps: 70 | Train Loss: 27.047 Vali Loss: 19.491 Vali Acc: 0.500 Test Loss: 19.491 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.813774585723877
Epoch: 7, Steps: 70 | Train Loss: 24.290 Vali Loss: 44.603 Vali Acc: 0.500 Test Loss: 44.603 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.677441358566284
Epoch: 8, Steps: 70 | Train Loss: 21.820 Vali Loss: 26.973 Vali Acc: 0.520 Test Loss: 26.973 Test Acc: 0.520
Validation loss decreased (-0.509543 --> -0.519730).  Saving model ...
Epoch: 9 cost time: 11.711345911026001
Epoch: 9, Steps: 70 | Train Loss: 15.738 Vali Loss: 34.541 Vali Acc: 0.500 Test Loss: 34.541 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.637336254119873
Epoch: 10, Steps: 70 | Train Loss: 14.733 Vali Loss: 17.551 Vali Acc: 0.550 Test Loss: 17.551 Test Acc: 0.550
Validation loss decreased (-0.519730 --> -0.549824).  Saving model ...
Epoch: 11 cost time: 11.194319486618042
Epoch: 11, Steps: 70 | Train Loss: 6.576 Vali Loss: 30.416 Vali Acc: 0.530 Test Loss: 30.416 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.745859384536743
Epoch: 12, Steps: 70 | Train Loss: 9.237 Vali Loss: 20.516 Vali Acc: 0.550 Test Loss: 20.516 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.54582953453064
Epoch: 13, Steps: 70 | Train Loss: 3.918 Vali Loss: 25.159 Vali Acc: 0.520 Test Loss: 25.159 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.300949335098267
Epoch: 14, Steps: 70 | Train Loss: 5.533 Vali Loss: 7.658 Vali Acc: 0.520 Test Loss: 7.658 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.165960311889648
Epoch: 15, Steps: 70 | Train Loss: 8.413 Vali Loss: 61.941 Vali Acc: 0.500 Test Loss: 61.941 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.689101934432983
Epoch: 16, Steps: 70 | Train Loss: 3.652 Vali Loss: 17.025 Vali Acc: 0.550 Test Loss: 17.025 Test Acc: 0.550
Validation loss decreased (-0.549824 --> -0.549830).  Saving model ...
Epoch: 17 cost time: 11.614742279052734
Epoch: 17, Steps: 70 | Train Loss: 3.638 Vali Loss: 27.049 Vali Acc: 0.550 Test Loss: 27.049 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.63500714302063
Epoch: 18, Steps: 70 | Train Loss: 2.289 Vali Loss: 17.842 Vali Acc: 0.560 Test Loss: 17.842 Test Acc: 0.560
Validation loss decreased (-0.549830 --> -0.559822).  Saving model ...
Epoch: 19 cost time: 9.645164012908936
Epoch: 19, Steps: 70 | Train Loss: 1.352 Vali Loss: 39.505 Vali Acc: 0.490 Test Loss: 39.505 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.628681421279907
Epoch: 20, Steps: 70 | Train Loss: 1.379 Vali Loss: 16.755 Vali Acc: 0.600 Test Loss: 16.755 Test Acc: 0.600
Validation loss decreased (-0.559822 --> -0.599832).  Saving model ...
Epoch: 21 cost time: 11.713099241256714
Epoch: 21, Steps: 70 | Train Loss: 1.181 Vali Loss: 33.594 Vali Acc: 0.540 Test Loss: 33.594 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.62726378440857
Epoch: 22, Steps: 70 | Train Loss: 2.361 Vali Loss: 33.345 Vali Acc: 0.610 Test Loss: 33.345 Test Acc: 0.610
Validation loss decreased (-0.599832 --> -0.609667).  Saving model ...
Epoch: 23 cost time: 9.835224866867065
Epoch: 23, Steps: 70 | Train Loss: 5.840 Vali Loss: 57.032 Vali Acc: 0.520 Test Loss: 57.032 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.384640216827393
Epoch: 24, Steps: 70 | Train Loss: 2.137 Vali Loss: 24.019 Vali Acc: 0.540 Test Loss: 24.019 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.679111003875732
Epoch: 25, Steps: 70 | Train Loss: 0.739 Vali Loss: 23.606 Vali Acc: 0.530 Test Loss: 23.606 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.733607530593872
Epoch: 26, Steps: 70 | Train Loss: 0.844 Vali Loss: 30.725 Vali Acc: 0.570 Test Loss: 30.725 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.857287883758545
Epoch: 27, Steps: 70 | Train Loss: 0.505 Vali Loss: 21.388 Vali Acc: 0.590 Test Loss: 21.388 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.601539373397827
Epoch: 28, Steps: 70 | Train Loss: 0.417 Vali Loss: 27.818 Vali Acc: 0.610 Test Loss: 27.818 Test Acc: 0.610
Validation loss decreased (-0.609667 --> -0.609722).  Saving model ...
Epoch: 29 cost time: 11.760819911956787
Epoch: 29, Steps: 70 | Train Loss: 1.407 Vali Loss: 43.602 Vali Acc: 0.550 Test Loss: 43.602 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 11.679297924041748
Epoch: 30, Steps: 70 | Train Loss: 0.947 Vali Loss: 37.282 Vali Acc: 0.520 Test Loss: 37.282 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 11.818283796310425
Epoch: 31, Steps: 70 | Train Loss: 1.116 Vali Loss: 42.713 Vali Acc: 0.530 Test Loss: 42.713 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 9.82230806350708
Epoch: 32, Steps: 70 | Train Loss: 1.320 Vali Loss: 65.831 Vali Acc: 0.450 Test Loss: 65.831 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 11.672248125076294
Epoch: 33, Steps: 70 | Train Loss: 1.292 Vali Loss: 43.008 Vali Acc: 0.480 Test Loss: 43.008 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 11.78202486038208
Epoch: 34, Steps: 70 | Train Loss: 1.109 Vali Loss: 41.645 Vali Acc: 0.530 Test Loss: 41.645 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 11.73354697227478
Epoch: 35, Steps: 70 | Train Loss: 0.607 Vali Loss: 36.540 Vali Acc: 0.570 Test Loss: 36.540 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 9.914669036865234
Epoch: 36, Steps: 70 | Train Loss: 1.040 Vali Loss: 24.697 Vali Acc: 0.520 Test Loss: 24.697 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 10.916964054107666
Epoch: 37, Steps: 70 | Train Loss: 0.713 Vali Loss: 43.766 Vali Acc: 0.520 Test Loss: 43.766 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 11.776390552520752
Epoch: 38, Steps: 70 | Train Loss: 0.352 Vali Loss: 39.336 Vali Acc: 0.460 Test Loss: 39.336 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3506714
model size : 14.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.457712411880493
Epoch: 1, Steps: 70 | Train Loss: 10.159 Vali Loss: 40.773 Vali Acc: 0.510 Test Loss: 40.773 Test Acc: 0.510
Validation loss decreased (inf --> -0.509592).  Saving model ...
Epoch: 2 cost time: 11.2222580909729
Epoch: 2, Steps: 70 | Train Loss: 20.614 Vali Loss: 18.187 Vali Acc: 0.500 Test Loss: 18.187 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.213696479797363
Epoch: 3, Steps: 70 | Train Loss: 16.091 Vali Loss: 21.675 Vali Acc: 0.500 Test Loss: 21.675 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.396484375
Epoch: 4, Steps: 70 | Train Loss: 8.767 Vali Loss: 24.714 Vali Acc: 0.500 Test Loss: 24.714 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.906068325042725
Epoch: 5, Steps: 70 | Train Loss: 9.377 Vali Loss: 1.042 Vali Acc: 0.510 Test Loss: 1.042 Test Acc: 0.510
Validation loss decreased (-0.509592 --> -0.509990).  Saving model ...
Epoch: 6 cost time: 9.475547552108765
Epoch: 6, Steps: 70 | Train Loss: 10.958 Vali Loss: 2.968 Vali Acc: 0.500 Test Loss: 2.968 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.966787576675415
Epoch: 7, Steps: 70 | Train Loss: 7.065 Vali Loss: 2.294 Vali Acc: 0.500 Test Loss: 2.294 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.561103343963623
Epoch: 8, Steps: 70 | Train Loss: 8.527 Vali Loss: 27.232 Vali Acc: 0.500 Test Loss: 27.232 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.155203104019165
Epoch: 9, Steps: 70 | Train Loss: 7.970 Vali Loss: 7.687 Vali Acc: 0.500 Test Loss: 7.687 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.124113082885742
Epoch: 10, Steps: 70 | Train Loss: 8.965 Vali Loss: 3.230 Vali Acc: 0.500 Test Loss: 3.230 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.185959577560425
Epoch: 11, Steps: 70 | Train Loss: 8.189 Vali Loss: 4.995 Vali Acc: 0.430 Test Loss: 4.995 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.10415244102478
Epoch: 12, Steps: 70 | Train Loss: 5.924 Vali Loss: 10.509 Vali Acc: 0.500 Test Loss: 10.509 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.252800703048706
Epoch: 13, Steps: 70 | Train Loss: 5.044 Vali Loss: 11.111 Vali Acc: 0.420 Test Loss: 11.111 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.124600172042847
Epoch: 14, Steps: 70 | Train Loss: 3.282 Vali Loss: 21.122 Vali Acc: 0.510 Test Loss: 21.122 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.361700296401978
Epoch: 15, Steps: 70 | Train Loss: 9.867 Vali Loss: 10.232 Vali Acc: 0.540 Test Loss: 10.232 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539898).  Saving model ...
Epoch: 16 cost time: 11.181630849838257
Epoch: 16, Steps: 70 | Train Loss: 3.957 Vali Loss: 16.513 Vali Acc: 0.480 Test Loss: 16.513 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.295023679733276
Epoch: 17, Steps: 70 | Train Loss: 5.696 Vali Loss: 16.037 Vali Acc: 0.470 Test Loss: 16.037 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.256639003753662
Epoch: 18, Steps: 70 | Train Loss: 2.339 Vali Loss: 11.918 Vali Acc: 0.550 Test Loss: 11.918 Test Acc: 0.550
Validation loss decreased (-0.539898 --> -0.549881).  Saving model ...
Epoch: 19 cost time: 9.911103963851929
Epoch: 19, Steps: 70 | Train Loss: 2.120 Vali Loss: 9.648 Vali Acc: 0.490 Test Loss: 9.648 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.279264450073242
Epoch: 20, Steps: 70 | Train Loss: 2.852 Vali Loss: 7.875 Vali Acc: 0.590 Test Loss: 7.875 Test Acc: 0.590
Validation loss decreased (-0.549881 --> -0.589921).  Saving model ...
Epoch: 21 cost time: 11.178005933761597
Epoch: 21, Steps: 70 | Train Loss: 1.790 Vali Loss: 15.923 Vali Acc: 0.570 Test Loss: 15.923 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.303404092788696
Epoch: 22, Steps: 70 | Train Loss: 1.011 Vali Loss: 34.771 Vali Acc: 0.480 Test Loss: 34.771 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.477192163467407
Epoch: 23, Steps: 70 | Train Loss: 2.152 Vali Loss: 5.983 Vali Acc: 0.540 Test Loss: 5.983 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.323237657546997
Epoch: 24, Steps: 70 | Train Loss: 8.274 Vali Loss: 42.422 Vali Acc: 0.500 Test Loss: 42.422 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.189165353775024
Epoch: 25, Steps: 70 | Train Loss: 0.730 Vali Loss: 53.512 Vali Acc: 0.530 Test Loss: 53.512 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.351802825927734
Epoch: 26, Steps: 70 | Train Loss: 1.068 Vali Loss: 27.475 Vali Acc: 0.450 Test Loss: 27.475 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.265472650527954
Epoch: 27, Steps: 70 | Train Loss: 0.420 Vali Loss: 22.548 Vali Acc: 0.480 Test Loss: 22.548 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.173202514648438
Epoch: 28, Steps: 70 | Train Loss: 0.583 Vali Loss: 34.715 Vali Acc: 0.520 Test Loss: 34.715 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.563061475753784
Epoch: 29, Steps: 70 | Train Loss: 1.681 Vali Loss: 44.312 Vali Acc: 0.540 Test Loss: 44.312 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.424205541610718
Epoch: 30, Steps: 70 | Train Loss: 1.569 Vali Loss: 39.929 Vali Acc: 0.530 Test Loss: 39.929 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3490714
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.524292230606079
Epoch: 1, Steps: 70 | Train Loss: 17.722 Vali Loss: 11.723 Vali Acc: 0.550 Test Loss: 11.723 Test Acc: 0.550
Validation loss decreased (inf --> -0.549883).  Saving model ...
Epoch: 2 cost time: 9.109488725662231
Epoch: 2, Steps: 70 | Train Loss: 28.282 Vali Loss: 50.199 Vali Acc: 0.500 Test Loss: 50.199 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.131550312042236
Epoch: 3, Steps: 70 | Train Loss: 34.849 Vali Loss: 144.415 Vali Acc: 0.500 Test Loss: 144.415 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.096100807189941
Epoch: 4, Steps: 70 | Train Loss: 46.660 Vali Loss: 73.206 Vali Acc: 0.500 Test Loss: 73.206 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.929985284805298
Epoch: 5, Steps: 70 | Train Loss: 29.431 Vali Loss: 41.580 Vali Acc: 0.500 Test Loss: 41.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.233587265014648
Epoch: 6, Steps: 70 | Train Loss: 34.289 Vali Loss: 13.367 Vali Acc: 0.500 Test Loss: 13.367 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.156324625015259
Epoch: 7, Steps: 70 | Train Loss: 18.423 Vali Loss: 7.144 Vali Acc: 0.550 Test Loss: 7.144 Test Acc: 0.550
Validation loss decreased (-0.549883 --> -0.549929).  Saving model ...
Epoch: 8 cost time: 11.07401180267334
Epoch: 8, Steps: 70 | Train Loss: 28.409 Vali Loss: 6.546 Vali Acc: 0.520 Test Loss: 6.546 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.149396419525146
Epoch: 9, Steps: 70 | Train Loss: 4.970 Vali Loss: 36.805 Vali Acc: 0.510 Test Loss: 36.805 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.913925409317017
Epoch: 10, Steps: 70 | Train Loss: 8.690 Vali Loss: 34.033 Vali Acc: 0.500 Test Loss: 34.033 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.141360521316528
Epoch: 11, Steps: 70 | Train Loss: 8.968 Vali Loss: 13.850 Vali Acc: 0.520 Test Loss: 13.850 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.069588661193848
Epoch: 12, Steps: 70 | Train Loss: 6.340 Vali Loss: 10.125 Vali Acc: 0.480 Test Loss: 10.125 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.207857847213745
Epoch: 13, Steps: 70 | Train Loss: 5.363 Vali Loss: 11.370 Vali Acc: 0.530 Test Loss: 11.370 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.079373121261597
Epoch: 14, Steps: 70 | Train Loss: 6.406 Vali Loss: 22.273 Vali Acc: 0.590 Test Loss: 22.273 Test Acc: 0.590
Validation loss decreased (-0.549929 --> -0.589777).  Saving model ...
Epoch: 15 cost time: 11.14881682395935
Epoch: 15, Steps: 70 | Train Loss: 4.099 Vali Loss: 20.097 Vali Acc: 0.530 Test Loss: 20.097 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.04080319404602
Epoch: 16, Steps: 70 | Train Loss: 5.592 Vali Loss: 31.253 Vali Acc: 0.510 Test Loss: 31.253 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.566527843475342
Epoch: 17, Steps: 70 | Train Loss: 5.666 Vali Loss: 50.612 Vali Acc: 0.420 Test Loss: 50.612 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.15458059310913
Epoch: 18, Steps: 70 | Train Loss: 3.783 Vali Loss: 69.691 Vali Acc: 0.450 Test Loss: 69.691 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.024299144744873
Epoch: 19, Steps: 70 | Train Loss: 3.704 Vali Loss: 23.365 Vali Acc: 0.500 Test Loss: 23.365 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.426212072372437
Epoch: 20, Steps: 70 | Train Loss: 3.573 Vali Loss: 36.786 Vali Acc: 0.470 Test Loss: 36.786 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.078139066696167
Epoch: 21, Steps: 70 | Train Loss: 4.319 Vali Loss: 15.645 Vali Acc: 0.560 Test Loss: 15.645 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.075724601745605
Epoch: 22, Steps: 70 | Train Loss: 1.742 Vali Loss: 41.934 Vali Acc: 0.420 Test Loss: 41.934 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.086873292922974
Epoch: 23, Steps: 70 | Train Loss: 2.049 Vali Loss: 36.159 Vali Acc: 0.450 Test Loss: 36.159 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.1062753200531
Epoch: 24, Steps: 70 | Train Loss: 3.315 Vali Loss: 30.776 Vali Acc: 0.510 Test Loss: 30.776 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3439642
model size : 14.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.30889105796814
Epoch: 1, Steps: 70 | Train Loss: 8.533 Vali Loss: 14.635 Vali Acc: 0.510 Test Loss: 14.635 Test Acc: 0.510
Validation loss decreased (inf --> -0.509854).  Saving model ...
Epoch: 2 cost time: 8.989450454711914
Epoch: 2, Steps: 70 | Train Loss: 22.231 Vali Loss: 35.671 Vali Acc: 0.500 Test Loss: 35.671 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.607829093933105
Epoch: 3, Steps: 70 | Train Loss: 22.213 Vali Loss: 37.202 Vali Acc: 0.500 Test Loss: 37.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.202162504196167
Epoch: 4, Steps: 70 | Train Loss: 25.401 Vali Loss: 25.164 Vali Acc: 0.500 Test Loss: 25.164 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.265565633773804
Epoch: 5, Steps: 70 | Train Loss: 12.111 Vali Loss: 80.580 Vali Acc: 0.500 Test Loss: 80.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.185415744781494
Epoch: 6, Steps: 70 | Train Loss: 15.777 Vali Loss: 7.561 Vali Acc: 0.500 Test Loss: 7.561 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.21146035194397
Epoch: 7, Steps: 70 | Train Loss: 6.066 Vali Loss: 37.482 Vali Acc: 0.500 Test Loss: 37.482 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.202061653137207
Epoch: 8, Steps: 70 | Train Loss: 8.632 Vali Loss: 11.044 Vali Acc: 0.500 Test Loss: 11.044 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.10739803314209
Epoch: 9, Steps: 70 | Train Loss: 8.643 Vali Loss: 8.098 Vali Acc: 0.510 Test Loss: 8.098 Test Acc: 0.510
Validation loss decreased (-0.509854 --> -0.509919).  Saving model ...
Epoch: 10 cost time: 10.018309593200684
Epoch: 10, Steps: 70 | Train Loss: 4.647 Vali Loss: 13.046 Vali Acc: 0.510 Test Loss: 13.046 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.238287210464478
Epoch: 11, Steps: 70 | Train Loss: 10.053 Vali Loss: 27.780 Vali Acc: 0.530 Test Loss: 27.780 Test Acc: 0.530
Validation loss decreased (-0.509919 --> -0.529722).  Saving model ...
Epoch: 12 cost time: 11.232341289520264
Epoch: 12, Steps: 70 | Train Loss: 4.542 Vali Loss: 7.320 Vali Acc: 0.510 Test Loss: 7.320 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.329649448394775
Epoch: 13, Steps: 70 | Train Loss: 5.354 Vali Loss: 18.479 Vali Acc: 0.520 Test Loss: 18.479 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.378669023513794
Epoch: 14, Steps: 70 | Train Loss: 4.957 Vali Loss: 5.086 Vali Acc: 0.560 Test Loss: 5.086 Test Acc: 0.560
Validation loss decreased (-0.529722 --> -0.559949).  Saving model ...
Epoch: 15 cost time: 11.102456092834473
Epoch: 15, Steps: 70 | Train Loss: 5.932 Vali Loss: 8.622 Vali Acc: 0.580 Test Loss: 8.622 Test Acc: 0.580
Validation loss decreased (-0.559949 --> -0.579914).  Saving model ...
Epoch: 16 cost time: 10.241752862930298
Epoch: 16, Steps: 70 | Train Loss: 4.003 Vali Loss: 8.960 Vali Acc: 0.560 Test Loss: 8.960 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.362719297409058
Epoch: 17, Steps: 70 | Train Loss: 2.956 Vali Loss: 34.756 Vali Acc: 0.510 Test Loss: 34.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.031471490859985
Epoch: 18, Steps: 70 | Train Loss: 2.223 Vali Loss: 26.754 Vali Acc: 0.470 Test Loss: 26.754 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.05039119720459
Epoch: 19, Steps: 70 | Train Loss: 1.853 Vali Loss: 18.533 Vali Acc: 0.550 Test Loss: 18.533 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.609142303466797
Epoch: 20, Steps: 70 | Train Loss: 1.407 Vali Loss: 24.999 Vali Acc: 0.540 Test Loss: 24.999 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.295741319656372
Epoch: 21, Steps: 70 | Train Loss: 1.341 Vali Loss: 39.233 Vali Acc: 0.460 Test Loss: 39.233 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.995029211044312
Epoch: 22, Steps: 70 | Train Loss: 1.685 Vali Loss: 17.491 Vali Acc: 0.500 Test Loss: 17.491 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.03493618965149
Epoch: 23, Steps: 70 | Train Loss: 1.056 Vali Loss: 31.326 Vali Acc: 0.440 Test Loss: 31.326 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.166884660720825
Epoch: 24, Steps: 70 | Train Loss: 1.937 Vali Loss: 22.727 Vali Acc: 0.490 Test Loss: 22.727 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.105683088302612
Epoch: 25, Steps: 70 | Train Loss: 2.068 Vali Loss: 17.663 Vali Acc: 0.540 Test Loss: 17.663 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3423642
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.053017616271973
Epoch: 1, Steps: 70 | Train Loss: 13.202 Vali Loss: 14.375 Vali Acc: 0.500 Test Loss: 14.375 Test Acc: 0.500
Validation loss decreased (inf --> -0.499856).  Saving model ...
Epoch: 2 cost time: 10.850854396820068
Epoch: 2, Steps: 70 | Train Loss: 16.771 Vali Loss: 78.887 Vali Acc: 0.500 Test Loss: 78.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.881097555160522
Epoch: 3, Steps: 70 | Train Loss: 30.118 Vali Loss: 69.051 Vali Acc: 0.500 Test Loss: 69.051 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.573795318603516
Epoch: 4, Steps: 70 | Train Loss: 41.533 Vali Loss: 127.936 Vali Acc: 0.500 Test Loss: 127.936 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.009976387023926
Epoch: 5, Steps: 70 | Train Loss: 41.490 Vali Loss: 12.595 Vali Acc: 0.510 Test Loss: 12.595 Test Acc: 0.510
Validation loss decreased (-0.499856 --> -0.509874).  Saving model ...
Epoch: 6 cost time: 10.8514723777771
Epoch: 6, Steps: 70 | Train Loss: 12.046 Vali Loss: 4.708 Vali Acc: 0.430 Test Loss: 4.708 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.934180498123169
Epoch: 7, Steps: 70 | Train Loss: 10.076 Vali Loss: 6.240 Vali Acc: 0.530 Test Loss: 6.240 Test Acc: 0.530
Validation loss decreased (-0.509874 --> -0.529938).  Saving model ...
Epoch: 8 cost time: 9.976025104522705
Epoch: 8, Steps: 70 | Train Loss: 8.292 Vali Loss: 23.663 Vali Acc: 0.500 Test Loss: 23.663 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.420583486557007
Epoch: 9, Steps: 70 | Train Loss: 10.589 Vali Loss: 21.423 Vali Acc: 0.500 Test Loss: 21.423 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.01926064491272
Epoch: 10, Steps: 70 | Train Loss: 9.549 Vali Loss: 15.978 Vali Acc: 0.540 Test Loss: 15.978 Test Acc: 0.540
Validation loss decreased (-0.529938 --> -0.539840).  Saving model ...
Epoch: 11 cost time: 10.855486154556274
Epoch: 11, Steps: 70 | Train Loss: 18.936 Vali Loss: 24.033 Vali Acc: 0.500 Test Loss: 24.033 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.325004577636719
Epoch: 12, Steps: 70 | Train Loss: 8.524 Vali Loss: 35.147 Vali Acc: 0.500 Test Loss: 35.147 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.213376760482788
Epoch: 13, Steps: 70 | Train Loss: 6.373 Vali Loss: 41.424 Vali Acc: 0.510 Test Loss: 41.424 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.78413200378418
Epoch: 14, Steps: 70 | Train Loss: 10.460 Vali Loss: 50.874 Vali Acc: 0.500 Test Loss: 50.874 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.476886749267578
Epoch: 15, Steps: 70 | Train Loss: 11.727 Vali Loss: 29.208 Vali Acc: 0.400 Test Loss: 29.208 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.426777124404907
Epoch: 16, Steps: 70 | Train Loss: 3.548 Vali Loss: 10.657 Vali Acc: 0.510 Test Loss: 10.657 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.038158893585205
Epoch: 17, Steps: 70 | Train Loss: 4.282 Vali Loss: 40.184 Vali Acc: 0.520 Test Loss: 40.184 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.951719999313354
Epoch: 18, Steps: 70 | Train Loss: 9.771 Vali Loss: 25.728 Vali Acc: 0.480 Test Loss: 25.728 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.414459943771362
Epoch: 19, Steps: 70 | Train Loss: 2.510 Vali Loss: 47.034 Vali Acc: 0.410 Test Loss: 47.034 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.392633438110352
Epoch: 20, Steps: 70 | Train Loss: 2.700 Vali Loss: 24.829 Vali Acc: 0.460 Test Loss: 24.829 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 3407642
model size : 14.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.174368381500244
Epoch: 1, Steps: 70 | Train Loss: 17.336 Vali Loss: 24.045 Vali Acc: 0.470 Test Loss: 24.045 Test Acc: 0.470
Validation loss decreased (inf --> -0.469760).  Saving model ...
Epoch: 2 cost time: 8.258028507232666
Epoch: 2, Steps: 70 | Train Loss: 27.105 Vali Loss: 21.201 Vali Acc: 0.500 Test Loss: 21.201 Test Acc: 0.500
Validation loss decreased (-0.469760 --> -0.499788).  Saving model ...
Epoch: 3 cost time: 10.227606058120728
Epoch: 3, Steps: 70 | Train Loss: 32.568 Vali Loss: 24.206 Vali Acc: 0.500 Test Loss: 24.206 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.134297132492065
Epoch: 4, Steps: 70 | Train Loss: 26.003 Vali Loss: 5.504 Vali Acc: 0.500 Test Loss: 5.504 Test Acc: 0.500
Validation loss decreased (-0.499788 --> -0.499945).  Saving model ...
Epoch: 5 cost time: 8.417700052261353
Epoch: 5, Steps: 70 | Train Loss: 16.247 Vali Loss: 17.210 Vali Acc: 0.500 Test Loss: 17.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.542335987091064
Epoch: 6, Steps: 70 | Train Loss: 12.965 Vali Loss: 2.995 Vali Acc: 0.470 Test Loss: 2.995 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.033277750015259
Epoch: 7, Steps: 70 | Train Loss: 11.112 Vali Loss: 1.318 Vali Acc: 0.610 Test Loss: 1.318 Test Acc: 0.610
Validation loss decreased (-0.499945 --> -0.609987).  Saving model ...
Epoch: 8 cost time: 9.295449495315552
Epoch: 8, Steps: 70 | Train Loss: 5.408 Vali Loss: 27.485 Vali Acc: 0.500 Test Loss: 27.485 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.984264373779297
Epoch: 9, Steps: 70 | Train Loss: 5.052 Vali Loss: 15.973 Vali Acc: 0.500 Test Loss: 15.973 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.127703428268433
Epoch: 10, Steps: 70 | Train Loss: 7.343 Vali Loss: 3.345 Vali Acc: 0.550 Test Loss: 3.345 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.053877830505371
Epoch: 11, Steps: 70 | Train Loss: 11.463 Vali Loss: 13.587 Vali Acc: 0.460 Test Loss: 13.587 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.324095964431763
Epoch: 12, Steps: 70 | Train Loss: 9.795 Vali Loss: 24.921 Vali Acc: 0.490 Test Loss: 24.921 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.083501100540161
Epoch: 13, Steps: 70 | Train Loss: 7.319 Vali Loss: 12.324 Vali Acc: 0.540 Test Loss: 12.324 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.005613327026367
Epoch: 14, Steps: 70 | Train Loss: 5.019 Vali Loss: 30.319 Vali Acc: 0.510 Test Loss: 30.319 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.490630865097046
Epoch: 15, Steps: 70 | Train Loss: 4.828 Vali Loss: 18.869 Vali Acc: 0.470 Test Loss: 18.869 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.061854124069214
Epoch: 16, Steps: 70 | Train Loss: 6.912 Vali Loss: 42.044 Vali Acc: 0.480 Test Loss: 42.044 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.21096158027649
Epoch: 17, Steps: 70 | Train Loss: 9.896 Vali Loss: 16.386 Vali Acc: 0.530 Test Loss: 16.386 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3391642
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.253560304641724
Epoch: 1, Steps: 70 | Train Loss: 6.836 Vali Loss: 5.020 Vali Acc: 0.590 Test Loss: 5.020 Test Acc: 0.590
Validation loss decreased (inf --> -0.589950).  Saving model ...
Epoch: 2 cost time: 9.652472019195557
Epoch: 2, Steps: 70 | Train Loss: 44.193 Vali Loss: 46.706 Vali Acc: 0.500 Test Loss: 46.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.558053255081177
Epoch: 3, Steps: 70 | Train Loss: 22.374 Vali Loss: 30.127 Vali Acc: 0.500 Test Loss: 30.127 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.374774932861328
Epoch: 4, Steps: 70 | Train Loss: 40.562 Vali Loss: 14.869 Vali Acc: 0.500 Test Loss: 14.869 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.724865436553955
Epoch: 5, Steps: 70 | Train Loss: 17.341 Vali Loss: 8.307 Vali Acc: 0.500 Test Loss: 8.307 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.009324312210083
Epoch: 6, Steps: 70 | Train Loss: 8.557 Vali Loss: 7.333 Vali Acc: 0.490 Test Loss: 7.333 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.554707527160645
Epoch: 7, Steps: 70 | Train Loss: 6.630 Vali Loss: 6.684 Vali Acc: 0.520 Test Loss: 6.684 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.253959894180298
Epoch: 8, Steps: 70 | Train Loss: 8.123 Vali Loss: 5.534 Vali Acc: 0.430 Test Loss: 5.534 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.633944272994995
Epoch: 9, Steps: 70 | Train Loss: 7.403 Vali Loss: 9.130 Vali Acc: 0.500 Test Loss: 9.130 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.290335178375244
Epoch: 10, Steps: 70 | Train Loss: 7.143 Vali Loss: 18.333 Vali Acc: 0.500 Test Loss: 18.333 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.466167449951172
Epoch: 11, Steps: 70 | Train Loss: 6.217 Vali Loss: 8.480 Vali Acc: 0.540 Test Loss: 8.480 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3390106
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.343173265457153
Epoch: 1, Steps: 70 | Train Loss: 13.636 Vali Loss: 16.825 Vali Acc: 0.480 Test Loss: 16.825 Test Acc: 0.480
Validation loss decreased (inf --> -0.479832).  Saving model ...
Epoch: 2 cost time: 8.960968017578125
Epoch: 2, Steps: 70 | Train Loss: 13.785 Vali Loss: 12.739 Vali Acc: 0.530 Test Loss: 12.739 Test Acc: 0.530
Validation loss decreased (-0.479832 --> -0.529873).  Saving model ...
Epoch: 3 cost time: 10.22896671295166
Epoch: 3, Steps: 70 | Train Loss: 31.390 Vali Loss: 41.492 Vali Acc: 0.490 Test Loss: 41.492 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.527877807617188
Epoch: 4, Steps: 70 | Train Loss: 22.374 Vali Loss: 6.303 Vali Acc: 0.540 Test Loss: 6.303 Test Acc: 0.540
Validation loss decreased (-0.529873 --> -0.539937).  Saving model ...
Epoch: 5 cost time: 8.896791934967041
Epoch: 5, Steps: 70 | Train Loss: 26.398 Vali Loss: 9.173 Vali Acc: 0.510 Test Loss: 9.173 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.082129955291748
Epoch: 6, Steps: 70 | Train Loss: 32.435 Vali Loss: 10.012 Vali Acc: 0.490 Test Loss: 10.012 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.512939453125
Epoch: 7, Steps: 70 | Train Loss: 8.224 Vali Loss: 11.862 Vali Acc: 0.490 Test Loss: 11.862 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.311908483505249
Epoch: 8, Steps: 70 | Train Loss: 12.528 Vali Loss: 28.396 Vali Acc: 0.500 Test Loss: 28.396 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.595057964324951
Epoch: 9, Steps: 70 | Train Loss: 16.839 Vali Loss: 13.235 Vali Acc: 0.510 Test Loss: 13.235 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.359368324279785
Epoch: 10, Steps: 70 | Train Loss: 18.769 Vali Loss: 38.040 Vali Acc: 0.500 Test Loss: 38.040 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.733295679092407
Epoch: 11, Steps: 70 | Train Loss: 6.464 Vali Loss: 17.023 Vali Acc: 0.470 Test Loss: 17.023 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.403159141540527
Epoch: 12, Steps: 70 | Train Loss: 3.705 Vali Loss: 12.514 Vali Acc: 0.540 Test Loss: 12.514 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.213391780853271
Epoch: 13, Steps: 70 | Train Loss: 4.261 Vali Loss: 15.718 Vali Acc: 0.560 Test Loss: 15.718 Test Acc: 0.560
Validation loss decreased (-0.539937 --> -0.559843).  Saving model ...
Epoch: 14 cost time: 10.067225933074951
Epoch: 14, Steps: 70 | Train Loss: 4.324 Vali Loss: 8.113 Vali Acc: 0.500 Test Loss: 8.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.560521125793457
Epoch: 15, Steps: 70 | Train Loss: 4.359 Vali Loss: 31.954 Vali Acc: 0.520 Test Loss: 31.954 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.419800281524658
Epoch: 16, Steps: 70 | Train Loss: 6.188 Vali Loss: 15.242 Vali Acc: 0.500 Test Loss: 15.242 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.494595766067505
Epoch: 17, Steps: 70 | Train Loss: 2.948 Vali Loss: 13.426 Vali Acc: 0.490 Test Loss: 13.426 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.636192798614502
Epoch: 18, Steps: 70 | Train Loss: 3.631 Vali Loss: 28.985 Vali Acc: 0.530 Test Loss: 28.985 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.393291473388672
Epoch: 19, Steps: 70 | Train Loss: 2.861 Vali Loss: 46.468 Vali Acc: 0.460 Test Loss: 46.468 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.407135486602783
Epoch: 20, Steps: 70 | Train Loss: 3.376 Vali Loss: 26.377 Vali Acc: 0.490 Test Loss: 26.377 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.59343957901001
Epoch: 21, Steps: 70 | Train Loss: 4.698 Vali Loss: 26.093 Vali Acc: 0.500 Test Loss: 26.093 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.446661233901978
Epoch: 22, Steps: 70 | Train Loss: 3.606 Vali Loss: 10.398 Vali Acc: 0.500 Test Loss: 10.398 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.451147556304932
Epoch: 23, Steps: 70 | Train Loss: 0.394 Vali Loss: 23.481 Vali Acc: 0.560 Test Loss: 23.481 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3374106
model size : 14.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.152990341186523
Epoch: 1, Steps: 70 | Train Loss: 11.894 Vali Loss: 28.098 Vali Acc: 0.510 Test Loss: 28.098 Test Acc: 0.510
Validation loss decreased (inf --> -0.509719).  Saving model ...
Epoch: 2 cost time: 9.271616458892822
Epoch: 2, Steps: 70 | Train Loss: 27.053 Vali Loss: 36.735 Vali Acc: 0.490 Test Loss: 36.735 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.401192665100098
Epoch: 3, Steps: 70 | Train Loss: 26.775 Vali Loss: 5.733 Vali Acc: 0.450 Test Loss: 5.733 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.238845109939575
Epoch: 4, Steps: 70 | Train Loss: 35.600 Vali Loss: 65.955 Vali Acc: 0.500 Test Loss: 65.955 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.913554191589355
Epoch: 5, Steps: 70 | Train Loss: 24.221 Vali Loss: 58.970 Vali Acc: 0.500 Test Loss: 58.970 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.630481719970703
Epoch: 6, Steps: 70 | Train Loss: 38.547 Vali Loss: 39.468 Vali Acc: 0.500 Test Loss: 39.468 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.104660987854004
Epoch: 7, Steps: 70 | Train Loss: 23.251 Vali Loss: 16.928 Vali Acc: 0.620 Test Loss: 16.928 Test Acc: 0.620
Validation loss decreased (-0.509719 --> -0.619831).  Saving model ...
Epoch: 8 cost time: 10.257414102554321
Epoch: 8, Steps: 70 | Train Loss: 20.240 Vali Loss: 10.929 Vali Acc: 0.490 Test Loss: 10.929 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.655098915100098
Epoch: 9, Steps: 70 | Train Loss: 12.335 Vali Loss: 28.636 Vali Acc: 0.500 Test Loss: 28.636 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.268728256225586
Epoch: 10, Steps: 70 | Train Loss: 5.521 Vali Loss: 25.972 Vali Acc: 0.520 Test Loss: 25.972 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.348525047302246
Epoch: 11, Steps: 70 | Train Loss: 11.323 Vali Loss: 47.801 Vali Acc: 0.430 Test Loss: 47.801 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.441027164459229
Epoch: 12, Steps: 70 | Train Loss: 12.604 Vali Loss: 44.396 Vali Acc: 0.460 Test Loss: 44.396 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.158411264419556
Epoch: 13, Steps: 70 | Train Loss: 5.769 Vali Loss: 20.675 Vali Acc: 0.570 Test Loss: 20.675 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.275628089904785
Epoch: 14, Steps: 70 | Train Loss: 2.126 Vali Loss: 16.657 Vali Acc: 0.530 Test Loss: 16.657 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.24180269241333
Epoch: 15, Steps: 70 | Train Loss: 6.453 Vali Loss: 40.638 Vali Acc: 0.490 Test Loss: 40.638 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.607276439666748
Epoch: 16, Steps: 70 | Train Loss: 3.144 Vali Loss: 52.749 Vali Acc: 0.520 Test Loss: 52.749 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.250679731369019
Epoch: 17, Steps: 70 | Train Loss: 2.875 Vali Loss: 58.197 Vali Acc: 0.430 Test Loss: 58.197 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3358106
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.991927862167358
Epoch: 1, Steps: 70 | Train Loss: 12.629 Vali Loss: 21.427 Vali Acc: 0.480 Test Loss: 21.427 Test Acc: 0.480
Validation loss decreased (inf --> -0.479786).  Saving model ...
Epoch: 2 cost time: 10.003784894943237
Epoch: 2, Steps: 70 | Train Loss: 23.838 Vali Loss: 8.906 Vali Acc: 0.530 Test Loss: 8.906 Test Acc: 0.530
Validation loss decreased (-0.479786 --> -0.529911).  Saving model ...
Epoch: 3 cost time: 8.225884437561035
Epoch: 3, Steps: 70 | Train Loss: 34.134 Vali Loss: 87.315 Vali Acc: 0.510 Test Loss: 87.315 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.173691034317017
Epoch: 4, Steps: 70 | Train Loss: 46.343 Vali Loss: 42.572 Vali Acc: 0.500 Test Loss: 42.572 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.098981380462646
Epoch: 5, Steps: 70 | Train Loss: 38.572 Vali Loss: 15.608 Vali Acc: 0.540 Test Loss: 15.608 Test Acc: 0.540
Validation loss decreased (-0.529911 --> -0.539844).  Saving model ...
Epoch: 6 cost time: 8.359777450561523
Epoch: 6, Steps: 70 | Train Loss: 35.776 Vali Loss: 37.410 Vali Acc: 0.500 Test Loss: 37.410 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.855863332748413
Epoch: 7, Steps: 70 | Train Loss: 31.956 Vali Loss: 93.544 Vali Acc: 0.500 Test Loss: 93.544 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.809470176696777
Epoch: 8, Steps: 70 | Train Loss: 18.964 Vali Loss: 18.553 Vali Acc: 0.480 Test Loss: 18.553 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.267109632492065
Epoch: 9, Steps: 70 | Train Loss: 15.988 Vali Loss: 19.942 Vali Acc: 0.480 Test Loss: 19.942 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.109058380126953
Epoch: 10, Steps: 70 | Train Loss: 10.051 Vali Loss: 28.473 Vali Acc: 0.510 Test Loss: 28.473 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.27683424949646
Epoch: 11, Steps: 70 | Train Loss: 18.746 Vali Loss: 67.891 Vali Acc: 0.500 Test Loss: 67.891 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.022527694702148
Epoch: 12, Steps: 70 | Train Loss: 9.815 Vali Loss: 26.615 Vali Acc: 0.510 Test Loss: 26.615 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.78922724723816
Epoch: 13, Steps: 70 | Train Loss: 5.392 Vali Loss: 34.388 Vali Acc: 0.530 Test Loss: 34.388 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.214158535003662
Epoch: 14, Steps: 70 | Train Loss: 3.253 Vali Loss: 28.986 Vali Acc: 0.480 Test Loss: 28.986 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.082592487335205
Epoch: 15, Steps: 70 | Train Loss: 2.374 Vali Loss: 53.158 Vali Acc: 0.510 Test Loss: 53.158 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 3342106
model size : 14.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.0641348361969
Epoch: 1, Steps: 70 | Train Loss: 8.068 Vali Loss: 12.061 Vali Acc: 0.470 Test Loss: 12.061 Test Acc: 0.470
Validation loss decreased (inf --> -0.469879).  Saving model ...
Epoch: 2 cost time: 8.57743763923645
Epoch: 2, Steps: 70 | Train Loss: 21.623 Vali Loss: 32.476 Vali Acc: 0.500 Test Loss: 32.476 Test Acc: 0.500
Validation loss decreased (-0.469879 --> -0.499675).  Saving model ...
Epoch: 3 cost time: 7.925382137298584
Epoch: 3, Steps: 70 | Train Loss: 27.048 Vali Loss: 30.713 Vali Acc: 0.490 Test Loss: 30.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.97889757156372
Epoch: 4, Steps: 70 | Train Loss: 20.772 Vali Loss: 15.908 Vali Acc: 0.500 Test Loss: 15.908 Test Acc: 0.500
Validation loss decreased (-0.499675 --> -0.499841).  Saving model ...
Epoch: 5 cost time: 7.88494873046875
Epoch: 5, Steps: 70 | Train Loss: 11.041 Vali Loss: 5.686 Vali Acc: 0.560 Test Loss: 5.686 Test Acc: 0.560
Validation loss decreased (-0.499841 --> -0.559943).  Saving model ...
Epoch: 6 cost time: 8.52265477180481
Epoch: 6, Steps: 70 | Train Loss: 17.348 Vali Loss: 18.209 Vali Acc: 0.540 Test Loss: 18.209 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.885234594345093
Epoch: 7, Steps: 70 | Train Loss: 11.948 Vali Loss: 19.646 Vali Acc: 0.510 Test Loss: 19.646 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.532970905303955
Epoch: 8, Steps: 70 | Train Loss: 9.922 Vali Loss: 20.718 Vali Acc: 0.500 Test Loss: 20.718 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.989709377288818
Epoch: 9, Steps: 70 | Train Loss: 5.297 Vali Loss: 39.383 Vali Acc: 0.500 Test Loss: 39.383 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.538976192474365
Epoch: 10, Steps: 70 | Train Loss: 9.729 Vali Loss: 37.815 Vali Acc: 0.510 Test Loss: 37.815 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.8352580070495605
Epoch: 11, Steps: 70 | Train Loss: 4.723 Vali Loss: 9.360 Vali Acc: 0.580 Test Loss: 9.360 Test Acc: 0.580
Validation loss decreased (-0.559943 --> -0.579906).  Saving model ...
Epoch: 12 cost time: 9.00481390953064
Epoch: 12, Steps: 70 | Train Loss: 3.372 Vali Loss: 14.126 Vali Acc: 0.500 Test Loss: 14.126 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.936274290084839
Epoch: 13, Steps: 70 | Train Loss: 1.524 Vali Loss: 20.621 Vali Acc: 0.460 Test Loss: 20.621 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.861260414123535
Epoch: 14, Steps: 70 | Train Loss: 1.454 Vali Loss: 10.895 Vali Acc: 0.510 Test Loss: 10.895 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.963558673858643
Epoch: 15, Steps: 70 | Train Loss: 1.187 Vali Loss: 30.176 Vali Acc: 0.500 Test Loss: 30.176 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.677440166473389
Epoch: 16, Steps: 70 | Train Loss: 1.988 Vali Loss: 16.027 Vali Acc: 0.520 Test Loss: 16.027 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.936463117599487
Epoch: 17, Steps: 70 | Train Loss: 0.451 Vali Loss: 12.245 Vali Acc: 0.500 Test Loss: 12.245 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.476778268814087
Epoch: 18, Steps: 70 | Train Loss: 0.545 Vali Loss: 18.398 Vali Acc: 0.490 Test Loss: 18.398 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.15223240852356
Epoch: 19, Steps: 70 | Train Loss: 0.743 Vali Loss: 16.805 Vali Acc: 0.470 Test Loss: 16.805 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.79702377319336
Epoch: 20, Steps: 70 | Train Loss: 0.721 Vali Loss: 19.819 Vali Acc: 0.460 Test Loss: 19.819 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.721461534500122
Epoch: 21, Steps: 70 | Train Loss: 0.585 Vali Loss: 25.423 Vali Acc: 0.470 Test Loss: 25.423 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1820826
model size : 7.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.615217447280884
Epoch: 1, Steps: 70 | Train Loss: 6.381 Vali Loss: 5.473 Vali Acc: 0.530 Test Loss: 5.473 Test Acc: 0.530
Validation loss decreased (inf --> -0.529945).  Saving model ...
Epoch: 2 cost time: 6.104942560195923
Epoch: 2, Steps: 70 | Train Loss: 14.204 Vali Loss: 14.501 Vali Acc: 0.500 Test Loss: 14.501 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.53954553604126
Epoch: 3, Steps: 70 | Train Loss: 14.234 Vali Loss: 8.121 Vali Acc: 0.520 Test Loss: 8.121 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.688850164413452
Epoch: 4, Steps: 70 | Train Loss: 10.710 Vali Loss: 14.577 Vali Acc: 0.500 Test Loss: 14.577 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.756020784378052
Epoch: 5, Steps: 70 | Train Loss: 18.604 Vali Loss: 14.683 Vali Acc: 0.500 Test Loss: 14.683 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.710239887237549
Epoch: 6, Steps: 70 | Train Loss: 7.321 Vali Loss: 9.167 Vali Acc: 0.460 Test Loss: 9.167 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.00182580947876
Epoch: 7, Steps: 70 | Train Loss: 10.480 Vali Loss: 9.501 Vali Acc: 0.490 Test Loss: 9.501 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.704181671142578
Epoch: 8, Steps: 70 | Train Loss: 4.460 Vali Loss: 13.809 Vali Acc: 0.580 Test Loss: 13.809 Test Acc: 0.580
Validation loss decreased (-0.529945 --> -0.579862).  Saving model ...
Epoch: 9 cost time: 9.749748229980469
Epoch: 9, Steps: 70 | Train Loss: 4.867 Vali Loss: 19.682 Vali Acc: 0.470 Test Loss: 19.682 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.820722103118896
Epoch: 10, Steps: 70 | Train Loss: 6.994 Vali Loss: 7.932 Vali Acc: 0.480 Test Loss: 7.932 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.079130172729492
Epoch: 11, Steps: 70 | Train Loss: 4.744 Vali Loss: 33.245 Vali Acc: 0.500 Test Loss: 33.245 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.998041868209839
Epoch: 12, Steps: 70 | Train Loss: 2.409 Vali Loss: 13.744 Vali Acc: 0.490 Test Loss: 13.744 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.689432382583618
Epoch: 13, Steps: 70 | Train Loss: 4.129 Vali Loss: 40.236 Vali Acc: 0.500 Test Loss: 40.236 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.732486724853516
Epoch: 14, Steps: 70 | Train Loss: 3.519 Vali Loss: 10.148 Vali Acc: 0.490 Test Loss: 10.148 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.756217241287231
Epoch: 15, Steps: 70 | Train Loss: 0.924 Vali Loss: 20.569 Vali Acc: 0.510 Test Loss: 20.569 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.543775081634521
Epoch: 16, Steps: 70 | Train Loss: 1.765 Vali Loss: 24.236 Vali Acc: 0.500 Test Loss: 24.236 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.978109121322632
Epoch: 17, Steps: 70 | Train Loss: 1.256 Vali Loss: 14.581 Vali Acc: 0.500 Test Loss: 14.581 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.82289719581604
Epoch: 18, Steps: 70 | Train Loss: 0.002 Vali Loss: 15.363 Vali Acc: 0.480 Test Loss: 15.363 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1812826
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.617216348648071
Epoch: 1, Steps: 70 | Train Loss: 9.679 Vali Loss: 4.400 Vali Acc: 0.610 Test Loss: 4.400 Test Acc: 0.610
Validation loss decreased (inf --> -0.609956).  Saving model ...
Epoch: 2 cost time: 7.961076974868774
Epoch: 2, Steps: 70 | Train Loss: 12.479 Vali Loss: 6.024 Vali Acc: 0.500 Test Loss: 6.024 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.741872072219849
Epoch: 3, Steps: 70 | Train Loss: 12.547 Vali Loss: 27.664 Vali Acc: 0.500 Test Loss: 27.664 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.657973527908325
Epoch: 4, Steps: 70 | Train Loss: 19.873 Vali Loss: 38.148 Vali Acc: 0.500 Test Loss: 38.148 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.575876951217651
Epoch: 5, Steps: 70 | Train Loss: 12.376 Vali Loss: 40.976 Vali Acc: 0.500 Test Loss: 40.976 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.1595139503479
Epoch: 6, Steps: 70 | Train Loss: 14.677 Vali Loss: 6.313 Vali Acc: 0.500 Test Loss: 6.313 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.1362783908844
Epoch: 7, Steps: 70 | Train Loss: 9.770 Vali Loss: 6.227 Vali Acc: 0.490 Test Loss: 6.227 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.690890550613403
Epoch: 8, Steps: 70 | Train Loss: 7.515 Vali Loss: 2.823 Vali Acc: 0.450 Test Loss: 2.823 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.731970310211182
Epoch: 9, Steps: 70 | Train Loss: 7.277 Vali Loss: 7.655 Vali Acc: 0.500 Test Loss: 7.655 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.607980728149414
Epoch: 10, Steps: 70 | Train Loss: 4.074 Vali Loss: 19.699 Vali Acc: 0.500 Test Loss: 19.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.9700706005096436
Epoch: 11, Steps: 70 | Train Loss: 10.083 Vali Loss: 6.762 Vali Acc: 0.480 Test Loss: 6.762 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1804826
model size : 7.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.405450105667114
Epoch: 1, Steps: 70 | Train Loss: 5.258 Vali Loss: 6.823 Vali Acc: 0.450 Test Loss: 6.823 Test Acc: 0.450
Validation loss decreased (inf --> -0.449932).  Saving model ...
Epoch: 2 cost time: 9.42039442062378
Epoch: 2, Steps: 70 | Train Loss: 12.030 Vali Loss: 19.372 Vali Acc: 0.500 Test Loss: 19.372 Test Acc: 0.500
Validation loss decreased (-0.449932 --> -0.499806).  Saving model ...
Epoch: 3 cost time: 7.597233295440674
Epoch: 3, Steps: 70 | Train Loss: 7.745 Vali Loss: 13.144 Vali Acc: 0.500 Test Loss: 13.144 Test Acc: 0.500
Validation loss decreased (-0.499806 --> -0.499869).  Saving model ...
Epoch: 4 cost time: 8.861254692077637
Epoch: 4, Steps: 70 | Train Loss: 21.397 Vali Loss: 13.942 Vali Acc: 0.500 Test Loss: 13.942 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.437022686004639
Epoch: 5, Steps: 70 | Train Loss: 8.966 Vali Loss: 15.040 Vali Acc: 0.500 Test Loss: 15.040 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.352850675582886
Epoch: 6, Steps: 70 | Train Loss: 18.833 Vali Loss: 15.000 Vali Acc: 0.510 Test Loss: 15.000 Test Acc: 0.510
Validation loss decreased (-0.499869 --> -0.509850).  Saving model ...
Epoch: 7 cost time: 9.32496166229248
Epoch: 7, Steps: 70 | Train Loss: 13.021 Vali Loss: 5.307 Vali Acc: 0.490 Test Loss: 5.307 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.675489187240601
Epoch: 8, Steps: 70 | Train Loss: 7.813 Vali Loss: 12.414 Vali Acc: 0.460 Test Loss: 12.414 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.425618648529053
Epoch: 9, Steps: 70 | Train Loss: 14.060 Vali Loss: 30.416 Vali Acc: 0.500 Test Loss: 30.416 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.368915319442749
Epoch: 10, Steps: 70 | Train Loss: 6.172 Vali Loss: 23.766 Vali Acc: 0.500 Test Loss: 23.766 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.310389757156372
Epoch: 11, Steps: 70 | Train Loss: 6.606 Vali Loss: 10.531 Vali Acc: 0.540 Test Loss: 10.531 Test Acc: 0.540
Validation loss decreased (-0.509850 --> -0.539895).  Saving model ...
Epoch: 12 cost time: 8.931419610977173
Epoch: 12, Steps: 70 | Train Loss: 6.282 Vali Loss: 7.101 Vali Acc: 0.540 Test Loss: 7.101 Test Acc: 0.540
Validation loss decreased (-0.539895 --> -0.539929).  Saving model ...
Epoch: 13 cost time: 7.546572923660278
Epoch: 13, Steps: 70 | Train Loss: 2.298 Vali Loss: 10.318 Vali Acc: 0.530 Test Loss: 10.318 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.377991199493408
Epoch: 14, Steps: 70 | Train Loss: 1.065 Vali Loss: 11.042 Vali Acc: 0.530 Test Loss: 11.042 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.417015075683594
Epoch: 15, Steps: 70 | Train Loss: 0.783 Vali Loss: 14.946 Vali Acc: 0.490 Test Loss: 14.946 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.303115606307983
Epoch: 16, Steps: 70 | Train Loss: 2.432 Vali Loss: 13.435 Vali Acc: 0.530 Test Loss: 13.435 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.594388246536255
Epoch: 17, Steps: 70 | Train Loss: 0.678 Vali Loss: 25.855 Vali Acc: 0.500 Test Loss: 25.855 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.556836128234863
Epoch: 18, Steps: 70 | Train Loss: 0.492 Vali Loss: 18.389 Vali Acc: 0.510 Test Loss: 18.389 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.395699262619019
Epoch: 19, Steps: 70 | Train Loss: 0.300 Vali Loss: 24.935 Vali Acc: 0.450 Test Loss: 24.935 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.353726863861084
Epoch: 20, Steps: 70 | Train Loss: 0.430 Vali Loss: 27.317 Vali Acc: 0.520 Test Loss: 27.317 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.382941722869873
Epoch: 21, Steps: 70 | Train Loss: 0.255 Vali Loss: 24.616 Vali Acc: 0.490 Test Loss: 24.616 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.48543381690979
Epoch: 22, Steps: 70 | Train Loss: 2.012 Vali Loss: 15.845 Vali Acc: 0.560 Test Loss: 15.845 Test Acc: 0.560
Validation loss decreased (-0.539929 --> -0.559842).  Saving model ...
Epoch: 23 cost time: 7.722845554351807
Epoch: 23, Steps: 70 | Train Loss: 0.608 Vali Loss: 31.762 Vali Acc: 0.470 Test Loss: 31.762 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.364198207855225
Epoch: 24, Steps: 70 | Train Loss: 1.467 Vali Loss: 13.836 Vali Acc: 0.480 Test Loss: 13.836 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.401549577713013
Epoch: 25, Steps: 70 | Train Loss: 0.012 Vali Loss: 18.965 Vali Acc: 0.460 Test Loss: 18.965 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.288649082183838
Epoch: 26, Steps: 70 | Train Loss: 0.000 Vali Loss: 17.299 Vali Acc: 0.440 Test Loss: 17.299 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.111920595169067
Epoch: 27, Steps: 70 | Train Loss: 0.000 Vali Loss: 17.288 Vali Acc: 0.440 Test Loss: 17.288 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.606661796569824
Epoch: 28, Steps: 70 | Train Loss: 0.000 Vali Loss: 18.871 Vali Acc: 0.500 Test Loss: 18.871 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.29391598701477
Epoch: 29, Steps: 70 | Train Loss: 0.000 Vali Loss: 18.894 Vali Acc: 0.500 Test Loss: 18.894 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.380411624908447
Epoch: 30, Steps: 70 | Train Loss: 0.000 Vali Loss: 17.905 Vali Acc: 0.460 Test Loss: 17.905 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 9.373159170150757
Epoch: 31, Steps: 70 | Train Loss: 0.000 Vali Loss: 17.892 Vali Acc: 0.460 Test Loss: 17.892 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 8.052675247192383
Epoch: 32, Steps: 70 | Train Loss: 0.022 Vali Loss: 16.734 Vali Acc: 0.470 Test Loss: 16.734 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1796826
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.842138528823853
Epoch: 1, Steps: 70 | Train Loss: 5.333 Vali Loss: 7.217 Vali Acc: 0.500 Test Loss: 7.217 Test Acc: 0.500
Validation loss decreased (inf --> -0.499928).  Saving model ...
Epoch: 2 cost time: 8.720519542694092
Epoch: 2, Steps: 70 | Train Loss: 14.648 Vali Loss: 12.635 Vali Acc: 0.500 Test Loss: 12.635 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.5964367389678955
Epoch: 3, Steps: 70 | Train Loss: 12.340 Vali Loss: 19.085 Vali Acc: 0.500 Test Loss: 19.085 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.197083473205566
Epoch: 4, Steps: 70 | Train Loss: 11.031 Vali Loss: 33.760 Vali Acc: 0.500 Test Loss: 33.760 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.80335807800293
Epoch: 5, Steps: 70 | Train Loss: 17.481 Vali Loss: 6.442 Vali Acc: 0.480 Test Loss: 6.442 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.022313833236694
Epoch: 6, Steps: 70 | Train Loss: 10.439 Vali Loss: 15.802 Vali Acc: 0.510 Test Loss: 15.802 Test Acc: 0.510
Validation loss decreased (-0.499928 --> -0.509842).  Saving model ...
Epoch: 7 cost time: 8.89138126373291
Epoch: 7, Steps: 70 | Train Loss: 16.850 Vali Loss: 9.744 Vali Acc: 0.560 Test Loss: 9.744 Test Acc: 0.560
Validation loss decreased (-0.509842 --> -0.559903).  Saving model ...
Epoch: 8 cost time: 7.985280275344849
Epoch: 8, Steps: 70 | Train Loss: 10.394 Vali Loss: 8.586 Vali Acc: 0.550 Test Loss: 8.586 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.261295557022095
Epoch: 9, Steps: 70 | Train Loss: 9.093 Vali Loss: 38.122 Vali Acc: 0.500 Test Loss: 38.122 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.786165475845337
Epoch: 10, Steps: 70 | Train Loss: 4.913 Vali Loss: 23.465 Vali Acc: 0.460 Test Loss: 23.465 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.864502906799316
Epoch: 11, Steps: 70 | Train Loss: 2.071 Vali Loss: 12.797 Vali Acc: 0.500 Test Loss: 12.797 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.858597993850708
Epoch: 12, Steps: 70 | Train Loss: 3.680 Vali Loss: 24.568 Vali Acc: 0.440 Test Loss: 24.568 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.313503742218018
Epoch: 13, Steps: 70 | Train Loss: 3.331 Vali Loss: 23.215 Vali Acc: 0.490 Test Loss: 23.215 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.114106178283691
Epoch: 14, Steps: 70 | Train Loss: 3.994 Vali Loss: 27.163 Vali Acc: 0.520 Test Loss: 27.163 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.83845829963684
Epoch: 15, Steps: 70 | Train Loss: 2.825 Vali Loss: 18.840 Vali Acc: 0.580 Test Loss: 18.840 Test Acc: 0.580
Validation loss decreased (-0.559903 --> -0.579812).  Saving model ...
Epoch: 16 cost time: 8.836689710617065
Epoch: 16, Steps: 70 | Train Loss: 1.454 Vali Loss: 32.797 Vali Acc: 0.530 Test Loss: 32.797 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.745593547821045
Epoch: 17, Steps: 70 | Train Loss: 3.663 Vali Loss: 7.991 Vali Acc: 0.580 Test Loss: 7.991 Test Acc: 0.580
Validation loss decreased (-0.579812 --> -0.579920).  Saving model ...
Epoch: 18 cost time: 8.455596685409546
Epoch: 18, Steps: 70 | Train Loss: 1.078 Vali Loss: 17.861 Vali Acc: 0.440 Test Loss: 17.861 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.004154205322266
Epoch: 19, Steps: 70 | Train Loss: 0.115 Vali Loss: 18.285 Vali Acc: 0.540 Test Loss: 18.285 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.69789433479309
Epoch: 20, Steps: 70 | Train Loss: 0.435 Vali Loss: 18.852 Vali Acc: 0.440 Test Loss: 18.852 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.69038724899292
Epoch: 21, Steps: 70 | Train Loss: 0.926 Vali Loss: 29.588 Vali Acc: 0.420 Test Loss: 29.588 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 8.792709350585938
Epoch: 22, Steps: 70 | Train Loss: 0.888 Vali Loss: 28.015 Vali Acc: 0.420 Test Loss: 28.015 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 8.674925565719604
Epoch: 23, Steps: 70 | Train Loss: 0.243 Vali Loss: 26.442 Vali Acc: 0.510 Test Loss: 26.442 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.2327659130096436
Epoch: 24, Steps: 70 | Train Loss: 0.504 Vali Loss: 26.975 Vali Acc: 0.430 Test Loss: 26.975 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.632946968078613
Epoch: 25, Steps: 70 | Train Loss: 0.577 Vali Loss: 25.073 Vali Acc: 0.480 Test Loss: 25.073 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 8.829657793045044
Epoch: 26, Steps: 70 | Train Loss: 1.160 Vali Loss: 18.788 Vali Acc: 0.510 Test Loss: 18.788 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 8.946493864059448
Epoch: 27, Steps: 70 | Train Loss: 0.809 Vali Loss: 14.630 Vali Acc: 0.550 Test Loss: 14.630 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1720986
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.921203851699829
Epoch: 1, Steps: 70 | Train Loss: 4.729 Vali Loss: 1.663 Vali Acc: 0.450 Test Loss: 1.663 Test Acc: 0.450
Validation loss decreased (inf --> -0.449983).  Saving model ...
Epoch: 2 cost time: 8.749526023864746
Epoch: 2, Steps: 70 | Train Loss: 12.978 Vali Loss: 9.806 Vali Acc: 0.470 Test Loss: 9.806 Test Acc: 0.470
Validation loss decreased (-0.449983 --> -0.469902).  Saving model ...
Epoch: 3 cost time: 8.752547264099121
Epoch: 3, Steps: 70 | Train Loss: 12.175 Vali Loss: 6.223 Vali Acc: 0.500 Test Loss: 6.223 Test Acc: 0.500
Validation loss decreased (-0.469902 --> -0.499938).  Saving model ...
Epoch: 4 cost time: 8.773387908935547
Epoch: 4, Steps: 70 | Train Loss: 15.832 Vali Loss: 56.016 Vali Acc: 0.500 Test Loss: 56.016 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.25555157661438
Epoch: 5, Steps: 70 | Train Loss: 32.147 Vali Loss: 50.710 Vali Acc: 0.510 Test Loss: 50.710 Test Acc: 0.510
Validation loss decreased (-0.499938 --> -0.509493).  Saving model ...
Epoch: 6 cost time: 7.342878818511963
Epoch: 6, Steps: 70 | Train Loss: 24.508 Vali Loss: 12.727 Vali Acc: 0.490 Test Loss: 12.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.675614595413208
Epoch: 7, Steps: 70 | Train Loss: 9.157 Vali Loss: 32.379 Vali Acc: 0.500 Test Loss: 32.379 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.726434707641602
Epoch: 8, Steps: 70 | Train Loss: 12.425 Vali Loss: 20.282 Vali Acc: 0.480 Test Loss: 20.282 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.754504680633545
Epoch: 9, Steps: 70 | Train Loss: 11.106 Vali Loss: 25.007 Vali Acc: 0.490 Test Loss: 25.007 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.766607761383057
Epoch: 10, Steps: 70 | Train Loss: 14.675 Vali Loss: 6.060 Vali Acc: 0.560 Test Loss: 6.060 Test Acc: 0.560
Validation loss decreased (-0.509493 --> -0.559939).  Saving model ...
Epoch: 11 cost time: 7.026757478713989
Epoch: 11, Steps: 70 | Train Loss: 3.068 Vali Loss: 10.864 Vali Acc: 0.470 Test Loss: 10.864 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.677649974822998
Epoch: 12, Steps: 70 | Train Loss: 1.854 Vali Loss: 10.348 Vali Acc: 0.530 Test Loss: 10.348 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.717025518417358
Epoch: 13, Steps: 70 | Train Loss: 1.798 Vali Loss: 28.797 Vali Acc: 0.500 Test Loss: 28.797 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.712929487228394
Epoch: 14, Steps: 70 | Train Loss: 1.260 Vali Loss: 15.755 Vali Acc: 0.530 Test Loss: 15.755 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.617539405822754
Epoch: 15, Steps: 70 | Train Loss: 0.720 Vali Loss: 18.372 Vali Acc: 0.530 Test Loss: 18.372 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.02778697013855
Epoch: 16, Steps: 70 | Train Loss: 1.092 Vali Loss: 21.379 Vali Acc: 0.510 Test Loss: 21.379 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.3887460231781
Epoch: 17, Steps: 70 | Train Loss: 0.723 Vali Loss: 12.557 Vali Acc: 0.490 Test Loss: 12.557 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.766217947006226
Epoch: 18, Steps: 70 | Train Loss: 0.569 Vali Loss: 16.839 Vali Acc: 0.480 Test Loss: 16.839 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.735753297805786
Epoch: 19, Steps: 70 | Train Loss: 0.153 Vali Loss: 23.714 Vali Acc: 0.410 Test Loss: 23.714 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.699052810668945
Epoch: 20, Steps: 70 | Train Loss: 0.302 Vali Loss: 15.426 Vali Acc: 0.480 Test Loss: 15.426 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1712986
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.65800929069519
Epoch: 1, Steps: 70 | Train Loss: 6.176 Vali Loss: 5.098 Vali Acc: 0.470 Test Loss: 5.098 Test Acc: 0.470
Validation loss decreased (inf --> -0.469949).  Saving model ...
Epoch: 2 cost time: 8.696073293685913
Epoch: 2, Steps: 70 | Train Loss: 8.167 Vali Loss: 14.895 Vali Acc: 0.500 Test Loss: 14.895 Test Acc: 0.500
Validation loss decreased (-0.469949 --> -0.499851).  Saving model ...
Epoch: 3 cost time: 8.756326675415039
Epoch: 3, Steps: 70 | Train Loss: 9.398 Vali Loss: 17.122 Vali Acc: 0.500 Test Loss: 17.122 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.05784010887146
Epoch: 4, Steps: 70 | Train Loss: 13.511 Vali Loss: 1.515 Vali Acc: 0.560 Test Loss: 1.515 Test Acc: 0.560
Validation loss decreased (-0.499851 --> -0.559985).  Saving model ...
Epoch: 5 cost time: 8.050360441207886
Epoch: 5, Steps: 70 | Train Loss: 10.223 Vali Loss: 34.861 Vali Acc: 0.500 Test Loss: 34.861 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.78286623954773
Epoch: 6, Steps: 70 | Train Loss: 14.780 Vali Loss: 10.925 Vali Acc: 0.500 Test Loss: 10.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.827906608581543
Epoch: 7, Steps: 70 | Train Loss: 15.662 Vali Loss: 35.790 Vali Acc: 0.510 Test Loss: 35.790 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.917905330657959
Epoch: 8, Steps: 70 | Train Loss: 10.457 Vali Loss: 15.150 Vali Acc: 0.550 Test Loss: 15.150 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.186380386352539
Epoch: 9, Steps: 70 | Train Loss: 10.236 Vali Loss: 30.444 Vali Acc: 0.480 Test Loss: 30.444 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.352692365646362
Epoch: 10, Steps: 70 | Train Loss: 5.542 Vali Loss: 26.970 Vali Acc: 0.450 Test Loss: 26.970 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.893292427062988
Epoch: 11, Steps: 70 | Train Loss: 4.212 Vali Loss: 18.663 Vali Acc: 0.510 Test Loss: 18.663 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.88007140159607
Epoch: 12, Steps: 70 | Train Loss: 3.290 Vali Loss: 18.510 Vali Acc: 0.530 Test Loss: 18.510 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.709516763687134
Epoch: 13, Steps: 70 | Train Loss: 1.795 Vali Loss: 42.217 Vali Acc: 0.500 Test Loss: 42.217 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.121110916137695
Epoch: 14, Steps: 70 | Train Loss: 1.489 Vali Loss: 19.279 Vali Acc: 0.480 Test Loss: 19.279 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1704986
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.30775761604309
Epoch: 1, Steps: 70 | Train Loss: 5.393 Vali Loss: 17.338 Vali Acc: 0.500 Test Loss: 17.338 Test Acc: 0.500
Validation loss decreased (inf --> -0.499827).  Saving model ...
Epoch: 2 cost time: 8.18680453300476
Epoch: 2, Steps: 70 | Train Loss: 22.680 Vali Loss: 56.862 Vali Acc: 0.500 Test Loss: 56.862 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.345018863677979
Epoch: 3, Steps: 70 | Train Loss: 14.975 Vali Loss: 39.358 Vali Acc: 0.500 Test Loss: 39.358 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.041000843048096
Epoch: 4, Steps: 70 | Train Loss: 15.337 Vali Loss: 32.840 Vali Acc: 0.500 Test Loss: 32.840 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.886977434158325
Epoch: 5, Steps: 70 | Train Loss: 9.913 Vali Loss: 10.252 Vali Acc: 0.500 Test Loss: 10.252 Test Acc: 0.500
Validation loss decreased (-0.499827 --> -0.499897).  Saving model ...
Epoch: 6 cost time: 8.328218698501587
Epoch: 6, Steps: 70 | Train Loss: 13.607 Vali Loss: 20.556 Vali Acc: 0.500 Test Loss: 20.556 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.239341020584106
Epoch: 7, Steps: 70 | Train Loss: 16.598 Vali Loss: 19.216 Vali Acc: 0.510 Test Loss: 19.216 Test Acc: 0.510
Validation loss decreased (-0.499897 --> -0.509808).  Saving model ...
Epoch: 8 cost time: 8.279883861541748
Epoch: 8, Steps: 70 | Train Loss: 8.795 Vali Loss: 9.004 Vali Acc: 0.560 Test Loss: 9.004 Test Acc: 0.560
Validation loss decreased (-0.509808 --> -0.559910).  Saving model ...
Epoch: 9 cost time: 6.81315279006958
Epoch: 9, Steps: 70 | Train Loss: 9.930 Vali Loss: 12.820 Vali Acc: 0.520 Test Loss: 12.820 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.192140579223633
Epoch: 10, Steps: 70 | Train Loss: 8.985 Vali Loss: 15.376 Vali Acc: 0.540 Test Loss: 15.376 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.300708770751953
Epoch: 11, Steps: 70 | Train Loss: 5.347 Vali Loss: 15.058 Vali Acc: 0.480 Test Loss: 15.058 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.441457033157349
Epoch: 12, Steps: 70 | Train Loss: 2.305 Vali Loss: 15.874 Vali Acc: 0.540 Test Loss: 15.874 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.337956428527832
Epoch: 13, Steps: 70 | Train Loss: 2.771 Vali Loss: 24.302 Vali Acc: 0.430 Test Loss: 24.302 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.659952640533447
Epoch: 14, Steps: 70 | Train Loss: 1.849 Vali Loss: 11.176 Vali Acc: 0.580 Test Loss: 11.176 Test Acc: 0.580
Validation loss decreased (-0.559910 --> -0.579888).  Saving model ...
Epoch: 15 cost time: 8.315626621246338
Epoch: 15, Steps: 70 | Train Loss: 2.692 Vali Loss: 15.819 Vali Acc: 0.610 Test Loss: 15.819 Test Acc: 0.610
Validation loss decreased (-0.579888 --> -0.609842).  Saving model ...
Epoch: 16 cost time: 8.172618627548218
Epoch: 16, Steps: 70 | Train Loss: 1.088 Vali Loss: 9.595 Vali Acc: 0.570 Test Loss: 9.595 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.168770551681519
Epoch: 17, Steps: 70 | Train Loss: 3.541 Vali Loss: 30.526 Vali Acc: 0.500 Test Loss: 30.526 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.679899454116821
Epoch: 18, Steps: 70 | Train Loss: 1.405 Vali Loss: 10.468 Vali Acc: 0.490 Test Loss: 10.468 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.748844623565674
Epoch: 19, Steps: 70 | Train Loss: 0.348 Vali Loss: 24.823 Vali Acc: 0.540 Test Loss: 24.823 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.403976202011108
Epoch: 20, Steps: 70 | Train Loss: 1.042 Vali Loss: 14.350 Vali Acc: 0.510 Test Loss: 14.350 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.507776975631714
Epoch: 21, Steps: 70 | Train Loss: 1.513 Vali Loss: 14.891 Vali Acc: 0.540 Test Loss: 14.891 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.40886378288269
Epoch: 22, Steps: 70 | Train Loss: 0.627 Vali Loss: 32.194 Vali Acc: 0.480 Test Loss: 32.194 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.909918308258057
Epoch: 23, Steps: 70 | Train Loss: 3.418 Vali Loss: 22.650 Vali Acc: 0.590 Test Loss: 22.650 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.464253187179565
Epoch: 24, Steps: 70 | Train Loss: 1.461 Vali Loss: 25.687 Vali Acc: 0.450 Test Loss: 25.687 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.329959630966187
Epoch: 25, Steps: 70 | Train Loss: 1.188 Vali Loss: 13.576 Vali Acc: 0.610 Test Loss: 13.576 Test Acc: 0.610
Validation loss decreased (-0.609842 --> -0.609864).  Saving model ...
Epoch: 26 cost time: 8.448453664779663
Epoch: 26, Steps: 70 | Train Loss: 0.150 Vali Loss: 14.951 Vali Acc: 0.530 Test Loss: 14.951 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.790536403656006
Epoch: 27, Steps: 70 | Train Loss: 0.189 Vali Loss: 16.428 Vali Acc: 0.530 Test Loss: 16.428 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.399788618087769
Epoch: 28, Steps: 70 | Train Loss: 0.425 Vali Loss: 15.522 Vali Acc: 0.510 Test Loss: 15.522 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.5192129611969
Epoch: 29, Steps: 70 | Train Loss: 0.174 Vali Loss: 17.421 Vali Acc: 0.550 Test Loss: 17.421 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.338062524795532
Epoch: 30, Steps: 70 | Train Loss: 0.271 Vali Loss: 14.883 Vali Acc: 0.580 Test Loss: 14.883 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.87816047668457
Epoch: 31, Steps: 70 | Train Loss: 0.056 Vali Loss: 16.491 Vali Acc: 0.540 Test Loss: 16.491 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 8.221691608428955
Epoch: 32, Steps: 70 | Train Loss: 0.151 Vali Loss: 14.515 Vali Acc: 0.530 Test Loss: 14.515 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 8.39520263671875
Epoch: 33, Steps: 70 | Train Loss: 0.000 Vali Loss: 14.516 Vali Acc: 0.530 Test Loss: 14.516 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 8.44362759590149
Epoch: 34, Steps: 70 | Train Loss: 0.000 Vali Loss: 14.503 Vali Acc: 0.530 Test Loss: 14.503 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.109795570373535
Epoch: 35, Steps: 70 | Train Loss: 0.000 Vali Loss: 14.501 Vali Acc: 0.530 Test Loss: 14.501 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1696986
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.259339809417725
Epoch: 1, Steps: 70 | Train Loss: 6.774 Vali Loss: 13.144 Vali Acc: 0.490 Test Loss: 13.144 Test Acc: 0.490
Validation loss decreased (inf --> -0.489869).  Saving model ...
Epoch: 2 cost time: 7.567120790481567
Epoch: 2, Steps: 70 | Train Loss: 14.508 Vali Loss: 2.453 Vali Acc: 0.520 Test Loss: 2.453 Test Acc: 0.520
Validation loss decreased (-0.489869 --> -0.519975).  Saving model ...
Epoch: 3 cost time: 6.696822166442871
Epoch: 3, Steps: 70 | Train Loss: 9.102 Vali Loss: 2.510 Vali Acc: 0.490 Test Loss: 2.510 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.367363691329956
Epoch: 4, Steps: 70 | Train Loss: 9.489 Vali Loss: 13.804 Vali Acc: 0.490 Test Loss: 13.804 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.445844173431396
Epoch: 5, Steps: 70 | Train Loss: 6.683 Vali Loss: 4.260 Vali Acc: 0.460 Test Loss: 4.260 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.56479811668396
Epoch: 6, Steps: 70 | Train Loss: 12.621 Vali Loss: 19.062 Vali Acc: 0.510 Test Loss: 19.062 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.819450616836548
Epoch: 7, Steps: 70 | Train Loss: 14.014 Vali Loss: 28.221 Vali Acc: 0.500 Test Loss: 28.221 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.7036213874816895
Epoch: 8, Steps: 70 | Train Loss: 6.691 Vali Loss: 8.510 Vali Acc: 0.560 Test Loss: 8.510 Test Acc: 0.560
Validation loss decreased (-0.519975 --> -0.559915).  Saving model ...
Epoch: 9 cost time: 8.407487154006958
Epoch: 9, Steps: 70 | Train Loss: 9.780 Vali Loss: 35.073 Vali Acc: 0.500 Test Loss: 35.073 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.43646502494812
Epoch: 10, Steps: 70 | Train Loss: 7.493 Vali Loss: 21.728 Vali Acc: 0.510 Test Loss: 21.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.808512210845947
Epoch: 11, Steps: 70 | Train Loss: 6.167 Vali Loss: 6.732 Vali Acc: 0.510 Test Loss: 6.732 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.780237436294556
Epoch: 12, Steps: 70 | Train Loss: 5.172 Vali Loss: 35.809 Vali Acc: 0.500 Test Loss: 35.809 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.413708686828613
Epoch: 13, Steps: 70 | Train Loss: 1.559 Vali Loss: 13.717 Vali Acc: 0.500 Test Loss: 13.717 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.5208899974823
Epoch: 14, Steps: 70 | Train Loss: 1.051 Vali Loss: 26.753 Vali Acc: 0.430 Test Loss: 26.753 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.49392056465149
Epoch: 15, Steps: 70 | Train Loss: 1.617 Vali Loss: 13.901 Vali Acc: 0.540 Test Loss: 13.901 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.812688589096069
Epoch: 16, Steps: 70 | Train Loss: 1.246 Vali Loss: 21.821 Vali Acc: 0.470 Test Loss: 21.821 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.164753198623657
Epoch: 17, Steps: 70 | Train Loss: 0.637 Vali Loss: 35.743 Vali Acc: 0.520 Test Loss: 35.743 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.556028127670288
Epoch: 18, Steps: 70 | Train Loss: 0.593 Vali Loss: 26.725 Vali Acc: 0.490 Test Loss: 26.725 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1671066
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.35747766494751
Epoch: 1, Steps: 70 | Train Loss: 6.708 Vali Loss: 16.204 Vali Acc: 0.490 Test Loss: 16.204 Test Acc: 0.490
Validation loss decreased (inf --> -0.489838).  Saving model ...
Epoch: 2 cost time: 8.41867971420288
Epoch: 2, Steps: 70 | Train Loss: 18.564 Vali Loss: 15.521 Vali Acc: 0.500 Test Loss: 15.521 Test Acc: 0.500
Validation loss decreased (-0.489838 --> -0.499845).  Saving model ...
Epoch: 3 cost time: 8.386133432388306
Epoch: 3, Steps: 70 | Train Loss: 16.770 Vali Loss: 1.944 Vali Acc: 0.510 Test Loss: 1.944 Test Acc: 0.510
Validation loss decreased (-0.499845 --> -0.509981).  Saving model ...
Epoch: 4 cost time: 7.194769620895386
Epoch: 4, Steps: 70 | Train Loss: 13.452 Vali Loss: 48.316 Vali Acc: 0.500 Test Loss: 48.316 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.278416633605957
Epoch: 5, Steps: 70 | Train Loss: 11.297 Vali Loss: 4.634 Vali Acc: 0.600 Test Loss: 4.634 Test Acc: 0.600
Validation loss decreased (-0.509981 --> -0.599954).  Saving model ...
Epoch: 6 cost time: 8.360506296157837
Epoch: 6, Steps: 70 | Train Loss: 16.331 Vali Loss: 18.923 Vali Acc: 0.500 Test Loss: 18.923 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.37481427192688
Epoch: 7, Steps: 70 | Train Loss: 9.433 Vali Loss: 35.290 Vali Acc: 0.500 Test Loss: 35.290 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.375611782073975
Epoch: 8, Steps: 70 | Train Loss: 10.778 Vali Loss: 16.741 Vali Acc: 0.550 Test Loss: 16.741 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.740734815597534
Epoch: 9, Steps: 70 | Train Loss: 9.015 Vali Loss: 24.827 Vali Acc: 0.460 Test Loss: 24.827 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.315169095993042
Epoch: 10, Steps: 70 | Train Loss: 5.447 Vali Loss: 10.513 Vali Acc: 0.550 Test Loss: 10.513 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.452884197235107
Epoch: 11, Steps: 70 | Train Loss: 5.135 Vali Loss: 24.942 Vali Acc: 0.450 Test Loss: 24.942 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.492312669754028
Epoch: 12, Steps: 70 | Train Loss: 4.159 Vali Loss: 19.745 Vali Acc: 0.540 Test Loss: 19.745 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.966433763504028
Epoch: 13, Steps: 70 | Train Loss: 4.176 Vali Loss: 34.955 Vali Acc: 0.410 Test Loss: 34.955 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.2262725830078125
Epoch: 14, Steps: 70 | Train Loss: 3.101 Vali Loss: 50.586 Vali Acc: 0.500 Test Loss: 50.586 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.433846712112427
Epoch: 15, Steps: 70 | Train Loss: 4.695 Vali Loss: 35.627 Vali Acc: 0.490 Test Loss: 35.627 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1663066
model size : 7.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.560685396194458
Epoch: 1, Steps: 70 | Train Loss: 4.516 Vali Loss: 11.636 Vali Acc: 0.470 Test Loss: 11.636 Test Acc: 0.470
Validation loss decreased (inf --> -0.469884).  Saving model ...
Epoch: 2 cost time: 8.17888855934143
Epoch: 2, Steps: 70 | Train Loss: 14.694 Vali Loss: 12.343 Vali Acc: 0.500 Test Loss: 12.343 Test Acc: 0.500
Validation loss decreased (-0.469884 --> -0.499877).  Saving model ...
Epoch: 3 cost time: 8.26982593536377
Epoch: 3, Steps: 70 | Train Loss: 12.343 Vali Loss: 5.399 Vali Acc: 0.500 Test Loss: 5.399 Test Acc: 0.500
Validation loss decreased (-0.499877 --> -0.499946).  Saving model ...
Epoch: 4 cost time: 8.277982234954834
Epoch: 4, Steps: 70 | Train Loss: 11.987 Vali Loss: 24.553 Vali Acc: 0.490 Test Loss: 24.553 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.797490358352661
Epoch: 5, Steps: 70 | Train Loss: 21.846 Vali Loss: 47.346 Vali Acc: 0.500 Test Loss: 47.346 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.552178382873535
Epoch: 6, Steps: 70 | Train Loss: 15.958 Vali Loss: 21.553 Vali Acc: 0.500 Test Loss: 21.553 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.246498823165894
Epoch: 7, Steps: 70 | Train Loss: 19.631 Vali Loss: 13.641 Vali Acc: 0.500 Test Loss: 13.641 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.215502738952637
Epoch: 8, Steps: 70 | Train Loss: 11.914 Vali Loss: 15.188 Vali Acc: 0.500 Test Loss: 15.188 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.746105909347534
Epoch: 9, Steps: 70 | Train Loss: 9.866 Vali Loss: 21.955 Vali Acc: 0.500 Test Loss: 21.955 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.621586799621582
Epoch: 10, Steps: 70 | Train Loss: 12.974 Vali Loss: 19.066 Vali Acc: 0.530 Test Loss: 19.066 Test Acc: 0.530
Validation loss decreased (-0.499946 --> -0.529809).  Saving model ...
Epoch: 11 cost time: 8.196344375610352
Epoch: 11, Steps: 70 | Train Loss: 10.671 Vali Loss: 22.752 Vali Acc: 0.480 Test Loss: 22.752 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.265846490859985
Epoch: 12, Steps: 70 | Train Loss: 7.311 Vali Loss: 11.684 Vali Acc: 0.580 Test Loss: 11.684 Test Acc: 0.580
Validation loss decreased (-0.529809 --> -0.579883).  Saving model ...
Epoch: 13 cost time: 8.237702131271362
Epoch: 13, Steps: 70 | Train Loss: 2.897 Vali Loss: 23.829 Vali Acc: 0.440 Test Loss: 23.829 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.82116436958313
Epoch: 14, Steps: 70 | Train Loss: 3.970 Vali Loss: 18.309 Vali Acc: 0.590 Test Loss: 18.309 Test Acc: 0.590
Validation loss decreased (-0.579883 --> -0.589817).  Saving model ...
Epoch: 15 cost time: 7.220620155334473
Epoch: 15, Steps: 70 | Train Loss: 1.741 Vali Loss: 19.508 Vali Acc: 0.430 Test Loss: 19.508 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.222504377365112
Epoch: 16, Steps: 70 | Train Loss: 0.810 Vali Loss: 26.596 Vali Acc: 0.440 Test Loss: 26.596 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.311803102493286
Epoch: 17, Steps: 70 | Train Loss: 1.157 Vali Loss: 23.919 Vali Acc: 0.430 Test Loss: 23.919 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.114560604095459
Epoch: 18, Steps: 70 | Train Loss: 0.381 Vali Loss: 8.041 Vali Acc: 0.580 Test Loss: 8.041 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.6097633838653564
Epoch: 19, Steps: 70 | Train Loss: 0.686 Vali Loss: 31.781 Vali Acc: 0.510 Test Loss: 31.781 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.199872970581055
Epoch: 20, Steps: 70 | Train Loss: 0.839 Vali Loss: 30.053 Vali Acc: 0.450 Test Loss: 30.053 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.301048755645752
Epoch: 21, Steps: 70 | Train Loss: 1.853 Vali Loss: 26.504 Vali Acc: 0.510 Test Loss: 26.504 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.255208969116211
Epoch: 22, Steps: 70 | Train Loss: 0.931 Vali Loss: 20.737 Vali Acc: 0.530 Test Loss: 20.737 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.008000612258911
Epoch: 23, Steps: 70 | Train Loss: 1.473 Vali Loss: 16.955 Vali Acc: 0.480 Test Loss: 16.955 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.707556962966919
Epoch: 24, Steps: 70 | Train Loss: 1.007 Vali Loss: 38.213 Vali Acc: 0.510 Test Loss: 38.213 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1655066
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.947306632995605
Epoch: 1, Steps: 70 | Train Loss: 6.908 Vali Loss: 19.584 Vali Acc: 0.500 Test Loss: 19.584 Test Acc: 0.500
Validation loss decreased (inf --> -0.499804).  Saving model ...
Epoch: 2 cost time: 6.438527822494507
Epoch: 2, Steps: 70 | Train Loss: 18.719 Vali Loss: 34.159 Vali Acc: 0.500 Test Loss: 34.159 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.6933159828186035
Epoch: 3, Steps: 70 | Train Loss: 24.680 Vali Loss: 11.828 Vali Acc: 0.500 Test Loss: 11.828 Test Acc: 0.500
Validation loss decreased (-0.499804 --> -0.499882).  Saving model ...
Epoch: 4 cost time: 7.919280290603638
Epoch: 4, Steps: 70 | Train Loss: 12.080 Vali Loss: 20.283 Vali Acc: 0.500 Test Loss: 20.283 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.940730810165405
Epoch: 5, Steps: 70 | Train Loss: 14.753 Vali Loss: 31.910 Vali Acc: 0.500 Test Loss: 31.910 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.218117952346802
Epoch: 6, Steps: 70 | Train Loss: 17.208 Vali Loss: 33.330 Vali Acc: 0.500 Test Loss: 33.330 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.447248220443726
Epoch: 7, Steps: 70 | Train Loss: 14.290 Vali Loss: 27.308 Vali Acc: 0.500 Test Loss: 27.308 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.70496940612793
Epoch: 8, Steps: 70 | Train Loss: 6.933 Vali Loss: 13.219 Vali Acc: 0.510 Test Loss: 13.219 Test Acc: 0.510
Validation loss decreased (-0.499882 --> -0.509868).  Saving model ...
Epoch: 9 cost time: 5.143984079360962
Epoch: 9, Steps: 70 | Train Loss: 13.036 Vali Loss: 14.121 Vali Acc: 0.510 Test Loss: 14.121 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.528628587722778
Epoch: 10, Steps: 70 | Train Loss: 18.430 Vali Loss: 58.476 Vali Acc: 0.500 Test Loss: 58.476 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.600638389587402
Epoch: 11, Steps: 70 | Train Loss: 11.649 Vali Loss: 27.550 Vali Acc: 0.510 Test Loss: 27.550 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.590632200241089
Epoch: 12, Steps: 70 | Train Loss: 4.934 Vali Loss: 7.195 Vali Acc: 0.530 Test Loss: 7.195 Test Acc: 0.530
Validation loss decreased (-0.509868 --> -0.529928).  Saving model ...
Epoch: 13 cost time: 6.180732727050781
Epoch: 13, Steps: 70 | Train Loss: 5.343 Vali Loss: 26.757 Vali Acc: 0.430 Test Loss: 26.757 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.584761619567871
Epoch: 14, Steps: 70 | Train Loss: 3.194 Vali Loss: 22.189 Vali Acc: 0.500 Test Loss: 22.189 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.520333766937256
Epoch: 15, Steps: 70 | Train Loss: 0.851 Vali Loss: 15.091 Vali Acc: 0.560 Test Loss: 15.091 Test Acc: 0.560
Validation loss decreased (-0.529928 --> -0.559849).  Saving model ...
Epoch: 16 cost time: 7.268642425537109
Epoch: 16, Steps: 70 | Train Loss: 1.696 Vali Loss: 27.325 Vali Acc: 0.460 Test Loss: 27.325 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.231969594955444
Epoch: 17, Steps: 70 | Train Loss: 1.164 Vali Loss: 40.019 Vali Acc: 0.480 Test Loss: 40.019 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.548516511917114
Epoch: 18, Steps: 70 | Train Loss: 0.625 Vali Loss: 29.164 Vali Acc: 0.500 Test Loss: 29.164 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.537450551986694
Epoch: 19, Steps: 70 | Train Loss: 0.284 Vali Loss: 15.971 Vali Acc: 0.490 Test Loss: 15.971 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.054831266403198
Epoch: 20, Steps: 70 | Train Loss: 0.129 Vali Loss: 13.308 Vali Acc: 0.490 Test Loss: 13.308 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.181026220321655
Epoch: 21, Steps: 70 | Train Loss: 0.571 Vali Loss: 9.472 Vali Acc: 0.570 Test Loss: 9.472 Test Acc: 0.570
Validation loss decreased (-0.559849 --> -0.569905).  Saving model ...
Epoch: 22 cost time: 7.533675909042358
Epoch: 22, Steps: 70 | Train Loss: 0.617 Vali Loss: 14.182 Vali Acc: 0.450 Test Loss: 14.182 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.562990188598633
Epoch: 23, Steps: 70 | Train Loss: 0.362 Vali Loss: 22.675 Vali Acc: 0.540 Test Loss: 22.675 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.14311671257019
Epoch: 24, Steps: 70 | Train Loss: 0.605 Vali Loss: 26.416 Vali Acc: 0.510 Test Loss: 26.416 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.153980016708374
Epoch: 25, Steps: 70 | Train Loss: 0.745 Vali Loss: 39.644 Vali Acc: 0.520 Test Loss: 39.644 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.547389507293701
Epoch: 26, Steps: 70 | Train Loss: 0.937 Vali Loss: 14.172 Vali Acc: 0.510 Test Loss: 14.172 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.356882810592651
Epoch: 27, Steps: 70 | Train Loss: 0.286 Vali Loss: 17.572 Vali Acc: 0.500 Test Loss: 17.572 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.008056402206421
Epoch: 28, Steps: 70 | Train Loss: 0.775 Vali Loss: 14.412 Vali Acc: 0.520 Test Loss: 14.412 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.114202976226807
Epoch: 29, Steps: 70 | Train Loss: 4.039 Vali Loss: 41.900 Vali Acc: 0.410 Test Loss: 41.900 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.512599229812622
Epoch: 30, Steps: 70 | Train Loss: 0.487 Vali Loss: 27.632 Vali Acc: 0.540 Test Loss: 27.632 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.5908801555633545
Epoch: 31, Steps: 70 | Train Loss: 0.240 Vali Loss: 17.110 Vali Acc: 0.620 Test Loss: 17.110 Test Acc: 0.620
Validation loss decreased (-0.569905 --> -0.619829).  Saving model ...
Epoch: 32 cost time: 6.9291160106658936
Epoch: 32, Steps: 70 | Train Loss: 0.223 Vali Loss: 33.360 Vali Acc: 0.520 Test Loss: 33.360 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.39893651008606
Epoch: 33, Steps: 70 | Train Loss: 0.264 Vali Loss: 26.440 Vali Acc: 0.480 Test Loss: 26.440 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 7.57763147354126
Epoch: 34, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 7.545697450637817
Epoch: 35, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.827189922332764
Epoch: 36, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.514607667922974
Epoch: 37, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 7.518380165100098
Epoch: 38, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 7.786715030670166
Epoch: 39, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 6.691166400909424
Epoch: 40, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 6.798707962036133
Epoch: 41, Steps: 70 | Train Loss: 0.000 Vali Loss: 26.343 Vali Acc: 0.480 Test Loss: 26.343 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1647066
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.481972932815552
Epoch: 1, Steps: 70 | Train Loss: 8.534 Vali Loss: 13.870 Vali Acc: 0.510 Test Loss: 13.870 Test Acc: 0.510
Validation loss decreased (inf --> -0.509861).  Saving model ...
Epoch: 2 cost time: 7.807094097137451
Epoch: 2, Steps: 70 | Train Loss: 14.043 Vali Loss: 14.090 Vali Acc: 0.480 Test Loss: 14.090 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.8281450271606445
Epoch: 3, Steps: 70 | Train Loss: 19.146 Vali Loss: 55.852 Vali Acc: 0.500 Test Loss: 55.852 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.859220266342163
Epoch: 4, Steps: 70 | Train Loss: 22.318 Vali Loss: 19.211 Vali Acc: 0.490 Test Loss: 19.211 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.4708945751190186
Epoch: 5, Steps: 70 | Train Loss: 15.980 Vali Loss: 7.274 Vali Acc: 0.460 Test Loss: 7.274 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.7784647941589355
Epoch: 6, Steps: 70 | Train Loss: 11.254 Vali Loss: 35.976 Vali Acc: 0.490 Test Loss: 35.976 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.7955193519592285
Epoch: 7, Steps: 70 | Train Loss: 20.448 Vali Loss: 47.977 Vali Acc: 0.500 Test Loss: 47.977 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.482604265213013
Epoch: 8, Steps: 70 | Train Loss: 19.605 Vali Loss: 22.385 Vali Acc: 0.480 Test Loss: 22.385 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.730509519577026
Epoch: 9, Steps: 70 | Train Loss: 12.807 Vali Loss: 57.547 Vali Acc: 0.510 Test Loss: 57.547 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.88280987739563
Epoch: 10, Steps: 70 | Train Loss: 10.262 Vali Loss: 32.072 Vali Acc: 0.440 Test Loss: 32.072 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.930667400360107
Epoch: 11, Steps: 70 | Train Loss: 7.238 Vali Loss: 30.552 Vali Acc: 0.480 Test Loss: 30.552 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 1646106
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.601643562316895
Epoch: 1, Steps: 70 | Train Loss: 12.003 Vali Loss: 9.660 Vali Acc: 0.530 Test Loss: 9.660 Test Acc: 0.530
Validation loss decreased (inf --> -0.529903).  Saving model ...
Epoch: 2 cost time: 7.556193113327026
Epoch: 2, Steps: 70 | Train Loss: 10.099 Vali Loss: 22.418 Vali Acc: 0.490 Test Loss: 22.418 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.408789396286011
Epoch: 3, Steps: 70 | Train Loss: 11.928 Vali Loss: 28.465 Vali Acc: 0.500 Test Loss: 28.465 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.907482385635376
Epoch: 4, Steps: 70 | Train Loss: 28.913 Vali Loss: 20.012 Vali Acc: 0.500 Test Loss: 20.012 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.668488502502441
Epoch: 5, Steps: 70 | Train Loss: 21.275 Vali Loss: 5.866 Vali Acc: 0.540 Test Loss: 5.866 Test Acc: 0.540
Validation loss decreased (-0.529903 --> -0.539941).  Saving model ...
Epoch: 6 cost time: 7.42488431930542
Epoch: 6, Steps: 70 | Train Loss: 9.334 Vali Loss: 11.243 Vali Acc: 0.510 Test Loss: 11.243 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.531080961227417
Epoch: 7, Steps: 70 | Train Loss: 13.082 Vali Loss: 3.541 Vali Acc: 0.510 Test Loss: 3.541 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.742462158203125
Epoch: 8, Steps: 70 | Train Loss: 11.482 Vali Loss: 12.993 Vali Acc: 0.560 Test Loss: 12.993 Test Acc: 0.560
Validation loss decreased (-0.539941 --> -0.559870).  Saving model ...
Epoch: 9 cost time: 7.965955972671509
Epoch: 9, Steps: 70 | Train Loss: 7.351 Vali Loss: 27.884 Vali Acc: 0.510 Test Loss: 27.884 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.9143266677856445
Epoch: 10, Steps: 70 | Train Loss: 9.353 Vali Loss: 18.428 Vali Acc: 0.540 Test Loss: 18.428 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.6613078117370605
Epoch: 11, Steps: 70 | Train Loss: 14.083 Vali Loss: 16.557 Vali Acc: 0.510 Test Loss: 16.557 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.840350151062012
Epoch: 12, Steps: 70 | Train Loss: 2.736 Vali Loss: 23.110 Vali Acc: 0.460 Test Loss: 23.110 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.822776556015015
Epoch: 13, Steps: 70 | Train Loss: 3.246 Vali Loss: 27.957 Vali Acc: 0.500 Test Loss: 27.957 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.743723154067993
Epoch: 14, Steps: 70 | Train Loss: 5.391 Vali Loss: 15.791 Vali Acc: 0.460 Test Loss: 15.791 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.898875713348389
Epoch: 15, Steps: 70 | Train Loss: 0.955 Vali Loss: 29.256 Vali Acc: 0.480 Test Loss: 29.256 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.86183762550354
Epoch: 16, Steps: 70 | Train Loss: 1.265 Vali Loss: 48.521 Vali Acc: 0.490 Test Loss: 48.521 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.864705562591553
Epoch: 17, Steps: 70 | Train Loss: 0.902 Vali Loss: 14.754 Vali Acc: 0.450 Test Loss: 14.754 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.55897855758667
Epoch: 18, Steps: 70 | Train Loss: 0.653 Vali Loss: 36.422 Vali Acc: 0.510 Test Loss: 36.422 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1638106
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.265581130981445
Epoch: 1, Steps: 70 | Train Loss: 4.927 Vali Loss: 10.170 Vali Acc: 0.490 Test Loss: 10.170 Test Acc: 0.490
Validation loss decreased (inf --> -0.489898).  Saving model ...
Epoch: 2 cost time: 7.229267358779907
Epoch: 2, Steps: 70 | Train Loss: 15.682 Vali Loss: 26.915 Vali Acc: 0.490 Test Loss: 26.915 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.204851150512695
Epoch: 3, Steps: 70 | Train Loss: 13.974 Vali Loss: 14.034 Vali Acc: 0.500 Test Loss: 14.034 Test Acc: 0.500
Validation loss decreased (-0.489898 --> -0.499860).  Saving model ...
Epoch: 4 cost time: 7.191150665283203
Epoch: 4, Steps: 70 | Train Loss: 11.252 Vali Loss: 6.184 Vali Acc: 0.500 Test Loss: 6.184 Test Acc: 0.500
Validation loss decreased (-0.499860 --> -0.499938).  Saving model ...
Epoch: 5 cost time: 7.030216932296753
Epoch: 5, Steps: 70 | Train Loss: 8.680 Vali Loss: 62.214 Vali Acc: 0.500 Test Loss: 62.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.250735759735107
Epoch: 6, Steps: 70 | Train Loss: 26.404 Vali Loss: 10.012 Vali Acc: 0.430 Test Loss: 10.012 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.233445405960083
Epoch: 7, Steps: 70 | Train Loss: 15.323 Vali Loss: 5.164 Vali Acc: 0.520 Test Loss: 5.164 Test Acc: 0.520
Validation loss decreased (-0.499938 --> -0.519948).  Saving model ...
Epoch: 8 cost time: 6.810436964035034
Epoch: 8, Steps: 70 | Train Loss: 12.136 Vali Loss: 7.054 Vali Acc: 0.550 Test Loss: 7.054 Test Acc: 0.550
Validation loss decreased (-0.519948 --> -0.549929).  Saving model ...
Epoch: 9 cost time: 6.6570329666137695
Epoch: 9, Steps: 70 | Train Loss: 9.061 Vali Loss: 31.511 Vali Acc: 0.510 Test Loss: 31.511 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.3587260246276855
Epoch: 10, Steps: 70 | Train Loss: 12.586 Vali Loss: 31.503 Vali Acc: 0.520 Test Loss: 31.503 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.525409460067749
Epoch: 11, Steps: 70 | Train Loss: 11.972 Vali Loss: 36.553 Vali Acc: 0.570 Test Loss: 36.553 Test Acc: 0.570
Validation loss decreased (-0.549929 --> -0.569634).  Saving model ...
Epoch: 12 cost time: 6.938120365142822
Epoch: 12, Steps: 70 | Train Loss: 2.851 Vali Loss: 17.475 Vali Acc: 0.560 Test Loss: 17.475 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.507549047470093
Epoch: 13, Steps: 70 | Train Loss: 4.060 Vali Loss: 30.087 Vali Acc: 0.440 Test Loss: 30.087 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.213391542434692
Epoch: 14, Steps: 70 | Train Loss: 1.239 Vali Loss: 22.480 Vali Acc: 0.530 Test Loss: 22.480 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.417132377624512
Epoch: 15, Steps: 70 | Train Loss: 0.691 Vali Loss: 28.283 Vali Acc: 0.470 Test Loss: 28.283 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.3356359004974365
Epoch: 16, Steps: 70 | Train Loss: 1.598 Vali Loss: 31.308 Vali Acc: 0.460 Test Loss: 31.308 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.199694395065308
Epoch: 17, Steps: 70 | Train Loss: 0.862 Vali Loss: 16.312 Vali Acc: 0.560 Test Loss: 16.312 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.4087347984313965
Epoch: 18, Steps: 70 | Train Loss: 0.099 Vali Loss: 14.193 Vali Acc: 0.550 Test Loss: 14.193 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.065029621124268
Epoch: 19, Steps: 70 | Train Loss: 0.368 Vali Loss: 31.776 Vali Acc: 0.470 Test Loss: 31.776 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.836452484130859
Epoch: 20, Steps: 70 | Train Loss: 0.832 Vali Loss: 35.996 Vali Acc: 0.530 Test Loss: 35.996 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.328028917312622
Epoch: 21, Steps: 70 | Train Loss: 1.494 Vali Loss: 29.956 Vali Acc: 0.450 Test Loss: 29.956 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1630106
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.026404142379761
Epoch: 1, Steps: 70 | Train Loss: 7.076 Vali Loss: 4.389 Vali Acc: 0.420 Test Loss: 4.389 Test Acc: 0.420
Validation loss decreased (inf --> -0.419956).  Saving model ...
Epoch: 2 cost time: 6.730176687240601
Epoch: 2, Steps: 70 | Train Loss: 9.051 Vali Loss: 12.707 Vali Acc: 0.460 Test Loss: 12.707 Test Acc: 0.460
Validation loss decreased (-0.419956 --> -0.459873).  Saving model ...
Epoch: 3 cost time: 6.909782886505127
Epoch: 3, Steps: 70 | Train Loss: 17.180 Vali Loss: 15.634 Vali Acc: 0.480 Test Loss: 15.634 Test Acc: 0.480
Validation loss decreased (-0.459873 --> -0.479844).  Saving model ...
Epoch: 4 cost time: 5.947526931762695
Epoch: 4, Steps: 70 | Train Loss: 25.779 Vali Loss: 17.178 Vali Acc: 0.500 Test Loss: 17.178 Test Acc: 0.500
Validation loss decreased (-0.479844 --> -0.499828).  Saving model ...
Epoch: 5 cost time: 6.65991735458374
Epoch: 5, Steps: 70 | Train Loss: 16.152 Vali Loss: 6.286 Vali Acc: 0.580 Test Loss: 6.286 Test Acc: 0.580
Validation loss decreased (-0.499828 --> -0.579937).  Saving model ...
Epoch: 6 cost time: 7.022277593612671
Epoch: 6, Steps: 70 | Train Loss: 14.375 Vali Loss: 11.840 Vali Acc: 0.460 Test Loss: 11.840 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.012813568115234
Epoch: 7, Steps: 70 | Train Loss: 10.609 Vali Loss: 47.143 Vali Acc: 0.500 Test Loss: 47.143 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.479335069656372
Epoch: 8, Steps: 70 | Train Loss: 6.924 Vali Loss: 7.875 Vali Acc: 0.500 Test Loss: 7.875 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.853475093841553
Epoch: 9, Steps: 70 | Train Loss: 8.036 Vali Loss: 59.035 Vali Acc: 0.500 Test Loss: 59.035 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.2546985149383545
Epoch: 10, Steps: 70 | Train Loss: 8.153 Vali Loss: 12.973 Vali Acc: 0.530 Test Loss: 12.973 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.560743570327759
Epoch: 11, Steps: 70 | Train Loss: 4.907 Vali Loss: 23.420 Vali Acc: 0.500 Test Loss: 23.420 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.949951648712158
Epoch: 12, Steps: 70 | Train Loss: 3.980 Vali Loss: 21.010 Vali Acc: 0.550 Test Loss: 21.010 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.184998989105225
Epoch: 13, Steps: 70 | Train Loss: 2.958 Vali Loss: 27.470 Vali Acc: 0.440 Test Loss: 27.470 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.494365453720093
Epoch: 14, Steps: 70 | Train Loss: 9.381 Vali Loss: 32.385 Vali Acc: 0.510 Test Loss: 32.385 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.9096152782440186
Epoch: 15, Steps: 70 | Train Loss: 5.969 Vali Loss: 12.766 Vali Acc: 0.500 Test Loss: 12.766 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_Crossformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1622106
model size : 6.86MB
