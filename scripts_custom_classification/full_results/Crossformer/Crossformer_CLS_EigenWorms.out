Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.340942859649658
Epoch: 1, Steps: 32 | Train Loss: 5.224 Vali Loss: 8.520 Vali Acc: 0.420 Test Loss: 8.520 Test Acc: 0.420
Validation loss decreased (inf --> -0.419762).  Saving model ...
Epoch: 2 cost time: 13.799051284790039
Epoch: 2, Steps: 32 | Train Loss: 11.697 Vali Loss: 23.798 Vali Acc: 0.176 Test Loss: 23.798 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.801398277282715
Epoch: 3, Steps: 32 | Train Loss: 5.082 Vali Loss: 5.987 Vali Acc: 0.427 Test Loss: 5.987 Test Acc: 0.427
Validation loss decreased (-0.419762 --> -0.427421).  Saving model ...
Epoch: 4 cost time: 14.003266096115112
Epoch: 4, Steps: 32 | Train Loss: 2.608 Vali Loss: 8.357 Vali Acc: 0.389 Test Loss: 8.357 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.074905633926392
Epoch: 5, Steps: 32 | Train Loss: 1.389 Vali Loss: 17.361 Vali Acc: 0.198 Test Loss: 17.361 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.159850597381592
Epoch: 6, Steps: 32 | Train Loss: 1.887 Vali Loss: 11.484 Vali Acc: 0.466 Test Loss: 11.484 Test Acc: 0.466
Validation loss decreased (-0.427421 --> -0.465534).  Saving model ...
Epoch: 7 cost time: 14.135290622711182
Epoch: 7, Steps: 32 | Train Loss: 1.087 Vali Loss: 10.183 Vali Acc: 0.458 Test Loss: 10.183 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.023366689682007
Epoch: 8, Steps: 32 | Train Loss: 0.397 Vali Loss: 13.098 Vali Acc: 0.382 Test Loss: 13.098 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.236879587173462
Epoch: 9, Steps: 32 | Train Loss: 3.344 Vali Loss: 14.503 Vali Acc: 0.435 Test Loss: 14.503 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.560015678405762
Epoch: 10, Steps: 32 | Train Loss: 4.394 Vali Loss: 17.510 Vali Acc: 0.275 Test Loss: 17.510 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.098228216171265
Epoch: 11, Steps: 32 | Train Loss: 25.449 Vali Loss: 24.396 Vali Acc: 0.137 Test Loss: 24.396 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.663231372833252
Epoch: 12, Steps: 32 | Train Loss: 22.983 Vali Loss: 12.971 Vali Acc: 0.137 Test Loss: 12.971 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.822881698608398
Epoch: 13, Steps: 32 | Train Loss: 12.742 Vali Loss: 8.048 Vali Acc: 0.137 Test Loss: 8.048 Test Acc: 0.137
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.383718729019165
Epoch: 14, Steps: 32 | Train Loss: 9.713 Vali Loss: 6.718 Vali Acc: 0.176 Test Loss: 6.718 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.660271644592285
Epoch: 15, Steps: 32 | Train Loss: 8.234 Vali Loss: 3.024 Vali Acc: 0.176 Test Loss: 3.024 Test Acc: 0.176
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.200170278549194
Epoch: 16, Steps: 32 | Train Loss: 6.660 Vali Loss: 7.897 Vali Acc: 0.137 Test Loss: 7.897 Test Acc: 0.137
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 20877121
model size : 97.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.620649099349976
Epoch: 1, Steps: 32 | Train Loss: 6.659 Vali Loss: 13.341 Vali Acc: 0.176 Test Loss: 13.341 Test Acc: 0.176
Validation loss decreased (inf --> -0.175439).  Saving model ...
Epoch: 2 cost time: 14.067203521728516
Epoch: 2, Steps: 32 | Train Loss: 8.027 Vali Loss: 11.598 Vali Acc: 0.191 Test Loss: 11.598 Test Acc: 0.191
Validation loss decreased (-0.175439 --> -0.190724).  Saving model ...
Epoch: 3 cost time: 13.8816978931427
Epoch: 3, Steps: 32 | Train Loss: 3.520 Vali Loss: 6.519 Vali Acc: 0.344 Test Loss: 6.519 Test Acc: 0.344
Validation loss decreased (-0.190724 --> -0.343446).  Saving model ...
Epoch: 4 cost time: 13.965613603591919
Epoch: 4, Steps: 32 | Train Loss: 2.565 Vali Loss: 9.793 Vali Acc: 0.252 Test Loss: 9.793 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.833375453948975
Epoch: 5, Steps: 32 | Train Loss: 1.373 Vali Loss: 9.192 Vali Acc: 0.466 Test Loss: 9.192 Test Acc: 0.466
Validation loss decreased (-0.343446 --> -0.465557).  Saving model ...
Epoch: 6 cost time: 13.740879774093628
Epoch: 6, Steps: 32 | Train Loss: 1.563 Vali Loss: 15.285 Vali Acc: 0.519 Test Loss: 15.285 Test Acc: 0.519
Validation loss decreased (-0.465557 --> -0.518931).  Saving model ...
Epoch: 7 cost time: 14.170494794845581
Epoch: 7, Steps: 32 | Train Loss: 0.590 Vali Loss: 11.745 Vali Acc: 0.336 Test Loss: 11.745 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.899534940719604
Epoch: 8, Steps: 32 | Train Loss: 0.409 Vali Loss: 10.822 Vali Acc: 0.420 Test Loss: 10.822 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.02549695968628
Epoch: 9, Steps: 32 | Train Loss: 0.516 Vali Loss: 16.575 Vali Acc: 0.305 Test Loss: 16.575 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.103132247924805
Epoch: 10, Steps: 32 | Train Loss: 1.355 Vali Loss: 17.296 Vali Acc: 0.443 Test Loss: 17.296 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.957799673080444
Epoch: 11, Steps: 32 | Train Loss: 0.752 Vali Loss: 16.787 Vali Acc: 0.458 Test Loss: 16.787 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.146247863769531
Epoch: 12, Steps: 32 | Train Loss: 13.825 Vali Loss: 46.169 Vali Acc: 0.137 Test Loss: 46.169 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.560472011566162
Epoch: 13, Steps: 32 | Train Loss: 37.692 Vali Loss: 57.356 Vali Acc: 0.099 Test Loss: 57.356 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.317447185516357
Epoch: 14, Steps: 32 | Train Loss: 46.124 Vali Loss: 55.375 Vali Acc: 0.137 Test Loss: 55.375 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.498789310455322
Epoch: 15, Steps: 32 | Train Loss: 28.801 Vali Loss: 34.992 Vali Acc: 0.420 Test Loss: 34.992 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.581351280212402
Epoch: 16, Steps: 32 | Train Loss: 17.197 Vali Loss: 9.631 Vali Acc: 0.420 Test Loss: 9.631 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 20157249
model size : 94.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.962786436080933
Epoch: 1, Steps: 32 | Train Loss: 4.975 Vali Loss: 6.831 Vali Acc: 0.244 Test Loss: 6.831 Test Acc: 0.244
Validation loss decreased (inf --> -0.244206).  Saving model ...
Epoch: 2 cost time: 13.978838205337524
Epoch: 2, Steps: 32 | Train Loss: 5.134 Vali Loss: 4.306 Vali Acc: 0.443 Test Loss: 4.306 Test Acc: 0.443
Validation loss decreased (-0.244206 --> -0.442705).  Saving model ...
Epoch: 3 cost time: 13.663766860961914
Epoch: 3, Steps: 32 | Train Loss: 2.600 Vali Loss: 7.477 Vali Acc: 0.481 Test Loss: 7.477 Test Acc: 0.481
Validation loss decreased (-0.442705 --> -0.480841).  Saving model ...
Epoch: 4 cost time: 13.598430871963501
Epoch: 4, Steps: 32 | Train Loss: 1.595 Vali Loss: 7.208 Vali Acc: 0.443 Test Loss: 7.208 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.835819959640503
Epoch: 5, Steps: 32 | Train Loss: 2.302 Vali Loss: 11.020 Vali Acc: 0.527 Test Loss: 11.020 Test Acc: 0.527
Validation loss decreased (-0.480841 --> -0.526607).  Saving model ...
Epoch: 6 cost time: 13.816968441009521
Epoch: 6, Steps: 32 | Train Loss: 1.159 Vali Loss: 13.191 Vali Acc: 0.382 Test Loss: 13.191 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.867508888244629
Epoch: 7, Steps: 32 | Train Loss: 0.987 Vali Loss: 11.102 Vali Acc: 0.435 Test Loss: 11.102 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.833662271499634
Epoch: 8, Steps: 32 | Train Loss: 1.585 Vali Loss: 11.021 Vali Acc: 0.443 Test Loss: 11.021 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.659590482711792
Epoch: 9, Steps: 32 | Train Loss: 6.593 Vali Loss: 16.599 Vali Acc: 0.344 Test Loss: 16.599 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.10469388961792
Epoch: 10, Steps: 32 | Train Loss: 19.509 Vali Loss: 11.426 Vali Acc: 0.420 Test Loss: 11.426 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.938512563705444
Epoch: 11, Steps: 32 | Train Loss: 18.632 Vali Loss: 31.962 Vali Acc: 0.420 Test Loss: 31.962 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.02255368232727
Epoch: 12, Steps: 32 | Train Loss: 27.492 Vali Loss: 26.710 Vali Acc: 0.168 Test Loss: 26.710 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.082913160324097
Epoch: 13, Steps: 32 | Train Loss: 17.111 Vali Loss: 23.219 Vali Acc: 0.176 Test Loss: 23.219 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.725005388259888
Epoch: 14, Steps: 32 | Train Loss: 14.705 Vali Loss: 6.594 Vali Acc: 0.420 Test Loss: 6.594 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.483342170715332
Epoch: 15, Steps: 32 | Train Loss: 10.828 Vali Loss: 11.860 Vali Acc: 0.420 Test Loss: 11.860 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 19437377
model size : 91.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.642647981643677
Epoch: 1, Steps: 32 | Train Loss: 3.755 Vali Loss: 9.197 Vali Acc: 0.137 Test Loss: 9.197 Test Acc: 0.137
Validation loss decreased (inf --> -0.137313).  Saving model ...
Epoch: 2 cost time: 13.408241033554077
Epoch: 2, Steps: 32 | Train Loss: 5.610 Vali Loss: 9.974 Vali Acc: 0.153 Test Loss: 9.974 Test Acc: 0.153
Validation loss decreased (-0.137313 --> -0.152572).  Saving model ...
Epoch: 3 cost time: 13.443271398544312
Epoch: 3, Steps: 32 | Train Loss: 3.529 Vali Loss: 6.957 Vali Acc: 0.450 Test Loss: 6.957 Test Acc: 0.450
Validation loss decreased (-0.152572 --> -0.450312).  Saving model ...
Epoch: 4 cost time: 13.517455339431763
Epoch: 4, Steps: 32 | Train Loss: 1.432 Vali Loss: 7.261 Vali Acc: 0.473 Test Loss: 7.261 Test Acc: 0.473
Validation loss decreased (-0.450312 --> -0.473210).  Saving model ...
Epoch: 5 cost time: 14.092805624008179
Epoch: 5, Steps: 32 | Train Loss: 1.713 Vali Loss: 11.198 Vali Acc: 0.489 Test Loss: 11.198 Test Acc: 0.489
Validation loss decreased (-0.473210 --> -0.488438).  Saving model ...
Epoch: 6 cost time: 13.529718399047852
Epoch: 6, Steps: 32 | Train Loss: 0.363 Vali Loss: 10.650 Vali Acc: 0.397 Test Loss: 10.650 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.34274673461914
Epoch: 7, Steps: 32 | Train Loss: 0.884 Vali Loss: 10.141 Vali Acc: 0.412 Test Loss: 10.141 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.656895399093628
Epoch: 8, Steps: 32 | Train Loss: 1.527 Vali Loss: 14.256 Vali Acc: 0.374 Test Loss: 14.256 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.555314540863037
Epoch: 9, Steps: 32 | Train Loss: 1.107 Vali Loss: 17.066 Vali Acc: 0.473 Test Loss: 17.066 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.18711543083191
Epoch: 10, Steps: 32 | Train Loss: 0.971 Vali Loss: 15.995 Vali Acc: 0.458 Test Loss: 15.995 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.44843316078186
Epoch: 11, Steps: 32 | Train Loss: 1.840 Vali Loss: 15.949 Vali Acc: 0.328 Test Loss: 15.949 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.409558057785034
Epoch: 12, Steps: 32 | Train Loss: 1.208 Vali Loss: 27.667 Vali Acc: 0.237 Test Loss: 27.667 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.43801498413086
Epoch: 13, Steps: 32 | Train Loss: 1.650 Vali Loss: 27.238 Vali Acc: 0.489 Test Loss: 27.238 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.89226222038269
Epoch: 14, Steps: 32 | Train Loss: 2.554 Vali Loss: 25.346 Vali Acc: 0.252 Test Loss: 25.346 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.37614631652832
Epoch: 15, Steps: 32 | Train Loss: 0.575 Vali Loss: 21.279 Vali Acc: 0.405 Test Loss: 21.279 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 18717505
model size : 89.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.716089248657227
Epoch: 1, Steps: 32 | Train Loss: 4.614 Vali Loss: 14.330 Vali Acc: 0.137 Test Loss: 14.330 Test Acc: 0.137
Validation loss decreased (inf --> -0.137261).  Saving model ...
Epoch: 2 cost time: 13.846645832061768
Epoch: 2, Steps: 32 | Train Loss: 10.984 Vali Loss: 9.035 Vali Acc: 0.130 Test Loss: 9.035 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.506165742874146
Epoch: 3, Steps: 32 | Train Loss: 5.877 Vali Loss: 6.789 Vali Acc: 0.550 Test Loss: 6.789 Test Acc: 0.550
Validation loss decreased (-0.137261 --> -0.549550).  Saving model ...
Epoch: 4 cost time: 14.003578901290894
Epoch: 4, Steps: 32 | Train Loss: 2.455 Vali Loss: 7.551 Vali Acc: 0.443 Test Loss: 7.551 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.551690578460693
Epoch: 5, Steps: 32 | Train Loss: 1.258 Vali Loss: 7.095 Vali Acc: 0.450 Test Loss: 7.095 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.930468320846558
Epoch: 6, Steps: 32 | Train Loss: 1.808 Vali Loss: 8.264 Vali Acc: 0.504 Test Loss: 8.264 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.90881061553955
Epoch: 7, Steps: 32 | Train Loss: 0.441 Vali Loss: 10.241 Vali Acc: 0.504 Test Loss: 10.241 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.35480809211731
Epoch: 8, Steps: 32 | Train Loss: 0.209 Vali Loss: 13.235 Vali Acc: 0.389 Test Loss: 13.235 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.561905860900879
Epoch: 9, Steps: 32 | Train Loss: 1.041 Vali Loss: 11.986 Vali Acc: 0.435 Test Loss: 11.986 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.227270364761353
Epoch: 10, Steps: 32 | Train Loss: 2.416 Vali Loss: 15.609 Vali Acc: 0.466 Test Loss: 15.609 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.660542488098145
Epoch: 11, Steps: 32 | Train Loss: 1.192 Vali Loss: 23.000 Vali Acc: 0.374 Test Loss: 23.000 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.898017168045044
Epoch: 12, Steps: 32 | Train Loss: 2.453 Vali Loss: 17.048 Vali Acc: 0.321 Test Loss: 17.048 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.708289384841919
Epoch: 13, Steps: 32 | Train Loss: 1.372 Vali Loss: 18.233 Vali Acc: 0.397 Test Loss: 18.233 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 18513217
model size : 88.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.32297658920288
Epoch: 1, Steps: 32 | Train Loss: 7.569 Vali Loss: 13.370 Vali Acc: 0.137 Test Loss: 13.370 Test Acc: 0.137
Validation loss decreased (inf --> -0.137271).  Saving model ...
Epoch: 2 cost time: 13.539110660552979
Epoch: 2, Steps: 32 | Train Loss: 11.006 Vali Loss: 6.769 Vali Acc: 0.198 Test Loss: 6.769 Test Acc: 0.198
Validation loss decreased (-0.137271 --> -0.198406).  Saving model ...
Epoch: 3 cost time: 13.319590330123901
Epoch: 3, Steps: 32 | Train Loss: 3.483 Vali Loss: 7.743 Vali Acc: 0.420 Test Loss: 7.743 Test Acc: 0.420
Validation loss decreased (-0.198406 --> -0.419770).  Saving model ...
Epoch: 4 cost time: 13.40741777420044
Epoch: 4, Steps: 32 | Train Loss: 2.258 Vali Loss: 6.901 Vali Acc: 0.443 Test Loss: 6.901 Test Acc: 0.443
Validation loss decreased (-0.419770 --> -0.442679).  Saving model ...
Epoch: 5 cost time: 13.27532410621643
Epoch: 5, Steps: 32 | Train Loss: 1.108 Vali Loss: 8.128 Vali Acc: 0.427 Test Loss: 8.128 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.473713397979736
Epoch: 6, Steps: 32 | Train Loss: 2.099 Vali Loss: 9.696 Vali Acc: 0.351 Test Loss: 9.696 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.317623853683472
Epoch: 7, Steps: 32 | Train Loss: 0.677 Vali Loss: 9.169 Vali Acc: 0.435 Test Loss: 9.169 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.36452054977417
Epoch: 8, Steps: 32 | Train Loss: 1.001 Vali Loss: 13.877 Vali Acc: 0.389 Test Loss: 13.877 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.399943351745605
Epoch: 9, Steps: 32 | Train Loss: 0.758 Vali Loss: 13.971 Vali Acc: 0.435 Test Loss: 13.971 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.46621561050415
Epoch: 10, Steps: 32 | Train Loss: 0.587 Vali Loss: 12.691 Vali Acc: 0.473 Test Loss: 12.691 Test Acc: 0.473
Validation loss decreased (-0.442679 --> -0.473156).  Saving model ...
Epoch: 11 cost time: 13.994139194488525
Epoch: 11, Steps: 32 | Train Loss: 1.239 Vali Loss: 15.471 Vali Acc: 0.321 Test Loss: 15.471 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.043229103088379
Epoch: 12, Steps: 32 | Train Loss: 13.421 Vali Loss: 40.900 Vali Acc: 0.168 Test Loss: 40.900 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.9247465133667
Epoch: 13, Steps: 32 | Train Loss: 45.465 Vali Loss: 25.509 Vali Acc: 0.420 Test Loss: 25.509 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.614609003067017
Epoch: 14, Steps: 32 | Train Loss: 29.564 Vali Loss: 18.295 Vali Acc: 0.137 Test Loss: 18.295 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.444709300994873
Epoch: 15, Steps: 32 | Train Loss: 21.173 Vali Loss: 17.134 Vali Acc: 0.137 Test Loss: 17.134 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.892602682113647
Epoch: 16, Steps: 32 | Train Loss: 21.938 Vali Loss: 20.593 Vali Acc: 0.420 Test Loss: 20.593 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.056403398513794
Epoch: 17, Steps: 32 | Train Loss: 14.678 Vali Loss: 9.898 Vali Acc: 0.137 Test Loss: 9.898 Test Acc: 0.137
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.416242837905884
Epoch: 18, Steps: 32 | Train Loss: 13.817 Vali Loss: 12.597 Vali Acc: 0.420 Test Loss: 12.597 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.02649712562561
Epoch: 19, Steps: 32 | Train Loss: 10.868 Vali Loss: 10.126 Vali Acc: 0.137 Test Loss: 10.126 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.963319778442383
Epoch: 20, Steps: 32 | Train Loss: 8.845 Vali Loss: 8.631 Vali Acc: 0.176 Test Loss: 8.631 Test Acc: 0.176
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 17793345
model size : 85.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.257088422775269
Epoch: 1, Steps: 32 | Train Loss: 4.046 Vali Loss: 3.767 Vali Acc: 0.427 Test Loss: 3.767 Test Acc: 0.427
Validation loss decreased (inf --> -0.427443).  Saving model ...
Epoch: 2 cost time: 13.538329839706421
Epoch: 2, Steps: 32 | Train Loss: 5.555 Vali Loss: 7.424 Vali Acc: 0.359 Test Loss: 7.424 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.376826524734497
Epoch: 3, Steps: 32 | Train Loss: 3.710 Vali Loss: 4.931 Vali Acc: 0.466 Test Loss: 4.931 Test Acc: 0.466
Validation loss decreased (-0.427443 --> -0.465600).  Saving model ...
Epoch: 4 cost time: 13.584315061569214
Epoch: 4, Steps: 32 | Train Loss: 1.561 Vali Loss: 8.173 Vali Acc: 0.489 Test Loss: 8.173 Test Acc: 0.489
Validation loss decreased (-0.465600 --> -0.488468).  Saving model ...
Epoch: 5 cost time: 13.41937804222107
Epoch: 5, Steps: 32 | Train Loss: 1.258 Vali Loss: 9.480 Vali Acc: 0.466 Test Loss: 9.480 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.508031845092773
Epoch: 6, Steps: 32 | Train Loss: 0.734 Vali Loss: 16.527 Vali Acc: 0.275 Test Loss: 16.527 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.869009256362915
Epoch: 7, Steps: 32 | Train Loss: 0.786 Vali Loss: 10.824 Vali Acc: 0.489 Test Loss: 10.824 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.736903190612793
Epoch: 8, Steps: 32 | Train Loss: 0.079 Vali Loss: 11.575 Vali Acc: 0.489 Test Loss: 11.575 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.801209926605225
Epoch: 9, Steps: 32 | Train Loss: 0.315 Vali Loss: 18.665 Vali Acc: 0.344 Test Loss: 18.665 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.630575180053711
Epoch: 10, Steps: 32 | Train Loss: 0.397 Vali Loss: 18.948 Vali Acc: 0.466 Test Loss: 18.948 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.309256315231323
Epoch: 11, Steps: 32 | Train Loss: 1.873 Vali Loss: 16.037 Vali Acc: 0.519 Test Loss: 16.037 Test Acc: 0.519
Validation loss decreased (-0.488468 --> -0.518924).  Saving model ...
Epoch: 12 cost time: 13.750534772872925
Epoch: 12, Steps: 32 | Train Loss: 5.459 Vali Loss: 20.208 Vali Acc: 0.336 Test Loss: 20.208 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.543691396713257
Epoch: 13, Steps: 32 | Train Loss: 1.781 Vali Loss: 20.554 Vali Acc: 0.443 Test Loss: 20.554 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.858420610427856
Epoch: 14, Steps: 32 | Train Loss: 3.028 Vali Loss: 24.986 Vali Acc: 0.405 Test Loss: 24.986 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.692479610443115
Epoch: 15, Steps: 32 | Train Loss: 12.083 Vali Loss: 34.671 Vali Acc: 0.191 Test Loss: 34.671 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.571738719940186
Epoch: 16, Steps: 32 | Train Loss: 11.761 Vali Loss: 14.757 Vali Acc: 0.420 Test Loss: 14.757 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.522343873977661
Epoch: 17, Steps: 32 | Train Loss: 15.250 Vali Loss: 41.185 Vali Acc: 0.176 Test Loss: 41.185 Test Acc: 0.176
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.502345085144043
Epoch: 18, Steps: 32 | Train Loss: 26.380 Vali Loss: 16.643 Vali Acc: 0.198 Test Loss: 16.643 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.792316913604736
Epoch: 19, Steps: 32 | Train Loss: 32.268 Vali Loss: 23.196 Vali Acc: 0.389 Test Loss: 23.196 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 13.63748574256897
Epoch: 20, Steps: 32 | Train Loss: 16.740 Vali Loss: 11.176 Vali Acc: 0.252 Test Loss: 11.176 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.81421685218811
Epoch: 21, Steps: 32 | Train Loss: 7.679 Vali Loss: 19.180 Vali Acc: 0.221 Test Loss: 19.180 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 17073473
model size : 82.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.351475477218628
Epoch: 1, Steps: 32 | Train Loss: 3.015 Vali Loss: 5.355 Vali Acc: 0.099 Test Loss: 5.355 Test Acc: 0.099
Validation loss decreased (inf --> -0.099183).  Saving model ...
Epoch: 2 cost time: 13.180880546569824
Epoch: 2, Steps: 32 | Train Loss: 7.436 Vali Loss: 4.858 Vali Acc: 0.282 Test Loss: 4.858 Test Acc: 0.282
Validation loss decreased (-0.099183 --> -0.282394).  Saving model ...
Epoch: 3 cost time: 13.364246368408203
Epoch: 3, Steps: 32 | Train Loss: 2.792 Vali Loss: 5.951 Vali Acc: 0.359 Test Loss: 5.951 Test Acc: 0.359
Validation loss decreased (-0.282394 --> -0.358719).  Saving model ...
Epoch: 4 cost time: 13.345704317092896
Epoch: 4, Steps: 32 | Train Loss: 1.589 Vali Loss: 7.742 Vali Acc: 0.504 Test Loss: 7.742 Test Acc: 0.504
Validation loss decreased (-0.358719 --> -0.503739).  Saving model ...
Epoch: 5 cost time: 13.284193515777588
Epoch: 5, Steps: 32 | Train Loss: 1.384 Vali Loss: 9.517 Vali Acc: 0.534 Test Loss: 9.517 Test Acc: 0.534
Validation loss decreased (-0.503739 --> -0.534256).  Saving model ...
Epoch: 6 cost time: 13.457973003387451
Epoch: 6, Steps: 32 | Train Loss: 0.903 Vali Loss: 11.143 Vali Acc: 0.435 Test Loss: 11.143 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.854609966278076
Epoch: 7, Steps: 32 | Train Loss: 0.666 Vali Loss: 12.417 Vali Acc: 0.489 Test Loss: 12.417 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.49222445487976
Epoch: 8, Steps: 32 | Train Loss: 0.102 Vali Loss: 19.144 Vali Acc: 0.511 Test Loss: 19.144 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.292027473449707
Epoch: 9, Steps: 32 | Train Loss: 0.532 Vali Loss: 14.575 Vali Acc: 0.458 Test Loss: 14.575 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.16429615020752
Epoch: 10, Steps: 32 | Train Loss: 2.186 Vali Loss: 18.200 Vali Acc: 0.397 Test Loss: 18.200 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.313125133514404
Epoch: 11, Steps: 32 | Train Loss: 1.596 Vali Loss: 17.752 Vali Acc: 0.321 Test Loss: 17.752 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.504982709884644
Epoch: 12, Steps: 32 | Train Loss: 3.826 Vali Loss: 15.417 Vali Acc: 0.412 Test Loss: 15.417 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.673201322555542
Epoch: 13, Steps: 32 | Train Loss: 0.881 Vali Loss: 18.980 Vali Acc: 0.458 Test Loss: 18.980 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.34907865524292
Epoch: 14, Steps: 32 | Train Loss: 2.425 Vali Loss: 14.508 Vali Acc: 0.298 Test Loss: 14.508 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.035574436187744
Epoch: 15, Steps: 32 | Train Loss: 0.457 Vali Loss: 18.380 Vali Acc: 0.389 Test Loss: 18.380 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 16353601
model size : 80.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.206927061080933
Epoch: 1, Steps: 32 | Train Loss: 7.236 Vali Loss: 10.095 Vali Acc: 0.168 Test Loss: 10.095 Test Acc: 0.168
Validation loss decreased (inf --> -0.167838).  Saving model ...
Epoch: 2 cost time: 13.278406858444214
Epoch: 2, Steps: 32 | Train Loss: 7.463 Vali Loss: 15.252 Vali Acc: 0.137 Test Loss: 15.252 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.493008852005005
Epoch: 3, Steps: 32 | Train Loss: 7.117 Vali Loss: 7.399 Vali Acc: 0.412 Test Loss: 7.399 Test Acc: 0.412
Validation loss decreased (-0.167838 --> -0.412140).  Saving model ...
Epoch: 4 cost time: 13.26010775566101
Epoch: 4, Steps: 32 | Train Loss: 1.574 Vali Loss: 7.329 Vali Acc: 0.336 Test Loss: 7.329 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.639561653137207
Epoch: 5, Steps: 32 | Train Loss: 2.166 Vali Loss: 8.553 Vali Acc: 0.496 Test Loss: 8.553 Test Acc: 0.496
Validation loss decreased (-0.412140 --> -0.496098).  Saving model ...
Epoch: 6 cost time: 13.682599782943726
Epoch: 6, Steps: 32 | Train Loss: 1.822 Vali Loss: 7.423 Vali Acc: 0.443 Test Loss: 7.423 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.221837997436523
Epoch: 7, Steps: 32 | Train Loss: 0.298 Vali Loss: 10.444 Vali Acc: 0.473 Test Loss: 10.444 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.603073596954346
Epoch: 8, Steps: 32 | Train Loss: 0.207 Vali Loss: 12.525 Vali Acc: 0.466 Test Loss: 12.525 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.446026802062988
Epoch: 9, Steps: 32 | Train Loss: 0.164 Vali Loss: 14.916 Vali Acc: 0.466 Test Loss: 14.916 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.280144453048706
Epoch: 10, Steps: 32 | Train Loss: 0.133 Vali Loss: 12.159 Vali Acc: 0.496 Test Loss: 12.159 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.748355865478516
Epoch: 11, Steps: 32 | Train Loss: 0.462 Vali Loss: 17.455 Vali Acc: 0.420 Test Loss: 17.455 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.629104137420654
Epoch: 12, Steps: 32 | Train Loss: 0.796 Vali Loss: 16.446 Vali Acc: 0.374 Test Loss: 16.446 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.548934936523438
Epoch: 13, Steps: 32 | Train Loss: 0.338 Vali Loss: 17.929 Vali Acc: 0.458 Test Loss: 17.929 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.582581281661987
Epoch: 14, Steps: 32 | Train Loss: 5.826 Vali Loss: 48.158 Vali Acc: 0.130 Test Loss: 48.158 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.76456356048584
Epoch: 15, Steps: 32 | Train Loss: 26.150 Vali Loss: 26.870 Vali Acc: 0.351 Test Loss: 26.870 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 17331265
model size : 83.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.079635858535767
Epoch: 1, Steps: 32 | Train Loss: 5.558 Vali Loss: 7.712 Vali Acc: 0.420 Test Loss: 7.712 Test Acc: 0.420
Validation loss decreased (inf --> -0.419770).  Saving model ...
Epoch: 2 cost time: 13.523242235183716
Epoch: 2, Steps: 32 | Train Loss: 7.741 Vali Loss: 4.431 Vali Acc: 0.176 Test Loss: 4.431 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.593684196472168
Epoch: 3, Steps: 32 | Train Loss: 4.815 Vali Loss: 6.852 Vali Acc: 0.458 Test Loss: 6.852 Test Acc: 0.458
Validation loss decreased (-0.419770 --> -0.457947).  Saving model ...
Epoch: 4 cost time: 13.768279314041138
Epoch: 4, Steps: 32 | Train Loss: 1.820 Vali Loss: 7.643 Vali Acc: 0.504 Test Loss: 7.643 Test Acc: 0.504
Validation loss decreased (-0.457947 --> -0.503740).  Saving model ...
Epoch: 5 cost time: 13.882793188095093
Epoch: 5, Steps: 32 | Train Loss: 2.054 Vali Loss: 14.368 Vali Acc: 0.298 Test Loss: 14.368 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.522424221038818
Epoch: 6, Steps: 32 | Train Loss: 1.359 Vali Loss: 9.195 Vali Acc: 0.450 Test Loss: 9.195 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.717278242111206
Epoch: 7, Steps: 32 | Train Loss: 0.903 Vali Loss: 14.962 Vali Acc: 0.466 Test Loss: 14.962 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.066215515136719
Epoch: 8, Steps: 32 | Train Loss: 0.697 Vali Loss: 10.139 Vali Acc: 0.504 Test Loss: 10.139 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.325754642486572
Epoch: 9, Steps: 32 | Train Loss: 0.573 Vali Loss: 12.745 Vali Acc: 0.344 Test Loss: 12.745 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.395341634750366
Epoch: 10, Steps: 32 | Train Loss: 0.839 Vali Loss: 13.573 Vali Acc: 0.405 Test Loss: 13.573 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.977108001708984
Epoch: 11, Steps: 32 | Train Loss: 0.542 Vali Loss: 14.524 Vali Acc: 0.450 Test Loss: 14.524 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.65006947517395
Epoch: 12, Steps: 32 | Train Loss: 0.479 Vali Loss: 25.583 Vali Acc: 0.282 Test Loss: 25.583 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.069950342178345
Epoch: 13, Steps: 32 | Train Loss: 1.286 Vali Loss: 20.123 Vali Acc: 0.389 Test Loss: 20.123 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.767683982849121
Epoch: 14, Steps: 32 | Train Loss: 0.284 Vali Loss: 18.642 Vali Acc: 0.397 Test Loss: 18.642 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 16611393
model size : 81.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.467180728912354
Epoch: 1, Steps: 32 | Train Loss: 5.998 Vali Loss: 7.165 Vali Acc: 0.130 Test Loss: 7.165 Test Acc: 0.130
Validation loss decreased (inf --> -0.129699).  Saving model ...
Epoch: 2 cost time: 14.026511669158936
Epoch: 2, Steps: 32 | Train Loss: 6.478 Vali Loss: 11.246 Vali Acc: 0.183 Test Loss: 11.246 Test Acc: 0.183
Validation loss decreased (-0.129699 --> -0.183094).  Saving model ...
Epoch: 3 cost time: 13.914485454559326
Epoch: 3, Steps: 32 | Train Loss: 4.522 Vali Loss: 5.670 Vali Acc: 0.389 Test Loss: 5.670 Test Acc: 0.389
Validation loss decreased (-0.183094 --> -0.389256).  Saving model ...
Epoch: 4 cost time: 13.626754999160767
Epoch: 4, Steps: 32 | Train Loss: 3.095 Vali Loss: 7.458 Vali Acc: 0.489 Test Loss: 7.458 Test Acc: 0.489
Validation loss decreased (-0.389256 --> -0.488475).  Saving model ...
Epoch: 5 cost time: 14.002013444900513
Epoch: 5, Steps: 32 | Train Loss: 0.648 Vali Loss: 13.963 Vali Acc: 0.496 Test Loss: 13.963 Test Acc: 0.496
Validation loss decreased (-0.488475 --> -0.496044).  Saving model ...
Epoch: 6 cost time: 13.895870208740234
Epoch: 6, Steps: 32 | Train Loss: 1.075 Vali Loss: 12.620 Vali Acc: 0.321 Test Loss: 12.620 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.932319402694702
Epoch: 7, Steps: 32 | Train Loss: 0.762 Vali Loss: 7.609 Vali Acc: 0.443 Test Loss: 7.609 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.786987781524658
Epoch: 8, Steps: 32 | Train Loss: 0.619 Vali Loss: 13.215 Vali Acc: 0.466 Test Loss: 13.215 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.518213987350464
Epoch: 9, Steps: 32 | Train Loss: 0.554 Vali Loss: 14.670 Vali Acc: 0.298 Test Loss: 14.670 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.585506439208984
Epoch: 10, Steps: 32 | Train Loss: 0.253 Vali Loss: 16.660 Vali Acc: 0.374 Test Loss: 16.660 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.351173400878906
Epoch: 11, Steps: 32 | Train Loss: 1.211 Vali Loss: 17.957 Vali Acc: 0.366 Test Loss: 17.957 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.537546634674072
Epoch: 12, Steps: 32 | Train Loss: 7.864 Vali Loss: 10.868 Vali Acc: 0.412 Test Loss: 10.868 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.856372594833374
Epoch: 13, Steps: 32 | Train Loss: 19.668 Vali Loss: 25.363 Vali Acc: 0.176 Test Loss: 25.363 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.362956523895264
Epoch: 14, Steps: 32 | Train Loss: 18.778 Vali Loss: 15.525 Vali Acc: 0.237 Test Loss: 15.525 Test Acc: 0.237
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.451388597488403
Epoch: 15, Steps: 32 | Train Loss: 2.807 Vali Loss: 23.633 Vali Acc: 0.420 Test Loss: 23.633 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 15891521
model size : 78.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.98525071144104
Epoch: 1, Steps: 32 | Train Loss: 5.149 Vali Loss: 7.670 Vali Acc: 0.137 Test Loss: 7.670 Test Acc: 0.137
Validation loss decreased (inf --> -0.137328).  Saving model ...
Epoch: 2 cost time: 13.268848896026611
Epoch: 2, Steps: 32 | Train Loss: 4.339 Vali Loss: 4.982 Vali Acc: 0.229 Test Loss: 4.982 Test Acc: 0.229
Validation loss decreased (-0.137328 --> -0.228958).  Saving model ...
Epoch: 3 cost time: 12.901165246963501
Epoch: 3, Steps: 32 | Train Loss: 4.534 Vali Loss: 8.935 Vali Acc: 0.321 Test Loss: 8.935 Test Acc: 0.321
Validation loss decreased (-0.228958 --> -0.320521).  Saving model ...
Epoch: 4 cost time: 12.653616905212402
Epoch: 4, Steps: 32 | Train Loss: 4.133 Vali Loss: 8.889 Vali Acc: 0.351 Test Loss: 8.889 Test Acc: 0.351
Validation loss decreased (-0.320521 --> -0.351056).  Saving model ...
Epoch: 5 cost time: 12.949495077133179
Epoch: 5, Steps: 32 | Train Loss: 2.052 Vali Loss: 7.967 Vali Acc: 0.458 Test Loss: 7.967 Test Acc: 0.458
Validation loss decreased (-0.351056 --> -0.457936).  Saving model ...
Epoch: 6 cost time: 12.758463859558105
Epoch: 6, Steps: 32 | Train Loss: 0.572 Vali Loss: 12.230 Vali Acc: 0.344 Test Loss: 12.230 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.941831350326538
Epoch: 7, Steps: 32 | Train Loss: 0.534 Vali Loss: 10.279 Vali Acc: 0.473 Test Loss: 10.279 Test Acc: 0.473
Validation loss decreased (-0.457936 --> -0.473180).  Saving model ...
Epoch: 8 cost time: 12.709501504898071
Epoch: 8, Steps: 32 | Train Loss: 0.423 Vali Loss: 14.254 Vali Acc: 0.466 Test Loss: 14.254 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.939919233322144
Epoch: 9, Steps: 32 | Train Loss: 1.398 Vali Loss: 10.584 Vali Acc: 0.443 Test Loss: 10.584 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.920945644378662
Epoch: 10, Steps: 32 | Train Loss: 0.470 Vali Loss: 19.709 Vali Acc: 0.351 Test Loss: 19.709 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.37608027458191
Epoch: 11, Steps: 32 | Train Loss: 0.938 Vali Loss: 15.679 Vali Acc: 0.344 Test Loss: 15.679 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.194231033325195
Epoch: 12, Steps: 32 | Train Loss: 0.611 Vali Loss: 17.308 Vali Acc: 0.420 Test Loss: 17.308 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.919898748397827
Epoch: 13, Steps: 32 | Train Loss: 1.361 Vali Loss: 20.092 Vali Acc: 0.466 Test Loss: 20.092 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.047065258026123
Epoch: 14, Steps: 32 | Train Loss: 0.803 Vali Loss: 14.779 Vali Acc: 0.420 Test Loss: 14.779 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.84366750717163
Epoch: 15, Steps: 32 | Train Loss: 2.166 Vali Loss: 16.141 Vali Acc: 0.366 Test Loss: 16.141 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.878983736038208
Epoch: 16, Steps: 32 | Train Loss: 0.535 Vali Loss: 18.670 Vali Acc: 0.481 Test Loss: 18.670 Test Acc: 0.481
Validation loss decreased (-0.473180 --> -0.480729).  Saving model ...
Epoch: 17 cost time: 13.08437967300415
Epoch: 17, Steps: 32 | Train Loss: 1.156 Vali Loss: 20.942 Vali Acc: 0.405 Test Loss: 20.942 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.868685722351074
Epoch: 18, Steps: 32 | Train Loss: 0.046 Vali Loss: 21.203 Vali Acc: 0.481 Test Loss: 21.203 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.96804928779602
Epoch: 19, Steps: 32 | Train Loss: 0.310 Vali Loss: 26.221 Vali Acc: 0.504 Test Loss: 26.221 Test Acc: 0.504
Validation loss decreased (-0.480729 --> -0.503555).  Saving model ...
Epoch: 20 cost time: 13.006846189498901
Epoch: 20, Steps: 32 | Train Loss: 0.200 Vali Loss: 22.367 Vali Acc: 0.389 Test Loss: 22.367 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.458863496780396
Epoch: 21, Steps: 32 | Train Loss: 0.268 Vali Loss: 24.622 Vali Acc: 0.443 Test Loss: 24.622 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.364706993103027
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.369 Vali Acc: 0.336 Test Loss: 24.369 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.562081098556519
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.339 Vali Acc: 0.344 Test Loss: 24.339 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.431590795516968
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.525 Vali Acc: 0.321 Test Loss: 24.525 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.559200048446655
Epoch: 25, Steps: 32 | Train Loss: 0.591 Vali Loss: 19.594 Vali Acc: 0.458 Test Loss: 19.594 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 13.532368183135986
Epoch: 26, Steps: 32 | Train Loss: 1.222 Vali Loss: 21.501 Vali Acc: 0.397 Test Loss: 21.501 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.500536441802979
Epoch: 27, Steps: 32 | Train Loss: 0.479 Vali Loss: 35.735 Vali Acc: 0.229 Test Loss: 35.735 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 13.299716234207153
Epoch: 28, Steps: 32 | Train Loss: 7.112 Vali Loss: 19.724 Vali Acc: 0.191 Test Loss: 19.724 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 13.38463044166565
Epoch: 29, Steps: 32 | Train Loss: 64.986 Vali Loss: 82.446 Vali Acc: 0.397 Test Loss: 82.446 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 15171649
model size : 75.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.996548652648926
Epoch: 1, Steps: 32 | Train Loss: 3.515 Vali Loss: 8.421 Vali Acc: 0.427 Test Loss: 8.421 Test Acc: 0.427
Validation loss decreased (inf --> -0.427397).  Saving model ...
Epoch: 2 cost time: 14.30787467956543
Epoch: 2, Steps: 32 | Train Loss: 6.411 Vali Loss: 14.527 Vali Acc: 0.191 Test Loss: 14.527 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.628790855407715
Epoch: 3, Steps: 32 | Train Loss: 4.355 Vali Loss: 10.095 Vali Acc: 0.466 Test Loss: 10.095 Test Acc: 0.466
Validation loss decreased (-0.427397 --> -0.465548).  Saving model ...
Epoch: 4 cost time: 13.692049026489258
Epoch: 4, Steps: 32 | Train Loss: 2.466 Vali Loss: 7.214 Vali Acc: 0.504 Test Loss: 7.214 Test Acc: 0.504
Validation loss decreased (-0.465548 --> -0.503745).  Saving model ...
Epoch: 5 cost time: 14.02931022644043
Epoch: 5, Steps: 32 | Train Loss: 1.450 Vali Loss: 8.587 Vali Acc: 0.443 Test Loss: 8.587 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.942787408828735
Epoch: 6, Steps: 32 | Train Loss: 0.345 Vali Loss: 10.672 Vali Acc: 0.450 Test Loss: 10.672 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.684526443481445
Epoch: 7, Steps: 32 | Train Loss: 0.338 Vali Loss: 14.572 Vali Acc: 0.481 Test Loss: 14.572 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.651363849639893
Epoch: 8, Steps: 32 | Train Loss: 0.770 Vali Loss: 13.428 Vali Acc: 0.473 Test Loss: 13.428 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.06751036643982
Epoch: 9, Steps: 32 | Train Loss: 0.766 Vali Loss: 16.618 Vali Acc: 0.321 Test Loss: 16.618 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.526765823364258
Epoch: 10, Steps: 32 | Train Loss: 10.814 Vali Loss: 80.072 Vali Acc: 0.099 Test Loss: 80.072 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.876914978027344
Epoch: 11, Steps: 32 | Train Loss: 35.871 Vali Loss: 21.863 Vali Acc: 0.435 Test Loss: 21.863 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.131586074829102
Epoch: 12, Steps: 32 | Train Loss: 25.957 Vali Loss: 60.969 Vali Acc: 0.130 Test Loss: 60.969 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.235930919647217
Epoch: 13, Steps: 32 | Train Loss: 26.524 Vali Loss: 18.637 Vali Acc: 0.198 Test Loss: 18.637 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.217043399810791
Epoch: 14, Steps: 32 | Train Loss: 15.667 Vali Loss: 16.289 Vali Acc: 0.366 Test Loss: 16.289 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 16740289
model size : 81.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.490248441696167
Epoch: 1, Steps: 32 | Train Loss: 6.242 Vali Loss: 7.829 Vali Acc: 0.137 Test Loss: 7.829 Test Acc: 0.137
Validation loss decreased (inf --> -0.137326).  Saving model ...
Epoch: 2 cost time: 13.2563796043396
Epoch: 2, Steps: 32 | Train Loss: 9.853 Vali Loss: 4.931 Vali Acc: 0.481 Test Loss: 4.931 Test Acc: 0.481
Validation loss decreased (-0.137326 --> -0.480867).  Saving model ...
Epoch: 3 cost time: 13.228818416595459
Epoch: 3, Steps: 32 | Train Loss: 3.640 Vali Loss: 11.641 Vali Acc: 0.504 Test Loss: 11.641 Test Acc: 0.504
Validation loss decreased (-0.480867 --> -0.503700).  Saving model ...
Epoch: 4 cost time: 13.41810393333435
Epoch: 4, Steps: 32 | Train Loss: 1.891 Vali Loss: 8.273 Vali Acc: 0.511 Test Loss: 8.273 Test Acc: 0.511
Validation loss decreased (-0.503700 --> -0.511368).  Saving model ...
Epoch: 5 cost time: 13.540895700454712
Epoch: 5, Steps: 32 | Train Loss: 1.228 Vali Loss: 9.619 Vali Acc: 0.473 Test Loss: 9.619 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.382520914077759
Epoch: 6, Steps: 32 | Train Loss: 1.083 Vali Loss: 9.345 Vali Acc: 0.496 Test Loss: 9.345 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.468250513076782
Epoch: 7, Steps: 32 | Train Loss: 0.501 Vali Loss: 10.891 Vali Acc: 0.420 Test Loss: 10.891 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.44949746131897
Epoch: 8, Steps: 32 | Train Loss: 0.952 Vali Loss: 19.884 Vali Acc: 0.550 Test Loss: 19.884 Test Acc: 0.550
Validation loss decreased (-0.511368 --> -0.549419).  Saving model ...
Epoch: 9 cost time: 13.257283210754395
Epoch: 9, Steps: 32 | Train Loss: 1.072 Vali Loss: 17.660 Vali Acc: 0.382 Test Loss: 17.660 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.280749559402466
Epoch: 10, Steps: 32 | Train Loss: 0.559 Vali Loss: 13.571 Vali Acc: 0.473 Test Loss: 13.571 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.486024141311646
Epoch: 11, Steps: 32 | Train Loss: 0.332 Vali Loss: 18.958 Vali Acc: 0.481 Test Loss: 18.958 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.742793798446655
Epoch: 12, Steps: 32 | Train Loss: 11.288 Vali Loss: 29.482 Vali Acc: 0.122 Test Loss: 29.482 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.545414447784424
Epoch: 13, Steps: 32 | Train Loss: 36.011 Vali Loss: 48.711 Vali Acc: 0.450 Test Loss: 48.711 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.674257278442383
Epoch: 14, Steps: 32 | Train Loss: 44.308 Vali Loss: 36.355 Vali Acc: 0.168 Test Loss: 36.355 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.408400774002075
Epoch: 15, Steps: 32 | Train Loss: 18.287 Vali Loss: 12.668 Vali Acc: 0.099 Test Loss: 12.668 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.648772478103638
Epoch: 16, Steps: 32 | Train Loss: 13.529 Vali Loss: 10.442 Vali Acc: 0.176 Test Loss: 10.442 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.361092329025269
Epoch: 17, Steps: 32 | Train Loss: 7.648 Vali Loss: 7.427 Vali Acc: 0.420 Test Loss: 7.427 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.80584454536438
Epoch: 18, Steps: 32 | Train Loss: 9.144 Vali Loss: 10.801 Vali Acc: 0.420 Test Loss: 10.801 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 16020417
model size : 78.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.775001287460327
Epoch: 1, Steps: 32 | Train Loss: 3.724 Vali Loss: 4.142 Vali Acc: 0.420 Test Loss: 4.142 Test Acc: 0.420
Validation loss decreased (inf --> -0.419806).  Saving model ...
Epoch: 2 cost time: 13.398377656936646
Epoch: 2, Steps: 32 | Train Loss: 5.071 Vali Loss: 11.611 Vali Acc: 0.435 Test Loss: 11.611 Test Acc: 0.435
Validation loss decreased (-0.419806 --> -0.434998).  Saving model ...
Epoch: 3 cost time: 13.775648355484009
Epoch: 3, Steps: 32 | Train Loss: 6.155 Vali Loss: 10.642 Vali Acc: 0.328 Test Loss: 10.642 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.123284101486206
Epoch: 4, Steps: 32 | Train Loss: 2.598 Vali Loss: 11.710 Vali Acc: 0.344 Test Loss: 11.710 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.778640031814575
Epoch: 5, Steps: 32 | Train Loss: 2.579 Vali Loss: 10.792 Vali Acc: 0.397 Test Loss: 10.792 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.793256521224976
Epoch: 6, Steps: 32 | Train Loss: 0.599 Vali Loss: 10.821 Vali Acc: 0.382 Test Loss: 10.821 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.049341440200806
Epoch: 7, Steps: 32 | Train Loss: 0.409 Vali Loss: 10.755 Vali Acc: 0.389 Test Loss: 10.755 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.269932270050049
Epoch: 8, Steps: 32 | Train Loss: 0.203 Vali Loss: 11.720 Vali Acc: 0.458 Test Loss: 11.720 Test Acc: 0.458
Validation loss decreased (-0.434998 --> -0.457898).  Saving model ...
Epoch: 9 cost time: 13.678791284561157
Epoch: 9, Steps: 32 | Train Loss: 0.531 Vali Loss: 15.064 Vali Acc: 0.382 Test Loss: 15.064 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.353649854660034
Epoch: 10, Steps: 32 | Train Loss: 0.547 Vali Loss: 18.540 Vali Acc: 0.328 Test Loss: 18.540 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.239383220672607
Epoch: 11, Steps: 32 | Train Loss: 0.532 Vali Loss: 18.305 Vali Acc: 0.443 Test Loss: 18.305 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.014996767044067
Epoch: 12, Steps: 32 | Train Loss: 0.740 Vali Loss: 18.207 Vali Acc: 0.473 Test Loss: 18.207 Test Acc: 0.473
Validation loss decreased (-0.457898 --> -0.473100).  Saving model ...
Epoch: 13 cost time: 14.014641761779785
Epoch: 13, Steps: 32 | Train Loss: 1.374 Vali Loss: 16.219 Vali Acc: 0.344 Test Loss: 16.219 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.029838562011719
Epoch: 14, Steps: 32 | Train Loss: 1.389 Vali Loss: 17.810 Vali Acc: 0.534 Test Loss: 17.810 Test Acc: 0.534
Validation loss decreased (-0.473100 --> -0.534173).  Saving model ...
Epoch: 15 cost time: 14.002738952636719
Epoch: 15, Steps: 32 | Train Loss: 2.461 Vali Loss: 19.219 Vali Acc: 0.496 Test Loss: 19.219 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.529085397720337
Epoch: 16, Steps: 32 | Train Loss: 0.747 Vali Loss: 15.181 Vali Acc: 0.466 Test Loss: 15.181 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.993469953536987
Epoch: 17, Steps: 32 | Train Loss: 0.203 Vali Loss: 21.463 Vali Acc: 0.466 Test Loss: 21.463 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.379713296890259
Epoch: 18, Steps: 32 | Train Loss: 0.898 Vali Loss: 22.763 Vali Acc: 0.489 Test Loss: 22.763 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 13.820456504821777
Epoch: 19, Steps: 32 | Train Loss: 1.305 Vali Loss: 19.608 Vali Acc: 0.344 Test Loss: 19.608 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.06202220916748
Epoch: 20, Steps: 32 | Train Loss: 5.105 Vali Loss: 23.310 Vali Acc: 0.496 Test Loss: 23.310 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.369304418563843
Epoch: 21, Steps: 32 | Train Loss: 1.493 Vali Loss: 13.601 Vali Acc: 0.466 Test Loss: 13.601 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.429270267486572
Epoch: 22, Steps: 32 | Train Loss: 1.748 Vali Loss: 21.466 Vali Acc: 0.336 Test Loss: 21.466 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 13.710755348205566
Epoch: 23, Steps: 32 | Train Loss: 1.441 Vali Loss: 18.624 Vali Acc: 0.237 Test Loss: 18.624 Test Acc: 0.237
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.459131002426147
Epoch: 24, Steps: 32 | Train Loss: 0.945 Vali Loss: 25.704 Vali Acc: 0.336 Test Loss: 25.704 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 15300545
model size : 76.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.283252716064453
Epoch: 1, Steps: 32 | Train Loss: 4.602 Vali Loss: 6.488 Vali Acc: 0.420 Test Loss: 6.488 Test Acc: 0.420
Validation loss decreased (inf --> -0.419782).  Saving model ...
Epoch: 2 cost time: 13.34594178199768
Epoch: 2, Steps: 32 | Train Loss: 7.477 Vali Loss: 2.338 Vali Acc: 0.336 Test Loss: 2.338 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.282857656478882
Epoch: 3, Steps: 32 | Train Loss: 5.655 Vali Loss: 9.756 Vali Acc: 0.298 Test Loss: 9.756 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.659678220748901
Epoch: 4, Steps: 32 | Train Loss: 3.106 Vali Loss: 6.652 Vali Acc: 0.473 Test Loss: 6.652 Test Acc: 0.473
Validation loss decreased (-0.419782 --> -0.473216).  Saving model ...
Epoch: 5 cost time: 13.039696455001831
Epoch: 5, Steps: 32 | Train Loss: 2.175 Vali Loss: 7.459 Vali Acc: 0.427 Test Loss: 7.459 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.875393390655518
Epoch: 6, Steps: 32 | Train Loss: 0.912 Vali Loss: 8.068 Vali Acc: 0.412 Test Loss: 8.068 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.183335065841675
Epoch: 7, Steps: 32 | Train Loss: 1.155 Vali Loss: 22.010 Vali Acc: 0.473 Test Loss: 22.010 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.981435775756836
Epoch: 8, Steps: 32 | Train Loss: 1.128 Vali Loss: 12.283 Vali Acc: 0.405 Test Loss: 12.283 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.14344072341919
Epoch: 9, Steps: 32 | Train Loss: 0.797 Vali Loss: 14.231 Vali Acc: 0.542 Test Loss: 14.231 Test Acc: 0.542
Validation loss decreased (-0.473216 --> -0.541842).  Saving model ...
Epoch: 10 cost time: 13.0533926486969
Epoch: 10, Steps: 32 | Train Loss: 0.762 Vali Loss: 12.280 Vali Acc: 0.427 Test Loss: 12.280 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.991976976394653
Epoch: 11, Steps: 32 | Train Loss: 0.586 Vali Loss: 16.419 Vali Acc: 0.466 Test Loss: 16.419 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.08991527557373
Epoch: 12, Steps: 32 | Train Loss: 1.530 Vali Loss: 15.911 Vali Acc: 0.382 Test Loss: 15.911 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.012673377990723
Epoch: 13, Steps: 32 | Train Loss: 0.535 Vali Loss: 18.488 Vali Acc: 0.450 Test Loss: 18.488 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.160065412521362
Epoch: 14, Steps: 32 | Train Loss: 1.027 Vali Loss: 14.798 Vali Acc: 0.397 Test Loss: 14.798 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.74717116355896
Epoch: 15, Steps: 32 | Train Loss: 0.977 Vali Loss: 19.373 Vali Acc: 0.359 Test Loss: 19.373 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.142186641693115
Epoch: 16, Steps: 32 | Train Loss: 1.152 Vali Loss: 26.272 Vali Acc: 0.298 Test Loss: 26.272 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.018621683120728
Epoch: 17, Steps: 32 | Train Loss: 1.491 Vali Loss: 19.654 Vali Acc: 0.435 Test Loss: 19.654 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.913686037063599
Epoch: 18, Steps: 32 | Train Loss: 0.139 Vali Loss: 31.307 Vali Acc: 0.298 Test Loss: 31.307 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.191323518753052
Epoch: 19, Steps: 32 | Train Loss: 0.658 Vali Loss: 31.977 Vali Acc: 0.473 Test Loss: 31.977 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 14580673
model size : 73.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.975215911865234
Epoch: 1, Steps: 32 | Train Loss: 2.848 Vali Loss: 2.794 Vali Acc: 0.168 Test Loss: 2.794 Test Acc: 0.168
Validation loss decreased (inf --> -0.167911).  Saving model ...
Epoch: 2 cost time: 13.422598123550415
Epoch: 2, Steps: 32 | Train Loss: 3.833 Vali Loss: 2.935 Vali Acc: 0.481 Test Loss: 2.935 Test Acc: 0.481
Validation loss decreased (-0.167911 --> -0.480887).  Saving model ...
Epoch: 3 cost time: 14.000908374786377
Epoch: 3, Steps: 32 | Train Loss: 2.971 Vali Loss: 6.788 Vali Acc: 0.489 Test Loss: 6.788 Test Acc: 0.489
Validation loss decreased (-0.480887 --> -0.488482).  Saving model ...
Epoch: 4 cost time: 13.584777355194092
Epoch: 4, Steps: 32 | Train Loss: 1.986 Vali Loss: 4.795 Vali Acc: 0.420 Test Loss: 4.795 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.180938720703125
Epoch: 5, Steps: 32 | Train Loss: 0.692 Vali Loss: 6.162 Vali Acc: 0.382 Test Loss: 6.162 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.045389890670776
Epoch: 6, Steps: 32 | Train Loss: 0.646 Vali Loss: 5.865 Vali Acc: 0.382 Test Loss: 5.865 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.164941549301147
Epoch: 7, Steps: 32 | Train Loss: 0.043 Vali Loss: 7.667 Vali Acc: 0.435 Test Loss: 7.667 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.491161346435547
Epoch: 8, Steps: 32 | Train Loss: 0.112 Vali Loss: 7.479 Vali Acc: 0.412 Test Loss: 7.479 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.706540584564209
Epoch: 9, Steps: 32 | Train Loss: 0.099 Vali Loss: 8.451 Vali Acc: 0.427 Test Loss: 8.451 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.911544799804688
Epoch: 10, Steps: 32 | Train Loss: 0.230 Vali Loss: 7.848 Vali Acc: 0.481 Test Loss: 7.848 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.375115156173706
Epoch: 11, Steps: 32 | Train Loss: 0.028 Vali Loss: 7.594 Vali Acc: 0.405 Test Loss: 7.594 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.825750589370728
Epoch: 12, Steps: 32 | Train Loss: 0.017 Vali Loss: 11.078 Vali Acc: 0.489 Test Loss: 11.078 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.423726081848145
Epoch: 13, Steps: 32 | Train Loss: 0.271 Vali Loss: 12.546 Vali Acc: 0.298 Test Loss: 12.546 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 8083905
model size : 39.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.39173173904419
Epoch: 1, Steps: 32 | Train Loss: 3.624 Vali Loss: 5.791 Vali Acc: 0.137 Test Loss: 5.791 Test Acc: 0.137
Validation loss decreased (inf --> -0.137347).  Saving model ...
Epoch: 2 cost time: 13.061092615127563
Epoch: 2, Steps: 32 | Train Loss: 3.833 Vali Loss: 7.288 Vali Acc: 0.244 Test Loss: 7.288 Test Acc: 0.244
Validation loss decreased (-0.137347 --> -0.244202).  Saving model ...
Epoch: 3 cost time: 12.916619539260864
Epoch: 3, Steps: 32 | Train Loss: 2.847 Vali Loss: 4.577 Vali Acc: 0.519 Test Loss: 4.577 Test Acc: 0.519
Validation loss decreased (-0.244202 --> -0.519038).  Saving model ...
Epoch: 4 cost time: 12.939161777496338
Epoch: 4, Steps: 32 | Train Loss: 1.053 Vali Loss: 4.773 Vali Acc: 0.389 Test Loss: 4.773 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.518736839294434
Epoch: 5, Steps: 32 | Train Loss: 0.889 Vali Loss: 7.514 Vali Acc: 0.504 Test Loss: 7.514 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.188690900802612
Epoch: 6, Steps: 32 | Train Loss: 0.187 Vali Loss: 9.120 Vali Acc: 0.298 Test Loss: 9.120 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.132585525512695
Epoch: 7, Steps: 32 | Train Loss: 0.132 Vali Loss: 9.176 Vali Acc: 0.450 Test Loss: 9.176 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.221346139907837
Epoch: 8, Steps: 32 | Train Loss: 0.116 Vali Loss: 8.172 Vali Acc: 0.496 Test Loss: 8.172 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.255704641342163
Epoch: 9, Steps: 32 | Train Loss: 0.325 Vali Loss: 8.908 Vali Acc: 0.443 Test Loss: 8.908 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.007629632949829
Epoch: 10, Steps: 32 | Train Loss: 0.200 Vali Loss: 9.648 Vali Acc: 0.412 Test Loss: 9.648 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.402839660644531
Epoch: 11, Steps: 32 | Train Loss: 0.802 Vali Loss: 9.426 Vali Acc: 0.496 Test Loss: 9.426 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.032653331756592
Epoch: 12, Steps: 32 | Train Loss: 0.274 Vali Loss: 8.619 Vali Acc: 0.427 Test Loss: 8.619 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.284168004989624
Epoch: 13, Steps: 32 | Train Loss: 0.088 Vali Loss: 10.371 Vali Acc: 0.412 Test Loss: 10.371 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 7723969
model size : 38.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.603895902633667
Epoch: 1, Steps: 32 | Train Loss: 2.343 Vali Loss: 2.607 Vali Acc: 0.176 Test Loss: 2.607 Test Acc: 0.176
Validation loss decreased (inf --> -0.175546).  Saving model ...
Epoch: 2 cost time: 12.22029733657837
Epoch: 2, Steps: 32 | Train Loss: 3.069 Vali Loss: 3.096 Vali Acc: 0.473 Test Loss: 3.096 Test Acc: 0.473
Validation loss decreased (-0.175546 --> -0.473251).  Saving model ...
Epoch: 3 cost time: 12.289193630218506
Epoch: 3, Steps: 32 | Train Loss: 2.093 Vali Loss: 3.909 Vali Acc: 0.405 Test Loss: 3.909 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.748387575149536
Epoch: 4, Steps: 32 | Train Loss: 1.167 Vali Loss: 8.100 Vali Acc: 0.473 Test Loss: 8.100 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.484925508499146
Epoch: 5, Steps: 32 | Train Loss: 0.912 Vali Loss: 6.046 Vali Acc: 0.435 Test Loss: 6.046 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.118795394897461
Epoch: 6, Steps: 32 | Train Loss: 0.185 Vali Loss: 7.726 Vali Acc: 0.405 Test Loss: 7.726 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.228939533233643
Epoch: 7, Steps: 32 | Train Loss: 0.367 Vali Loss: 7.270 Vali Acc: 0.450 Test Loss: 7.270 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.428991317749023
Epoch: 8, Steps: 32 | Train Loss: 0.243 Vali Loss: 7.908 Vali Acc: 0.496 Test Loss: 7.908 Test Acc: 0.496
Validation loss decreased (-0.473251 --> -0.496104).  Saving model ...
Epoch: 9 cost time: 12.336899042129517
Epoch: 9, Steps: 32 | Train Loss: 0.165 Vali Loss: 9.463 Vali Acc: 0.427 Test Loss: 9.463 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.078999996185303
Epoch: 10, Steps: 32 | Train Loss: 0.190 Vali Loss: 9.724 Vali Acc: 0.412 Test Loss: 9.724 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.3396897315979
Epoch: 11, Steps: 32 | Train Loss: 0.044 Vali Loss: 12.488 Vali Acc: 0.435 Test Loss: 12.488 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.312406539916992
Epoch: 12, Steps: 32 | Train Loss: 0.247 Vali Loss: 11.446 Vali Acc: 0.435 Test Loss: 11.446 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.371119022369385
Epoch: 13, Steps: 32 | Train Loss: 0.222 Vali Loss: 11.472 Vali Acc: 0.496 Test Loss: 11.472 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.729882955551147
Epoch: 14, Steps: 32 | Train Loss: 0.134 Vali Loss: 14.880 Vali Acc: 0.427 Test Loss: 14.880 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.50607442855835
Epoch: 15, Steps: 32 | Train Loss: 0.282 Vali Loss: 14.364 Vali Acc: 0.427 Test Loss: 14.364 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.526076555252075
Epoch: 16, Steps: 32 | Train Loss: 0.372 Vali Loss: 13.405 Vali Acc: 0.366 Test Loss: 13.405 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.247081518173218
Epoch: 17, Steps: 32 | Train Loss: 0.252 Vali Loss: 14.856 Vali Acc: 0.405 Test Loss: 14.856 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.659223318099976
Epoch: 18, Steps: 32 | Train Loss: 0.326 Vali Loss: 14.628 Vali Acc: 0.420 Test Loss: 14.628 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 7364033
model size : 37.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.844034910202026
Epoch: 1, Steps: 32 | Train Loss: 3.055 Vali Loss: 3.563 Vali Acc: 0.366 Test Loss: 3.563 Test Acc: 0.366
Validation loss decreased (inf --> -0.366377).  Saving model ...
Epoch: 2 cost time: 12.187631845474243
Epoch: 2, Steps: 32 | Train Loss: 3.811 Vali Loss: 3.471 Vali Acc: 0.435 Test Loss: 3.471 Test Acc: 0.435
Validation loss decreased (-0.366377 --> -0.435080).  Saving model ...
Epoch: 3 cost time: 12.459844827651978
Epoch: 3, Steps: 32 | Train Loss: 2.528 Vali Loss: 3.995 Vali Acc: 0.450 Test Loss: 3.995 Test Acc: 0.450
Validation loss decreased (-0.435080 --> -0.450342).  Saving model ...
Epoch: 4 cost time: 13.029056549072266
Epoch: 4, Steps: 32 | Train Loss: 1.074 Vali Loss: 5.498 Vali Acc: 0.275 Test Loss: 5.498 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.424901485443115
Epoch: 5, Steps: 32 | Train Loss: 1.483 Vali Loss: 4.912 Vali Acc: 0.389 Test Loss: 4.912 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.841585397720337
Epoch: 6, Steps: 32 | Train Loss: 0.238 Vali Loss: 6.729 Vali Acc: 0.336 Test Loss: 6.729 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.04777193069458
Epoch: 7, Steps: 32 | Train Loss: 0.279 Vali Loss: 7.279 Vali Acc: 0.389 Test Loss: 7.279 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.429866790771484
Epoch: 8, Steps: 32 | Train Loss: 0.159 Vali Loss: 8.453 Vali Acc: 0.366 Test Loss: 8.453 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.405497312545776
Epoch: 9, Steps: 32 | Train Loss: 0.147 Vali Loss: 7.311 Vali Acc: 0.366 Test Loss: 7.311 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.930459260940552
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.426 Vali Acc: 0.435 Test Loss: 8.426 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.109214067459106
Epoch: 11, Steps: 32 | Train Loss: 0.039 Vali Loss: 8.290 Vali Acc: 0.366 Test Loss: 8.290 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.922603368759155
Epoch: 12, Steps: 32 | Train Loss: 0.075 Vali Loss: 8.675 Vali Acc: 0.397 Test Loss: 8.675 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.987017393112183
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.925 Vali Acc: 0.427 Test Loss: 8.925 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 7004097
model size : 35.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.559688568115234
Epoch: 1, Steps: 32 | Train Loss: 3.528 Vali Loss: 2.764 Vali Acc: 0.092 Test Loss: 2.764 Test Acc: 0.092
Validation loss decreased (inf --> -0.091575).  Saving model ...
Epoch: 2 cost time: 12.642186164855957
Epoch: 2, Steps: 32 | Train Loss: 5.023 Vali Loss: 2.923 Vali Acc: 0.435 Test Loss: 2.923 Test Acc: 0.435
Validation loss decreased (-0.091575 --> -0.435085).  Saving model ...
Epoch: 3 cost time: 13.12674880027771
Epoch: 3, Steps: 32 | Train Loss: 3.081 Vali Loss: 7.047 Vali Acc: 0.252 Test Loss: 7.047 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.793410778045654
Epoch: 4, Steps: 32 | Train Loss: 2.075 Vali Loss: 4.791 Vali Acc: 0.397 Test Loss: 4.791 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.362068176269531
Epoch: 5, Steps: 32 | Train Loss: 0.928 Vali Loss: 6.382 Vali Acc: 0.458 Test Loss: 6.382 Test Acc: 0.458
Validation loss decreased (-0.435085 --> -0.457951).  Saving model ...
Epoch: 6 cost time: 13.131883144378662
Epoch: 6, Steps: 32 | Train Loss: 0.419 Vali Loss: 6.773 Vali Acc: 0.344 Test Loss: 6.773 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.904972791671753
Epoch: 7, Steps: 32 | Train Loss: 0.258 Vali Loss: 8.619 Vali Acc: 0.397 Test Loss: 8.619 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.850013494491577
Epoch: 8, Steps: 32 | Train Loss: 0.286 Vali Loss: 9.958 Vali Acc: 0.359 Test Loss: 9.958 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.130985498428345
Epoch: 9, Steps: 32 | Train Loss: 0.153 Vali Loss: 7.726 Vali Acc: 0.519 Test Loss: 7.726 Test Acc: 0.519
Validation loss decreased (-0.457951 --> -0.519007).  Saving model ...
Epoch: 10 cost time: 13.161713123321533
Epoch: 10, Steps: 32 | Train Loss: 0.146 Vali Loss: 8.749 Vali Acc: 0.489 Test Loss: 8.749 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.936511278152466
Epoch: 11, Steps: 32 | Train Loss: 0.003 Vali Loss: 9.193 Vali Acc: 0.527 Test Loss: 9.193 Test Acc: 0.527
Validation loss decreased (-0.519007 --> -0.526626).  Saving model ...
Epoch: 12 cost time: 13.18057632446289
Epoch: 12, Steps: 32 | Train Loss: 0.043 Vali Loss: 8.719 Vali Acc: 0.542 Test Loss: 8.719 Test Acc: 0.542
Validation loss decreased (-0.526626 --> -0.541898).  Saving model ...
Epoch: 13 cost time: 13.142971277236938
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.891 Vali Acc: 0.489 Test Loss: 8.891 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.126864910125732
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.972 Vali Acc: 0.481 Test Loss: 8.972 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.636122465133667
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.972 Vali Acc: 0.481 Test Loss: 8.972 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.211508750915527
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.962 Vali Acc: 0.481 Test Loss: 8.962 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.58535385131836
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.961 Vali Acc: 0.481 Test Loss: 8.961 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.693354606628418
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.956 Vali Acc: 0.481 Test Loss: 8.956 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.51548719406128
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.950 Vali Acc: 0.481 Test Loss: 8.950 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.989479064941406
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.949 Vali Acc: 0.481 Test Loss: 8.949 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.91717529296875
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.949 Vali Acc: 0.481 Test Loss: 8.949 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.51867389678955
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.949 Vali Acc: 0.481 Test Loss: 8.949 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6899649
model size : 35.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.33846640586853
Epoch: 1, Steps: 32 | Train Loss: 3.969 Vali Loss: 3.564 Vali Acc: 0.420 Test Loss: 3.564 Test Acc: 0.420
Validation loss decreased (inf --> -0.419812).  Saving model ...
Epoch: 2 cost time: 13.026462078094482
Epoch: 2, Steps: 32 | Train Loss: 4.301 Vali Loss: 2.995 Vali Acc: 0.221 Test Loss: 2.995 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.951241493225098
Epoch: 3, Steps: 32 | Train Loss: 2.686 Vali Loss: 4.851 Vali Acc: 0.481 Test Loss: 4.851 Test Acc: 0.481
Validation loss decreased (-0.419812 --> -0.480868).  Saving model ...
Epoch: 4 cost time: 12.81278371810913
Epoch: 4, Steps: 32 | Train Loss: 1.415 Vali Loss: 7.704 Vali Acc: 0.496 Test Loss: 7.704 Test Acc: 0.496
Validation loss decreased (-0.480868 --> -0.496106).  Saving model ...
Epoch: 5 cost time: 13.359108209609985
Epoch: 5, Steps: 32 | Train Loss: 0.343 Vali Loss: 5.655 Vali Acc: 0.473 Test Loss: 5.655 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.57360553741455
Epoch: 6, Steps: 32 | Train Loss: 0.656 Vali Loss: 6.657 Vali Acc: 0.435 Test Loss: 6.657 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.24340009689331
Epoch: 7, Steps: 32 | Train Loss: 0.382 Vali Loss: 8.636 Vali Acc: 0.511 Test Loss: 8.636 Test Acc: 0.511
Validation loss decreased (-0.496106 --> -0.511364).  Saving model ...
Epoch: 8 cost time: 13.128084421157837
Epoch: 8, Steps: 32 | Train Loss: 0.371 Vali Loss: 9.642 Vali Acc: 0.374 Test Loss: 9.642 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.052180051803589
Epoch: 9, Steps: 32 | Train Loss: 0.277 Vali Loss: 12.258 Vali Acc: 0.458 Test Loss: 12.258 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.046064376831055
Epoch: 10, Steps: 32 | Train Loss: 0.465 Vali Loss: 10.514 Vali Acc: 0.397 Test Loss: 10.514 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.068278551101685
Epoch: 11, Steps: 32 | Train Loss: 0.048 Vali Loss: 10.856 Vali Acc: 0.443 Test Loss: 10.856 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.12316608428955
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 11.711 Vali Acc: 0.473 Test Loss: 11.711 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.162212610244751
Epoch: 13, Steps: 32 | Train Loss: 0.008 Vali Loss: 10.663 Vali Acc: 0.420 Test Loss: 10.663 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.005716800689697
Epoch: 14, Steps: 32 | Train Loss: 0.073 Vali Loss: 10.386 Vali Acc: 0.397 Test Loss: 10.386 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.335916519165039
Epoch: 15, Steps: 32 | Train Loss: 0.437 Vali Loss: 12.666 Vali Acc: 0.374 Test Loss: 12.666 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.967663764953613
Epoch: 16, Steps: 32 | Train Loss: 0.819 Vali Loss: 9.655 Vali Acc: 0.389 Test Loss: 9.655 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.78862452507019
Epoch: 17, Steps: 32 | Train Loss: 0.860 Vali Loss: 9.965 Vali Acc: 0.389 Test Loss: 9.965 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 6539713
model size : 33.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.497807741165161
Epoch: 1, Steps: 32 | Train Loss: 3.280 Vali Loss: 4.053 Vali Acc: 0.420 Test Loss: 4.053 Test Acc: 0.420
Validation loss decreased (inf --> -0.419807).  Saving model ...
Epoch: 2 cost time: 13.15430760383606
Epoch: 2, Steps: 32 | Train Loss: 3.541 Vali Loss: 4.904 Vali Acc: 0.397 Test Loss: 4.904 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.815317869186401
Epoch: 3, Steps: 32 | Train Loss: 2.523 Vali Loss: 4.454 Vali Acc: 0.313 Test Loss: 4.454 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.630310773849487
Epoch: 4, Steps: 32 | Train Loss: 1.639 Vali Loss: 7.291 Vali Acc: 0.252 Test Loss: 7.291 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.690382242202759
Epoch: 5, Steps: 32 | Train Loss: 1.380 Vali Loss: 6.047 Vali Acc: 0.435 Test Loss: 6.047 Test Acc: 0.435
Validation loss decreased (-0.419807 --> -0.435054).  Saving model ...
Epoch: 6 cost time: 12.467196941375732
Epoch: 6, Steps: 32 | Train Loss: 0.532 Vali Loss: 7.039 Vali Acc: 0.466 Test Loss: 7.039 Test Acc: 0.466
Validation loss decreased (-0.435054 --> -0.465578).  Saving model ...
Epoch: 7 cost time: 13.242669343948364
Epoch: 7, Steps: 32 | Train Loss: 0.243 Vali Loss: 7.852 Vali Acc: 0.489 Test Loss: 7.852 Test Acc: 0.489
Validation loss decreased (-0.465578 --> -0.488471).  Saving model ...
Epoch: 8 cost time: 13.161357879638672
Epoch: 8, Steps: 32 | Train Loss: 0.468 Vali Loss: 6.945 Vali Acc: 0.489 Test Loss: 6.945 Test Acc: 0.489
Validation loss decreased (-0.488471 --> -0.488480).  Saving model ...
Epoch: 9 cost time: 13.524085283279419
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.063 Vali Acc: 0.489 Test Loss: 8.063 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.213505983352661
Epoch: 10, Steps: 32 | Train Loss: 0.002 Vali Loss: 7.255 Vali Acc: 0.481 Test Loss: 7.255 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.994904518127441
Epoch: 11, Steps: 32 | Train Loss: 0.078 Vali Loss: 10.079 Vali Acc: 0.519 Test Loss: 10.079 Test Acc: 0.519
Validation loss decreased (-0.488480 --> -0.518983).  Saving model ...
Epoch: 12 cost time: 13.236731767654419
Epoch: 12, Steps: 32 | Train Loss: 0.400 Vali Loss: 13.410 Vali Acc: 0.328 Test Loss: 13.410 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.150499820709229
Epoch: 13, Steps: 32 | Train Loss: 0.383 Vali Loss: 10.916 Vali Acc: 0.412 Test Loss: 10.916 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.804847955703735
Epoch: 14, Steps: 32 | Train Loss: 0.610 Vali Loss: 12.452 Vali Acc: 0.344 Test Loss: 12.452 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.210871696472168
Epoch: 15, Steps: 32 | Train Loss: 0.858 Vali Loss: 13.339 Vali Acc: 0.351 Test Loss: 13.339 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.017783403396606
Epoch: 16, Steps: 32 | Train Loss: 0.889 Vali Loss: 19.712 Vali Acc: 0.305 Test Loss: 19.712 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.164909839630127
Epoch: 17, Steps: 32 | Train Loss: 0.786 Vali Loss: 13.912 Vali Acc: 0.359 Test Loss: 13.912 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.83800458908081
Epoch: 18, Steps: 32 | Train Loss: 1.211 Vali Loss: 15.532 Vali Acc: 0.443 Test Loss: 15.532 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.10204553604126
Epoch: 19, Steps: 32 | Train Loss: 1.498 Vali Loss: 15.337 Vali Acc: 0.344 Test Loss: 15.337 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.8230140209198
Epoch: 20, Steps: 32 | Train Loss: 0.383 Vali Loss: 12.548 Vali Acc: 0.466 Test Loss: 12.548 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.681498527526855
Epoch: 21, Steps: 32 | Train Loss: 0.739 Vali Loss: 12.333 Vali Acc: 0.458 Test Loss: 12.333 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6179777
model size : 32.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.554380178451538
Epoch: 1, Steps: 32 | Train Loss: 2.596 Vali Loss: 3.177 Vali Acc: 0.206 Test Loss: 3.177 Test Acc: 0.206
Validation loss decreased (inf --> -0.206075).  Saving model ...
Epoch: 2 cost time: 11.677645444869995
Epoch: 2, Steps: 32 | Train Loss: 3.931 Vali Loss: 1.865 Vali Acc: 0.435 Test Loss: 1.865 Test Acc: 0.435
Validation loss decreased (-0.206075 --> -0.435096).  Saving model ...
Epoch: 3 cost time: 12.298234939575195
Epoch: 3, Steps: 32 | Train Loss: 1.832 Vali Loss: 4.344 Vali Acc: 0.534 Test Loss: 4.344 Test Acc: 0.534
Validation loss decreased (-0.435096 --> -0.534308).  Saving model ...
Epoch: 4 cost time: 12.252474546432495
Epoch: 4, Steps: 32 | Train Loss: 1.620 Vali Loss: 4.754 Vali Acc: 0.473 Test Loss: 4.754 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.331338167190552
Epoch: 5, Steps: 32 | Train Loss: 0.491 Vali Loss: 8.601 Vali Acc: 0.382 Test Loss: 8.601 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.03134536743164
Epoch: 6, Steps: 32 | Train Loss: 0.560 Vali Loss: 8.028 Vali Acc: 0.458 Test Loss: 8.028 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.275444030761719
Epoch: 7, Steps: 32 | Train Loss: 0.439 Vali Loss: 7.090 Vali Acc: 0.435 Test Loss: 7.090 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.057008028030396
Epoch: 8, Steps: 32 | Train Loss: 0.025 Vali Loss: 7.436 Vali Acc: 0.504 Test Loss: 7.436 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.893925189971924
Epoch: 9, Steps: 32 | Train Loss: 0.074 Vali Loss: 9.220 Vali Acc: 0.489 Test Loss: 9.220 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.88959264755249
Epoch: 10, Steps: 32 | Train Loss: 0.263 Vali Loss: 10.164 Vali Acc: 0.489 Test Loss: 10.164 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.978882074356079
Epoch: 11, Steps: 32 | Train Loss: 0.235 Vali Loss: 8.785 Vali Acc: 0.389 Test Loss: 8.785 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.941587924957275
Epoch: 12, Steps: 32 | Train Loss: 0.214 Vali Loss: 7.296 Vali Acc: 0.443 Test Loss: 7.296 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.351843357086182
Epoch: 13, Steps: 32 | Train Loss: 0.094 Vali Loss: 9.889 Vali Acc: 0.412 Test Loss: 9.889 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5819841
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.901995658874512
Epoch: 1, Steps: 32 | Train Loss: 3.133 Vali Loss: 4.784 Vali Acc: 0.420 Test Loss: 4.784 Test Acc: 0.420
Validation loss decreased (inf --> -0.419799).  Saving model ...
Epoch: 2 cost time: 12.484713315963745
Epoch: 2, Steps: 32 | Train Loss: 3.555 Vali Loss: 5.340 Vali Acc: 0.130 Test Loss: 5.340 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.511481285095215
Epoch: 3, Steps: 32 | Train Loss: 3.794 Vali Loss: 9.896 Vali Acc: 0.450 Test Loss: 9.896 Test Acc: 0.450
Validation loss decreased (-0.419799 --> -0.450283).  Saving model ...
Epoch: 4 cost time: 12.816814422607422
Epoch: 4, Steps: 32 | Train Loss: 2.714 Vali Loss: 5.270 Vali Acc: 0.336 Test Loss: 5.270 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.616215705871582
Epoch: 5, Steps: 32 | Train Loss: 0.743 Vali Loss: 5.627 Vali Acc: 0.473 Test Loss: 5.627 Test Acc: 0.473
Validation loss decreased (-0.450283 --> -0.473226).  Saving model ...
Epoch: 6 cost time: 13.411711692810059
Epoch: 6, Steps: 32 | Train Loss: 0.278 Vali Loss: 6.321 Vali Acc: 0.450 Test Loss: 6.321 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.956552267074585
Epoch: 7, Steps: 32 | Train Loss: 0.102 Vali Loss: 8.470 Vali Acc: 0.466 Test Loss: 8.470 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.713253021240234
Epoch: 8, Steps: 32 | Train Loss: 0.188 Vali Loss: 7.649 Vali Acc: 0.435 Test Loss: 7.649 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.419259071350098
Epoch: 9, Steps: 32 | Train Loss: 0.097 Vali Loss: 8.221 Vali Acc: 0.389 Test Loss: 8.221 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.540740728378296
Epoch: 10, Steps: 32 | Train Loss: 0.076 Vali Loss: 9.329 Vali Acc: 0.466 Test Loss: 9.329 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.922070503234863
Epoch: 11, Steps: 32 | Train Loss: 0.247 Vali Loss: 11.579 Vali Acc: 0.427 Test Loss: 11.579 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.980763912200928
Epoch: 12, Steps: 32 | Train Loss: 0.268 Vali Loss: 9.572 Vali Acc: 0.458 Test Loss: 9.572 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.787511110305786
Epoch: 13, Steps: 32 | Train Loss: 0.226 Vali Loss: 10.586 Vali Acc: 0.466 Test Loss: 10.586 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.33085584640503
Epoch: 14, Steps: 32 | Train Loss: 0.978 Vali Loss: 8.763 Vali Acc: 0.496 Test Loss: 8.763 Test Acc: 0.496
Validation loss decreased (-0.473226 --> -0.496096).  Saving model ...
Epoch: 15 cost time: 12.635843515396118
Epoch: 15, Steps: 32 | Train Loss: 0.927 Vali Loss: 12.598 Vali Acc: 0.481 Test Loss: 12.598 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.237915754318237
Epoch: 16, Steps: 32 | Train Loss: 0.011 Vali Loss: 17.560 Vali Acc: 0.336 Test Loss: 17.560 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.794448375701904
Epoch: 17, Steps: 32 | Train Loss: 0.469 Vali Loss: 12.090 Vali Acc: 0.420 Test Loss: 12.090 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.61381196975708
Epoch: 18, Steps: 32 | Train Loss: 0.179 Vali Loss: 14.858 Vali Acc: 0.458 Test Loss: 14.858 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.753176927566528
Epoch: 19, Steps: 32 | Train Loss: 0.789 Vali Loss: 18.933 Vali Acc: 0.374 Test Loss: 18.933 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.866085290908813
Epoch: 20, Steps: 32 | Train Loss: 0.325 Vali Loss: 18.909 Vali Acc: 0.504 Test Loss: 18.909 Test Acc: 0.504
Validation loss decreased (-0.496096 --> -0.503628).  Saving model ...
Epoch: 21 cost time: 12.823484659194946
Epoch: 21, Steps: 32 | Train Loss: 0.201 Vali Loss: 17.800 Vali Acc: 0.466 Test Loss: 17.800 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.877016067504883
Epoch: 22, Steps: 32 | Train Loss: 0.003 Vali Loss: 15.292 Vali Acc: 0.420 Test Loss: 15.292 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.495356559753418
Epoch: 23, Steps: 32 | Train Loss: 0.036 Vali Loss: 15.859 Vali Acc: 0.435 Test Loss: 15.859 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.359387159347534
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.103 Vali Acc: 0.450 Test Loss: 17.103 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.629462242126465
Epoch: 25, Steps: 32 | Train Loss: 0.285 Vali Loss: 17.743 Vali Acc: 0.435 Test Loss: 17.743 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 12.26119613647461
Epoch: 26, Steps: 32 | Train Loss: 0.948 Vali Loss: 18.959 Vali Acc: 0.458 Test Loss: 18.959 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.502523422241211
Epoch: 27, Steps: 32 | Train Loss: 0.352 Vali Loss: 15.552 Vali Acc: 0.244 Test Loss: 15.552 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 12.72771167755127
Epoch: 28, Steps: 32 | Train Loss: 1.247 Vali Loss: 20.902 Vali Acc: 0.466 Test Loss: 20.902 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.60841965675354
Epoch: 29, Steps: 32 | Train Loss: 4.412 Vali Loss: 22.194 Vali Acc: 0.351 Test Loss: 22.194 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 12.508300304412842
Epoch: 30, Steps: 32 | Train Loss: 0.077 Vali Loss: 21.893 Vali Acc: 0.366 Test Loss: 21.893 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6307521
model size : 33.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.261369466781616
Epoch: 1, Steps: 32 | Train Loss: 3.973 Vali Loss: 3.050 Vali Acc: 0.130 Test Loss: 3.050 Test Acc: 0.130
Validation loss decreased (inf --> -0.129740).  Saving model ...
Epoch: 2 cost time: 12.231213331222534
Epoch: 2, Steps: 32 | Train Loss: 5.277 Vali Loss: 5.075 Vali Acc: 0.282 Test Loss: 5.075 Test Acc: 0.282
Validation loss decreased (-0.129740 --> -0.282392).  Saving model ...
Epoch: 3 cost time: 12.869062900543213
Epoch: 3, Steps: 32 | Train Loss: 4.075 Vali Loss: 2.461 Vali Acc: 0.458 Test Loss: 2.461 Test Acc: 0.458
Validation loss decreased (-0.282392 --> -0.457991).  Saving model ...
Epoch: 4 cost time: 12.564073324203491
Epoch: 4, Steps: 32 | Train Loss: 1.670 Vali Loss: 4.978 Vali Acc: 0.511 Test Loss: 4.978 Test Acc: 0.511
Validation loss decreased (-0.457991 --> -0.511401).  Saving model ...
Epoch: 5 cost time: 12.576399326324463
Epoch: 5, Steps: 32 | Train Loss: 1.157 Vali Loss: 7.441 Vali Acc: 0.359 Test Loss: 7.441 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.235436201095581
Epoch: 6, Steps: 32 | Train Loss: 0.702 Vali Loss: 6.968 Vali Acc: 0.458 Test Loss: 6.968 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.38567066192627
Epoch: 7, Steps: 32 | Train Loss: 0.158 Vali Loss: 6.973 Vali Acc: 0.458 Test Loss: 6.973 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.775645732879639
Epoch: 8, Steps: 32 | Train Loss: 0.172 Vali Loss: 8.437 Vali Acc: 0.443 Test Loss: 8.437 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.466830253601074
Epoch: 9, Steps: 32 | Train Loss: 0.022 Vali Loss: 9.190 Vali Acc: 0.420 Test Loss: 9.190 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.593523979187012
Epoch: 10, Steps: 32 | Train Loss: 0.003 Vali Loss: 9.427 Vali Acc: 0.427 Test Loss: 9.427 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.770712614059448
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.583 Vali Acc: 0.427 Test Loss: 9.583 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.641191482543945
Epoch: 12, Steps: 32 | Train Loss: 0.058 Vali Loss: 10.954 Vali Acc: 0.489 Test Loss: 10.954 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.269287586212158
Epoch: 13, Steps: 32 | Train Loss: 0.365 Vali Loss: 9.557 Vali Acc: 0.504 Test Loss: 9.557 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.575830698013306
Epoch: 14, Steps: 32 | Train Loss: 0.452 Vali Loss: 14.645 Vali Acc: 0.527 Test Loss: 14.645 Test Acc: 0.527
Validation loss decreased (-0.511401 --> -0.526571).  Saving model ...
Epoch: 15 cost time: 12.419633626937866
Epoch: 15, Steps: 32 | Train Loss: 0.249 Vali Loss: 12.601 Vali Acc: 0.466 Test Loss: 12.601 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.548970937728882
Epoch: 16, Steps: 32 | Train Loss: 0.487 Vali Loss: 12.661 Vali Acc: 0.534 Test Loss: 12.661 Test Acc: 0.534
Validation loss decreased (-0.526571 --> -0.534225).  Saving model ...
Epoch: 17 cost time: 12.653692245483398
Epoch: 17, Steps: 32 | Train Loss: 0.248 Vali Loss: 13.667 Vali Acc: 0.420 Test Loss: 13.667 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.890186786651611
Epoch: 18, Steps: 32 | Train Loss: 0.581 Vali Loss: 17.897 Vali Acc: 0.267 Test Loss: 17.897 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.734519004821777
Epoch: 19, Steps: 32 | Train Loss: 0.641 Vali Loss: 15.021 Vali Acc: 0.344 Test Loss: 15.021 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.770283222198486
Epoch: 20, Steps: 32 | Train Loss: 0.827 Vali Loss: 11.976 Vali Acc: 0.466 Test Loss: 11.976 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.745447635650635
Epoch: 21, Steps: 32 | Train Loss: 0.182 Vali Loss: 17.664 Vali Acc: 0.389 Test Loss: 17.664 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.518847227096558
Epoch: 22, Steps: 32 | Train Loss: 0.117 Vali Loss: 17.451 Vali Acc: 0.382 Test Loss: 17.451 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.333811283111572
Epoch: 23, Steps: 32 | Train Loss: 0.031 Vali Loss: 18.475 Vali Acc: 0.366 Test Loss: 18.475 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.965325117111206
Epoch: 24, Steps: 32 | Train Loss: 0.516 Vali Loss: 17.483 Vali Acc: 0.496 Test Loss: 17.483 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.803677797317505
Epoch: 25, Steps: 32 | Train Loss: 0.040 Vali Loss: 17.937 Vali Acc: 0.427 Test Loss: 17.937 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.573313236236572
Epoch: 26, Steps: 32 | Train Loss: 0.002 Vali Loss: 19.688 Vali Acc: 0.489 Test Loss: 19.688 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5947585
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.03494381904602
Epoch: 1, Steps: 32 | Train Loss: 2.493 Vali Loss: 5.176 Vali Acc: 0.420 Test Loss: 5.176 Test Acc: 0.420
Validation loss decreased (inf --> -0.419796).  Saving model ...
Epoch: 2 cost time: 12.077012538909912
Epoch: 2, Steps: 32 | Train Loss: 5.058 Vali Loss: 4.358 Vali Acc: 0.168 Test Loss: 4.358 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.049498796463013
Epoch: 3, Steps: 32 | Train Loss: 4.060 Vali Loss: 3.726 Vali Acc: 0.496 Test Loss: 3.726 Test Acc: 0.496
Validation loss decreased (-0.419796 --> -0.496146).  Saving model ...
Epoch: 4 cost time: 11.8743417263031
Epoch: 4, Steps: 32 | Train Loss: 1.882 Vali Loss: 5.078 Vali Acc: 0.435 Test Loss: 5.078 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.31014633178711
Epoch: 5, Steps: 32 | Train Loss: 0.621 Vali Loss: 5.477 Vali Acc: 0.481 Test Loss: 5.477 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.211097240447998
Epoch: 6, Steps: 32 | Train Loss: 1.157 Vali Loss: 7.998 Vali Acc: 0.366 Test Loss: 7.998 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.241935014724731
Epoch: 7, Steps: 32 | Train Loss: 0.216 Vali Loss: 7.011 Vali Acc: 0.481 Test Loss: 7.011 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.917718410491943
Epoch: 8, Steps: 32 | Train Loss: 0.093 Vali Loss: 8.369 Vali Acc: 0.473 Test Loss: 8.369 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.096447944641113
Epoch: 9, Steps: 32 | Train Loss: 0.254 Vali Loss: 10.150 Vali Acc: 0.489 Test Loss: 10.150 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.684713363647461
Epoch: 10, Steps: 32 | Train Loss: 0.105 Vali Loss: 8.609 Vali Acc: 0.473 Test Loss: 8.609 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.416314125061035
Epoch: 11, Steps: 32 | Train Loss: 0.012 Vali Loss: 10.126 Vali Acc: 0.519 Test Loss: 10.126 Test Acc: 0.519
Validation loss decreased (-0.496146 --> -0.518983).  Saving model ...
Epoch: 12 cost time: 12.426291704177856
Epoch: 12, Steps: 32 | Train Loss: 0.012 Vali Loss: 10.889 Vali Acc: 0.534 Test Loss: 10.889 Test Acc: 0.534
Validation loss decreased (-0.518983 --> -0.534242).  Saving model ...
Epoch: 13 cost time: 12.313543319702148
Epoch: 13, Steps: 32 | Train Loss: 0.171 Vali Loss: 9.410 Vali Acc: 0.481 Test Loss: 9.410 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.578604459762573
Epoch: 14, Steps: 32 | Train Loss: 0.264 Vali Loss: 11.762 Vali Acc: 0.420 Test Loss: 11.762 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.219573736190796
Epoch: 15, Steps: 32 | Train Loss: 0.271 Vali Loss: 13.737 Vali Acc: 0.504 Test Loss: 13.737 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.97450590133667
Epoch: 16, Steps: 32 | Train Loss: 0.342 Vali Loss: 15.824 Vali Acc: 0.351 Test Loss: 15.824 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.646301507949829
Epoch: 17, Steps: 32 | Train Loss: 0.582 Vali Loss: 12.796 Vali Acc: 0.435 Test Loss: 12.796 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.147188663482666
Epoch: 18, Steps: 32 | Train Loss: 0.036 Vali Loss: 12.812 Vali Acc: 0.374 Test Loss: 12.812 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.455871105194092
Epoch: 19, Steps: 32 | Train Loss: 0.015 Vali Loss: 14.432 Vali Acc: 0.412 Test Loss: 14.432 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.628926038742065
Epoch: 20, Steps: 32 | Train Loss: 0.382 Vali Loss: 14.951 Vali Acc: 0.328 Test Loss: 14.951 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.550079584121704
Epoch: 21, Steps: 32 | Train Loss: 0.265 Vali Loss: 14.787 Vali Acc: 0.389 Test Loss: 14.787 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.358443021774292
Epoch: 22, Steps: 32 | Train Loss: 0.546 Vali Loss: 17.290 Vali Acc: 0.458 Test Loss: 17.290 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5587649
model size : 30.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.6889967918396
Epoch: 1, Steps: 32 | Train Loss: 3.637 Vali Loss: 5.953 Vali Acc: 0.099 Test Loss: 5.953 Test Acc: 0.099
Validation loss decreased (inf --> -0.099177).  Saving model ...
Epoch: 2 cost time: 12.166881084442139
Epoch: 2, Steps: 32 | Train Loss: 4.593 Vali Loss: 11.435 Vali Acc: 0.420 Test Loss: 11.435 Test Acc: 0.420
Validation loss decreased (-0.099177 --> -0.419733).  Saving model ...
Epoch: 3 cost time: 12.451165437698364
Epoch: 3, Steps: 32 | Train Loss: 4.039 Vali Loss: 6.443 Vali Acc: 0.374 Test Loss: 6.443 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.860472679138184
Epoch: 4, Steps: 32 | Train Loss: 1.814 Vali Loss: 3.782 Vali Acc: 0.458 Test Loss: 3.782 Test Acc: 0.458
Validation loss decreased (-0.419733 --> -0.457977).  Saving model ...
Epoch: 5 cost time: 12.311747074127197
Epoch: 5, Steps: 32 | Train Loss: 0.416 Vali Loss: 5.053 Vali Acc: 0.489 Test Loss: 5.053 Test Acc: 0.489
Validation loss decreased (-0.457977 --> -0.488499).  Saving model ...
Epoch: 6 cost time: 12.392346620559692
Epoch: 6, Steps: 32 | Train Loss: 0.680 Vali Loss: 6.416 Vali Acc: 0.412 Test Loss: 6.416 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.08788776397705
Epoch: 7, Steps: 32 | Train Loss: 0.346 Vali Loss: 6.457 Vali Acc: 0.374 Test Loss: 6.457 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.685819149017334
Epoch: 8, Steps: 32 | Train Loss: 0.008 Vali Loss: 9.094 Vali Acc: 0.481 Test Loss: 9.094 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.07236361503601
Epoch: 9, Steps: 32 | Train Loss: 0.280 Vali Loss: 8.572 Vali Acc: 0.397 Test Loss: 8.572 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.24819302558899
Epoch: 10, Steps: 32 | Train Loss: 0.455 Vali Loss: 9.143 Vali Acc: 0.489 Test Loss: 9.143 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.14086389541626
Epoch: 11, Steps: 32 | Train Loss: 0.160 Vali Loss: 10.891 Vali Acc: 0.481 Test Loss: 10.891 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.27813172340393
Epoch: 12, Steps: 32 | Train Loss: 0.377 Vali Loss: 11.433 Vali Acc: 0.481 Test Loss: 11.433 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.088292837142944
Epoch: 13, Steps: 32 | Train Loss: 0.036 Vali Loss: 14.948 Vali Acc: 0.389 Test Loss: 14.948 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.20276427268982
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 12.654 Vali Acc: 0.420 Test Loss: 12.654 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.847930192947388
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.648 Vali Acc: 0.435 Test Loss: 13.648 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 5227713
model size : 28.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.858120918273926
Epoch: 1, Steps: 32 | Train Loss: 3.617 Vali Loss: 4.510 Vali Acc: 0.137 Test Loss: 4.510 Test Acc: 0.137
Validation loss decreased (inf --> -0.137359).  Saving model ...
Epoch: 2 cost time: 12.977306365966797
Epoch: 2, Steps: 32 | Train Loss: 7.984 Vali Loss: 15.544 Vali Acc: 0.137 Test Loss: 15.544 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.03266429901123
Epoch: 3, Steps: 32 | Train Loss: 6.937 Vali Loss: 6.594 Vali Acc: 0.191 Test Loss: 6.594 Test Acc: 0.191
Validation loss decreased (-0.137359 --> -0.190774).  Saving model ...
Epoch: 4 cost time: 13.328078031539917
Epoch: 4, Steps: 32 | Train Loss: 3.028 Vali Loss: 8.057 Vali Acc: 0.267 Test Loss: 8.057 Test Acc: 0.267
Validation loss decreased (-0.190774 --> -0.267095).  Saving model ...
Epoch: 5 cost time: 13.353396654129028
Epoch: 5, Steps: 32 | Train Loss: 1.260 Vali Loss: 5.300 Vali Acc: 0.466 Test Loss: 5.300 Test Acc: 0.466
Validation loss decreased (-0.267095 --> -0.465596).  Saving model ...
Epoch: 6 cost time: 12.823081731796265
Epoch: 6, Steps: 32 | Train Loss: 0.434 Vali Loss: 6.024 Vali Acc: 0.435 Test Loss: 6.024 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.695641994476318
Epoch: 7, Steps: 32 | Train Loss: 0.194 Vali Loss: 6.811 Vali Acc: 0.435 Test Loss: 6.811 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.397732973098755
Epoch: 8, Steps: 32 | Train Loss: 0.103 Vali Loss: 8.886 Vali Acc: 0.382 Test Loss: 8.886 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.965445280075073
Epoch: 9, Steps: 32 | Train Loss: 0.540 Vali Loss: 9.899 Vali Acc: 0.466 Test Loss: 9.899 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.814010620117188
Epoch: 10, Steps: 32 | Train Loss: 0.338 Vali Loss: 14.712 Vali Acc: 0.382 Test Loss: 14.712 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.949997901916504
Epoch: 11, Steps: 32 | Train Loss: 0.180 Vali Loss: 15.019 Vali Acc: 0.504 Test Loss: 15.019 Test Acc: 0.504
Validation loss decreased (-0.465596 --> -0.503667).  Saving model ...
Epoch: 12 cost time: 12.851665258407593
Epoch: 12, Steps: 32 | Train Loss: 0.632 Vali Loss: 13.140 Vali Acc: 0.389 Test Loss: 13.140 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.695003032684326
Epoch: 13, Steps: 32 | Train Loss: 0.862 Vali Loss: 12.065 Vali Acc: 0.481 Test Loss: 12.065 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.92093539237976
Epoch: 14, Steps: 32 | Train Loss: 0.265 Vali Loss: 16.431 Vali Acc: 0.397 Test Loss: 16.431 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.6760995388031
Epoch: 15, Steps: 32 | Train Loss: 0.100 Vali Loss: 12.519 Vali Acc: 0.427 Test Loss: 12.519 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.628337860107422
Epoch: 16, Steps: 32 | Train Loss: 0.449 Vali Loss: 13.555 Vali Acc: 0.443 Test Loss: 13.555 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.237854480743408
Epoch: 17, Steps: 32 | Train Loss: 0.026 Vali Loss: 13.464 Vali Acc: 0.336 Test Loss: 13.464 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.95140027999878
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.435 Vali Acc: 0.382 Test Loss: 13.435 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.054755926132202
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.526 Vali Acc: 0.412 Test Loss: 13.526 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.021284103393555
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.532 Vali Acc: 0.412 Test Loss: 13.532 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.576012372970581
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.532 Vali Acc: 0.412 Test Loss: 13.532 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6011457
model size : 31.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.564372301101685
Epoch: 1, Steps: 32 | Train Loss: 3.108 Vali Loss: 3.028 Vali Acc: 0.420 Test Loss: 3.028 Test Acc: 0.420
Validation loss decreased (inf --> -0.419817).  Saving model ...
Epoch: 2 cost time: 12.579163551330566
Epoch: 2, Steps: 32 | Train Loss: 3.306 Vali Loss: 3.831 Vali Acc: 0.427 Test Loss: 3.831 Test Acc: 0.427
Validation loss decreased (-0.419817 --> -0.427443).  Saving model ...
Epoch: 3 cost time: 12.342433452606201
Epoch: 3, Steps: 32 | Train Loss: 3.308 Vali Loss: 7.179 Vali Acc: 0.450 Test Loss: 7.179 Test Acc: 0.450
Validation loss decreased (-0.427443 --> -0.450310).  Saving model ...
Epoch: 4 cost time: 12.34560489654541
Epoch: 4, Steps: 32 | Train Loss: 1.889 Vali Loss: 4.336 Vali Acc: 0.359 Test Loss: 4.336 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.092838764190674
Epoch: 5, Steps: 32 | Train Loss: 1.695 Vali Loss: 7.284 Vali Acc: 0.420 Test Loss: 7.284 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.993423700332642
Epoch: 6, Steps: 32 | Train Loss: 0.548 Vali Loss: 9.528 Vali Acc: 0.397 Test Loss: 9.528 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.937351703643799
Epoch: 7, Steps: 32 | Train Loss: 0.262 Vali Loss: 9.806 Vali Acc: 0.527 Test Loss: 9.806 Test Acc: 0.527
Validation loss decreased (-0.450310 --> -0.526619).  Saving model ...
Epoch: 8 cost time: 12.258946418762207
Epoch: 8, Steps: 32 | Train Loss: 0.275 Vali Loss: 8.780 Vali Acc: 0.435 Test Loss: 8.780 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.104053497314453
Epoch: 9, Steps: 32 | Train Loss: 0.151 Vali Loss: 11.883 Vali Acc: 0.489 Test Loss: 11.883 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.329337120056152
Epoch: 10, Steps: 32 | Train Loss: 0.039 Vali Loss: 11.979 Vali Acc: 0.450 Test Loss: 11.979 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.032077550888062
Epoch: 11, Steps: 32 | Train Loss: 0.038 Vali Loss: 8.206 Vali Acc: 0.443 Test Loss: 8.206 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.007437229156494
Epoch: 12, Steps: 32 | Train Loss: 0.280 Vali Loss: 11.340 Vali Acc: 0.534 Test Loss: 11.340 Test Acc: 0.534
Validation loss decreased (-0.526619 --> -0.534238).  Saving model ...
Epoch: 13 cost time: 12.067856311798096
Epoch: 13, Steps: 32 | Train Loss: 0.143 Vali Loss: 9.788 Vali Acc: 0.481 Test Loss: 9.788 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.026206493377686
Epoch: 14, Steps: 32 | Train Loss: 0.847 Vali Loss: 13.753 Vali Acc: 0.519 Test Loss: 13.753 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.917968988418579
Epoch: 15, Steps: 32 | Train Loss: 0.048 Vali Loss: 11.673 Vali Acc: 0.550 Test Loss: 11.673 Test Acc: 0.550
Validation loss decreased (-0.534238 --> -0.549502).  Saving model ...
Epoch: 16 cost time: 12.095948934555054
Epoch: 16, Steps: 32 | Train Loss: 0.009 Vali Loss: 12.451 Vali Acc: 0.557 Test Loss: 12.451 Test Acc: 0.557
Validation loss decreased (-0.549502 --> -0.557127).  Saving model ...
Epoch: 17 cost time: 11.976946353912354
Epoch: 17, Steps: 32 | Train Loss: 0.132 Vali Loss: 12.724 Vali Acc: 0.435 Test Loss: 12.724 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.917986631393433
Epoch: 18, Steps: 32 | Train Loss: 0.063 Vali Loss: 11.234 Vali Acc: 0.443 Test Loss: 11.234 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.484108924865723
Epoch: 19, Steps: 32 | Train Loss: 0.103 Vali Loss: 15.518 Vali Acc: 0.389 Test Loss: 15.518 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.598828315734863
Epoch: 20, Steps: 32 | Train Loss: 0.351 Vali Loss: 11.465 Vali Acc: 0.458 Test Loss: 11.465 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.923172235488892
Epoch: 21, Steps: 32 | Train Loss: 0.138 Vali Loss: 14.360 Vali Acc: 0.382 Test Loss: 14.360 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.397457122802734
Epoch: 22, Steps: 32 | Train Loss: 0.343 Vali Loss: 13.456 Vali Acc: 0.489 Test Loss: 13.456 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.895054817199707
Epoch: 23, Steps: 32 | Train Loss: 1.246 Vali Loss: 14.711 Vali Acc: 0.344 Test Loss: 14.711 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.384452104568481
Epoch: 24, Steps: 32 | Train Loss: 2.865 Vali Loss: 19.562 Vali Acc: 0.313 Test Loss: 19.562 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.607635498046875
Epoch: 25, Steps: 32 | Train Loss: 1.643 Vali Loss: 21.624 Vali Acc: 0.328 Test Loss: 21.624 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.153349161148071
Epoch: 26, Steps: 32 | Train Loss: 1.911 Vali Loss: 17.706 Vali Acc: 0.336 Test Loss: 17.706 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 5651521
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.524437427520752
Epoch: 1, Steps: 32 | Train Loss: 2.641 Vali Loss: 6.494 Vali Acc: 0.420 Test Loss: 6.494 Test Acc: 0.420
Validation loss decreased (inf --> -0.419782).  Saving model ...
Epoch: 2 cost time: 12.278421878814697
Epoch: 2, Steps: 32 | Train Loss: 5.399 Vali Loss: 1.837 Vali Acc: 0.244 Test Loss: 1.837 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.390987634658813
Epoch: 3, Steps: 32 | Train Loss: 2.722 Vali Loss: 4.775 Vali Acc: 0.244 Test Loss: 4.775 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.343505382537842
Epoch: 4, Steps: 32 | Train Loss: 1.583 Vali Loss: 7.230 Vali Acc: 0.504 Test Loss: 7.230 Test Acc: 0.504
Validation loss decreased (-0.419782 --> -0.503744).  Saving model ...
Epoch: 5 cost time: 12.600641012191772
Epoch: 5, Steps: 32 | Train Loss: 1.293 Vali Loss: 7.736 Vali Acc: 0.534 Test Loss: 7.736 Test Acc: 0.534
Validation loss decreased (-0.503744 --> -0.534274).  Saving model ...
Epoch: 6 cost time: 12.781646251678467
Epoch: 6, Steps: 32 | Train Loss: 0.250 Vali Loss: 6.678 Vali Acc: 0.435 Test Loss: 6.678 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.014421224594116
Epoch: 7, Steps: 32 | Train Loss: 0.275 Vali Loss: 6.992 Vali Acc: 0.359 Test Loss: 6.992 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.51500129699707
Epoch: 8, Steps: 32 | Train Loss: 0.003 Vali Loss: 8.807 Vali Acc: 0.328 Test Loss: 8.807 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.657924890518188
Epoch: 9, Steps: 32 | Train Loss: 0.329 Vali Loss: 7.931 Vali Acc: 0.412 Test Loss: 7.931 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.501468658447266
Epoch: 10, Steps: 32 | Train Loss: 0.052 Vali Loss: 8.154 Vali Acc: 0.481 Test Loss: 8.154 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.501464366912842
Epoch: 11, Steps: 32 | Train Loss: 0.167 Vali Loss: 9.461 Vali Acc: 0.344 Test Loss: 9.461 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.23757028579712
Epoch: 12, Steps: 32 | Train Loss: 0.382 Vali Loss: 12.214 Vali Acc: 0.489 Test Loss: 12.214 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.242618083953857
Epoch: 13, Steps: 32 | Train Loss: 0.886 Vali Loss: 11.849 Vali Acc: 0.260 Test Loss: 11.849 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.352823972702026
Epoch: 14, Steps: 32 | Train Loss: 0.680 Vali Loss: 14.119 Vali Acc: 0.481 Test Loss: 14.119 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.395065784454346
Epoch: 15, Steps: 32 | Train Loss: 1.010 Vali Loss: 12.849 Vali Acc: 0.443 Test Loss: 12.849 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5291585
model size : 29.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.479702711105347
Epoch: 1, Steps: 32 | Train Loss: 3.430 Vali Loss: 6.096 Vali Acc: 0.168 Test Loss: 6.096 Test Acc: 0.168
Validation loss decreased (inf --> -0.167878).  Saving model ...
Epoch: 2 cost time: 11.480796337127686
Epoch: 2, Steps: 32 | Train Loss: 2.935 Vali Loss: 3.487 Vali Acc: 0.427 Test Loss: 3.487 Test Acc: 0.427
Validation loss decreased (-0.167878 --> -0.427446).  Saving model ...
Epoch: 3 cost time: 11.720129013061523
Epoch: 3, Steps: 32 | Train Loss: 5.427 Vali Loss: 3.988 Vali Acc: 0.481 Test Loss: 3.988 Test Acc: 0.481
Validation loss decreased (-0.427446 --> -0.480876).  Saving model ...
Epoch: 4 cost time: 12.501803398132324
Epoch: 4, Steps: 32 | Train Loss: 1.554 Vali Loss: 4.206 Vali Acc: 0.450 Test Loss: 4.206 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.384661197662354
Epoch: 5, Steps: 32 | Train Loss: 0.952 Vali Loss: 8.472 Vali Acc: 0.473 Test Loss: 8.472 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.376749753952026
Epoch: 6, Steps: 32 | Train Loss: 0.423 Vali Loss: 5.727 Vali Acc: 0.519 Test Loss: 5.727 Test Acc: 0.519
Validation loss decreased (-0.480876 --> -0.519027).  Saving model ...
Epoch: 7 cost time: 12.15651798248291
Epoch: 7, Steps: 32 | Train Loss: 0.294 Vali Loss: 6.891 Vali Acc: 0.489 Test Loss: 6.891 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.983250617980957
Epoch: 8, Steps: 32 | Train Loss: 0.203 Vali Loss: 11.666 Vali Acc: 0.260 Test Loss: 11.666 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.421528100967407
Epoch: 9, Steps: 32 | Train Loss: 0.149 Vali Loss: 13.366 Vali Acc: 0.519 Test Loss: 13.366 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.692877769470215
Epoch: 10, Steps: 32 | Train Loss: 0.527 Vali Loss: 10.633 Vali Acc: 0.466 Test Loss: 10.633 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.687152624130249
Epoch: 11, Steps: 32 | Train Loss: 0.137 Vali Loss: 10.932 Vali Acc: 0.496 Test Loss: 10.932 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.501044750213623
Epoch: 12, Steps: 32 | Train Loss: 0.039 Vali Loss: 9.472 Vali Acc: 0.496 Test Loss: 9.472 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.982258558273315
Epoch: 13, Steps: 32 | Train Loss: 0.278 Vali Loss: 12.209 Vali Acc: 0.420 Test Loss: 12.209 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.469933032989502
Epoch: 14, Steps: 32 | Train Loss: 0.485 Vali Loss: 9.134 Vali Acc: 0.420 Test Loss: 9.134 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.17143201828003
Epoch: 15, Steps: 32 | Train Loss: 0.047 Vali Loss: 10.346 Vali Acc: 0.511 Test Loss: 10.346 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.627911567687988
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 14.849 Vali Acc: 0.336 Test Loss: 14.849 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 4931649
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.235926628112793
Epoch: 1, Steps: 32 | Train Loss: 2.689 Vali Loss: 2.024 Vali Acc: 0.176 Test Loss: 2.024 Test Acc: 0.176
Validation loss decreased (inf --> -0.175552).  Saving model ...
Epoch: 2 cost time: 12.299775838851929
Epoch: 2, Steps: 32 | Train Loss: 2.968 Vali Loss: 2.806 Vali Acc: 0.427 Test Loss: 2.806 Test Acc: 0.427
Validation loss decreased (-0.175552 --> -0.427453).  Saving model ...
Epoch: 3 cost time: 12.350409030914307
Epoch: 3, Steps: 32 | Train Loss: 2.522 Vali Loss: 1.948 Vali Acc: 0.511 Test Loss: 1.948 Test Acc: 0.511
Validation loss decreased (-0.427453 --> -0.511431).  Saving model ...
Epoch: 4 cost time: 12.00536847114563
Epoch: 4, Steps: 32 | Train Loss: 0.769 Vali Loss: 3.342 Vali Acc: 0.527 Test Loss: 3.342 Test Acc: 0.527
Validation loss decreased (-0.511431 --> -0.526684).  Saving model ...
Epoch: 5 cost time: 12.083464622497559
Epoch: 5, Steps: 32 | Train Loss: 0.224 Vali Loss: 3.609 Vali Acc: 0.496 Test Loss: 3.609 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.137277364730835
Epoch: 6, Steps: 32 | Train Loss: 0.081 Vali Loss: 4.020 Vali Acc: 0.412 Test Loss: 4.020 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.848777532577515
Epoch: 7, Steps: 32 | Train Loss: 0.238 Vali Loss: 6.812 Vali Acc: 0.489 Test Loss: 6.812 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.990051746368408
Epoch: 8, Steps: 32 | Train Loss: 0.404 Vali Loss: 3.722 Vali Acc: 0.466 Test Loss: 3.722 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.81648874282837
Epoch: 9, Steps: 32 | Train Loss: 0.195 Vali Loss: 5.174 Vali Acc: 0.496 Test Loss: 5.174 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.27827501296997
Epoch: 10, Steps: 32 | Train Loss: 0.036 Vali Loss: 5.958 Vali Acc: 0.412 Test Loss: 5.958 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.006640195846558
Epoch: 11, Steps: 32 | Train Loss: 0.007 Vali Loss: 5.368 Vali Acc: 0.389 Test Loss: 5.368 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.541610717773438
Epoch: 12, Steps: 32 | Train Loss: 0.008 Vali Loss: 5.624 Vali Acc: 0.412 Test Loss: 5.624 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.162402391433716
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.945 Vali Acc: 0.405 Test Loss: 4.945 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.134604692459106
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.443 Test Loss: 4.882 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3456769
model size : 17.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.114289283752441
Epoch: 1, Steps: 32 | Train Loss: 2.549 Vali Loss: 2.480 Vali Acc: 0.420 Test Loss: 2.480 Test Acc: 0.420
Validation loss decreased (inf --> -0.419823).  Saving model ...
Epoch: 2 cost time: 12.811028718948364
Epoch: 2, Steps: 32 | Train Loss: 2.667 Vali Loss: 3.039 Vali Acc: 0.183 Test Loss: 3.039 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.607471704483032
Epoch: 3, Steps: 32 | Train Loss: 1.425 Vali Loss: 2.502 Vali Acc: 0.481 Test Loss: 2.502 Test Acc: 0.481
Validation loss decreased (-0.419823 --> -0.480891).  Saving model ...
Epoch: 4 cost time: 12.924397706985474
Epoch: 4, Steps: 32 | Train Loss: 0.332 Vali Loss: 3.937 Vali Acc: 0.489 Test Loss: 3.937 Test Acc: 0.489
Validation loss decreased (-0.480891 --> -0.488510).  Saving model ...
Epoch: 5 cost time: 12.669131755828857
Epoch: 5, Steps: 32 | Train Loss: 0.623 Vali Loss: 3.694 Vali Acc: 0.420 Test Loss: 3.694 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.146413326263428
Epoch: 6, Steps: 32 | Train Loss: 0.122 Vali Loss: 3.500 Vali Acc: 0.534 Test Loss: 3.500 Test Acc: 0.534
Validation loss decreased (-0.488510 --> -0.534316).  Saving model ...
Epoch: 7 cost time: 12.587154626846313
Epoch: 7, Steps: 32 | Train Loss: 0.080 Vali Loss: 4.911 Vali Acc: 0.481 Test Loss: 4.911 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.819429636001587
Epoch: 8, Steps: 32 | Train Loss: 0.002 Vali Loss: 4.288 Vali Acc: 0.397 Test Loss: 4.288 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.879294157028198
Epoch: 9, Steps: 32 | Train Loss: 0.231 Vali Loss: 6.069 Vali Acc: 0.542 Test Loss: 6.069 Test Acc: 0.542
Validation loss decreased (-0.534316 --> -0.541924).  Saving model ...
Epoch: 10 cost time: 12.860212564468384
Epoch: 10, Steps: 32 | Train Loss: 0.013 Vali Loss: 4.259 Vali Acc: 0.443 Test Loss: 4.259 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.811679363250732
Epoch: 11, Steps: 32 | Train Loss: 0.039 Vali Loss: 5.535 Vali Acc: 0.542 Test Loss: 5.535 Test Acc: 0.542
Validation loss decreased (-0.541924 --> -0.541929).  Saving model ...
Epoch: 12 cost time: 12.923718929290771
Epoch: 12, Steps: 32 | Train Loss: 0.018 Vali Loss: 5.065 Vali Acc: 0.435 Test Loss: 5.065 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.090150594711304
Epoch: 13, Steps: 32 | Train Loss: 0.056 Vali Loss: 6.133 Vali Acc: 0.420 Test Loss: 6.133 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.157291173934937
Epoch: 14, Steps: 32 | Train Loss: 0.006 Vali Loss: 7.076 Vali Acc: 0.466 Test Loss: 7.076 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.126709461212158
Epoch: 15, Steps: 32 | Train Loss: 0.001 Vali Loss: 6.692 Vali Acc: 0.389 Test Loss: 6.692 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.166990995407104
Epoch: 16, Steps: 32 | Train Loss: 0.015 Vali Loss: 6.635 Vali Acc: 0.534 Test Loss: 6.635 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.22015929222107
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.235 Vali Acc: 0.511 Test Loss: 6.235 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.598982810974121
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.458 Vali Acc: 0.481 Test Loss: 6.458 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.471736907958984
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.365 Vali Acc: 0.458 Test Loss: 6.365 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.544486284255981
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.333 Vali Acc: 0.450 Test Loss: 6.333 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.850320816040039
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.320 Vali Acc: 0.450 Test Loss: 6.320 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3276801
model size : 17.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.447938680648804
Epoch: 1, Steps: 32 | Train Loss: 2.377 Vali Loss: 4.693 Vali Acc: 0.176 Test Loss: 4.693 Test Acc: 0.176
Validation loss decreased (inf --> -0.175526).  Saving model ...
Epoch: 2 cost time: 13.313366174697876
Epoch: 2, Steps: 32 | Train Loss: 3.764 Vali Loss: 3.354 Vali Acc: 0.198 Test Loss: 3.354 Test Acc: 0.198
Validation loss decreased (-0.175526 --> -0.198440).  Saving model ...
Epoch: 3 cost time: 12.605817794799805
Epoch: 3, Steps: 32 | Train Loss: 2.221 Vali Loss: 2.420 Vali Acc: 0.481 Test Loss: 2.420 Test Acc: 0.481
Validation loss decreased (-0.198440 --> -0.480892).  Saving model ...
Epoch: 4 cost time: 12.591303586959839
Epoch: 4, Steps: 32 | Train Loss: 0.625 Vali Loss: 3.167 Vali Acc: 0.344 Test Loss: 3.167 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.479958295822144
Epoch: 5, Steps: 32 | Train Loss: 0.244 Vali Loss: 3.266 Vali Acc: 0.519 Test Loss: 3.266 Test Acc: 0.519
Validation loss decreased (-0.480892 --> -0.519051).  Saving model ...
Epoch: 6 cost time: 11.860867023468018
Epoch: 6, Steps: 32 | Train Loss: 0.229 Vali Loss: 3.798 Vali Acc: 0.481 Test Loss: 3.798 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.164198398590088
Epoch: 7, Steps: 32 | Train Loss: 0.041 Vali Loss: 4.204 Vali Acc: 0.481 Test Loss: 4.204 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.701317310333252
Epoch: 8, Steps: 32 | Train Loss: 0.110 Vali Loss: 6.017 Vali Acc: 0.504 Test Loss: 6.017 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.717118978500366
Epoch: 9, Steps: 32 | Train Loss: 0.127 Vali Loss: 3.670 Vali Acc: 0.504 Test Loss: 3.670 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.643880128860474
Epoch: 10, Steps: 32 | Train Loss: 0.005 Vali Loss: 5.318 Vali Acc: 0.443 Test Loss: 5.318 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.435140371322632
Epoch: 11, Steps: 32 | Train Loss: 0.018 Vali Loss: 5.564 Vali Acc: 0.412 Test Loss: 5.564 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.039262533187866
Epoch: 12, Steps: 32 | Train Loss: 0.043 Vali Loss: 4.711 Vali Acc: 0.473 Test Loss: 4.711 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.00275731086731
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.060 Vali Acc: 0.496 Test Loss: 5.060 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.670104265213013
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.263 Vali Acc: 0.481 Test Loss: 5.263 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.821840763092041
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.198 Vali Acc: 0.481 Test Loss: 5.198 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 3096833
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.763046026229858
Epoch: 1, Steps: 32 | Train Loss: 2.220 Vali Loss: 3.045 Vali Acc: 0.176 Test Loss: 3.045 Test Acc: 0.176
Validation loss decreased (inf --> -0.175542).  Saving model ...
Epoch: 2 cost time: 11.756620645523071
Epoch: 2, Steps: 32 | Train Loss: 2.766 Vali Loss: 2.021 Vali Acc: 0.206 Test Loss: 2.021 Test Acc: 0.206
Validation loss decreased (-0.175542 --> -0.206087).  Saving model ...
Epoch: 3 cost time: 12.143834114074707
Epoch: 3, Steps: 32 | Train Loss: 1.624 Vali Loss: 2.506 Vali Acc: 0.351 Test Loss: 2.506 Test Acc: 0.351
Validation loss decreased (-0.206087 --> -0.351120).  Saving model ...
Epoch: 4 cost time: 12.009677410125732
Epoch: 4, Steps: 32 | Train Loss: 0.836 Vali Loss: 6.889 Vali Acc: 0.489 Test Loss: 6.889 Test Acc: 0.489
Validation loss decreased (-0.351120 --> -0.488481).  Saving model ...
Epoch: 5 cost time: 12.158333778381348
Epoch: 5, Steps: 32 | Train Loss: 0.438 Vali Loss: 5.410 Vali Acc: 0.527 Test Loss: 5.410 Test Acc: 0.527
Validation loss decreased (-0.488481 --> -0.526663).  Saving model ...
Epoch: 6 cost time: 11.921338319778442
Epoch: 6, Steps: 32 | Train Loss: 0.131 Vali Loss: 4.163 Vali Acc: 0.466 Test Loss: 4.163 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.017487525939941
Epoch: 7, Steps: 32 | Train Loss: 0.017 Vali Loss: 4.659 Vali Acc: 0.412 Test Loss: 4.659 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.609968900680542
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.521 Vali Acc: 0.458 Test Loss: 4.521 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.056072235107422
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.515 Vali Acc: 0.458 Test Loss: 4.515 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.226290225982666
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.518 Vali Acc: 0.466 Test Loss: 4.518 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.79014253616333
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.516 Vali Acc: 0.466 Test Loss: 4.516 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.139748573303223
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.509 Vali Acc: 0.466 Test Loss: 4.509 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.163564205169678
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.488 Vali Acc: 0.466 Test Loss: 4.488 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.5261549949646
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.491 Vali Acc: 0.466 Test Loss: 4.491 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.445135116577148
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.486 Vali Acc: 0.466 Test Loss: 4.486 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2916865
model size : 15.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.837012529373169
Epoch: 1, Steps: 32 | Train Loss: 2.562 Vali Loss: 3.188 Vali Acc: 0.420 Test Loss: 3.188 Test Acc: 0.420
Validation loss decreased (inf --> -0.419815).  Saving model ...
Epoch: 2 cost time: 12.75034236907959
Epoch: 2, Steps: 32 | Train Loss: 2.792 Vali Loss: 3.271 Vali Acc: 0.176 Test Loss: 3.271 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.822451829910278
Epoch: 3, Steps: 32 | Train Loss: 2.268 Vali Loss: 2.315 Vali Acc: 0.313 Test Loss: 2.315 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.205086708068848
Epoch: 4, Steps: 32 | Train Loss: 0.853 Vali Loss: 3.353 Vali Acc: 0.466 Test Loss: 3.353 Test Acc: 0.466
Validation loss decreased (-0.419815 --> -0.465615).  Saving model ...
Epoch: 5 cost time: 12.191264390945435
Epoch: 5, Steps: 32 | Train Loss: 0.167 Vali Loss: 3.582 Vali Acc: 0.443 Test Loss: 3.582 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.074400901794434
Epoch: 6, Steps: 32 | Train Loss: 0.285 Vali Loss: 4.330 Vali Acc: 0.336 Test Loss: 4.330 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.341094255447388
Epoch: 7, Steps: 32 | Train Loss: 0.157 Vali Loss: 4.320 Vali Acc: 0.519 Test Loss: 4.320 Test Acc: 0.519
Validation loss decreased (-0.465615 --> -0.519041).  Saving model ...
Epoch: 8 cost time: 12.59393835067749
Epoch: 8, Steps: 32 | Train Loss: 0.045 Vali Loss: 3.994 Vali Acc: 0.527 Test Loss: 3.994 Test Acc: 0.527
Validation loss decreased (-0.519041 --> -0.526678).  Saving model ...
Epoch: 9 cost time: 12.19536805152893
Epoch: 9, Steps: 32 | Train Loss: 0.028 Vali Loss: 4.804 Vali Acc: 0.565 Test Loss: 4.804 Test Acc: 0.565
Validation loss decreased (-0.526678 --> -0.564837).  Saving model ...
Epoch: 10 cost time: 13.007340669631958
Epoch: 10, Steps: 32 | Train Loss: 0.086 Vali Loss: 5.722 Vali Acc: 0.557 Test Loss: 5.722 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.25678014755249
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.230 Vali Acc: 0.489 Test Loss: 4.230 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.078736782073975
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.269 Vali Acc: 0.496 Test Loss: 4.269 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.600181818008423
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.289 Vali Acc: 0.489 Test Loss: 4.289 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.520096063613892
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.287 Vali Acc: 0.489 Test Loss: 4.287 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.880325078964233
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.286 Vali Acc: 0.489 Test Loss: 4.286 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.953030586242676
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.283 Vali Acc: 0.489 Test Loss: 4.283 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.290811777114868
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.282 Vali Acc: 0.489 Test Loss: 4.282 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.959804058074951
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.281 Vali Acc: 0.489 Test Loss: 4.281 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.35568356513977
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.283 Vali Acc: 0.489 Test Loss: 4.283 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2862337
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.684234380722046
Epoch: 1, Steps: 32 | Train Loss: 2.292 Vali Loss: 2.780 Vali Acc: 0.176 Test Loss: 2.780 Test Acc: 0.176
Validation loss decreased (inf --> -0.175545).  Saving model ...
Epoch: 2 cost time: 12.559091091156006
Epoch: 2, Steps: 32 | Train Loss: 2.721 Vali Loss: 2.577 Vali Acc: 0.176 Test Loss: 2.577 Test Acc: 0.176
Validation loss decreased (-0.175545 --> -0.175547).  Saving model ...
Epoch: 3 cost time: 11.946432113647461
Epoch: 3, Steps: 32 | Train Loss: 2.041 Vali Loss: 3.800 Vali Acc: 0.168 Test Loss: 3.800 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.556469202041626
Epoch: 4, Steps: 32 | Train Loss: 2.721 Vali Loss: 2.866 Vali Acc: 0.420 Test Loss: 2.866 Test Acc: 0.420
Validation loss decreased (-0.175547 --> -0.419819).  Saving model ...
Epoch: 5 cost time: 12.31416392326355
Epoch: 5, Steps: 32 | Train Loss: 0.876 Vali Loss: 3.811 Vali Acc: 0.473 Test Loss: 3.811 Test Acc: 0.473
Validation loss decreased (-0.419819 --> -0.473244).  Saving model ...
Epoch: 6 cost time: 12.17572808265686
Epoch: 6, Steps: 32 | Train Loss: 0.274 Vali Loss: 4.572 Vali Acc: 0.427 Test Loss: 4.572 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.311823606491089
Epoch: 7, Steps: 32 | Train Loss: 0.078 Vali Loss: 5.109 Vali Acc: 0.420 Test Loss: 5.109 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.108757019042969
Epoch: 8, Steps: 32 | Train Loss: 0.024 Vali Loss: 5.044 Vali Acc: 0.427 Test Loss: 5.044 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.532614469528198
Epoch: 9, Steps: 32 | Train Loss: 0.103 Vali Loss: 5.278 Vali Acc: 0.489 Test Loss: 5.278 Test Acc: 0.489
Validation loss decreased (-0.473244 --> -0.488497).  Saving model ...
Epoch: 10 cost time: 12.219952821731567
Epoch: 10, Steps: 32 | Train Loss: 0.070 Vali Loss: 6.607 Vali Acc: 0.504 Test Loss: 6.607 Test Acc: 0.504
Validation loss decreased (-0.488497 --> -0.503751).  Saving model ...
Epoch: 11 cost time: 12.305245161056519
Epoch: 11, Steps: 32 | Train Loss: 0.009 Vali Loss: 6.079 Vali Acc: 0.504 Test Loss: 6.079 Test Acc: 0.504
Validation loss decreased (-0.503751 --> -0.503756).  Saving model ...
Epoch: 12 cost time: 12.426304340362549
Epoch: 12, Steps: 32 | Train Loss: 0.004 Vali Loss: 5.643 Vali Acc: 0.473 Test Loss: 5.643 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.072096824645996
Epoch: 13, Steps: 32 | Train Loss: 0.168 Vali Loss: 5.630 Vali Acc: 0.473 Test Loss: 5.630 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.51468539237976
Epoch: 14, Steps: 32 | Train Loss: 0.009 Vali Loss: 6.093 Vali Acc: 0.412 Test Loss: 6.093 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.845174074172974
Epoch: 15, Steps: 32 | Train Loss: 0.004 Vali Loss: 6.422 Vali Acc: 0.443 Test Loss: 6.422 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.264323711395264
Epoch: 16, Steps: 32 | Train Loss: 0.005 Vali Loss: 6.701 Vali Acc: 0.504 Test Loss: 6.701 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.48737120628357
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.616 Vali Acc: 0.496 Test Loss: 6.616 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.770431995391846
Epoch: 18, Steps: 32 | Train Loss: 0.004 Vali Loss: 6.945 Vali Acc: 0.427 Test Loss: 6.945 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.979998588562012
Epoch: 19, Steps: 32 | Train Loss: 0.058 Vali Loss: 6.510 Vali Acc: 0.466 Test Loss: 6.510 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.806400537490845
Epoch: 20, Steps: 32 | Train Loss: 0.054 Vali Loss: 7.265 Vali Acc: 0.481 Test Loss: 7.265 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.330447912216187
Epoch: 21, Steps: 32 | Train Loss: 0.163 Vali Loss: 9.300 Vali Acc: 0.420 Test Loss: 9.300 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 2682369
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.338464736938477
Epoch: 1, Steps: 32 | Train Loss: 2.095 Vali Loss: 2.530 Vali Acc: 0.420 Test Loss: 2.530 Test Acc: 0.420
Validation loss decreased (inf --> -0.419822).  Saving model ...
Epoch: 2 cost time: 11.720659732818604
Epoch: 2, Steps: 32 | Train Loss: 2.138 Vali Loss: 1.741 Vali Acc: 0.450 Test Loss: 1.741 Test Acc: 0.450
Validation loss decreased (-0.419822 --> -0.450364).  Saving model ...
Epoch: 3 cost time: 11.8505117893219
Epoch: 3, Steps: 32 | Train Loss: 2.285 Vali Loss: 2.560 Vali Acc: 0.374 Test Loss: 2.560 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.410771131515503
Epoch: 4, Steps: 32 | Train Loss: 1.297 Vali Loss: 2.043 Vali Acc: 0.473 Test Loss: 2.043 Test Acc: 0.473
Validation loss decreased (-0.450364 --> -0.473262).  Saving model ...
Epoch: 5 cost time: 11.681109189987183
Epoch: 5, Steps: 32 | Train Loss: 0.123 Vali Loss: 3.570 Vali Acc: 0.481 Test Loss: 3.570 Test Acc: 0.481
Validation loss decreased (-0.473262 --> -0.480880).  Saving model ...
Epoch: 6 cost time: 11.27993893623352
Epoch: 6, Steps: 32 | Train Loss: 0.102 Vali Loss: 4.167 Vali Acc: 0.427 Test Loss: 4.167 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.585809230804443
Epoch: 7, Steps: 32 | Train Loss: 0.207 Vali Loss: 4.620 Vali Acc: 0.420 Test Loss: 4.620 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.278387069702148
Epoch: 8, Steps: 32 | Train Loss: 0.019 Vali Loss: 3.792 Vali Acc: 0.519 Test Loss: 3.792 Test Acc: 0.519
Validation loss decreased (-0.480880 --> -0.519046).  Saving model ...
Epoch: 9 cost time: 11.980761528015137
Epoch: 9, Steps: 32 | Train Loss: 0.054 Vali Loss: 5.009 Vali Acc: 0.496 Test Loss: 5.009 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.531242847442627
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.522 Vali Acc: 0.496 Test Loss: 5.522 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.239886999130249
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.539 Vali Acc: 0.534 Test Loss: 4.539 Test Acc: 0.534
Validation loss decreased (-0.519046 --> -0.534306).  Saving model ...
Epoch: 12 cost time: 11.662229061126709
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.181 Vali Acc: 0.519 Test Loss: 5.181 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.583650588989258
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.125 Vali Acc: 0.511 Test Loss: 5.125 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.80681586265564
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.082 Vali Acc: 0.511 Test Loss: 5.082 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.318756580352783
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.081 Vali Acc: 0.511 Test Loss: 5.081 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.569664716720581
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.077 Vali Acc: 0.511 Test Loss: 5.077 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.655730724334717
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.073 Vali Acc: 0.511 Test Loss: 5.073 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.582145690917969
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.070 Vali Acc: 0.511 Test Loss: 5.070 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.577775239944458
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.076 Vali Acc: 0.511 Test Loss: 5.076 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.382823467254639
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.074 Vali Acc: 0.511 Test Loss: 5.074 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.115662097930908
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.069 Vali Acc: 0.511 Test Loss: 5.069 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2502401
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.362243890762329
Epoch: 1, Steps: 32 | Train Loss: 2.489 Vali Loss: 3.239 Vali Acc: 0.420 Test Loss: 3.239 Test Acc: 0.420
Validation loss decreased (inf --> -0.419815).  Saving model ...
Epoch: 2 cost time: 11.826193809509277
Epoch: 2, Steps: 32 | Train Loss: 3.019 Vali Loss: 3.711 Vali Acc: 0.130 Test Loss: 3.711 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.787925481796265
Epoch: 3, Steps: 32 | Train Loss: 2.725 Vali Loss: 3.040 Vali Acc: 0.221 Test Loss: 3.040 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.621542692184448
Epoch: 4, Steps: 32 | Train Loss: 0.875 Vali Loss: 3.120 Vali Acc: 0.481 Test Loss: 3.120 Test Acc: 0.481
Validation loss decreased (-0.419815 --> -0.480885).  Saving model ...
Epoch: 5 cost time: 12.330213069915771
Epoch: 5, Steps: 32 | Train Loss: 0.197 Vali Loss: 2.855 Vali Acc: 0.481 Test Loss: 2.855 Test Acc: 0.481
Validation loss decreased (-0.480885 --> -0.480887).  Saving model ...
Epoch: 6 cost time: 12.225511312484741
Epoch: 6, Steps: 32 | Train Loss: 0.156 Vali Loss: 4.135 Vali Acc: 0.519 Test Loss: 4.135 Test Acc: 0.519
Validation loss decreased (-0.480887 --> -0.519043).  Saving model ...
Epoch: 7 cost time: 11.81183385848999
Epoch: 7, Steps: 32 | Train Loss: 0.081 Vali Loss: 5.735 Vali Acc: 0.534 Test Loss: 5.735 Test Acc: 0.534
Validation loss decreased (-0.519043 --> -0.534294).  Saving model ...
Epoch: 8 cost time: 12.529632329940796
Epoch: 8, Steps: 32 | Train Loss: 0.087 Vali Loss: 5.498 Vali Acc: 0.412 Test Loss: 5.498 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.331058502197266
Epoch: 9, Steps: 32 | Train Loss: 0.043 Vali Loss: 6.727 Vali Acc: 0.542 Test Loss: 6.727 Test Acc: 0.542
Validation loss decreased (-0.534294 --> -0.541917).  Saving model ...
Epoch: 10 cost time: 12.435868978500366
Epoch: 10, Steps: 32 | Train Loss: 0.083 Vali Loss: 5.248 Vali Acc: 0.519 Test Loss: 5.248 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.307788610458374
Epoch: 11, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.163 Vali Acc: 0.511 Test Loss: 5.163 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.431106805801392
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.057 Vali Acc: 0.458 Test Loss: 5.057 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.416131258010864
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.336 Vali Acc: 0.489 Test Loss: 5.336 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.60801649093628
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.424 Vali Acc: 0.504 Test Loss: 5.424 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.0347261428833
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.403 Vali Acc: 0.504 Test Loss: 5.403 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.043760061264038
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.386 Vali Acc: 0.504 Test Loss: 5.386 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.493729829788208
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.380 Vali Acc: 0.504 Test Loss: 5.380 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.409472942352295
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.373 Vali Acc: 0.496 Test Loss: 5.373 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.341391801834106
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.370 Vali Acc: 0.496 Test Loss: 5.370 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2322433
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.084720849990845
Epoch: 1, Steps: 32 | Train Loss: 2.158 Vali Loss: 2.742 Vali Acc: 0.137 Test Loss: 2.742 Test Acc: 0.137
Validation loss decreased (inf --> -0.137377).  Saving model ...
Epoch: 2 cost time: 12.362637281417847
Epoch: 2, Steps: 32 | Train Loss: 3.567 Vali Loss: 2.299 Vali Acc: 0.214 Test Loss: 2.299 Test Acc: 0.214
Validation loss decreased (-0.137377 --> -0.213717).  Saving model ...
Epoch: 3 cost time: 12.904877185821533
Epoch: 3, Steps: 32 | Train Loss: 3.030 Vali Loss: 3.366 Vali Acc: 0.229 Test Loss: 3.366 Test Acc: 0.229
Validation loss decreased (-0.213717 --> -0.228974).  Saving model ...
Epoch: 4 cost time: 12.665756702423096
Epoch: 4, Steps: 32 | Train Loss: 1.062 Vali Loss: 5.370 Vali Acc: 0.229 Test Loss: 5.370 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.39351773262024
Epoch: 5, Steps: 32 | Train Loss: 0.592 Vali Loss: 2.299 Vali Acc: 0.473 Test Loss: 2.299 Test Acc: 0.473
Validation loss decreased (-0.228974 --> -0.473259).  Saving model ...
Epoch: 6 cost time: 12.912919282913208
Epoch: 6, Steps: 32 | Train Loss: 0.194 Vali Loss: 4.851 Vali Acc: 0.534 Test Loss: 4.851 Test Acc: 0.534
Validation loss decreased (-0.473259 --> -0.534303).  Saving model ...
Epoch: 7 cost time: 12.930213689804077
Epoch: 7, Steps: 32 | Train Loss: 0.187 Vali Loss: 4.964 Vali Acc: 0.481 Test Loss: 4.964 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.446563005447388
Epoch: 8, Steps: 32 | Train Loss: 0.023 Vali Loss: 4.971 Vali Acc: 0.511 Test Loss: 4.971 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.142658710479736
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 4.348 Vali Acc: 0.443 Test Loss: 4.348 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.565345048904419
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.953 Vali Acc: 0.527 Test Loss: 4.953 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.385207176208496
Epoch: 11, Steps: 32 | Train Loss: 0.026 Vali Loss: 4.782 Vali Acc: 0.412 Test Loss: 4.782 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.08834433555603
Epoch: 12, Steps: 32 | Train Loss: 0.059 Vali Loss: 5.028 Vali Acc: 0.420 Test Loss: 5.028 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.019326210021973
Epoch: 13, Steps: 32 | Train Loss: 0.062 Vali Loss: 8.959 Vali Acc: 0.305 Test Loss: 8.959 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.406761169433594
Epoch: 14, Steps: 32 | Train Loss: 0.032 Vali Loss: 4.972 Vali Acc: 0.519 Test Loss: 4.972 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.522528171539307
Epoch: 15, Steps: 32 | Train Loss: 0.266 Vali Loss: 6.564 Vali Acc: 0.466 Test Loss: 6.564 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.048469543457031
Epoch: 16, Steps: 32 | Train Loss: 0.120 Vali Loss: 8.049 Vali Acc: 0.427 Test Loss: 8.049 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2565121
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.515167236328125
Epoch: 1, Steps: 32 | Train Loss: 2.400 Vali Loss: 1.756 Vali Acc: 0.145 Test Loss: 1.756 Test Acc: 0.145
Validation loss decreased (inf --> -0.145021).  Saving model ...
Epoch: 2 cost time: 12.279788494110107
Epoch: 2, Steps: 32 | Train Loss: 2.691 Vali Loss: 3.478 Vali Acc: 0.168 Test Loss: 3.478 Test Acc: 0.168
Validation loss decreased (-0.145021 --> -0.167904).  Saving model ...
Epoch: 3 cost time: 12.680420160293579
Epoch: 3, Steps: 32 | Train Loss: 2.781 Vali Loss: 5.198 Vali Acc: 0.183 Test Loss: 5.198 Test Acc: 0.183
Validation loss decreased (-0.167904 --> -0.183154).  Saving model ...
Epoch: 4 cost time: 12.760146617889404
Epoch: 4, Steps: 32 | Train Loss: 2.318 Vali Loss: 5.136 Vali Acc: 0.481 Test Loss: 5.136 Test Acc: 0.481
Validation loss decreased (-0.183154 --> -0.480865).  Saving model ...
Epoch: 5 cost time: 12.628939151763916
Epoch: 5, Steps: 32 | Train Loss: 0.655 Vali Loss: 3.934 Vali Acc: 0.511 Test Loss: 3.934 Test Acc: 0.511
Validation loss decreased (-0.480865 --> -0.511411).  Saving model ...
Epoch: 6 cost time: 12.437208652496338
Epoch: 6, Steps: 32 | Train Loss: 0.376 Vali Loss: 3.991 Vali Acc: 0.382 Test Loss: 3.991 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.928186893463135
Epoch: 7, Steps: 32 | Train Loss: 0.052 Vali Loss: 4.312 Vali Acc: 0.450 Test Loss: 4.312 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.586416244506836
Epoch: 8, Steps: 32 | Train Loss: 0.065 Vali Loss: 4.682 Vali Acc: 0.443 Test Loss: 4.682 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.126001596450806
Epoch: 9, Steps: 32 | Train Loss: 0.017 Vali Loss: 5.619 Vali Acc: 0.458 Test Loss: 5.619 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.914703607559204
Epoch: 10, Steps: 32 | Train Loss: 0.104 Vali Loss: 5.216 Vali Acc: 0.443 Test Loss: 5.216 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.93047308921814
Epoch: 11, Steps: 32 | Train Loss: 0.035 Vali Loss: 6.562 Vali Acc: 0.489 Test Loss: 6.562 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.871472597122192
Epoch: 12, Steps: 32 | Train Loss: 0.002 Vali Loss: 6.350 Vali Acc: 0.427 Test Loss: 6.350 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.175315856933594
Epoch: 13, Steps: 32 | Train Loss: 0.127 Vali Loss: 7.498 Vali Acc: 0.504 Test Loss: 7.498 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.380984544754028
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 8.223 Vali Acc: 0.511 Test Loss: 8.223 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.767930030822754
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.668 Vali Acc: 0.458 Test Loss: 7.668 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2385153
model size : 13.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.603524923324585
Epoch: 1, Steps: 32 | Train Loss: 2.091 Vali Loss: 3.655 Vali Acc: 0.168 Test Loss: 3.655 Test Acc: 0.168
Validation loss decreased (inf --> -0.167902).  Saving model ...
Epoch: 2 cost time: 12.3302161693573
Epoch: 2, Steps: 32 | Train Loss: 2.968 Vali Loss: 3.022 Vali Acc: 0.168 Test Loss: 3.022 Test Acc: 0.168
Validation loss decreased (-0.167902 --> -0.167909).  Saving model ...
Epoch: 3 cost time: 12.55034589767456
Epoch: 3, Steps: 32 | Train Loss: 2.044 Vali Loss: 1.910 Vali Acc: 0.496 Test Loss: 1.910 Test Acc: 0.496
Validation loss decreased (-0.167909 --> -0.496164).  Saving model ...
Epoch: 4 cost time: 12.49110221862793
Epoch: 4, Steps: 32 | Train Loss: 1.448 Vali Loss: 4.219 Vali Acc: 0.489 Test Loss: 4.219 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.081341743469238
Epoch: 5, Steps: 32 | Train Loss: 0.427 Vali Loss: 4.913 Vali Acc: 0.496 Test Loss: 4.913 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.838130950927734
Epoch: 6, Steps: 32 | Train Loss: 0.042 Vali Loss: 4.480 Vali Acc: 0.489 Test Loss: 4.480 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.233692169189453
Epoch: 7, Steps: 32 | Train Loss: 0.076 Vali Loss: 4.674 Vali Acc: 0.519 Test Loss: 4.674 Test Acc: 0.519
Validation loss decreased (-0.496164 --> -0.519037).  Saving model ...
Epoch: 8 cost time: 12.81973671913147
Epoch: 8, Steps: 32 | Train Loss: 0.025 Vali Loss: 6.190 Vali Acc: 0.496 Test Loss: 6.190 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.693167448043823
Epoch: 9, Steps: 32 | Train Loss: 0.121 Vali Loss: 6.492 Vali Acc: 0.527 Test Loss: 6.492 Test Acc: 0.527
Validation loss decreased (-0.519037 --> -0.526653).  Saving model ...
Epoch: 10 cost time: 12.707267761230469
Epoch: 10, Steps: 32 | Train Loss: 0.097 Vali Loss: 6.334 Vali Acc: 0.420 Test Loss: 6.334 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.959174394607544
Epoch: 11, Steps: 32 | Train Loss: 0.020 Vali Loss: 5.775 Vali Acc: 0.473 Test Loss: 5.775 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.084792375564575
Epoch: 12, Steps: 32 | Train Loss: 0.158 Vali Loss: 6.001 Vali Acc: 0.504 Test Loss: 6.001 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.333654403686523
Epoch: 13, Steps: 32 | Train Loss: 0.001 Vali Loss: 6.141 Vali Acc: 0.466 Test Loss: 6.141 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.002203702926636
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 7.092 Vali Acc: 0.527 Test Loss: 7.092 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.582104921340942
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.506 Vali Acc: 0.489 Test Loss: 6.506 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.516944169998169
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.498 Vali Acc: 0.489 Test Loss: 6.498 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.423988342285156
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.532 Vali Acc: 0.504 Test Loss: 6.532 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.396490573883057
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.532 Vali Acc: 0.504 Test Loss: 6.532 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.55932092666626
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.531 Vali Acc: 0.504 Test Loss: 6.531 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2205185
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.7641761302948
Epoch: 1, Steps: 32 | Train Loss: 2.426 Vali Loss: 2.941 Vali Acc: 0.420 Test Loss: 2.941 Test Acc: 0.420
Validation loss decreased (inf --> -0.419818).  Saving model ...
Epoch: 2 cost time: 12.125859260559082
Epoch: 2, Steps: 32 | Train Loss: 2.831 Vali Loss: 4.068 Vali Acc: 0.420 Test Loss: 4.068 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.01716923713684
Epoch: 3, Steps: 32 | Train Loss: 2.986 Vali Loss: 2.930 Vali Acc: 0.176 Test Loss: 2.930 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.093737840652466
Epoch: 4, Steps: 32 | Train Loss: 1.439 Vali Loss: 4.899 Vali Acc: 0.481 Test Loss: 4.899 Test Acc: 0.481
Validation loss decreased (-0.419818 --> -0.480867).  Saving model ...
Epoch: 5 cost time: 11.842730283737183
Epoch: 5, Steps: 32 | Train Loss: 0.989 Vali Loss: 5.340 Vali Acc: 0.519 Test Loss: 5.340 Test Acc: 0.519
Validation loss decreased (-0.480867 --> -0.519031).  Saving model ...
Epoch: 6 cost time: 11.679276704788208
Epoch: 6, Steps: 32 | Train Loss: 1.235 Vali Loss: 3.627 Vali Acc: 0.511 Test Loss: 3.627 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.312647104263306
Epoch: 7, Steps: 32 | Train Loss: 0.135 Vali Loss: 4.729 Vali Acc: 0.550 Test Loss: 4.729 Test Acc: 0.550
Validation loss decreased (-0.519031 --> -0.549571).  Saving model ...
Epoch: 8 cost time: 12.181781768798828
Epoch: 8, Steps: 32 | Train Loss: 0.091 Vali Loss: 5.824 Vali Acc: 0.519 Test Loss: 5.824 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.952266693115234
Epoch: 9, Steps: 32 | Train Loss: 0.014 Vali Loss: 6.040 Vali Acc: 0.542 Test Loss: 6.040 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.06515622138977
Epoch: 10, Steps: 32 | Train Loss: 0.027 Vali Loss: 4.706 Vali Acc: 0.481 Test Loss: 4.706 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.943653583526611
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.350 Vali Acc: 0.534 Test Loss: 6.350 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.153388500213623
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.273 Vali Acc: 0.534 Test Loss: 6.273 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.061427116394043
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.263 Vali Acc: 0.534 Test Loss: 6.263 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.477490663528442
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.246 Vali Acc: 0.534 Test Loss: 6.246 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.36118459701538
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.235 Vali Acc: 0.534 Test Loss: 6.235 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.609430313110352
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.215 Vali Acc: 0.534 Test Loss: 6.215 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.116397142410278
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.208 Vali Acc: 0.534 Test Loss: 6.208 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2025217
model size : 12.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.167059659957886
Epoch: 1, Steps: 32 | Train Loss: 1.898 Vali Loss: 1.878 Vali Acc: 0.298 Test Loss: 1.878 Test Acc: 0.298
Validation loss decreased (inf --> -0.297691).  Saving model ...
Epoch: 2 cost time: 12.155018329620361
Epoch: 2, Steps: 32 | Train Loss: 2.123 Vali Loss: 3.330 Vali Acc: 0.458 Test Loss: 3.330 Test Acc: 0.458
Validation loss decreased (-0.297691 --> -0.457982).  Saving model ...
Epoch: 3 cost time: 12.05138373374939
Epoch: 3, Steps: 32 | Train Loss: 2.499 Vali Loss: 3.863 Vali Acc: 0.496 Test Loss: 3.863 Test Acc: 0.496
Validation loss decreased (-0.457982 --> -0.496145).  Saving model ...
Epoch: 4 cost time: 12.460906744003296
Epoch: 4, Steps: 32 | Train Loss: 1.532 Vali Loss: 4.574 Vali Acc: 0.481 Test Loss: 4.574 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.661096572875977
Epoch: 5, Steps: 32 | Train Loss: 0.786 Vali Loss: 4.785 Vali Acc: 0.504 Test Loss: 4.785 Test Acc: 0.504
Validation loss decreased (-0.496145 --> -0.503769).  Saving model ...
Epoch: 6 cost time: 11.831024646759033
Epoch: 6, Steps: 32 | Train Loss: 0.160 Vali Loss: 3.901 Vali Acc: 0.519 Test Loss: 3.901 Test Acc: 0.519
Validation loss decreased (-0.503769 --> -0.519045).  Saving model ...
Epoch: 7 cost time: 13.226932525634766
Epoch: 7, Steps: 32 | Train Loss: 0.335 Vali Loss: 4.552 Vali Acc: 0.511 Test Loss: 4.552 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.25135064125061
Epoch: 8, Steps: 32 | Train Loss: 0.024 Vali Loss: 4.108 Vali Acc: 0.519 Test Loss: 4.108 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.772216558456421
Epoch: 9, Steps: 32 | Train Loss: 0.003 Vali Loss: 4.650 Vali Acc: 0.496 Test Loss: 4.650 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.062194585800171
Epoch: 10, Steps: 32 | Train Loss: 0.023 Vali Loss: 4.856 Vali Acc: 0.519 Test Loss: 4.856 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.734042644500732
Epoch: 11, Steps: 32 | Train Loss: 0.243 Vali Loss: 7.156 Vali Acc: 0.397 Test Loss: 7.156 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.028507947921753
Epoch: 12, Steps: 32 | Train Loss: 0.011 Vali Loss: 5.469 Vali Acc: 0.542 Test Loss: 5.469 Test Acc: 0.542
Validation loss decreased (-0.519045 --> -0.541930).  Saving model ...
Epoch: 13 cost time: 11.980619668960571
Epoch: 13, Steps: 32 | Train Loss: 0.002 Vali Loss: 5.454 Vali Acc: 0.519 Test Loss: 5.454 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.096004962921143
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.123 Vali Acc: 0.519 Test Loss: 5.123 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.080688953399658
Epoch: 15, Steps: 32 | Train Loss: 0.048 Vali Loss: 6.511 Vali Acc: 0.504 Test Loss: 6.511 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.335718870162964
Epoch: 16, Steps: 32 | Train Loss: 0.015 Vali Loss: 8.530 Vali Acc: 0.405 Test Loss: 8.530 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.344099998474121
Epoch: 17, Steps: 32 | Train Loss: 0.002 Vali Loss: 5.947 Vali Acc: 0.519 Test Loss: 5.947 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.624364614486694
Epoch: 18, Steps: 32 | Train Loss: 0.038 Vali Loss: 7.633 Vali Acc: 0.435 Test Loss: 7.633 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.29051423072815
Epoch: 19, Steps: 32 | Train Loss: 0.003 Vali Loss: 7.005 Vali Acc: 0.542 Test Loss: 7.005 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.026142358779907
Epoch: 20, Steps: 32 | Train Loss: 0.001 Vali Loss: 6.207 Vali Acc: 0.504 Test Loss: 6.207 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.865309000015259
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.228 Vali Acc: 0.534 Test Loss: 6.228 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.98462438583374
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.287 Vali Acc: 0.534 Test Loss: 6.287 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2416513
model size : 13.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.698934316635132
Epoch: 1, Steps: 32 | Train Loss: 2.204 Vali Loss: 3.138 Vali Acc: 0.420 Test Loss: 3.138 Test Acc: 0.420
Validation loss decreased (inf --> -0.419816).  Saving model ...
Epoch: 2 cost time: 12.267745018005371
Epoch: 2, Steps: 32 | Train Loss: 2.954 Vali Loss: 2.476 Vali Acc: 0.389 Test Loss: 2.476 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.853013277053833
Epoch: 3, Steps: 32 | Train Loss: 2.558 Vali Loss: 4.303 Vali Acc: 0.450 Test Loss: 4.303 Test Acc: 0.450
Validation loss decreased (-0.419816 --> -0.450339).  Saving model ...
Epoch: 4 cost time: 11.972909927368164
Epoch: 4, Steps: 32 | Train Loss: 2.410 Vali Loss: 3.322 Vali Acc: 0.489 Test Loss: 3.322 Test Acc: 0.489
Validation loss decreased (-0.450339 --> -0.488516).  Saving model ...
Epoch: 5 cost time: 11.770494222640991
Epoch: 5, Steps: 32 | Train Loss: 1.191 Vali Loss: 3.458 Vali Acc: 0.336 Test Loss: 3.458 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.452468156814575
Epoch: 6, Steps: 32 | Train Loss: 0.900 Vali Loss: 5.400 Vali Acc: 0.519 Test Loss: 5.400 Test Acc: 0.519
Validation loss decreased (-0.488516 --> -0.519030).  Saving model ...
Epoch: 7 cost time: 12.569608211517334
Epoch: 7, Steps: 32 | Train Loss: 0.184 Vali Loss: 4.565 Vali Acc: 0.389 Test Loss: 4.565 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.692133903503418
Epoch: 8, Steps: 32 | Train Loss: 0.006 Vali Loss: 4.098 Vali Acc: 0.458 Test Loss: 4.098 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.18399453163147
Epoch: 9, Steps: 32 | Train Loss: 0.065 Vali Loss: 5.239 Vali Acc: 0.458 Test Loss: 5.239 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.06113052368164
Epoch: 10, Steps: 32 | Train Loss: 0.111 Vali Loss: 5.880 Vali Acc: 0.519 Test Loss: 5.880 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.638783931732178
Epoch: 11, Steps: 32 | Train Loss: 0.084 Vali Loss: 4.763 Vali Acc: 0.511 Test Loss: 4.763 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.952093362808228
Epoch: 12, Steps: 32 | Train Loss: 0.026 Vali Loss: 7.275 Vali Acc: 0.359 Test Loss: 7.275 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.268969535827637
Epoch: 13, Steps: 32 | Train Loss: 0.179 Vali Loss: 5.524 Vali Acc: 0.527 Test Loss: 5.524 Test Acc: 0.527
Validation loss decreased (-0.519030 --> -0.526662).  Saving model ...
Epoch: 14 cost time: 11.872581958770752
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 7.363 Vali Acc: 0.489 Test Loss: 7.363 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.532219648361206
Epoch: 15, Steps: 32 | Train Loss: 0.025 Vali Loss: 5.456 Vali Acc: 0.511 Test Loss: 5.456 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.81863260269165
Epoch: 16, Steps: 32 | Train Loss: 0.111 Vali Loss: 6.910 Vali Acc: 0.504 Test Loss: 6.910 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.79782748222351
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.190 Vali Acc: 0.511 Test Loss: 6.190 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.198510646820068
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.652 Vali Acc: 0.504 Test Loss: 6.652 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.205127000808716
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.006 Vali Acc: 0.496 Test Loss: 7.006 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.323827266693115
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.989 Vali Acc: 0.496 Test Loss: 6.989 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.560082912445068
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.978 Vali Acc: 0.496 Test Loss: 6.978 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.594046115875244
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.963 Vali Acc: 0.496 Test Loss: 6.963 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.038069725036621
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.959 Vali Acc: 0.496 Test Loss: 6.959 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2236545
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.982269287109375
Epoch: 1, Steps: 32 | Train Loss: 3.034 Vali Loss: 3.259 Vali Acc: 0.443 Test Loss: 3.259 Test Acc: 0.443
Validation loss decreased (inf --> -0.442715).  Saving model ...
Epoch: 2 cost time: 12.557531833648682
Epoch: 2, Steps: 32 | Train Loss: 3.444 Vali Loss: 3.372 Vali Acc: 0.443 Test Loss: 3.372 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.54869294166565
Epoch: 3, Steps: 32 | Train Loss: 2.774 Vali Loss: 3.183 Vali Acc: 0.489 Test Loss: 3.183 Test Acc: 0.489
Validation loss decreased (-0.442715 --> -0.488518).  Saving model ...
Epoch: 4 cost time: 12.881865501403809
Epoch: 4, Steps: 32 | Train Loss: 1.430 Vali Loss: 5.021 Vali Acc: 0.481 Test Loss: 5.021 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.152753114700317
Epoch: 5, Steps: 32 | Train Loss: 0.738 Vali Loss: 3.267 Vali Acc: 0.389 Test Loss: 3.267 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.996680736541748
Epoch: 6, Steps: 32 | Train Loss: 0.259 Vali Loss: 5.780 Vali Acc: 0.473 Test Loss: 5.780 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.460675954818726
Epoch: 7, Steps: 32 | Train Loss: 0.129 Vali Loss: 4.048 Vali Acc: 0.328 Test Loss: 4.048 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.69442868232727
Epoch: 8, Steps: 32 | Train Loss: 0.137 Vali Loss: 5.767 Vali Acc: 0.511 Test Loss: 5.767 Test Acc: 0.511
Validation loss decreased (-0.488518 --> -0.511393).  Saving model ...
Epoch: 9 cost time: 11.904509544372559
Epoch: 9, Steps: 32 | Train Loss: 0.107 Vali Loss: 6.290 Vali Acc: 0.481 Test Loss: 6.290 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.476274490356445
Epoch: 10, Steps: 32 | Train Loss: 0.035 Vali Loss: 4.781 Vali Acc: 0.420 Test Loss: 4.781 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.478699684143066
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 5.880 Vali Acc: 0.420 Test Loss: 5.880 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.203214883804321
Epoch: 12, Steps: 32 | Train Loss: 0.090 Vali Loss: 6.110 Vali Acc: 0.466 Test Loss: 6.110 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.048161745071411
Epoch: 13, Steps: 32 | Train Loss: 0.030 Vali Loss: 6.429 Vali Acc: 0.466 Test Loss: 6.429 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.040579557418823
Epoch: 14, Steps: 32 | Train Loss: 0.005 Vali Loss: 6.718 Vali Acc: 0.382 Test Loss: 6.718 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.881749629974365
Epoch: 15, Steps: 32 | Train Loss: 0.059 Vali Loss: 6.515 Vali Acc: 0.427 Test Loss: 6.515 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.72453761100769
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 8.075 Vali Acc: 0.473 Test Loss: 8.075 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.128445386886597
Epoch: 17, Steps: 32 | Train Loss: 0.044 Vali Loss: 10.049 Vali Acc: 0.359 Test Loss: 10.049 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.87007188796997
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.622 Vali Acc: 0.458 Test Loss: 7.622 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2056577
model size : 12.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.5241379737854
Epoch: 1, Steps: 32 | Train Loss: 2.592 Vali Loss: 3.820 Vali Acc: 0.137 Test Loss: 3.820 Test Acc: 0.137
Validation loss decreased (inf --> -0.137366).  Saving model ...
Epoch: 2 cost time: 11.654433965682983
Epoch: 2, Steps: 32 | Train Loss: 3.401 Vali Loss: 2.662 Vali Acc: 0.435 Test Loss: 2.662 Test Acc: 0.435
Validation loss decreased (-0.137366 --> -0.435088).  Saving model ...
Epoch: 3 cost time: 11.511413097381592
Epoch: 3, Steps: 32 | Train Loss: 3.419 Vali Loss: 3.395 Vali Acc: 0.405 Test Loss: 3.395 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.277323246002197
Epoch: 4, Steps: 32 | Train Loss: 1.616 Vali Loss: 4.072 Vali Acc: 0.504 Test Loss: 4.072 Test Acc: 0.504
Validation loss decreased (-0.435088 --> -0.503776).  Saving model ...
Epoch: 5 cost time: 10.94129753112793
Epoch: 5, Steps: 32 | Train Loss: 0.958 Vali Loss: 5.754 Vali Acc: 0.473 Test Loss: 5.754 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.25242304801941
Epoch: 6, Steps: 32 | Train Loss: 0.267 Vali Loss: 3.663 Vali Acc: 0.466 Test Loss: 3.663 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.700701475143433
Epoch: 7, Steps: 32 | Train Loss: 0.134 Vali Loss: 4.295 Vali Acc: 0.435 Test Loss: 4.295 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.781885385513306
Epoch: 8, Steps: 32 | Train Loss: 0.078 Vali Loss: 6.238 Vali Acc: 0.374 Test Loss: 6.238 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.706888437271118
Epoch: 9, Steps: 32 | Train Loss: 0.174 Vali Loss: 5.155 Vali Acc: 0.427 Test Loss: 5.155 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.225659847259521
Epoch: 10, Steps: 32 | Train Loss: 0.018 Vali Loss: 5.128 Vali Acc: 0.481 Test Loss: 5.128 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.641054153442383
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.897 Vali Acc: 0.489 Test Loss: 4.897 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.726754426956177
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.886 Vali Acc: 0.489 Test Loss: 4.886 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.018877744674683
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.930 Vali Acc: 0.473 Test Loss: 4.930 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.962206363677979
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.926 Vali Acc: 0.481 Test Loss: 4.926 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 1876609
model size : 11.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.009826183319092
Epoch: 1, Steps: 32 | Train Loss: 1.895 Vali Loss: 1.743 Vali Acc: 0.420 Test Loss: 1.743 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 12.367196559906006
Epoch: 2, Steps: 32 | Train Loss: 1.984 Vali Loss: 2.174 Vali Acc: 0.435 Test Loss: 2.174 Test Acc: 0.435
Validation loss decreased (-0.419830 --> -0.435093).  Saving model ...
Epoch: 3 cost time: 11.168542861938477
Epoch: 3, Steps: 32 | Train Loss: 1.742 Vali Loss: 1.773 Vali Acc: 0.275 Test Loss: 1.773 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.111701011657715
Epoch: 4, Steps: 32 | Train Loss: 1.080 Vali Loss: 2.256 Vali Acc: 0.382 Test Loss: 2.256 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.42732286453247
Epoch: 5, Steps: 32 | Train Loss: 0.249 Vali Loss: 5.086 Vali Acc: 0.221 Test Loss: 5.086 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.828055143356323
Epoch: 6, Steps: 32 | Train Loss: 0.317 Vali Loss: 3.097 Vali Acc: 0.542 Test Loss: 3.097 Test Acc: 0.542
Validation loss decreased (-0.435093 --> -0.541954).  Saving model ...
Epoch: 7 cost time: 11.954209804534912
Epoch: 7, Steps: 32 | Train Loss: 0.032 Vali Loss: 2.844 Vali Acc: 0.435 Test Loss: 2.844 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.919205665588379
Epoch: 8, Steps: 32 | Train Loss: 0.016 Vali Loss: 3.367 Vali Acc: 0.504 Test Loss: 3.367 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.776471853256226
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.069 Vali Acc: 0.458 Test Loss: 3.069 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.853894233703613
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.176 Vali Acc: 0.405 Test Loss: 3.176 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.022576570510864
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.420 Test Loss: 3.166 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.94320559501648
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.154 Vali Acc: 0.435 Test Loss: 3.154 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.953508138656616
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.164 Vali Acc: 0.435 Test Loss: 3.164 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.752238988876343
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.435 Test Loss: 3.170 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.850531339645386
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.169 Vali Acc: 0.443 Test Loss: 3.169 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.398919343948364
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.443 Test Loss: 3.189 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1585569
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.765469312667847
Epoch: 1, Steps: 32 | Train Loss: 2.018 Vali Loss: 2.822 Vali Acc: 0.137 Test Loss: 2.822 Test Acc: 0.137
Validation loss decreased (inf --> -0.137376).  Saving model ...
Epoch: 2 cost time: 11.609375715255737
Epoch: 2, Steps: 32 | Train Loss: 1.921 Vali Loss: 2.742 Vali Acc: 0.420 Test Loss: 2.742 Test Acc: 0.420
Validation loss decreased (-0.137376 --> -0.419820).  Saving model ...
Epoch: 3 cost time: 11.856747150421143
Epoch: 3, Steps: 32 | Train Loss: 1.727 Vali Loss: 1.919 Vali Acc: 0.473 Test Loss: 1.919 Test Acc: 0.473
Validation loss decreased (-0.419820 --> -0.473263).  Saving model ...
Epoch: 4 cost time: 11.970001697540283
Epoch: 4, Steps: 32 | Train Loss: 0.844 Vali Loss: 2.981 Vali Acc: 0.275 Test Loss: 2.981 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.675976514816284
Epoch: 5, Steps: 32 | Train Loss: 0.212 Vali Loss: 3.019 Vali Acc: 0.298 Test Loss: 3.019 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.129319906234741
Epoch: 6, Steps: 32 | Train Loss: 0.076 Vali Loss: 3.198 Vali Acc: 0.450 Test Loss: 3.198 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.056439876556396
Epoch: 7, Steps: 32 | Train Loss: 0.036 Vali Loss: 2.575 Vali Acc: 0.466 Test Loss: 2.575 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.464592695236206
Epoch: 8, Steps: 32 | Train Loss: 0.005 Vali Loss: 2.731 Vali Acc: 0.489 Test Loss: 2.731 Test Acc: 0.489
Validation loss decreased (-0.473263 --> -0.488522).  Saving model ...
Epoch: 9 cost time: 11.376655578613281
Epoch: 9, Steps: 32 | Train Loss: 0.006 Vali Loss: 3.042 Vali Acc: 0.489 Test Loss: 3.042 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.622476577758789
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.872 Vali Acc: 0.511 Test Loss: 3.872 Test Acc: 0.511
Validation loss decreased (-0.488522 --> -0.511412).  Saving model ...
Epoch: 11 cost time: 12.310110092163086
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.519 Vali Acc: 0.511 Test Loss: 3.519 Test Acc: 0.511
Validation loss decreased (-0.511412 --> -0.511415).  Saving model ...
Epoch: 12 cost time: 12.542361497879028
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.522 Vali Acc: 0.496 Test Loss: 3.522 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.869511365890503
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.555 Vali Acc: 0.496 Test Loss: 3.555 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.573538541793823
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.553 Vali Acc: 0.496 Test Loss: 3.553 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.79493260383606
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.560 Vali Acc: 0.496 Test Loss: 3.560 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.108935832977295
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.550 Vali Acc: 0.489 Test Loss: 3.550 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.512436628341675
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.570 Vali Acc: 0.489 Test Loss: 3.570 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.161018133163452
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.496 Test Loss: 3.581 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.850186109542847
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.582 Vali Acc: 0.496 Test Loss: 3.582 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.524476766586304
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.578 Vali Acc: 0.489 Test Loss: 3.578 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.918245077133179
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.578 Vali Acc: 0.504 Test Loss: 3.578 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1495585
model size : 8.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.094369411468506
Epoch: 1, Steps: 32 | Train Loss: 1.961 Vali Loss: 3.170 Vali Acc: 0.168 Test Loss: 3.170 Test Acc: 0.168
Validation loss decreased (inf --> -0.167907).  Saving model ...
Epoch: 2 cost time: 12.049671411514282
Epoch: 2, Steps: 32 | Train Loss: 2.267 Vali Loss: 1.991 Vali Acc: 0.420 Test Loss: 1.991 Test Acc: 0.420
Validation loss decreased (-0.167907 --> -0.419827).  Saving model ...
Epoch: 3 cost time: 12.481425046920776
Epoch: 3, Steps: 32 | Train Loss: 1.606 Vali Loss: 1.450 Vali Acc: 0.534 Test Loss: 1.450 Test Acc: 0.534
Validation loss decreased (-0.419827 --> -0.534337).  Saving model ...
Epoch: 4 cost time: 11.805227756500244
Epoch: 4, Steps: 32 | Train Loss: 0.870 Vali Loss: 3.128 Vali Acc: 0.489 Test Loss: 3.128 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.988885879516602
Epoch: 5, Steps: 32 | Train Loss: 0.184 Vali Loss: 2.303 Vali Acc: 0.496 Test Loss: 2.303 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.684277057647705
Epoch: 6, Steps: 32 | Train Loss: 0.087 Vali Loss: 3.073 Vali Acc: 0.527 Test Loss: 3.073 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.486930847167969
Epoch: 7, Steps: 32 | Train Loss: 0.039 Vali Loss: 2.514 Vali Acc: 0.534 Test Loss: 2.514 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.665209770202637
Epoch: 8, Steps: 32 | Train Loss: 0.004 Vali Loss: 3.060 Vali Acc: 0.504 Test Loss: 3.060 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.16813588142395
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.337 Vali Acc: 0.511 Test Loss: 3.337 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.13766860961914
Epoch: 10, Steps: 32 | Train Loss: 0.002 Vali Loss: 3.258 Vali Acc: 0.504 Test Loss: 3.258 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.044435739517212
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.352 Vali Acc: 0.511 Test Loss: 3.352 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.349740982055664
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.262 Vali Acc: 0.504 Test Loss: 3.262 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.886427640914917
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.504 Test Loss: 3.293 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1405601
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.991803169250488
Epoch: 1, Steps: 32 | Train Loss: 1.835 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 11.22457218170166
Epoch: 2, Steps: 32 | Train Loss: 2.139 Vali Loss: 2.399 Vali Acc: 0.176 Test Loss: 2.399 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.241097688674927
Epoch: 3, Steps: 32 | Train Loss: 1.866 Vali Loss: 2.514 Vali Acc: 0.420 Test Loss: 2.514 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.57075810432434
Epoch: 4, Steps: 32 | Train Loss: 2.107 Vali Loss: 2.034 Vali Acc: 0.298 Test Loss: 2.034 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.64076566696167
Epoch: 5, Steps: 32 | Train Loss: 1.090 Vali Loss: 2.306 Vali Acc: 0.351 Test Loss: 2.306 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.292343854904175
Epoch: 6, Steps: 32 | Train Loss: 0.365 Vali Loss: 3.414 Vali Acc: 0.275 Test Loss: 3.414 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.520203828811646
Epoch: 7, Steps: 32 | Train Loss: 0.032 Vali Loss: 3.075 Vali Acc: 0.481 Test Loss: 3.075 Test Acc: 0.481
Validation loss decreased (-0.419830 --> -0.480885).  Saving model ...
Epoch: 8 cost time: 12.0836341381073
Epoch: 8, Steps: 32 | Train Loss: 0.086 Vali Loss: 3.626 Vali Acc: 0.382 Test Loss: 3.626 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.397444725036621
Epoch: 9, Steps: 32 | Train Loss: 0.025 Vali Loss: 3.100 Vali Acc: 0.458 Test Loss: 3.100 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.31169581413269
Epoch: 10, Steps: 32 | Train Loss: 0.034 Vali Loss: 3.365 Vali Acc: 0.489 Test Loss: 3.365 Test Acc: 0.489
Validation loss decreased (-0.480885 --> -0.488516).  Saving model ...
Epoch: 11 cost time: 11.851608991622925
Epoch: 11, Steps: 32 | Train Loss: 0.011 Vali Loss: 3.686 Vali Acc: 0.420 Test Loss: 3.686 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.556366682052612
Epoch: 12, Steps: 32 | Train Loss: 0.001 Vali Loss: 4.238 Vali Acc: 0.511 Test Loss: 4.238 Test Acc: 0.511
Validation loss decreased (-0.488516 --> -0.511408).  Saving model ...
Epoch: 13 cost time: 11.907866477966309
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.980 Vali Acc: 0.489 Test Loss: 3.980 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.01443862915039
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.926 Vali Acc: 0.496 Test Loss: 3.926 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.833778142929077
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.903 Vali Acc: 0.489 Test Loss: 3.903 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.378490447998047
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.892 Vali Acc: 0.489 Test Loss: 3.892 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.958113431930542
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.884 Vali Acc: 0.489 Test Loss: 3.884 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.3531014919281
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.877 Vali Acc: 0.489 Test Loss: 3.877 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.800312280654907
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.863 Vali Acc: 0.489 Test Loss: 3.863 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.418641328811646
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.489 Test Loss: 3.854 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.396231412887573
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.850 Vali Acc: 0.489 Test Loss: 3.850 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.986970663070679
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.845 Vali Acc: 0.489 Test Loss: 3.845 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1315617
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.919764757156372
Epoch: 1, Steps: 32 | Train Loss: 1.988 Vali Loss: 1.809 Vali Acc: 0.191 Test Loss: 1.809 Test Acc: 0.191
Validation loss decreased (inf --> -0.190822).  Saving model ...
Epoch: 2 cost time: 11.541538000106812
Epoch: 2, Steps: 32 | Train Loss: 2.177 Vali Loss: 2.598 Vali Acc: 0.176 Test Loss: 2.598 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.774497509002686
Epoch: 3, Steps: 32 | Train Loss: 2.798 Vali Loss: 2.451 Vali Acc: 0.489 Test Loss: 2.451 Test Acc: 0.489
Validation loss decreased (-0.190822 --> -0.488525).  Saving model ...
Epoch: 4 cost time: 11.914471864700317
Epoch: 4, Steps: 32 | Train Loss: 1.511 Vali Loss: 1.695 Vali Acc: 0.351 Test Loss: 1.695 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.130756378173828
Epoch: 5, Steps: 32 | Train Loss: 0.831 Vali Loss: 3.310 Vali Acc: 0.427 Test Loss: 3.310 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.288071393966675
Epoch: 6, Steps: 32 | Train Loss: 0.319 Vali Loss: 3.288 Vali Acc: 0.527 Test Loss: 3.288 Test Acc: 0.527
Validation loss decreased (-0.488525 --> -0.526685).  Saving model ...
Epoch: 7 cost time: 11.639997959136963
Epoch: 7, Steps: 32 | Train Loss: 0.093 Vali Loss: 3.156 Vali Acc: 0.382 Test Loss: 3.156 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.486567974090576
Epoch: 8, Steps: 32 | Train Loss: 0.083 Vali Loss: 3.188 Vali Acc: 0.466 Test Loss: 3.188 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.193142175674438
Epoch: 9, Steps: 32 | Train Loss: 0.015 Vali Loss: 3.217 Vali Acc: 0.443 Test Loss: 3.217 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.380388498306274
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.386 Vali Acc: 0.481 Test Loss: 3.386 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.24441909790039
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 3.541 Vali Acc: 0.435 Test Loss: 3.541 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.80451226234436
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.942 Vali Acc: 0.389 Test Loss: 3.942 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.844820261001587
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.620 Vali Acc: 0.435 Test Loss: 3.620 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.098389625549316
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.516 Vali Acc: 0.450 Test Loss: 3.516 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.148637056350708
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.506 Vali Acc: 0.450 Test Loss: 3.506 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.391996622085571
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.500 Vali Acc: 0.450 Test Loss: 3.500 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1286049
model size : 7.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.693163394927979
Epoch: 1, Steps: 32 | Train Loss: 1.973 Vali Loss: 2.381 Vali Acc: 0.420 Test Loss: 2.381 Test Acc: 0.420
Validation loss decreased (inf --> -0.419824).  Saving model ...
Epoch: 2 cost time: 11.697284698486328
Epoch: 2, Steps: 32 | Train Loss: 2.351 Vali Loss: 2.328 Vali Acc: 0.420 Test Loss: 2.328 Test Acc: 0.420
Validation loss decreased (-0.419824 --> -0.419824).  Saving model ...
Epoch: 3 cost time: 11.593316555023193
Epoch: 3, Steps: 32 | Train Loss: 2.483 Vali Loss: 1.943 Vali Acc: 0.420 Test Loss: 1.943 Test Acc: 0.420
Validation loss decreased (-0.419824 --> -0.419828).  Saving model ...
Epoch: 4 cost time: 11.350590229034424
Epoch: 4, Steps: 32 | Train Loss: 1.432 Vali Loss: 2.012 Vali Acc: 0.267 Test Loss: 2.012 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.109324216842651
Epoch: 5, Steps: 32 | Train Loss: 0.650 Vali Loss: 1.913 Vali Acc: 0.473 Test Loss: 1.913 Test Acc: 0.473
Validation loss decreased (-0.419828 --> -0.473263).  Saving model ...
Epoch: 6 cost time: 11.27478837966919
Epoch: 6, Steps: 32 | Train Loss: 0.195 Vali Loss: 2.421 Vali Acc: 0.504 Test Loss: 2.421 Test Acc: 0.504
Validation loss decreased (-0.473263 --> -0.503793).  Saving model ...
Epoch: 7 cost time: 11.470849990844727
Epoch: 7, Steps: 32 | Train Loss: 0.031 Vali Loss: 3.293 Vali Acc: 0.382 Test Loss: 3.293 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.901510953903198
Epoch: 8, Steps: 32 | Train Loss: 0.009 Vali Loss: 2.890 Vali Acc: 0.534 Test Loss: 2.890 Test Acc: 0.534
Validation loss decreased (-0.503793 --> -0.534322).  Saving model ...
Epoch: 9 cost time: 10.951767206192017
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.261 Vali Acc: 0.496 Test Loss: 3.261 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.0147864818573
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.086 Vali Acc: 0.496 Test Loss: 3.086 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.30859088897705
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.006 Vali Acc: 0.496 Test Loss: 3.006 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.011935234069824
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.511 Test Loss: 3.021 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.203091144561768
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.037 Vali Acc: 0.511 Test Loss: 3.037 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.504995584487915
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.504 Test Loss: 3.029 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.37777066230774
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.034 Vali Acc: 0.504 Test Loss: 3.034 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.279247283935547
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.504 Test Loss: 3.031 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.262032747268677
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.030 Vali Acc: 0.511 Test Loss: 3.030 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.332545042037964
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.025 Vali Acc: 0.504 Test Loss: 3.025 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1196065
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.197969913482666
Epoch: 1, Steps: 32 | Train Loss: 1.780 Vali Loss: 2.161 Vali Acc: 0.168 Test Loss: 2.161 Test Acc: 0.168
Validation loss decreased (inf --> -0.167917).  Saving model ...
Epoch: 2 cost time: 11.997890949249268
Epoch: 2, Steps: 32 | Train Loss: 2.058 Vali Loss: 1.868 Vali Acc: 0.420 Test Loss: 1.868 Test Acc: 0.420
Validation loss decreased (-0.167917 --> -0.419829).  Saving model ...
Epoch: 3 cost time: 12.703263282775879
Epoch: 3, Steps: 32 | Train Loss: 1.793 Vali Loss: 2.663 Vali Acc: 0.229 Test Loss: 2.663 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.39042854309082
Epoch: 4, Steps: 32 | Train Loss: 0.983 Vali Loss: 1.575 Vali Acc: 0.450 Test Loss: 1.575 Test Acc: 0.450
Validation loss decreased (-0.419829 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 11.724235773086548
Epoch: 5, Steps: 32 | Train Loss: 0.505 Vali Loss: 2.636 Vali Acc: 0.527 Test Loss: 2.636 Test Acc: 0.527
Validation loss decreased (-0.450366 --> -0.526691).  Saving model ...
Epoch: 6 cost time: 11.745802164077759
Epoch: 6, Steps: 32 | Train Loss: 0.092 Vali Loss: 2.883 Vali Acc: 0.519 Test Loss: 2.883 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.49752140045166
Epoch: 7, Steps: 32 | Train Loss: 0.091 Vali Loss: 2.314 Vali Acc: 0.527 Test Loss: 2.314 Test Acc: 0.527
Validation loss decreased (-0.526691 --> -0.526694).  Saving model ...
Epoch: 8 cost time: 11.978297233581543
Epoch: 8, Steps: 32 | Train Loss: 0.007 Vali Loss: 2.699 Vali Acc: 0.450 Test Loss: 2.699 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.311212539672852
Epoch: 9, Steps: 32 | Train Loss: 0.045 Vali Loss: 3.346 Vali Acc: 0.504 Test Loss: 3.346 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.285020351409912
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.468 Vali Acc: 0.519 Test Loss: 3.468 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.103950023651123
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.262 Vali Acc: 0.511 Test Loss: 3.262 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.251601934432983
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.219 Vali Acc: 0.511 Test Loss: 3.219 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.626100301742554
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.242 Vali Acc: 0.511 Test Loss: 3.242 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.990991115570068
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.238 Vali Acc: 0.511 Test Loss: 3.238 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.398814916610718
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.236 Vali Acc: 0.511 Test Loss: 3.236 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.953999042510986
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.242 Vali Acc: 0.511 Test Loss: 3.242 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.484022617340088
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.511 Test Loss: 3.248 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1106081
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.51728105545044
Epoch: 1, Steps: 32 | Train Loss: 2.452 Vali Loss: 2.450 Vali Acc: 0.412 Test Loss: 2.450 Test Acc: 0.412
Validation loss decreased (inf --> -0.412189).  Saving model ...
Epoch: 2 cost time: 11.403748035430908
Epoch: 2, Steps: 32 | Train Loss: 2.086 Vali Loss: 2.947 Vali Acc: 0.168 Test Loss: 2.947 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.151923894882202
Epoch: 3, Steps: 32 | Train Loss: 1.252 Vali Loss: 2.387 Vali Acc: 0.183 Test Loss: 2.387 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.123940706253052
Epoch: 4, Steps: 32 | Train Loss: 0.832 Vali Loss: 2.518 Vali Acc: 0.351 Test Loss: 2.518 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.574719667434692
Epoch: 5, Steps: 32 | Train Loss: 0.319 Vali Loss: 2.566 Vali Acc: 0.382 Test Loss: 2.566 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.77149748802185
Epoch: 6, Steps: 32 | Train Loss: 0.033 Vali Loss: 2.830 Vali Acc: 0.534 Test Loss: 2.830 Test Acc: 0.534
Validation loss decreased (-0.412189 --> -0.534323).  Saving model ...
Epoch: 7 cost time: 11.850860595703125
Epoch: 7, Steps: 32 | Train Loss: 0.013 Vali Loss: 2.989 Vali Acc: 0.511 Test Loss: 2.989 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.185925722122192
Epoch: 8, Steps: 32 | Train Loss: 0.001 Vali Loss: 2.737 Vali Acc: 0.534 Test Loss: 2.737 Test Acc: 0.534
Validation loss decreased (-0.534323 --> -0.534324).  Saving model ...
Epoch: 9 cost time: 12.07631230354309
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.373 Vali Acc: 0.519 Test Loss: 3.373 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.863655805587769
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 2.936 Vali Acc: 0.511 Test Loss: 2.936 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.180506467819214
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 2.885 Vali Acc: 0.504 Test Loss: 2.885 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.345533609390259
Epoch: 12, Steps: 32 | Train Loss: 0.003 Vali Loss: 3.180 Vali Acc: 0.511 Test Loss: 3.180 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.496706247329712
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.992 Vali Acc: 0.489 Test Loss: 2.992 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.577001571655273
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.496 Test Loss: 2.836 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.308191061019897
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.797 Vali Acc: 0.481 Test Loss: 2.797 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.92395305633545
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.826 Vali Acc: 0.481 Test Loss: 2.826 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.89660930633545
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.481 Test Loss: 2.845 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.780367136001587
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.496 Test Loss: 2.814 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1016097
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.831658363342285
Epoch: 1, Steps: 32 | Train Loss: 2.442 Vali Loss: 2.744 Vali Acc: 0.168 Test Loss: 2.744 Test Acc: 0.168
Validation loss decreased (inf --> -0.167911).  Saving model ...
Epoch: 2 cost time: 10.918653011322021
Epoch: 2, Steps: 32 | Train Loss: 2.099 Vali Loss: 2.200 Vali Acc: 0.427 Test Loss: 2.200 Test Acc: 0.427
Validation loss decreased (-0.167911 --> -0.427459).  Saving model ...
Epoch: 3 cost time: 11.061804056167603
Epoch: 3, Steps: 32 | Train Loss: 2.164 Vali Loss: 1.859 Vali Acc: 0.489 Test Loss: 1.859 Test Acc: 0.489
Validation loss decreased (-0.427459 --> -0.488531).  Saving model ...
Epoch: 4 cost time: 11.044055938720703
Epoch: 4, Steps: 32 | Train Loss: 1.281 Vali Loss: 2.774 Vali Acc: 0.496 Test Loss: 2.774 Test Acc: 0.496
Validation loss decreased (-0.488531 --> -0.496155).  Saving model ...
Epoch: 5 cost time: 11.282205820083618
Epoch: 5, Steps: 32 | Train Loss: 1.299 Vali Loss: 3.222 Vali Acc: 0.298 Test Loss: 3.222 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.408077478408813
Epoch: 6, Steps: 32 | Train Loss: 0.264 Vali Loss: 3.128 Vali Acc: 0.443 Test Loss: 3.128 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.927679538726807
Epoch: 7, Steps: 32 | Train Loss: 0.050 Vali Loss: 3.073 Vali Acc: 0.496 Test Loss: 3.073 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.895640134811401
Epoch: 8, Steps: 32 | Train Loss: 0.058 Vali Loss: 3.065 Vali Acc: 0.359 Test Loss: 3.065 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.330261945724487
Epoch: 9, Steps: 32 | Train Loss: 0.015 Vali Loss: 3.637 Vali Acc: 0.504 Test Loss: 3.637 Test Acc: 0.504
Validation loss decreased (-0.496155 --> -0.503780).  Saving model ...
Epoch: 10 cost time: 10.958397150039673
Epoch: 10, Steps: 32 | Train Loss: 0.002 Vali Loss: 3.510 Vali Acc: 0.496 Test Loss: 3.510 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.817832231521606
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.504 Test Loss: 3.355 Test Acc: 0.504
Validation loss decreased (-0.503780 --> -0.503783).  Saving model ...
Epoch: 12 cost time: 11.169835329055786
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.208 Vali Acc: 0.504 Test Loss: 3.208 Test Acc: 0.504
Validation loss decreased (-0.503783 --> -0.503785).  Saving model ...
Epoch: 13 cost time: 10.992482900619507
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.233 Vali Acc: 0.504 Test Loss: 3.233 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.93785572052002
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.241 Vali Acc: 0.504 Test Loss: 3.241 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.125458478927612
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.241 Vali Acc: 0.496 Test Loss: 3.241 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.873431205749512
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.244 Vali Acc: 0.496 Test Loss: 3.244 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.16130805015564
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.253 Vali Acc: 0.496 Test Loss: 3.253 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.71680998802185
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.250 Vali Acc: 0.496 Test Loss: 3.250 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.829487562179565
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.496 Test Loss: 3.249 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.74824047088623
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.246 Vali Acc: 0.496 Test Loss: 3.246 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.340264320373535
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.246 Vali Acc: 0.496 Test Loss: 3.246 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.937599658966064
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.496 Test Loss: 3.243 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 1136289
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.578528642654419
Epoch: 1, Steps: 32 | Train Loss: 1.865 Vali Loss: 2.197 Vali Acc: 0.168 Test Loss: 2.197 Test Acc: 0.168
Validation loss decreased (inf --> -0.167917).  Saving model ...
Epoch: 2 cost time: 10.938509464263916
Epoch: 2, Steps: 32 | Train Loss: 2.195 Vali Loss: 2.584 Vali Acc: 0.099 Test Loss: 2.584 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.347793340682983
Epoch: 3, Steps: 32 | Train Loss: 1.932 Vali Loss: 2.021 Vali Acc: 0.466 Test Loss: 2.021 Test Acc: 0.466
Validation loss decreased (-0.167917 --> -0.465629).  Saving model ...
Epoch: 4 cost time: 11.559902667999268
Epoch: 4, Steps: 32 | Train Loss: 1.077 Vali Loss: 2.045 Vali Acc: 0.504 Test Loss: 2.045 Test Acc: 0.504
Validation loss decreased (-0.465629 --> -0.503796).  Saving model ...
Epoch: 5 cost time: 11.208836078643799
Epoch: 5, Steps: 32 | Train Loss: 0.317 Vali Loss: 3.620 Vali Acc: 0.504 Test Loss: 3.620 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.496925830841064
Epoch: 6, Steps: 32 | Train Loss: 0.145 Vali Loss: 2.278 Vali Acc: 0.481 Test Loss: 2.278 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.342262744903564
Epoch: 7, Steps: 32 | Train Loss: 0.088 Vali Loss: 2.580 Vali Acc: 0.489 Test Loss: 2.580 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.982861995697021
Epoch: 8, Steps: 32 | Train Loss: 0.008 Vali Loss: 3.142 Vali Acc: 0.511 Test Loss: 3.142 Test Acc: 0.511
Validation loss decreased (-0.503796 --> -0.511419).  Saving model ...
Epoch: 9 cost time: 11.074264287948608
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.306 Vali Acc: 0.450 Test Loss: 3.306 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.448703527450562
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.450 Test Loss: 3.309 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.325663566589355
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.303 Vali Acc: 0.450 Test Loss: 3.303 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.41871428489685
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.277 Vali Acc: 0.450 Test Loss: 3.277 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.13666296005249
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.270 Vali Acc: 0.443 Test Loss: 3.270 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.338146686553955
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.268 Vali Acc: 0.450 Test Loss: 3.268 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.4161217212677
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.258 Vali Acc: 0.450 Test Loss: 3.258 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.192854881286621
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.271 Vali Acc: 0.443 Test Loss: 3.271 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.693198204040527
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.266 Vali Acc: 0.450 Test Loss: 3.266 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.287930727005005
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.450 Test Loss: 3.265 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1046305
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.433118343353271
Epoch: 1, Steps: 32 | Train Loss: 1.674 Vali Loss: 1.848 Vali Acc: 0.420 Test Loss: 1.848 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 11.016754388809204
Epoch: 2, Steps: 32 | Train Loss: 2.284 Vali Loss: 2.379 Vali Acc: 0.183 Test Loss: 2.379 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.655027389526367
Epoch: 3, Steps: 32 | Train Loss: 1.911 Vali Loss: 1.724 Vali Acc: 0.321 Test Loss: 1.724 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.071141481399536
Epoch: 4, Steps: 32 | Train Loss: 1.131 Vali Loss: 1.631 Vali Acc: 0.374 Test Loss: 1.631 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.827156782150269
Epoch: 5, Steps: 32 | Train Loss: 0.578 Vali Loss: 2.001 Vali Acc: 0.511 Test Loss: 2.001 Test Acc: 0.511
Validation loss decreased (-0.419829 --> -0.511430).  Saving model ...
Epoch: 6 cost time: 11.547407627105713
Epoch: 6, Steps: 32 | Train Loss: 0.347 Vali Loss: 2.673 Vali Acc: 0.397 Test Loss: 2.673 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.866479635238647
Epoch: 7, Steps: 32 | Train Loss: 0.158 Vali Loss: 2.919 Vali Acc: 0.473 Test Loss: 2.919 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.02150583267212
Epoch: 8, Steps: 32 | Train Loss: 0.018 Vali Loss: 3.456 Vali Acc: 0.534 Test Loss: 3.456 Test Acc: 0.534
Validation loss decreased (-0.511430 --> -0.534317).  Saving model ...
Epoch: 9 cost time: 11.628737211227417
Epoch: 9, Steps: 32 | Train Loss: 0.002 Vali Loss: 2.908 Vali Acc: 0.534 Test Loss: 2.908 Test Acc: 0.534
Validation loss decreased (-0.534317 --> -0.534322).  Saving model ...
Epoch: 10 cost time: 11.216469764709473
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.534 Test Loss: 2.930 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.961379051208496
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.519 Test Loss: 3.159 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.501773834228516
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.099 Vali Acc: 0.527 Test Loss: 3.099 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.742465734481812
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.073 Vali Acc: 0.527 Test Loss: 3.073 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.870696783065796
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.527 Test Loss: 3.032 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.439636945724487
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.527 Test Loss: 3.024 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.814639568328857
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.024 Vali Acc: 0.527 Test Loss: 3.024 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.192441701889038
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.017 Vali Acc: 0.527 Test Loss: 3.017 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.387569904327393
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.006 Vali Acc: 0.527 Test Loss: 3.006 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.396741390228271
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.014 Vali Acc: 0.527 Test Loss: 3.014 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 956321
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.767764806747437
Epoch: 1, Steps: 32 | Train Loss: 1.894 Vali Loss: 2.408 Vali Acc: 0.420 Test Loss: 2.408 Test Acc: 0.420
Validation loss decreased (inf --> -0.419823).  Saving model ...
Epoch: 2 cost time: 11.119114637374878
Epoch: 2, Steps: 32 | Train Loss: 2.080 Vali Loss: 2.694 Vali Acc: 0.420 Test Loss: 2.694 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.632447957992554
Epoch: 3, Steps: 32 | Train Loss: 1.995 Vali Loss: 2.797 Vali Acc: 0.443 Test Loss: 2.797 Test Acc: 0.443
Validation loss decreased (-0.419823 --> -0.442720).  Saving model ...
Epoch: 4 cost time: 10.861971616744995
Epoch: 4, Steps: 32 | Train Loss: 2.014 Vali Loss: 2.724 Vali Acc: 0.473 Test Loss: 2.724 Test Acc: 0.473
Validation loss decreased (-0.442720 --> -0.473255).  Saving model ...
Epoch: 5 cost time: 10.809252262115479
Epoch: 5, Steps: 32 | Train Loss: 1.033 Vali Loss: 2.939 Vali Acc: 0.489 Test Loss: 2.939 Test Acc: 0.489
Validation loss decreased (-0.473255 --> -0.488520).  Saving model ...
Epoch: 6 cost time: 10.656858444213867
Epoch: 6, Steps: 32 | Train Loss: 0.272 Vali Loss: 3.314 Vali Acc: 0.519 Test Loss: 3.314 Test Acc: 0.519
Validation loss decreased (-0.488520 --> -0.519051).  Saving model ...
Epoch: 7 cost time: 10.654113054275513
Epoch: 7, Steps: 32 | Train Loss: 0.119 Vali Loss: 4.336 Vali Acc: 0.527 Test Loss: 4.336 Test Acc: 0.527
Validation loss decreased (-0.519051 --> -0.526674).  Saving model ...
Epoch: 8 cost time: 11.27992033958435
Epoch: 8, Steps: 32 | Train Loss: 0.005 Vali Loss: 3.062 Vali Acc: 0.534 Test Loss: 3.062 Test Acc: 0.534
Validation loss decreased (-0.526674 --> -0.534321).  Saving model ...
Epoch: 9 cost time: 10.884206056594849
Epoch: 9, Steps: 32 | Train Loss: 0.002 Vali Loss: 3.292 Vali Acc: 0.489 Test Loss: 3.292 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.340753078460693
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.180 Vali Acc: 0.504 Test Loss: 3.180 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.157346963882446
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.254 Vali Acc: 0.504 Test Loss: 3.254 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.51711654663086
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.267 Vali Acc: 0.504 Test Loss: 3.267 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.694259643554688
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.277 Vali Acc: 0.504 Test Loss: 3.277 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.548293828964233
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.276 Vali Acc: 0.489 Test Loss: 3.276 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.021680116653442
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.276 Vali Acc: 0.496 Test Loss: 3.276 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.929649114608765
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.289 Vali Acc: 0.504 Test Loss: 3.289 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.15360975265503
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.301 Vali Acc: 0.511 Test Loss: 3.301 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.933801889419556
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.314 Vali Acc: 0.511 Test Loss: 3.314 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 866337
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.695785522460938
Epoch: 1, Steps: 32 | Train Loss: 2.130 Vali Loss: 2.874 Vali Acc: 0.420 Test Loss: 2.874 Test Acc: 0.420
Validation loss decreased (inf --> -0.419819).  Saving model ...
Epoch: 2 cost time: 11.451202630996704
Epoch: 2, Steps: 32 | Train Loss: 2.466 Vali Loss: 2.134 Vali Acc: 0.420 Test Loss: 2.134 Test Acc: 0.420
Validation loss decreased (-0.419819 --> -0.419826).  Saving model ...
Epoch: 3 cost time: 11.445026397705078
Epoch: 3, Steps: 32 | Train Loss: 2.366 Vali Loss: 1.904 Vali Acc: 0.481 Test Loss: 1.904 Test Acc: 0.481
Validation loss decreased (-0.419826 --> -0.480897).  Saving model ...
Epoch: 4 cost time: 11.715311050415039
Epoch: 4, Steps: 32 | Train Loss: 1.551 Vali Loss: 2.633 Vali Acc: 0.244 Test Loss: 2.633 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.778632402420044
Epoch: 5, Steps: 32 | Train Loss: 0.702 Vali Loss: 2.710 Vali Acc: 0.511 Test Loss: 2.710 Test Acc: 0.511
Validation loss decreased (-0.480897 --> -0.511423).  Saving model ...
Epoch: 6 cost time: 11.739150047302246
Epoch: 6, Steps: 32 | Train Loss: 0.292 Vali Loss: 2.393 Vali Acc: 0.527 Test Loss: 2.393 Test Acc: 0.527
Validation loss decreased (-0.511423 --> -0.526694).  Saving model ...
Epoch: 7 cost time: 12.19047236442566
Epoch: 7, Steps: 32 | Train Loss: 0.084 Vali Loss: 2.750 Vali Acc: 0.481 Test Loss: 2.750 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.23185920715332
Epoch: 8, Steps: 32 | Train Loss: 0.015 Vali Loss: 3.364 Vali Acc: 0.481 Test Loss: 3.364 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.718284845352173
Epoch: 9, Steps: 32 | Train Loss: 0.003 Vali Loss: 3.389 Vali Acc: 0.511 Test Loss: 3.389 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.876425743103027
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.852 Vali Acc: 0.527 Test Loss: 3.852 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.999556064605713
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.388 Vali Acc: 0.458 Test Loss: 3.388 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.33495545387268
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.974 Vali Acc: 0.527 Test Loss: 3.974 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.14228081703186
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.709 Vali Acc: 0.519 Test Loss: 3.709 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.900343656539917
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.599 Vali Acc: 0.511 Test Loss: 3.599 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.89865493774414
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.582 Vali Acc: 0.511 Test Loss: 3.582 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.883112668991089
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.572 Vali Acc: 0.511 Test Loss: 3.572 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1061409
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.04563307762146
Epoch: 1, Steps: 32 | Train Loss: 2.188 Vali Loss: 2.417 Vali Acc: 0.176 Test Loss: 2.417 Test Acc: 0.176
Validation loss decreased (inf --> -0.175548).  Saving model ...
Epoch: 2 cost time: 11.95563006401062
Epoch: 2, Steps: 32 | Train Loss: 2.908 Vali Loss: 3.642 Vali Acc: 0.176 Test Loss: 3.642 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.91534686088562
Epoch: 3, Steps: 32 | Train Loss: 3.817 Vali Loss: 1.552 Vali Acc: 0.237 Test Loss: 1.552 Test Acc: 0.237
Validation loss decreased (-0.175548 --> -0.236626).  Saving model ...
Epoch: 4 cost time: 11.435184717178345
Epoch: 4, Steps: 32 | Train Loss: 2.245 Vali Loss: 2.221 Vali Acc: 0.321 Test Loss: 2.221 Test Acc: 0.321
Validation loss decreased (-0.236626 --> -0.320588).  Saving model ...
Epoch: 5 cost time: 11.789238691329956
Epoch: 5, Steps: 32 | Train Loss: 1.637 Vali Loss: 2.320 Vali Acc: 0.511 Test Loss: 2.320 Test Acc: 0.511
Validation loss decreased (-0.320588 --> -0.511427).  Saving model ...
Epoch: 6 cost time: 11.307168960571289
Epoch: 6, Steps: 32 | Train Loss: 0.399 Vali Loss: 2.556 Vali Acc: 0.527 Test Loss: 2.556 Test Acc: 0.527
Validation loss decreased (-0.511427 --> -0.526692).  Saving model ...
Epoch: 7 cost time: 11.455928325653076
Epoch: 7, Steps: 32 | Train Loss: 0.227 Vali Loss: 4.075 Vali Acc: 0.519 Test Loss: 4.075 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.784857034683228
Epoch: 8, Steps: 32 | Train Loss: 0.048 Vali Loss: 3.099 Vali Acc: 0.458 Test Loss: 3.099 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.464992046356201
Epoch: 9, Steps: 32 | Train Loss: 0.006 Vali Loss: 3.244 Vali Acc: 0.473 Test Loss: 3.244 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.215641975402832
Epoch: 10, Steps: 32 | Train Loss: 0.019 Vali Loss: 3.997 Vali Acc: 0.534 Test Loss: 3.997 Test Acc: 0.534
Validation loss decreased (-0.526692 --> -0.534311).  Saving model ...
Epoch: 11 cost time: 11.490487813949585
Epoch: 11, Steps: 32 | Train Loss: 0.015 Vali Loss: 3.747 Vali Acc: 0.481 Test Loss: 3.747 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.53481674194336
Epoch: 12, Steps: 32 | Train Loss: 0.032 Vali Loss: 3.293 Vali Acc: 0.511 Test Loss: 3.293 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.993243932723999
Epoch: 13, Steps: 32 | Train Loss: 0.008 Vali Loss: 3.893 Vali Acc: 0.489 Test Loss: 3.893 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.61998200416565
Epoch: 14, Steps: 32 | Train Loss: 0.005 Vali Loss: 3.599 Vali Acc: 0.458 Test Loss: 3.599 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.764824151992798
Epoch: 15, Steps: 32 | Train Loss: 0.028 Vali Loss: 4.477 Vali Acc: 0.534 Test Loss: 4.477 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.188247442245483
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 4.255 Vali Acc: 0.489 Test Loss: 4.255 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.847903728485107
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.406 Vali Acc: 0.504 Test Loss: 4.406 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.627331018447876
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.339 Vali Acc: 0.504 Test Loss: 4.339 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.180084466934204
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.322 Vali Acc: 0.504 Test Loss: 4.322 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.951333284378052
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.300 Vali Acc: 0.504 Test Loss: 4.300 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 971425
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.138088464736938
Epoch: 1, Steps: 32 | Train Loss: 2.044 Vali Loss: 1.963 Vali Acc: 0.168 Test Loss: 1.963 Test Acc: 0.168
Validation loss decreased (inf --> -0.167919).  Saving model ...
Epoch: 2 cost time: 10.98575234413147
Epoch: 2, Steps: 32 | Train Loss: 1.996 Vali Loss: 2.130 Vali Acc: 0.420 Test Loss: 2.130 Test Acc: 0.420
Validation loss decreased (-0.167919 --> -0.419826).  Saving model ...
Epoch: 3 cost time: 10.86061406135559
Epoch: 3, Steps: 32 | Train Loss: 2.103 Vali Loss: 2.169 Vali Acc: 0.221 Test Loss: 2.169 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.395120859146118
Epoch: 4, Steps: 32 | Train Loss: 1.049 Vali Loss: 1.546 Vali Acc: 0.489 Test Loss: 1.546 Test Acc: 0.489
Validation loss decreased (-0.419826 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 10.725160360336304
Epoch: 5, Steps: 32 | Train Loss: 0.381 Vali Loss: 2.926 Vali Acc: 0.527 Test Loss: 2.926 Test Acc: 0.527
Validation loss decreased (-0.488534 --> -0.526688).  Saving model ...
Epoch: 6 cost time: 10.825605392456055
Epoch: 6, Steps: 32 | Train Loss: 0.159 Vali Loss: 3.211 Vali Acc: 0.489 Test Loss: 3.211 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.67652416229248
Epoch: 7, Steps: 32 | Train Loss: 0.031 Vali Loss: 3.879 Vali Acc: 0.359 Test Loss: 3.879 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.31352949142456
Epoch: 8, Steps: 32 | Train Loss: 0.035 Vali Loss: 3.994 Vali Acc: 0.534 Test Loss: 3.994 Test Acc: 0.534
Validation loss decreased (-0.526688 --> -0.534311).  Saving model ...
Epoch: 9 cost time: 10.633687973022461
Epoch: 9, Steps: 32 | Train Loss: 0.027 Vali Loss: 4.453 Vali Acc: 0.519 Test Loss: 4.453 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.740893363952637
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.574 Vali Acc: 0.511 Test Loss: 3.574 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.214792966842651
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.579 Vali Acc: 0.527 Test Loss: 3.579 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.086320877075195
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.578 Vali Acc: 0.527 Test Loss: 3.578 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.310587167739868
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.573 Vali Acc: 0.527 Test Loss: 3.573 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.501505851745605
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.571 Vali Acc: 0.527 Test Loss: 3.571 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.67630410194397
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.582 Vali Acc: 0.527 Test Loss: 3.582 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.686497688293457
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.582 Vali Acc: 0.527 Test Loss: 3.582 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.138916969299316
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.587 Vali Acc: 0.527 Test Loss: 3.587 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.775075435638428
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.590 Vali Acc: 0.527 Test Loss: 3.590 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 881441
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.897335290908813
Epoch: 1, Steps: 32 | Train Loss: 2.214 Vali Loss: 2.255 Vali Acc: 0.176 Test Loss: 2.255 Test Acc: 0.176
Validation loss decreased (inf --> -0.175550).  Saving model ...
Epoch: 2 cost time: 11.10468339920044
Epoch: 2, Steps: 32 | Train Loss: 2.439 Vali Loss: 2.220 Vali Acc: 0.244 Test Loss: 2.220 Test Acc: 0.244
Validation loss decreased (-0.175550 --> -0.244253).  Saving model ...
Epoch: 3 cost time: 10.926039934158325
Epoch: 3, Steps: 32 | Train Loss: 2.145 Vali Loss: 1.749 Vali Acc: 0.473 Test Loss: 1.749 Test Acc: 0.473
Validation loss decreased (-0.244253 --> -0.473265).  Saving model ...
Epoch: 4 cost time: 10.594126224517822
Epoch: 4, Steps: 32 | Train Loss: 1.511 Vali Loss: 1.724 Vali Acc: 0.435 Test Loss: 1.724 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.681034088134766
Epoch: 5, Steps: 32 | Train Loss: 0.607 Vali Loss: 2.581 Vali Acc: 0.328 Test Loss: 2.581 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.109114646911621
Epoch: 6, Steps: 32 | Train Loss: 0.215 Vali Loss: 3.196 Vali Acc: 0.458 Test Loss: 3.196 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.18446946144104
Epoch: 7, Steps: 32 | Train Loss: 0.041 Vali Loss: 3.909 Vali Acc: 0.496 Test Loss: 3.909 Test Acc: 0.496
Validation loss decreased (-0.473265 --> -0.496144).  Saving model ...
Epoch: 8 cost time: 11.203043937683105
Epoch: 8, Steps: 32 | Train Loss: 0.014 Vali Loss: 3.686 Vali Acc: 0.542 Test Loss: 3.686 Test Acc: 0.542
Validation loss decreased (-0.496144 --> -0.541948).  Saving model ...
Epoch: 9 cost time: 11.077395915985107
Epoch: 9, Steps: 32 | Train Loss: 0.003 Vali Loss: 3.786 Vali Acc: 0.519 Test Loss: 3.786 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.879369258880615
Epoch: 10, Steps: 32 | Train Loss: 0.016 Vali Loss: 3.843 Vali Acc: 0.511 Test Loss: 3.843 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.02080488204956
Epoch: 11, Steps: 32 | Train Loss: 0.012 Vali Loss: 4.055 Vali Acc: 0.496 Test Loss: 4.055 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.83469843864441
Epoch: 12, Steps: 32 | Train Loss: 0.036 Vali Loss: 5.666 Vali Acc: 0.527 Test Loss: 5.666 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.645562887191772
Epoch: 13, Steps: 32 | Train Loss: 0.021 Vali Loss: 4.106 Vali Acc: 0.458 Test Loss: 4.106 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.167444229125977
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 3.581 Vali Acc: 0.435 Test Loss: 3.581 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.911120891571045
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.805 Vali Acc: 0.443 Test Loss: 3.805 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.22562575340271
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.873 Vali Acc: 0.458 Test Loss: 3.873 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.95844554901123
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.855 Vali Acc: 0.450 Test Loss: 3.855 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.816901683807373
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.840 Vali Acc: 0.450 Test Loss: 3.840 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 791457
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.372517108917236
Epoch: 1, Steps: 32 | Train Loss: 6.441 Vali Loss: 17.456 Vali Acc: 0.168 Test Loss: 17.456 Test Acc: 0.168
Validation loss decreased (inf --> -0.167764).  Saving model ...
Epoch: 2 cost time: 13.910852432250977
Epoch: 2, Steps: 32 | Train Loss: 16.094 Vali Loss: 22.007 Vali Acc: 0.435 Test Loss: 22.007 Test Acc: 0.435
Validation loss decreased (-0.167764 --> -0.434894).  Saving model ...
Epoch: 3 cost time: 13.773169994354248
Epoch: 3, Steps: 32 | Train Loss: 9.574 Vali Loss: 19.097 Vali Acc: 0.260 Test Loss: 19.097 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.873321294784546
Epoch: 4, Steps: 32 | Train Loss: 3.857 Vali Loss: 15.928 Vali Acc: 0.412 Test Loss: 15.928 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.979328155517578
Epoch: 5, Steps: 32 | Train Loss: 4.617 Vali Loss: 23.658 Vali Acc: 0.450 Test Loss: 23.658 Test Acc: 0.450
Validation loss decreased (-0.434894 --> -0.450145).  Saving model ...
Epoch: 6 cost time: 13.951067447662354
Epoch: 6, Steps: 32 | Train Loss: 2.312 Vali Loss: 20.222 Vali Acc: 0.397 Test Loss: 20.222 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.15951132774353
Epoch: 7, Steps: 32 | Train Loss: 19.767 Vali Loss: 22.362 Vali Acc: 0.183 Test Loss: 22.362 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.074506998062134
Epoch: 8, Steps: 32 | Train Loss: 26.473 Vali Loss: 20.848 Vali Acc: 0.237 Test Loss: 20.848 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.165220499038696
Epoch: 9, Steps: 32 | Train Loss: 16.811 Vali Loss: 24.320 Vali Acc: 0.176 Test Loss: 24.320 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.103968620300293
Epoch: 10, Steps: 32 | Train Loss: 5.814 Vali Loss: 18.540 Vali Acc: 0.374 Test Loss: 18.540 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.580749750137329
Epoch: 11, Steps: 32 | Train Loss: 1.005 Vali Loss: 24.869 Vali Acc: 0.412 Test Loss: 24.869 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.62185549736023
Epoch: 12, Steps: 32 | Train Loss: 1.069 Vali Loss: 24.730 Vali Acc: 0.443 Test Loss: 24.730 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.26684832572937
Epoch: 13, Steps: 32 | Train Loss: 0.367 Vali Loss: 30.475 Vali Acc: 0.458 Test Loss: 30.475 Test Acc: 0.458
Validation loss decreased (-0.450145 --> -0.457711).  Saving model ...
Epoch: 14 cost time: 13.962218761444092
Epoch: 14, Steps: 32 | Train Loss: 2.876 Vali Loss: 43.274 Vali Acc: 0.473 Test Loss: 43.274 Test Acc: 0.473
Validation loss decreased (-0.457711 --> -0.472850).  Saving model ...
Epoch: 15 cost time: 14.191711187362671
Epoch: 15, Steps: 32 | Train Loss: 1.503 Vali Loss: 37.183 Vali Acc: 0.496 Test Loss: 37.183 Test Acc: 0.496
Validation loss decreased (-0.472850 --> -0.495811).  Saving model ...
Epoch: 16 cost time: 13.652628898620605
Epoch: 16, Steps: 32 | Train Loss: 1.108 Vali Loss: 26.429 Vali Acc: 0.397 Test Loss: 26.429 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.86652398109436
Epoch: 17, Steps: 32 | Train Loss: 0.390 Vali Loss: 32.645 Vali Acc: 0.412 Test Loss: 32.645 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.110715627670288
Epoch: 18, Steps: 32 | Train Loss: 0.154 Vali Loss: 31.394 Vali Acc: 0.389 Test Loss: 31.394 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.14582371711731
Epoch: 19, Steps: 32 | Train Loss: 1.470 Vali Loss: 35.180 Vali Acc: 0.366 Test Loss: 35.180 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.28581690788269
Epoch: 20, Steps: 32 | Train Loss: 9.732 Vali Loss: 35.828 Vali Acc: 0.130 Test Loss: 35.828 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.959845781326294
Epoch: 21, Steps: 32 | Train Loss: 25.585 Vali Loss: 7.634 Vali Acc: 0.168 Test Loss: 7.634 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 13.90030837059021
Epoch: 22, Steps: 32 | Train Loss: 28.031 Vali Loss: 26.115 Vali Acc: 0.176 Test Loss: 26.115 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.728427648544312
Epoch: 23, Steps: 32 | Train Loss: 26.252 Vali Loss: 19.581 Vali Acc: 0.420 Test Loss: 19.581 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.009446620941162
Epoch: 24, Steps: 32 | Train Loss: 20.205 Vali Loss: 8.421 Vali Acc: 0.137 Test Loss: 8.421 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.073732614517212
Epoch: 25, Steps: 32 | Train Loss: 16.279 Vali Loss: 17.142 Vali Acc: 0.137 Test Loss: 17.142 Test Acc: 0.137
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 18954805
model size : 90.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.39991545677185
Epoch: 1, Steps: 32 | Train Loss: 9.748 Vali Loss: 16.595 Vali Acc: 0.137 Test Loss: 16.595 Test Acc: 0.137
Validation loss decreased (inf --> -0.137239).  Saving model ...
Epoch: 2 cost time: 13.897376775741577
Epoch: 2, Steps: 32 | Train Loss: 12.319 Vali Loss: 14.514 Vali Acc: 0.351 Test Loss: 14.514 Test Acc: 0.351
Validation loss decreased (-0.137239 --> -0.351000).  Saving model ...
Epoch: 3 cost time: 13.566960334777832
Epoch: 3, Steps: 32 | Train Loss: 6.750 Vali Loss: 15.833 Vali Acc: 0.359 Test Loss: 15.833 Test Acc: 0.359
Validation loss decreased (-0.351000 --> -0.358620).  Saving model ...
Epoch: 4 cost time: 13.804019927978516
Epoch: 4, Steps: 32 | Train Loss: 4.243 Vali Loss: 26.593 Vali Acc: 0.282 Test Loss: 26.593 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.863505840301514
Epoch: 5, Steps: 32 | Train Loss: 4.448 Vali Loss: 25.112 Vali Acc: 0.282 Test Loss: 25.112 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.902637958526611
Epoch: 6, Steps: 32 | Train Loss: 1.183 Vali Loss: 19.866 Vali Acc: 0.481 Test Loss: 19.866 Test Acc: 0.481
Validation loss decreased (-0.358620 --> -0.480717).  Saving model ...
Epoch: 7 cost time: 13.770389556884766
Epoch: 7, Steps: 32 | Train Loss: 3.148 Vali Loss: 23.076 Vali Acc: 0.382 Test Loss: 23.076 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.96514344215393
Epoch: 8, Steps: 32 | Train Loss: 1.518 Vali Loss: 28.532 Vali Acc: 0.496 Test Loss: 28.532 Test Acc: 0.496
Validation loss decreased (-0.480717 --> -0.495898).  Saving model ...
Epoch: 9 cost time: 13.504714727401733
Epoch: 9, Steps: 32 | Train Loss: 0.752 Vali Loss: 28.030 Vali Acc: 0.374 Test Loss: 28.030 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.67000937461853
Epoch: 10, Steps: 32 | Train Loss: 0.324 Vali Loss: 32.893 Vali Acc: 0.443 Test Loss: 32.893 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.867777109146118
Epoch: 11, Steps: 32 | Train Loss: 0.822 Vali Loss: 29.790 Vali Acc: 0.427 Test Loss: 29.790 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.795155763626099
Epoch: 12, Steps: 32 | Train Loss: 0.630 Vali Loss: 33.252 Vali Acc: 0.473 Test Loss: 33.252 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.952802419662476
Epoch: 13, Steps: 32 | Train Loss: 0.801 Vali Loss: 31.204 Vali Acc: 0.496 Test Loss: 31.204 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.084740161895752
Epoch: 14, Steps: 32 | Train Loss: 0.578 Vali Loss: 34.446 Vali Acc: 0.382 Test Loss: 34.446 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.068285703659058
Epoch: 15, Steps: 32 | Train Loss: 0.413 Vali Loss: 34.716 Vali Acc: 0.351 Test Loss: 34.716 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.837177515029907
Epoch: 16, Steps: 32 | Train Loss: 1.930 Vali Loss: 38.895 Vali Acc: 0.351 Test Loss: 38.895 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.142481088638306
Epoch: 17, Steps: 32 | Train Loss: 2.287 Vali Loss: 84.485 Vali Acc: 0.168 Test Loss: 84.485 Test Acc: 0.168
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.617955684661865
Epoch: 18, Steps: 32 | Train Loss: 7.883 Vali Loss: 46.067 Vali Acc: 0.305 Test Loss: 46.067 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 18283061
model size : 87.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.540916681289673
Epoch: 1, Steps: 32 | Train Loss: 8.735 Vali Loss: 10.347 Vali Acc: 0.168 Test Loss: 10.347 Test Acc: 0.168
Validation loss decreased (inf --> -0.167835).  Saving model ...
Epoch: 2 cost time: 13.600189208984375
Epoch: 2, Steps: 32 | Train Loss: 9.319 Vali Loss: 12.184 Vali Acc: 0.496 Test Loss: 12.184 Test Acc: 0.496
Validation loss decreased (-0.167835 --> -0.496061).  Saving model ...
Epoch: 3 cost time: 13.448330640792847
Epoch: 3, Steps: 32 | Train Loss: 5.497 Vali Loss: 13.259 Vali Acc: 0.405 Test Loss: 13.259 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.585359811782837
Epoch: 4, Steps: 32 | Train Loss: 2.719 Vali Loss: 20.148 Vali Acc: 0.473 Test Loss: 20.148 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.680789709091187
Epoch: 5, Steps: 32 | Train Loss: 1.461 Vali Loss: 15.532 Vali Acc: 0.481 Test Loss: 15.532 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.788004398345947
Epoch: 6, Steps: 32 | Train Loss: 2.912 Vali Loss: 13.749 Vali Acc: 0.519 Test Loss: 13.749 Test Acc: 0.519
Validation loss decreased (-0.496061 --> -0.518946).  Saving model ...
Epoch: 7 cost time: 13.60766053199768
Epoch: 7, Steps: 32 | Train Loss: 1.280 Vali Loss: 22.683 Vali Acc: 0.420 Test Loss: 22.683 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.45634937286377
Epoch: 8, Steps: 32 | Train Loss: 0.892 Vali Loss: 22.446 Vali Acc: 0.229 Test Loss: 22.446 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.681905508041382
Epoch: 9, Steps: 32 | Train Loss: 1.652 Vali Loss: 35.814 Vali Acc: 0.290 Test Loss: 35.814 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.400413990020752
Epoch: 10, Steps: 32 | Train Loss: 3.541 Vali Loss: 32.359 Vali Acc: 0.382 Test Loss: 32.359 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.25808596611023
Epoch: 11, Steps: 32 | Train Loss: 2.241 Vali Loss: 33.288 Vali Acc: 0.458 Test Loss: 33.288 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.642231702804565
Epoch: 12, Steps: 32 | Train Loss: 3.482 Vali Loss: 34.960 Vali Acc: 0.298 Test Loss: 34.960 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.79649543762207
Epoch: 13, Steps: 32 | Train Loss: 6.788 Vali Loss: 30.329 Vali Acc: 0.313 Test Loss: 30.329 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.024312019348145
Epoch: 14, Steps: 32 | Train Loss: 20.026 Vali Loss: 86.358 Vali Acc: 0.176 Test Loss: 86.358 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.977039337158203
Epoch: 15, Steps: 32 | Train Loss: 16.716 Vali Loss: 54.290 Vali Acc: 0.290 Test Loss: 54.290 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.844481945037842
Epoch: 16, Steps: 32 | Train Loss: 11.056 Vali Loss: 76.446 Vali Acc: 0.450 Test Loss: 76.446 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 17611317
model size : 84.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.995426654815674
Epoch: 1, Steps: 32 | Train Loss: 9.733 Vali Loss: 25.573 Vali Acc: 0.420 Test Loss: 25.573 Test Acc: 0.420
Validation loss decreased (inf --> -0.419592).  Saving model ...
Epoch: 2 cost time: 13.310534000396729
Epoch: 2, Steps: 32 | Train Loss: 16.987 Vali Loss: 23.278 Vali Acc: 0.435 Test Loss: 23.278 Test Acc: 0.435
Validation loss decreased (-0.419592 --> -0.434882).  Saving model ...
Epoch: 3 cost time: 13.473334074020386
Epoch: 3, Steps: 32 | Train Loss: 8.959 Vali Loss: 18.291 Vali Acc: 0.519 Test Loss: 18.291 Test Acc: 0.519
Validation loss decreased (-0.434882 --> -0.518901).  Saving model ...
Epoch: 4 cost time: 13.238099575042725
Epoch: 4, Steps: 32 | Train Loss: 2.592 Vali Loss: 18.812 Vali Acc: 0.267 Test Loss: 18.812 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.600004434585571
Epoch: 5, Steps: 32 | Train Loss: 4.036 Vali Loss: 16.620 Vali Acc: 0.511 Test Loss: 16.620 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.640136480331421
Epoch: 6, Steps: 32 | Train Loss: 2.047 Vali Loss: 19.040 Vali Acc: 0.519 Test Loss: 19.040 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.460578441619873
Epoch: 7, Steps: 32 | Train Loss: 1.747 Vali Loss: 23.396 Vali Acc: 0.412 Test Loss: 23.396 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.02861213684082
Epoch: 8, Steps: 32 | Train Loss: 0.352 Vali Loss: 24.603 Vali Acc: 0.458 Test Loss: 24.603 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.733549356460571
Epoch: 9, Steps: 32 | Train Loss: 0.830 Vali Loss: 24.906 Vali Acc: 0.450 Test Loss: 24.906 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.823346853256226
Epoch: 10, Steps: 32 | Train Loss: 1.872 Vali Loss: 26.665 Vali Acc: 0.427 Test Loss: 26.665 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.676371335983276
Epoch: 11, Steps: 32 | Train Loss: 1.041 Vali Loss: 31.164 Vali Acc: 0.435 Test Loss: 31.164 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.946551084518433
Epoch: 12, Steps: 32 | Train Loss: 4.901 Vali Loss: 34.953 Vali Acc: 0.298 Test Loss: 34.953 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.858182430267334
Epoch: 13, Steps: 32 | Train Loss: 2.704 Vali Loss: 36.573 Vali Acc: 0.328 Test Loss: 36.573 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 16939573
model size : 82.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.14506506919861
Epoch: 1, Steps: 32 | Train Loss: 7.895 Vali Loss: 9.857 Vali Acc: 0.420 Test Loss: 9.857 Test Acc: 0.420
Validation loss decreased (inf --> -0.419749).  Saving model ...
Epoch: 2 cost time: 14.196715593338013
Epoch: 2, Steps: 32 | Train Loss: 7.610 Vali Loss: 6.423 Vali Acc: 0.519 Test Loss: 6.423 Test Acc: 0.519
Validation loss decreased (-0.419749 --> -0.519020).  Saving model ...
Epoch: 3 cost time: 13.414393901824951
Epoch: 3, Steps: 32 | Train Loss: 5.650 Vali Loss: 12.511 Vali Acc: 0.450 Test Loss: 12.511 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.469516515731812
Epoch: 4, Steps: 32 | Train Loss: 3.270 Vali Loss: 10.982 Vali Acc: 0.443 Test Loss: 10.982 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.517781734466553
Epoch: 5, Steps: 32 | Train Loss: 2.052 Vali Loss: 22.212 Vali Acc: 0.366 Test Loss: 22.212 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.644993543624878
Epoch: 6, Steps: 32 | Train Loss: 1.697 Vali Loss: 20.941 Vali Acc: 0.458 Test Loss: 20.941 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.759479284286499
Epoch: 7, Steps: 32 | Train Loss: 3.085 Vali Loss: 26.552 Vali Acc: 0.466 Test Loss: 26.552 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.041526794433594
Epoch: 8, Steps: 32 | Train Loss: 2.436 Vali Loss: 26.442 Vali Acc: 0.427 Test Loss: 26.442 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.33484959602356
Epoch: 9, Steps: 32 | Train Loss: 0.721 Vali Loss: 28.526 Vali Acc: 0.366 Test Loss: 28.526 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.312756299972534
Epoch: 10, Steps: 32 | Train Loss: 0.678 Vali Loss: 36.198 Vali Acc: 0.405 Test Loss: 36.198 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.495557308197021
Epoch: 11, Steps: 32 | Train Loss: 10.056 Vali Loss: 28.045 Vali Acc: 0.153 Test Loss: 28.045 Test Acc: 0.153
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.665492057800293
Epoch: 12, Steps: 32 | Train Loss: 25.530 Vali Loss: 38.481 Vali Acc: 0.252 Test Loss: 38.481 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 17116213
model size : 83.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.817191362380981
Epoch: 1, Steps: 32 | Train Loss: 10.340 Vali Loss: 22.689 Vali Acc: 0.420 Test Loss: 22.689 Test Acc: 0.420
Validation loss decreased (inf --> -0.419620).  Saving model ...
Epoch: 2 cost time: 13.239484548568726
Epoch: 2, Steps: 32 | Train Loss: 18.630 Vali Loss: 9.029 Vali Acc: 0.137 Test Loss: 9.029 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.253046035766602
Epoch: 3, Steps: 32 | Train Loss: 8.413 Vali Loss: 18.302 Vali Acc: 0.275 Test Loss: 18.302 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.384193658828735
Epoch: 4, Steps: 32 | Train Loss: 3.833 Vali Loss: 30.083 Vali Acc: 0.260 Test Loss: 30.083 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.249783277511597
Epoch: 5, Steps: 32 | Train Loss: 1.842 Vali Loss: 17.573 Vali Acc: 0.511 Test Loss: 17.573 Test Acc: 0.511
Validation loss decreased (-0.419620 --> -0.511275).  Saving model ...
Epoch: 6 cost time: 13.229677438735962
Epoch: 6, Steps: 32 | Train Loss: 2.259 Vali Loss: 23.137 Vali Acc: 0.466 Test Loss: 23.137 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.316148042678833
Epoch: 7, Steps: 32 | Train Loss: 1.389 Vali Loss: 19.440 Vali Acc: 0.466 Test Loss: 19.440 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.416708707809448
Epoch: 8, Steps: 32 | Train Loss: 2.095 Vali Loss: 19.752 Vali Acc: 0.443 Test Loss: 19.752 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.347743272781372
Epoch: 9, Steps: 32 | Train Loss: 0.668 Vali Loss: 20.109 Vali Acc: 0.458 Test Loss: 20.109 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.209067344665527
Epoch: 10, Steps: 32 | Train Loss: 0.902 Vali Loss: 22.048 Vali Acc: 0.405 Test Loss: 22.048 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.312817096710205
Epoch: 11, Steps: 32 | Train Loss: 2.719 Vali Loss: 32.936 Vali Acc: 0.321 Test Loss: 32.936 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.387916326522827
Epoch: 12, Steps: 32 | Train Loss: 1.453 Vali Loss: 34.830 Vali Acc: 0.481 Test Loss: 34.830 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.527100086212158
Epoch: 13, Steps: 32 | Train Loss: 0.122 Vali Loss: 33.241 Vali Acc: 0.389 Test Loss: 33.241 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.389076948165894
Epoch: 14, Steps: 32 | Train Loss: 0.638 Vali Loss: 53.475 Vali Acc: 0.496 Test Loss: 53.475 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.661697149276733
Epoch: 15, Steps: 32 | Train Loss: 0.381 Vali Loss: 32.000 Vali Acc: 0.420 Test Loss: 32.000 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 16444469
model size : 80.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.206424236297607
Epoch: 1, Steps: 32 | Train Loss: 8.154 Vali Loss: 13.557 Vali Acc: 0.145 Test Loss: 13.557 Test Acc: 0.145
Validation loss decreased (inf --> -0.144903).  Saving model ...
Epoch: 2 cost time: 13.549456596374512
Epoch: 2, Steps: 32 | Train Loss: 17.598 Vali Loss: 6.101 Vali Acc: 0.450 Test Loss: 6.101 Test Acc: 0.450
Validation loss decreased (-0.144903 --> -0.450321).  Saving model ...
Epoch: 3 cost time: 13.949194192886353
Epoch: 3, Steps: 32 | Train Loss: 6.426 Vali Loss: 13.293 Vali Acc: 0.420 Test Loss: 13.293 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.2643883228302
Epoch: 4, Steps: 32 | Train Loss: 3.727 Vali Loss: 21.278 Vali Acc: 0.550 Test Loss: 21.278 Test Acc: 0.550
Validation loss decreased (-0.450321 --> -0.549406).  Saving model ...
Epoch: 5 cost time: 13.416809558868408
Epoch: 5, Steps: 32 | Train Loss: 2.260 Vali Loss: 17.441 Vali Acc: 0.458 Test Loss: 17.441 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.221369981765747
Epoch: 6, Steps: 32 | Train Loss: 1.654 Vali Loss: 18.296 Vali Acc: 0.504 Test Loss: 18.296 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.074732065200806
Epoch: 7, Steps: 32 | Train Loss: 0.524 Vali Loss: 17.213 Vali Acc: 0.466 Test Loss: 17.213 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.447236776351929
Epoch: 8, Steps: 32 | Train Loss: 1.960 Vali Loss: 26.933 Vali Acc: 0.534 Test Loss: 26.933 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.443954229354858
Epoch: 9, Steps: 32 | Train Loss: 1.045 Vali Loss: 23.821 Vali Acc: 0.550 Test Loss: 23.821 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.25638222694397
Epoch: 10, Steps: 32 | Train Loss: 0.598 Vali Loss: 29.312 Vali Acc: 0.374 Test Loss: 29.312 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.039913892745972
Epoch: 11, Steps: 32 | Train Loss: 2.775 Vali Loss: 33.694 Vali Acc: 0.313 Test Loss: 33.694 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.932804584503174
Epoch: 12, Steps: 32 | Train Loss: 1.122 Vali Loss: 44.566 Vali Acc: 0.267 Test Loss: 44.566 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.392682075500488
Epoch: 13, Steps: 32 | Train Loss: 4.750 Vali Loss: 36.582 Vali Acc: 0.374 Test Loss: 36.582 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.211913347244263
Epoch: 14, Steps: 32 | Train Loss: 1.781 Vali Loss: 30.011 Vali Acc: 0.427 Test Loss: 30.011 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 15772725
model size : 77.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.01408314704895
Epoch: 1, Steps: 32 | Train Loss: 10.629 Vali Loss: 19.822 Vali Acc: 0.137 Test Loss: 19.822 Test Acc: 0.137
Validation loss decreased (inf --> -0.137206).  Saving model ...
Epoch: 2 cost time: 13.338468074798584
Epoch: 2, Steps: 32 | Train Loss: 10.171 Vali Loss: 8.457 Vali Acc: 0.359 Test Loss: 8.457 Test Acc: 0.359
Validation loss decreased (-0.137206 --> -0.358694).  Saving model ...
Epoch: 3 cost time: 13.259754419326782
Epoch: 3, Steps: 32 | Train Loss: 7.055 Vali Loss: 10.992 Vali Acc: 0.389 Test Loss: 10.992 Test Acc: 0.389
Validation loss decreased (-0.358694 --> -0.389203).  Saving model ...
Epoch: 4 cost time: 13.448291301727295
Epoch: 4, Steps: 32 | Train Loss: 4.894 Vali Loss: 18.693 Vali Acc: 0.443 Test Loss: 18.693 Test Acc: 0.443
Validation loss decreased (-0.389203 --> -0.442561).  Saving model ...
Epoch: 5 cost time: 13.330663204193115
Epoch: 5, Steps: 32 | Train Loss: 1.644 Vali Loss: 19.177 Vali Acc: 0.458 Test Loss: 19.177 Test Acc: 0.458
Validation loss decreased (-0.442561 --> -0.457824).  Saving model ...
Epoch: 6 cost time: 12.986270427703857
Epoch: 6, Steps: 32 | Train Loss: 1.937 Vali Loss: 19.933 Vali Acc: 0.450 Test Loss: 19.933 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.235839605331421
Epoch: 7, Steps: 32 | Train Loss: 1.395 Vali Loss: 33.762 Vali Acc: 0.511 Test Loss: 33.762 Test Acc: 0.511
Validation loss decreased (-0.457824 --> -0.511113).  Saving model ...
Epoch: 8 cost time: 13.308273792266846
Epoch: 8, Steps: 32 | Train Loss: 2.979 Vali Loss: 23.984 Vali Acc: 0.450 Test Loss: 23.984 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.357993841171265
Epoch: 9, Steps: 32 | Train Loss: 0.848 Vali Loss: 31.177 Vali Acc: 0.458 Test Loss: 31.177 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.228549003601074
Epoch: 10, Steps: 32 | Train Loss: 1.660 Vali Loss: 25.423 Vali Acc: 0.382 Test Loss: 25.423 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.74172306060791
Epoch: 11, Steps: 32 | Train Loss: 4.985 Vali Loss: 55.593 Vali Acc: 0.481 Test Loss: 55.593 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.643316984176636
Epoch: 12, Steps: 32 | Train Loss: 1.900 Vali Loss: 42.413 Vali Acc: 0.473 Test Loss: 42.413 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.792515754699707
Epoch: 13, Steps: 32 | Train Loss: 1.070 Vali Loss: 25.867 Vali Acc: 0.427 Test Loss: 25.867 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.964632511138916
Epoch: 14, Steps: 32 | Train Loss: 1.611 Vali Loss: 50.342 Vali Acc: 0.252 Test Loss: 50.342 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.998990058898926
Epoch: 15, Steps: 32 | Train Loss: 0.742 Vali Loss: 35.468 Vali Acc: 0.366 Test Loss: 35.468 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.057476282119751
Epoch: 16, Steps: 32 | Train Loss: 0.225 Vali Loss: 31.152 Vali Acc: 0.359 Test Loss: 31.152 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.185749769210815
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.916 Vali Acc: 0.282 Test Loss: 46.916 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 15100981
model size : 75.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.383918523788452
Epoch: 1, Steps: 32 | Train Loss: 7.624 Vali Loss: 15.479 Vali Acc: 0.168 Test Loss: 15.479 Test Acc: 0.168
Validation loss decreased (inf --> -0.167784).  Saving model ...
Epoch: 2 cost time: 13.074519634246826
Epoch: 2, Steps: 32 | Train Loss: 12.787 Vali Loss: 11.953 Vali Acc: 0.450 Test Loss: 11.953 Test Acc: 0.450
Validation loss decreased (-0.167784 --> -0.450262).  Saving model ...
Epoch: 3 cost time: 13.905727624893188
Epoch: 3, Steps: 32 | Train Loss: 5.838 Vali Loss: 13.432 Vali Acc: 0.504 Test Loss: 13.432 Test Acc: 0.504
Validation loss decreased (-0.450262 --> -0.503682).  Saving model ...
Epoch: 4 cost time: 13.416290044784546
Epoch: 4, Steps: 32 | Train Loss: 4.538 Vali Loss: 16.977 Vali Acc: 0.359 Test Loss: 16.977 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.89796781539917
Epoch: 5, Steps: 32 | Train Loss: 3.314 Vali Loss: 21.326 Vali Acc: 0.458 Test Loss: 21.326 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.107455015182495
Epoch: 6, Steps: 32 | Train Loss: 3.609 Vali Loss: 23.166 Vali Acc: 0.496 Test Loss: 23.166 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.477405071258545
Epoch: 7, Steps: 32 | Train Loss: 1.178 Vali Loss: 26.261 Vali Acc: 0.527 Test Loss: 26.261 Test Acc: 0.527
Validation loss decreased (-0.503682 --> -0.526455).  Saving model ...
Epoch: 8 cost time: 13.549705266952515
Epoch: 8, Steps: 32 | Train Loss: 0.980 Vali Loss: 20.509 Vali Acc: 0.336 Test Loss: 20.509 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.827760696411133
Epoch: 9, Steps: 32 | Train Loss: 1.113 Vali Loss: 23.184 Vali Acc: 0.481 Test Loss: 23.184 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.914686441421509
Epoch: 10, Steps: 32 | Train Loss: 0.840 Vali Loss: 27.705 Vali Acc: 0.481 Test Loss: 27.705 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.636363506317139
Epoch: 11, Steps: 32 | Train Loss: 1.139 Vali Loss: 30.046 Vali Acc: 0.466 Test Loss: 30.046 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.581732034683228
Epoch: 12, Steps: 32 | Train Loss: 1.017 Vali Loss: 30.719 Vali Acc: 0.466 Test Loss: 30.719 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.547313451766968
Epoch: 13, Steps: 32 | Train Loss: 1.685 Vali Loss: 32.908 Vali Acc: 0.496 Test Loss: 32.908 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.361579418182373
Epoch: 14, Steps: 32 | Train Loss: 1.434 Vali Loss: 39.886 Vali Acc: 0.305 Test Loss: 39.886 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.664638042449951
Epoch: 15, Steps: 32 | Train Loss: 38.087 Vali Loss: 32.945 Vali Acc: 0.290 Test Loss: 32.945 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.76587724685669
Epoch: 16, Steps: 32 | Train Loss: 39.039 Vali Loss: 44.460 Vali Acc: 0.450 Test Loss: 44.460 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 14.038000106811523
Epoch: 17, Steps: 32 | Train Loss: 13.523 Vali Loss: 50.926 Vali Acc: 0.504 Test Loss: 50.926 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 16196917
model size : 79.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.868490934371948
Epoch: 1, Steps: 32 | Train Loss: 10.792 Vali Loss: 28.058 Vali Acc: 0.137 Test Loss: 28.058 Test Acc: 0.137
Validation loss decreased (inf --> -0.137124).  Saving model ...
Epoch: 2 cost time: 13.21397066116333
Epoch: 2, Steps: 32 | Train Loss: 22.857 Vali Loss: 12.358 Vali Acc: 0.305 Test Loss: 12.358 Test Acc: 0.305
Validation loss decreased (-0.137124 --> -0.305220).  Saving model ...
Epoch: 3 cost time: 13.010841846466064
Epoch: 3, Steps: 32 | Train Loss: 8.722 Vali Loss: 15.093 Vali Acc: 0.511 Test Loss: 15.093 Test Acc: 0.511
Validation loss decreased (-0.305220 --> -0.511299).  Saving model ...
Epoch: 4 cost time: 13.010628461837769
Epoch: 4, Steps: 32 | Train Loss: 4.513 Vali Loss: 19.036 Vali Acc: 0.275 Test Loss: 19.036 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.323491334915161
Epoch: 5, Steps: 32 | Train Loss: 1.791 Vali Loss: 16.445 Vali Acc: 0.389 Test Loss: 16.445 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.010542869567871
Epoch: 6, Steps: 32 | Train Loss: 1.554 Vali Loss: 27.620 Vali Acc: 0.534 Test Loss: 27.620 Test Acc: 0.534
Validation loss decreased (-0.511299 --> -0.534075).  Saving model ...
Epoch: 7 cost time: 12.872571468353271
Epoch: 7, Steps: 32 | Train Loss: 1.951 Vali Loss: 34.121 Vali Acc: 0.466 Test Loss: 34.121 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.012291193008423
Epoch: 8, Steps: 32 | Train Loss: 2.769 Vali Loss: 34.494 Vali Acc: 0.473 Test Loss: 34.494 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.06238865852356
Epoch: 9, Steps: 32 | Train Loss: 2.072 Vali Loss: 23.554 Vali Acc: 0.420 Test Loss: 23.554 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.935598850250244
Epoch: 10, Steps: 32 | Train Loss: 3.591 Vali Loss: 32.337 Vali Acc: 0.344 Test Loss: 32.337 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.179426193237305
Epoch: 11, Steps: 32 | Train Loss: 0.993 Vali Loss: 38.023 Vali Acc: 0.443 Test Loss: 38.023 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.042745113372803
Epoch: 12, Steps: 32 | Train Loss: 1.838 Vali Loss: 30.263 Vali Acc: 0.481 Test Loss: 30.263 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.344200849533081
Epoch: 13, Steps: 32 | Train Loss: 2.538 Vali Loss: 42.477 Vali Acc: 0.351 Test Loss: 42.477 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.853672504425049
Epoch: 14, Steps: 32 | Train Loss: 0.973 Vali Loss: 36.145 Vali Acc: 0.389 Test Loss: 36.145 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.063414335250854
Epoch: 15, Steps: 32 | Train Loss: 0.365 Vali Loss: 35.852 Vali Acc: 0.519 Test Loss: 35.852 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.800037384033203
Epoch: 16, Steps: 32 | Train Loss: 0.644 Vali Loss: 38.999 Vali Acc: 0.405 Test Loss: 38.999 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 15525173
model size : 76.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.30112600326538
Epoch: 1, Steps: 32 | Train Loss: 8.658 Vali Loss: 12.991 Vali Acc: 0.420 Test Loss: 12.991 Test Acc: 0.420
Validation loss decreased (inf --> -0.419717).  Saving model ...
Epoch: 2 cost time: 13.652354955673218
Epoch: 2, Steps: 32 | Train Loss: 13.683 Vali Loss: 27.556 Vali Acc: 0.176 Test Loss: 27.556 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.265053987503052
Epoch: 3, Steps: 32 | Train Loss: 9.384 Vali Loss: 10.709 Vali Acc: 0.489 Test Loss: 10.709 Test Acc: 0.489
Validation loss decreased (-0.419717 --> -0.488443).  Saving model ...
Epoch: 4 cost time: 13.434571981430054
Epoch: 4, Steps: 32 | Train Loss: 2.403 Vali Loss: 21.929 Vali Acc: 0.443 Test Loss: 21.929 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.110407829284668
Epoch: 5, Steps: 32 | Train Loss: 3.325 Vali Loss: 20.853 Vali Acc: 0.435 Test Loss: 20.853 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.57044529914856
Epoch: 6, Steps: 32 | Train Loss: 1.354 Vali Loss: 25.307 Vali Acc: 0.458 Test Loss: 25.307 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.910409927368164
Epoch: 7, Steps: 32 | Train Loss: 0.909 Vali Loss: 27.999 Vali Acc: 0.336 Test Loss: 27.999 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.362387418746948
Epoch: 8, Steps: 32 | Train Loss: 1.383 Vali Loss: 27.014 Vali Acc: 0.412 Test Loss: 27.014 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.657744407653809
Epoch: 9, Steps: 32 | Train Loss: 2.323 Vali Loss: 33.137 Vali Acc: 0.557 Test Loss: 33.137 Test Acc: 0.557
Validation loss decreased (-0.488443 --> -0.556921).  Saving model ...
Epoch: 10 cost time: 13.108574867248535
Epoch: 10, Steps: 32 | Train Loss: 1.227 Vali Loss: 29.103 Vali Acc: 0.489 Test Loss: 29.103 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.849282264709473
Epoch: 11, Steps: 32 | Train Loss: 0.633 Vali Loss: 35.840 Vali Acc: 0.267 Test Loss: 35.840 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.226311206817627
Epoch: 12, Steps: 32 | Train Loss: 0.659 Vali Loss: 30.934 Vali Acc: 0.481 Test Loss: 30.934 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.252684831619263
Epoch: 13, Steps: 32 | Train Loss: 0.714 Vali Loss: 32.710 Vali Acc: 0.374 Test Loss: 32.710 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.655736207962036
Epoch: 14, Steps: 32 | Train Loss: 2.245 Vali Loss: 37.569 Vali Acc: 0.305 Test Loss: 37.569 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.62904405593872
Epoch: 15, Steps: 32 | Train Loss: 1.608 Vali Loss: 34.911 Vali Acc: 0.527 Test Loss: 34.911 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.347470045089722
Epoch: 16, Steps: 32 | Train Loss: 0.475 Vali Loss: 32.695 Vali Acc: 0.458 Test Loss: 32.695 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.583220720291138
Epoch: 17, Steps: 32 | Train Loss: 1.316 Vali Loss: 28.316 Vali Acc: 0.351 Test Loss: 28.316 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.60023283958435
Epoch: 18, Steps: 32 | Train Loss: 5.698 Vali Loss: 24.384 Vali Acc: 0.328 Test Loss: 24.384 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.58684253692627
Epoch: 19, Steps: 32 | Train Loss: 53.434 Vali Loss: 67.676 Vali Acc: 0.206 Test Loss: 67.676 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 14853429
model size : 74.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.083369970321655
Epoch: 1, Steps: 32 | Train Loss: 12.876 Vali Loss: 12.740 Vali Acc: 0.176 Test Loss: 12.740 Test Acc: 0.176
Validation loss decreased (inf --> -0.175445).  Saving model ...
Epoch: 2 cost time: 12.24083662033081
Epoch: 2, Steps: 32 | Train Loss: 10.324 Vali Loss: 14.096 Vali Acc: 0.397 Test Loss: 14.096 Test Acc: 0.397
Validation loss decreased (-0.175445 --> -0.396806).  Saving model ...
Epoch: 3 cost time: 12.916961669921875
Epoch: 3, Steps: 32 | Train Loss: 7.196 Vali Loss: 11.032 Vali Acc: 0.412 Test Loss: 11.032 Test Acc: 0.412
Validation loss decreased (-0.396806 --> -0.412103).  Saving model ...
Epoch: 4 cost time: 12.473767280578613
Epoch: 4, Steps: 32 | Train Loss: 2.954 Vali Loss: 15.841 Vali Acc: 0.534 Test Loss: 15.841 Test Acc: 0.534
Validation loss decreased (-0.412103 --> -0.534193).  Saving model ...
Epoch: 5 cost time: 12.39171290397644
Epoch: 5, Steps: 32 | Train Loss: 2.490 Vali Loss: 21.409 Vali Acc: 0.527 Test Loss: 21.409 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.482370138168335
Epoch: 6, Steps: 32 | Train Loss: 2.061 Vali Loss: 19.281 Vali Acc: 0.557 Test Loss: 19.281 Test Acc: 0.557
Validation loss decreased (-0.534193 --> -0.557059).  Saving model ...
Epoch: 7 cost time: 12.672213077545166
Epoch: 7, Steps: 32 | Train Loss: 0.945 Vali Loss: 15.885 Vali Acc: 0.458 Test Loss: 15.885 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.92325472831726
Epoch: 8, Steps: 32 | Train Loss: 1.273 Vali Loss: 20.593 Vali Acc: 0.527 Test Loss: 20.593 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.582791566848755
Epoch: 9, Steps: 32 | Train Loss: 0.975 Vali Loss: 26.424 Vali Acc: 0.344 Test Loss: 26.424 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.692246913909912
Epoch: 10, Steps: 32 | Train Loss: 9.328 Vali Loss: 22.867 Vali Acc: 0.466 Test Loss: 22.867 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.456399202346802
Epoch: 11, Steps: 32 | Train Loss: 3.714 Vali Loss: 26.836 Vali Acc: 0.328 Test Loss: 26.836 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.40021824836731
Epoch: 12, Steps: 32 | Train Loss: 0.768 Vali Loss: 27.738 Vali Acc: 0.511 Test Loss: 27.738 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.806455373764038
Epoch: 13, Steps: 32 | Train Loss: 0.828 Vali Loss: 26.158 Vali Acc: 0.504 Test Loss: 26.158 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.832387924194336
Epoch: 14, Steps: 32 | Train Loss: 0.002 Vali Loss: 32.917 Vali Acc: 0.313 Test Loss: 32.917 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.477878332138062
Epoch: 15, Steps: 32 | Train Loss: 0.695 Vali Loss: 28.033 Vali Acc: 0.466 Test Loss: 28.033 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.316358089447021
Epoch: 16, Steps: 32 | Train Loss: 0.061 Vali Loss: 28.420 Vali Acc: 0.336 Test Loss: 28.420 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 14181685
model size : 71.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.284640550613403
Epoch: 1, Steps: 32 | Train Loss: 8.152 Vali Loss: 18.357 Vali Acc: 0.137 Test Loss: 18.357 Test Acc: 0.137
Validation loss decreased (inf --> -0.137221).  Saving model ...
Epoch: 2 cost time: 13.012253522872925
Epoch: 2, Steps: 32 | Train Loss: 12.676 Vali Loss: 10.209 Vali Acc: 0.359 Test Loss: 10.209 Test Acc: 0.359
Validation loss decreased (-0.137221 --> -0.358677).  Saving model ...
Epoch: 3 cost time: 13.038280725479126
Epoch: 3, Steps: 32 | Train Loss: 6.364 Vali Loss: 12.017 Vali Acc: 0.412 Test Loss: 12.017 Test Acc: 0.412
Validation loss decreased (-0.358677 --> -0.412094).  Saving model ...
Epoch: 4 cost time: 12.892369031906128
Epoch: 4, Steps: 32 | Train Loss: 4.567 Vali Loss: 23.929 Vali Acc: 0.504 Test Loss: 23.929 Test Acc: 0.504
Validation loss decreased (-0.412094 --> -0.503578).  Saving model ...
Epoch: 5 cost time: 12.806703805923462
Epoch: 5, Steps: 32 | Train Loss: 2.214 Vali Loss: 19.731 Vali Acc: 0.496 Test Loss: 19.731 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.898103952407837
Epoch: 6, Steps: 32 | Train Loss: 3.318 Vali Loss: 21.435 Vali Acc: 0.527 Test Loss: 21.435 Test Acc: 0.527
Validation loss decreased (-0.503578 --> -0.526503).  Saving model ...
Epoch: 7 cost time: 13.437970876693726
Epoch: 7, Steps: 32 | Train Loss: 1.087 Vali Loss: 32.501 Vali Acc: 0.511 Test Loss: 32.501 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.481131315231323
Epoch: 8, Steps: 32 | Train Loss: 3.933 Vali Loss: 21.667 Vali Acc: 0.450 Test Loss: 21.667 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.279696702957153
Epoch: 9, Steps: 32 | Train Loss: 1.866 Vali Loss: 21.497 Vali Acc: 0.496 Test Loss: 21.497 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.098330974578857
Epoch: 10, Steps: 32 | Train Loss: 1.650 Vali Loss: 54.294 Vali Acc: 0.183 Test Loss: 54.294 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.981197357177734
Epoch: 11, Steps: 32 | Train Loss: 3.707 Vali Loss: 35.972 Vali Acc: 0.458 Test Loss: 35.972 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.873474359512329
Epoch: 12, Steps: 32 | Train Loss: 0.440 Vali Loss: 37.850 Vali Acc: 0.511 Test Loss: 37.850 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.164962768554688
Epoch: 13, Steps: 32 | Train Loss: 1.157 Vali Loss: 29.509 Vali Acc: 0.405 Test Loss: 29.509 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.888107538223267
Epoch: 14, Steps: 32 | Train Loss: 5.528 Vali Loss: 33.106 Vali Acc: 0.443 Test Loss: 33.106 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.909981727600098
Epoch: 15, Steps: 32 | Train Loss: 0.128 Vali Loss: 42.798 Vali Acc: 0.511 Test Loss: 42.798 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.21875286102295
Epoch: 16, Steps: 32 | Train Loss: 0.276 Vali Loss: 41.460 Vali Acc: 0.550 Test Loss: 41.460 Test Acc: 0.550
Validation loss decreased (-0.526503 --> -0.549204).  Saving model ...
Epoch: 17 cost time: 13.135233163833618
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.119 Vali Acc: 0.511 Test Loss: 37.119 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.4224112033844
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.119 Vali Acc: 0.534 Test Loss: 37.119 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.977676630020142
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.83438515663147
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.813258647918701
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.758472204208374
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.315398454666138
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.885042190551758
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.882337093353271
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.924996614456177
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.115 Vali Acc: 0.534 Test Loss: 37.115 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 15737269
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.354292392730713
Epoch: 1, Steps: 32 | Train Loss: 8.814 Vali Loss: 27.594 Vali Acc: 0.168 Test Loss: 27.594 Test Acc: 0.168
Validation loss decreased (inf --> -0.167663).  Saving model ...
Epoch: 2 cost time: 13.355159521102905
Epoch: 2, Steps: 32 | Train Loss: 13.616 Vali Loss: 12.634 Vali Acc: 0.206 Test Loss: 12.634 Test Acc: 0.206
Validation loss decreased (-0.167663 --> -0.205981).  Saving model ...
Epoch: 3 cost time: 13.051535844802856
Epoch: 3, Steps: 32 | Train Loss: 7.269 Vali Loss: 13.510 Vali Acc: 0.420 Test Loss: 13.510 Test Acc: 0.420
Validation loss decreased (-0.205981 --> -0.419712).  Saving model ...
Epoch: 4 cost time: 12.880175352096558
Epoch: 4, Steps: 32 | Train Loss: 3.245 Vali Loss: 17.829 Vali Acc: 0.344 Test Loss: 17.829 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.037827491760254
Epoch: 5, Steps: 32 | Train Loss: 2.633 Vali Loss: 20.787 Vali Acc: 0.504 Test Loss: 20.787 Test Acc: 0.504
Validation loss decreased (-0.419712 --> -0.503609).  Saving model ...
Epoch: 6 cost time: 13.007325887680054
Epoch: 6, Steps: 32 | Train Loss: 1.984 Vali Loss: 25.308 Vali Acc: 0.427 Test Loss: 25.308 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.958049774169922
Epoch: 7, Steps: 32 | Train Loss: 1.982 Vali Loss: 32.611 Vali Acc: 0.351 Test Loss: 32.611 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.260111808776855
Epoch: 8, Steps: 32 | Train Loss: 1.460 Vali Loss: 30.864 Vali Acc: 0.504 Test Loss: 30.864 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.456740379333496
Epoch: 9, Steps: 32 | Train Loss: 2.690 Vali Loss: 35.799 Vali Acc: 0.336 Test Loss: 35.799 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.904876947402954
Epoch: 10, Steps: 32 | Train Loss: 12.944 Vali Loss: 25.580 Vali Acc: 0.420 Test Loss: 25.580 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.78981351852417
Epoch: 11, Steps: 32 | Train Loss: 0.375 Vali Loss: 31.324 Vali Acc: 0.176 Test Loss: 31.324 Test Acc: 0.176
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.892648935317993
Epoch: 12, Steps: 32 | Train Loss: 1.929 Vali Loss: 33.402 Vali Acc: 0.527 Test Loss: 33.402 Test Acc: 0.527
Validation loss decreased (-0.503609 --> -0.526384).  Saving model ...
Epoch: 13 cost time: 12.547917127609253
Epoch: 13, Steps: 32 | Train Loss: 0.507 Vali Loss: 26.927 Vali Acc: 0.496 Test Loss: 26.927 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.814036130905151
Epoch: 14, Steps: 32 | Train Loss: 0.010 Vali Loss: 32.472 Vali Acc: 0.336 Test Loss: 32.472 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.818483829498291
Epoch: 15, Steps: 32 | Train Loss: 0.928 Vali Loss: 32.953 Vali Acc: 0.389 Test Loss: 32.953 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.012665271759033
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 33.805 Vali Acc: 0.527 Test Loss: 33.805 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.830053567886353
Epoch: 17, Steps: 32 | Train Loss: 0.200 Vali Loss: 33.977 Vali Acc: 0.405 Test Loss: 33.977 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.260929822921753
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.190 Vali Acc: 0.481 Test Loss: 30.190 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.953840732574463
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.335 Vali Acc: 0.466 Test Loss: 30.335 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.235339403152466
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.370 Vali Acc: 0.466 Test Loss: 30.370 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.991209745407104
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.370 Vali Acc: 0.466 Test Loss: 30.370 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.906826496124268
Epoch: 22, Steps: 32 | Train Loss: 0.074 Vali Loss: 45.931 Vali Acc: 0.359 Test Loss: 45.931 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 15065525
model size : 75.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.109527587890625
Epoch: 1, Steps: 32 | Train Loss: 8.676 Vali Loss: 8.773 Vali Acc: 0.420 Test Loss: 8.773 Test Acc: 0.420
Validation loss decreased (inf --> -0.419760).  Saving model ...
Epoch: 2 cost time: 12.989670753479004
Epoch: 2, Steps: 32 | Train Loss: 19.905 Vali Loss: 13.594 Vali Acc: 0.374 Test Loss: 13.594 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.217627763748169
Epoch: 3, Steps: 32 | Train Loss: 10.175 Vali Loss: 17.842 Vali Acc: 0.267 Test Loss: 17.842 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.986720561981201
Epoch: 4, Steps: 32 | Train Loss: 3.720 Vali Loss: 13.952 Vali Acc: 0.427 Test Loss: 13.952 Test Acc: 0.427
Validation loss decreased (-0.419760 --> -0.427341).  Saving model ...
Epoch: 5 cost time: 13.339823961257935
Epoch: 5, Steps: 32 | Train Loss: 4.549 Vali Loss: 17.324 Vali Acc: 0.374 Test Loss: 17.324 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.943012475967407
Epoch: 6, Steps: 32 | Train Loss: 1.249 Vali Loss: 20.134 Vali Acc: 0.443 Test Loss: 20.134 Test Acc: 0.443
Validation loss decreased (-0.427341 --> -0.442547).  Saving model ...
Epoch: 7 cost time: 12.931461811065674
Epoch: 7, Steps: 32 | Train Loss: 0.935 Vali Loss: 24.223 Vali Acc: 0.450 Test Loss: 24.223 Test Acc: 0.450
Validation loss decreased (-0.442547 --> -0.450139).  Saving model ...
Epoch: 8 cost time: 12.665486574172974
Epoch: 8, Steps: 32 | Train Loss: 0.629 Vali Loss: 24.834 Vali Acc: 0.481 Test Loss: 24.834 Test Acc: 0.481
Validation loss decreased (-0.450139 --> -0.480668).  Saving model ...
Epoch: 9 cost time: 12.881414890289307
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.353 Vali Acc: 0.496 Test Loss: 25.353 Test Acc: 0.496
Validation loss decreased (-0.480668 --> -0.495930).  Saving model ...
Epoch: 10 cost time: 12.948613166809082
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.343 Vali Acc: 0.489 Test Loss: 24.343 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.977141857147217
Epoch: 11, Steps: 32 | Train Loss: 0.497 Vali Loss: 29.416 Vali Acc: 0.435 Test Loss: 29.416 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.560773611068726
Epoch: 12, Steps: 32 | Train Loss: 0.081 Vali Loss: 37.977 Vali Acc: 0.412 Test Loss: 37.977 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.91427493095398
Epoch: 13, Steps: 32 | Train Loss: 0.513 Vali Loss: 35.897 Vali Acc: 0.366 Test Loss: 35.897 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.807857751846313
Epoch: 14, Steps: 32 | Train Loss: 2.008 Vali Loss: 29.997 Vali Acc: 0.496 Test Loss: 29.997 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.986438989639282
Epoch: 15, Steps: 32 | Train Loss: 2.111 Vali Loss: 38.952 Vali Acc: 0.405 Test Loss: 38.952 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.052101135253906
Epoch: 16, Steps: 32 | Train Loss: 5.281 Vali Loss: 36.075 Vali Acc: 0.405 Test Loss: 36.075 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.90826964378357
Epoch: 17, Steps: 32 | Train Loss: 7.145 Vali Loss: 40.964 Vali Acc: 0.198 Test Loss: 40.964 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.904500484466553
Epoch: 18, Steps: 32 | Train Loss: 17.378 Vali Loss: 38.305 Vali Acc: 0.313 Test Loss: 38.305 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.982500076293945
Epoch: 19, Steps: 32 | Train Loss: 27.862 Vali Loss: 36.108 Vali Acc: 0.237 Test Loss: 36.108 Test Acc: 0.237
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 14393781
model size : 72.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.874861001968384
Epoch: 1, Steps: 32 | Train Loss: 7.520 Vali Loss: 10.563 Vali Acc: 0.420 Test Loss: 10.563 Test Acc: 0.420
Validation loss decreased (inf --> -0.419742).  Saving model ...
Epoch: 2 cost time: 12.638856887817383
Epoch: 2, Steps: 32 | Train Loss: 18.897 Vali Loss: 20.974 Vali Acc: 0.168 Test Loss: 20.974 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.680944442749023
Epoch: 3, Steps: 32 | Train Loss: 13.951 Vali Loss: 14.532 Vali Acc: 0.389 Test Loss: 14.532 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.675417423248291
Epoch: 4, Steps: 32 | Train Loss: 4.026 Vali Loss: 14.702 Vali Acc: 0.527 Test Loss: 14.702 Test Acc: 0.527
Validation loss decreased (-0.419742 --> -0.526571).  Saving model ...
Epoch: 5 cost time: 12.60159707069397
Epoch: 5, Steps: 32 | Train Loss: 4.134 Vali Loss: 20.460 Vali Acc: 0.374 Test Loss: 20.460 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.581817388534546
Epoch: 6, Steps: 32 | Train Loss: 2.457 Vali Loss: 21.880 Vali Acc: 0.344 Test Loss: 21.880 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.850995063781738
Epoch: 7, Steps: 32 | Train Loss: 2.077 Vali Loss: 29.444 Vali Acc: 0.282 Test Loss: 29.444 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.849007606506348
Epoch: 8, Steps: 32 | Train Loss: 2.245 Vali Loss: 27.977 Vali Acc: 0.344 Test Loss: 27.977 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.54573106765747
Epoch: 9, Steps: 32 | Train Loss: 1.297 Vali Loss: 26.937 Vali Acc: 0.427 Test Loss: 26.937 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.629101276397705
Epoch: 10, Steps: 32 | Train Loss: 0.274 Vali Loss: 26.219 Vali Acc: 0.427 Test Loss: 26.219 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.30871844291687
Epoch: 11, Steps: 32 | Train Loss: 0.545 Vali Loss: 26.308 Vali Acc: 0.412 Test Loss: 26.308 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.077492713928223
Epoch: 12, Steps: 32 | Train Loss: 0.100 Vali Loss: 38.173 Vali Acc: 0.542 Test Loss: 38.173 Test Acc: 0.542
Validation loss decreased (-0.526571 --> -0.541603).  Saving model ...
Epoch: 13 cost time: 12.547131776809692
Epoch: 13, Steps: 32 | Train Loss: 1.598 Vali Loss: 29.718 Vali Acc: 0.427 Test Loss: 29.718 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.416216850280762
Epoch: 14, Steps: 32 | Train Loss: 38.611 Vali Loss: 33.930 Vali Acc: 0.244 Test Loss: 33.930 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.612982988357544
Epoch: 15, Steps: 32 | Train Loss: 28.780 Vali Loss: 22.435 Vali Acc: 0.420 Test Loss: 22.435 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.719337224960327
Epoch: 16, Steps: 32 | Train Loss: 30.631 Vali Loss: 24.105 Vali Acc: 0.412 Test Loss: 24.105 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.955036401748657
Epoch: 17, Steps: 32 | Train Loss: 37.555 Vali Loss: 56.485 Vali Acc: 0.176 Test Loss: 56.485 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.630561828613281
Epoch: 18, Steps: 32 | Train Loss: 22.109 Vali Loss: 28.694 Vali Acc: 0.198 Test Loss: 28.694 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.429104566574097
Epoch: 19, Steps: 32 | Train Loss: 11.340 Vali Loss: 10.251 Vali Acc: 0.374 Test Loss: 10.251 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.522144079208374
Epoch: 20, Steps: 32 | Train Loss: 16.142 Vali Loss: 28.049 Vali Acc: 0.099 Test Loss: 28.049 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.39939284324646
Epoch: 21, Steps: 32 | Train Loss: 16.415 Vali Loss: 21.395 Vali Acc: 0.130 Test Loss: 21.395 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.423750638961792
Epoch: 22, Steps: 32 | Train Loss: 17.780 Vali Loss: 26.782 Vali Acc: 0.176 Test Loss: 26.782 Test Acc: 0.176
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 13722037
model size : 70.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.165559530258179
Epoch: 1, Steps: 32 | Train Loss: 5.442 Vali Loss: 9.440 Vali Acc: 0.137 Test Loss: 9.440 Test Acc: 0.137
Validation loss decreased (inf --> -0.137310).  Saving model ...
Epoch: 2 cost time: 11.943749189376831
Epoch: 2, Steps: 32 | Train Loss: 7.520 Vali Loss: 5.975 Vali Acc: 0.443 Test Loss: 5.975 Test Acc: 0.443
Validation loss decreased (-0.137310 --> -0.442688).  Saving model ...
Epoch: 3 cost time: 11.893483638763428
Epoch: 3, Steps: 32 | Train Loss: 4.862 Vali Loss: 11.177 Vali Acc: 0.290 Test Loss: 11.177 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.12112832069397
Epoch: 4, Steps: 32 | Train Loss: 3.185 Vali Loss: 11.814 Vali Acc: 0.458 Test Loss: 11.814 Test Acc: 0.458
Validation loss decreased (-0.442688 --> -0.457897).  Saving model ...
Epoch: 5 cost time: 12.3708176612854
Epoch: 5, Steps: 32 | Train Loss: 1.077 Vali Loss: 14.130 Vali Acc: 0.412 Test Loss: 14.130 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.399141550064087
Epoch: 6, Steps: 32 | Train Loss: 1.194 Vali Loss: 15.522 Vali Acc: 0.290 Test Loss: 15.522 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.309734344482422
Epoch: 7, Steps: 32 | Train Loss: 0.528 Vali Loss: 13.619 Vali Acc: 0.443 Test Loss: 13.619 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.243710994720459
Epoch: 8, Steps: 32 | Train Loss: 0.710 Vali Loss: 11.976 Vali Acc: 0.443 Test Loss: 11.976 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.2060387134552
Epoch: 9, Steps: 32 | Train Loss: 0.404 Vali Loss: 20.481 Vali Acc: 0.336 Test Loss: 20.481 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.17517900466919
Epoch: 10, Steps: 32 | Train Loss: 1.229 Vali Loss: 16.129 Vali Acc: 0.435 Test Loss: 16.129 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.10950493812561
Epoch: 11, Steps: 32 | Train Loss: 1.305 Vali Loss: 30.567 Vali Acc: 0.267 Test Loss: 30.567 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.029591083526611
Epoch: 12, Steps: 32 | Train Loss: 0.461 Vali Loss: 21.848 Vali Acc: 0.489 Test Loss: 21.848 Test Acc: 0.489
Validation loss decreased (-0.457897 --> -0.488331).  Saving model ...
Epoch: 13 cost time: 12.306623458862305
Epoch: 13, Steps: 32 | Train Loss: 0.900 Vali Loss: 19.730 Vali Acc: 0.458 Test Loss: 19.730 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.195032119750977
Epoch: 14, Steps: 32 | Train Loss: 1.744 Vali Loss: 18.907 Vali Acc: 0.466 Test Loss: 18.907 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.176455974578857
Epoch: 15, Steps: 32 | Train Loss: 1.984 Vali Loss: 20.284 Vali Acc: 0.466 Test Loss: 20.284 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.522548198699951
Epoch: 16, Steps: 32 | Train Loss: 0.295 Vali Loss: 22.787 Vali Acc: 0.397 Test Loss: 22.787 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.055515766143799
Epoch: 17, Steps: 32 | Train Loss: 0.797 Vali Loss: 24.895 Vali Acc: 0.420 Test Loss: 24.895 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.092586278915405
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.340 Vali Acc: 0.466 Test Loss: 25.340 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.157581806182861
Epoch: 19, Steps: 32 | Train Loss: 0.305 Vali Loss: 27.164 Vali Acc: 0.443 Test Loss: 27.164 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.149240255355835
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.940 Vali Acc: 0.435 Test Loss: 28.940 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.01047968864441
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.984 Vali Acc: 0.420 Test Loss: 28.984 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.21106767654419
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.986 Vali Acc: 0.420 Test Loss: 28.986 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 7646005
model size : 38.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.332723617553711
Epoch: 1, Steps: 32 | Train Loss: 5.673 Vali Loss: 8.688 Vali Acc: 0.168 Test Loss: 8.688 Test Acc: 0.168
Validation loss decreased (inf --> -0.167852).  Saving model ...
Epoch: 2 cost time: 12.089329481124878
Epoch: 2, Steps: 32 | Train Loss: 12.115 Vali Loss: 8.011 Vali Acc: 0.252 Test Loss: 8.011 Test Acc: 0.252
Validation loss decreased (-0.167852 --> -0.251828).  Saving model ...
Epoch: 3 cost time: 12.050102472305298
Epoch: 3, Steps: 32 | Train Loss: 5.343 Vali Loss: 6.792 Vali Acc: 0.344 Test Loss: 6.792 Test Acc: 0.344
Validation loss decreased (-0.251828 --> -0.343444).  Saving model ...
Epoch: 4 cost time: 12.222796440124512
Epoch: 4, Steps: 32 | Train Loss: 2.494 Vali Loss: 15.826 Vali Acc: 0.282 Test Loss: 15.826 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.923802137374878
Epoch: 5, Steps: 32 | Train Loss: 0.501 Vali Loss: 10.361 Vali Acc: 0.466 Test Loss: 10.361 Test Acc: 0.466
Validation loss decreased (-0.343444 --> -0.465545).  Saving model ...
Epoch: 6 cost time: 11.888953685760498
Epoch: 6, Steps: 32 | Train Loss: 0.595 Vali Loss: 12.781 Vali Acc: 0.389 Test Loss: 12.781 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.084292650222778
Epoch: 7, Steps: 32 | Train Loss: 0.312 Vali Loss: 11.452 Vali Acc: 0.458 Test Loss: 11.452 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.210283994674683
Epoch: 8, Steps: 32 | Train Loss: 0.454 Vali Loss: 12.428 Vali Acc: 0.481 Test Loss: 12.428 Test Acc: 0.481
Validation loss decreased (-0.465545 --> -0.480792).  Saving model ...
Epoch: 9 cost time: 12.009907245635986
Epoch: 9, Steps: 32 | Train Loss: 0.276 Vali Loss: 13.998 Vali Acc: 0.466 Test Loss: 13.998 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.943061828613281
Epoch: 10, Steps: 32 | Train Loss: 0.570 Vali Loss: 14.157 Vali Acc: 0.389 Test Loss: 14.157 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.985602855682373
Epoch: 11, Steps: 32 | Train Loss: 0.326 Vali Loss: 17.101 Vali Acc: 0.389 Test Loss: 17.101 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.056074380874634
Epoch: 12, Steps: 32 | Train Loss: 0.836 Vali Loss: 17.127 Vali Acc: 0.450 Test Loss: 17.127 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.048351049423218
Epoch: 13, Steps: 32 | Train Loss: 0.866 Vali Loss: 20.898 Vali Acc: 0.382 Test Loss: 20.898 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.12621283531189
Epoch: 14, Steps: 32 | Train Loss: 0.474 Vali Loss: 18.096 Vali Acc: 0.511 Test Loss: 18.096 Test Acc: 0.511
Validation loss decreased (-0.480792 --> -0.511269).  Saving model ...
Epoch: 15 cost time: 12.349102258682251
Epoch: 15, Steps: 32 | Train Loss: 0.409 Vali Loss: 19.498 Vali Acc: 0.382 Test Loss: 19.498 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.051932334899902
Epoch: 16, Steps: 32 | Train Loss: 1.492 Vali Loss: 18.445 Vali Acc: 0.405 Test Loss: 18.445 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.904427289962769
Epoch: 17, Steps: 32 | Train Loss: 0.298 Vali Loss: 21.766 Vali Acc: 0.443 Test Loss: 21.766 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.03457260131836
Epoch: 18, Steps: 32 | Train Loss: 0.388 Vali Loss: 24.929 Vali Acc: 0.496 Test Loss: 24.929 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.47659945487976
Epoch: 19, Steps: 32 | Train Loss: 1.435 Vali Loss: 24.671 Vali Acc: 0.366 Test Loss: 24.671 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.958499193191528
Epoch: 20, Steps: 32 | Train Loss: 0.358 Vali Loss: 28.102 Vali Acc: 0.473 Test Loss: 28.102 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.222974061965942
Epoch: 21, Steps: 32 | Train Loss: 0.362 Vali Loss: 25.157 Vali Acc: 0.458 Test Loss: 25.157 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.17220687866211
Epoch: 22, Steps: 32 | Train Loss: 0.369 Vali Loss: 28.560 Vali Acc: 0.496 Test Loss: 28.560 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.145659446716309
Epoch: 23, Steps: 32 | Train Loss: 0.121 Vali Loss: 29.089 Vali Acc: 0.519 Test Loss: 29.089 Test Acc: 0.519
Validation loss decreased (-0.511269 --> -0.518793).  Saving model ...
Epoch: 24 cost time: 11.869138240814209
Epoch: 24, Steps: 32 | Train Loss: 0.291 Vali Loss: 32.332 Vali Acc: 0.389 Test Loss: 32.332 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 12.479960441589355
Epoch: 25, Steps: 32 | Train Loss: 0.217 Vali Loss: 31.259 Vali Acc: 0.397 Test Loss: 31.259 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 12.183729648590088
Epoch: 26, Steps: 32 | Train Loss: 0.016 Vali Loss: 39.166 Vali Acc: 0.527 Test Loss: 39.166 Test Acc: 0.527
Validation loss decreased (-0.518793 --> -0.526326).  Saving model ...
Epoch: 27 cost time: 12.24416184425354
Epoch: 27, Steps: 32 | Train Loss: 0.381 Vali Loss: 33.712 Vali Acc: 0.489 Test Loss: 33.712 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 12.170369148254395
Epoch: 28, Steps: 32 | Train Loss: 0.021 Vali Loss: 35.376 Vali Acc: 0.504 Test Loss: 35.376 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.103296041488647
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.451 Vali Acc: 0.504 Test Loss: 35.451 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.727690935134888
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.460 Vali Acc: 0.504 Test Loss: 35.460 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 11.970034122467041
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.461 Vali Acc: 0.504 Test Loss: 35.461 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 12.141131162643433
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.461 Vali Acc: 0.504 Test Loss: 35.461 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 12.047144889831543
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.461 Vali Acc: 0.504 Test Loss: 35.461 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 12.596190690994263
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.461 Vali Acc: 0.504 Test Loss: 35.461 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 12.450313568115234
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.460 Vali Acc: 0.504 Test Loss: 35.460 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 12.524771451950073
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 35.460 Vali Acc: 0.504 Test Loss: 35.460 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 7310133
model size : 36.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.51973557472229
Epoch: 1, Steps: 32 | Train Loss: 5.534 Vali Loss: 6.399 Vali Acc: 0.137 Test Loss: 6.399 Test Acc: 0.137
Validation loss decreased (inf --> -0.137341).  Saving model ...
Epoch: 2 cost time: 12.296775102615356
Epoch: 2, Steps: 32 | Train Loss: 7.065 Vali Loss: 15.648 Vali Acc: 0.137 Test Loss: 15.648 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.547831058502197
Epoch: 3, Steps: 32 | Train Loss: 5.808 Vali Loss: 5.326 Vali Acc: 0.450 Test Loss: 5.326 Test Acc: 0.450
Validation loss decreased (-0.137341 --> -0.450328).  Saving model ...
Epoch: 4 cost time: 12.292548179626465
Epoch: 4, Steps: 32 | Train Loss: 1.854 Vali Loss: 10.905 Vali Acc: 0.496 Test Loss: 10.905 Test Acc: 0.496
Validation loss decreased (-0.450328 --> -0.496074).  Saving model ...
Epoch: 5 cost time: 12.547363996505737
Epoch: 5, Steps: 32 | Train Loss: 0.852 Vali Loss: 12.263 Vali Acc: 0.366 Test Loss: 12.263 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.156406164169312
Epoch: 6, Steps: 32 | Train Loss: 1.022 Vali Loss: 15.962 Vali Acc: 0.458 Test Loss: 15.962 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.298110723495483
Epoch: 7, Steps: 32 | Train Loss: 0.784 Vali Loss: 14.304 Vali Acc: 0.458 Test Loss: 14.304 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.499585390090942
Epoch: 8, Steps: 32 | Train Loss: 0.692 Vali Loss: 12.732 Vali Acc: 0.435 Test Loss: 12.732 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.520831823348999
Epoch: 9, Steps: 32 | Train Loss: 0.313 Vali Loss: 20.930 Vali Acc: 0.298 Test Loss: 20.930 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.611324071884155
Epoch: 10, Steps: 32 | Train Loss: 0.544 Vali Loss: 18.490 Vali Acc: 0.366 Test Loss: 18.490 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.423814535140991
Epoch: 11, Steps: 32 | Train Loss: 0.354 Vali Loss: 21.665 Vali Acc: 0.389 Test Loss: 21.665 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.576127767562866
Epoch: 12, Steps: 32 | Train Loss: 0.195 Vali Loss: 20.586 Vali Acc: 0.519 Test Loss: 20.586 Test Acc: 0.519
Validation loss decreased (-0.496074 --> -0.518878).  Saving model ...
Epoch: 13 cost time: 12.297629117965698
Epoch: 13, Steps: 32 | Train Loss: 0.201 Vali Loss: 22.095 Vali Acc: 0.527 Test Loss: 22.095 Test Acc: 0.527
Validation loss decreased (-0.518878 --> -0.526497).  Saving model ...
Epoch: 14 cost time: 13.003363370895386
Epoch: 14, Steps: 32 | Train Loss: 0.130 Vali Loss: 17.764 Vali Acc: 0.427 Test Loss: 17.764 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.45018458366394
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.761 Vali Acc: 0.473 Test Loss: 19.761 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.710438966751099
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.694 Vali Acc: 0.473 Test Loss: 19.694 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.386274576187134
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.319805145263672
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.05040192604065
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.703622579574585
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.060441255569458
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.103548288345337
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.813382863998413
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.691 Vali Acc: 0.473 Test Loss: 19.691 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 6974261
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.814530611038208
Epoch: 1, Steps: 32 | Train Loss: 6.250 Vali Loss: 7.373 Vali Acc: 0.420 Test Loss: 7.373 Test Acc: 0.420
Validation loss decreased (inf --> -0.419774).  Saving model ...
Epoch: 2 cost time: 11.685657739639282
Epoch: 2, Steps: 32 | Train Loss: 8.691 Vali Loss: 4.948 Vali Acc: 0.221 Test Loss: 4.948 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.385789155960083
Epoch: 3, Steps: 32 | Train Loss: 6.849 Vali Loss: 7.378 Vali Acc: 0.374 Test Loss: 7.378 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.510144710540771
Epoch: 4, Steps: 32 | Train Loss: 1.997 Vali Loss: 9.624 Vali Acc: 0.374 Test Loss: 9.624 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.735924243927002
Epoch: 5, Steps: 32 | Train Loss: 1.240 Vali Loss: 10.590 Vali Acc: 0.527 Test Loss: 10.590 Test Acc: 0.527
Validation loss decreased (-0.419774 --> -0.526612).  Saving model ...
Epoch: 6 cost time: 11.39478588104248
Epoch: 6, Steps: 32 | Train Loss: 0.642 Vali Loss: 12.390 Vali Acc: 0.389 Test Loss: 12.390 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.514281034469604
Epoch: 7, Steps: 32 | Train Loss: 0.478 Vali Loss: 12.904 Vali Acc: 0.397 Test Loss: 12.904 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.457757949829102
Epoch: 8, Steps: 32 | Train Loss: 0.468 Vali Loss: 13.181 Vali Acc: 0.458 Test Loss: 13.181 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.684110641479492
Epoch: 9, Steps: 32 | Train Loss: 0.950 Vali Loss: 14.512 Vali Acc: 0.359 Test Loss: 14.512 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.220146656036377
Epoch: 10, Steps: 32 | Train Loss: 0.821 Vali Loss: 22.881 Vali Acc: 0.267 Test Loss: 22.881 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.360595703125
Epoch: 11, Steps: 32 | Train Loss: 0.804 Vali Loss: 20.752 Vali Acc: 0.489 Test Loss: 20.752 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.745782852172852
Epoch: 12, Steps: 32 | Train Loss: 1.269 Vali Loss: 16.393 Vali Acc: 0.313 Test Loss: 16.393 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.396285772323608
Epoch: 13, Steps: 32 | Train Loss: 0.333 Vali Loss: 19.784 Vali Acc: 0.511 Test Loss: 19.784 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.519435405731201
Epoch: 14, Steps: 32 | Train Loss: 0.446 Vali Loss: 29.684 Vali Acc: 0.221 Test Loss: 29.684 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.676690101623535
Epoch: 15, Steps: 32 | Train Loss: 1.633 Vali Loss: 27.974 Vali Acc: 0.534 Test Loss: 27.974 Test Acc: 0.534
Validation loss decreased (-0.526612 --> -0.534071).  Saving model ...
Epoch: 16 cost time: 11.509200811386108
Epoch: 16, Steps: 32 | Train Loss: 0.575 Vali Loss: 21.921 Vali Acc: 0.397 Test Loss: 21.921 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.400303840637207
Epoch: 17, Steps: 32 | Train Loss: 0.221 Vali Loss: 37.721 Vali Acc: 0.214 Test Loss: 37.721 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.607401609420776
Epoch: 18, Steps: 32 | Train Loss: 1.605 Vali Loss: 25.898 Vali Acc: 0.389 Test Loss: 25.898 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.826393842697144
Epoch: 19, Steps: 32 | Train Loss: 1.204 Vali Loss: 27.037 Vali Acc: 0.458 Test Loss: 27.037 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.572099208831787
Epoch: 20, Steps: 32 | Train Loss: 0.067 Vali Loss: 25.750 Vali Acc: 0.420 Test Loss: 25.750 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.702214241027832
Epoch: 21, Steps: 32 | Train Loss: 0.530 Vali Loss: 25.042 Vali Acc: 0.427 Test Loss: 25.042 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.827516794204712
Epoch: 22, Steps: 32 | Train Loss: 0.778 Vali Loss: 33.675 Vali Acc: 0.344 Test Loss: 33.675 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.587600469589233
Epoch: 23, Steps: 32 | Train Loss: 0.425 Vali Loss: 23.549 Vali Acc: 0.458 Test Loss: 23.549 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 11.381246328353882
Epoch: 24, Steps: 32 | Train Loss: 0.699 Vali Loss: 27.848 Vali Acc: 0.481 Test Loss: 27.848 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.487241506576538
Epoch: 25, Steps: 32 | Train Loss: 0.565 Vali Loss: 29.112 Vali Acc: 0.443 Test Loss: 29.112 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6638389
model size : 34.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.865203619003296
Epoch: 1, Steps: 32 | Train Loss: 5.131 Vali Loss: 6.258 Vali Acc: 0.420 Test Loss: 6.258 Test Acc: 0.420
Validation loss decreased (inf --> -0.419785).  Saving model ...
Epoch: 2 cost time: 11.923459768295288
Epoch: 2, Steps: 32 | Train Loss: 7.411 Vali Loss: 10.090 Vali Acc: 0.206 Test Loss: 10.090 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.095969676971436
Epoch: 3, Steps: 32 | Train Loss: 5.581 Vali Loss: 11.310 Vali Acc: 0.481 Test Loss: 11.310 Test Acc: 0.481
Validation loss decreased (-0.419785 --> -0.480803).  Saving model ...
Epoch: 4 cost time: 11.909156799316406
Epoch: 4, Steps: 32 | Train Loss: 3.392 Vali Loss: 13.559 Vali Acc: 0.504 Test Loss: 13.559 Test Acc: 0.504
Validation loss decreased (-0.480803 --> -0.503681).  Saving model ...
Epoch: 5 cost time: 11.871347904205322
Epoch: 5, Steps: 32 | Train Loss: 2.425 Vali Loss: 16.459 Vali Acc: 0.351 Test Loss: 16.459 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.938779354095459
Epoch: 6, Steps: 32 | Train Loss: 1.084 Vali Loss: 12.132 Vali Acc: 0.489 Test Loss: 12.132 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.113169193267822
Epoch: 7, Steps: 32 | Train Loss: 1.462 Vali Loss: 13.030 Vali Acc: 0.511 Test Loss: 13.030 Test Acc: 0.511
Validation loss decreased (-0.503681 --> -0.511320).  Saving model ...
Epoch: 8 cost time: 11.92299485206604
Epoch: 8, Steps: 32 | Train Loss: 0.662 Vali Loss: 14.946 Vali Acc: 0.550 Test Loss: 14.946 Test Acc: 0.550
Validation loss decreased (-0.511320 --> -0.549469).  Saving model ...
Epoch: 9 cost time: 12.071757078170776
Epoch: 9, Steps: 32 | Train Loss: 0.451 Vali Loss: 16.424 Vali Acc: 0.412 Test Loss: 16.424 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.495633602142334
Epoch: 10, Steps: 32 | Train Loss: 0.035 Vali Loss: 14.823 Vali Acc: 0.519 Test Loss: 14.823 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.081871509552002
Epoch: 11, Steps: 32 | Train Loss: 0.318 Vali Loss: 16.315 Vali Acc: 0.519 Test Loss: 16.315 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.84634804725647
Epoch: 12, Steps: 32 | Train Loss: 0.480 Vali Loss: 14.189 Vali Acc: 0.519 Test Loss: 14.189 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.898437261581421
Epoch: 13, Steps: 32 | Train Loss: 0.030 Vali Loss: 18.063 Vali Acc: 0.382 Test Loss: 18.063 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.890073776245117
Epoch: 14, Steps: 32 | Train Loss: 0.130 Vali Loss: 15.751 Vali Acc: 0.527 Test Loss: 15.751 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.974318742752075
Epoch: 15, Steps: 32 | Train Loss: 0.239 Vali Loss: 15.121 Vali Acc: 0.466 Test Loss: 15.121 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.043904781341553
Epoch: 16, Steps: 32 | Train Loss: 0.632 Vali Loss: 18.802 Vali Acc: 0.511 Test Loss: 18.802 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.874373435974121
Epoch: 17, Steps: 32 | Train Loss: 1.018 Vali Loss: 21.601 Vali Acc: 0.458 Test Loss: 21.601 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.905418872833252
Epoch: 18, Steps: 32 | Train Loss: 1.370 Vali Loss: 23.087 Vali Acc: 0.450 Test Loss: 23.087 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6724917
model size : 34.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.737505674362183
Epoch: 1, Steps: 32 | Train Loss: 4.525 Vali Loss: 6.365 Vali Acc: 0.168 Test Loss: 6.365 Test Acc: 0.168
Validation loss decreased (inf --> -0.167875).  Saving model ...
Epoch: 2 cost time: 11.851537942886353
Epoch: 2, Steps: 32 | Train Loss: 8.660 Vali Loss: 5.409 Vali Acc: 0.489 Test Loss: 5.409 Test Acc: 0.489
Validation loss decreased (-0.167875 --> -0.488496).  Saving model ...
Epoch: 3 cost time: 11.772294998168945
Epoch: 3, Steps: 32 | Train Loss: 5.060 Vali Loss: 12.719 Vali Acc: 0.237 Test Loss: 12.719 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.807834148406982
Epoch: 4, Steps: 32 | Train Loss: 3.342 Vali Loss: 11.342 Vali Acc: 0.420 Test Loss: 11.342 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.79587197303772
Epoch: 5, Steps: 32 | Train Loss: 1.628 Vali Loss: 15.763 Vali Acc: 0.443 Test Loss: 15.763 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.608140468597412
Epoch: 6, Steps: 32 | Train Loss: 1.106 Vali Loss: 15.424 Vali Acc: 0.511 Test Loss: 15.424 Test Acc: 0.511
Validation loss decreased (-0.488496 --> -0.511296).  Saving model ...
Epoch: 7 cost time: 11.825242757797241
Epoch: 7, Steps: 32 | Train Loss: 0.255 Vali Loss: 12.818 Vali Acc: 0.481 Test Loss: 12.818 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.655860185623169
Epoch: 8, Steps: 32 | Train Loss: 0.488 Vali Loss: 15.394 Vali Acc: 0.489 Test Loss: 15.394 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.974931240081787
Epoch: 9, Steps: 32 | Train Loss: 0.157 Vali Loss: 15.924 Vali Acc: 0.466 Test Loss: 15.924 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.595714569091797
Epoch: 10, Steps: 32 | Train Loss: 0.053 Vali Loss: 20.002 Vali Acc: 0.473 Test Loss: 20.002 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.883409261703491
Epoch: 11, Steps: 32 | Train Loss: 0.092 Vali Loss: 17.041 Vali Acc: 0.420 Test Loss: 17.041 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.57594108581543
Epoch: 12, Steps: 32 | Train Loss: 0.419 Vali Loss: 19.515 Vali Acc: 0.504 Test Loss: 19.515 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.810175895690918
Epoch: 13, Steps: 32 | Train Loss: 0.121 Vali Loss: 20.372 Vali Acc: 0.412 Test Loss: 20.372 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.625899076461792
Epoch: 14, Steps: 32 | Train Loss: 0.391 Vali Loss: 23.623 Vali Acc: 0.473 Test Loss: 23.623 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.682166814804077
Epoch: 15, Steps: 32 | Train Loss: 0.774 Vali Loss: 21.130 Vali Acc: 0.534 Test Loss: 21.130 Test Acc: 0.534
Validation loss decreased (-0.511296 --> -0.534140).  Saving model ...
Epoch: 16 cost time: 12.112390279769897
Epoch: 16, Steps: 32 | Train Loss: 0.327 Vali Loss: 22.817 Vali Acc: 0.504 Test Loss: 22.817 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.579741954803467
Epoch: 17, Steps: 32 | Train Loss: 0.425 Vali Loss: 20.224 Vali Acc: 0.435 Test Loss: 20.224 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.70670747756958
Epoch: 18, Steps: 32 | Train Loss: 0.379 Vali Loss: 27.028 Vali Acc: 0.550 Test Loss: 27.028 Test Acc: 0.550
Validation loss decreased (-0.534140 --> -0.549348).  Saving model ...
Epoch: 19 cost time: 11.848923444747925
Epoch: 19, Steps: 32 | Train Loss: 1.029 Vali Loss: 30.006 Vali Acc: 0.519 Test Loss: 30.006 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.769205331802368
Epoch: 20, Steps: 32 | Train Loss: 0.994 Vali Loss: 29.068 Vali Acc: 0.397 Test Loss: 29.068 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.944642305374146
Epoch: 21, Steps: 32 | Train Loss: 1.823 Vali Loss: 34.593 Vali Acc: 0.489 Test Loss: 34.593 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.830811500549316
Epoch: 22, Steps: 32 | Train Loss: 0.091 Vali Loss: 40.596 Vali Acc: 0.481 Test Loss: 40.596 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 12.000406265258789
Epoch: 23, Steps: 32 | Train Loss: 0.922 Vali Loss: 31.418 Vali Acc: 0.405 Test Loss: 31.418 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.688708543777466
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.232 Vali Acc: 0.405 Test Loss: 31.232 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.605716466903687
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.227 Vali Acc: 0.405 Test Loss: 31.227 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.094255924224854
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.227 Vali Acc: 0.405 Test Loss: 31.227 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.596560716629028
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.227 Vali Acc: 0.405 Test Loss: 31.227 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.674724817276001
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.227 Vali Acc: 0.405 Test Loss: 31.227 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6389045
model size : 33.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.13871431350708
Epoch: 1, Steps: 32 | Train Loss: 4.316 Vali Loss: 6.103 Vali Acc: 0.137 Test Loss: 6.103 Test Acc: 0.137
Validation loss decreased (inf --> -0.137344).  Saving model ...
Epoch: 2 cost time: 11.420790672302246
Epoch: 2, Steps: 32 | Train Loss: 8.819 Vali Loss: 10.718 Vali Acc: 0.420 Test Loss: 10.718 Test Acc: 0.420
Validation loss decreased (-0.137344 --> -0.419740).  Saving model ...
Epoch: 3 cost time: 11.836276531219482
Epoch: 3, Steps: 32 | Train Loss: 4.645 Vali Loss: 7.386 Vali Acc: 0.481 Test Loss: 7.386 Test Acc: 0.481
Validation loss decreased (-0.419740 --> -0.480842).  Saving model ...
Epoch: 4 cost time: 11.639237642288208
Epoch: 4, Steps: 32 | Train Loss: 1.990 Vali Loss: 11.350 Vali Acc: 0.313 Test Loss: 11.350 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.676660060882568
Epoch: 5, Steps: 32 | Train Loss: 1.227 Vali Loss: 10.827 Vali Acc: 0.481 Test Loss: 10.827 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.627503633499146
Epoch: 6, Steps: 32 | Train Loss: 0.974 Vali Loss: 10.893 Vali Acc: 0.527 Test Loss: 10.893 Test Acc: 0.527
Validation loss decreased (-0.480842 --> -0.526609).  Saving model ...
Epoch: 7 cost time: 11.593968391418457
Epoch: 7, Steps: 32 | Train Loss: 0.819 Vali Loss: 12.033 Vali Acc: 0.496 Test Loss: 12.033 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.794790029525757
Epoch: 8, Steps: 32 | Train Loss: 0.239 Vali Loss: 14.050 Vali Acc: 0.397 Test Loss: 14.050 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.542943716049194
Epoch: 9, Steps: 32 | Train Loss: 0.683 Vali Loss: 18.201 Vali Acc: 0.298 Test Loss: 18.201 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.680635690689087
Epoch: 10, Steps: 32 | Train Loss: 1.242 Vali Loss: 19.990 Vali Acc: 0.397 Test Loss: 19.990 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.952423810958862
Epoch: 11, Steps: 32 | Train Loss: 0.016 Vali Loss: 19.463 Vali Acc: 0.489 Test Loss: 19.463 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.60909914970398
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.578 Vali Acc: 0.427 Test Loss: 19.578 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.676397562026978
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.600 Vali Acc: 0.427 Test Loss: 19.600 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.763690948486328
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.601 Vali Acc: 0.427 Test Loss: 19.601 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.711528778076172
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.601 Vali Acc: 0.427 Test Loss: 19.601 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.742021083831787
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.599 Vali Acc: 0.427 Test Loss: 19.599 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 6053173
model size : 32.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.184173107147217
Epoch: 1, Steps: 32 | Train Loss: 11.057 Vali Loss: 15.344 Vali Acc: 0.420 Test Loss: 15.344 Test Acc: 0.420
Validation loss decreased (inf --> -0.419694).  Saving model ...
Epoch: 2 cost time: 11.136613607406616
Epoch: 2, Steps: 32 | Train Loss: 11.615 Vali Loss: 11.234 Vali Acc: 0.412 Test Loss: 11.234 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.93788766860962
Epoch: 3, Steps: 32 | Train Loss: 6.833 Vali Loss: 9.657 Vali Acc: 0.229 Test Loss: 9.657 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.966197967529297
Epoch: 4, Steps: 32 | Train Loss: 3.481 Vali Loss: 11.623 Vali Acc: 0.328 Test Loss: 11.623 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.226356744766235
Epoch: 5, Steps: 32 | Train Loss: 1.241 Vali Loss: 12.825 Vali Acc: 0.534 Test Loss: 12.825 Test Acc: 0.534
Validation loss decreased (-0.419694 --> -0.534223).  Saving model ...
Epoch: 6 cost time: 11.0540771484375
Epoch: 6, Steps: 32 | Train Loss: 1.465 Vali Loss: 11.593 Vali Acc: 0.511 Test Loss: 11.593 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.009989023208618
Epoch: 7, Steps: 32 | Train Loss: 0.009 Vali Loss: 13.239 Vali Acc: 0.458 Test Loss: 13.239 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.24866509437561
Epoch: 8, Steps: 32 | Train Loss: 0.411 Vali Loss: 12.804 Vali Acc: 0.450 Test Loss: 12.804 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.382970571517944
Epoch: 9, Steps: 32 | Train Loss: 0.046 Vali Loss: 14.402 Vali Acc: 0.443 Test Loss: 14.402 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.021748781204224
Epoch: 10, Steps: 32 | Train Loss: 0.149 Vali Loss: 14.392 Vali Acc: 0.458 Test Loss: 14.392 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.234469175338745
Epoch: 11, Steps: 32 | Train Loss: 0.252 Vali Loss: 13.778 Vali Acc: 0.450 Test Loss: 13.778 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.939934968948364
Epoch: 12, Steps: 32 | Train Loss: 0.200 Vali Loss: 21.480 Vali Acc: 0.466 Test Loss: 21.480 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.019903898239136
Epoch: 13, Steps: 32 | Train Loss: 0.489 Vali Loss: 18.823 Vali Acc: 0.450 Test Loss: 18.823 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.168689727783203
Epoch: 14, Steps: 32 | Train Loss: 1.209 Vali Loss: 21.405 Vali Acc: 0.458 Test Loss: 21.405 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.187975406646729
Epoch: 15, Steps: 32 | Train Loss: 1.587 Vali Loss: 20.528 Vali Acc: 0.473 Test Loss: 20.528 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5717301
model size : 30.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.887614250183105
Epoch: 1, Steps: 32 | Train Loss: 4.040 Vali Loss: 5.232 Vali Acc: 0.137 Test Loss: 5.232 Test Acc: 0.137
Validation loss decreased (inf --> -0.137352).  Saving model ...
Epoch: 2 cost time: 11.73829197883606
Epoch: 2, Steps: 32 | Train Loss: 4.923 Vali Loss: 12.042 Vali Acc: 0.427 Test Loss: 12.042 Test Acc: 0.427
Validation loss decreased (-0.137352 --> -0.427360).  Saving model ...
Epoch: 3 cost time: 11.806293487548828
Epoch: 3, Steps: 32 | Train Loss: 7.270 Vali Loss: 16.150 Vali Acc: 0.275 Test Loss: 16.150 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.232287168502808
Epoch: 4, Steps: 32 | Train Loss: 3.950 Vali Loss: 11.639 Vali Acc: 0.542 Test Loss: 11.639 Test Acc: 0.542
Validation loss decreased (-0.427360 --> -0.541868).  Saving model ...
Epoch: 5 cost time: 11.909049034118652
Epoch: 5, Steps: 32 | Train Loss: 1.496 Vali Loss: 12.825 Vali Acc: 0.359 Test Loss: 12.825 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.566197395324707
Epoch: 6, Steps: 32 | Train Loss: 1.256 Vali Loss: 14.375 Vali Acc: 0.466 Test Loss: 14.375 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.968548774719238
Epoch: 7, Steps: 32 | Train Loss: 0.589 Vali Loss: 16.305 Vali Acc: 0.557 Test Loss: 16.305 Test Acc: 0.557
Validation loss decreased (-0.541868 --> -0.557089).  Saving model ...
Epoch: 8 cost time: 12.176820755004883
Epoch: 8, Steps: 32 | Train Loss: 0.334 Vali Loss: 14.294 Vali Acc: 0.511 Test Loss: 14.294 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.81984281539917
Epoch: 9, Steps: 32 | Train Loss: 0.337 Vali Loss: 16.528 Vali Acc: 0.504 Test Loss: 16.528 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.057509183883667
Epoch: 10, Steps: 32 | Train Loss: 0.021 Vali Loss: 18.614 Vali Acc: 0.489 Test Loss: 18.614 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.815048694610596
Epoch: 11, Steps: 32 | Train Loss: 0.006 Vali Loss: 18.631 Vali Acc: 0.435 Test Loss: 18.631 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.26649808883667
Epoch: 12, Steps: 32 | Train Loss: 0.079 Vali Loss: 18.651 Vali Acc: 0.466 Test Loss: 18.651 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.238289594650269
Epoch: 13, Steps: 32 | Train Loss: 0.231 Vali Loss: 17.366 Vali Acc: 0.412 Test Loss: 17.366 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.92208194732666
Epoch: 14, Steps: 32 | Train Loss: 0.643 Vali Loss: 21.699 Vali Acc: 0.382 Test Loss: 21.699 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.683511972427368
Epoch: 15, Steps: 32 | Train Loss: 0.708 Vali Loss: 21.861 Vali Acc: 0.527 Test Loss: 21.861 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.599523782730103
Epoch: 16, Steps: 32 | Train Loss: 0.567 Vali Loss: 24.503 Vali Acc: 0.374 Test Loss: 24.503 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.725830554962158
Epoch: 17, Steps: 32 | Train Loss: 1.410 Vali Loss: 20.675 Vali Acc: 0.481 Test Loss: 20.675 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6264373
model size : 32.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.288784980773926
Epoch: 1, Steps: 32 | Train Loss: 3.624 Vali Loss: 6.027 Vali Acc: 0.420 Test Loss: 6.027 Test Acc: 0.420
Validation loss decreased (inf --> -0.419787).  Saving model ...
Epoch: 2 cost time: 11.332545042037964
Epoch: 2, Steps: 32 | Train Loss: 7.622 Vali Loss: 6.421 Vali Acc: 0.443 Test Loss: 6.421 Test Acc: 0.443
Validation loss decreased (-0.419787 --> -0.442684).  Saving model ...
Epoch: 3 cost time: 11.493112087249756
Epoch: 3, Steps: 32 | Train Loss: 7.462 Vali Loss: 17.635 Vali Acc: 0.206 Test Loss: 17.635 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.199174404144287
Epoch: 4, Steps: 32 | Train Loss: 3.176 Vali Loss: 8.281 Vali Acc: 0.366 Test Loss: 8.281 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.32896089553833
Epoch: 5, Steps: 32 | Train Loss: 2.247 Vali Loss: 13.242 Vali Acc: 0.473 Test Loss: 13.242 Test Acc: 0.473
Validation loss decreased (-0.442684 --> -0.473150).  Saving model ...
Epoch: 6 cost time: 11.34503698348999
Epoch: 6, Steps: 32 | Train Loss: 1.407 Vali Loss: 12.743 Vali Acc: 0.389 Test Loss: 12.743 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.65333342552185
Epoch: 7, Steps: 32 | Train Loss: 0.775 Vali Loss: 15.376 Vali Acc: 0.519 Test Loss: 15.376 Test Acc: 0.519
Validation loss decreased (-0.473150 --> -0.518930).  Saving model ...
Epoch: 8 cost time: 11.352453231811523
Epoch: 8, Steps: 32 | Train Loss: 1.991 Vali Loss: 12.121 Vali Acc: 0.450 Test Loss: 12.121 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.393328666687012
Epoch: 9, Steps: 32 | Train Loss: 0.391 Vali Loss: 18.100 Vali Acc: 0.351 Test Loss: 18.100 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.767479419708252
Epoch: 10, Steps: 32 | Train Loss: 0.159 Vali Loss: 14.733 Vali Acc: 0.489 Test Loss: 14.733 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.584578275680542
Epoch: 11, Steps: 32 | Train Loss: 0.144 Vali Loss: 16.242 Vali Acc: 0.534 Test Loss: 16.242 Test Acc: 0.534
Validation loss decreased (-0.518930 --> -0.534189).  Saving model ...
Epoch: 12 cost time: 11.81464433670044
Epoch: 12, Steps: 32 | Train Loss: 0.586 Vali Loss: 14.926 Vali Acc: 0.504 Test Loss: 14.926 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.420197010040283
Epoch: 13, Steps: 32 | Train Loss: 0.456 Vali Loss: 15.158 Vali Acc: 0.527 Test Loss: 15.158 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.631966590881348
Epoch: 14, Steps: 32 | Train Loss: 0.400 Vali Loss: 21.266 Vali Acc: 0.504 Test Loss: 21.266 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.596584558486938
Epoch: 15, Steps: 32 | Train Loss: 0.198 Vali Loss: 18.630 Vali Acc: 0.473 Test Loss: 18.630 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.715983629226685
Epoch: 16, Steps: 32 | Train Loss: 0.332 Vali Loss: 24.717 Vali Acc: 0.534 Test Loss: 24.717 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.584465980529785
Epoch: 17, Steps: 32 | Train Loss: 0.395 Vali Loss: 22.282 Vali Acc: 0.496 Test Loss: 22.282 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.576883792877197
Epoch: 18, Steps: 32 | Train Loss: 2.068 Vali Loss: 17.597 Vali Acc: 0.443 Test Loss: 17.597 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.469413995742798
Epoch: 19, Steps: 32 | Train Loss: 0.770 Vali Loss: 26.029 Vali Acc: 0.527 Test Loss: 26.029 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.246839046478271
Epoch: 20, Steps: 32 | Train Loss: 0.202 Vali Loss: 26.589 Vali Acc: 0.519 Test Loss: 26.589 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.464358806610107
Epoch: 21, Steps: 32 | Train Loss: 0.170 Vali Loss: 21.705 Vali Acc: 0.489 Test Loss: 21.705 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5928501
model size : 31.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.607137441635132
Epoch: 1, Steps: 32 | Train Loss: 4.797 Vali Loss: 12.451 Vali Acc: 0.168 Test Loss: 12.451 Test Acc: 0.168
Validation loss decreased (inf --> -0.167814).  Saving model ...
Epoch: 2 cost time: 12.142951965332031
Epoch: 2, Steps: 32 | Train Loss: 8.916 Vali Loss: 10.676 Vali Acc: 0.099 Test Loss: 10.676 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.793067216873169
Epoch: 3, Steps: 32 | Train Loss: 7.679 Vali Loss: 19.234 Vali Acc: 0.214 Test Loss: 19.234 Test Acc: 0.214
Validation loss decreased (-0.167814 --> -0.213548).  Saving model ...
Epoch: 4 cost time: 11.34867262840271
Epoch: 4, Steps: 32 | Train Loss: 5.028 Vali Loss: 12.718 Vali Acc: 0.405 Test Loss: 12.718 Test Acc: 0.405
Validation loss decreased (-0.213548 --> -0.404453).  Saving model ...
Epoch: 5 cost time: 11.671065330505371
Epoch: 5, Steps: 32 | Train Loss: 2.809 Vali Loss: 12.755 Vali Acc: 0.374 Test Loss: 12.755 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.961594343185425
Epoch: 6, Steps: 32 | Train Loss: 0.324 Vali Loss: 12.205 Vali Acc: 0.420 Test Loss: 12.205 Test Acc: 0.420
Validation loss decreased (-0.404453 --> -0.419725).  Saving model ...
Epoch: 7 cost time: 11.838600397109985
Epoch: 7, Steps: 32 | Train Loss: 0.612 Vali Loss: 12.534 Vali Acc: 0.382 Test Loss: 12.534 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.381863832473755
Epoch: 8, Steps: 32 | Train Loss: 0.429 Vali Loss: 14.380 Vali Acc: 0.344 Test Loss: 14.380 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.705902814865112
Epoch: 9, Steps: 32 | Train Loss: 0.238 Vali Loss: 12.941 Vali Acc: 0.427 Test Loss: 12.941 Test Acc: 0.427
Validation loss decreased (-0.419725 --> -0.427352).  Saving model ...
Epoch: 10 cost time: 11.519906282424927
Epoch: 10, Steps: 32 | Train Loss: 0.465 Vali Loss: 20.871 Vali Acc: 0.344 Test Loss: 20.871 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.639919757843018
Epoch: 11, Steps: 32 | Train Loss: 0.255 Vali Loss: 14.403 Vali Acc: 0.527 Test Loss: 14.403 Test Acc: 0.527
Validation loss decreased (-0.427352 --> -0.526574).  Saving model ...
Epoch: 12 cost time: 11.648881673812866
Epoch: 12, Steps: 32 | Train Loss: 0.090 Vali Loss: 14.619 Vali Acc: 0.489 Test Loss: 14.619 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.89626955986023
Epoch: 13, Steps: 32 | Train Loss: 0.122 Vali Loss: 17.985 Vali Acc: 0.496 Test Loss: 17.985 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.55495834350586
Epoch: 14, Steps: 32 | Train Loss: 0.306 Vali Loss: 15.122 Vali Acc: 0.481 Test Loss: 15.122 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.759863138198853
Epoch: 15, Steps: 32 | Train Loss: 0.159 Vali Loss: 15.565 Vali Acc: 0.481 Test Loss: 15.565 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.822041749954224
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.621 Vali Acc: 0.344 Test Loss: 24.621 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.749326229095459
Epoch: 17, Steps: 32 | Train Loss: 0.251 Vali Loss: 16.111 Vali Acc: 0.443 Test Loss: 16.111 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.132869243621826
Epoch: 18, Steps: 32 | Train Loss: 0.752 Vali Loss: 18.186 Vali Acc: 0.435 Test Loss: 18.186 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.600992679595947
Epoch: 19, Steps: 32 | Train Loss: 0.655 Vali Loss: 19.995 Vali Acc: 0.351 Test Loss: 19.995 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.599578380584717
Epoch: 20, Steps: 32 | Train Loss: 1.219 Vali Loss: 24.769 Vali Acc: 0.366 Test Loss: 24.769 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.804604768753052
Epoch: 21, Steps: 32 | Train Loss: 0.296 Vali Loss: 26.601 Vali Acc: 0.420 Test Loss: 26.601 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 5592629
model size : 30.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.674137115478516
Epoch: 1, Steps: 32 | Train Loss: 4.630 Vali Loss: 5.310 Vali Acc: 0.168 Test Loss: 5.310 Test Acc: 0.168
Validation loss decreased (inf --> -0.167886).  Saving model ...
Epoch: 2 cost time: 11.039180755615234
Epoch: 2, Steps: 32 | Train Loss: 6.890 Vali Loss: 6.704 Vali Acc: 0.099 Test Loss: 6.704 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.896727800369263
Epoch: 3, Steps: 32 | Train Loss: 7.428 Vali Loss: 6.863 Vali Acc: 0.321 Test Loss: 6.863 Test Acc: 0.321
Validation loss decreased (-0.167886 --> -0.320542).  Saving model ...
Epoch: 4 cost time: 11.27484917640686
Epoch: 4, Steps: 32 | Train Loss: 3.911 Vali Loss: 9.937 Vali Acc: 0.412 Test Loss: 9.937 Test Acc: 0.412
Validation loss decreased (-0.320542 --> -0.412114).  Saving model ...
Epoch: 5 cost time: 11.003072500228882
Epoch: 5, Steps: 32 | Train Loss: 1.097 Vali Loss: 10.893 Vali Acc: 0.374 Test Loss: 10.893 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.01021933555603
Epoch: 6, Steps: 32 | Train Loss: 1.330 Vali Loss: 16.744 Vali Acc: 0.336 Test Loss: 16.744 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.332221508026123
Epoch: 7, Steps: 32 | Train Loss: 0.322 Vali Loss: 13.355 Vali Acc: 0.397 Test Loss: 13.355 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.10023021697998
Epoch: 8, Steps: 32 | Train Loss: 0.570 Vali Loss: 14.962 Vali Acc: 0.397 Test Loss: 14.962 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.291990041732788
Epoch: 9, Steps: 32 | Train Loss: 1.151 Vali Loss: 16.753 Vali Acc: 0.382 Test Loss: 16.753 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.061478853225708
Epoch: 10, Steps: 32 | Train Loss: 0.227 Vali Loss: 24.052 Vali Acc: 0.260 Test Loss: 24.052 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.131504774093628
Epoch: 11, Steps: 32 | Train Loss: 0.927 Vali Loss: 20.762 Vali Acc: 0.336 Test Loss: 20.762 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.940931797027588
Epoch: 12, Steps: 32 | Train Loss: 0.549 Vali Loss: 17.619 Vali Acc: 0.389 Test Loss: 17.619 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.375079154968262
Epoch: 13, Steps: 32 | Train Loss: 0.001 Vali Loss: 23.966 Vali Acc: 0.336 Test Loss: 23.966 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.234757423400879
Epoch: 14, Steps: 32 | Train Loss: 0.770 Vali Loss: 20.827 Vali Acc: 0.351 Test Loss: 20.827 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4122137404580153
model parameter : 5256757
model size : 28.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.906867504119873
Epoch: 1, Steps: 32 | Train Loss: 5.711 Vali Loss: 8.864 Vali Acc: 0.099 Test Loss: 8.864 Test Acc: 0.099
Validation loss decreased (inf --> -0.099148).  Saving model ...
Epoch: 2 cost time: 10.971222162246704
Epoch: 2, Steps: 32 | Train Loss: 10.207 Vali Loss: 10.082 Vali Acc: 0.191 Test Loss: 10.082 Test Acc: 0.191
Validation loss decreased (-0.099148 --> -0.190739).  Saving model ...
Epoch: 3 cost time: 11.158538341522217
Epoch: 3, Steps: 32 | Train Loss: 7.307 Vali Loss: 10.431 Vali Acc: 0.443 Test Loss: 10.431 Test Acc: 0.443
Validation loss decreased (-0.190739 --> -0.442644).  Saving model ...
Epoch: 4 cost time: 11.165106773376465
Epoch: 4, Steps: 32 | Train Loss: 3.778 Vali Loss: 12.082 Vali Acc: 0.496 Test Loss: 12.082 Test Acc: 0.496
Validation loss decreased (-0.442644 --> -0.496062).  Saving model ...
Epoch: 5 cost time: 11.151301622390747
Epoch: 5, Steps: 32 | Train Loss: 1.763 Vali Loss: 15.318 Vali Acc: 0.519 Test Loss: 15.318 Test Acc: 0.519
Validation loss decreased (-0.496062 --> -0.518931).  Saving model ...
Epoch: 6 cost time: 11.091063261032104
Epoch: 6, Steps: 32 | Train Loss: 0.407 Vali Loss: 22.501 Vali Acc: 0.489 Test Loss: 22.501 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.43326449394226
Epoch: 7, Steps: 32 | Train Loss: 1.244 Vali Loss: 15.435 Vali Acc: 0.397 Test Loss: 15.435 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.235998392105103
Epoch: 8, Steps: 32 | Train Loss: 0.595 Vali Loss: 11.417 Vali Acc: 0.481 Test Loss: 11.417 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.196945428848267
Epoch: 9, Steps: 32 | Train Loss: 0.740 Vali Loss: 19.891 Vali Acc: 0.328 Test Loss: 19.891 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.393674373626709
Epoch: 10, Steps: 32 | Train Loss: 0.144 Vali Loss: 20.179 Vali Acc: 0.519 Test Loss: 20.179 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.223102807998657
Epoch: 11, Steps: 32 | Train Loss: 0.445 Vali Loss: 22.702 Vali Acc: 0.534 Test Loss: 22.702 Test Acc: 0.534
Validation loss decreased (-0.518931 --> -0.534124).  Saving model ...
Epoch: 12 cost time: 11.150828123092651
Epoch: 12, Steps: 32 | Train Loss: 0.454 Vali Loss: 30.245 Vali Acc: 0.458 Test Loss: 30.245 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.15262222290039
Epoch: 13, Steps: 32 | Train Loss: 0.091 Vali Loss: 19.458 Vali Acc: 0.481 Test Loss: 19.458 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.921597003936768
Epoch: 14, Steps: 32 | Train Loss: 1.044 Vali Loss: 23.482 Vali Acc: 0.519 Test Loss: 23.482 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.208698987960815
Epoch: 15, Steps: 32 | Train Loss: 0.566 Vali Loss: 24.502 Vali Acc: 0.542 Test Loss: 24.502 Test Acc: 0.542
Validation loss decreased (-0.534124 --> -0.541740).  Saving model ...
Epoch: 16 cost time: 11.263392448425293
Epoch: 16, Steps: 32 | Train Loss: 0.048 Vali Loss: 22.828 Vali Acc: 0.481 Test Loss: 22.828 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.494499683380127
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.917 Vali Acc: 0.496 Test Loss: 22.917 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.04780387878418
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.009 Vali Acc: 0.496 Test Loss: 23.009 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.181907176971436
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.609 Vali Acc: 0.504 Test Loss: 22.609 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.086854934692383
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.555 Vali Acc: 0.496 Test Loss: 22.555 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.42787480354309
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.553 Vali Acc: 0.496 Test Loss: 22.553 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.105676651000977
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.559 Vali Acc: 0.496 Test Loss: 22.559 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.931617259979248
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.559 Vali Acc: 0.496 Test Loss: 22.559 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.961052417755127
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.559 Vali Acc: 0.496 Test Loss: 22.559 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.048109769821167
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.559 Vali Acc: 0.496 Test Loss: 22.559 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6034101
model size : 31.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.815600872039795
Epoch: 1, Steps: 32 | Train Loss: 5.544 Vali Loss: 14.603 Vali Acc: 0.099 Test Loss: 14.603 Test Acc: 0.099
Validation loss decreased (inf --> -0.099091).  Saving model ...
Epoch: 2 cost time: 11.140666246414185
Epoch: 2, Steps: 32 | Train Loss: 11.151 Vali Loss: 8.732 Vali Acc: 0.427 Test Loss: 8.732 Test Acc: 0.427
Validation loss decreased (-0.099091 --> -0.427394).  Saving model ...
Epoch: 3 cost time: 10.909560203552246
Epoch: 3, Steps: 32 | Train Loss: 11.887 Vali Loss: 12.407 Vali Acc: 0.473 Test Loss: 12.407 Test Acc: 0.473
Validation loss decreased (-0.427394 --> -0.473158).  Saving model ...
Epoch: 4 cost time: 11.050246000289917
Epoch: 4, Steps: 32 | Train Loss: 3.090 Vali Loss: 11.565 Vali Acc: 0.504 Test Loss: 11.565 Test Acc: 0.504
Validation loss decreased (-0.473158 --> -0.503701).  Saving model ...
Epoch: 5 cost time: 11.041601181030273
Epoch: 5, Steps: 32 | Train Loss: 1.403 Vali Loss: 11.929 Vali Acc: 0.550 Test Loss: 11.929 Test Acc: 0.550
Validation loss decreased (-0.503701 --> -0.549499).  Saving model ...
Epoch: 6 cost time: 10.878478288650513
Epoch: 6, Steps: 32 | Train Loss: 1.542 Vali Loss: 11.852 Vali Acc: 0.496 Test Loss: 11.852 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.274384021759033
Epoch: 7, Steps: 32 | Train Loss: 0.998 Vali Loss: 12.693 Vali Acc: 0.435 Test Loss: 12.693 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.989566802978516
Epoch: 8, Steps: 32 | Train Loss: 0.352 Vali Loss: 15.705 Vali Acc: 0.427 Test Loss: 15.705 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.065090417861938
Epoch: 9, Steps: 32 | Train Loss: 0.207 Vali Loss: 14.039 Vali Acc: 0.450 Test Loss: 14.039 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.641385078430176
Epoch: 10, Steps: 32 | Train Loss: 0.009 Vali Loss: 15.987 Vali Acc: 0.397 Test Loss: 15.987 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.128774642944336
Epoch: 11, Steps: 32 | Train Loss: 0.288 Vali Loss: 17.239 Vali Acc: 0.397 Test Loss: 17.239 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.282520532608032
Epoch: 12, Steps: 32 | Train Loss: 0.163 Vali Loss: 21.954 Vali Acc: 0.359 Test Loss: 21.954 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.957451581954956
Epoch: 13, Steps: 32 | Train Loss: 0.427 Vali Loss: 21.732 Vali Acc: 0.366 Test Loss: 21.732 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.205363750457764
Epoch: 14, Steps: 32 | Train Loss: 0.133 Vali Loss: 21.909 Vali Acc: 0.496 Test Loss: 21.909 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.234431266784668
Epoch: 15, Steps: 32 | Train Loss: 0.753 Vali Loss: 22.130 Vali Acc: 0.427 Test Loss: 22.130 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 5698229
model size : 30.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.724529266357422
Epoch: 1, Steps: 32 | Train Loss: 4.499 Vali Loss: 3.371 Vali Acc: 0.137 Test Loss: 3.371 Test Acc: 0.137
Validation loss decreased (inf --> -0.137371).  Saving model ...
Epoch: 2 cost time: 10.777077674865723
Epoch: 2, Steps: 32 | Train Loss: 6.432 Vali Loss: 6.632 Vali Acc: 0.412 Test Loss: 6.632 Test Acc: 0.412
Validation loss decreased (-0.137371 --> -0.412147).  Saving model ...
Epoch: 3 cost time: 11.001049518585205
Epoch: 3, Steps: 32 | Train Loss: 7.344 Vali Loss: 14.202 Vali Acc: 0.481 Test Loss: 14.202 Test Acc: 0.481
Validation loss decreased (-0.412147 --> -0.480774).  Saving model ...
Epoch: 4 cost time: 10.937029361724854
Epoch: 4, Steps: 32 | Train Loss: 3.954 Vali Loss: 12.171 Vali Acc: 0.305 Test Loss: 12.171 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.893263101577759
Epoch: 5, Steps: 32 | Train Loss: 1.723 Vali Loss: 10.503 Vali Acc: 0.344 Test Loss: 10.503 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.95723843574524
Epoch: 6, Steps: 32 | Train Loss: 1.776 Vali Loss: 11.301 Vali Acc: 0.473 Test Loss: 11.301 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.836719036102295
Epoch: 7, Steps: 32 | Train Loss: 0.371 Vali Loss: 11.188 Vali Acc: 0.359 Test Loss: 11.188 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.18716311454773
Epoch: 8, Steps: 32 | Train Loss: 0.161 Vali Loss: 11.562 Vali Acc: 0.511 Test Loss: 11.562 Test Acc: 0.511
Validation loss decreased (-0.480774 --> -0.511335).  Saving model ...
Epoch: 9 cost time: 11.160406589508057
Epoch: 9, Steps: 32 | Train Loss: 0.132 Vali Loss: 13.919 Vali Acc: 0.458 Test Loss: 13.919 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.010946273803711
Epoch: 10, Steps: 32 | Train Loss: 0.150 Vali Loss: 14.857 Vali Acc: 0.534 Test Loss: 14.857 Test Acc: 0.534
Validation loss decreased (-0.511335 --> -0.534203).  Saving model ...
Epoch: 11 cost time: 11.17615032196045
Epoch: 11, Steps: 32 | Train Loss: 0.271 Vali Loss: 19.402 Vali Acc: 0.374 Test Loss: 19.402 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.894466638565063
Epoch: 12, Steps: 32 | Train Loss: 0.196 Vali Loss: 16.354 Vali Acc: 0.397 Test Loss: 16.354 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.865903854370117
Epoch: 13, Steps: 32 | Train Loss: 0.627 Vali Loss: 20.321 Vali Acc: 0.397 Test Loss: 20.321 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.324270963668823
Epoch: 14, Steps: 32 | Train Loss: 0.329 Vali Loss: 18.594 Vali Acc: 0.489 Test Loss: 18.594 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.237930536270142
Epoch: 15, Steps: 32 | Train Loss: 0.716 Vali Loss: 18.326 Vali Acc: 0.420 Test Loss: 18.326 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.314576864242554
Epoch: 16, Steps: 32 | Train Loss: 0.741 Vali Loss: 21.396 Vali Acc: 0.489 Test Loss: 21.396 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.934337377548218
Epoch: 17, Steps: 32 | Train Loss: 0.013 Vali Loss: 23.487 Vali Acc: 0.435 Test Loss: 23.487 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.935198783874512
Epoch: 18, Steps: 32 | Train Loss: 0.553 Vali Loss: 27.671 Vali Acc: 0.351 Test Loss: 27.671 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.939137935638428
Epoch: 19, Steps: 32 | Train Loss: 0.559 Vali Loss: 33.899 Vali Acc: 0.519 Test Loss: 33.899 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.054565191268921
Epoch: 20, Steps: 32 | Train Loss: 0.398 Vali Loss: 26.453 Vali Acc: 0.405 Test Loss: 26.453 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5362357
model size : 29.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.011579751968384
Epoch: 1, Steps: 32 | Train Loss: 5.168 Vali Loss: 5.555 Vali Acc: 0.176 Test Loss: 5.555 Test Acc: 0.176
Validation loss decreased (inf --> -0.175517).  Saving model ...
Epoch: 2 cost time: 10.778233766555786
Epoch: 2, Steps: 32 | Train Loss: 6.349 Vali Loss: 3.869 Vali Acc: 0.206 Test Loss: 3.869 Test Acc: 0.206
Validation loss decreased (-0.175517 --> -0.206068).  Saving model ...
Epoch: 3 cost time: 10.423868417739868
Epoch: 3, Steps: 32 | Train Loss: 7.138 Vali Loss: 5.290 Vali Acc: 0.458 Test Loss: 5.290 Test Acc: 0.458
Validation loss decreased (-0.206068 --> -0.457962).  Saving model ...
Epoch: 4 cost time: 10.733659505844116
Epoch: 4, Steps: 32 | Train Loss: 2.041 Vali Loss: 8.256 Vali Acc: 0.534 Test Loss: 8.256 Test Acc: 0.534
Validation loss decreased (-0.457962 --> -0.534269).  Saving model ...
Epoch: 5 cost time: 10.4931960105896
Epoch: 5, Steps: 32 | Train Loss: 0.721 Vali Loss: 10.593 Vali Acc: 0.435 Test Loss: 10.593 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.436478853225708
Epoch: 6, Steps: 32 | Train Loss: 1.358 Vali Loss: 11.227 Vali Acc: 0.511 Test Loss: 11.227 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.404953241348267
Epoch: 7, Steps: 32 | Train Loss: 1.483 Vali Loss: 16.327 Vali Acc: 0.366 Test Loss: 16.327 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.651265859603882
Epoch: 8, Steps: 32 | Train Loss: 1.739 Vali Loss: 18.259 Vali Acc: 0.427 Test Loss: 18.259 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.51530909538269
Epoch: 9, Steps: 32 | Train Loss: 0.765 Vali Loss: 17.718 Vali Acc: 0.366 Test Loss: 17.718 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.511214017868042
Epoch: 10, Steps: 32 | Train Loss: 1.050 Vali Loss: 16.854 Vali Acc: 0.527 Test Loss: 16.854 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.567900657653809
Epoch: 11, Steps: 32 | Train Loss: 0.241 Vali Loss: 18.956 Vali Acc: 0.481 Test Loss: 18.956 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.44199013710022
Epoch: 12, Steps: 32 | Train Loss: 0.070 Vali Loss: 19.361 Vali Acc: 0.443 Test Loss: 19.361 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.58221983909607
Epoch: 13, Steps: 32 | Train Loss: 0.383 Vali Loss: 19.210 Vali Acc: 0.481 Test Loss: 19.210 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.815596103668213
Epoch: 14, Steps: 32 | Train Loss: 0.263 Vali Loss: 23.470 Vali Acc: 0.450 Test Loss: 23.470 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 5026485
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.895160913467407
Epoch: 1, Steps: 32 | Train Loss: 2.503 Vali Loss: 2.370 Vali Acc: 0.137 Test Loss: 2.370 Test Acc: 0.137
Validation loss decreased (inf --> -0.137381).  Saving model ...
Epoch: 2 cost time: 10.627221822738647
Epoch: 2, Steps: 32 | Train Loss: 4.556 Vali Loss: 3.963 Vali Acc: 0.466 Test Loss: 3.963 Test Acc: 0.466
Validation loss decreased (-0.137381 --> -0.465609).  Saving model ...
Epoch: 3 cost time: 10.769607782363892
Epoch: 3, Steps: 32 | Train Loss: 2.370 Vali Loss: 3.325 Vali Acc: 0.489 Test Loss: 3.325 Test Acc: 0.489
Validation loss decreased (-0.465609 --> -0.488516).  Saving model ...
Epoch: 4 cost time: 10.907008409500122
Epoch: 4, Steps: 32 | Train Loss: 1.459 Vali Loss: 5.027 Vali Acc: 0.450 Test Loss: 5.027 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.69348669052124
Epoch: 5, Steps: 32 | Train Loss: 0.581 Vali Loss: 5.105 Vali Acc: 0.473 Test Loss: 5.105 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.623135566711426
Epoch: 6, Steps: 32 | Train Loss: 0.123 Vali Loss: 5.668 Vali Acc: 0.489 Test Loss: 5.668 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.609637022018433
Epoch: 7, Steps: 32 | Train Loss: 0.237 Vali Loss: 7.564 Vali Acc: 0.504 Test Loss: 7.564 Test Acc: 0.504
Validation loss decreased (-0.488516 --> -0.503741).  Saving model ...
Epoch: 8 cost time: 10.6981041431427
Epoch: 8, Steps: 32 | Train Loss: 0.048 Vali Loss: 6.788 Vali Acc: 0.412 Test Loss: 6.788 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.580310821533203
Epoch: 9, Steps: 32 | Train Loss: 0.039 Vali Loss: 6.972 Vali Acc: 0.450 Test Loss: 6.972 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.632848978042603
Epoch: 10, Steps: 32 | Train Loss: 0.018 Vali Loss: 7.426 Vali Acc: 0.389 Test Loss: 7.426 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.37325382232666
Epoch: 11, Steps: 32 | Train Loss: 0.030 Vali Loss: 9.667 Vali Acc: 0.412 Test Loss: 9.667 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.50941514968872
Epoch: 12, Steps: 32 | Train Loss: 0.306 Vali Loss: 7.666 Vali Acc: 0.427 Test Loss: 7.666 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.709595680236816
Epoch: 13, Steps: 32 | Train Loss: 0.156 Vali Loss: 7.718 Vali Acc: 0.458 Test Loss: 7.718 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.460092544555664
Epoch: 14, Steps: 32 | Train Loss: 0.404 Vali Loss: 10.096 Vali Acc: 0.458 Test Loss: 10.096 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.536470890045166
Epoch: 15, Steps: 32 | Train Loss: 0.366 Vali Loss: 10.672 Vali Acc: 0.412 Test Loss: 10.672 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.9162917137146
Epoch: 16, Steps: 32 | Train Loss: 0.547 Vali Loss: 9.590 Vali Acc: 0.458 Test Loss: 9.590 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.610195875167847
Epoch: 17, Steps: 32 | Train Loss: 0.002 Vali Loss: 12.828 Vali Acc: 0.496 Test Loss: 12.828 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 3367861
model size : 17.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.907402753829956
Epoch: 1, Steps: 32 | Train Loss: 2.655 Vali Loss: 3.920 Vali Acc: 0.420 Test Loss: 3.920 Test Acc: 0.420
Validation loss decreased (inf --> -0.419808).  Saving model ...
Epoch: 2 cost time: 10.672672748565674
Epoch: 2, Steps: 32 | Train Loss: 3.102 Vali Loss: 2.367 Vali Acc: 0.458 Test Loss: 2.367 Test Acc: 0.458
Validation loss decreased (-0.419808 --> -0.457992).  Saving model ...
Epoch: 3 cost time: 10.678065776824951
Epoch: 3, Steps: 32 | Train Loss: 1.730 Vali Loss: 7.509 Vali Acc: 0.435 Test Loss: 7.509 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.554980278015137
Epoch: 4, Steps: 32 | Train Loss: 1.179 Vali Loss: 6.012 Vali Acc: 0.527 Test Loss: 6.012 Test Acc: 0.527
Validation loss decreased (-0.457992 --> -0.526657).  Saving model ...
Epoch: 5 cost time: 10.621305465698242
Epoch: 5, Steps: 32 | Train Loss: 0.556 Vali Loss: 7.749 Vali Acc: 0.527 Test Loss: 7.749 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.75294280052185
Epoch: 6, Steps: 32 | Train Loss: 0.521 Vali Loss: 6.804 Vali Acc: 0.473 Test Loss: 6.804 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.021229982376099
Epoch: 7, Steps: 32 | Train Loss: 0.022 Vali Loss: 7.528 Vali Acc: 0.481 Test Loss: 7.528 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.80430817604065
Epoch: 8, Steps: 32 | Train Loss: 0.173 Vali Loss: 7.695 Vali Acc: 0.427 Test Loss: 7.695 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.647781372070312
Epoch: 9, Steps: 32 | Train Loss: 0.224 Vali Loss: 8.984 Vali Acc: 0.481 Test Loss: 8.984 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.702207088470459
Epoch: 10, Steps: 32 | Train Loss: 0.184 Vali Loss: 8.759 Vali Acc: 0.489 Test Loss: 8.759 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.608630418777466
Epoch: 11, Steps: 32 | Train Loss: 0.504 Vali Loss: 7.795 Vali Acc: 0.511 Test Loss: 7.795 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.694048643112183
Epoch: 12, Steps: 32 | Train Loss: 0.210 Vali Loss: 8.226 Vali Acc: 0.458 Test Loss: 8.226 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.615320205688477
Epoch: 13, Steps: 32 | Train Loss: 0.040 Vali Loss: 11.683 Vali Acc: 0.557 Test Loss: 11.683 Test Acc: 0.557
Validation loss decreased (-0.526657 --> -0.557135).  Saving model ...
Epoch: 14 cost time: 11.011566162109375
Epoch: 14, Steps: 32 | Train Loss: 0.005 Vali Loss: 9.500 Vali Acc: 0.382 Test Loss: 9.500 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.765647172927856
Epoch: 15, Steps: 32 | Train Loss: 0.001 Vali Loss: 12.158 Vali Acc: 0.450 Test Loss: 12.158 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.721143960952759
Epoch: 16, Steps: 32 | Train Loss: 0.072 Vali Loss: 11.962 Vali Acc: 0.282 Test Loss: 11.962 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.814591407775879
Epoch: 17, Steps: 32 | Train Loss: 0.228 Vali Loss: 10.767 Vali Acc: 0.458 Test Loss: 10.767 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.653665542602539
Epoch: 18, Steps: 32 | Train Loss: 0.238 Vali Loss: 10.544 Vali Acc: 0.519 Test Loss: 10.544 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.978072881698608
Epoch: 19, Steps: 32 | Train Loss: 0.435 Vali Loss: 13.838 Vali Acc: 0.443 Test Loss: 13.838 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.763144969940186
Epoch: 20, Steps: 32 | Train Loss: 0.123 Vali Loss: 15.494 Vali Acc: 0.427 Test Loss: 15.494 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.48611855506897
Epoch: 21, Steps: 32 | Train Loss: 0.142 Vali Loss: 18.685 Vali Acc: 0.366 Test Loss: 18.685 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.808140993118286
Epoch: 22, Steps: 32 | Train Loss: 0.208 Vali Loss: 16.072 Vali Acc: 0.504 Test Loss: 16.072 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.658089399337769
Epoch: 23, Steps: 32 | Train Loss: 0.494 Vali Loss: 17.441 Vali Acc: 0.397 Test Loss: 17.441 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3199925
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.510299682617188
Epoch: 1, Steps: 32 | Train Loss: 2.796 Vali Loss: 4.223 Vali Acc: 0.344 Test Loss: 4.223 Test Acc: 0.344
Validation loss decreased (inf --> -0.343469).  Saving model ...
Epoch: 2 cost time: 10.427209854125977
Epoch: 2, Steps: 32 | Train Loss: 3.713 Vali Loss: 4.462 Vali Acc: 0.191 Test Loss: 4.462 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.351168632507324
Epoch: 3, Steps: 32 | Train Loss: 2.840 Vali Loss: 6.599 Vali Acc: 0.214 Test Loss: 6.599 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.592728614807129
Epoch: 4, Steps: 32 | Train Loss: 1.058 Vali Loss: 6.786 Vali Acc: 0.496 Test Loss: 6.786 Test Acc: 0.496
Validation loss decreased (-0.343469 --> -0.496115).  Saving model ...
Epoch: 5 cost time: 10.547378063201904
Epoch: 5, Steps: 32 | Train Loss: 0.584 Vali Loss: 7.348 Vali Acc: 0.527 Test Loss: 7.348 Test Acc: 0.527
Validation loss decreased (-0.496115 --> -0.526644).  Saving model ...
Epoch: 6 cost time: 10.711092472076416
Epoch: 6, Steps: 32 | Train Loss: 0.289 Vali Loss: 7.552 Vali Acc: 0.481 Test Loss: 7.552 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.477670431137085
Epoch: 7, Steps: 32 | Train Loss: 0.368 Vali Loss: 9.492 Vali Acc: 0.328 Test Loss: 9.492 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.478978395462036
Epoch: 8, Steps: 32 | Train Loss: 0.274 Vali Loss: 8.233 Vali Acc: 0.473 Test Loss: 8.233 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.527264833450317
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.957 Vali Acc: 0.504 Test Loss: 8.957 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.865075826644897
Epoch: 10, Steps: 32 | Train Loss: 0.018 Vali Loss: 7.375 Vali Acc: 0.458 Test Loss: 7.375 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.694439888000488
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 9.938 Vali Acc: 0.466 Test Loss: 9.938 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.602529525756836
Epoch: 12, Steps: 32 | Train Loss: 0.033 Vali Loss: 12.060 Vali Acc: 0.458 Test Loss: 12.060 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.570827960968018
Epoch: 13, Steps: 32 | Train Loss: 0.049 Vali Loss: 11.368 Vali Acc: 0.511 Test Loss: 11.368 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.624091148376465
Epoch: 14, Steps: 32 | Train Loss: 0.167 Vali Loss: 14.969 Vali Acc: 0.282 Test Loss: 14.969 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.454141855239868
Epoch: 15, Steps: 32 | Train Loss: 0.830 Vali Loss: 15.327 Vali Acc: 0.313 Test Loss: 15.327 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3031989
model size : 16.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.741037845611572
Epoch: 1, Steps: 32 | Train Loss: 3.134 Vali Loss: 2.418 Vali Acc: 0.176 Test Loss: 2.418 Test Acc: 0.176
Validation loss decreased (inf --> -0.175548).  Saving model ...
Epoch: 2 cost time: 10.037309885025024
Epoch: 2, Steps: 32 | Train Loss: 5.212 Vali Loss: 7.642 Vali Acc: 0.160 Test Loss: 7.642 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.358641147613525
Epoch: 3, Steps: 32 | Train Loss: 4.070 Vali Loss: 4.078 Vali Acc: 0.405 Test Loss: 4.078 Test Acc: 0.405
Validation loss decreased (-0.175548 --> -0.404539).  Saving model ...
Epoch: 4 cost time: 10.264791011810303
Epoch: 4, Steps: 32 | Train Loss: 1.600 Vali Loss: 5.890 Vali Acc: 0.473 Test Loss: 5.890 Test Acc: 0.473
Validation loss decreased (-0.404539 --> -0.473224).  Saving model ...
Epoch: 5 cost time: 10.169174671173096
Epoch: 5, Steps: 32 | Train Loss: 1.107 Vali Loss: 6.015 Vali Acc: 0.527 Test Loss: 6.015 Test Acc: 0.527
Validation loss decreased (-0.473224 --> -0.526657).  Saving model ...
Epoch: 6 cost time: 10.082296371459961
Epoch: 6, Steps: 32 | Train Loss: 0.342 Vali Loss: 7.345 Vali Acc: 0.511 Test Loss: 7.345 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.127531051635742
Epoch: 7, Steps: 32 | Train Loss: 0.177 Vali Loss: 6.132 Vali Acc: 0.443 Test Loss: 6.132 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.125310182571411
Epoch: 8, Steps: 32 | Train Loss: 0.193 Vali Loss: 6.886 Vali Acc: 0.527 Test Loss: 6.886 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.567731380462646
Epoch: 9, Steps: 32 | Train Loss: 0.010 Vali Loss: 8.032 Vali Acc: 0.466 Test Loss: 8.032 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.470378398895264
Epoch: 10, Steps: 32 | Train Loss: 0.139 Vali Loss: 8.563 Vali Acc: 0.504 Test Loss: 8.563 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.219743728637695
Epoch: 11, Steps: 32 | Train Loss: 0.054 Vali Loss: 8.715 Vali Acc: 0.466 Test Loss: 8.715 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.172593593597412
Epoch: 12, Steps: 32 | Train Loss: 0.356 Vali Loss: 12.594 Vali Acc: 0.496 Test Loss: 12.594 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.239334344863892
Epoch: 13, Steps: 32 | Train Loss: 0.373 Vali Loss: 11.245 Vali Acc: 0.504 Test Loss: 11.245 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.211175203323364
Epoch: 14, Steps: 32 | Train Loss: 0.010 Vali Loss: 11.872 Vali Acc: 0.443 Test Loss: 11.872 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.235749244689941
Epoch: 15, Steps: 32 | Train Loss: 0.314 Vali Loss: 9.712 Vali Acc: 0.450 Test Loss: 9.712 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2864053
model size : 15.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.595102071762085
Epoch: 1, Steps: 32 | Train Loss: 3.420 Vali Loss: 6.950 Vali Acc: 0.420 Test Loss: 6.950 Test Acc: 0.420
Validation loss decreased (inf --> -0.419778).  Saving model ...
Epoch: 2 cost time: 10.140275478363037
Epoch: 2, Steps: 32 | Train Loss: 3.557 Vali Loss: 6.543 Vali Acc: 0.137 Test Loss: 6.543 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.380126476287842
Epoch: 3, Steps: 32 | Train Loss: 4.764 Vali Loss: 2.903 Vali Acc: 0.420 Test Loss: 2.903 Test Acc: 0.420
Validation loss decreased (-0.419778 --> -0.419818).  Saving model ...
Epoch: 4 cost time: 10.442596435546875
Epoch: 4, Steps: 32 | Train Loss: 2.250 Vali Loss: 7.990 Vali Acc: 0.359 Test Loss: 7.990 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.496942281723022
Epoch: 5, Steps: 32 | Train Loss: 1.309 Vali Loss: 7.890 Vali Acc: 0.511 Test Loss: 7.890 Test Acc: 0.511
Validation loss decreased (-0.419818 --> -0.511371).  Saving model ...
Epoch: 6 cost time: 10.141000032424927
Epoch: 6, Steps: 32 | Train Loss: 0.489 Vali Loss: 5.280 Vali Acc: 0.458 Test Loss: 5.280 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.304218053817749
Epoch: 7, Steps: 32 | Train Loss: 0.587 Vali Loss: 7.359 Vali Acc: 0.550 Test Loss: 7.359 Test Acc: 0.550
Validation loss decreased (-0.511371 --> -0.549545).  Saving model ...
Epoch: 8 cost time: 10.376391410827637
Epoch: 8, Steps: 32 | Train Loss: 0.073 Vali Loss: 7.595 Vali Acc: 0.405 Test Loss: 7.595 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.64244556427002
Epoch: 9, Steps: 32 | Train Loss: 0.158 Vali Loss: 8.859 Vali Acc: 0.519 Test Loss: 8.859 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.284790754318237
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.483 Vali Acc: 0.504 Test Loss: 8.483 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.293365240097046
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.370 Vali Acc: 0.504 Test Loss: 8.370 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.088926076889038
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.450 Vali Acc: 0.504 Test Loss: 8.450 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.285001516342163
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.544 Vali Acc: 0.511 Test Loss: 8.544 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.488755464553833
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.557 Vali Acc: 0.511 Test Loss: 8.557 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.289870738983154
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.570 Vali Acc: 0.511 Test Loss: 8.570 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.4911208152771
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.577 Vali Acc: 0.511 Test Loss: 8.577 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.32233190536499
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.578 Vali Acc: 0.511 Test Loss: 8.578 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2905525
model size : 15.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.752862215042114
Epoch: 1, Steps: 32 | Train Loss: 4.183 Vali Loss: 10.590 Vali Acc: 0.176 Test Loss: 10.590 Test Acc: 0.176
Validation loss decreased (inf --> -0.175467).  Saving model ...
Epoch: 2 cost time: 10.395960807800293
Epoch: 2, Steps: 32 | Train Loss: 5.678 Vali Loss: 5.788 Vali Acc: 0.176 Test Loss: 5.788 Test Acc: 0.176
Validation loss decreased (-0.175467 --> -0.175515).  Saving model ...
Epoch: 3 cost time: 10.20124363899231
Epoch: 3, Steps: 32 | Train Loss: 3.788 Vali Loss: 5.419 Vali Acc: 0.229 Test Loss: 5.419 Test Acc: 0.229
Validation loss decreased (-0.175515 --> -0.228953).  Saving model ...
Epoch: 4 cost time: 10.515644073486328
Epoch: 4, Steps: 32 | Train Loss: 1.906 Vali Loss: 6.690 Vali Acc: 0.275 Test Loss: 6.690 Test Acc: 0.275
Validation loss decreased (-0.228953 --> -0.274742).  Saving model ...
Epoch: 5 cost time: 10.488904476165771
Epoch: 5, Steps: 32 | Train Loss: 0.635 Vali Loss: 9.865 Vali Acc: 0.504 Test Loss: 9.865 Test Acc: 0.504
Validation loss decreased (-0.274742 --> -0.503718).  Saving model ...
Epoch: 6 cost time: 10.256972312927246
Epoch: 6, Steps: 32 | Train Loss: 0.961 Vali Loss: 6.640 Vali Acc: 0.489 Test Loss: 6.640 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.376152992248535
Epoch: 7, Steps: 32 | Train Loss: 0.126 Vali Loss: 9.946 Vali Acc: 0.527 Test Loss: 9.946 Test Acc: 0.527
Validation loss decreased (-0.503718 --> -0.526618).  Saving model ...
Epoch: 8 cost time: 10.192399263381958
Epoch: 8, Steps: 32 | Train Loss: 0.694 Vali Loss: 8.424 Vali Acc: 0.458 Test Loss: 8.424 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.216088056564331
Epoch: 9, Steps: 32 | Train Loss: 0.267 Vali Loss: 8.158 Vali Acc: 0.511 Test Loss: 8.158 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.286264181137085
Epoch: 10, Steps: 32 | Train Loss: 0.010 Vali Loss: 8.378 Vali Acc: 0.511 Test Loss: 8.378 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.639907836914062
Epoch: 11, Steps: 32 | Train Loss: 0.015 Vali Loss: 9.555 Vali Acc: 0.489 Test Loss: 9.555 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.140078783035278
Epoch: 12, Steps: 32 | Train Loss: 0.047 Vali Loss: 8.658 Vali Acc: 0.466 Test Loss: 8.658 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.698583126068115
Epoch: 13, Steps: 32 | Train Loss: 0.017 Vali Loss: 9.046 Vali Acc: 0.473 Test Loss: 9.046 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.507331371307373
Epoch: 14, Steps: 32 | Train Loss: 0.073 Vali Loss: 11.175 Vali Acc: 0.359 Test Loss: 11.175 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.56992769241333
Epoch: 15, Steps: 32 | Train Loss: 0.253 Vali Loss: 11.992 Vali Acc: 0.542 Test Loss: 11.992 Test Acc: 0.542
Validation loss decreased (-0.526618 --> -0.541865).  Saving model ...
Epoch: 16 cost time: 10.82872986793518
Epoch: 16, Steps: 32 | Train Loss: 0.140 Vali Loss: 13.867 Vali Acc: 0.405 Test Loss: 13.867 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.999269962310791
Epoch: 17, Steps: 32 | Train Loss: 0.481 Vali Loss: 10.735 Vali Acc: 0.481 Test Loss: 10.735 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.994873523712158
Epoch: 18, Steps: 32 | Train Loss: 0.137 Vali Loss: 13.099 Vali Acc: 0.542 Test Loss: 13.099 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.442317485809326
Epoch: 19, Steps: 32 | Train Loss: 0.304 Vali Loss: 12.723 Vali Acc: 0.458 Test Loss: 12.723 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.844651222229004
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.376 Vali Acc: 0.427 Test Loss: 13.376 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.628093004226685
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.206 Vali Acc: 0.450 Test Loss: 13.206 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.57515573501587
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.203 Vali Acc: 0.450 Test Loss: 13.203 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.160478353500366
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.202 Vali Acc: 0.450 Test Loss: 13.202 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.276442766189575
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.202 Vali Acc: 0.450 Test Loss: 13.202 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.41875147819519
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.202 Vali Acc: 0.450 Test Loss: 13.202 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2737589
model size : 14.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.028097867965698
Epoch: 1, Steps: 32 | Train Loss: 3.302 Vali Loss: 3.370 Vali Acc: 0.420 Test Loss: 3.370 Test Acc: 0.420
Validation loss decreased (inf --> -0.419814).  Saving model ...
Epoch: 2 cost time: 10.275325775146484
Epoch: 2, Steps: 32 | Train Loss: 4.278 Vali Loss: 4.902 Vali Acc: 0.435 Test Loss: 4.902 Test Acc: 0.435
Validation loss decreased (-0.419814 --> -0.435065).  Saving model ...
Epoch: 3 cost time: 10.204081058502197
Epoch: 3, Steps: 32 | Train Loss: 4.251 Vali Loss: 4.849 Vali Acc: 0.145 Test Loss: 4.849 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.356691122055054
Epoch: 4, Steps: 32 | Train Loss: 1.727 Vali Loss: 3.831 Vali Acc: 0.450 Test Loss: 3.831 Test Acc: 0.450
Validation loss decreased (-0.435065 --> -0.450343).  Saving model ...
Epoch: 5 cost time: 10.376481771469116
Epoch: 5, Steps: 32 | Train Loss: 1.208 Vali Loss: 8.749 Vali Acc: 0.382 Test Loss: 8.749 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.626806020736694
Epoch: 6, Steps: 32 | Train Loss: 0.304 Vali Loss: 8.256 Vali Acc: 0.504 Test Loss: 8.256 Test Acc: 0.504
Validation loss decreased (-0.450343 --> -0.503734).  Saving model ...
Epoch: 7 cost time: 10.472728252410889
Epoch: 7, Steps: 32 | Train Loss: 0.230 Vali Loss: 8.134 Vali Acc: 0.511 Test Loss: 8.134 Test Acc: 0.511
Validation loss decreased (-0.503734 --> -0.511369).  Saving model ...
Epoch: 8 cost time: 10.449747562408447
Epoch: 8, Steps: 32 | Train Loss: 0.224 Vali Loss: 6.382 Vali Acc: 0.458 Test Loss: 6.382 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.72191047668457
Epoch: 9, Steps: 32 | Train Loss: 0.566 Vali Loss: 7.716 Vali Acc: 0.496 Test Loss: 7.716 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.379167795181274
Epoch: 10, Steps: 32 | Train Loss: 0.641 Vali Loss: 10.438 Vali Acc: 0.496 Test Loss: 10.438 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.68958306312561
Epoch: 11, Steps: 32 | Train Loss: 0.229 Vali Loss: 10.535 Vali Acc: 0.466 Test Loss: 10.535 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.4249849319458
Epoch: 12, Steps: 32 | Train Loss: 0.206 Vali Loss: 10.911 Vali Acc: 0.527 Test Loss: 10.911 Test Acc: 0.527
Validation loss decreased (-0.511369 --> -0.526608).  Saving model ...
Epoch: 13 cost time: 10.205557107925415
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.708 Vali Acc: 0.527 Test Loss: 10.708 Test Acc: 0.527
Validation loss decreased (-0.526608 --> -0.526610).  Saving model ...
Epoch: 14 cost time: 10.662040948867798
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.577 Vali Acc: 0.527 Test Loss: 10.577 Test Acc: 0.527
Validation loss decreased (-0.526610 --> -0.526612).  Saving model ...
Epoch: 15 cost time: 10.464934825897217
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.532 Vali Acc: 0.527 Test Loss: 10.532 Test Acc: 0.527
Validation loss decreased (-0.526612 --> -0.526612).  Saving model ...
Epoch: 16 cost time: 10.62977123260498
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.530 Vali Acc: 0.527 Test Loss: 10.530 Test Acc: 0.527
Validation loss decreased (-0.526612 --> -0.526612).  Saving model ...
Epoch: 17 cost time: 10.474194765090942
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.23815369606018
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.490201473236084
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.536 Vali Acc: 0.527 Test Loss: 10.536 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.403372526168823
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.517171621322632
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.44559359550476
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 10.312140226364136
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.538 Vali Acc: 0.527 Test Loss: 10.538 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 10.313584804534912
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.538 Vali Acc: 0.527 Test Loss: 10.538 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 10.587521076202393
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.537 Vali Acc: 0.527 Test Loss: 10.537 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 10.669769287109375
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.535 Vali Acc: 0.527 Test Loss: 10.535 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2569653
model size : 14.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.546918392181396
Epoch: 1, Steps: 32 | Train Loss: 2.668 Vali Loss: 4.190 Vali Acc: 0.420 Test Loss: 4.190 Test Acc: 0.420
Validation loss decreased (inf --> -0.419805).  Saving model ...
Epoch: 2 cost time: 10.143040895462036
Epoch: 2, Steps: 32 | Train Loss: 4.929 Vali Loss: 6.501 Vali Acc: 0.420 Test Loss: 6.501 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.199782133102417
Epoch: 3, Steps: 32 | Train Loss: 1.835 Vali Loss: 5.302 Vali Acc: 0.244 Test Loss: 5.302 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.813367366790771
Epoch: 4, Steps: 32 | Train Loss: 2.283 Vali Loss: 6.696 Vali Acc: 0.237 Test Loss: 6.696 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.103787183761597
Epoch: 5, Steps: 32 | Train Loss: 1.245 Vali Loss: 7.393 Vali Acc: 0.344 Test Loss: 7.393 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.952327489852905
Epoch: 6, Steps: 32 | Train Loss: 0.637 Vali Loss: 10.858 Vali Acc: 0.427 Test Loss: 10.858 Test Acc: 0.427
Validation loss decreased (-0.419805 --> -0.427372).  Saving model ...
Epoch: 7 cost time: 9.799496412277222
Epoch: 7, Steps: 32 | Train Loss: 0.317 Vali Loss: 11.710 Vali Acc: 0.489 Test Loss: 11.710 Test Acc: 0.489
Validation loss decreased (-0.427372 --> -0.488433).  Saving model ...
Epoch: 8 cost time: 9.94695496559143
Epoch: 8, Steps: 32 | Train Loss: 0.217 Vali Loss: 8.624 Vali Acc: 0.489 Test Loss: 8.624 Test Acc: 0.489
Validation loss decreased (-0.488433 --> -0.488463).  Saving model ...
Epoch: 9 cost time: 9.928869724273682
Epoch: 9, Steps: 32 | Train Loss: 0.117 Vali Loss: 10.322 Vali Acc: 0.427 Test Loss: 10.322 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.963520526885986
Epoch: 10, Steps: 32 | Train Loss: 0.057 Vali Loss: 11.762 Vali Acc: 0.511 Test Loss: 11.762 Test Acc: 0.511
Validation loss decreased (-0.488463 --> -0.511333).  Saving model ...
Epoch: 11 cost time: 10.17214822769165
Epoch: 11, Steps: 32 | Train Loss: 0.168 Vali Loss: 9.896 Vali Acc: 0.527 Test Loss: 9.896 Test Acc: 0.527
Validation loss decreased (-0.511333 --> -0.526619).  Saving model ...
Epoch: 12 cost time: 10.069591522216797
Epoch: 12, Steps: 32 | Train Loss: 0.004 Vali Loss: 12.105 Vali Acc: 0.519 Test Loss: 12.105 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.974610567092896
Epoch: 13, Steps: 32 | Train Loss: 0.131 Vali Loss: 11.504 Vali Acc: 0.527 Test Loss: 11.504 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.962975263595581
Epoch: 14, Steps: 32 | Train Loss: 0.207 Vali Loss: 11.272 Vali Acc: 0.374 Test Loss: 11.272 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.98069977760315
Epoch: 15, Steps: 32 | Train Loss: 0.010 Vali Loss: 10.541 Vali Acc: 0.427 Test Loss: 10.541 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.132043361663818
Epoch: 16, Steps: 32 | Train Loss: 0.091 Vali Loss: 11.288 Vali Acc: 0.458 Test Loss: 11.288 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.120966672897339
Epoch: 17, Steps: 32 | Train Loss: 0.070 Vali Loss: 12.117 Vali Acc: 0.481 Test Loss: 12.117 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.954980611801147
Epoch: 18, Steps: 32 | Train Loss: 0.225 Vali Loss: 12.797 Vali Acc: 0.466 Test Loss: 12.797 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.877493143081665
Epoch: 19, Steps: 32 | Train Loss: 0.370 Vali Loss: 14.525 Vali Acc: 0.443 Test Loss: 14.525 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.137564420700073
Epoch: 20, Steps: 32 | Train Loss: 0.379 Vali Loss: 15.778 Vali Acc: 0.374 Test Loss: 15.778 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.170870065689087
Epoch: 21, Steps: 32 | Train Loss: 1.017 Vali Loss: 14.577 Vali Acc: 0.443 Test Loss: 14.577 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2401717
model size : 13.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.71602487564087
Epoch: 1, Steps: 32 | Train Loss: 3.199 Vali Loss: 4.468 Vali Acc: 0.420 Test Loss: 4.468 Test Acc: 0.420
Validation loss decreased (inf --> -0.419803).  Saving model ...
Epoch: 2 cost time: 10.17263674736023
Epoch: 2, Steps: 32 | Train Loss: 6.393 Vali Loss: 4.793 Vali Acc: 0.275 Test Loss: 4.793 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.487182378768921
Epoch: 3, Steps: 32 | Train Loss: 4.746 Vali Loss: 4.549 Vali Acc: 0.229 Test Loss: 4.549 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.482172966003418
Epoch: 4, Steps: 32 | Train Loss: 0.921 Vali Loss: 4.480 Vali Acc: 0.435 Test Loss: 4.480 Test Acc: 0.435
Validation loss decreased (-0.419803 --> -0.435070).  Saving model ...
Epoch: 5 cost time: 10.554271459579468
Epoch: 5, Steps: 32 | Train Loss: 1.480 Vali Loss: 5.884 Vali Acc: 0.496 Test Loss: 5.884 Test Acc: 0.496
Validation loss decreased (-0.435070 --> -0.496124).  Saving model ...
Epoch: 6 cost time: 10.371952295303345
Epoch: 6, Steps: 32 | Train Loss: 0.905 Vali Loss: 9.912 Vali Acc: 0.527 Test Loss: 9.912 Test Acc: 0.527
Validation loss decreased (-0.496124 --> -0.526618).  Saving model ...
Epoch: 7 cost time: 10.343767404556274
Epoch: 7, Steps: 32 | Train Loss: 0.455 Vali Loss: 9.539 Vali Acc: 0.481 Test Loss: 9.539 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.275447845458984
Epoch: 8, Steps: 32 | Train Loss: 0.104 Vali Loss: 8.180 Vali Acc: 0.450 Test Loss: 8.180 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.214686870574951
Epoch: 9, Steps: 32 | Train Loss: 0.160 Vali Loss: 7.931 Vali Acc: 0.458 Test Loss: 7.931 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.261983871459961
Epoch: 10, Steps: 32 | Train Loss: 0.025 Vali Loss: 11.021 Vali Acc: 0.427 Test Loss: 11.021 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.327404260635376
Epoch: 11, Steps: 32 | Train Loss: 0.030 Vali Loss: 10.201 Vali Acc: 0.420 Test Loss: 10.201 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.296183109283447
Epoch: 12, Steps: 32 | Train Loss: 0.077 Vali Loss: 9.354 Vali Acc: 0.511 Test Loss: 9.354 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.570458889007568
Epoch: 13, Steps: 32 | Train Loss: 0.011 Vali Loss: 10.872 Vali Acc: 0.542 Test Loss: 10.872 Test Acc: 0.542
Validation loss decreased (-0.526618 --> -0.541876).  Saving model ...
Epoch: 14 cost time: 10.390075922012329
Epoch: 14, Steps: 32 | Train Loss: 0.153 Vali Loss: 11.861 Vali Acc: 0.427 Test Loss: 11.861 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.955030679702759
Epoch: 15, Steps: 32 | Train Loss: 0.217 Vali Loss: 13.804 Vali Acc: 0.458 Test Loss: 13.804 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.427817821502686
Epoch: 16, Steps: 32 | Train Loss: 0.236 Vali Loss: 15.430 Vali Acc: 0.382 Test Loss: 15.430 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.6421217918396
Epoch: 17, Steps: 32 | Train Loss: 0.177 Vali Loss: 13.586 Vali Acc: 0.420 Test Loss: 13.586 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.438194990158081
Epoch: 18, Steps: 32 | Train Loss: 0.120 Vali Loss: 16.426 Vali Acc: 0.458 Test Loss: 16.426 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.763696432113647
Epoch: 19, Steps: 32 | Train Loss: 0.358 Vali Loss: 14.971 Vali Acc: 0.382 Test Loss: 14.971 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.598815679550171
Epoch: 20, Steps: 32 | Train Loss: 0.047 Vali Loss: 14.100 Vali Acc: 0.481 Test Loss: 14.100 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.214730501174927
Epoch: 21, Steps: 32 | Train Loss: 0.327 Vali Loss: 12.857 Vali Acc: 0.511 Test Loss: 12.857 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.414786100387573
Epoch: 22, Steps: 32 | Train Loss: 0.315 Vali Loss: 11.722 Vali Acc: 0.473 Test Loss: 11.722 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.206384897232056
Epoch: 23, Steps: 32 | Train Loss: 0.232 Vali Loss: 14.496 Vali Acc: 0.435 Test Loss: 14.496 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2674357
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.171871662139893
Epoch: 1, Steps: 32 | Train Loss: 2.527 Vali Loss: 2.768 Vali Acc: 0.420 Test Loss: 2.768 Test Acc: 0.420
Validation loss decreased (inf --> -0.419820).  Saving model ...
Epoch: 2 cost time: 10.10457468032837
Epoch: 2, Steps: 32 | Train Loss: 5.000 Vali Loss: 4.483 Vali Acc: 0.198 Test Loss: 4.483 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.390528678894043
Epoch: 3, Steps: 32 | Train Loss: 2.989 Vali Loss: 2.085 Vali Acc: 0.420 Test Loss: 2.085 Test Acc: 0.420
Validation loss decreased (-0.419820 --> -0.419826).  Saving model ...
Epoch: 4 cost time: 10.670207738876343
Epoch: 4, Steps: 32 | Train Loss: 1.955 Vali Loss: 6.997 Vali Acc: 0.252 Test Loss: 6.997 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.569443941116333
Epoch: 5, Steps: 32 | Train Loss: 1.453 Vali Loss: 7.160 Vali Acc: 0.435 Test Loss: 7.160 Test Acc: 0.435
Validation loss decreased (-0.419826 --> -0.435043).  Saving model ...
Epoch: 6 cost time: 10.433440923690796
Epoch: 6, Steps: 32 | Train Loss: 1.105 Vali Loss: 8.412 Vali Acc: 0.489 Test Loss: 8.412 Test Acc: 0.489
Validation loss decreased (-0.435043 --> -0.488465).  Saving model ...
Epoch: 7 cost time: 10.137564420700073
Epoch: 7, Steps: 32 | Train Loss: 0.163 Vali Loss: 8.727 Vali Acc: 0.489 Test Loss: 8.727 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.178665399551392
Epoch: 8, Steps: 32 | Train Loss: 0.131 Vali Loss: 9.150 Vali Acc: 0.542 Test Loss: 9.150 Test Acc: 0.542
Validation loss decreased (-0.488465 --> -0.541893).  Saving model ...
Epoch: 9 cost time: 10.734771251678467
Epoch: 9, Steps: 32 | Train Loss: 0.023 Vali Loss: 8.253 Vali Acc: 0.550 Test Loss: 8.253 Test Acc: 0.550
Validation loss decreased (-0.541893 --> -0.549536).  Saving model ...
Epoch: 10 cost time: 10.337239742279053
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.321 Vali Acc: 0.542 Test Loss: 8.321 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.543589115142822
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.287 Vali Acc: 0.542 Test Loss: 8.287 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.249638795852661
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.248 Vali Acc: 0.542 Test Loss: 8.248 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.075206756591797
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.248 Vali Acc: 0.542 Test Loss: 8.248 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.473212242126465
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.249 Vali Acc: 0.542 Test Loss: 8.249 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.25520133972168
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.242 Vali Acc: 0.542 Test Loss: 8.242 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.396873474121094
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.238 Vali Acc: 0.542 Test Loss: 8.238 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.230179786682129
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.227 Vali Acc: 0.542 Test Loss: 8.227 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.231108665466309
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.215 Vali Acc: 0.542 Test Loss: 8.215 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.285123586654663
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.221 Vali Acc: 0.542 Test Loss: 8.221 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2506421
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.543013334274292
Epoch: 1, Steps: 32 | Train Loss: 2.773 Vali Loss: 4.015 Vali Acc: 0.176 Test Loss: 4.015 Test Acc: 0.176
Validation loss decreased (inf --> -0.175532).  Saving model ...
Epoch: 2 cost time: 10.422752618789673
Epoch: 2, Steps: 32 | Train Loss: 3.808 Vali Loss: 4.806 Vali Acc: 0.336 Test Loss: 4.806 Test Acc: 0.336
Validation loss decreased (-0.175532 --> -0.335830).  Saving model ...
Epoch: 3 cost time: 10.479187250137329
Epoch: 3, Steps: 32 | Train Loss: 3.465 Vali Loss: 4.579 Vali Acc: 0.481 Test Loss: 4.579 Test Acc: 0.481
Validation loss decreased (-0.335830 --> -0.480870).  Saving model ...
Epoch: 4 cost time: 10.321924448013306
Epoch: 4, Steps: 32 | Train Loss: 1.486 Vali Loss: 5.088 Vali Acc: 0.458 Test Loss: 5.088 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.567880392074585
Epoch: 5, Steps: 32 | Train Loss: 1.502 Vali Loss: 7.545 Vali Acc: 0.481 Test Loss: 7.545 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.506570100784302
Epoch: 6, Steps: 32 | Train Loss: 0.916 Vali Loss: 6.398 Vali Acc: 0.412 Test Loss: 6.398 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.188767433166504
Epoch: 7, Steps: 32 | Train Loss: 0.198 Vali Loss: 9.705 Vali Acc: 0.382 Test Loss: 9.705 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.432917833328247
Epoch: 8, Steps: 32 | Train Loss: 0.201 Vali Loss: 9.089 Vali Acc: 0.473 Test Loss: 9.089 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.235094785690308
Epoch: 9, Steps: 32 | Train Loss: 0.004 Vali Loss: 9.950 Vali Acc: 0.466 Test Loss: 9.950 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.141886711120605
Epoch: 10, Steps: 32 | Train Loss: 0.271 Vali Loss: 10.375 Vali Acc: 0.435 Test Loss: 10.375 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.420662879943848
Epoch: 11, Steps: 32 | Train Loss: 0.001 Vali Loss: 9.398 Vali Acc: 0.435 Test Loss: 9.398 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.266122817993164
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.937 Vali Acc: 0.458 Test Loss: 8.937 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.131120920181274
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.930 Vali Acc: 0.450 Test Loss: 8.930 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 2338485
model size : 13.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.370569467544556
Epoch: 1, Steps: 32 | Train Loss: 3.806 Vali Loss: 2.931 Vali Acc: 0.107 Test Loss: 2.931 Test Acc: 0.107
Validation loss decreased (inf --> -0.106841).  Saving model ...
Epoch: 2 cost time: 9.77558970451355
Epoch: 2, Steps: 32 | Train Loss: 4.913 Vali Loss: 4.094 Vali Acc: 0.443 Test Loss: 4.094 Test Acc: 0.443
Validation loss decreased (-0.106841 --> -0.442707).  Saving model ...
Epoch: 3 cost time: 9.919291019439697
Epoch: 3, Steps: 32 | Train Loss: 4.477 Vali Loss: 5.805 Vali Acc: 0.489 Test Loss: 5.805 Test Acc: 0.489
Validation loss decreased (-0.442707 --> -0.488492).  Saving model ...
Epoch: 4 cost time: 9.66739821434021
Epoch: 4, Steps: 32 | Train Loss: 4.530 Vali Loss: 7.632 Vali Acc: 0.389 Test Loss: 7.632 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.270856618881226
Epoch: 5, Steps: 32 | Train Loss: 1.437 Vali Loss: 6.777 Vali Acc: 0.458 Test Loss: 6.777 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.870023250579834
Epoch: 6, Steps: 32 | Train Loss: 0.620 Vali Loss: 8.793 Vali Acc: 0.405 Test Loss: 8.793 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.150543928146362
Epoch: 7, Steps: 32 | Train Loss: 0.426 Vali Loss: 8.833 Vali Acc: 0.511 Test Loss: 8.833 Test Acc: 0.511
Validation loss decreased (-0.488492 --> -0.511362).  Saving model ...
Epoch: 8 cost time: 9.906311511993408
Epoch: 8, Steps: 32 | Train Loss: 0.049 Vali Loss: 11.242 Vali Acc: 0.328 Test Loss: 11.242 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.887450933456421
Epoch: 9, Steps: 32 | Train Loss: 0.203 Vali Loss: 8.185 Vali Acc: 0.420 Test Loss: 8.185 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.899022102355957
Epoch: 10, Steps: 32 | Train Loss: 0.104 Vali Loss: 13.951 Vali Acc: 0.336 Test Loss: 13.951 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.05640435218811
Epoch: 11, Steps: 32 | Train Loss: 0.390 Vali Loss: 9.739 Vali Acc: 0.473 Test Loss: 9.739 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.795612096786499
Epoch: 12, Steps: 32 | Train Loss: 0.062 Vali Loss: 13.914 Vali Acc: 0.389 Test Loss: 13.914 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.788930416107178
Epoch: 13, Steps: 32 | Train Loss: 0.217 Vali Loss: 12.591 Vali Acc: 0.504 Test Loss: 12.591 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.617785930633545
Epoch: 14, Steps: 32 | Train Loss: 0.061 Vali Loss: 12.644 Vali Acc: 0.366 Test Loss: 12.644 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.07396149635315
Epoch: 15, Steps: 32 | Train Loss: 0.188 Vali Loss: 12.737 Vali Acc: 0.412 Test Loss: 12.737 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.701304197311401
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 13.166 Vali Acc: 0.397 Test Loss: 13.166 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.056612253189087
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.368 Vali Acc: 0.496 Test Loss: 13.368 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2170549
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.464335203170776
Epoch: 1, Steps: 32 | Train Loss: 3.236 Vali Loss: 3.285 Vali Acc: 0.137 Test Loss: 3.285 Test Acc: 0.137
Validation loss decreased (inf --> -0.137372).  Saving model ...
Epoch: 2 cost time: 10.596935272216797
Epoch: 2, Steps: 32 | Train Loss: 4.960 Vali Loss: 2.934 Vali Acc: 0.435 Test Loss: 2.934 Test Acc: 0.435
Validation loss decreased (-0.137372 --> -0.435085).  Saving model ...
Epoch: 3 cost time: 10.602106809616089
Epoch: 3, Steps: 32 | Train Loss: 3.014 Vali Loss: 5.385 Vali Acc: 0.450 Test Loss: 5.385 Test Acc: 0.450
Validation loss decreased (-0.435085 --> -0.450328).  Saving model ...
Epoch: 4 cost time: 10.37851333618164
Epoch: 4, Steps: 32 | Train Loss: 1.788 Vali Loss: 3.229 Vali Acc: 0.458 Test Loss: 3.229 Test Acc: 0.458
Validation loss decreased (-0.450328 --> -0.457983).  Saving model ...
Epoch: 5 cost time: 10.355694770812988
Epoch: 5, Steps: 32 | Train Loss: 0.517 Vali Loss: 8.033 Vali Acc: 0.519 Test Loss: 8.033 Test Acc: 0.519
Validation loss decreased (-0.457983 --> -0.519004).  Saving model ...
Epoch: 6 cost time: 10.526220560073853
Epoch: 6, Steps: 32 | Train Loss: 0.526 Vali Loss: 10.593 Vali Acc: 0.489 Test Loss: 10.593 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.422286748886108
Epoch: 7, Steps: 32 | Train Loss: 0.667 Vali Loss: 7.948 Vali Acc: 0.527 Test Loss: 7.948 Test Acc: 0.527
Validation loss decreased (-0.519004 --> -0.526638).  Saving model ...
Epoch: 8 cost time: 10.369603872299194
Epoch: 8, Steps: 32 | Train Loss: 0.100 Vali Loss: 7.364 Vali Acc: 0.466 Test Loss: 7.364 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.716461181640625
Epoch: 9, Steps: 32 | Train Loss: 0.022 Vali Loss: 8.588 Vali Acc: 0.412 Test Loss: 8.588 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.206048250198364
Epoch: 10, Steps: 32 | Train Loss: 0.104 Vali Loss: 8.301 Vali Acc: 0.427 Test Loss: 8.301 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.37938141822815
Epoch: 11, Steps: 32 | Train Loss: 0.033 Vali Loss: 9.398 Vali Acc: 0.473 Test Loss: 9.398 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.255760192871094
Epoch: 12, Steps: 32 | Train Loss: 0.020 Vali Loss: 11.488 Vali Acc: 0.504 Test Loss: 11.488 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.567793369293213
Epoch: 13, Steps: 32 | Train Loss: 0.146 Vali Loss: 10.251 Vali Acc: 0.450 Test Loss: 10.251 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.631465673446655
Epoch: 14, Steps: 32 | Train Loss: 0.111 Vali Loss: 12.824 Vali Acc: 0.412 Test Loss: 12.824 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.43472695350647
Epoch: 15, Steps: 32 | Train Loss: 0.328 Vali Loss: 12.473 Vali Acc: 0.458 Test Loss: 12.473 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.35012936592102
Epoch: 16, Steps: 32 | Train Loss: 0.130 Vali Loss: 13.195 Vali Acc: 0.504 Test Loss: 13.195 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.348257064819336
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.678 Vali Acc: 0.420 Test Loss: 13.678 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2558773
model size : 14.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.637810468673706
Epoch: 1, Steps: 32 | Train Loss: 2.754 Vali Loss: 2.895 Vali Acc: 0.168 Test Loss: 2.895 Test Acc: 0.168
Validation loss decreased (inf --> -0.167910).  Saving model ...
Epoch: 2 cost time: 10.380329132080078
Epoch: 2, Steps: 32 | Train Loss: 4.820 Vali Loss: 6.387 Vali Acc: 0.137 Test Loss: 6.387 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.364458322525024
Epoch: 3, Steps: 32 | Train Loss: 7.811 Vali Loss: 5.752 Vali Acc: 0.198 Test Loss: 5.752 Test Acc: 0.198
Validation loss decreased (-0.167910 --> -0.198416).  Saving model ...
Epoch: 4 cost time: 9.89464282989502
Epoch: 4, Steps: 32 | Train Loss: 2.226 Vali Loss: 5.081 Vali Acc: 0.313 Test Loss: 5.081 Test Acc: 0.313
Validation loss decreased (-0.198416 --> -0.312926).  Saving model ...
Epoch: 5 cost time: 10.109313488006592
Epoch: 5, Steps: 32 | Train Loss: 0.876 Vali Loss: 5.718 Vali Acc: 0.427 Test Loss: 5.718 Test Acc: 0.427
Validation loss decreased (-0.312926 --> -0.427424).  Saving model ...
Epoch: 6 cost time: 10.205551147460938
Epoch: 6, Steps: 32 | Train Loss: 0.871 Vali Loss: 8.804 Vali Acc: 0.466 Test Loss: 8.804 Test Acc: 0.466
Validation loss decreased (-0.427424 --> -0.465561).  Saving model ...
Epoch: 7 cost time: 10.202257871627808
Epoch: 7, Steps: 32 | Train Loss: 0.316 Vali Loss: 9.093 Vali Acc: 0.496 Test Loss: 9.093 Test Acc: 0.496
Validation loss decreased (-0.465561 --> -0.496092).  Saving model ...
Epoch: 8 cost time: 10.024764776229858
Epoch: 8, Steps: 32 | Train Loss: 0.271 Vali Loss: 8.500 Vali Acc: 0.473 Test Loss: 8.500 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.863929033279419
Epoch: 9, Steps: 32 | Train Loss: 0.173 Vali Loss: 8.545 Vali Acc: 0.435 Test Loss: 8.545 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.250083923339844
Epoch: 10, Steps: 32 | Train Loss: 0.078 Vali Loss: 8.958 Vali Acc: 0.481 Test Loss: 8.958 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.464704036712646
Epoch: 11, Steps: 32 | Train Loss: 0.058 Vali Loss: 9.243 Vali Acc: 0.443 Test Loss: 9.243 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.47642731666565
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.179 Vali Acc: 0.405 Test Loss: 10.179 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.720351457595825
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.134 Vali Acc: 0.420 Test Loss: 10.134 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.213770151138306
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.124 Vali Acc: 0.420 Test Loss: 10.124 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.284221172332764
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.120 Vali Acc: 0.420 Test Loss: 10.120 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.239484071731567
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.115 Vali Acc: 0.420 Test Loss: 10.115 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.415915966033936
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.111 Vali Acc: 0.420 Test Loss: 10.111 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 2390837
model size : 13.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.190510749816895
Epoch: 1, Steps: 32 | Train Loss: 2.647 Vali Loss: 3.825 Vali Acc: 0.420 Test Loss: 3.825 Test Acc: 0.420
Validation loss decreased (inf --> -0.419809).  Saving model ...
Epoch: 2 cost time: 9.997823476791382
Epoch: 2, Steps: 32 | Train Loss: 4.045 Vali Loss: 4.409 Vali Acc: 0.466 Test Loss: 4.409 Test Acc: 0.466
Validation loss decreased (-0.419809 --> -0.465605).  Saving model ...
Epoch: 3 cost time: 10.320537567138672
Epoch: 3, Steps: 32 | Train Loss: 4.270 Vali Loss: 4.075 Vali Acc: 0.489 Test Loss: 4.075 Test Acc: 0.489
Validation loss decreased (-0.465605 --> -0.488509).  Saving model ...
Epoch: 4 cost time: 10.341488361358643
Epoch: 4, Steps: 32 | Train Loss: 2.970 Vali Loss: 9.094 Vali Acc: 0.191 Test Loss: 9.094 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.07555079460144
Epoch: 5, Steps: 32 | Train Loss: 1.318 Vali Loss: 6.891 Vali Acc: 0.496 Test Loss: 6.891 Test Acc: 0.496
Validation loss decreased (-0.488509 --> -0.496114).  Saving model ...
Epoch: 6 cost time: 10.104358673095703
Epoch: 6, Steps: 32 | Train Loss: 1.334 Vali Loss: 7.214 Vali Acc: 0.519 Test Loss: 7.214 Test Acc: 0.519
Validation loss decreased (-0.496114 --> -0.519012).  Saving model ...
Epoch: 7 cost time: 10.02867078781128
Epoch: 7, Steps: 32 | Train Loss: 0.236 Vali Loss: 11.231 Vali Acc: 0.351 Test Loss: 11.231 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.183542490005493
Epoch: 8, Steps: 32 | Train Loss: 0.163 Vali Loss: 9.553 Vali Acc: 0.550 Test Loss: 9.553 Test Acc: 0.550
Validation loss decreased (-0.519012 --> -0.549523).  Saving model ...
Epoch: 9 cost time: 10.306058883666992
Epoch: 9, Steps: 32 | Train Loss: 0.009 Vali Loss: 8.960 Vali Acc: 0.550 Test Loss: 8.960 Test Acc: 0.550
Validation loss decreased (-0.549523 --> -0.549529).  Saving model ...
Epoch: 10 cost time: 10.250940322875977
Epoch: 10, Steps: 32 | Train Loss: 0.606 Vali Loss: 10.194 Vali Acc: 0.557 Test Loss: 10.194 Test Acc: 0.557
Validation loss decreased (-0.549529 --> -0.557150).  Saving model ...
Epoch: 11 cost time: 10.263103485107422
Epoch: 11, Steps: 32 | Train Loss: 0.156 Vali Loss: 10.843 Vali Acc: 0.519 Test Loss: 10.843 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.004702806472778
Epoch: 12, Steps: 32 | Train Loss: 0.286 Vali Loss: 15.136 Vali Acc: 0.466 Test Loss: 15.136 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.103960990905762
Epoch: 13, Steps: 32 | Train Loss: 0.199 Vali Loss: 10.397 Vali Acc: 0.435 Test Loss: 10.397 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.125445365905762
Epoch: 14, Steps: 32 | Train Loss: 0.102 Vali Loss: 12.972 Vali Acc: 0.504 Test Loss: 12.972 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.086082458496094
Epoch: 15, Steps: 32 | Train Loss: 0.200 Vali Loss: 11.970 Vali Acc: 0.504 Test Loss: 11.970 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.054127931594849
Epoch: 16, Steps: 32 | Train Loss: 0.358 Vali Loss: 11.490 Vali Acc: 0.435 Test Loss: 11.490 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.159357786178589
Epoch: 17, Steps: 32 | Train Loss: 0.283 Vali Loss: 13.429 Vali Acc: 0.527 Test Loss: 13.429 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.049256801605225
Epoch: 18, Steps: 32 | Train Loss: 0.147 Vali Loss: 11.445 Vali Acc: 0.405 Test Loss: 11.445 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.156127452850342
Epoch: 19, Steps: 32 | Train Loss: 0.159 Vali Loss: 12.459 Vali Acc: 0.389 Test Loss: 12.459 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.941843748092651
Epoch: 20, Steps: 32 | Train Loss: 0.036 Vali Loss: 15.035 Vali Acc: 0.382 Test Loss: 15.035 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 2222901
model size : 13.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.444386959075928
Epoch: 1, Steps: 32 | Train Loss: 3.259 Vali Loss: 5.710 Vali Acc: 0.168 Test Loss: 5.710 Test Acc: 0.168
Validation loss decreased (inf --> -0.167882).  Saving model ...
Epoch: 2 cost time: 9.81464147567749
Epoch: 2, Steps: 32 | Train Loss: 4.055 Vali Loss: 8.044 Vali Acc: 0.420 Test Loss: 8.044 Test Acc: 0.420
Validation loss decreased (-0.167882 --> -0.419767).  Saving model ...
Epoch: 3 cost time: 10.035252571105957
Epoch: 3, Steps: 32 | Train Loss: 4.448 Vali Loss: 3.576 Vali Acc: 0.389 Test Loss: 3.576 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.572280883789062
Epoch: 4, Steps: 32 | Train Loss: 3.007 Vali Loss: 9.222 Vali Acc: 0.481 Test Loss: 9.222 Test Acc: 0.481
Validation loss decreased (-0.419767 --> -0.480824).  Saving model ...
Epoch: 5 cost time: 9.86150860786438
Epoch: 5, Steps: 32 | Train Loss: 1.395 Vali Loss: 7.799 Vali Acc: 0.420 Test Loss: 7.799 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.936485528945923
Epoch: 6, Steps: 32 | Train Loss: 1.225 Vali Loss: 10.436 Vali Acc: 0.359 Test Loss: 10.436 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.952467203140259
Epoch: 7, Steps: 32 | Train Loss: 0.458 Vali Loss: 9.520 Vali Acc: 0.443 Test Loss: 9.520 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.805336713790894
Epoch: 8, Steps: 32 | Train Loss: 0.277 Vali Loss: 10.706 Vali Acc: 0.504 Test Loss: 10.706 Test Acc: 0.504
Validation loss decreased (-0.480824 --> -0.503710).  Saving model ...
Epoch: 9 cost time: 9.703321933746338
Epoch: 9, Steps: 32 | Train Loss: 0.106 Vali Loss: 11.274 Vali Acc: 0.443 Test Loss: 11.274 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.81821346282959
Epoch: 10, Steps: 32 | Train Loss: 0.268 Vali Loss: 14.952 Vali Acc: 0.511 Test Loss: 14.952 Test Acc: 0.511
Validation loss decreased (-0.503710 --> -0.511301).  Saving model ...
Epoch: 11 cost time: 9.774156332015991
Epoch: 11, Steps: 32 | Train Loss: 0.411 Vali Loss: 12.892 Vali Acc: 0.473 Test Loss: 12.892 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.161988496780396
Epoch: 12, Steps: 32 | Train Loss: 0.018 Vali Loss: 11.109 Vali Acc: 0.481 Test Loss: 11.109 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.835697174072266
Epoch: 13, Steps: 32 | Train Loss: 0.005 Vali Loss: 12.339 Vali Acc: 0.519 Test Loss: 12.339 Test Acc: 0.519
Validation loss decreased (-0.511301 --> -0.518961).  Saving model ...
Epoch: 14 cost time: 10.127554893493652
Epoch: 14, Steps: 32 | Train Loss: 0.021 Vali Loss: 12.760 Vali Acc: 0.489 Test Loss: 12.760 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.588517189025879
Epoch: 15, Steps: 32 | Train Loss: 0.012 Vali Loss: 10.833 Vali Acc: 0.427 Test Loss: 10.833 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.781807661056519
Epoch: 16, Steps: 32 | Train Loss: 0.572 Vali Loss: 15.132 Vali Acc: 0.489 Test Loss: 15.132 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.938524723052979
Epoch: 17, Steps: 32 | Train Loss: 0.348 Vali Loss: 14.433 Vali Acc: 0.458 Test Loss: 14.433 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.276162385940552
Epoch: 18, Steps: 32 | Train Loss: 0.204 Vali Loss: 13.023 Vali Acc: 0.481 Test Loss: 13.023 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.129511594772339
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.237 Vali Acc: 0.450 Test Loss: 13.237 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.792413473129272
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.959 Vali Acc: 0.427 Test Loss: 13.959 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.858113765716553
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.979 Vali Acc: 0.427 Test Loss: 13.979 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.097845315933228
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.979 Vali Acc: 0.427 Test Loss: 13.979 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.062560558319092
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.978 Vali Acc: 0.427 Test Loss: 13.978 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2054965
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.057045459747314
Epoch: 1, Steps: 32 | Train Loss: 2.126 Vali Loss: 2.502 Vali Acc: 0.420 Test Loss: 2.502 Test Acc: 0.420
Validation loss decreased (inf --> -0.419822).  Saving model ...
Epoch: 2 cost time: 9.965256452560425
Epoch: 2, Steps: 32 | Train Loss: 2.560 Vali Loss: 3.545 Vali Acc: 0.420 Test Loss: 3.545 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.113154649734497
Epoch: 3, Steps: 32 | Train Loss: 3.044 Vali Loss: 2.967 Vali Acc: 0.160 Test Loss: 2.967 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.970209121704102
Epoch: 4, Steps: 32 | Train Loss: 1.386 Vali Loss: 3.487 Vali Acc: 0.466 Test Loss: 3.487 Test Acc: 0.466
Validation loss decreased (-0.419822 --> -0.465614).  Saving model ...
Epoch: 5 cost time: 10.175851583480835
Epoch: 5, Steps: 32 | Train Loss: 0.787 Vali Loss: 4.353 Vali Acc: 0.489 Test Loss: 4.353 Test Acc: 0.489
Validation loss decreased (-0.465614 --> -0.488506).  Saving model ...
Epoch: 6 cost time: 10.226279735565186
Epoch: 6, Steps: 32 | Train Loss: 0.290 Vali Loss: 4.381 Vali Acc: 0.458 Test Loss: 4.381 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.033158540725708
Epoch: 7, Steps: 32 | Train Loss: 0.155 Vali Loss: 4.454 Vali Acc: 0.435 Test Loss: 4.454 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.993058204650879
Epoch: 8, Steps: 32 | Train Loss: 0.050 Vali Loss: 4.345 Vali Acc: 0.397 Test Loss: 4.345 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.039367914199829
Epoch: 9, Steps: 32 | Train Loss: 0.008 Vali Loss: 7.930 Vali Acc: 0.282 Test Loss: 7.930 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.029321193695068
Epoch: 10, Steps: 32 | Train Loss: 0.033 Vali Loss: 5.702 Vali Acc: 0.412 Test Loss: 5.702 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.311916828155518
Epoch: 11, Steps: 32 | Train Loss: 0.030 Vali Loss: 4.976 Vali Acc: 0.435 Test Loss: 4.976 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.167399168014526
Epoch: 12, Steps: 32 | Train Loss: 0.018 Vali Loss: 6.864 Vali Acc: 0.321 Test Loss: 6.864 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.100361108779907
Epoch: 13, Steps: 32 | Train Loss: 0.025 Vali Loss: 5.144 Vali Acc: 0.374 Test Loss: 5.144 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.846219062805176
Epoch: 14, Steps: 32 | Train Loss: 0.021 Vali Loss: 5.879 Vali Acc: 0.519 Test Loss: 5.879 Test Acc: 0.519
Validation loss decreased (-0.488506 --> -0.519025).  Saving model ...
Epoch: 15 cost time: 10.114561796188354
Epoch: 15, Steps: 32 | Train Loss: 0.017 Vali Loss: 5.309 Vali Acc: 0.466 Test Loss: 5.309 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.012682914733887
Epoch: 16, Steps: 32 | Train Loss: 0.033 Vali Loss: 5.825 Vali Acc: 0.466 Test Loss: 5.825 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.128865718841553
Epoch: 17, Steps: 32 | Train Loss: 0.027 Vali Loss: 5.976 Vali Acc: 0.466 Test Loss: 5.976 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.861611366271973
Epoch: 18, Steps: 32 | Train Loss: 0.065 Vali Loss: 5.940 Vali Acc: 0.527 Test Loss: 5.940 Test Acc: 0.527
Validation loss decreased (-0.519025 --> -0.526658).  Saving model ...
Epoch: 19 cost time: 10.082135915756226
Epoch: 19, Steps: 32 | Train Loss: 0.285 Vali Loss: 7.779 Vali Acc: 0.489 Test Loss: 7.779 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.039350748062134
Epoch: 20, Steps: 32 | Train Loss: 0.246 Vali Loss: 10.915 Vali Acc: 0.542 Test Loss: 10.915 Test Acc: 0.542
Validation loss decreased (-0.526658 --> -0.541876).  Saving model ...
Epoch: 21 cost time: 9.884270191192627
Epoch: 21, Steps: 32 | Train Loss: 0.080 Vali Loss: 9.600 Vali Acc: 0.527 Test Loss: 9.600 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.944781303405762
Epoch: 22, Steps: 32 | Train Loss: 0.028 Vali Loss: 11.697 Vali Acc: 0.504 Test Loss: 11.697 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.89290738105774
Epoch: 23, Steps: 32 | Train Loss: 0.374 Vali Loss: 9.883 Vali Acc: 0.504 Test Loss: 9.883 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.935469150543213
Epoch: 24, Steps: 32 | Train Loss: 0.039 Vali Loss: 10.832 Vali Acc: 0.435 Test Loss: 10.832 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.9939546585083
Epoch: 25, Steps: 32 | Train Loss: 0.080 Vali Loss: 10.406 Vali Acc: 0.504 Test Loss: 10.406 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.178942441940308
Epoch: 26, Steps: 32 | Train Loss: 0.047 Vali Loss: 8.746 Vali Acc: 0.420 Test Loss: 8.746 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.131844520568848
Epoch: 27, Steps: 32 | Train Loss: 0.272 Vali Loss: 8.847 Vali Acc: 0.443 Test Loss: 8.847 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.131683588027954
Epoch: 28, Steps: 32 | Train Loss: 0.109 Vali Loss: 9.355 Vali Acc: 0.382 Test Loss: 9.355 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.046416759490967
Epoch: 29, Steps: 32 | Train Loss: 0.112 Vali Loss: 9.571 Vali Acc: 0.435 Test Loss: 9.571 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.02003002166748
Epoch: 30, Steps: 32 | Train Loss: 0.105 Vali Loss: 9.683 Vali Acc: 0.450 Test Loss: 9.683 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1572853
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.276771783828735
Epoch: 1, Steps: 32 | Train Loss: 2.808 Vali Loss: 4.024 Vali Acc: 0.420 Test Loss: 4.024 Test Acc: 0.420
Validation loss decreased (inf --> -0.419807).  Saving model ...
Epoch: 2 cost time: 9.915838956832886
Epoch: 2, Steps: 32 | Train Loss: 3.336 Vali Loss: 3.677 Vali Acc: 0.229 Test Loss: 3.677 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.78212594985962
Epoch: 3, Steps: 32 | Train Loss: 2.054 Vali Loss: 4.605 Vali Acc: 0.473 Test Loss: 4.605 Test Acc: 0.473
Validation loss decreased (-0.419807 --> -0.473236).  Saving model ...
Epoch: 4 cost time: 9.701834678649902
Epoch: 4, Steps: 32 | Train Loss: 1.101 Vali Loss: 5.387 Vali Acc: 0.496 Test Loss: 5.387 Test Acc: 0.496
Validation loss decreased (-0.473236 --> -0.496129).  Saving model ...
Epoch: 5 cost time: 9.807738065719604
Epoch: 5, Steps: 32 | Train Loss: 0.359 Vali Loss: 3.085 Vali Acc: 0.489 Test Loss: 3.085 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.694218873977661
Epoch: 6, Steps: 32 | Train Loss: 0.289 Vali Loss: 4.284 Vali Acc: 0.481 Test Loss: 4.284 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.869929075241089
Epoch: 7, Steps: 32 | Train Loss: 0.542 Vali Loss: 6.559 Vali Acc: 0.519 Test Loss: 6.559 Test Acc: 0.519
Validation loss decreased (-0.496129 --> -0.519018).  Saving model ...
Epoch: 8 cost time: 9.685961246490479
Epoch: 8, Steps: 32 | Train Loss: 0.054 Vali Loss: 7.800 Vali Acc: 0.511 Test Loss: 7.800 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.85305118560791
Epoch: 9, Steps: 32 | Train Loss: 0.204 Vali Loss: 5.517 Vali Acc: 0.519 Test Loss: 5.517 Test Acc: 0.519
Validation loss decreased (-0.519018 --> -0.519029).  Saving model ...
Epoch: 10 cost time: 10.14918565750122
Epoch: 10, Steps: 32 | Train Loss: 0.028 Vali Loss: 6.123 Vali Acc: 0.511 Test Loss: 6.123 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.960198640823364
Epoch: 11, Steps: 32 | Train Loss: 0.059 Vali Loss: 4.858 Vali Acc: 0.458 Test Loss: 4.858 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.111904621124268
Epoch: 12, Steps: 32 | Train Loss: 0.026 Vali Loss: 4.410 Vali Acc: 0.511 Test Loss: 4.410 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.06544280052185
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.323 Vali Acc: 0.504 Test Loss: 5.323 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.876070022583008
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.356 Vali Acc: 0.504 Test Loss: 5.356 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.997822999954224
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.308 Vali Acc: 0.504 Test Loss: 5.308 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.897782564163208
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.295 Vali Acc: 0.504 Test Loss: 5.295 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.052411794662476
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.504 Test Loss: 5.280 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.874547243118286
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.262 Vali Acc: 0.504 Test Loss: 5.262 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.775822877883911
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.504 Test Loss: 5.223 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1488885
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.175630331039429
Epoch: 1, Steps: 32 | Train Loss: 2.111 Vali Loss: 1.928 Vali Acc: 0.427 Test Loss: 1.928 Test Acc: 0.427
Validation loss decreased (inf --> -0.427462).  Saving model ...
Epoch: 2 cost time: 9.929880142211914
Epoch: 2, Steps: 32 | Train Loss: 3.364 Vali Loss: 4.129 Vali Acc: 0.176 Test Loss: 4.129 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.86971402168274
Epoch: 3, Steps: 32 | Train Loss: 1.981 Vali Loss: 2.350 Vali Acc: 0.282 Test Loss: 2.350 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.68120527267456
Epoch: 4, Steps: 32 | Train Loss: 0.732 Vali Loss: 2.981 Vali Acc: 0.504 Test Loss: 2.981 Test Acc: 0.504
Validation loss decreased (-0.427462 --> -0.503787).  Saving model ...
Epoch: 5 cost time: 10.104723930358887
Epoch: 5, Steps: 32 | Train Loss: 0.360 Vali Loss: 4.076 Vali Acc: 0.504 Test Loss: 4.076 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.918768167495728
Epoch: 6, Steps: 32 | Train Loss: 0.097 Vali Loss: 4.540 Vali Acc: 0.519 Test Loss: 4.540 Test Acc: 0.519
Validation loss decreased (-0.503787 --> -0.519039).  Saving model ...
Epoch: 7 cost time: 9.947519063949585
Epoch: 7, Steps: 32 | Train Loss: 0.020 Vali Loss: 4.998 Vali Acc: 0.473 Test Loss: 4.998 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.926506280899048
Epoch: 8, Steps: 32 | Train Loss: 0.033 Vali Loss: 5.077 Vali Acc: 0.458 Test Loss: 5.077 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.881494522094727
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.577 Vali Acc: 0.496 Test Loss: 4.577 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.000475406646729
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.686 Vali Acc: 0.496 Test Loss: 4.686 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.95967721939087
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.706 Vali Acc: 0.504 Test Loss: 4.706 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.953855514526367
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.709 Vali Acc: 0.504 Test Loss: 4.709 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.116625547409058
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.504 Test Loss: 4.743 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.980372190475464
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.750 Vali Acc: 0.504 Test Loss: 4.750 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.902087450027466
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.504 Test Loss: 4.753 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.030046224594116
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.777 Vali Acc: 0.504 Test Loss: 4.777 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1404917
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.073513746261597
Epoch: 1, Steps: 32 | Train Loss: 2.479 Vali Loss: 3.091 Vali Acc: 0.137 Test Loss: 3.091 Test Acc: 0.137
Validation loss decreased (inf --> -0.137374).  Saving model ...
Epoch: 2 cost time: 9.706918001174927
Epoch: 2, Steps: 32 | Train Loss: 3.525 Vali Loss: 1.617 Vali Acc: 0.458 Test Loss: 1.617 Test Acc: 0.458
Validation loss decreased (-0.137374 --> -0.457999).  Saving model ...
Epoch: 3 cost time: 9.385189771652222
Epoch: 3, Steps: 32 | Train Loss: 3.043 Vali Loss: 5.143 Vali Acc: 0.374 Test Loss: 5.143 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.730999946594238
Epoch: 4, Steps: 32 | Train Loss: 2.464 Vali Loss: 4.047 Vali Acc: 0.275 Test Loss: 4.047 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.611943483352661
Epoch: 5, Steps: 32 | Train Loss: 0.836 Vali Loss: 3.186 Vali Acc: 0.344 Test Loss: 3.186 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.877162218093872
Epoch: 6, Steps: 32 | Train Loss: 0.261 Vali Loss: 4.333 Vali Acc: 0.504 Test Loss: 4.333 Test Acc: 0.504
Validation loss decreased (-0.457999 --> -0.503773).  Saving model ...
Epoch: 7 cost time: 10.31084680557251
Epoch: 7, Steps: 32 | Train Loss: 0.154 Vali Loss: 3.927 Vali Acc: 0.458 Test Loss: 3.927 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.710550546646118
Epoch: 8, Steps: 32 | Train Loss: 0.016 Vali Loss: 6.499 Vali Acc: 0.351 Test Loss: 6.499 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.757575035095215
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.332 Vali Acc: 0.443 Test Loss: 5.332 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.896519899368286
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.566 Vali Acc: 0.458 Test Loss: 5.566 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.915937423706055
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.358 Vali Acc: 0.450 Test Loss: 5.358 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.789515018463135
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.567 Vali Acc: 0.458 Test Loss: 5.567 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.862839937210083
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.549 Vali Acc: 0.458 Test Loss: 5.549 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.625464916229248
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.516 Vali Acc: 0.450 Test Loss: 5.516 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.88476014137268
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.487 Vali Acc: 0.450 Test Loss: 5.487 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.711475372314453
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.478 Vali Acc: 0.450 Test Loss: 5.478 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 1320949
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.410387992858887
Epoch: 1, Steps: 32 | Train Loss: 2.846 Vali Loss: 2.371 Vali Acc: 0.420 Test Loss: 2.371 Test Acc: 0.420
Validation loss decreased (inf --> -0.419824).  Saving model ...
Epoch: 2 cost time: 9.58291220664978
Epoch: 2, Steps: 32 | Train Loss: 2.710 Vali Loss: 2.583 Vali Acc: 0.237 Test Loss: 2.583 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.741497039794922
Epoch: 3, Steps: 32 | Train Loss: 2.381 Vali Loss: 1.760 Vali Acc: 0.443 Test Loss: 1.760 Test Acc: 0.443
Validation loss decreased (-0.419824 --> -0.442730).  Saving model ...
Epoch: 4 cost time: 9.675210952758789
Epoch: 4, Steps: 32 | Train Loss: 0.912 Vali Loss: 3.835 Vali Acc: 0.511 Test Loss: 3.835 Test Acc: 0.511
Validation loss decreased (-0.442730 --> -0.511412).  Saving model ...
Epoch: 5 cost time: 9.711359024047852
Epoch: 5, Steps: 32 | Train Loss: 0.937 Vali Loss: 4.454 Vali Acc: 0.405 Test Loss: 4.454 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.663184642791748
Epoch: 6, Steps: 32 | Train Loss: 0.518 Vali Loss: 6.039 Vali Acc: 0.290 Test Loss: 6.039 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.914840459823608
Epoch: 7, Steps: 32 | Train Loss: 0.145 Vali Loss: 6.118 Vali Acc: 0.473 Test Loss: 6.118 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.700175762176514
Epoch: 8, Steps: 32 | Train Loss: 0.145 Vali Loss: 4.856 Vali Acc: 0.412 Test Loss: 4.856 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.815536975860596
Epoch: 9, Steps: 32 | Train Loss: 0.033 Vali Loss: 7.056 Vali Acc: 0.496 Test Loss: 7.056 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.796997547149658
Epoch: 10, Steps: 32 | Train Loss: 0.021 Vali Loss: 6.694 Vali Acc: 0.542 Test Loss: 6.694 Test Acc: 0.542
Validation loss decreased (-0.511412 --> -0.541918).  Saving model ...
Epoch: 11 cost time: 10.027681589126587
Epoch: 11, Steps: 32 | Train Loss: 0.070 Vali Loss: 6.191 Vali Acc: 0.443 Test Loss: 6.191 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.768175601959229
Epoch: 12, Steps: 32 | Train Loss: 0.009 Vali Loss: 6.387 Vali Acc: 0.473 Test Loss: 6.387 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.100301027297974
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.465 Vali Acc: 0.458 Test Loss: 6.465 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.705808162689209
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.470 Vali Acc: 0.458 Test Loss: 6.470 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.154119968414307
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.467 Vali Acc: 0.458 Test Loss: 6.467 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.122056245803833
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.465 Vali Acc: 0.458 Test Loss: 6.465 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.928729057312012
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.455 Vali Acc: 0.458 Test Loss: 6.455 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.121987104415894
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.451 Vali Acc: 0.458 Test Loss: 6.451 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.921912908554077
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.450 Vali Acc: 0.458 Test Loss: 6.450 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.023812770843506
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.451 Vali Acc: 0.458 Test Loss: 6.451 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1339893
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.724040508270264
Epoch: 1, Steps: 32 | Train Loss: 2.451 Vali Loss: 3.177 Vali Acc: 0.420 Test Loss: 3.177 Test Acc: 0.420
Validation loss decreased (inf --> -0.419816).  Saving model ...
Epoch: 2 cost time: 9.895819425582886
Epoch: 2, Steps: 32 | Train Loss: 3.279 Vali Loss: 9.136 Vali Acc: 0.176 Test Loss: 9.136 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.79344391822815
Epoch: 3, Steps: 32 | Train Loss: 3.260 Vali Loss: 5.258 Vali Acc: 0.435 Test Loss: 5.258 Test Acc: 0.435
Validation loss decreased (-0.419816 --> -0.435062).  Saving model ...
Epoch: 4 cost time: 9.864922523498535
Epoch: 4, Steps: 32 | Train Loss: 3.137 Vali Loss: 2.420 Vali Acc: 0.336 Test Loss: 2.420 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.817455291748047
Epoch: 5, Steps: 32 | Train Loss: 0.907 Vali Loss: 4.864 Vali Acc: 0.382 Test Loss: 4.864 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.754331350326538
Epoch: 6, Steps: 32 | Train Loss: 0.338 Vali Loss: 3.952 Vali Acc: 0.550 Test Loss: 3.952 Test Acc: 0.550
Validation loss decreased (-0.435062 --> -0.549579).  Saving model ...
Epoch: 7 cost time: 9.782312393188477
Epoch: 7, Steps: 32 | Train Loss: 0.257 Vali Loss: 5.573 Vali Acc: 0.443 Test Loss: 5.573 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.951642274856567
Epoch: 8, Steps: 32 | Train Loss: 0.056 Vali Loss: 6.224 Vali Acc: 0.504 Test Loss: 6.224 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.682300090789795
Epoch: 9, Steps: 32 | Train Loss: 0.086 Vali Loss: 5.569 Vali Acc: 0.473 Test Loss: 5.569 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.912784099578857
Epoch: 10, Steps: 32 | Train Loss: 0.024 Vali Loss: 10.064 Vali Acc: 0.496 Test Loss: 10.064 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.627991676330566
Epoch: 11, Steps: 32 | Train Loss: 0.125 Vali Loss: 6.693 Vali Acc: 0.489 Test Loss: 6.693 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.995803117752075
Epoch: 12, Steps: 32 | Train Loss: 0.006 Vali Loss: 6.088 Vali Acc: 0.450 Test Loss: 6.088 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.758049964904785
Epoch: 13, Steps: 32 | Train Loss: 0.001 Vali Loss: 8.271 Vali Acc: 0.504 Test Loss: 8.271 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.829640626907349
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.068 Vali Acc: 0.504 Test Loss: 8.068 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.98191523551941
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.024 Vali Acc: 0.504 Test Loss: 8.024 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.671059608459473
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.007 Vali Acc: 0.504 Test Loss: 8.007 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1255925
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.232855081558228
Epoch: 1, Steps: 32 | Train Loss: 2.239 Vali Loss: 1.679 Vali Acc: 0.305 Test Loss: 1.679 Test Acc: 0.305
Validation loss decreased (inf --> -0.305327).  Saving model ...
Epoch: 2 cost time: 9.922073364257812
Epoch: 2, Steps: 32 | Train Loss: 2.222 Vali Loss: 2.121 Vali Acc: 0.405 Test Loss: 2.121 Test Acc: 0.405
Validation loss decreased (-0.305327 --> -0.404559).  Saving model ...
Epoch: 3 cost time: 9.869643211364746
Epoch: 3, Steps: 32 | Train Loss: 1.777 Vali Loss: 2.018 Vali Acc: 0.244 Test Loss: 2.018 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.711021900177002
Epoch: 4, Steps: 32 | Train Loss: 1.230 Vali Loss: 3.673 Vali Acc: 0.351 Test Loss: 3.673 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.909494400024414
Epoch: 5, Steps: 32 | Train Loss: 0.927 Vali Loss: 3.538 Vali Acc: 0.519 Test Loss: 3.538 Test Acc: 0.519
Validation loss decreased (-0.404559 --> -0.519049).  Saving model ...
Epoch: 6 cost time: 9.89280652999878
Epoch: 6, Steps: 32 | Train Loss: 0.422 Vali Loss: 5.898 Vali Acc: 0.267 Test Loss: 5.898 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.147850275039673
Epoch: 7, Steps: 32 | Train Loss: 0.128 Vali Loss: 5.273 Vali Acc: 0.496 Test Loss: 5.273 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.887753963470459
Epoch: 8, Steps: 32 | Train Loss: 0.080 Vali Loss: 4.705 Vali Acc: 0.496 Test Loss: 4.705 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.797329902648926
Epoch: 9, Steps: 32 | Train Loss: 0.003 Vali Loss: 5.698 Vali Acc: 0.489 Test Loss: 5.698 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.605563640594482
Epoch: 10, Steps: 32 | Train Loss: 0.003 Vali Loss: 6.752 Vali Acc: 0.504 Test Loss: 6.752 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.899755477905273
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.998 Vali Acc: 0.389 Test Loss: 4.998 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.782890319824219
Epoch: 12, Steps: 32 | Train Loss: 0.035 Vali Loss: 4.301 Vali Acc: 0.374 Test Loss: 4.301 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.923539638519287
Epoch: 13, Steps: 32 | Train Loss: 0.090 Vali Loss: 6.349 Vali Acc: 0.504 Test Loss: 6.349 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.729788064956665
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.825 Vali Acc: 0.420 Test Loss: 5.825 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.891614198684692
Epoch: 15, Steps: 32 | Train Loss: 0.003 Vali Loss: 7.320 Vali Acc: 0.534 Test Loss: 7.320 Test Acc: 0.534
Validation loss decreased (-0.519049 --> -0.534278).  Saving model ...
Epoch: 16 cost time: 9.690478801727295
Epoch: 16, Steps: 32 | Train Loss: 0.337 Vali Loss: 8.083 Vali Acc: 0.344 Test Loss: 8.083 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.7142174243927
Epoch: 17, Steps: 32 | Train Loss: 0.066 Vali Loss: 7.277 Vali Acc: 0.389 Test Loss: 7.277 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.947107315063477
Epoch: 18, Steps: 32 | Train Loss: 0.047 Vali Loss: 7.501 Vali Acc: 0.427 Test Loss: 7.501 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.893834829330444
Epoch: 19, Steps: 32 | Train Loss: 0.039 Vali Loss: 8.038 Vali Acc: 0.458 Test Loss: 8.038 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.714123725891113
Epoch: 20, Steps: 32 | Train Loss: 0.158 Vali Loss: 9.426 Vali Acc: 0.527 Test Loss: 9.426 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.769361972808838
Epoch: 21, Steps: 32 | Train Loss: 0.093 Vali Loss: 10.471 Vali Acc: 0.542 Test Loss: 10.471 Test Acc: 0.542
Validation loss decreased (-0.534278 --> -0.541880).  Saving model ...
Epoch: 22 cost time: 9.605659246444702
Epoch: 22, Steps: 32 | Train Loss: 0.067 Vali Loss: 7.612 Vali Acc: 0.481 Test Loss: 7.612 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.6993408203125
Epoch: 23, Steps: 32 | Train Loss: 0.011 Vali Loss: 8.775 Vali Acc: 0.511 Test Loss: 8.775 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.8987717628479
Epoch: 24, Steps: 32 | Train Loss: 0.074 Vali Loss: 8.643 Vali Acc: 0.458 Test Loss: 8.643 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.687456846237183
Epoch: 25, Steps: 32 | Train Loss: 0.011 Vali Loss: 8.150 Vali Acc: 0.527 Test Loss: 8.150 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.730660200119019
Epoch: 26, Steps: 32 | Train Loss: 0.084 Vali Loss: 8.966 Vali Acc: 0.534 Test Loss: 8.966 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.745125532150269
Epoch: 27, Steps: 32 | Train Loss: 0.011 Vali Loss: 8.288 Vali Acc: 0.588 Test Loss: 8.288 Test Acc: 0.588
Validation loss decreased (-0.541880 --> -0.587703).  Saving model ...
Epoch: 28 cost time: 9.856247663497925
Epoch: 28, Steps: 32 | Train Loss: 0.024 Vali Loss: 8.468 Vali Acc: 0.542 Test Loss: 8.468 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 9.994758605957031
Epoch: 29, Steps: 32 | Train Loss: 0.098 Vali Loss: 11.448 Vali Acc: 0.427 Test Loss: 11.448 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 9.675901412963867
Epoch: 30, Steps: 32 | Train Loss: 0.147 Vali Loss: 9.471 Vali Acc: 0.565 Test Loss: 9.471 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 9.64377737045288
Epoch: 31, Steps: 32 | Train Loss: 0.019 Vali Loss: 9.654 Vali Acc: 0.481 Test Loss: 9.654 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 9.675710201263428
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.682 Vali Acc: 0.489 Test Loss: 9.682 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 9.723758935928345
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.683 Vali Acc: 0.489 Test Loss: 9.683 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 9.690737009048462
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.679 Vali Acc: 0.489 Test Loss: 9.679 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 9.908058166503906
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.681 Vali Acc: 0.489 Test Loss: 9.681 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 9.724096775054932
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.681 Vali Acc: 0.489 Test Loss: 9.681 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 9.82421064376831
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.681 Vali Acc: 0.489 Test Loss: 9.681 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1171957
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.875382900238037
Epoch: 1, Steps: 32 | Train Loss: 2.325 Vali Loss: 3.631 Vali Acc: 0.420 Test Loss: 3.631 Test Acc: 0.420
Validation loss decreased (inf --> -0.419811).  Saving model ...
Epoch: 2 cost time: 9.338756084442139
Epoch: 2, Steps: 32 | Train Loss: 3.515 Vali Loss: 8.218 Vali Acc: 0.191 Test Loss: 8.218 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.32888388633728
Epoch: 3, Steps: 32 | Train Loss: 4.038 Vali Loss: 4.350 Vali Acc: 0.214 Test Loss: 4.350 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.200361013412476
Epoch: 4, Steps: 32 | Train Loss: 1.475 Vali Loss: 3.493 Vali Acc: 0.298 Test Loss: 3.493 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.330568075180054
Epoch: 5, Steps: 32 | Train Loss: 0.434 Vali Loss: 3.819 Vali Acc: 0.466 Test Loss: 3.819 Test Acc: 0.466
Validation loss decreased (-0.419811 --> -0.465611).  Saving model ...
Epoch: 6 cost time: 9.454092502593994
Epoch: 6, Steps: 32 | Train Loss: 0.178 Vali Loss: 4.244 Vali Acc: 0.466 Test Loss: 4.244 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.542739152908325
Epoch: 7, Steps: 32 | Train Loss: 0.179 Vali Loss: 5.973 Vali Acc: 0.267 Test Loss: 5.973 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.612225532531738
Epoch: 8, Steps: 32 | Train Loss: 0.231 Vali Loss: 4.915 Vali Acc: 0.473 Test Loss: 4.915 Test Acc: 0.473
Validation loss decreased (-0.465611 --> -0.473233).  Saving model ...
Epoch: 9 cost time: 9.280077695846558
Epoch: 9, Steps: 32 | Train Loss: 0.090 Vali Loss: 4.546 Vali Acc: 0.359 Test Loss: 4.546 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.467418432235718
Epoch: 10, Steps: 32 | Train Loss: 0.009 Vali Loss: 4.891 Vali Acc: 0.496 Test Loss: 4.891 Test Acc: 0.496
Validation loss decreased (-0.473233 --> -0.496134).  Saving model ...
Epoch: 11 cost time: 9.22553038597107
Epoch: 11, Steps: 32 | Train Loss: 0.027 Vali Loss: 4.858 Vali Acc: 0.519 Test Loss: 4.858 Test Acc: 0.519
Validation loss decreased (-0.496134 --> -0.519035).  Saving model ...
Epoch: 12 cost time: 9.245826721191406
Epoch: 12, Steps: 32 | Train Loss: 0.041 Vali Loss: 4.981 Vali Acc: 0.550 Test Loss: 4.981 Test Acc: 0.550
Validation loss decreased (-0.519035 --> -0.549569).  Saving model ...
Epoch: 13 cost time: 9.414098501205444
Epoch: 13, Steps: 32 | Train Loss: 0.008 Vali Loss: 5.722 Vali Acc: 0.542 Test Loss: 5.722 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.365902423858643
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.810 Vali Acc: 0.534 Test Loss: 5.810 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.374664783477783
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.713 Vali Acc: 0.519 Test Loss: 5.713 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.598270177841187
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.662 Vali Acc: 0.527 Test Loss: 5.662 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.357987403869629
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.527 Test Loss: 5.651 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.547290802001953
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.641 Vali Acc: 0.527 Test Loss: 5.641 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.331896781921387
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.623 Vali Acc: 0.527 Test Loss: 5.623 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.22998332977295
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.600 Vali Acc: 0.527 Test Loss: 5.600 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.31847882270813
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.584 Vali Acc: 0.527 Test Loss: 5.584 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.217334032058716
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.581 Vali Acc: 0.527 Test Loss: 5.581 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1087989
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.627766609191895
Epoch: 1, Steps: 32 | Train Loss: 2.078 Vali Loss: 2.011 Vali Acc: 0.176 Test Loss: 2.011 Test Acc: 0.176
Validation loss decreased (inf --> -0.175552).  Saving model ...
Epoch: 2 cost time: 9.537859201431274
Epoch: 2, Steps: 32 | Train Loss: 3.636 Vali Loss: 4.407 Vali Acc: 0.168 Test Loss: 4.407 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.72669267654419
Epoch: 3, Steps: 32 | Train Loss: 3.186 Vali Loss: 3.697 Vali Acc: 0.237 Test Loss: 3.697 Test Acc: 0.237
Validation loss decreased (-0.175552 --> -0.236604).  Saving model ...
Epoch: 4 cost time: 10.376766443252563
Epoch: 4, Steps: 32 | Train Loss: 2.386 Vali Loss: 2.962 Vali Acc: 0.519 Test Loss: 2.962 Test Acc: 0.519
Validation loss decreased (-0.236604 --> -0.519054).  Saving model ...
Epoch: 5 cost time: 9.592356204986572
Epoch: 5, Steps: 32 | Train Loss: 1.036 Vali Loss: 3.690 Vali Acc: 0.450 Test Loss: 3.690 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.89023232460022
Epoch: 6, Steps: 32 | Train Loss: 0.164 Vali Loss: 4.507 Vali Acc: 0.511 Test Loss: 4.507 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.7503182888031
Epoch: 7, Steps: 32 | Train Loss: 0.235 Vali Loss: 4.495 Vali Acc: 0.466 Test Loss: 4.495 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.527859687805176
Epoch: 8, Steps: 32 | Train Loss: 0.080 Vali Loss: 4.906 Vali Acc: 0.481 Test Loss: 4.906 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.813765525817871
Epoch: 9, Steps: 32 | Train Loss: 0.046 Vali Loss: 4.622 Vali Acc: 0.473 Test Loss: 4.622 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.712968349456787
Epoch: 10, Steps: 32 | Train Loss: 0.006 Vali Loss: 5.659 Vali Acc: 0.511 Test Loss: 5.659 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.74146819114685
Epoch: 11, Steps: 32 | Train Loss: 0.012 Vali Loss: 6.168 Vali Acc: 0.542 Test Loss: 6.168 Test Acc: 0.542
Validation loss decreased (-0.519054 --> -0.541923).  Saving model ...
Epoch: 12 cost time: 9.691888332366943
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.996 Vali Acc: 0.450 Test Loss: 4.996 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.511893033981323
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.526 Vali Acc: 0.519 Test Loss: 5.526 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.702496767044067
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.519 Vali Acc: 0.519 Test Loss: 5.519 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.714032888412476
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.475 Vali Acc: 0.519 Test Loss: 5.475 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.791543006896973
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.390 Vali Acc: 0.519 Test Loss: 5.390 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.812018394470215
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.378 Vali Acc: 0.519 Test Loss: 5.378 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.751471757888794
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.375 Vali Acc: 0.519 Test Loss: 5.375 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.73752737045288
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.374 Vali Acc: 0.519 Test Loss: 5.374 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.11595344543457
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.369 Vali Acc: 0.519 Test Loss: 5.369 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.944770097732544
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.365 Vali Acc: 0.519 Test Loss: 5.365 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1223413
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.150989532470703
Epoch: 1, Steps: 32 | Train Loss: 2.967 Vali Loss: 2.425 Vali Acc: 0.420 Test Loss: 2.425 Test Acc: 0.420
Validation loss decreased (inf --> -0.419823).  Saving model ...
Epoch: 2 cost time: 9.629356145858765
Epoch: 2, Steps: 32 | Train Loss: 2.737 Vali Loss: 3.632 Vali Acc: 0.427 Test Loss: 3.632 Test Acc: 0.427
Validation loss decreased (-0.419823 --> -0.427445).  Saving model ...
Epoch: 3 cost time: 9.701725959777832
Epoch: 3, Steps: 32 | Train Loss: 3.047 Vali Loss: 7.553 Vali Acc: 0.168 Test Loss: 7.553 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.908666372299194
Epoch: 4, Steps: 32 | Train Loss: 1.620 Vali Loss: 3.528 Vali Acc: 0.298 Test Loss: 3.528 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.811017751693726
Epoch: 5, Steps: 32 | Train Loss: 1.247 Vali Loss: 4.279 Vali Acc: 0.443 Test Loss: 4.279 Test Acc: 0.443
Validation loss decreased (-0.427445 --> -0.442705).  Saving model ...
Epoch: 6 cost time: 9.523889541625977
Epoch: 6, Steps: 32 | Train Loss: 0.437 Vali Loss: 4.906 Vali Acc: 0.397 Test Loss: 4.906 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.924211740493774
Epoch: 7, Steps: 32 | Train Loss: 0.099 Vali Loss: 4.698 Vali Acc: 0.534 Test Loss: 4.698 Test Acc: 0.534
Validation loss decreased (-0.442705 --> -0.534304).  Saving model ...
Epoch: 8 cost time: 9.957728862762451
Epoch: 8, Steps: 32 | Train Loss: 0.059 Vali Loss: 5.553 Vali Acc: 0.481 Test Loss: 5.553 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.952807188034058
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.108 Vali Acc: 0.511 Test Loss: 5.108 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.937307596206665
Epoch: 10, Steps: 32 | Train Loss: 0.009 Vali Loss: 5.903 Vali Acc: 0.511 Test Loss: 5.903 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.966916799545288
Epoch: 11, Steps: 32 | Train Loss: 0.010 Vali Loss: 5.582 Vali Acc: 0.481 Test Loss: 5.582 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.751803636550903
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.919 Vali Acc: 0.481 Test Loss: 5.919 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.913135290145874
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.745 Vali Acc: 0.473 Test Loss: 5.745 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.125694751739502
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.746 Vali Acc: 0.466 Test Loss: 5.746 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.76806354522705
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.745 Vali Acc: 0.466 Test Loss: 5.745 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.946074962615967
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.743 Vali Acc: 0.473 Test Loss: 5.743 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.722459554672241
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.744 Vali Acc: 0.473 Test Loss: 5.744 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1139445
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.353721380233765
Epoch: 1, Steps: 32 | Train Loss: 2.448 Vali Loss: 2.151 Vali Acc: 0.130 Test Loss: 2.151 Test Acc: 0.130
Validation loss decreased (inf --> -0.129749).  Saving model ...
Epoch: 2 cost time: 9.592631340026855
Epoch: 2, Steps: 32 | Train Loss: 2.341 Vali Loss: 2.319 Vali Acc: 0.427 Test Loss: 2.319 Test Acc: 0.427
Validation loss decreased (-0.129749 --> -0.427458).  Saving model ...
Epoch: 3 cost time: 9.464531898498535
Epoch: 3, Steps: 32 | Train Loss: 2.260 Vali Loss: 2.084 Vali Acc: 0.496 Test Loss: 2.084 Test Acc: 0.496
Validation loss decreased (-0.427458 --> -0.496162).  Saving model ...
Epoch: 4 cost time: 9.597402334213257
Epoch: 4, Steps: 32 | Train Loss: 1.086 Vali Loss: 2.828 Vali Acc: 0.305 Test Loss: 2.828 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.598922967910767
Epoch: 5, Steps: 32 | Train Loss: 0.629 Vali Loss: 3.767 Vali Acc: 0.534 Test Loss: 3.767 Test Acc: 0.534
Validation loss decreased (-0.496162 --> -0.534313).  Saving model ...
Epoch: 6 cost time: 9.881638526916504
Epoch: 6, Steps: 32 | Train Loss: 0.251 Vali Loss: 4.283 Vali Acc: 0.443 Test Loss: 4.283 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.706876754760742
Epoch: 7, Steps: 32 | Train Loss: 0.219 Vali Loss: 4.113 Vali Acc: 0.366 Test Loss: 4.113 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.692930698394775
Epoch: 8, Steps: 32 | Train Loss: 0.087 Vali Loss: 5.646 Vali Acc: 0.481 Test Loss: 5.646 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.80069375038147
Epoch: 9, Steps: 32 | Train Loss: 0.051 Vali Loss: 6.036 Vali Acc: 0.443 Test Loss: 6.036 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.671772241592407
Epoch: 10, Steps: 32 | Train Loss: 0.013 Vali Loss: 6.462 Vali Acc: 0.427 Test Loss: 6.462 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.52982759475708
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.236 Vali Acc: 0.450 Test Loss: 6.236 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.497993469238281
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.207 Vali Acc: 0.435 Test Loss: 6.207 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.532068967819214
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.205 Vali Acc: 0.435 Test Loss: 6.205 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.485020637512207
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.201 Vali Acc: 0.435 Test Loss: 6.201 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.702799797058105
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.196 Vali Acc: 0.435 Test Loss: 6.196 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1055477
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.625316381454468
Epoch: 1, Steps: 32 | Train Loss: 2.229 Vali Loss: 4.530 Vali Acc: 0.176 Test Loss: 4.530 Test Acc: 0.176
Validation loss decreased (inf --> -0.175527).  Saving model ...
Epoch: 2 cost time: 9.237335443496704
Epoch: 2, Steps: 32 | Train Loss: 2.798 Vali Loss: 3.688 Vali Acc: 0.153 Test Loss: 3.688 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.387080192565918
Epoch: 3, Steps: 32 | Train Loss: 3.284 Vali Loss: 4.255 Vali Acc: 0.344 Test Loss: 4.255 Test Acc: 0.344
Validation loss decreased (-0.175527 --> -0.343469).  Saving model ...
Epoch: 4 cost time: 9.536008834838867
Epoch: 4, Steps: 32 | Train Loss: 1.985 Vali Loss: 3.445 Vali Acc: 0.511 Test Loss: 3.445 Test Acc: 0.511
Validation loss decreased (-0.343469 --> -0.511416).  Saving model ...
Epoch: 5 cost time: 9.339949607849121
Epoch: 5, Steps: 32 | Train Loss: 0.582 Vali Loss: 4.202 Vali Acc: 0.321 Test Loss: 4.202 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.2999746799469
Epoch: 6, Steps: 32 | Train Loss: 0.107 Vali Loss: 5.104 Vali Acc: 0.458 Test Loss: 5.104 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.666756868362427
Epoch: 7, Steps: 32 | Train Loss: 0.059 Vali Loss: 4.916 Vali Acc: 0.359 Test Loss: 4.916 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.536467552185059
Epoch: 8, Steps: 32 | Train Loss: 0.034 Vali Loss: 3.966 Vali Acc: 0.527 Test Loss: 3.966 Test Acc: 0.527
Validation loss decreased (-0.511416 --> -0.526678).  Saving model ...
Epoch: 9 cost time: 9.851750373840332
Epoch: 9, Steps: 32 | Train Loss: 0.023 Vali Loss: 5.834 Vali Acc: 0.519 Test Loss: 5.834 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.681949377059937
Epoch: 10, Steps: 32 | Train Loss: 0.050 Vali Loss: 4.825 Vali Acc: 0.489 Test Loss: 4.825 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.564347267150879
Epoch: 11, Steps: 32 | Train Loss: 0.123 Vali Loss: 5.837 Vali Acc: 0.519 Test Loss: 5.837 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.832764148712158
Epoch: 12, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.987 Vali Acc: 0.458 Test Loss: 5.987 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.872951984405518
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.438 Vali Acc: 0.458 Test Loss: 5.438 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.59020733833313
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.520 Vali Acc: 0.458 Test Loss: 5.520 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.7309250831604
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.535 Vali Acc: 0.458 Test Loss: 5.535 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.175976514816284
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.541 Vali Acc: 0.458 Test Loss: 5.541 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.156674146652222
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.544 Vali Acc: 0.458 Test Loss: 5.544 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.37680721282959
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.458 Test Loss: 5.546 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 971509
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.858675003051758
Epoch: 1, Steps: 32 | Train Loss: 2.374 Vali Loss: 3.316 Vali Acc: 0.420 Test Loss: 3.316 Test Acc: 0.420
Validation loss decreased (inf --> -0.419814).  Saving model ...
Epoch: 2 cost time: 9.506554365158081
Epoch: 2, Steps: 32 | Train Loss: 2.511 Vali Loss: 2.682 Vali Acc: 0.168 Test Loss: 2.682 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.367455244064331
Epoch: 3, Steps: 32 | Train Loss: 2.258 Vali Loss: 2.842 Vali Acc: 0.244 Test Loss: 2.842 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.583807945251465
Epoch: 4, Steps: 32 | Train Loss: 1.638 Vali Loss: 4.597 Vali Acc: 0.160 Test Loss: 4.597 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.753726243972778
Epoch: 5, Steps: 32 | Train Loss: 1.653 Vali Loss: 3.741 Vali Acc: 0.366 Test Loss: 3.741 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.601155042648315
Epoch: 6, Steps: 32 | Train Loss: 0.502 Vali Loss: 4.530 Vali Acc: 0.481 Test Loss: 4.530 Test Acc: 0.481
Validation loss decreased (-0.419814 --> -0.480871).  Saving model ...
Epoch: 7 cost time: 9.54652714729309
Epoch: 7, Steps: 32 | Train Loss: 0.079 Vali Loss: 5.932 Vali Acc: 0.389 Test Loss: 5.932 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.726569175720215
Epoch: 8, Steps: 32 | Train Loss: 0.066 Vali Loss: 4.813 Vali Acc: 0.527 Test Loss: 4.813 Test Acc: 0.527
Validation loss decreased (-0.480871 --> -0.526669).  Saving model ...
Epoch: 9 cost time: 9.780822992324829
Epoch: 9, Steps: 32 | Train Loss: 0.002 Vali Loss: 6.180 Vali Acc: 0.504 Test Loss: 6.180 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.924241781234741
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.946 Vali Acc: 0.504 Test Loss: 4.946 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.034648180007935
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.935 Vali Acc: 0.496 Test Loss: 4.935 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.851675987243652
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.950 Vali Acc: 0.504 Test Loss: 4.950 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.795180082321167
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.977 Vali Acc: 0.504 Test Loss: 4.977 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.75418996810913
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.962 Vali Acc: 0.504 Test Loss: 4.962 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.806497812271118
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.969 Vali Acc: 0.504 Test Loss: 4.969 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.80870795249939
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.979 Vali Acc: 0.504 Test Loss: 4.979 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.768919467926025
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.986 Vali Acc: 0.504 Test Loss: 4.986 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.697251319885254
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 5.004 Vali Acc: 0.496 Test Loss: 5.004 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1165173
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.267210483551025
Epoch: 1, Steps: 32 | Train Loss: 2.696 Vali Loss: 3.687 Vali Acc: 0.137 Test Loss: 3.687 Test Acc: 0.137
Validation loss decreased (inf --> -0.137368).  Saving model ...
Epoch: 2 cost time: 9.683138847351074
Epoch: 2, Steps: 32 | Train Loss: 3.306 Vali Loss: 2.547 Vali Acc: 0.427 Test Loss: 2.547 Test Acc: 0.427
Validation loss decreased (-0.137368 --> -0.427455).  Saving model ...
Epoch: 3 cost time: 9.866780996322632
Epoch: 3, Steps: 32 | Train Loss: 3.258 Vali Loss: 2.484 Vali Acc: 0.221 Test Loss: 2.484 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.462296962738037
Epoch: 4, Steps: 32 | Train Loss: 3.195 Vali Loss: 2.340 Vali Acc: 0.282 Test Loss: 2.340 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.97297477722168
Epoch: 5, Steps: 32 | Train Loss: 2.250 Vali Loss: 3.114 Vali Acc: 0.305 Test Loss: 3.114 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.76421308517456
Epoch: 6, Steps: 32 | Train Loss: 0.630 Vali Loss: 4.966 Vali Acc: 0.527 Test Loss: 4.966 Test Acc: 0.527
Validation loss decreased (-0.427455 --> -0.526668).  Saving model ...
Epoch: 7 cost time: 9.911696910858154
Epoch: 7, Steps: 32 | Train Loss: 0.146 Vali Loss: 5.131 Vali Acc: 0.405 Test Loss: 5.131 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.150577306747437
Epoch: 8, Steps: 32 | Train Loss: 0.026 Vali Loss: 5.279 Vali Acc: 0.511 Test Loss: 5.279 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.485031843185425
Epoch: 9, Steps: 32 | Train Loss: 0.063 Vali Loss: 6.204 Vali Acc: 0.504 Test Loss: 6.204 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.649979829788208
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 7.113 Vali Acc: 0.267 Test Loss: 7.113 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.603028535842896
Epoch: 11, Steps: 32 | Train Loss: 0.164 Vali Loss: 6.403 Vali Acc: 0.496 Test Loss: 6.403 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.482863187789917
Epoch: 12, Steps: 32 | Train Loss: 0.158 Vali Loss: 6.277 Vali Acc: 0.420 Test Loss: 6.277 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.95742130279541
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.080 Vali Acc: 0.458 Test Loss: 6.080 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.476019620895386
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.061 Vali Acc: 0.450 Test Loss: 6.061 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.738885164260864
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.066 Vali Acc: 0.450 Test Loss: 6.066 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.847760200500488
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.070 Vali Acc: 0.450 Test Loss: 6.070 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1081205
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.27555513381958
Epoch: 1, Steps: 32 | Train Loss: 2.047 Vali Loss: 1.990 Vali Acc: 0.168 Test Loss: 1.990 Test Acc: 0.168
Validation loss decreased (inf --> -0.167919).  Saving model ...
Epoch: 2 cost time: 9.741166353225708
Epoch: 2, Steps: 32 | Train Loss: 2.563 Vali Loss: 1.983 Vali Acc: 0.435 Test Loss: 1.983 Test Acc: 0.435
Validation loss decreased (-0.167919 --> -0.435095).  Saving model ...
Epoch: 3 cost time: 9.597480773925781
Epoch: 3, Steps: 32 | Train Loss: 3.063 Vali Loss: 3.167 Vali Acc: 0.237 Test Loss: 3.167 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.934678316116333
Epoch: 4, Steps: 32 | Train Loss: 2.946 Vali Loss: 5.830 Vali Acc: 0.450 Test Loss: 5.830 Test Acc: 0.450
Validation loss decreased (-0.435095 --> -0.450323).  Saving model ...
Epoch: 5 cost time: 9.599074602127075
Epoch: 5, Steps: 32 | Train Loss: 1.049 Vali Loss: 3.315 Vali Acc: 0.389 Test Loss: 3.315 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.584505796432495
Epoch: 6, Steps: 32 | Train Loss: 0.516 Vali Loss: 6.511 Vali Acc: 0.534 Test Loss: 6.511 Test Acc: 0.534
Validation loss decreased (-0.450323 --> -0.534286).  Saving model ...
Epoch: 7 cost time: 9.570072650909424
Epoch: 7, Steps: 32 | Train Loss: 0.138 Vali Loss: 5.766 Vali Acc: 0.511 Test Loss: 5.766 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.637739181518555
Epoch: 8, Steps: 32 | Train Loss: 0.019 Vali Loss: 6.983 Vali Acc: 0.542 Test Loss: 6.983 Test Acc: 0.542
Validation loss decreased (-0.534286 --> -0.541915).  Saving model ...
Epoch: 9 cost time: 9.626078844070435
Epoch: 9, Steps: 32 | Train Loss: 0.002 Vali Loss: 7.262 Vali Acc: 0.534 Test Loss: 7.262 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.038499116897583
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.101 Vali Acc: 0.489 Test Loss: 6.101 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.432083368301392
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.504 Test Loss: 6.062 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.414146423339844
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.105 Vali Acc: 0.511 Test Loss: 6.105 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.882861375808716
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.141 Vali Acc: 0.511 Test Loss: 6.141 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.712814807891846
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.163 Vali Acc: 0.511 Test Loss: 6.163 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.784826755523682
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.181 Vali Acc: 0.511 Test Loss: 6.181 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.644248485565186
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.203 Vali Acc: 0.519 Test Loss: 6.203 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.636726140975952
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.233 Vali Acc: 0.519 Test Loss: 6.233 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.056533575057983
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.250 Vali Acc: 0.519 Test Loss: 6.250 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 997237
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.098155736923218
Epoch: 1, Steps: 32 | Train Loss: 2.089 Vali Loss: 4.473 Vali Acc: 0.420 Test Loss: 4.473 Test Acc: 0.420
Validation loss decreased (inf --> -0.419803).  Saving model ...
Epoch: 2 cost time: 9.256358861923218
Epoch: 2, Steps: 32 | Train Loss: 4.841 Vali Loss: 4.862 Vali Acc: 0.099 Test Loss: 4.862 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.064171314239502
Epoch: 3, Steps: 32 | Train Loss: 2.965 Vali Loss: 2.155 Vali Acc: 0.206 Test Loss: 2.155 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.475728988647461
Epoch: 4, Steps: 32 | Train Loss: 1.322 Vali Loss: 3.732 Vali Acc: 0.504 Test Loss: 3.732 Test Acc: 0.504
Validation loss decreased (-0.419803 --> -0.503779).  Saving model ...
Epoch: 5 cost time: 9.378372430801392
Epoch: 5, Steps: 32 | Train Loss: 0.854 Vali Loss: 4.782 Vali Acc: 0.504 Test Loss: 4.782 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.317240953445435
Epoch: 6, Steps: 32 | Train Loss: 0.349 Vali Loss: 5.139 Vali Acc: 0.466 Test Loss: 5.139 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.386920690536499
Epoch: 7, Steps: 32 | Train Loss: 0.023 Vali Loss: 4.389 Vali Acc: 0.504 Test Loss: 4.389 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.059308290481567
Epoch: 8, Steps: 32 | Train Loss: 0.049 Vali Loss: 6.656 Vali Acc: 0.504 Test Loss: 6.656 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.2599778175354
Epoch: 9, Steps: 32 | Train Loss: 0.056 Vali Loss: 6.393 Vali Acc: 0.542 Test Loss: 6.393 Test Acc: 0.542
Validation loss decreased (-0.503779 --> -0.541921).  Saving model ...
Epoch: 10 cost time: 9.287652969360352
Epoch: 10, Steps: 32 | Train Loss: 0.052 Vali Loss: 6.848 Vali Acc: 0.519 Test Loss: 6.848 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.412677526473999
Epoch: 11, Steps: 32 | Train Loss: 0.022 Vali Loss: 8.263 Vali Acc: 0.511 Test Loss: 8.263 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.22832202911377
Epoch: 12, Steps: 32 | Train Loss: 0.072 Vali Loss: 9.035 Vali Acc: 0.519 Test Loss: 9.035 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.188693761825562
Epoch: 13, Steps: 32 | Train Loss: 0.233 Vali Loss: 6.416 Vali Acc: 0.405 Test Loss: 6.416 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.256473779678345
Epoch: 14, Steps: 32 | Train Loss: 0.042 Vali Loss: 8.243 Vali Acc: 0.527 Test Loss: 8.243 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.381165027618408
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.641 Vali Acc: 0.443 Test Loss: 6.641 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.394418001174927
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.627 Vali Acc: 0.443 Test Loss: 6.627 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.327158689498901
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.649 Vali Acc: 0.450 Test Loss: 6.649 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.353425025939941
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.661 Vali Acc: 0.466 Test Loss: 6.661 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.22679877281189
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.667 Vali Acc: 0.473 Test Loss: 6.667 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 913269
model size : 5.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.781000852584839
Epoch: 1, Steps: 32 | Train Loss: 21.945 Vali Loss: 28.088 Vali Acc: 0.160 Test Loss: 28.088 Test Acc: 0.160
Validation loss decreased (inf --> -0.160024).  Saving model ...
Epoch: 2 cost time: 12.283759117126465
Epoch: 2, Steps: 32 | Train Loss: 32.084 Vali Loss: 22.889 Vali Acc: 0.298 Test Loss: 22.889 Test Acc: 0.298
Validation loss decreased (-0.160024 --> -0.297481).  Saving model ...
Epoch: 3 cost time: 12.074024677276611
Epoch: 3, Steps: 32 | Train Loss: 13.876 Vali Loss: 25.527 Vali Acc: 0.298 Test Loss: 25.527 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.423959493637085
Epoch: 4, Steps: 32 | Train Loss: 9.598 Vali Loss: 41.177 Vali Acc: 0.489 Test Loss: 41.177 Test Acc: 0.489
Validation loss decreased (-0.297481 --> -0.488138).  Saving model ...
Epoch: 5 cost time: 12.377426862716675
Epoch: 5, Steps: 32 | Train Loss: 6.271 Vali Loss: 38.894 Vali Acc: 0.305 Test Loss: 38.894 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.423506021499634
Epoch: 6, Steps: 32 | Train Loss: 1.294 Vali Loss: 39.358 Vali Acc: 0.443 Test Loss: 39.358 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.304393768310547
Epoch: 7, Steps: 32 | Train Loss: 2.757 Vali Loss: 39.041 Vali Acc: 0.466 Test Loss: 39.041 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.429336786270142
Epoch: 8, Steps: 32 | Train Loss: 0.610 Vali Loss: 48.668 Vali Acc: 0.427 Test Loss: 48.668 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.70932149887085
Epoch: 9, Steps: 32 | Train Loss: 1.111 Vali Loss: 50.454 Vali Acc: 0.313 Test Loss: 50.454 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.414963245391846
Epoch: 10, Steps: 32 | Train Loss: 5.687 Vali Loss: 53.097 Vali Acc: 0.397 Test Loss: 53.097 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.29926061630249
Epoch: 11, Steps: 32 | Train Loss: 3.549 Vali Loss: 65.167 Vali Acc: 0.527 Test Loss: 65.167 Test Acc: 0.527
Validation loss decreased (-0.488138 --> -0.526066).  Saving model ...
Epoch: 12 cost time: 12.529476881027222
Epoch: 12, Steps: 32 | Train Loss: 2.891 Vali Loss: 63.236 Vali Acc: 0.412 Test Loss: 63.236 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.30537748336792
Epoch: 13, Steps: 32 | Train Loss: 0.572 Vali Loss: 65.554 Vali Acc: 0.450 Test Loss: 65.554 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.586869478225708
Epoch: 14, Steps: 32 | Train Loss: 0.152 Vali Loss: 64.662 Vali Acc: 0.496 Test Loss: 64.662 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.17603087425232
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 64.195 Vali Acc: 0.481 Test Loss: 64.195 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.343796253204346
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 64.241 Vali Acc: 0.481 Test Loss: 64.241 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.275614500045776
Epoch: 17, Steps: 32 | Train Loss: 0.007 Vali Loss: 69.341 Vali Acc: 0.351 Test Loss: 69.341 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.40157175064087
Epoch: 18, Steps: 32 | Train Loss: 1.446 Vali Loss: 96.673 Vali Acc: 0.519 Test Loss: 96.673 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.651735305786133
Epoch: 19, Steps: 32 | Train Loss: 18.173 Vali Loss: 49.694 Vali Acc: 0.366 Test Loss: 49.694 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.622330904006958
Epoch: 20, Steps: 32 | Train Loss: 1.709 Vali Loss: 88.515 Vali Acc: 0.290 Test Loss: 88.515 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.342489957809448
Epoch: 21, Steps: 32 | Train Loss: 4.193 Vali Loss: 65.293 Vali Acc: 0.573 Test Loss: 65.293 Test Acc: 0.573
Validation loss decreased (-0.526066 --> -0.571866).  Saving model ...
Epoch: 22 cost time: 12.382147550582886
Epoch: 22, Steps: 32 | Train Loss: 2.115 Vali Loss: 62.373 Vali Acc: 0.328 Test Loss: 62.373 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.61881136894226
Epoch: 23, Steps: 32 | Train Loss: 27.632 Vali Loss: 50.664 Vali Acc: 0.290 Test Loss: 50.664 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.548310995101929
Epoch: 24, Steps: 32 | Train Loss: 70.534 Vali Loss: 56.905 Vali Acc: 0.336 Test Loss: 56.905 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.481104373931885
Epoch: 25, Steps: 32 | Train Loss: 27.397 Vali Loss: 67.595 Vali Acc: 0.321 Test Loss: 67.595 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 12.336500406265259
Epoch: 26, Steps: 32 | Train Loss: 7.307 Vali Loss: 64.814 Vali Acc: 0.405 Test Loss: 64.814 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 12.525465488433838
Epoch: 27, Steps: 32 | Train Loss: 4.389 Vali Loss: 76.121 Vali Acc: 0.351 Test Loss: 76.121 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 12.353312730789185
Epoch: 28, Steps: 32 | Train Loss: 2.085 Vali Loss: 110.034 Vali Acc: 0.221 Test Loss: 110.034 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.168694972991943
Epoch: 29, Steps: 32 | Train Loss: 3.413 Vali Loss: 99.054 Vali Acc: 0.328 Test Loss: 99.054 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 12.40160584449768
Epoch: 30, Steps: 32 | Train Loss: 22.532 Vali Loss: 106.312 Vali Acc: 0.282 Test Loss: 106.312 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 12.227474451065063
Epoch: 31, Steps: 32 | Train Loss: 31.383 Vali Loss: 103.588 Vali Acc: 0.290 Test Loss: 103.588 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 18284841
model size : 87.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.149704694747925
Epoch: 1, Steps: 32 | Train Loss: 16.979 Vali Loss: 38.846 Vali Acc: 0.420 Test Loss: 38.846 Test Acc: 0.420
Validation loss decreased (inf --> -0.419459).  Saving model ...
Epoch: 2 cost time: 12.449108362197876
Epoch: 2, Steps: 32 | Train Loss: 39.964 Vali Loss: 23.202 Vali Acc: 0.221 Test Loss: 23.202 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.122787237167358
Epoch: 3, Steps: 32 | Train Loss: 16.562 Vali Loss: 25.084 Vali Acc: 0.443 Test Loss: 25.084 Test Acc: 0.443
Validation loss decreased (-0.419459 --> -0.442497).  Saving model ...
Epoch: 4 cost time: 12.191407442092896
Epoch: 4, Steps: 32 | Train Loss: 6.540 Vali Loss: 28.820 Vali Acc: 0.458 Test Loss: 28.820 Test Acc: 0.458
Validation loss decreased (-0.442497 --> -0.457727).  Saving model ...
Epoch: 5 cost time: 12.12032961845398
Epoch: 5, Steps: 32 | Train Loss: 3.152 Vali Loss: 31.892 Vali Acc: 0.489 Test Loss: 31.892 Test Acc: 0.489
Validation loss decreased (-0.457727 --> -0.488231).  Saving model ...
Epoch: 6 cost time: 12.02241039276123
Epoch: 6, Steps: 32 | Train Loss: 1.737 Vali Loss: 42.770 Vali Acc: 0.481 Test Loss: 42.770 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.104217529296875
Epoch: 7, Steps: 32 | Train Loss: 3.076 Vali Loss: 43.998 Vali Acc: 0.443 Test Loss: 43.998 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.416534423828125
Epoch: 8, Steps: 32 | Train Loss: 3.280 Vali Loss: 56.817 Vali Acc: 0.473 Test Loss: 56.817 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.140067100524902
Epoch: 9, Steps: 32 | Train Loss: 3.664 Vali Loss: 66.067 Vali Acc: 0.519 Test Loss: 66.067 Test Acc: 0.519
Validation loss decreased (-0.488231 --> -0.518423).  Saving model ...
Epoch: 10 cost time: 12.296169996261597
Epoch: 10, Steps: 32 | Train Loss: 4.771 Vali Loss: 44.986 Vali Acc: 0.359 Test Loss: 44.986 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.369607925415039
Epoch: 11, Steps: 32 | Train Loss: 13.610 Vali Loss: 55.898 Vali Acc: 0.412 Test Loss: 55.898 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.400418519973755
Epoch: 12, Steps: 32 | Train Loss: 0.955 Vali Loss: 43.936 Vali Acc: 0.443 Test Loss: 43.936 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.073035478591919
Epoch: 13, Steps: 32 | Train Loss: 0.121 Vali Loss: 43.125 Vali Acc: 0.412 Test Loss: 43.125 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.260856866836548
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 47.207 Vali Acc: 0.458 Test Loss: 47.207 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.566411256790161
Epoch: 15, Steps: 32 | Train Loss: 0.757 Vali Loss: 48.227 Vali Acc: 0.344 Test Loss: 48.227 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.2445969581604
Epoch: 16, Steps: 32 | Train Loss: 0.339 Vali Loss: 51.633 Vali Acc: 0.260 Test Loss: 51.633 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.207720279693604
Epoch: 17, Steps: 32 | Train Loss: 0.085 Vali Loss: 58.999 Vali Acc: 0.267 Test Loss: 58.999 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.08376932144165
Epoch: 18, Steps: 32 | Train Loss: 0.727 Vali Loss: 40.741 Vali Acc: 0.427 Test Loss: 40.741 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.32623839378357
Epoch: 19, Steps: 32 | Train Loss: 3.619 Vali Loss: 55.000 Vali Acc: 0.397 Test Loss: 55.000 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 17709097
model size : 85.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.933117151260376
Epoch: 1, Steps: 32 | Train Loss: 17.690 Vali Loss: 26.653 Vali Acc: 0.420 Test Loss: 26.653 Test Acc: 0.420
Validation loss decreased (inf --> -0.419581).  Saving model ...
Epoch: 2 cost time: 11.891900300979614
Epoch: 2, Steps: 32 | Train Loss: 22.890 Vali Loss: 21.484 Vali Acc: 0.420 Test Loss: 21.484 Test Acc: 0.420
Validation loss decreased (-0.419581 --> -0.419632).  Saving model ...
Epoch: 3 cost time: 12.027060508728027
Epoch: 3, Steps: 32 | Train Loss: 13.318 Vali Loss: 34.492 Vali Acc: 0.321 Test Loss: 34.492 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.247040510177612
Epoch: 4, Steps: 32 | Train Loss: 7.222 Vali Loss: 24.901 Vali Acc: 0.504 Test Loss: 24.901 Test Acc: 0.504
Validation loss decreased (-0.419632 --> -0.503568).  Saving model ...
Epoch: 5 cost time: 12.148343563079834
Epoch: 5, Steps: 32 | Train Loss: 4.700 Vali Loss: 40.663 Vali Acc: 0.366 Test Loss: 40.663 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.270135164260864
Epoch: 6, Steps: 32 | Train Loss: 1.926 Vali Loss: 36.776 Vali Acc: 0.382 Test Loss: 36.776 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.152865171432495
Epoch: 7, Steps: 32 | Train Loss: 3.953 Vali Loss: 45.771 Vali Acc: 0.473 Test Loss: 45.771 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.359926700592041
Epoch: 8, Steps: 32 | Train Loss: 2.540 Vali Loss: 56.963 Vali Acc: 0.489 Test Loss: 56.963 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.287893772125244
Epoch: 9, Steps: 32 | Train Loss: 1.338 Vali Loss: 50.846 Vali Acc: 0.466 Test Loss: 50.846 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.99244499206543
Epoch: 10, Steps: 32 | Train Loss: 2.116 Vali Loss: 46.783 Vali Acc: 0.366 Test Loss: 46.783 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.986868858337402
Epoch: 11, Steps: 32 | Train Loss: 2.169 Vali Loss: 75.494 Vali Acc: 0.237 Test Loss: 75.494 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.26787805557251
Epoch: 12, Steps: 32 | Train Loss: 2.085 Vali Loss: 59.050 Vali Acc: 0.489 Test Loss: 59.050 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.451002836227417
Epoch: 13, Steps: 32 | Train Loss: 2.952 Vali Loss: 83.775 Vali Acc: 0.336 Test Loss: 83.775 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.028650283813477
Epoch: 14, Steps: 32 | Train Loss: 3.926 Vali Loss: 51.130 Vali Acc: 0.519 Test Loss: 51.130 Test Acc: 0.519
Validation loss decreased (-0.503568 --> -0.518573).  Saving model ...
Epoch: 15 cost time: 12.153981685638428
Epoch: 15, Steps: 32 | Train Loss: 1.385 Vali Loss: 52.326 Vali Acc: 0.496 Test Loss: 52.326 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.324826002120972
Epoch: 16, Steps: 32 | Train Loss: 29.169 Vali Loss: 69.017 Vali Acc: 0.374 Test Loss: 69.017 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.214719533920288
Epoch: 17, Steps: 32 | Train Loss: 31.790 Vali Loss: 137.617 Vali Acc: 0.183 Test Loss: 137.617 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.146904468536377
Epoch: 18, Steps: 32 | Train Loss: 32.581 Vali Loss: 73.546 Vali Acc: 0.321 Test Loss: 73.546 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.120013236999512
Epoch: 19, Steps: 32 | Train Loss: 10.444 Vali Loss: 124.961 Vali Acc: 0.252 Test Loss: 124.961 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.381965637207031
Epoch: 20, Steps: 32 | Train Loss: 12.111 Vali Loss: 109.580 Vali Acc: 0.229 Test Loss: 109.580 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.355797529220581
Epoch: 21, Steps: 32 | Train Loss: 6.708 Vali Loss: 121.091 Vali Acc: 0.252 Test Loss: 121.091 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.319750785827637
Epoch: 22, Steps: 32 | Train Loss: 1.856 Vali Loss: 76.371 Vali Acc: 0.305 Test Loss: 76.371 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.981127738952637
Epoch: 23, Steps: 32 | Train Loss: 3.747 Vali Loss: 82.520 Vali Acc: 0.450 Test Loss: 82.520 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 12.517833232879639
Epoch: 24, Steps: 32 | Train Loss: 0.063 Vali Loss: 69.463 Vali Acc: 0.420 Test Loss: 69.463 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 17133353
model size : 83.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.155768394470215
Epoch: 1, Steps: 32 | Train Loss: 14.292 Vali Loss: 30.960 Vali Acc: 0.183 Test Loss: 30.960 Test Acc: 0.183
Validation loss decreased (inf --> -0.182897).  Saving model ...
Epoch: 2 cost time: 11.735979318618774
Epoch: 2, Steps: 32 | Train Loss: 28.170 Vali Loss: 26.988 Vali Acc: 0.450 Test Loss: 26.988 Test Acc: 0.450
Validation loss decreased (-0.182897 --> -0.450112).  Saving model ...
Epoch: 3 cost time: 11.971941471099854
Epoch: 3, Steps: 32 | Train Loss: 10.504 Vali Loss: 28.968 Vali Acc: 0.305 Test Loss: 28.968 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.798989534378052
Epoch: 4, Steps: 32 | Train Loss: 12.167 Vali Loss: 26.014 Vali Acc: 0.344 Test Loss: 26.014 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.844594717025757
Epoch: 5, Steps: 32 | Train Loss: 2.164 Vali Loss: 40.325 Vali Acc: 0.321 Test Loss: 40.325 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.615046739578247
Epoch: 6, Steps: 32 | Train Loss: 5.778 Vali Loss: 34.625 Vali Acc: 0.427 Test Loss: 34.625 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.304778099060059
Epoch: 7, Steps: 32 | Train Loss: 1.305 Vali Loss: 39.087 Vali Acc: 0.427 Test Loss: 39.087 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.979218244552612
Epoch: 8, Steps: 32 | Train Loss: 0.332 Vali Loss: 39.760 Vali Acc: 0.466 Test Loss: 39.760 Test Acc: 0.466
Validation loss decreased (-0.450112 --> -0.465251).  Saving model ...
Epoch: 9 cost time: 11.727688312530518
Epoch: 9, Steps: 32 | Train Loss: 1.806 Vali Loss: 55.939 Vali Acc: 0.305 Test Loss: 55.939 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.852671384811401
Epoch: 10, Steps: 32 | Train Loss: 4.189 Vali Loss: 53.522 Vali Acc: 0.282 Test Loss: 53.522 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.920952796936035
Epoch: 11, Steps: 32 | Train Loss: 2.380 Vali Loss: 59.571 Vali Acc: 0.511 Test Loss: 59.571 Test Acc: 0.511
Validation loss decreased (-0.465251 --> -0.510855).  Saving model ...
Epoch: 12 cost time: 11.927202463150024
Epoch: 12, Steps: 32 | Train Loss: 3.945 Vali Loss: 58.765 Vali Acc: 0.305 Test Loss: 58.765 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.916167497634888
Epoch: 13, Steps: 32 | Train Loss: 0.013 Vali Loss: 56.619 Vali Acc: 0.389 Test Loss: 56.619 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.942706823348999
Epoch: 14, Steps: 32 | Train Loss: 1.767 Vali Loss: 63.478 Vali Acc: 0.466 Test Loss: 63.478 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.778144598007202
Epoch: 15, Steps: 32 | Train Loss: 1.300 Vali Loss: 66.389 Vali Acc: 0.527 Test Loss: 66.389 Test Acc: 0.527
Validation loss decreased (-0.510855 --> -0.526054).  Saving model ...
Epoch: 16 cost time: 12.028477668762207
Epoch: 16, Steps: 32 | Train Loss: 7.641 Vali Loss: 61.338 Vali Acc: 0.511 Test Loss: 61.338 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.74146032333374
Epoch: 17, Steps: 32 | Train Loss: 0.083 Vali Loss: 56.588 Vali Acc: 0.366 Test Loss: 56.588 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.785437107086182
Epoch: 18, Steps: 32 | Train Loss: 0.752 Vali Loss: 67.129 Vali Acc: 0.511 Test Loss: 67.129 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.856626987457275
Epoch: 19, Steps: 32 | Train Loss: 3.459 Vali Loss: 61.992 Vali Acc: 0.351 Test Loss: 61.992 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.947538614273071
Epoch: 20, Steps: 32 | Train Loss: 1.074 Vali Loss: 70.614 Vali Acc: 0.466 Test Loss: 70.614 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.125112533569336
Epoch: 21, Steps: 32 | Train Loss: 3.875 Vali Loss: 78.432 Vali Acc: 0.473 Test Loss: 78.432 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.74641752243042
Epoch: 22, Steps: 32 | Train Loss: 3.740 Vali Loss: 102.364 Vali Acc: 0.206 Test Loss: 102.364 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.856850147247314
Epoch: 23, Steps: 32 | Train Loss: 16.700 Vali Loss: 102.400 Vali Acc: 0.282 Test Loss: 102.400 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 11.6905357837677
Epoch: 24, Steps: 32 | Train Loss: 1.060 Vali Loss: 89.720 Vali Acc: 0.374 Test Loss: 89.720 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.736780881881714
Epoch: 25, Steps: 32 | Train Loss: 0.786 Vali Loss: 100.790 Vali Acc: 0.328 Test Loss: 100.790 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 16557609
model size : 80.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.265978813171387
Epoch: 1, Steps: 32 | Train Loss: 13.957 Vali Loss: 49.772 Vali Acc: 0.168 Test Loss: 49.772 Test Acc: 0.168
Validation loss decreased (inf --> -0.167441).  Saving model ...
Epoch: 2 cost time: 11.908902645111084
Epoch: 2, Steps: 32 | Train Loss: 29.531 Vali Loss: 23.943 Vali Acc: 0.221 Test Loss: 23.943 Test Acc: 0.221
Validation loss decreased (-0.167441 --> -0.221135).  Saving model ...
Epoch: 3 cost time: 11.990566730499268
Epoch: 3, Steps: 32 | Train Loss: 19.047 Vali Loss: 30.904 Vali Acc: 0.473 Test Loss: 30.904 Test Acc: 0.473
Validation loss decreased (-0.221135 --> -0.472973).  Saving model ...
Epoch: 4 cost time: 11.849072933197021
Epoch: 4, Steps: 32 | Train Loss: 12.060 Vali Loss: 27.358 Vali Acc: 0.481 Test Loss: 27.358 Test Acc: 0.481
Validation loss decreased (-0.472973 --> -0.480642).  Saving model ...
Epoch: 5 cost time: 11.915758848190308
Epoch: 5, Steps: 32 | Train Loss: 2.128 Vali Loss: 34.777 Vali Acc: 0.397 Test Loss: 34.777 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.003047943115234
Epoch: 6, Steps: 32 | Train Loss: 3.400 Vali Loss: 44.215 Vali Acc: 0.481 Test Loss: 44.215 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.968030452728271
Epoch: 7, Steps: 32 | Train Loss: 1.927 Vali Loss: 69.113 Vali Acc: 0.542 Test Loss: 69.113 Test Acc: 0.542
Validation loss decreased (-0.480642 --> -0.541294).  Saving model ...
Epoch: 8 cost time: 11.995314359664917
Epoch: 8, Steps: 32 | Train Loss: 3.728 Vali Loss: 59.801 Vali Acc: 0.420 Test Loss: 59.801 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.992656707763672
Epoch: 9, Steps: 32 | Train Loss: 16.015 Vali Loss: 65.531 Vali Acc: 0.282 Test Loss: 65.531 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.116506099700928
Epoch: 10, Steps: 32 | Train Loss: 4.542 Vali Loss: 61.599 Vali Acc: 0.435 Test Loss: 61.599 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.080747127532959
Epoch: 11, Steps: 32 | Train Loss: 1.187 Vali Loss: 64.872 Vali Acc: 0.359 Test Loss: 64.872 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.865299701690674
Epoch: 12, Steps: 32 | Train Loss: 0.805 Vali Loss: 65.925 Vali Acc: 0.435 Test Loss: 65.925 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.802663326263428
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.559 Vali Acc: 0.359 Test Loss: 67.559 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.841065645217896
Epoch: 14, Steps: 32 | Train Loss: 0.566 Vali Loss: 68.796 Vali Acc: 0.481 Test Loss: 68.796 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.903116941452026
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 68.822 Vali Acc: 0.496 Test Loss: 68.822 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.093156099319458
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 68.879 Vali Acc: 0.496 Test Loss: 68.879 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.013754844665527
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 68.881 Vali Acc: 0.496 Test Loss: 68.881 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 16971561
model size : 82.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.425864219665527
Epoch: 1, Steps: 32 | Train Loss: 13.784 Vali Loss: 30.953 Vali Acc: 0.420 Test Loss: 30.953 Test Acc: 0.420
Validation loss decreased (inf --> -0.419538).  Saving model ...
Epoch: 2 cost time: 11.97860860824585
Epoch: 2, Steps: 32 | Train Loss: 39.585 Vali Loss: 24.264 Vali Acc: 0.443 Test Loss: 24.264 Test Acc: 0.443
Validation loss decreased (-0.419538 --> -0.442505).  Saving model ...
Epoch: 3 cost time: 11.838042497634888
Epoch: 3, Steps: 32 | Train Loss: 12.594 Vali Loss: 34.844 Vali Acc: 0.374 Test Loss: 34.844 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.765089988708496
Epoch: 4, Steps: 32 | Train Loss: 10.735 Vali Loss: 35.160 Vali Acc: 0.389 Test Loss: 35.160 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.876978158950806
Epoch: 5, Steps: 32 | Train Loss: 5.781 Vali Loss: 37.918 Vali Acc: 0.504 Test Loss: 37.918 Test Acc: 0.504
Validation loss decreased (-0.442505 --> -0.503438).  Saving model ...
Epoch: 6 cost time: 11.739737510681152
Epoch: 6, Steps: 32 | Train Loss: 1.536 Vali Loss: 51.461 Vali Acc: 0.481 Test Loss: 51.461 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.851401805877686
Epoch: 7, Steps: 32 | Train Loss: 12.125 Vali Loss: 48.487 Vali Acc: 0.305 Test Loss: 48.487 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.782470703125
Epoch: 8, Steps: 32 | Train Loss: 2.970 Vali Loss: 56.022 Vali Acc: 0.336 Test Loss: 56.022 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.95499038696289
Epoch: 9, Steps: 32 | Train Loss: 5.626 Vali Loss: 64.734 Vali Acc: 0.450 Test Loss: 64.734 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.964479923248291
Epoch: 10, Steps: 32 | Train Loss: 3.106 Vali Loss: 57.638 Vali Acc: 0.496 Test Loss: 57.638 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.411534547805786
Epoch: 11, Steps: 32 | Train Loss: 2.589 Vali Loss: 57.474 Vali Acc: 0.458 Test Loss: 57.474 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.961637020111084
Epoch: 12, Steps: 32 | Train Loss: 1.002 Vali Loss: 53.067 Vali Acc: 0.412 Test Loss: 53.067 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.120941877365112
Epoch: 13, Steps: 32 | Train Loss: 0.436 Vali Loss: 65.883 Vali Acc: 0.504 Test Loss: 65.883 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.955526351928711
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 69.241 Vali Acc: 0.489 Test Loss: 69.241 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.352124452590942
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 69.304 Vali Acc: 0.489 Test Loss: 69.304 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 16395817
model size : 80.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.178279161453247
Epoch: 1, Steps: 32 | Train Loss: 13.452 Vali Loss: 32.398 Vali Acc: 0.137 Test Loss: 32.398 Test Acc: 0.137
Validation loss decreased (inf --> -0.137081).  Saving model ...
Epoch: 2 cost time: 11.638368368148804
Epoch: 2, Steps: 32 | Train Loss: 26.551 Vali Loss: 27.178 Vali Acc: 0.229 Test Loss: 27.178 Test Acc: 0.229
Validation loss decreased (-0.137081 --> -0.228736).  Saving model ...
Epoch: 3 cost time: 11.656879901885986
Epoch: 3, Steps: 32 | Train Loss: 16.606 Vali Loss: 30.255 Vali Acc: 0.237 Test Loss: 30.255 Test Acc: 0.237
Validation loss decreased (-0.228736 --> -0.236339).  Saving model ...
Epoch: 4 cost time: 11.580855131149292
Epoch: 4, Steps: 32 | Train Loss: 7.661 Vali Loss: 31.655 Vali Acc: 0.473 Test Loss: 31.655 Test Acc: 0.473
Validation loss decreased (-0.236339 --> -0.472966).  Saving model ...
Epoch: 5 cost time: 11.621065139770508
Epoch: 5, Steps: 32 | Train Loss: 7.397 Vali Loss: 44.710 Vali Acc: 0.351 Test Loss: 44.710 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.791305303573608
Epoch: 6, Steps: 32 | Train Loss: 5.033 Vali Loss: 38.398 Vali Acc: 0.489 Test Loss: 38.398 Test Acc: 0.489
Validation loss decreased (-0.472966 --> -0.488166).  Saving model ...
Epoch: 7 cost time: 11.725995779037476
Epoch: 7, Steps: 32 | Train Loss: 1.836 Vali Loss: 73.676 Vali Acc: 0.260 Test Loss: 73.676 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.749736309051514
Epoch: 8, Steps: 32 | Train Loss: 1.598 Vali Loss: 66.287 Vali Acc: 0.267 Test Loss: 66.287 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.667638540267944
Epoch: 9, Steps: 32 | Train Loss: 3.503 Vali Loss: 64.076 Vali Acc: 0.366 Test Loss: 64.076 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.762582540512085
Epoch: 10, Steps: 32 | Train Loss: 0.693 Vali Loss: 50.457 Vali Acc: 0.412 Test Loss: 50.457 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.032124280929565
Epoch: 11, Steps: 32 | Train Loss: 1.036 Vali Loss: 63.669 Vali Acc: 0.359 Test Loss: 63.669 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.664789915084839
Epoch: 12, Steps: 32 | Train Loss: 1.661 Vali Loss: 58.290 Vali Acc: 0.344 Test Loss: 58.290 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.945420265197754
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.011 Vali Acc: 0.351 Test Loss: 60.011 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.819279670715332
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.122 Vali Acc: 0.336 Test Loss: 60.122 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.708927631378174
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.126 Vali Acc: 0.336 Test Loss: 60.126 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.680968999862671
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.126 Vali Acc: 0.336 Test Loss: 60.126 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 15820073
model size : 78.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.769675970077515
Epoch: 1, Steps: 32 | Train Loss: 15.047 Vali Loss: 45.943 Vali Acc: 0.137 Test Loss: 45.943 Test Acc: 0.137
Validation loss decreased (inf --> -0.136945).  Saving model ...
Epoch: 2 cost time: 11.276553630828857
Epoch: 2, Steps: 32 | Train Loss: 45.506 Vali Loss: 32.982 Vali Acc: 0.443 Test Loss: 32.982 Test Acc: 0.443
Validation loss decreased (-0.136945 --> -0.442418).  Saving model ...
Epoch: 3 cost time: 11.338861465454102
Epoch: 3, Steps: 32 | Train Loss: 10.743 Vali Loss: 26.363 Vali Acc: 0.374 Test Loss: 26.363 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.354567527770996
Epoch: 4, Steps: 32 | Train Loss: 8.821 Vali Loss: 33.663 Vali Acc: 0.534 Test Loss: 33.663 Test Acc: 0.534
Validation loss decreased (-0.442418 --> -0.534015).  Saving model ...
Epoch: 5 cost time: 11.363723039627075
Epoch: 5, Steps: 32 | Train Loss: 4.938 Vali Loss: 33.502 Vali Acc: 0.435 Test Loss: 33.502 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.358747482299805
Epoch: 6, Steps: 32 | Train Loss: 2.434 Vali Loss: 44.467 Vali Acc: 0.435 Test Loss: 44.467 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.352267980575562
Epoch: 7, Steps: 32 | Train Loss: 0.564 Vali Loss: 48.780 Vali Acc: 0.397 Test Loss: 48.780 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.302224159240723
Epoch: 8, Steps: 32 | Train Loss: 2.280 Vali Loss: 58.710 Vali Acc: 0.305 Test Loss: 58.710 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.459511995315552
Epoch: 9, Steps: 32 | Train Loss: 3.607 Vali Loss: 67.703 Vali Acc: 0.534 Test Loss: 67.703 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.278116703033447
Epoch: 10, Steps: 32 | Train Loss: 0.578 Vali Loss: 47.218 Vali Acc: 0.435 Test Loss: 47.218 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.455007791519165
Epoch: 11, Steps: 32 | Train Loss: 1.503 Vali Loss: 64.074 Vali Acc: 0.489 Test Loss: 64.074 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.266455173492432
Epoch: 12, Steps: 32 | Train Loss: 5.949 Vali Loss: 43.613 Vali Acc: 0.489 Test Loss: 43.613 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.435762166976929
Epoch: 13, Steps: 32 | Train Loss: 24.770 Vali Loss: 78.606 Vali Acc: 0.511 Test Loss: 78.606 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.31826663017273
Epoch: 14, Steps: 32 | Train Loss: 2.022 Vali Loss: 114.296 Vali Acc: 0.252 Test Loss: 114.296 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 15244329
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.00052809715271
Epoch: 1, Steps: 32 | Train Loss: 18.297 Vali Loss: 35.690 Vali Acc: 0.168 Test Loss: 35.690 Test Acc: 0.168
Validation loss decreased (inf --> -0.167582).  Saving model ...
Epoch: 2 cost time: 11.759324789047241
Epoch: 2, Steps: 32 | Train Loss: 33.076 Vali Loss: 70.573 Vali Acc: 0.168 Test Loss: 70.573 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.087001085281372
Epoch: 3, Steps: 32 | Train Loss: 26.388 Vali Loss: 29.308 Vali Acc: 0.473 Test Loss: 29.308 Test Acc: 0.473
Validation loss decreased (-0.167582 --> -0.472989).  Saving model ...
Epoch: 4 cost time: 11.906075239181519
Epoch: 4, Steps: 32 | Train Loss: 7.702 Vali Loss: 42.501 Vali Acc: 0.481 Test Loss: 42.501 Test Acc: 0.481
Validation loss decreased (-0.472989 --> -0.480491).  Saving model ...
Epoch: 5 cost time: 11.821365118026733
Epoch: 5, Steps: 32 | Train Loss: 5.925 Vali Loss: 33.274 Vali Acc: 0.397 Test Loss: 33.274 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.832813739776611
Epoch: 6, Steps: 32 | Train Loss: 1.547 Vali Loss: 38.224 Vali Acc: 0.458 Test Loss: 38.224 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.305105924606323
Epoch: 7, Steps: 32 | Train Loss: 0.426 Vali Loss: 35.779 Vali Acc: 0.435 Test Loss: 35.779 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.950476884841919
Epoch: 8, Steps: 32 | Train Loss: 0.627 Vali Loss: 48.024 Vali Acc: 0.489 Test Loss: 48.024 Test Acc: 0.489
Validation loss decreased (-0.480491 --> -0.488069).  Saving model ...
Epoch: 9 cost time: 11.897425413131714
Epoch: 9, Steps: 32 | Train Loss: 1.354 Vali Loss: 51.298 Vali Acc: 0.397 Test Loss: 51.298 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.829481601715088
Epoch: 10, Steps: 32 | Train Loss: 4.247 Vali Loss: 54.576 Vali Acc: 0.504 Test Loss: 54.576 Test Acc: 0.504
Validation loss decreased (-0.488069 --> -0.503271).  Saving model ...
Epoch: 11 cost time: 12.06424355506897
Epoch: 11, Steps: 32 | Train Loss: 8.306 Vali Loss: 59.892 Vali Acc: 0.336 Test Loss: 59.892 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.917411088943481
Epoch: 12, Steps: 32 | Train Loss: 5.004 Vali Loss: 66.463 Vali Acc: 0.374 Test Loss: 66.463 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.975003242492676
Epoch: 13, Steps: 32 | Train Loss: 2.331 Vali Loss: 78.264 Vali Acc: 0.351 Test Loss: 78.264 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.889264583587646
Epoch: 14, Steps: 32 | Train Loss: 0.908 Vali Loss: 116.587 Vali Acc: 0.305 Test Loss: 116.587 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.034965991973877
Epoch: 15, Steps: 32 | Train Loss: 6.973 Vali Loss: 114.897 Vali Acc: 0.496 Test Loss: 114.897 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.226994514465332
Epoch: 16, Steps: 32 | Train Loss: 3.204 Vali Loss: 70.109 Vali Acc: 0.420 Test Loss: 70.109 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.870539903640747
Epoch: 17, Steps: 32 | Train Loss: 0.567 Vali Loss: 86.368 Vali Acc: 0.382 Test Loss: 86.368 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.825902700424194
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.467 Vali Acc: 0.389 Test Loss: 87.467 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.062463521957397
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.580 Vali Acc: 0.389 Test Loss: 87.580 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.787534713745117
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.582 Vali Acc: 0.389 Test Loss: 87.582 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 16314921
model size : 79.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.042898178100586
Epoch: 1, Steps: 32 | Train Loss: 25.545 Vali Loss: 23.040 Vali Acc: 0.206 Test Loss: 23.040 Test Acc: 0.206
Validation loss decreased (inf --> -0.205876).  Saving model ...
Epoch: 2 cost time: 11.624695777893066
Epoch: 2, Steps: 32 | Train Loss: 53.416 Vali Loss: 58.438 Vali Acc: 0.435 Test Loss: 58.438 Test Acc: 0.435
Validation loss decreased (-0.205876 --> -0.434530).  Saving model ...
Epoch: 3 cost time: 11.740089893341064
Epoch: 3, Steps: 32 | Train Loss: 11.971 Vali Loss: 35.675 Vali Acc: 0.290 Test Loss: 35.675 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.908893585205078
Epoch: 4, Steps: 32 | Train Loss: 16.247 Vali Loss: 29.171 Vali Acc: 0.481 Test Loss: 29.171 Test Acc: 0.481
Validation loss decreased (-0.434530 --> -0.480624).  Saving model ...
Epoch: 5 cost time: 11.48288345336914
Epoch: 5, Steps: 32 | Train Loss: 4.511 Vali Loss: 38.374 Vali Acc: 0.450 Test Loss: 38.374 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.754550695419312
Epoch: 6, Steps: 32 | Train Loss: 4.201 Vali Loss: 43.651 Vali Acc: 0.496 Test Loss: 43.651 Test Acc: 0.496
Validation loss decreased (-0.480624 --> -0.495747).  Saving model ...
Epoch: 7 cost time: 11.6989266872406
Epoch: 7, Steps: 32 | Train Loss: 1.965 Vali Loss: 42.281 Vali Acc: 0.435 Test Loss: 42.281 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.80959153175354
Epoch: 8, Steps: 32 | Train Loss: 1.991 Vali Loss: 52.381 Vali Acc: 0.290 Test Loss: 52.381 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.830897808074951
Epoch: 9, Steps: 32 | Train Loss: 3.044 Vali Loss: 51.487 Vali Acc: 0.443 Test Loss: 51.487 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.012645721435547
Epoch: 10, Steps: 32 | Train Loss: 1.262 Vali Loss: 55.666 Vali Acc: 0.443 Test Loss: 55.666 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.879731893539429
Epoch: 11, Steps: 32 | Train Loss: 0.314 Vali Loss: 59.821 Vali Acc: 0.389 Test Loss: 59.821 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.978521347045898
Epoch: 12, Steps: 32 | Train Loss: 1.295 Vali Loss: 57.009 Vali Acc: 0.489 Test Loss: 57.009 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.752475500106812
Epoch: 13, Steps: 32 | Train Loss: 4.336 Vali Loss: 47.737 Vali Acc: 0.412 Test Loss: 47.737 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.023473262786865
Epoch: 14, Steps: 32 | Train Loss: 2.386 Vali Loss: 39.250 Vali Acc: 0.496 Test Loss: 39.250 Test Acc: 0.496
Validation loss decreased (-0.495747 --> -0.495791).  Saving model ...
Epoch: 15 cost time: 11.837819337844849
Epoch: 15, Steps: 32 | Train Loss: 0.155 Vali Loss: 66.604 Vali Acc: 0.351 Test Loss: 66.604 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.875893115997314
Epoch: 16, Steps: 32 | Train Loss: 1.175 Vali Loss: 60.241 Vali Acc: 0.458 Test Loss: 60.241 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.936112642288208
Epoch: 17, Steps: 32 | Train Loss: 1.746 Vali Loss: 96.759 Vali Acc: 0.267 Test Loss: 96.759 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.87425184249878
Epoch: 18, Steps: 32 | Train Loss: 1.929 Vali Loss: 98.009 Vali Acc: 0.481 Test Loss: 98.009 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.998252391815186
Epoch: 19, Steps: 32 | Train Loss: 5.328 Vali Loss: 138.160 Vali Acc: 0.534 Test Loss: 138.160 Test Acc: 0.534
Validation loss decreased (-0.495791 --> -0.532970).  Saving model ...
Epoch: 20 cost time: 12.010544300079346
Epoch: 20, Steps: 32 | Train Loss: 7.727 Vali Loss: 95.230 Vali Acc: 0.305 Test Loss: 95.230 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.000501155853271
Epoch: 21, Steps: 32 | Train Loss: 1.016 Vali Loss: 112.294 Vali Acc: 0.511 Test Loss: 112.294 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.161121368408203
Epoch: 22, Steps: 32 | Train Loss: 1.991 Vali Loss: 108.370 Vali Acc: 0.420 Test Loss: 108.370 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.772706031799316
Epoch: 23, Steps: 32 | Train Loss: 3.640 Vali Loss: 82.291 Vali Acc: 0.328 Test Loss: 82.291 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.808472633361816
Epoch: 24, Steps: 32 | Train Loss: 1.120 Vali Loss: 126.605 Vali Acc: 0.527 Test Loss: 126.605 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 12.026354312896729
Epoch: 25, Steps: 32 | Train Loss: 0.046 Vali Loss: 114.741 Vali Acc: 0.466 Test Loss: 114.741 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.751684188842773
Epoch: 26, Steps: 32 | Train Loss: 0.188 Vali Loss: 97.751 Vali Acc: 0.443 Test Loss: 97.751 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.692334413528442
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.932 Vali Acc: 0.427 Test Loss: 97.932 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 12.09472107887268
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.940 Vali Acc: 0.427 Test Loss: 97.940 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.961381435394287
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.941 Vali Acc: 0.427 Test Loss: 97.941 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 15739177
model size : 77.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.229459285736084
Epoch: 1, Steps: 32 | Train Loss: 29.562 Vali Loss: 24.925 Vali Acc: 0.160 Test Loss: 24.925 Test Acc: 0.160
Validation loss decreased (inf --> -0.160056).  Saving model ...
Epoch: 2 cost time: 11.756962060928345
Epoch: 2, Steps: 32 | Train Loss: 27.487 Vali Loss: 22.951 Vali Acc: 0.481 Test Loss: 22.951 Test Acc: 0.481
Validation loss decreased (-0.160056 --> -0.480687).  Saving model ...
Epoch: 3 cost time: 11.589838981628418
Epoch: 3, Steps: 32 | Train Loss: 20.600 Vali Loss: 37.184 Vali Acc: 0.481 Test Loss: 37.184 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.743408441543579
Epoch: 4, Steps: 32 | Train Loss: 12.320 Vali Loss: 37.674 Vali Acc: 0.374 Test Loss: 37.674 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.427967548370361
Epoch: 5, Steps: 32 | Train Loss: 7.598 Vali Loss: 35.938 Vali Acc: 0.450 Test Loss: 35.938 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.692397117614746
Epoch: 6, Steps: 32 | Train Loss: 0.979 Vali Loss: 50.803 Vali Acc: 0.458 Test Loss: 50.803 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.595792055130005
Epoch: 7, Steps: 32 | Train Loss: 2.302 Vali Loss: 46.052 Vali Acc: 0.519 Test Loss: 46.052 Test Acc: 0.519
Validation loss decreased (-0.480687 --> -0.518623).  Saving model ...
Epoch: 8 cost time: 11.620405435562134
Epoch: 8, Steps: 32 | Train Loss: 0.393 Vali Loss: 47.523 Vali Acc: 0.435 Test Loss: 47.523 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.762770652770996
Epoch: 9, Steps: 32 | Train Loss: 1.088 Vali Loss: 46.320 Vali Acc: 0.427 Test Loss: 46.320 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.652066946029663
Epoch: 10, Steps: 32 | Train Loss: 1.771 Vali Loss: 53.562 Vali Acc: 0.458 Test Loss: 53.562 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.623369932174683
Epoch: 11, Steps: 32 | Train Loss: 3.435 Vali Loss: 54.690 Vali Acc: 0.443 Test Loss: 54.690 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.733386516571045
Epoch: 12, Steps: 32 | Train Loss: 0.433 Vali Loss: 75.735 Vali Acc: 0.344 Test Loss: 75.735 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.555136919021606
Epoch: 13, Steps: 32 | Train Loss: 0.824 Vali Loss: 76.710 Vali Acc: 0.336 Test Loss: 76.710 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.533996343612671
Epoch: 14, Steps: 32 | Train Loss: 3.241 Vali Loss: 101.907 Vali Acc: 0.511 Test Loss: 101.907 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.612276554107666
Epoch: 15, Steps: 32 | Train Loss: 2.939 Vali Loss: 80.286 Vali Acc: 0.351 Test Loss: 80.286 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.807024717330933
Epoch: 16, Steps: 32 | Train Loss: 1.802 Vali Loss: 82.854 Vali Acc: 0.466 Test Loss: 82.854 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.566898107528687
Epoch: 17, Steps: 32 | Train Loss: 3.365 Vali Loss: 84.046 Vali Acc: 0.473 Test Loss: 84.046 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 15163433
model size : 75.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.728355169296265
Epoch: 1, Steps: 32 | Train Loss: 20.720 Vali Loss: 17.498 Vali Acc: 0.435 Test Loss: 17.498 Test Acc: 0.435
Validation loss decreased (inf --> -0.434940).  Saving model ...
Epoch: 2 cost time: 11.13929796218872
Epoch: 2, Steps: 32 | Train Loss: 29.493 Vali Loss: 27.318 Vali Acc: 0.389 Test Loss: 27.318 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.311568021774292
Epoch: 3, Steps: 32 | Train Loss: 17.832 Vali Loss: 33.320 Vali Acc: 0.504 Test Loss: 33.320 Test Acc: 0.504
Validation loss decreased (-0.434940 --> -0.503484).  Saving model ...
Epoch: 4 cost time: 11.066751718521118
Epoch: 4, Steps: 32 | Train Loss: 4.235 Vali Loss: 42.930 Vali Acc: 0.481 Test Loss: 42.930 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.288813591003418
Epoch: 5, Steps: 32 | Train Loss: 8.044 Vali Loss: 39.593 Vali Acc: 0.496 Test Loss: 39.593 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.450638055801392
Epoch: 6, Steps: 32 | Train Loss: 6.330 Vali Loss: 47.523 Vali Acc: 0.435 Test Loss: 47.523 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.515276670455933
Epoch: 7, Steps: 32 | Train Loss: 6.049 Vali Loss: 47.091 Vali Acc: 0.481 Test Loss: 47.091 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.428837060928345
Epoch: 8, Steps: 32 | Train Loss: 0.951 Vali Loss: 56.498 Vali Acc: 0.519 Test Loss: 56.498 Test Acc: 0.519
Validation loss decreased (-0.503484 --> -0.518519).  Saving model ...
Epoch: 9 cost time: 11.251393556594849
Epoch: 9, Steps: 32 | Train Loss: 4.859 Vali Loss: 56.815 Vali Acc: 0.496 Test Loss: 56.815 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.240596294403076
Epoch: 10, Steps: 32 | Train Loss: 0.243 Vali Loss: 57.764 Vali Acc: 0.443 Test Loss: 57.764 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.383390665054321
Epoch: 11, Steps: 32 | Train Loss: 3.769 Vali Loss: 62.206 Vali Acc: 0.443 Test Loss: 62.206 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.38805866241455
Epoch: 12, Steps: 32 | Train Loss: 5.477 Vali Loss: 59.737 Vali Acc: 0.382 Test Loss: 59.737 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.106534481048584
Epoch: 13, Steps: 32 | Train Loss: 1.472 Vali Loss: 70.665 Vali Acc: 0.496 Test Loss: 70.665 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.212838649749756
Epoch: 14, Steps: 32 | Train Loss: 1.819 Vali Loss: 62.832 Vali Acc: 0.382 Test Loss: 62.832 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.200292825698853
Epoch: 15, Steps: 32 | Train Loss: 1.318 Vali Loss: 71.549 Vali Acc: 0.481 Test Loss: 71.549 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.341737270355225
Epoch: 16, Steps: 32 | Train Loss: 0.107 Vali Loss: 67.231 Vali Acc: 0.504 Test Loss: 67.231 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.385950326919556
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 77.057 Vali Acc: 0.344 Test Loss: 77.057 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.200857639312744
Epoch: 18, Steps: 32 | Train Loss: 0.775 Vali Loss: 78.330 Vali Acc: 0.443 Test Loss: 78.330 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 14587689
model size : 73.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.269766807556152
Epoch: 1, Steps: 32 | Train Loss: 13.869 Vali Loss: 40.061 Vali Acc: 0.420 Test Loss: 40.061 Test Acc: 0.420
Validation loss decreased (inf --> -0.419447).  Saving model ...
Epoch: 2 cost time: 11.657970905303955
Epoch: 2, Steps: 32 | Train Loss: 34.290 Vali Loss: 37.120 Vali Acc: 0.198 Test Loss: 37.120 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.999664545059204
Epoch: 3, Steps: 32 | Train Loss: 14.399 Vali Loss: 22.610 Vali Acc: 0.290 Test Loss: 22.610 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.787012815475464
Epoch: 4, Steps: 32 | Train Loss: 11.359 Vali Loss: 37.393 Vali Acc: 0.344 Test Loss: 37.393 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.301651239395142
Epoch: 5, Steps: 32 | Train Loss: 5.791 Vali Loss: 37.171 Vali Acc: 0.427 Test Loss: 37.171 Test Acc: 0.427
Validation loss decreased (-0.419447 --> -0.427109).  Saving model ...
Epoch: 6 cost time: 11.766223430633545
Epoch: 6, Steps: 32 | Train Loss: 4.581 Vali Loss: 57.181 Vali Acc: 0.496 Test Loss: 57.181 Test Acc: 0.496
Validation loss decreased (-0.427109 --> -0.495611).  Saving model ...
Epoch: 7 cost time: 11.577513933181763
Epoch: 7, Steps: 32 | Train Loss: 2.242 Vali Loss: 50.483 Vali Acc: 0.534 Test Loss: 50.483 Test Acc: 0.534
Validation loss decreased (-0.495611 --> -0.533846).  Saving model ...
Epoch: 8 cost time: 11.621690034866333
Epoch: 8, Steps: 32 | Train Loss: 3.142 Vali Loss: 48.559 Vali Acc: 0.496 Test Loss: 48.559 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.765546321868896
Epoch: 9, Steps: 32 | Train Loss: 0.851 Vali Loss: 70.918 Vali Acc: 0.389 Test Loss: 70.918 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.846335411071777
Epoch: 10, Steps: 32 | Train Loss: 3.947 Vali Loss: 55.404 Vali Acc: 0.420 Test Loss: 55.404 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.936743259429932
Epoch: 11, Steps: 32 | Train Loss: 88.447 Vali Loss: 41.578 Vali Acc: 0.466 Test Loss: 41.578 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.767112731933594
Epoch: 12, Steps: 32 | Train Loss: 6.505 Vali Loss: 80.001 Vali Acc: 0.519 Test Loss: 80.001 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.375152826309204
Epoch: 13, Steps: 32 | Train Loss: 5.660 Vali Loss: 70.470 Vali Acc: 0.443 Test Loss: 70.470 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.099591493606567
Epoch: 14, Steps: 32 | Train Loss: 2.608 Vali Loss: 59.646 Vali Acc: 0.527 Test Loss: 59.646 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.822367429733276
Epoch: 15, Steps: 32 | Train Loss: 2.314 Vali Loss: 60.203 Vali Acc: 0.427 Test Loss: 60.203 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.36344289779663
Epoch: 16, Steps: 32 | Train Loss: 1.472 Vali Loss: 95.008 Vali Acc: 0.504 Test Loss: 95.008 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.12891697883606
Epoch: 17, Steps: 32 | Train Loss: 5.311 Vali Loss: 58.693 Vali Acc: 0.496 Test Loss: 58.693 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 15986601
model size : 78.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.025395154953003
Epoch: 1, Steps: 32 | Train Loss: 18.068 Vali Loss: 32.515 Vali Acc: 0.137 Test Loss: 32.515 Test Acc: 0.137
Validation loss decreased (inf --> -0.137079).  Saving model ...
Epoch: 2 cost time: 11.561951637268066
Epoch: 2, Steps: 32 | Train Loss: 22.353 Vali Loss: 15.395 Vali Acc: 0.191 Test Loss: 15.395 Test Acc: 0.191
Validation loss decreased (-0.137079 --> -0.190686).  Saving model ...
Epoch: 3 cost time: 11.895534753799438
Epoch: 3, Steps: 32 | Train Loss: 17.993 Vali Loss: 20.966 Vali Acc: 0.405 Test Loss: 20.966 Test Acc: 0.405
Validation loss decreased (-0.190686 --> -0.404370).  Saving model ...
Epoch: 4 cost time: 11.779163837432861
Epoch: 4, Steps: 32 | Train Loss: 13.500 Vali Loss: 37.375 Vali Acc: 0.550 Test Loss: 37.375 Test Acc: 0.550
Validation loss decreased (-0.404370 --> -0.549245).  Saving model ...
Epoch: 5 cost time: 11.73487663269043
Epoch: 5, Steps: 32 | Train Loss: 6.725 Vali Loss: 43.007 Vali Acc: 0.580 Test Loss: 43.007 Test Acc: 0.580
Validation loss decreased (-0.549245 --> -0.579723).  Saving model ...
Epoch: 6 cost time: 11.797778844833374
Epoch: 6, Steps: 32 | Train Loss: 5.397 Vali Loss: 42.522 Vali Acc: 0.366 Test Loss: 42.522 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.821447849273682
Epoch: 7, Steps: 32 | Train Loss: 1.522 Vali Loss: 49.624 Vali Acc: 0.435 Test Loss: 49.624 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.75847840309143
Epoch: 8, Steps: 32 | Train Loss: 2.075 Vali Loss: 51.174 Vali Acc: 0.420 Test Loss: 51.174 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.860917329788208
Epoch: 9, Steps: 32 | Train Loss: 2.340 Vali Loss: 58.265 Vali Acc: 0.298 Test Loss: 58.265 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.80380654335022
Epoch: 10, Steps: 32 | Train Loss: 1.552 Vali Loss: 63.811 Vali Acc: 0.534 Test Loss: 63.811 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.873470544815063
Epoch: 11, Steps: 32 | Train Loss: 3.489 Vali Loss: 61.568 Vali Acc: 0.489 Test Loss: 61.568 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.844534397125244
Epoch: 12, Steps: 32 | Train Loss: 2.064 Vali Loss: 70.000 Vali Acc: 0.321 Test Loss: 70.000 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.857751607894897
Epoch: 13, Steps: 32 | Train Loss: 0.498 Vali Loss: 81.142 Vali Acc: 0.405 Test Loss: 81.142 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.6080162525177
Epoch: 14, Steps: 32 | Train Loss: 1.394 Vali Loss: 67.101 Vali Acc: 0.298 Test Loss: 67.101 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.699711561203003
Epoch: 15, Steps: 32 | Train Loss: 6.504 Vali Loss: 73.510 Vali Acc: 0.397 Test Loss: 73.510 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 15410857
model size : 76.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.342644214630127
Epoch: 1, Steps: 32 | Train Loss: 23.556 Vali Loss: 69.353 Vali Acc: 0.168 Test Loss: 69.353 Test Acc: 0.168
Validation loss decreased (inf --> -0.167245).  Saving model ...
Epoch: 2 cost time: 11.640231847763062
Epoch: 2, Steps: 32 | Train Loss: 29.051 Vali Loss: 44.015 Vali Acc: 0.176 Test Loss: 44.015 Test Acc: 0.176
Validation loss decreased (-0.167245 --> -0.175132).  Saving model ...
Epoch: 3 cost time: 11.852671384811401
Epoch: 3, Steps: 32 | Train Loss: 13.295 Vali Loss: 27.635 Vali Acc: 0.466 Test Loss: 27.635 Test Acc: 0.466
Validation loss decreased (-0.175132 --> -0.465373).  Saving model ...
Epoch: 4 cost time: 11.993019819259644
Epoch: 4, Steps: 32 | Train Loss: 9.928 Vali Loss: 37.141 Vali Acc: 0.344 Test Loss: 37.141 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.732818603515625
Epoch: 5, Steps: 32 | Train Loss: 6.047 Vali Loss: 56.844 Vali Acc: 0.527 Test Loss: 56.844 Test Acc: 0.527
Validation loss decreased (-0.465373 --> -0.526149).  Saving model ...
Epoch: 6 cost time: 11.696630716323853
Epoch: 6, Steps: 32 | Train Loss: 2.488 Vali Loss: 108.775 Vali Acc: 0.214 Test Loss: 108.775 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.850045919418335
Epoch: 7, Steps: 32 | Train Loss: 6.259 Vali Loss: 68.162 Vali Acc: 0.252 Test Loss: 68.162 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.848034858703613
Epoch: 8, Steps: 32 | Train Loss: 3.076 Vali Loss: 61.874 Vali Acc: 0.450 Test Loss: 61.874 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.663164854049683
Epoch: 9, Steps: 32 | Train Loss: 1.226 Vali Loss: 49.177 Vali Acc: 0.450 Test Loss: 49.177 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.608459234237671
Epoch: 10, Steps: 32 | Train Loss: 0.913 Vali Loss: 49.204 Vali Acc: 0.496 Test Loss: 49.204 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.610461473464966
Epoch: 11, Steps: 32 | Train Loss: 1.521 Vali Loss: 80.041 Vali Acc: 0.374 Test Loss: 80.041 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.809019565582275
Epoch: 12, Steps: 32 | Train Loss: 0.814 Vali Loss: 73.419 Vali Acc: 0.344 Test Loss: 73.419 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.821908235549927
Epoch: 13, Steps: 32 | Train Loss: 1.568 Vali Loss: 62.293 Vali Acc: 0.427 Test Loss: 62.293 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.802364587783813
Epoch: 14, Steps: 32 | Train Loss: 6.217 Vali Loss: 88.125 Vali Acc: 0.359 Test Loss: 88.125 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.627826929092407
Epoch: 15, Steps: 32 | Train Loss: 1.609 Vali Loss: 80.254 Vali Acc: 0.359 Test Loss: 80.254 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 14835113
model size : 74.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.956120252609253
Epoch: 1, Steps: 32 | Train Loss: 17.907 Vali Loss: 35.161 Vali Acc: 0.145 Test Loss: 35.161 Test Acc: 0.145
Validation loss decreased (inf --> -0.144687).  Saving model ...
Epoch: 2 cost time: 11.177202224731445
Epoch: 2, Steps: 32 | Train Loss: 46.827 Vali Loss: 19.705 Vali Acc: 0.145 Test Loss: 19.705 Test Acc: 0.145
Validation loss decreased (-0.144687 --> -0.144841).  Saving model ...
Epoch: 3 cost time: 11.278717517852783
Epoch: 3, Steps: 32 | Train Loss: 14.671 Vali Loss: 30.624 Vali Acc: 0.443 Test Loss: 30.624 Test Acc: 0.443
Validation loss decreased (-0.144841 --> -0.442442).  Saving model ...
Epoch: 4 cost time: 11.190779685974121
Epoch: 4, Steps: 32 | Train Loss: 11.083 Vali Loss: 27.470 Vali Acc: 0.397 Test Loss: 27.470 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.122938394546509
Epoch: 5, Steps: 32 | Train Loss: 7.543 Vali Loss: 34.851 Vali Acc: 0.504 Test Loss: 34.851 Test Acc: 0.504
Validation loss decreased (-0.442442 --> -0.503468).  Saving model ...
Epoch: 6 cost time: 11.20766568183899
Epoch: 6, Steps: 32 | Train Loss: 1.903 Vali Loss: 53.770 Vali Acc: 0.481 Test Loss: 53.770 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.293870687484741
Epoch: 7, Steps: 32 | Train Loss: 1.556 Vali Loss: 47.701 Vali Acc: 0.405 Test Loss: 47.701 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.106235027313232
Epoch: 8, Steps: 32 | Train Loss: 6.517 Vali Loss: 53.955 Vali Acc: 0.420 Test Loss: 53.955 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.30818486213684
Epoch: 9, Steps: 32 | Train Loss: 1.633 Vali Loss: 62.796 Vali Acc: 0.443 Test Loss: 62.796 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.428392887115479
Epoch: 10, Steps: 32 | Train Loss: 1.969 Vali Loss: 62.399 Vali Acc: 0.420 Test Loss: 62.399 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.45399022102356
Epoch: 11, Steps: 32 | Train Loss: 1.211 Vali Loss: 77.257 Vali Acc: 0.412 Test Loss: 77.257 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.391874551773071
Epoch: 12, Steps: 32 | Train Loss: 3.215 Vali Loss: 61.147 Vali Acc: 0.466 Test Loss: 61.147 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.497461080551147
Epoch: 13, Steps: 32 | Train Loss: 0.884 Vali Loss: 79.660 Vali Acc: 0.473 Test Loss: 79.660 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.505440950393677
Epoch: 14, Steps: 32 | Train Loss: 6.669 Vali Loss: 78.812 Vali Acc: 0.328 Test Loss: 78.812 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.453094244003296
Epoch: 15, Steps: 32 | Train Loss: 1.050 Vali Loss: 67.441 Vali Acc: 0.412 Test Loss: 67.441 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 14259369
model size : 72.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.5977041721344
Epoch: 1, Steps: 32 | Train Loss: 6.687 Vali Loss: 8.614 Vali Acc: 0.420 Test Loss: 8.614 Test Acc: 0.420
Validation loss decreased (inf --> -0.419761).  Saving model ...
Epoch: 2 cost time: 10.685432434082031
Epoch: 2, Steps: 32 | Train Loss: 16.826 Vali Loss: 23.871 Vali Acc: 0.145 Test Loss: 23.871 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.760669708251953
Epoch: 3, Steps: 32 | Train Loss: 13.042 Vali Loss: 13.948 Vali Acc: 0.511 Test Loss: 13.948 Test Acc: 0.511
Validation loss decreased (-0.419761 --> -0.511311).  Saving model ...
Epoch: 4 cost time: 10.823696851730347
Epoch: 4, Steps: 32 | Train Loss: 5.916 Vali Loss: 25.714 Vali Acc: 0.420 Test Loss: 25.714 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.950816869735718
Epoch: 5, Steps: 32 | Train Loss: 3.600 Vali Loss: 14.265 Vali Acc: 0.420 Test Loss: 14.265 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.74496340751648
Epoch: 6, Steps: 32 | Train Loss: 2.256 Vali Loss: 23.017 Vali Acc: 0.511 Test Loss: 23.017 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.899158000946045
Epoch: 7, Steps: 32 | Train Loss: 1.004 Vali Loss: 20.112 Vali Acc: 0.420 Test Loss: 20.112 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.775215148925781
Epoch: 8, Steps: 32 | Train Loss: 0.533 Vali Loss: 24.421 Vali Acc: 0.466 Test Loss: 24.421 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.018044233322144
Epoch: 9, Steps: 32 | Train Loss: 0.986 Vali Loss: 22.918 Vali Acc: 0.466 Test Loss: 22.918 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.232525825500488
Epoch: 10, Steps: 32 | Train Loss: 0.359 Vali Loss: 30.175 Vali Acc: 0.489 Test Loss: 30.175 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.778162240982056
Epoch: 11, Steps: 32 | Train Loss: 1.803 Vali Loss: 26.654 Vali Acc: 0.443 Test Loss: 26.654 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.898069143295288
Epoch: 12, Steps: 32 | Train Loss: 0.110 Vali Loss: 32.802 Vali Acc: 0.534 Test Loss: 32.802 Test Acc: 0.534
Validation loss decreased (-0.511311 --> -0.534023).  Saving model ...
Epoch: 13 cost time: 10.710195064544678
Epoch: 13, Steps: 32 | Train Loss: 0.432 Vali Loss: 29.540 Vali Acc: 0.481 Test Loss: 29.540 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.061842918395996
Epoch: 14, Steps: 32 | Train Loss: 1.457 Vali Loss: 37.901 Vali Acc: 0.527 Test Loss: 37.901 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.868436574935913
Epoch: 15, Steps: 32 | Train Loss: 0.015 Vali Loss: 38.118 Vali Acc: 0.550 Test Loss: 38.118 Test Acc: 0.550
Validation loss decreased (-0.534023 --> -0.549237).  Saving model ...
Epoch: 16 cost time: 10.712862730026245
Epoch: 16, Steps: 32 | Train Loss: 0.670 Vali Loss: 36.991 Vali Acc: 0.351 Test Loss: 36.991 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.209714889526367
Epoch: 17, Steps: 32 | Train Loss: 1.057 Vali Loss: 45.774 Vali Acc: 0.504 Test Loss: 45.774 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.810045719146729
Epoch: 18, Steps: 32 | Train Loss: 3.034 Vali Loss: 45.194 Vali Acc: 0.305 Test Loss: 45.194 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.01771068572998
Epoch: 19, Steps: 32 | Train Loss: 1.836 Vali Loss: 46.403 Vali Acc: 0.466 Test Loss: 46.403 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.559068202972412
Epoch: 20, Steps: 32 | Train Loss: 0.644 Vali Loss: 42.270 Vali Acc: 0.466 Test Loss: 42.270 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.697914600372314
Epoch: 21, Steps: 32 | Train Loss: 0.034 Vali Loss: 46.630 Vali Acc: 0.550 Test Loss: 46.630 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.964012861251831
Epoch: 22, Steps: 32 | Train Loss: 1.125 Vali Loss: 44.412 Vali Acc: 0.489 Test Loss: 44.412 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.228314876556396
Epoch: 23, Steps: 32 | Train Loss: 3.336 Vali Loss: 54.664 Vali Acc: 0.511 Test Loss: 54.664 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.91084599494934
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.444 Vali Acc: 0.473 Test Loss: 45.444 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.754043579101562
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.016 Vali Acc: 0.473 Test Loss: 45.016 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 7834281
model size : 38.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.342002391815186
Epoch: 1, Steps: 32 | Train Loss: 6.697 Vali Loss: 20.101 Vali Acc: 0.168 Test Loss: 20.101 Test Acc: 0.168
Validation loss decreased (inf --> -0.167738).  Saving model ...
Epoch: 2 cost time: 10.620069026947021
Epoch: 2, Steps: 32 | Train Loss: 11.285 Vali Loss: 15.253 Vali Acc: 0.435 Test Loss: 15.253 Test Acc: 0.435
Validation loss decreased (-0.167738 --> -0.434962).  Saving model ...
Epoch: 3 cost time: 10.577117443084717
Epoch: 3, Steps: 32 | Train Loss: 10.896 Vali Loss: 13.618 Vali Acc: 0.374 Test Loss: 13.618 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.670081853866577
Epoch: 4, Steps: 32 | Train Loss: 3.612 Vali Loss: 17.997 Vali Acc: 0.489 Test Loss: 17.997 Test Acc: 0.489
Validation loss decreased (-0.434962 --> -0.488370).  Saving model ...
Epoch: 5 cost time: 11.028242111206055
Epoch: 5, Steps: 32 | Train Loss: 2.554 Vali Loss: 26.904 Vali Acc: 0.366 Test Loss: 26.904 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.953216075897217
Epoch: 6, Steps: 32 | Train Loss: 1.974 Vali Loss: 24.226 Vali Acc: 0.435 Test Loss: 24.226 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.9310462474823
Epoch: 7, Steps: 32 | Train Loss: 0.976 Vali Loss: 26.901 Vali Acc: 0.321 Test Loss: 26.901 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.679644584655762
Epoch: 8, Steps: 32 | Train Loss: 0.767 Vali Loss: 22.134 Vali Acc: 0.427 Test Loss: 22.134 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.090697765350342
Epoch: 9, Steps: 32 | Train Loss: 0.468 Vali Loss: 23.654 Vali Acc: 0.397 Test Loss: 23.654 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.789644956588745
Epoch: 10, Steps: 32 | Train Loss: 0.428 Vali Loss: 26.549 Vali Acc: 0.504 Test Loss: 26.549 Test Acc: 0.504
Validation loss decreased (-0.488370 --> -0.503551).  Saving model ...
Epoch: 11 cost time: 10.933643579483032
Epoch: 11, Steps: 32 | Train Loss: 0.259 Vali Loss: 29.328 Vali Acc: 0.504 Test Loss: 29.328 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.73132061958313
Epoch: 12, Steps: 32 | Train Loss: 0.874 Vali Loss: 25.055 Vali Acc: 0.427 Test Loss: 25.055 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.734411478042603
Epoch: 13, Steps: 32 | Train Loss: 0.260 Vali Loss: 35.877 Vali Acc: 0.496 Test Loss: 35.877 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.826430320739746
Epoch: 14, Steps: 32 | Train Loss: 2.047 Vali Loss: 30.697 Vali Acc: 0.427 Test Loss: 30.697 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.678417682647705
Epoch: 15, Steps: 32 | Train Loss: 2.492 Vali Loss: 43.146 Vali Acc: 0.405 Test Loss: 43.146 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.847875833511353
Epoch: 16, Steps: 32 | Train Loss: 1.742 Vali Loss: 49.665 Vali Acc: 0.481 Test Loss: 49.665 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.722113609313965
Epoch: 17, Steps: 32 | Train Loss: 0.887 Vali Loss: 38.484 Vali Acc: 0.389 Test Loss: 38.484 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.706656694412231
Epoch: 18, Steps: 32 | Train Loss: 0.953 Vali Loss: 52.727 Vali Acc: 0.420 Test Loss: 52.727 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.004154920578003
Epoch: 19, Steps: 32 | Train Loss: 5.452 Vali Loss: 52.438 Vali Acc: 0.466 Test Loss: 52.438 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.117218732833862
Epoch: 20, Steps: 32 | Train Loss: 1.028 Vali Loss: 47.562 Vali Acc: 0.496 Test Loss: 47.562 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 7546409
model size : 37.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.83603310585022
Epoch: 1, Steps: 32 | Train Loss: 8.659 Vali Loss: 12.093 Vali Acc: 0.420 Test Loss: 12.093 Test Acc: 0.420
Validation loss decreased (inf --> -0.419726).  Saving model ...
Epoch: 2 cost time: 10.596234560012817
Epoch: 2, Steps: 32 | Train Loss: 17.468 Vali Loss: 22.202 Vali Acc: 0.420 Test Loss: 22.202 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.559941530227661
Epoch: 3, Steps: 32 | Train Loss: 10.145 Vali Loss: 12.322 Vali Acc: 0.489 Test Loss: 12.322 Test Acc: 0.489
Validation loss decreased (-0.419726 --> -0.488426).  Saving model ...
Epoch: 4 cost time: 10.795510053634644
Epoch: 4, Steps: 32 | Train Loss: 3.775 Vali Loss: 15.833 Vali Acc: 0.489 Test Loss: 15.833 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.619696378707886
Epoch: 5, Steps: 32 | Train Loss: 2.152 Vali Loss: 19.810 Vali Acc: 0.534 Test Loss: 19.810 Test Acc: 0.534
Validation loss decreased (-0.488426 --> -0.534153).  Saving model ...
Epoch: 6 cost time: 10.678007125854492
Epoch: 6, Steps: 32 | Train Loss: 2.565 Vali Loss: 22.706 Vali Acc: 0.473 Test Loss: 22.706 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.709364652633667
Epoch: 7, Steps: 32 | Train Loss: 2.835 Vali Loss: 23.410 Vali Acc: 0.473 Test Loss: 23.410 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.385624647140503
Epoch: 8, Steps: 32 | Train Loss: 2.051 Vali Loss: 26.568 Vali Acc: 0.359 Test Loss: 26.568 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.649667501449585
Epoch: 9, Steps: 32 | Train Loss: 1.731 Vali Loss: 24.902 Vali Acc: 0.344 Test Loss: 24.902 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.626337766647339
Epoch: 10, Steps: 32 | Train Loss: 0.381 Vali Loss: 24.873 Vali Acc: 0.489 Test Loss: 24.873 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.377021789550781
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 29.489 Vali Acc: 0.473 Test Loss: 29.489 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.569308757781982
Epoch: 12, Steps: 32 | Train Loss: 0.382 Vali Loss: 31.555 Vali Acc: 0.405 Test Loss: 31.555 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.500404834747314
Epoch: 13, Steps: 32 | Train Loss: 0.209 Vali Loss: 32.353 Vali Acc: 0.496 Test Loss: 32.353 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.580665588378906
Epoch: 14, Steps: 32 | Train Loss: 0.263 Vali Loss: 34.365 Vali Acc: 0.458 Test Loss: 34.365 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.574361085891724
Epoch: 15, Steps: 32 | Train Loss: 0.283 Vali Loss: 36.709 Vali Acc: 0.351 Test Loss: 36.709 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 7258537
model size : 36.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.990254640579224
Epoch: 1, Steps: 32 | Train Loss: 7.900 Vali Loss: 11.327 Vali Acc: 0.137 Test Loss: 11.327 Test Acc: 0.137
Validation loss decreased (inf --> -0.137291).  Saving model ...
Epoch: 2 cost time: 10.127069234848022
Epoch: 2, Steps: 32 | Train Loss: 13.525 Vali Loss: 15.123 Vali Acc: 0.458 Test Loss: 15.123 Test Acc: 0.458
Validation loss decreased (-0.137291 --> -0.457864).  Saving model ...
Epoch: 3 cost time: 10.260506629943848
Epoch: 3, Steps: 32 | Train Loss: 10.888 Vali Loss: 10.426 Vali Acc: 0.450 Test Loss: 10.426 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.320972919464111
Epoch: 4, Steps: 32 | Train Loss: 4.743 Vali Loss: 20.512 Vali Acc: 0.389 Test Loss: 20.512 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.187445878982544
Epoch: 5, Steps: 32 | Train Loss: 4.672 Vali Loss: 23.015 Vali Acc: 0.473 Test Loss: 23.015 Test Acc: 0.473
Validation loss decreased (-0.457864 --> -0.473052).  Saving model ...
Epoch: 6 cost time: 10.414592981338501
Epoch: 6, Steps: 32 | Train Loss: 2.277 Vali Loss: 21.524 Vali Acc: 0.427 Test Loss: 21.524 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.186511278152466
Epoch: 7, Steps: 32 | Train Loss: 0.858 Vali Loss: 22.147 Vali Acc: 0.473 Test Loss: 22.147 Test Acc: 0.473
Validation loss decreased (-0.473052 --> -0.473061).  Saving model ...
Epoch: 8 cost time: 10.425371170043945
Epoch: 8, Steps: 32 | Train Loss: 1.032 Vali Loss: 27.682 Vali Acc: 0.504 Test Loss: 27.682 Test Acc: 0.504
Validation loss decreased (-0.473061 --> -0.503540).  Saving model ...
Epoch: 9 cost time: 10.32377314567566
Epoch: 9, Steps: 32 | Train Loss: 2.092 Vali Loss: 25.587 Vali Acc: 0.519 Test Loss: 25.587 Test Acc: 0.519
Validation loss decreased (-0.503540 --> -0.518828).  Saving model ...
Epoch: 10 cost time: 10.036087989807129
Epoch: 10, Steps: 32 | Train Loss: 0.585 Vali Loss: 29.226 Vali Acc: 0.511 Test Loss: 29.226 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.339869499206543
Epoch: 11, Steps: 32 | Train Loss: 0.345 Vali Loss: 34.504 Vali Acc: 0.458 Test Loss: 34.504 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.185742378234863
Epoch: 12, Steps: 32 | Train Loss: 0.223 Vali Loss: 36.642 Vali Acc: 0.519 Test Loss: 36.642 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.503671884536743
Epoch: 13, Steps: 32 | Train Loss: 0.107 Vali Loss: 40.601 Vali Acc: 0.466 Test Loss: 40.601 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.516148090362549
Epoch: 14, Steps: 32 | Train Loss: 0.044 Vali Loss: 39.001 Vali Acc: 0.420 Test Loss: 39.001 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.297075748443604
Epoch: 15, Steps: 32 | Train Loss: 0.635 Vali Loss: 50.708 Vali Acc: 0.427 Test Loss: 50.708 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.600770235061646
Epoch: 16, Steps: 32 | Train Loss: 0.203 Vali Loss: 42.129 Vali Acc: 0.466 Test Loss: 42.129 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.321886777877808
Epoch: 17, Steps: 32 | Train Loss: 0.550 Vali Loss: 42.867 Vali Acc: 0.427 Test Loss: 42.867 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.249731063842773
Epoch: 18, Steps: 32 | Train Loss: 1.115 Vali Loss: 48.984 Vali Acc: 0.504 Test Loss: 48.984 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.325233936309814
Epoch: 19, Steps: 32 | Train Loss: 1.173 Vali Loss: 52.839 Vali Acc: 0.351 Test Loss: 52.839 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6970665
model size : 35.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.037454605102539
Epoch: 1, Steps: 32 | Train Loss: 10.967 Vali Loss: 13.645 Vali Acc: 0.427 Test Loss: 13.645 Test Acc: 0.427
Validation loss decreased (inf --> -0.427344).  Saving model ...
Epoch: 2 cost time: 10.552329540252686
Epoch: 2, Steps: 32 | Train Loss: 29.036 Vali Loss: 28.789 Vali Acc: 0.435 Test Loss: 28.789 Test Acc: 0.435
Validation loss decreased (-0.427344 --> -0.434827).  Saving model ...
Epoch: 3 cost time: 10.570537805557251
Epoch: 3, Steps: 32 | Train Loss: 14.073 Vali Loss: 12.542 Vali Acc: 0.519 Test Loss: 12.542 Test Acc: 0.519
Validation loss decreased (-0.434827 --> -0.518959).  Saving model ...
Epoch: 4 cost time: 10.416670083999634
Epoch: 4, Steps: 32 | Train Loss: 6.224 Vali Loss: 20.857 Vali Acc: 0.405 Test Loss: 20.857 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.395395040512085
Epoch: 5, Steps: 32 | Train Loss: 4.849 Vali Loss: 29.308 Vali Acc: 0.336 Test Loss: 29.308 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.555846452713013
Epoch: 6, Steps: 32 | Train Loss: 3.087 Vali Loss: 21.064 Vali Acc: 0.473 Test Loss: 21.064 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.571595907211304
Epoch: 7, Steps: 32 | Train Loss: 1.370 Vali Loss: 21.861 Vali Acc: 0.466 Test Loss: 21.861 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.638285160064697
Epoch: 8, Steps: 32 | Train Loss: 0.188 Vali Loss: 25.554 Vali Acc: 0.412 Test Loss: 25.554 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.478115558624268
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.848 Vali Acc: 0.458 Test Loss: 28.848 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.464192152023315
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.528 Vali Acc: 0.511 Test Loss: 24.528 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.431665897369385
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.089 Vali Acc: 0.473 Test Loss: 24.089 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.481992244720459
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.907 Vali Acc: 0.458 Test Loss: 23.907 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.598613023757935
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.901 Vali Acc: 0.458 Test Loss: 23.901 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 7176361
model size : 36.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.791130065917969
Epoch: 1, Steps: 32 | Train Loss: 10.676 Vali Loss: 12.268 Vali Acc: 0.420 Test Loss: 12.268 Test Acc: 0.420
Validation loss decreased (inf --> -0.419725).  Saving model ...
Epoch: 2 cost time: 10.401286363601685
Epoch: 2, Steps: 32 | Train Loss: 18.179 Vali Loss: 18.963 Vali Acc: 0.145 Test Loss: 18.963 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.389477729797363
Epoch: 3, Steps: 32 | Train Loss: 13.096 Vali Loss: 21.963 Vali Acc: 0.473 Test Loss: 21.963 Test Acc: 0.473
Validation loss decreased (-0.419725 --> -0.473063).  Saving model ...
Epoch: 4 cost time: 10.637097597122192
Epoch: 4, Steps: 32 | Train Loss: 7.250 Vali Loss: 16.433 Vali Acc: 0.389 Test Loss: 16.433 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.495256185531616
Epoch: 5, Steps: 32 | Train Loss: 3.636 Vali Loss: 31.764 Vali Acc: 0.328 Test Loss: 31.764 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.556702613830566
Epoch: 6, Steps: 32 | Train Loss: 1.971 Vali Loss: 23.825 Vali Acc: 0.405 Test Loss: 23.825 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.4244065284729
Epoch: 7, Steps: 32 | Train Loss: 2.093 Vali Loss: 28.794 Vali Acc: 0.435 Test Loss: 28.794 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.344140529632568
Epoch: 8, Steps: 32 | Train Loss: 0.539 Vali Loss: 37.607 Vali Acc: 0.351 Test Loss: 37.607 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.488131523132324
Epoch: 9, Steps: 32 | Train Loss: 1.153 Vali Loss: 36.318 Vali Acc: 0.511 Test Loss: 36.318 Test Acc: 0.511
Validation loss decreased (-0.473063 --> -0.511087).  Saving model ...
Epoch: 10 cost time: 10.42286229133606
Epoch: 10, Steps: 32 | Train Loss: 0.716 Vali Loss: 33.427 Vali Acc: 0.511 Test Loss: 33.427 Test Acc: 0.511
Validation loss decreased (-0.511087 --> -0.511116).  Saving model ...
Epoch: 11 cost time: 10.57497787475586
Epoch: 11, Steps: 32 | Train Loss: 3.433 Vali Loss: 41.903 Vali Acc: 0.382 Test Loss: 41.903 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.507372379302979
Epoch: 12, Steps: 32 | Train Loss: 1.241 Vali Loss: 39.289 Vali Acc: 0.412 Test Loss: 39.289 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.695568323135376
Epoch: 13, Steps: 32 | Train Loss: 0.233 Vali Loss: 41.482 Vali Acc: 0.336 Test Loss: 41.482 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.441050291061401
Epoch: 14, Steps: 32 | Train Loss: 1.149 Vali Loss: 45.125 Vali Acc: 0.427 Test Loss: 45.125 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.626227855682373
Epoch: 15, Steps: 32 | Train Loss: 0.799 Vali Loss: 46.417 Vali Acc: 0.458 Test Loss: 46.417 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.377737998962402
Epoch: 16, Steps: 32 | Train Loss: 0.261 Vali Loss: 49.826 Vali Acc: 0.466 Test Loss: 49.826 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.535984754562378
Epoch: 17, Steps: 32 | Train Loss: 1.303 Vali Loss: 47.816 Vali Acc: 0.397 Test Loss: 47.816 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.502203464508057
Epoch: 18, Steps: 32 | Train Loss: 1.719 Vali Loss: 41.497 Vali Acc: 0.344 Test Loss: 41.497 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.444406270980835
Epoch: 19, Steps: 32 | Train Loss: 0.917 Vali Loss: 49.354 Vali Acc: 0.389 Test Loss: 49.354 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.447121620178223
Epoch: 20, Steps: 32 | Train Loss: 0.735 Vali Loss: 43.657 Vali Acc: 0.443 Test Loss: 43.657 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 6888489
model size : 35.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.064672470092773
Epoch: 1, Steps: 32 | Train Loss: 9.624 Vali Loss: 16.971 Vali Acc: 0.420 Test Loss: 16.971 Test Acc: 0.420
Validation loss decreased (inf --> -0.419678).  Saving model ...
Epoch: 2 cost time: 10.340255975723267
Epoch: 2, Steps: 32 | Train Loss: 15.713 Vali Loss: 6.420 Vali Acc: 0.496 Test Loss: 6.420 Test Acc: 0.496
Validation loss decreased (-0.419678 --> -0.496119).  Saving model ...
Epoch: 3 cost time: 10.40247368812561
Epoch: 3, Steps: 32 | Train Loss: 6.526 Vali Loss: 19.940 Vali Acc: 0.489 Test Loss: 19.940 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.343261480331421
Epoch: 4, Steps: 32 | Train Loss: 5.399 Vali Loss: 20.242 Vali Acc: 0.313 Test Loss: 20.242 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.798412084579468
Epoch: 5, Steps: 32 | Train Loss: 3.500 Vali Loss: 19.905 Vali Acc: 0.527 Test Loss: 19.905 Test Acc: 0.527
Validation loss decreased (-0.496119 --> -0.526519).  Saving model ...
Epoch: 6 cost time: 10.719367742538452
Epoch: 6, Steps: 32 | Train Loss: 2.182 Vali Loss: 21.711 Vali Acc: 0.366 Test Loss: 21.711 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.410028219223022
Epoch: 7, Steps: 32 | Train Loss: 0.250 Vali Loss: 28.787 Vali Acc: 0.366 Test Loss: 28.787 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.44745922088623
Epoch: 8, Steps: 32 | Train Loss: 0.894 Vali Loss: 21.313 Vali Acc: 0.473 Test Loss: 21.313 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.926798582077026
Epoch: 9, Steps: 32 | Train Loss: 1.664 Vali Loss: 26.178 Vali Acc: 0.496 Test Loss: 26.178 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.603093385696411
Epoch: 10, Steps: 32 | Train Loss: 1.383 Vali Loss: 29.765 Vali Acc: 0.519 Test Loss: 29.765 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.728447198867798
Epoch: 11, Steps: 32 | Train Loss: 1.195 Vali Loss: 32.501 Vali Acc: 0.473 Test Loss: 32.501 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.654146671295166
Epoch: 12, Steps: 32 | Train Loss: 4.098 Vali Loss: 36.554 Vali Acc: 0.427 Test Loss: 36.554 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.29823350906372
Epoch: 13, Steps: 32 | Train Loss: 3.500 Vali Loss: 37.480 Vali Acc: 0.389 Test Loss: 37.480 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.515074253082275
Epoch: 14, Steps: 32 | Train Loss: 0.508 Vali Loss: 43.587 Vali Acc: 0.504 Test Loss: 43.587 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.412737131118774
Epoch: 15, Steps: 32 | Train Loss: 0.706 Vali Loss: 40.739 Vali Acc: 0.420 Test Loss: 40.739 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 6600617
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.723528146743774
Epoch: 1, Steps: 32 | Train Loss: 9.464 Vali Loss: 11.935 Vali Acc: 0.168 Test Loss: 11.935 Test Acc: 0.168
Validation loss decreased (inf --> -0.167820).  Saving model ...
Epoch: 2 cost time: 10.093384504318237
Epoch: 2, Steps: 32 | Train Loss: 24.431 Vali Loss: 18.071 Vali Acc: 0.427 Test Loss: 18.071 Test Acc: 0.427
Validation loss decreased (-0.167820 --> -0.427300).  Saving model ...
Epoch: 3 cost time: 10.303418397903442
Epoch: 3, Steps: 32 | Train Loss: 13.478 Vali Loss: 11.666 Vali Acc: 0.489 Test Loss: 11.666 Test Acc: 0.489
Validation loss decreased (-0.427300 --> -0.488433).  Saving model ...
Epoch: 4 cost time: 10.19603419303894
Epoch: 4, Steps: 32 | Train Loss: 5.293 Vali Loss: 29.769 Vali Acc: 0.504 Test Loss: 29.769 Test Acc: 0.504
Validation loss decreased (-0.488433 --> -0.503519).  Saving model ...
Epoch: 5 cost time: 10.321393966674805
Epoch: 5, Steps: 32 | Train Loss: 3.576 Vali Loss: 20.401 Vali Acc: 0.427 Test Loss: 20.401 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.112538576126099
Epoch: 6, Steps: 32 | Train Loss: 2.974 Vali Loss: 25.334 Vali Acc: 0.435 Test Loss: 25.334 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.002481698989868
Epoch: 7, Steps: 32 | Train Loss: 1.319 Vali Loss: 25.875 Vali Acc: 0.405 Test Loss: 25.875 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.121220111846924
Epoch: 8, Steps: 32 | Train Loss: 0.169 Vali Loss: 24.011 Vali Acc: 0.412 Test Loss: 24.011 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.221655368804932
Epoch: 9, Steps: 32 | Train Loss: 0.665 Vali Loss: 30.617 Vali Acc: 0.427 Test Loss: 30.617 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.114355087280273
Epoch: 10, Steps: 32 | Train Loss: 1.097 Vali Loss: 31.997 Vali Acc: 0.466 Test Loss: 31.997 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.436840057373047
Epoch: 11, Steps: 32 | Train Loss: 0.310 Vali Loss: 30.181 Vali Acc: 0.427 Test Loss: 30.181 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.055198192596436
Epoch: 12, Steps: 32 | Train Loss: 0.236 Vali Loss: 32.150 Vali Acc: 0.458 Test Loss: 32.150 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.158016204833984
Epoch: 13, Steps: 32 | Train Loss: 0.243 Vali Loss: 39.874 Vali Acc: 0.412 Test Loss: 39.874 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.309909343719482
Epoch: 14, Steps: 32 | Train Loss: 0.888 Vali Loss: 32.466 Vali Acc: 0.382 Test Loss: 32.466 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6312745
model size : 32.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.934546709060669
Epoch: 1, Steps: 32 | Train Loss: 8.828 Vali Loss: 25.667 Vali Acc: 0.137 Test Loss: 25.667 Test Acc: 0.137
Validation loss decreased (inf --> -0.137148).  Saving model ...
Epoch: 2 cost time: 10.6140775680542
Epoch: 2, Steps: 32 | Train Loss: 16.699 Vali Loss: 22.565 Vali Acc: 0.237 Test Loss: 22.565 Test Acc: 0.237
Validation loss decreased (-0.137148 --> -0.236416).  Saving model ...
Epoch: 3 cost time: 10.22067928314209
Epoch: 3, Steps: 32 | Train Loss: 13.648 Vali Loss: 14.059 Vali Acc: 0.389 Test Loss: 14.059 Test Acc: 0.389
Validation loss decreased (-0.236416 --> -0.389172).  Saving model ...
Epoch: 4 cost time: 10.591449975967407
Epoch: 4, Steps: 32 | Train Loss: 6.950 Vali Loss: 30.018 Vali Acc: 0.389 Test Loss: 30.018 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.810802936553955
Epoch: 5, Steps: 32 | Train Loss: 5.036 Vali Loss: 21.253 Vali Acc: 0.511 Test Loss: 21.253 Test Acc: 0.511
Validation loss decreased (-0.389172 --> -0.511238).  Saving model ...
Epoch: 6 cost time: 10.62644338607788
Epoch: 6, Steps: 32 | Train Loss: 1.687 Vali Loss: 29.136 Vali Acc: 0.344 Test Loss: 29.136 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.53421664237976
Epoch: 7, Steps: 32 | Train Loss: 3.218 Vali Loss: 28.959 Vali Acc: 0.382 Test Loss: 28.959 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.529420375823975
Epoch: 8, Steps: 32 | Train Loss: 1.376 Vali Loss: 37.324 Vali Acc: 0.473 Test Loss: 37.324 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.664957284927368
Epoch: 9, Steps: 32 | Train Loss: 0.697 Vali Loss: 28.075 Vali Acc: 0.458 Test Loss: 28.075 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.442036390304565
Epoch: 10, Steps: 32 | Train Loss: 0.075 Vali Loss: 27.965 Vali Acc: 0.420 Test Loss: 27.965 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.675623416900635
Epoch: 11, Steps: 32 | Train Loss: 0.018 Vali Loss: 35.508 Vali Acc: 0.504 Test Loss: 35.508 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.552241802215576
Epoch: 12, Steps: 32 | Train Loss: 0.288 Vali Loss: 40.315 Vali Acc: 0.481 Test Loss: 40.315 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.479305744171143
Epoch: 13, Steps: 32 | Train Loss: 1.393 Vali Loss: 44.767 Vali Acc: 0.336 Test Loss: 44.767 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.501493215560913
Epoch: 14, Steps: 32 | Train Loss: 1.582 Vali Loss: 50.657 Vali Acc: 0.519 Test Loss: 50.657 Test Acc: 0.519
Validation loss decreased (-0.511238 --> -0.518577).  Saving model ...
Epoch: 15 cost time: 10.539939403533936
Epoch: 15, Steps: 32 | Train Loss: 3.765 Vali Loss: 46.858 Vali Acc: 0.489 Test Loss: 46.858 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.688382625579834
Epoch: 16, Steps: 32 | Train Loss: 2.242 Vali Loss: 49.244 Vali Acc: 0.466 Test Loss: 49.244 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.482166290283203
Epoch: 17, Steps: 32 | Train Loss: 0.932 Vali Loss: 58.395 Vali Acc: 0.336 Test Loss: 58.395 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.425402402877808
Epoch: 18, Steps: 32 | Train Loss: 13.061 Vali Loss: 56.838 Vali Acc: 0.481 Test Loss: 56.838 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.358683347702026
Epoch: 19, Steps: 32 | Train Loss: 2.470 Vali Loss: 56.176 Vali Acc: 0.427 Test Loss: 56.176 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.519001483917236
Epoch: 20, Steps: 32 | Train Loss: 1.073 Vali Loss: 67.395 Vali Acc: 0.267 Test Loss: 67.395 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.507072925567627
Epoch: 21, Steps: 32 | Train Loss: 2.802 Vali Loss: 71.865 Vali Acc: 0.252 Test Loss: 71.865 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.458157777786255
Epoch: 22, Steps: 32 | Train Loss: 14.607 Vali Loss: 68.563 Vali Acc: 0.244 Test Loss: 68.563 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.288837671279907
Epoch: 23, Steps: 32 | Train Loss: 14.492 Vali Loss: 64.915 Vali Acc: 0.290 Test Loss: 64.915 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.39328932762146
Epoch: 24, Steps: 32 | Train Loss: 0.601 Vali Loss: 62.457 Vali Acc: 0.405 Test Loss: 62.457 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6847401
model size : 35.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.968567848205566
Epoch: 1, Steps: 32 | Train Loss: 15.032 Vali Loss: 26.143 Vali Acc: 0.176 Test Loss: 26.143 Test Acc: 0.176
Validation loss decreased (inf --> -0.175311).  Saving model ...
Epoch: 2 cost time: 10.183178186416626
Epoch: 2, Steps: 32 | Train Loss: 13.202 Vali Loss: 6.562 Vali Acc: 0.267 Test Loss: 6.562 Test Acc: 0.267
Validation loss decreased (-0.175311 --> -0.267110).  Saving model ...
Epoch: 3 cost time: 10.2522132396698
Epoch: 3, Steps: 32 | Train Loss: 18.276 Vali Loss: 13.861 Vali Acc: 0.336 Test Loss: 13.861 Test Acc: 0.336
Validation loss decreased (-0.267110 --> -0.335739).  Saving model ...
Epoch: 4 cost time: 10.616121768951416
Epoch: 4, Steps: 32 | Train Loss: 5.099 Vali Loss: 25.531 Vali Acc: 0.489 Test Loss: 25.531 Test Acc: 0.489
Validation loss decreased (-0.335739 --> -0.488294).  Saving model ...
Epoch: 5 cost time: 10.355366945266724
Epoch: 5, Steps: 32 | Train Loss: 6.412 Vali Loss: 21.902 Vali Acc: 0.504 Test Loss: 21.902 Test Acc: 0.504
Validation loss decreased (-0.488294 --> -0.503598).  Saving model ...
Epoch: 6 cost time: 10.282102823257446
Epoch: 6, Steps: 32 | Train Loss: 2.993 Vali Loss: 27.276 Vali Acc: 0.466 Test Loss: 27.276 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.599132061004639
Epoch: 7, Steps: 32 | Train Loss: 0.628 Vali Loss: 29.951 Vali Acc: 0.511 Test Loss: 29.951 Test Acc: 0.511
Validation loss decreased (-0.503598 --> -0.511151).  Saving model ...
Epoch: 8 cost time: 10.303304672241211
Epoch: 8, Steps: 32 | Train Loss: 1.194 Vali Loss: 27.286 Vali Acc: 0.466 Test Loss: 27.286 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.544204950332642
Epoch: 9, Steps: 32 | Train Loss: 0.785 Vali Loss: 25.347 Vali Acc: 0.504 Test Loss: 25.347 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.495185852050781
Epoch: 10, Steps: 32 | Train Loss: 0.005 Vali Loss: 31.373 Vali Acc: 0.557 Test Loss: 31.373 Test Acc: 0.557
Validation loss decreased (-0.511151 --> -0.556938).  Saving model ...
Epoch: 11 cost time: 10.514597415924072
Epoch: 11, Steps: 32 | Train Loss: 0.301 Vali Loss: 36.030 Vali Acc: 0.397 Test Loss: 36.030 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.480242729187012
Epoch: 12, Steps: 32 | Train Loss: 0.434 Vali Loss: 33.164 Vali Acc: 0.382 Test Loss: 33.164 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.179526329040527
Epoch: 13, Steps: 32 | Train Loss: 0.928 Vali Loss: 39.062 Vali Acc: 0.534 Test Loss: 39.062 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.192873477935791
Epoch: 14, Steps: 32 | Train Loss: 0.498 Vali Loss: 34.430 Vali Acc: 0.336 Test Loss: 34.430 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.396272420883179
Epoch: 15, Steps: 32 | Train Loss: 0.398 Vali Loss: 39.782 Vali Acc: 0.405 Test Loss: 39.782 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.346943616867065
Epoch: 16, Steps: 32 | Train Loss: 1.581 Vali Loss: 51.850 Vali Acc: 0.481 Test Loss: 51.850 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.213661432266235
Epoch: 17, Steps: 32 | Train Loss: 2.035 Vali Loss: 43.326 Vali Acc: 0.458 Test Loss: 43.326 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.491605520248413
Epoch: 18, Steps: 32 | Train Loss: 0.627 Vali Loss: 50.830 Vali Acc: 0.382 Test Loss: 50.830 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.30128788948059
Epoch: 19, Steps: 32 | Train Loss: 0.145 Vali Loss: 46.052 Vali Acc: 0.427 Test Loss: 46.052 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.580839395523071
Epoch: 20, Steps: 32 | Train Loss: 0.808 Vali Loss: 44.938 Vali Acc: 0.405 Test Loss: 44.938 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6559529
model size : 33.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.440442562103271
Epoch: 1, Steps: 32 | Train Loss: 7.378 Vali Loss: 20.738 Vali Acc: 0.176 Test Loss: 20.738 Test Acc: 0.176
Validation loss decreased (inf --> -0.175365).  Saving model ...
Epoch: 2 cost time: 10.008041143417358
Epoch: 2, Steps: 32 | Train Loss: 13.884 Vali Loss: 13.094 Vali Acc: 0.153 Test Loss: 13.094 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.034786224365234
Epoch: 3, Steps: 32 | Train Loss: 14.124 Vali Loss: 11.122 Vali Acc: 0.443 Test Loss: 11.122 Test Acc: 0.443
Validation loss decreased (-0.175365 --> -0.442637).  Saving model ...
Epoch: 4 cost time: 10.054888010025024
Epoch: 4, Steps: 32 | Train Loss: 8.013 Vali Loss: 15.527 Vali Acc: 0.504 Test Loss: 15.527 Test Acc: 0.504
Validation loss decreased (-0.442637 --> -0.503662).  Saving model ...
Epoch: 5 cost time: 10.023629665374756
Epoch: 5, Steps: 32 | Train Loss: 3.948 Vali Loss: 22.354 Vali Acc: 0.496 Test Loss: 22.354 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.024960994720459
Epoch: 6, Steps: 32 | Train Loss: 3.719 Vali Loss: 30.618 Vali Acc: 0.450 Test Loss: 30.618 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.048102617263794
Epoch: 7, Steps: 32 | Train Loss: 1.149 Vali Loss: 25.184 Vali Acc: 0.527 Test Loss: 25.184 Test Acc: 0.527
Validation loss decreased (-0.503662 --> -0.526466).  Saving model ...
Epoch: 8 cost time: 10.1916344165802
Epoch: 8, Steps: 32 | Train Loss: 1.445 Vali Loss: 30.116 Vali Acc: 0.427 Test Loss: 30.116 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.20425820350647
Epoch: 9, Steps: 32 | Train Loss: 1.041 Vali Loss: 33.761 Vali Acc: 0.443 Test Loss: 33.761 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.073183298110962
Epoch: 10, Steps: 32 | Train Loss: 0.121 Vali Loss: 31.366 Vali Acc: 0.351 Test Loss: 31.366 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.073380947113037
Epoch: 11, Steps: 32 | Train Loss: 1.110 Vali Loss: 26.607 Vali Acc: 0.450 Test Loss: 26.607 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.305001974105835
Epoch: 12, Steps: 32 | Train Loss: 0.810 Vali Loss: 35.796 Vali Acc: 0.382 Test Loss: 35.796 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.434654712677002
Epoch: 13, Steps: 32 | Train Loss: 0.022 Vali Loss: 32.606 Vali Acc: 0.427 Test Loss: 32.606 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.436876058578491
Epoch: 14, Steps: 32 | Train Loss: 0.550 Vali Loss: 41.832 Vali Acc: 0.534 Test Loss: 41.832 Test Acc: 0.534
Validation loss decreased (-0.526466 --> -0.533933).  Saving model ...
Epoch: 15 cost time: 10.36722469329834
Epoch: 15, Steps: 32 | Train Loss: 0.850 Vali Loss: 40.316 Vali Acc: 0.473 Test Loss: 40.316 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.358271598815918
Epoch: 16, Steps: 32 | Train Loss: 0.774 Vali Loss: 46.002 Vali Acc: 0.450 Test Loss: 46.002 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.399925708770752
Epoch: 17, Steps: 32 | Train Loss: 0.348 Vali Loss: 37.697 Vali Acc: 0.427 Test Loss: 37.697 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.409569025039673
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.484 Vali Acc: 0.420 Test Loss: 38.484 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.376221179962158
Epoch: 19, Steps: 32 | Train Loss: 0.215 Vali Loss: 40.936 Vali Acc: 0.412 Test Loss: 40.936 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.27087926864624
Epoch: 20, Steps: 32 | Train Loss: 1.540 Vali Loss: 41.248 Vali Acc: 0.473 Test Loss: 41.248 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.439106941223145
Epoch: 21, Steps: 32 | Train Loss: 0.189 Vali Loss: 41.617 Vali Acc: 0.397 Test Loss: 41.617 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.34628677368164
Epoch: 22, Steps: 32 | Train Loss: 0.198 Vali Loss: 52.003 Vali Acc: 0.489 Test Loss: 52.003 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.394546747207642
Epoch: 23, Steps: 32 | Train Loss: 3.484 Vali Loss: 43.252 Vali Acc: 0.366 Test Loss: 43.252 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.130518436431885
Epoch: 24, Steps: 32 | Train Loss: 0.388 Vali Loss: 62.661 Vali Acc: 0.321 Test Loss: 62.661 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6271657
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.514717102050781
Epoch: 1, Steps: 32 | Train Loss: 11.614 Vali Loss: 16.812 Vali Acc: 0.099 Test Loss: 16.812 Test Acc: 0.099
Validation loss decreased (inf --> -0.099069).  Saving model ...
Epoch: 2 cost time: 9.894070863723755
Epoch: 2, Steps: 32 | Train Loss: 19.588 Vali Loss: 31.180 Vali Acc: 0.137 Test Loss: 31.180 Test Acc: 0.137
Validation loss decreased (-0.099069 --> -0.137093).  Saving model ...
Epoch: 3 cost time: 9.906455039978027
Epoch: 3, Steps: 32 | Train Loss: 20.338 Vali Loss: 20.628 Vali Acc: 0.420 Test Loss: 20.628 Test Acc: 0.420
Validation loss decreased (-0.137093 --> -0.419641).  Saving model ...
Epoch: 4 cost time: 10.17096757888794
Epoch: 4, Steps: 32 | Train Loss: 5.767 Vali Loss: 24.891 Vali Acc: 0.504 Test Loss: 24.891 Test Acc: 0.504
Validation loss decreased (-0.419641 --> -0.503568).  Saving model ...
Epoch: 5 cost time: 10.017143726348877
Epoch: 5, Steps: 32 | Train Loss: 2.058 Vali Loss: 25.244 Vali Acc: 0.420 Test Loss: 25.244 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.770729780197144
Epoch: 6, Steps: 32 | Train Loss: 4.089 Vali Loss: 30.069 Vali Acc: 0.336 Test Loss: 30.069 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.152005434036255
Epoch: 7, Steps: 32 | Train Loss: 2.258 Vali Loss: 33.852 Vali Acc: 0.420 Test Loss: 33.852 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.006628274917603
Epoch: 8, Steps: 32 | Train Loss: 0.834 Vali Loss: 29.352 Vali Acc: 0.443 Test Loss: 29.352 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.98643183708191
Epoch: 9, Steps: 32 | Train Loss: 1.336 Vali Loss: 34.412 Vali Acc: 0.427 Test Loss: 34.412 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.087162017822266
Epoch: 10, Steps: 32 | Train Loss: 0.444 Vali Loss: 31.926 Vali Acc: 0.458 Test Loss: 31.926 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.806094646453857
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.253 Vali Acc: 0.504 Test Loss: 38.253 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.868489265441895
Epoch: 12, Steps: 32 | Train Loss: 0.108 Vali Loss: 34.838 Vali Acc: 0.504 Test Loss: 34.838 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.181540250778198
Epoch: 13, Steps: 32 | Train Loss: 0.007 Vali Loss: 36.164 Vali Acc: 0.511 Test Loss: 36.164 Test Acc: 0.511
Validation loss decreased (-0.503568 --> -0.511089).  Saving model ...
Epoch: 14 cost time: 10.029833316802979
Epoch: 14, Steps: 32 | Train Loss: 0.195 Vali Loss: 41.071 Vali Acc: 0.481 Test Loss: 41.071 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.948517084121704
Epoch: 15, Steps: 32 | Train Loss: 0.188 Vali Loss: 46.390 Vali Acc: 0.511 Test Loss: 46.390 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.900335311889648
Epoch: 16, Steps: 32 | Train Loss: 0.712 Vali Loss: 43.460 Vali Acc: 0.489 Test Loss: 43.460 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.975799798965454
Epoch: 17, Steps: 32 | Train Loss: 1.746 Vali Loss: 46.587 Vali Acc: 0.321 Test Loss: 46.587 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.011414766311646
Epoch: 18, Steps: 32 | Train Loss: 0.876 Vali Loss: 42.992 Vali Acc: 0.405 Test Loss: 42.992 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.01893424987793
Epoch: 19, Steps: 32 | Train Loss: 1.148 Vali Loss: 46.119 Vali Acc: 0.351 Test Loss: 46.119 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.860920429229736
Epoch: 20, Steps: 32 | Train Loss: 5.761 Vali Loss: 67.407 Vali Acc: 0.328 Test Loss: 67.407 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.94130802154541
Epoch: 21, Steps: 32 | Train Loss: 2.488 Vali Loss: 65.450 Vali Acc: 0.359 Test Loss: 65.450 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.098522901535034
Epoch: 22, Steps: 32 | Train Loss: 13.911 Vali Loss: 57.003 Vali Acc: 0.374 Test Loss: 57.003 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.003453731536865
Epoch: 23, Steps: 32 | Train Loss: 52.058 Vali Loss: 113.755 Vali Acc: 0.267 Test Loss: 113.755 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 5983785
model size : 31.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.634850025177002
Epoch: 1, Steps: 32 | Train Loss: 7.977 Vali Loss: 11.577 Vali Acc: 0.420 Test Loss: 11.577 Test Acc: 0.420
Validation loss decreased (inf --> -0.419732).  Saving model ...
Epoch: 2 cost time: 10.45978832244873
Epoch: 2, Steps: 32 | Train Loss: 16.532 Vali Loss: 21.766 Vali Acc: 0.206 Test Loss: 21.766 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.352137327194214
Epoch: 3, Steps: 32 | Train Loss: 15.601 Vali Loss: 12.599 Vali Acc: 0.260 Test Loss: 12.599 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.29622507095337
Epoch: 4, Steps: 32 | Train Loss: 5.057 Vali Loss: 19.826 Vali Acc: 0.336 Test Loss: 19.826 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.292743921279907
Epoch: 5, Steps: 32 | Train Loss: 5.034 Vali Loss: 26.294 Vali Acc: 0.519 Test Loss: 26.294 Test Acc: 0.519
Validation loss decreased (-0.419732 --> -0.518821).  Saving model ...
Epoch: 6 cost time: 10.557738780975342
Epoch: 6, Steps: 32 | Train Loss: 3.158 Vali Loss: 20.892 Vali Acc: 0.489 Test Loss: 20.892 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.421110153198242
Epoch: 7, Steps: 32 | Train Loss: 2.080 Vali Loss: 22.450 Vali Acc: 0.382 Test Loss: 22.450 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.328041553497314
Epoch: 8, Steps: 32 | Train Loss: 1.323 Vali Loss: 24.267 Vali Acc: 0.458 Test Loss: 24.267 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.205539464950562
Epoch: 9, Steps: 32 | Train Loss: 0.318 Vali Loss: 33.978 Vali Acc: 0.534 Test Loss: 33.978 Test Acc: 0.534
Validation loss decreased (-0.518821 --> -0.534011).  Saving model ...
Epoch: 10 cost time: 10.355968952178955
Epoch: 10, Steps: 32 | Train Loss: 0.046 Vali Loss: 40.274 Vali Acc: 0.443 Test Loss: 40.274 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.163926362991333
Epoch: 11, Steps: 32 | Train Loss: 1.126 Vali Loss: 28.413 Vali Acc: 0.336 Test Loss: 28.413 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.605839967727661
Epoch: 12, Steps: 32 | Train Loss: 0.248 Vali Loss: 30.804 Vali Acc: 0.389 Test Loss: 30.804 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.46223497390747
Epoch: 13, Steps: 32 | Train Loss: 1.374 Vali Loss: 38.544 Vali Acc: 0.534 Test Loss: 38.544 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.501155138015747
Epoch: 14, Steps: 32 | Train Loss: 1.218 Vali Loss: 29.988 Vali Acc: 0.473 Test Loss: 29.988 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.373793125152588
Epoch: 15, Steps: 32 | Train Loss: 10.202 Vali Loss: 41.866 Vali Acc: 0.466 Test Loss: 41.866 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.355773687362671
Epoch: 16, Steps: 32 | Train Loss: 1.461 Vali Loss: 48.301 Vali Acc: 0.374 Test Loss: 48.301 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.340564489364624
Epoch: 17, Steps: 32 | Train Loss: 1.230 Vali Loss: 42.736 Vali Acc: 0.534 Test Loss: 42.736 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.394739389419556
Epoch: 18, Steps: 32 | Train Loss: 0.665 Vali Loss: 42.587 Vali Acc: 0.435 Test Loss: 42.587 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.338204622268677
Epoch: 19, Steps: 32 | Train Loss: 0.292 Vali Loss: 45.322 Vali Acc: 0.542 Test Loss: 45.322 Test Acc: 0.542
Validation loss decreased (-0.534011 --> -0.541532).  Saving model ...
Epoch: 20 cost time: 10.296241521835327
Epoch: 20, Steps: 32 | Train Loss: 0.957 Vali Loss: 46.312 Vali Acc: 0.412 Test Loss: 46.312 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.259082794189453
Epoch: 21, Steps: 32 | Train Loss: 2.726 Vali Loss: 45.809 Vali Acc: 0.458 Test Loss: 45.809 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.526304483413696
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.823 Vali Acc: 0.450 Test Loss: 42.823 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.336731672286987
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.960 Vali Acc: 0.450 Test Loss: 42.960 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.2171311378479
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.270580053329468
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.44682502746582
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.370535612106323
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.361639976501465
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 10.44024109840393
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 42.954 Vali Acc: 0.450 Test Loss: 42.954 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6682921
model size : 34.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.578508138656616
Epoch: 1, Steps: 32 | Train Loss: 8.562 Vali Loss: 18.502 Vali Acc: 0.176 Test Loss: 18.502 Test Acc: 0.176
Validation loss decreased (inf --> -0.175387).  Saving model ...
Epoch: 2 cost time: 10.36414647102356
Epoch: 2, Steps: 32 | Train Loss: 13.286 Vali Loss: 18.881 Vali Acc: 0.260 Test Loss: 18.881 Test Acc: 0.260
Validation loss decreased (-0.175387 --> -0.259353).  Saving model ...
Epoch: 3 cost time: 10.26882529258728
Epoch: 3, Steps: 32 | Train Loss: 19.319 Vali Loss: 22.638 Vali Acc: 0.244 Test Loss: 22.638 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.943459510803223
Epoch: 4, Steps: 32 | Train Loss: 5.059 Vali Loss: 23.171 Vali Acc: 0.473 Test Loss: 23.171 Test Acc: 0.473
Validation loss decreased (-0.259353 --> -0.473051).  Saving model ...
Epoch: 5 cost time: 10.319242477416992
Epoch: 5, Steps: 32 | Train Loss: 6.036 Vali Loss: 21.898 Vali Acc: 0.366 Test Loss: 21.898 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.336197853088379
Epoch: 6, Steps: 32 | Train Loss: 1.679 Vali Loss: 26.544 Vali Acc: 0.466 Test Loss: 26.544 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.13038682937622
Epoch: 7, Steps: 32 | Train Loss: 1.496 Vali Loss: 23.936 Vali Acc: 0.519 Test Loss: 23.936 Test Acc: 0.519
Validation loss decreased (-0.473051 --> -0.518845).  Saving model ...
Epoch: 8 cost time: 10.209373950958252
Epoch: 8, Steps: 32 | Train Loss: 1.287 Vali Loss: 22.010 Vali Acc: 0.504 Test Loss: 22.010 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.151255369186401
Epoch: 9, Steps: 32 | Train Loss: 1.732 Vali Loss: 27.286 Vali Acc: 0.496 Test Loss: 27.286 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.295606136322021
Epoch: 10, Steps: 32 | Train Loss: 1.179 Vali Loss: 31.747 Vali Acc: 0.466 Test Loss: 31.747 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.461689710617065
Epoch: 11, Steps: 32 | Train Loss: 0.130 Vali Loss: 34.949 Vali Acc: 0.481 Test Loss: 34.949 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.263860940933228
Epoch: 12, Steps: 32 | Train Loss: 1.337 Vali Loss: 45.104 Vali Acc: 0.351 Test Loss: 45.104 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.218357563018799
Epoch: 13, Steps: 32 | Train Loss: 0.876 Vali Loss: 40.794 Vali Acc: 0.389 Test Loss: 40.794 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.06066370010376
Epoch: 14, Steps: 32 | Train Loss: 0.223 Vali Loss: 44.012 Vali Acc: 0.405 Test Loss: 44.012 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.173728466033936
Epoch: 15, Steps: 32 | Train Loss: 2.755 Vali Loss: 42.862 Vali Acc: 0.504 Test Loss: 42.862 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.243419647216797
Epoch: 16, Steps: 32 | Train Loss: 0.852 Vali Loss: 68.291 Vali Acc: 0.366 Test Loss: 68.291 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.318709373474121
Epoch: 17, Steps: 32 | Train Loss: 2.844 Vali Loss: 43.950 Vali Acc: 0.496 Test Loss: 43.950 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6395049
model size : 33.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.340591669082642
Epoch: 1, Steps: 32 | Train Loss: 9.383 Vali Loss: 8.975 Vali Acc: 0.191 Test Loss: 8.975 Test Acc: 0.191
Validation loss decreased (inf --> -0.190750).  Saving model ...
Epoch: 2 cost time: 10.139177799224854
Epoch: 2, Steps: 32 | Train Loss: 19.217 Vali Loss: 21.359 Vali Acc: 0.267 Test Loss: 21.359 Test Acc: 0.267
Validation loss decreased (-0.190750 --> -0.266962).  Saving model ...
Epoch: 3 cost time: 10.224847555160522
Epoch: 3, Steps: 32 | Train Loss: 15.257 Vali Loss: 12.980 Vali Acc: 0.458 Test Loss: 12.980 Test Acc: 0.458
Validation loss decreased (-0.266962 --> -0.457885).  Saving model ...
Epoch: 4 cost time: 10.207039594650269
Epoch: 4, Steps: 32 | Train Loss: 4.973 Vali Loss: 27.649 Vali Acc: 0.267 Test Loss: 27.649 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.966980934143066
Epoch: 5, Steps: 32 | Train Loss: 7.709 Vali Loss: 18.878 Vali Acc: 0.527 Test Loss: 18.878 Test Acc: 0.527
Validation loss decreased (-0.457885 --> -0.526529).  Saving model ...
Epoch: 6 cost time: 9.989096879959106
Epoch: 6, Steps: 32 | Train Loss: 2.659 Vali Loss: 22.529 Vali Acc: 0.489 Test Loss: 22.529 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.19440770149231
Epoch: 7, Steps: 32 | Train Loss: 2.413 Vali Loss: 28.851 Vali Acc: 0.397 Test Loss: 28.851 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.41681981086731
Epoch: 8, Steps: 32 | Train Loss: 1.440 Vali Loss: 33.178 Vali Acc: 0.427 Test Loss: 33.178 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.093026638031006
Epoch: 9, Steps: 32 | Train Loss: 0.235 Vali Loss: 32.772 Vali Acc: 0.412 Test Loss: 32.772 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.149457454681396
Epoch: 10, Steps: 32 | Train Loss: 1.690 Vali Loss: 33.221 Vali Acc: 0.496 Test Loss: 33.221 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.192713022232056
Epoch: 11, Steps: 32 | Train Loss: 1.055 Vali Loss: 32.166 Vali Acc: 0.481 Test Loss: 32.166 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.394286155700684
Epoch: 12, Steps: 32 | Train Loss: 0.044 Vali Loss: 38.106 Vali Acc: 0.534 Test Loss: 38.106 Test Acc: 0.534
Validation loss decreased (-0.526529 --> -0.533970).  Saving model ...
Epoch: 13 cost time: 10.200880527496338
Epoch: 13, Steps: 32 | Train Loss: 0.310 Vali Loss: 38.450 Vali Acc: 0.466 Test Loss: 38.450 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.095101594924927
Epoch: 14, Steps: 32 | Train Loss: 1.360 Vali Loss: 42.734 Vali Acc: 0.466 Test Loss: 42.734 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.055824756622314
Epoch: 15, Steps: 32 | Train Loss: 0.338 Vali Loss: 40.109 Vali Acc: 0.511 Test Loss: 40.109 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.190300941467285
Epoch: 16, Steps: 32 | Train Loss: 0.152 Vali Loss: 44.534 Vali Acc: 0.473 Test Loss: 44.534 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.210369110107422
Epoch: 17, Steps: 32 | Train Loss: 0.742 Vali Loss: 50.268 Vali Acc: 0.504 Test Loss: 50.268 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.340222835540771
Epoch: 18, Steps: 32 | Train Loss: 0.126 Vali Loss: 53.133 Vali Acc: 0.489 Test Loss: 53.133 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.964379072189331
Epoch: 19, Steps: 32 | Train Loss: 0.450 Vali Loss: 48.025 Vali Acc: 0.450 Test Loss: 48.025 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.878262042999268
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.777 Vali Acc: 0.435 Test Loss: 48.777 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.232303619384766
Epoch: 21, Steps: 32 | Train Loss: 0.052 Vali Loss: 48.121 Vali Acc: 0.473 Test Loss: 48.121 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.214118957519531
Epoch: 22, Steps: 32 | Train Loss: 1.061 Vali Loss: 49.447 Vali Acc: 0.359 Test Loss: 49.447 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6107177
model size : 32.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.331507444381714
Epoch: 1, Steps: 32 | Train Loss: 8.459 Vali Loss: 10.426 Vali Acc: 0.099 Test Loss: 10.426 Test Acc: 0.099
Validation loss decreased (inf --> -0.099132).  Saving model ...
Epoch: 2 cost time: 9.684138059616089
Epoch: 2, Steps: 32 | Train Loss: 12.889 Vali Loss: 5.381 Vali Acc: 0.244 Test Loss: 5.381 Test Acc: 0.244
Validation loss decreased (-0.099132 --> -0.244221).  Saving model ...
Epoch: 3 cost time: 9.94291067123413
Epoch: 3, Steps: 32 | Train Loss: 11.184 Vali Loss: 14.700 Vali Acc: 0.229 Test Loss: 14.700 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.822239398956299
Epoch: 4, Steps: 32 | Train Loss: 9.688 Vali Loss: 29.791 Vali Acc: 0.489 Test Loss: 29.791 Test Acc: 0.489
Validation loss decreased (-0.244221 --> -0.488252).  Saving model ...
Epoch: 5 cost time: 9.719250202178955
Epoch: 5, Steps: 32 | Train Loss: 7.638 Vali Loss: 21.764 Vali Acc: 0.412 Test Loss: 21.764 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.820657014846802
Epoch: 6, Steps: 32 | Train Loss: 2.260 Vali Loss: 22.523 Vali Acc: 0.496 Test Loss: 22.523 Test Acc: 0.496
Validation loss decreased (-0.488252 --> -0.495958).  Saving model ...
Epoch: 7 cost time: 9.747340679168701
Epoch: 7, Steps: 32 | Train Loss: 1.297 Vali Loss: 26.804 Vali Acc: 0.443 Test Loss: 26.804 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.795490026473999
Epoch: 8, Steps: 32 | Train Loss: 0.586 Vali Loss: 27.880 Vali Acc: 0.443 Test Loss: 27.880 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.756357669830322
Epoch: 9, Steps: 32 | Train Loss: 0.316 Vali Loss: 43.491 Vali Acc: 0.275 Test Loss: 43.491 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.788314580917358
Epoch: 10, Steps: 32 | Train Loss: 2.572 Vali Loss: 36.019 Vali Acc: 0.382 Test Loss: 36.019 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.662188053131104
Epoch: 11, Steps: 32 | Train Loss: 2.054 Vali Loss: 39.832 Vali Acc: 0.313 Test Loss: 39.832 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.824236869812012
Epoch: 12, Steps: 32 | Train Loss: 1.234 Vali Loss: 41.436 Vali Acc: 0.504 Test Loss: 41.436 Test Acc: 0.504
Validation loss decreased (-0.495958 --> -0.503402).  Saving model ...
Epoch: 13 cost time: 9.705626726150513
Epoch: 13, Steps: 32 | Train Loss: 0.302 Vali Loss: 37.903 Vali Acc: 0.496 Test Loss: 37.903 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.721318483352661
Epoch: 14, Steps: 32 | Train Loss: 0.429 Vali Loss: 41.477 Vali Acc: 0.481 Test Loss: 41.477 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.88827657699585
Epoch: 15, Steps: 32 | Train Loss: 0.632 Vali Loss: 41.208 Vali Acc: 0.527 Test Loss: 41.208 Test Acc: 0.527
Validation loss decreased (-0.503402 --> -0.526305).  Saving model ...
Epoch: 16 cost time: 9.743200540542603
Epoch: 16, Steps: 32 | Train Loss: 1.151 Vali Loss: 35.031 Vali Acc: 0.458 Test Loss: 35.031 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.832095384597778
Epoch: 17, Steps: 32 | Train Loss: 0.614 Vali Loss: 32.332 Vali Acc: 0.481 Test Loss: 32.332 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.731825113296509
Epoch: 18, Steps: 32 | Train Loss: 1.516 Vali Loss: 43.274 Vali Acc: 0.389 Test Loss: 43.274 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.708525657653809
Epoch: 19, Steps: 32 | Train Loss: 1.309 Vali Loss: 37.655 Vali Acc: 0.481 Test Loss: 37.655 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.816572427749634
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.072 Vali Acc: 0.382 Test Loss: 44.072 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.758625745773315
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.454 Vali Acc: 0.374 Test Loss: 44.454 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.750128984451294
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.477 Vali Acc: 0.374 Test Loss: 44.477 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.894867658615112
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.481 Vali Acc: 0.374 Test Loss: 44.481 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.551000356674194
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.481 Vali Acc: 0.374 Test Loss: 44.481 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.78695821762085
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 44.507 Vali Acc: 0.374 Test Loss: 44.507 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 5819305
model size : 31.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.321192741394043
Epoch: 1, Steps: 32 | Train Loss: 8.627 Vali Loss: 15.335 Vali Acc: 0.420 Test Loss: 15.335 Test Acc: 0.420
Validation loss decreased (inf --> -0.419694).  Saving model ...
Epoch: 2 cost time: 9.846676588058472
Epoch: 2, Steps: 32 | Train Loss: 13.627 Vali Loss: 15.133 Vali Acc: 0.137 Test Loss: 15.133 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.510104656219482
Epoch: 3, Steps: 32 | Train Loss: 6.218 Vali Loss: 7.803 Vali Acc: 0.443 Test Loss: 7.803 Test Acc: 0.443
Validation loss decreased (-0.419694 --> -0.442670).  Saving model ...
Epoch: 4 cost time: 9.827093362808228
Epoch: 4, Steps: 32 | Train Loss: 2.547 Vali Loss: 7.138 Vali Acc: 0.313 Test Loss: 7.138 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.040708065032959
Epoch: 5, Steps: 32 | Train Loss: 1.035 Vali Loss: 16.672 Vali Acc: 0.267 Test Loss: 16.672 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.74222445487976
Epoch: 6, Steps: 32 | Train Loss: 2.295 Vali Loss: 14.655 Vali Acc: 0.435 Test Loss: 14.655 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.125565528869629
Epoch: 7, Steps: 32 | Train Loss: 0.658 Vali Loss: 12.613 Vali Acc: 0.435 Test Loss: 12.613 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.959031343460083
Epoch: 8, Steps: 32 | Train Loss: 0.320 Vali Loss: 13.539 Vali Acc: 0.511 Test Loss: 13.539 Test Acc: 0.511
Validation loss decreased (-0.442670 --> -0.511315).  Saving model ...
Epoch: 9 cost time: 9.900369644165039
Epoch: 9, Steps: 32 | Train Loss: 0.091 Vali Loss: 17.521 Vali Acc: 0.443 Test Loss: 17.521 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.933809518814087
Epoch: 10, Steps: 32 | Train Loss: 0.059 Vali Loss: 18.188 Vali Acc: 0.496 Test Loss: 18.188 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.18673324584961
Epoch: 11, Steps: 32 | Train Loss: 0.237 Vali Loss: 18.321 Vali Acc: 0.481 Test Loss: 18.321 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.85754942893982
Epoch: 12, Steps: 32 | Train Loss: 0.086 Vali Loss: 15.235 Vali Acc: 0.481 Test Loss: 15.235 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.912787675857544
Epoch: 13, Steps: 32 | Train Loss: 0.334 Vali Loss: 16.692 Vali Acc: 0.504 Test Loss: 16.692 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.859412670135498
Epoch: 14, Steps: 32 | Train Loss: 0.249 Vali Loss: 17.658 Vali Acc: 0.481 Test Loss: 17.658 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.821263551712036
Epoch: 15, Steps: 32 | Train Loss: 0.191 Vali Loss: 25.201 Vali Acc: 0.244 Test Loss: 25.201 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.233003854751587
Epoch: 16, Steps: 32 | Train Loss: 0.315 Vali Loss: 18.603 Vali Acc: 0.374 Test Loss: 18.603 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.096366882324219
Epoch: 17, Steps: 32 | Train Loss: 0.904 Vali Loss: 18.553 Vali Acc: 0.458 Test Loss: 18.553 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.747750759124756
Epoch: 18, Steps: 32 | Train Loss: 0.183 Vali Loss: 28.575 Vali Acc: 0.466 Test Loss: 28.575 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 3592041
model size : 18.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.783219337463379
Epoch: 1, Steps: 32 | Train Loss: 5.761 Vali Loss: 5.472 Vali Acc: 0.458 Test Loss: 5.472 Test Acc: 0.458
Validation loss decreased (inf --> -0.457961).  Saving model ...
Epoch: 2 cost time: 9.896459341049194
Epoch: 2, Steps: 32 | Train Loss: 7.452 Vali Loss: 11.952 Vali Acc: 0.176 Test Loss: 11.952 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.021433353424072
Epoch: 3, Steps: 32 | Train Loss: 7.344 Vali Loss: 9.810 Vali Acc: 0.466 Test Loss: 9.810 Test Acc: 0.466
Validation loss decreased (-0.457961 --> -0.465551).  Saving model ...
Epoch: 4 cost time: 9.681470155715942
Epoch: 4, Steps: 32 | Train Loss: 2.940 Vali Loss: 7.769 Vali Acc: 0.412 Test Loss: 7.769 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.62491750717163
Epoch: 5, Steps: 32 | Train Loss: 0.862 Vali Loss: 11.717 Vali Acc: 0.450 Test Loss: 11.717 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.779967784881592
Epoch: 6, Steps: 32 | Train Loss: 0.396 Vali Loss: 12.503 Vali Acc: 0.443 Test Loss: 12.503 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.597084283828735
Epoch: 7, Steps: 32 | Train Loss: 1.257 Vali Loss: 13.206 Vali Acc: 0.458 Test Loss: 13.206 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.694462299346924
Epoch: 8, Steps: 32 | Train Loss: 0.469 Vali Loss: 10.240 Vali Acc: 0.527 Test Loss: 10.240 Test Acc: 0.527
Validation loss decreased (-0.465551 --> -0.526615).  Saving model ...
Epoch: 9 cost time: 9.66710877418518
Epoch: 9, Steps: 32 | Train Loss: 0.521 Vali Loss: 13.298 Vali Acc: 0.473 Test Loss: 13.298 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.6562659740448
Epoch: 10, Steps: 32 | Train Loss: 0.425 Vali Loss: 15.196 Vali Acc: 0.481 Test Loss: 15.196 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.806576251983643
Epoch: 11, Steps: 32 | Train Loss: 0.471 Vali Loss: 17.452 Vali Acc: 0.481 Test Loss: 17.452 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.889575242996216
Epoch: 12, Steps: 32 | Train Loss: 0.278 Vali Loss: 18.016 Vali Acc: 0.496 Test Loss: 18.016 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.636260271072388
Epoch: 13, Steps: 32 | Train Loss: 0.335 Vali Loss: 18.666 Vali Acc: 0.489 Test Loss: 18.666 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.600596189498901
Epoch: 14, Steps: 32 | Train Loss: 0.216 Vali Loss: 21.694 Vali Acc: 0.351 Test Loss: 21.694 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.088483810424805
Epoch: 15, Steps: 32 | Train Loss: 0.087 Vali Loss: 25.374 Vali Acc: 0.527 Test Loss: 25.374 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.655665397644043
Epoch: 16, Steps: 32 | Train Loss: 0.787 Vali Loss: 25.974 Vali Acc: 0.527 Test Loss: 25.974 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.135721683502197
Epoch: 17, Steps: 32 | Train Loss: 0.713 Vali Loss: 27.828 Vali Acc: 0.427 Test Loss: 27.828 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.733316898345947
Epoch: 18, Steps: 32 | Train Loss: 0.286 Vali Loss: 25.323 Vali Acc: 0.450 Test Loss: 25.323 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3448105
model size : 17.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.337568044662476
Epoch: 1, Steps: 32 | Train Loss: 5.342 Vali Loss: 14.029 Vali Acc: 0.137 Test Loss: 14.029 Test Acc: 0.137
Validation loss decreased (inf --> -0.137264).  Saving model ...
Epoch: 2 cost time: 9.706400871276855
Epoch: 2, Steps: 32 | Train Loss: 11.629 Vali Loss: 9.547 Vali Acc: 0.450 Test Loss: 9.547 Test Acc: 0.450
Validation loss decreased (-0.137264 --> -0.450286).  Saving model ...
Epoch: 3 cost time: 9.731589317321777
Epoch: 3, Steps: 32 | Train Loss: 6.031 Vali Loss: 7.464 Vali Acc: 0.504 Test Loss: 7.464 Test Acc: 0.504
Validation loss decreased (-0.450286 --> -0.503742).  Saving model ...
Epoch: 4 cost time: 9.56685209274292
Epoch: 4, Steps: 32 | Train Loss: 2.147 Vali Loss: 7.553 Vali Acc: 0.534 Test Loss: 7.553 Test Acc: 0.534
Validation loss decreased (-0.503742 --> -0.534276).  Saving model ...
Epoch: 5 cost time: 9.672162055969238
Epoch: 5, Steps: 32 | Train Loss: 1.995 Vali Loss: 14.103 Vali Acc: 0.527 Test Loss: 14.103 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.750468730926514
Epoch: 6, Steps: 32 | Train Loss: 0.644 Vali Loss: 12.525 Vali Acc: 0.397 Test Loss: 12.525 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.131130933761597
Epoch: 7, Steps: 32 | Train Loss: 0.881 Vali Loss: 13.547 Vali Acc: 0.389 Test Loss: 13.547 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.85336709022522
Epoch: 8, Steps: 32 | Train Loss: 0.205 Vali Loss: 14.117 Vali Acc: 0.443 Test Loss: 14.117 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.841529846191406
Epoch: 9, Steps: 32 | Train Loss: 0.236 Vali Loss: 14.164 Vali Acc: 0.412 Test Loss: 14.164 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.914211511611938
Epoch: 10, Steps: 32 | Train Loss: 0.103 Vali Loss: 16.412 Vali Acc: 0.359 Test Loss: 16.412 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.813879489898682
Epoch: 11, Steps: 32 | Train Loss: 0.383 Vali Loss: 19.320 Vali Acc: 0.366 Test Loss: 19.320 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.814957618713379
Epoch: 12, Steps: 32 | Train Loss: 0.420 Vali Loss: 22.573 Vali Acc: 0.473 Test Loss: 22.573 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.072048902511597
Epoch: 13, Steps: 32 | Train Loss: 0.142 Vali Loss: 19.381 Vali Acc: 0.473 Test Loss: 19.381 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.751463651657104
Epoch: 14, Steps: 32 | Train Loss: 0.187 Vali Loss: 22.994 Vali Acc: 0.450 Test Loss: 22.994 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3304169
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.263063669204712
Epoch: 1, Steps: 32 | Train Loss: 4.469 Vali Loss: 4.416 Vali Acc: 0.099 Test Loss: 4.416 Test Acc: 0.099
Validation loss decreased (inf --> -0.099192).  Saving model ...
Epoch: 2 cost time: 9.395133018493652
Epoch: 2, Steps: 32 | Train Loss: 9.597 Vali Loss: 9.467 Vali Acc: 0.191 Test Loss: 9.467 Test Acc: 0.191
Validation loss decreased (-0.099192 --> -0.190745).  Saving model ...
Epoch: 3 cost time: 9.362484455108643
Epoch: 3, Steps: 32 | Train Loss: 5.713 Vali Loss: 5.857 Vali Acc: 0.450 Test Loss: 5.857 Test Acc: 0.450
Validation loss decreased (-0.190745 --> -0.450323).  Saving model ...
Epoch: 4 cost time: 9.385321617126465
Epoch: 4, Steps: 32 | Train Loss: 4.253 Vali Loss: 13.369 Vali Acc: 0.481 Test Loss: 13.369 Test Acc: 0.481
Validation loss decreased (-0.450323 --> -0.480782).  Saving model ...
Epoch: 5 cost time: 9.608716487884521
Epoch: 5, Steps: 32 | Train Loss: 2.450 Vali Loss: 9.412 Vali Acc: 0.466 Test Loss: 9.412 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.418495893478394
Epoch: 6, Steps: 32 | Train Loss: 0.752 Vali Loss: 11.898 Vali Acc: 0.405 Test Loss: 11.898 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.247292041778564
Epoch: 7, Steps: 32 | Train Loss: 0.072 Vali Loss: 14.354 Vali Acc: 0.519 Test Loss: 14.354 Test Acc: 0.519
Validation loss decreased (-0.480782 --> -0.518940).  Saving model ...
Epoch: 8 cost time: 9.357203722000122
Epoch: 8, Steps: 32 | Train Loss: 0.704 Vali Loss: 19.458 Vali Acc: 0.519 Test Loss: 19.458 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.390870571136475
Epoch: 9, Steps: 32 | Train Loss: 0.390 Vali Loss: 16.166 Vali Acc: 0.473 Test Loss: 16.166 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.38292908668518
Epoch: 10, Steps: 32 | Train Loss: 0.310 Vali Loss: 18.314 Vali Acc: 0.336 Test Loss: 18.314 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.40130066871643
Epoch: 11, Steps: 32 | Train Loss: 0.063 Vali Loss: 15.191 Vali Acc: 0.397 Test Loss: 15.191 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.56804871559143
Epoch: 12, Steps: 32 | Train Loss: 0.271 Vali Loss: 15.418 Vali Acc: 0.496 Test Loss: 15.418 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.279791116714478
Epoch: 13, Steps: 32 | Train Loss: 0.402 Vali Loss: 18.516 Vali Acc: 0.489 Test Loss: 18.516 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.499108791351318
Epoch: 14, Steps: 32 | Train Loss: 0.735 Vali Loss: 17.706 Vali Acc: 0.534 Test Loss: 17.706 Test Acc: 0.534
Validation loss decreased (-0.518940 --> -0.534174).  Saving model ...
Epoch: 15 cost time: 9.394373416900635
Epoch: 15, Steps: 32 | Train Loss: 0.826 Vali Loss: 20.273 Vali Acc: 0.412 Test Loss: 20.273 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.660105466842651
Epoch: 16, Steps: 32 | Train Loss: 0.296 Vali Loss: 20.417 Vali Acc: 0.427 Test Loss: 20.417 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.20832085609436
Epoch: 17, Steps: 32 | Train Loss: 0.695 Vali Loss: 23.848 Vali Acc: 0.481 Test Loss: 23.848 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.34134554862976
Epoch: 18, Steps: 32 | Train Loss: 0.223 Vali Loss: 21.540 Vali Acc: 0.489 Test Loss: 21.540 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.519423007965088
Epoch: 19, Steps: 32 | Train Loss: 0.316 Vali Loss: 30.681 Vali Acc: 0.420 Test Loss: 30.681 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.296048164367676
Epoch: 20, Steps: 32 | Train Loss: 0.292 Vali Loss: 23.447 Vali Acc: 0.519 Test Loss: 23.447 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.316704988479614
Epoch: 21, Steps: 32 | Train Loss: 0.187 Vali Loss: 24.857 Vali Acc: 0.496 Test Loss: 24.857 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.236609935760498
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.148 Vali Acc: 0.489 Test Loss: 25.148 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.387232780456543
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.188 Vali Acc: 0.489 Test Loss: 25.188 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.296080112457275
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.249 Vali Acc: 0.481 Test Loss: 25.249 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3160233
model size : 16.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.857417106628418
Epoch: 1, Steps: 32 | Train Loss: 6.039 Vali Loss: 9.806 Vali Acc: 0.176 Test Loss: 9.806 Test Acc: 0.176
Validation loss decreased (inf --> -0.175474).  Saving model ...
Epoch: 2 cost time: 9.444317102432251
Epoch: 2, Steps: 32 | Train Loss: 10.701 Vali Loss: 14.269 Vali Acc: 0.221 Test Loss: 14.269 Test Acc: 0.221
Validation loss decreased (-0.175474 --> -0.221231).  Saving model ...
Epoch: 3 cost time: 9.577290534973145
Epoch: 3, Steps: 32 | Train Loss: 6.460 Vali Loss: 11.584 Vali Acc: 0.198 Test Loss: 11.584 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.69214415550232
Epoch: 4, Steps: 32 | Train Loss: 3.976 Vali Loss: 10.622 Vali Acc: 0.481 Test Loss: 10.622 Test Acc: 0.481
Validation loss decreased (-0.221231 --> -0.480810).  Saving model ...
Epoch: 5 cost time: 9.51404619216919
Epoch: 5, Steps: 32 | Train Loss: 1.481 Vali Loss: 18.945 Vali Acc: 0.290 Test Loss: 18.945 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.478825330734253
Epoch: 6, Steps: 32 | Train Loss: 0.663 Vali Loss: 14.492 Vali Acc: 0.420 Test Loss: 14.492 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.557761192321777
Epoch: 7, Steps: 32 | Train Loss: 1.092 Vali Loss: 18.443 Vali Acc: 0.260 Test Loss: 18.443 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.584810495376587
Epoch: 8, Steps: 32 | Train Loss: 0.459 Vali Loss: 14.260 Vali Acc: 0.405 Test Loss: 14.260 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.628692388534546
Epoch: 9, Steps: 32 | Train Loss: 0.318 Vali Loss: 17.233 Vali Acc: 0.435 Test Loss: 17.233 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.528602838516235
Epoch: 10, Steps: 32 | Train Loss: 0.529 Vali Loss: 20.155 Vali Acc: 0.489 Test Loss: 20.155 Test Acc: 0.489
Validation loss decreased (-0.480810 --> -0.488348).  Saving model ...
Epoch: 11 cost time: 9.28608512878418
Epoch: 11, Steps: 32 | Train Loss: 0.151 Vali Loss: 18.861 Vali Acc: 0.466 Test Loss: 18.861 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.717511177062988
Epoch: 12, Steps: 32 | Train Loss: 0.274 Vali Loss: 20.423 Vali Acc: 0.519 Test Loss: 20.423 Test Acc: 0.519
Validation loss decreased (-0.488348 --> -0.518880).  Saving model ...
Epoch: 13 cost time: 9.457741022109985
Epoch: 13, Steps: 32 | Train Loss: 0.049 Vali Loss: 20.223 Vali Acc: 0.382 Test Loss: 20.223 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.66649317741394
Epoch: 14, Steps: 32 | Train Loss: 0.003 Vali Loss: 18.133 Vali Acc: 0.450 Test Loss: 18.133 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.402822256088257
Epoch: 15, Steps: 32 | Train Loss: 0.091 Vali Loss: 25.717 Vali Acc: 0.336 Test Loss: 25.717 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.456138134002686
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 21.728 Vali Acc: 0.489 Test Loss: 21.728 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.742500066757202
Epoch: 17, Steps: 32 | Train Loss: 0.255 Vali Loss: 24.104 Vali Acc: 0.504 Test Loss: 24.104 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.907509088516235
Epoch: 18, Steps: 32 | Train Loss: 0.208 Vali Loss: 27.359 Vali Acc: 0.397 Test Loss: 27.359 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.704235076904297
Epoch: 19, Steps: 32 | Train Loss: 0.901 Vali Loss: 26.355 Vali Acc: 0.366 Test Loss: 26.355 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.978427648544312
Epoch: 20, Steps: 32 | Train Loss: 1.913 Vali Loss: 34.080 Vali Acc: 0.344 Test Loss: 34.080 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.554773092269897
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.279 Vali Acc: 0.511 Test Loss: 28.279 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.897677659988403
Epoch: 22, Steps: 32 | Train Loss: 0.291 Vali Loss: 33.465 Vali Acc: 0.351 Test Loss: 33.465 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 3261801
model size : 16.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.914331197738647
Epoch: 1, Steps: 32 | Train Loss: 8.054 Vali Loss: 9.702 Vali Acc: 0.420 Test Loss: 9.702 Test Acc: 0.420
Validation loss decreased (inf --> -0.419750).  Saving model ...
Epoch: 2 cost time: 9.490592002868652
Epoch: 2, Steps: 32 | Train Loss: 9.836 Vali Loss: 11.955 Vali Acc: 0.420 Test Loss: 11.955 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.339264392852783
Epoch: 3, Steps: 32 | Train Loss: 8.054 Vali Loss: 11.228 Vali Acc: 0.389 Test Loss: 11.228 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.488860368728638
Epoch: 4, Steps: 32 | Train Loss: 4.203 Vali Loss: 12.377 Vali Acc: 0.496 Test Loss: 12.377 Test Acc: 0.496
Validation loss decreased (-0.419750 --> -0.496059).  Saving model ...
Epoch: 5 cost time: 9.486640214920044
Epoch: 5, Steps: 32 | Train Loss: 1.948 Vali Loss: 18.177 Vali Acc: 0.458 Test Loss: 18.177 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.37216854095459
Epoch: 6, Steps: 32 | Train Loss: 1.777 Vali Loss: 13.416 Vali Acc: 0.519 Test Loss: 13.416 Test Acc: 0.519
Validation loss decreased (-0.496059 --> -0.518950).  Saving model ...
Epoch: 7 cost time: 9.580924272537231
Epoch: 7, Steps: 32 | Train Loss: 1.180 Vali Loss: 16.464 Vali Acc: 0.450 Test Loss: 16.464 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.44717788696289
Epoch: 8, Steps: 32 | Train Loss: 0.410 Vali Loss: 15.923 Vali Acc: 0.405 Test Loss: 15.923 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.452046394348145
Epoch: 9, Steps: 32 | Train Loss: 0.171 Vali Loss: 12.466 Vali Acc: 0.466 Test Loss: 12.466 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.951629877090454
Epoch: 10, Steps: 32 | Train Loss: 0.135 Vali Loss: 18.890 Vali Acc: 0.527 Test Loss: 18.890 Test Acc: 0.527
Validation loss decreased (-0.518950 --> -0.526529).  Saving model ...
Epoch: 11 cost time: 9.497110843658447
Epoch: 11, Steps: 32 | Train Loss: 0.942 Vali Loss: 17.713 Vali Acc: 0.420 Test Loss: 17.713 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.603265762329102
Epoch: 12, Steps: 32 | Train Loss: 0.833 Vali Loss: 26.403 Vali Acc: 0.298 Test Loss: 26.403 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.80178165435791
Epoch: 13, Steps: 32 | Train Loss: 1.251 Vali Loss: 23.598 Vali Acc: 0.359 Test Loss: 23.598 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.690473079681396
Epoch: 14, Steps: 32 | Train Loss: 0.184 Vali Loss: 19.477 Vali Acc: 0.412 Test Loss: 19.477 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.57971477508545
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.870 Vali Acc: 0.420 Test Loss: 20.870 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.376248598098755
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.985 Vali Acc: 0.420 Test Loss: 20.985 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.555895328521729
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.989 Vali Acc: 0.420 Test Loss: 20.989 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.530617237091064
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.989 Vali Acc: 0.420 Test Loss: 20.989 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.68743348121643
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.989 Vali Acc: 0.420 Test Loss: 20.989 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.316137075424194
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.977 Vali Acc: 0.420 Test Loss: 20.977 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3117865
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.721749305725098
Epoch: 1, Steps: 32 | Train Loss: 5.277 Vali Loss: 3.892 Vali Acc: 0.420 Test Loss: 3.892 Test Acc: 0.420
Validation loss decreased (inf --> -0.419808).  Saving model ...
Epoch: 2 cost time: 9.467630624771118
Epoch: 2, Steps: 32 | Train Loss: 5.973 Vali Loss: 5.072 Vali Acc: 0.443 Test Loss: 5.072 Test Acc: 0.443
Validation loss decreased (-0.419808 --> -0.442697).  Saving model ...
Epoch: 3 cost time: 9.635473012924194
Epoch: 3, Steps: 32 | Train Loss: 6.616 Vali Loss: 7.697 Vali Acc: 0.496 Test Loss: 7.697 Test Acc: 0.496
Validation loss decreased (-0.442697 --> -0.496106).  Saving model ...
Epoch: 4 cost time: 9.582529783248901
Epoch: 4, Steps: 32 | Train Loss: 4.321 Vali Loss: 9.280 Vali Acc: 0.267 Test Loss: 9.280 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.576045274734497
Epoch: 5, Steps: 32 | Train Loss: 2.392 Vali Loss: 16.475 Vali Acc: 0.244 Test Loss: 16.475 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.642091989517212
Epoch: 6, Steps: 32 | Train Loss: 1.027 Vali Loss: 16.786 Vali Acc: 0.473 Test Loss: 16.786 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.642566204071045
Epoch: 7, Steps: 32 | Train Loss: 0.427 Vali Loss: 20.120 Vali Acc: 0.443 Test Loss: 20.120 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.617229700088501
Epoch: 8, Steps: 32 | Train Loss: 0.146 Vali Loss: 17.243 Vali Acc: 0.344 Test Loss: 17.243 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.62795901298523
Epoch: 9, Steps: 32 | Train Loss: 0.319 Vali Loss: 21.744 Vali Acc: 0.435 Test Loss: 21.744 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.478838205337524
Epoch: 10, Steps: 32 | Train Loss: 0.274 Vali Loss: 20.749 Vali Acc: 0.374 Test Loss: 20.749 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.32720160484314
Epoch: 11, Steps: 32 | Train Loss: 1.079 Vali Loss: 16.919 Vali Acc: 0.489 Test Loss: 16.919 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.53937578201294
Epoch: 12, Steps: 32 | Train Loss: 0.798 Vali Loss: 17.448 Vali Acc: 0.496 Test Loss: 17.448 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.463138103485107
Epoch: 13, Steps: 32 | Train Loss: 0.140 Vali Loss: 21.652 Vali Acc: 0.496 Test Loss: 21.652 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 2973929
model size : 15.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.223159313201904
Epoch: 1, Steps: 32 | Train Loss: 5.249 Vali Loss: 6.943 Vali Acc: 0.420 Test Loss: 6.943 Test Acc: 0.420
Validation loss decreased (inf --> -0.419778).  Saving model ...
Epoch: 2 cost time: 9.134868621826172
Epoch: 2, Steps: 32 | Train Loss: 11.424 Vali Loss: 9.720 Vali Acc: 0.176 Test Loss: 9.720 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.247573614120483
Epoch: 3, Steps: 32 | Train Loss: 4.879 Vali Loss: 7.671 Vali Acc: 0.229 Test Loss: 7.671 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.250213146209717
Epoch: 4, Steps: 32 | Train Loss: 4.505 Vali Loss: 7.896 Vali Acc: 0.420 Test Loss: 7.896 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.112684965133667
Epoch: 5, Steps: 32 | Train Loss: 1.934 Vali Loss: 14.616 Vali Acc: 0.244 Test Loss: 14.616 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.293899774551392
Epoch: 6, Steps: 32 | Train Loss: 2.229 Vali Loss: 11.406 Vali Acc: 0.450 Test Loss: 11.406 Test Acc: 0.450
Validation loss decreased (-0.419778 --> -0.450268).  Saving model ...
Epoch: 7 cost time: 9.0673246383667
Epoch: 7, Steps: 32 | Train Loss: 0.520 Vali Loss: 17.862 Vali Acc: 0.504 Test Loss: 17.862 Test Acc: 0.504
Validation loss decreased (-0.450268 --> -0.503638).  Saving model ...
Epoch: 8 cost time: 9.193421363830566
Epoch: 8, Steps: 32 | Train Loss: 0.073 Vali Loss: 18.655 Vali Acc: 0.458 Test Loss: 18.655 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.36214804649353
Epoch: 9, Steps: 32 | Train Loss: 0.958 Vali Loss: 17.828 Vali Acc: 0.427 Test Loss: 17.828 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.184077978134155
Epoch: 10, Steps: 32 | Train Loss: 0.113 Vali Loss: 17.216 Vali Acc: 0.443 Test Loss: 17.216 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.30471396446228
Epoch: 11, Steps: 32 | Train Loss: 0.119 Vali Loss: 19.595 Vali Acc: 0.405 Test Loss: 19.595 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.480987071990967
Epoch: 12, Steps: 32 | Train Loss: 0.139 Vali Loss: 20.486 Vali Acc: 0.519 Test Loss: 20.486 Test Acc: 0.519
Validation loss decreased (-0.503638 --> -0.518879).  Saving model ...
Epoch: 13 cost time: 9.329058647155762
Epoch: 13, Steps: 32 | Train Loss: 0.031 Vali Loss: 19.744 Vali Acc: 0.412 Test Loss: 19.744 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.269228219985962
Epoch: 14, Steps: 32 | Train Loss: 0.282 Vali Loss: 13.963 Vali Acc: 0.374 Test Loss: 13.963 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.465130805969238
Epoch: 15, Steps: 32 | Train Loss: 0.825 Vali Loss: 24.046 Vali Acc: 0.496 Test Loss: 24.046 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.353760004043579
Epoch: 16, Steps: 32 | Train Loss: 0.760 Vali Loss: 28.537 Vali Acc: 0.351 Test Loss: 28.537 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.500136375427246
Epoch: 17, Steps: 32 | Train Loss: 2.289 Vali Loss: 30.129 Vali Acc: 0.389 Test Loss: 30.129 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.419026374816895
Epoch: 18, Steps: 32 | Train Loss: 1.563 Vali Loss: 28.052 Vali Acc: 0.359 Test Loss: 28.052 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.361045360565186
Epoch: 19, Steps: 32 | Train Loss: 1.144 Vali Loss: 30.899 Vali Acc: 0.427 Test Loss: 30.899 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.418325185775757
Epoch: 20, Steps: 32 | Train Loss: 0.015 Vali Loss: 34.171 Vali Acc: 0.519 Test Loss: 34.171 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.3046236038208
Epoch: 21, Steps: 32 | Train Loss: 0.214 Vali Loss: 37.866 Vali Acc: 0.481 Test Loss: 37.866 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.347826480865479
Epoch: 22, Steps: 32 | Train Loss: 0.401 Vali Loss: 30.540 Vali Acc: 0.504 Test Loss: 30.540 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2829993
model size : 15.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.635425090789795
Epoch: 1, Steps: 32 | Train Loss: 4.827 Vali Loss: 9.124 Vali Acc: 0.420 Test Loss: 9.124 Test Acc: 0.420
Validation loss decreased (inf --> -0.419756).  Saving model ...
Epoch: 2 cost time: 9.430606365203857
Epoch: 2, Steps: 32 | Train Loss: 7.892 Vali Loss: 9.208 Vali Acc: 0.420 Test Loss: 9.208 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.314778566360474
Epoch: 3, Steps: 32 | Train Loss: 6.524 Vali Loss: 5.014 Vali Acc: 0.321 Test Loss: 5.014 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.37204885482788
Epoch: 4, Steps: 32 | Train Loss: 5.517 Vali Loss: 13.690 Vali Acc: 0.481 Test Loss: 13.690 Test Acc: 0.481
Validation loss decreased (-0.419756 --> -0.480779).  Saving model ...
Epoch: 5 cost time: 9.855209112167358
Epoch: 5, Steps: 32 | Train Loss: 1.667 Vali Loss: 12.591 Vali Acc: 0.466 Test Loss: 12.591 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.401473999023438
Epoch: 6, Steps: 32 | Train Loss: 1.095 Vali Loss: 11.611 Vali Acc: 0.443 Test Loss: 11.611 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.357717275619507
Epoch: 7, Steps: 32 | Train Loss: 1.089 Vali Loss: 13.024 Vali Acc: 0.550 Test Loss: 13.024 Test Acc: 0.550
Validation loss decreased (-0.480779 --> -0.549488).  Saving model ...
Epoch: 8 cost time: 9.480196714401245
Epoch: 8, Steps: 32 | Train Loss: 0.993 Vali Loss: 15.651 Vali Acc: 0.466 Test Loss: 15.651 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.565016508102417
Epoch: 9, Steps: 32 | Train Loss: 0.572 Vali Loss: 16.825 Vali Acc: 0.443 Test Loss: 16.825 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.359344720840454
Epoch: 10, Steps: 32 | Train Loss: 1.498 Vali Loss: 19.144 Vali Acc: 0.534 Test Loss: 19.144 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.594987154006958
Epoch: 11, Steps: 32 | Train Loss: 0.084 Vali Loss: 17.354 Vali Acc: 0.458 Test Loss: 17.354 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.313295364379883
Epoch: 12, Steps: 32 | Train Loss: 0.190 Vali Loss: 17.309 Vali Acc: 0.550 Test Loss: 17.309 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.440931558609009
Epoch: 13, Steps: 32 | Train Loss: 0.137 Vali Loss: 17.455 Vali Acc: 0.534 Test Loss: 17.455 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.758592128753662
Epoch: 14, Steps: 32 | Train Loss: 0.035 Vali Loss: 21.038 Vali Acc: 0.527 Test Loss: 21.038 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.548717021942139
Epoch: 15, Steps: 32 | Train Loss: 0.687 Vali Loss: 21.497 Vali Acc: 0.466 Test Loss: 21.497 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.529205083847046
Epoch: 16, Steps: 32 | Train Loss: 0.172 Vali Loss: 24.561 Vali Acc: 0.527 Test Loss: 24.561 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.448129653930664
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.818 Vali Acc: 0.511 Test Loss: 28.818 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3096681
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.963443994522095
Epoch: 1, Steps: 32 | Train Loss: 4.327 Vali Loss: 7.741 Vali Acc: 0.420 Test Loss: 7.741 Test Acc: 0.420
Validation loss decreased (inf --> -0.419770).  Saving model ...
Epoch: 2 cost time: 9.397024869918823
Epoch: 2, Steps: 32 | Train Loss: 7.804 Vali Loss: 12.904 Vali Acc: 0.168 Test Loss: 12.904 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.385205268859863
Epoch: 3, Steps: 32 | Train Loss: 7.774 Vali Loss: 11.802 Vali Acc: 0.183 Test Loss: 11.802 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.547808408737183
Epoch: 4, Steps: 32 | Train Loss: 5.741 Vali Loss: 14.240 Vali Acc: 0.389 Test Loss: 14.240 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.398748874664307
Epoch: 5, Steps: 32 | Train Loss: 2.077 Vali Loss: 14.106 Vali Acc: 0.511 Test Loss: 14.106 Test Acc: 0.511
Validation loss decreased (-0.419770 --> -0.511309).  Saving model ...
Epoch: 6 cost time: 9.524648666381836
Epoch: 6, Steps: 32 | Train Loss: 0.986 Vali Loss: 22.106 Vali Acc: 0.282 Test Loss: 22.106 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.345628023147583
Epoch: 7, Steps: 32 | Train Loss: 0.932 Vali Loss: 18.513 Vali Acc: 0.443 Test Loss: 18.513 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.543736457824707
Epoch: 8, Steps: 32 | Train Loss: 0.189 Vali Loss: 20.622 Vali Acc: 0.504 Test Loss: 20.622 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.291912317276001
Epoch: 9, Steps: 32 | Train Loss: 0.315 Vali Loss: 17.825 Vali Acc: 0.450 Test Loss: 17.825 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.528571367263794
Epoch: 10, Steps: 32 | Train Loss: 0.419 Vali Loss: 16.116 Vali Acc: 0.458 Test Loss: 16.116 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.594469785690308
Epoch: 11, Steps: 32 | Train Loss: 0.347 Vali Loss: 17.152 Vali Acc: 0.496 Test Loss: 17.152 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.54752516746521
Epoch: 12, Steps: 32 | Train Loss: 0.538 Vali Loss: 18.232 Vali Acc: 0.496 Test Loss: 18.232 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.307198286056519
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.491 Vali Acc: 0.496 Test Loss: 18.491 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.444136381149292
Epoch: 14, Steps: 32 | Train Loss: 0.004 Vali Loss: 19.760 Vali Acc: 0.473 Test Loss: 19.760 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.393332242965698
Epoch: 15, Steps: 32 | Train Loss: 0.164 Vali Loss: 21.556 Vali Acc: 0.489 Test Loss: 21.556 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2952745
model size : 15.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.716458320617676
Epoch: 1, Steps: 32 | Train Loss: 5.522 Vali Loss: 5.806 Vali Acc: 0.168 Test Loss: 5.806 Test Acc: 0.168
Validation loss decreased (inf --> -0.167881).  Saving model ...
Epoch: 2 cost time: 9.20652723312378
Epoch: 2, Steps: 32 | Train Loss: 9.439 Vali Loss: 14.956 Vali Acc: 0.382 Test Loss: 14.956 Test Acc: 0.382
Validation loss decreased (-0.167881 --> -0.381530).  Saving model ...
Epoch: 3 cost time: 9.324612855911255
Epoch: 3, Steps: 32 | Train Loss: 11.202 Vali Loss: 5.133 Vali Acc: 0.435 Test Loss: 5.133 Test Acc: 0.435
Validation loss decreased (-0.381530 --> -0.435063).  Saving model ...
Epoch: 4 cost time: 9.314720869064331
Epoch: 4, Steps: 32 | Train Loss: 5.775 Vali Loss: 22.044 Vali Acc: 0.397 Test Loss: 22.044 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.696347951889038
Epoch: 5, Steps: 32 | Train Loss: 2.344 Vali Loss: 11.674 Vali Acc: 0.496 Test Loss: 11.674 Test Acc: 0.496
Validation loss decreased (-0.435063 --> -0.496066).  Saving model ...
Epoch: 6 cost time: 9.206370115280151
Epoch: 6, Steps: 32 | Train Loss: 0.907 Vali Loss: 12.690 Vali Acc: 0.489 Test Loss: 12.690 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.462578058242798
Epoch: 7, Steps: 32 | Train Loss: 0.232 Vali Loss: 13.326 Vali Acc: 0.435 Test Loss: 13.326 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.813232421875
Epoch: 8, Steps: 32 | Train Loss: 1.209 Vali Loss: 21.751 Vali Acc: 0.359 Test Loss: 21.751 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.615951538085938
Epoch: 9, Steps: 32 | Train Loss: 0.889 Vali Loss: 22.025 Vali Acc: 0.519 Test Loss: 22.025 Test Acc: 0.519
Validation loss decreased (-0.496066 --> -0.518864).  Saving model ...
Epoch: 10 cost time: 9.81437373161316
Epoch: 10, Steps: 32 | Train Loss: 1.637 Vali Loss: 21.573 Vali Acc: 0.397 Test Loss: 21.573 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.351611137390137
Epoch: 11, Steps: 32 | Train Loss: 0.401 Vali Loss: 16.215 Vali Acc: 0.466 Test Loss: 16.215 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.279226541519165
Epoch: 12, Steps: 32 | Train Loss: 0.469 Vali Loss: 19.835 Vali Acc: 0.366 Test Loss: 19.835 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.660840272903442
Epoch: 13, Steps: 32 | Train Loss: 0.379 Vali Loss: 23.108 Vali Acc: 0.443 Test Loss: 23.108 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.502744913101196
Epoch: 14, Steps: 32 | Train Loss: 0.344 Vali Loss: 20.097 Vali Acc: 0.435 Test Loss: 20.097 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.541079759597778
Epoch: 15, Steps: 32 | Train Loss: 0.084 Vali Loss: 17.964 Vali Acc: 0.466 Test Loss: 17.964 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.278488636016846
Epoch: 16, Steps: 32 | Train Loss: 0.050 Vali Loss: 20.913 Vali Acc: 0.473 Test Loss: 20.913 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.500897645950317
Epoch: 17, Steps: 32 | Train Loss: 0.577 Vali Loss: 22.616 Vali Acc: 0.473 Test Loss: 22.616 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.383361339569092
Epoch: 18, Steps: 32 | Train Loss: 1.310 Vali Loss: 25.125 Vali Acc: 0.489 Test Loss: 25.125 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.6282958984375
Epoch: 19, Steps: 32 | Train Loss: 0.251 Vali Loss: 25.079 Vali Acc: 0.489 Test Loss: 25.079 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2808809
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.570411682128906
Epoch: 1, Steps: 32 | Train Loss: 5.315 Vali Loss: 7.662 Vali Acc: 0.420 Test Loss: 7.662 Test Acc: 0.420
Validation loss decreased (inf --> -0.419771).  Saving model ...
Epoch: 2 cost time: 9.247271537780762
Epoch: 2, Steps: 32 | Train Loss: 8.943 Vali Loss: 9.266 Vali Acc: 0.145 Test Loss: 9.266 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.158541679382324
Epoch: 3, Steps: 32 | Train Loss: 10.633 Vali Loss: 15.165 Vali Acc: 0.435 Test Loss: 15.165 Test Acc: 0.435
Validation loss decreased (-0.419771 --> -0.434963).  Saving model ...
Epoch: 4 cost time: 9.12335991859436
Epoch: 4, Steps: 32 | Train Loss: 3.258 Vali Loss: 14.063 Vali Acc: 0.496 Test Loss: 14.063 Test Acc: 0.496
Validation loss decreased (-0.434963 --> -0.496043).  Saving model ...
Epoch: 5 cost time: 8.952079772949219
Epoch: 5, Steps: 32 | Train Loss: 2.671 Vali Loss: 15.868 Vali Acc: 0.527 Test Loss: 15.868 Test Acc: 0.527
Validation loss decreased (-0.496043 --> -0.526559).  Saving model ...
Epoch: 6 cost time: 8.912323236465454
Epoch: 6, Steps: 32 | Train Loss: 0.777 Vali Loss: 15.846 Vali Acc: 0.527 Test Loss: 15.846 Test Acc: 0.527
Validation loss decreased (-0.526559 --> -0.526559).  Saving model ...
Epoch: 7 cost time: 9.20884656906128
Epoch: 7, Steps: 32 | Train Loss: 0.484 Vali Loss: 13.344 Vali Acc: 0.481 Test Loss: 13.344 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.973600149154663
Epoch: 8, Steps: 32 | Train Loss: 1.561 Vali Loss: 17.814 Vali Acc: 0.397 Test Loss: 17.814 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.199353218078613
Epoch: 9, Steps: 32 | Train Loss: 2.225 Vali Loss: 19.321 Vali Acc: 0.466 Test Loss: 19.321 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.03458857536316
Epoch: 10, Steps: 32 | Train Loss: 2.914 Vali Loss: 26.741 Vali Acc: 0.420 Test Loss: 26.741 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.848674058914185
Epoch: 11, Steps: 32 | Train Loss: 0.567 Vali Loss: 16.184 Vali Acc: 0.458 Test Loss: 16.184 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.052399158477783
Epoch: 12, Steps: 32 | Train Loss: 0.117 Vali Loss: 24.147 Vali Acc: 0.519 Test Loss: 24.147 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.189738988876343
Epoch: 13, Steps: 32 | Train Loss: 0.002 Vali Loss: 23.545 Vali Acc: 0.473 Test Loss: 23.545 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.965035915374756
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.723 Vali Acc: 0.466 Test Loss: 21.723 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.04129695892334
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.313 Vali Acc: 0.473 Test Loss: 21.313 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.006192445755005
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.244 Vali Acc: 0.473 Test Loss: 21.244 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2664873
model size : 14.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.972219944000244
Epoch: 1, Steps: 32 | Train Loss: 6.216 Vali Loss: 3.674 Vali Acc: 0.092 Test Loss: 3.674 Test Acc: 0.092
Validation loss decreased (inf --> -0.091566).  Saving model ...
Epoch: 2 cost time: 9.485600233078003
Epoch: 2, Steps: 32 | Train Loss: 7.312 Vali Loss: 11.265 Vali Acc: 0.427 Test Loss: 11.265 Test Acc: 0.427
Validation loss decreased (-0.091566 --> -0.427368).  Saving model ...
Epoch: 3 cost time: 9.137300729751587
Epoch: 3, Steps: 32 | Train Loss: 9.443 Vali Loss: 18.496 Vali Acc: 0.458 Test Loss: 18.496 Test Acc: 0.458
Validation loss decreased (-0.427368 --> -0.457830).  Saving model ...
Epoch: 4 cost time: 9.452123641967773
Epoch: 4, Steps: 32 | Train Loss: 5.658 Vali Loss: 13.630 Vali Acc: 0.366 Test Loss: 13.630 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.248303174972534
Epoch: 5, Steps: 32 | Train Loss: 5.751 Vali Loss: 19.420 Vali Acc: 0.336 Test Loss: 19.420 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.222792387008667
Epoch: 6, Steps: 32 | Train Loss: 3.430 Vali Loss: 16.687 Vali Acc: 0.496 Test Loss: 16.687 Test Acc: 0.496
Validation loss decreased (-0.457830 --> -0.496016).  Saving model ...
Epoch: 7 cost time: 9.267330646514893
Epoch: 7, Steps: 32 | Train Loss: 1.339 Vali Loss: 18.675 Vali Acc: 0.496 Test Loss: 18.675 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.2927827835083
Epoch: 8, Steps: 32 | Train Loss: 0.210 Vali Loss: 17.915 Vali Acc: 0.481 Test Loss: 17.915 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.282429695129395
Epoch: 9, Steps: 32 | Train Loss: 0.489 Vali Loss: 18.356 Vali Acc: 0.435 Test Loss: 18.356 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.673040866851807
Epoch: 10, Steps: 32 | Train Loss: 0.319 Vali Loss: 21.641 Vali Acc: 0.443 Test Loss: 21.641 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.469420433044434
Epoch: 11, Steps: 32 | Train Loss: 0.031 Vali Loss: 23.416 Vali Acc: 0.366 Test Loss: 23.416 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.536163568496704
Epoch: 12, Steps: 32 | Train Loss: 0.332 Vali Loss: 19.923 Vali Acc: 0.405 Test Loss: 19.923 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.595003843307495
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.024 Vali Acc: 0.504 Test Loss: 20.024 Test Acc: 0.504
Validation loss decreased (-0.496016 --> -0.503617).  Saving model ...
Epoch: 14 cost time: 9.556509971618652
Epoch: 14, Steps: 32 | Train Loss: 0.439 Vali Loss: 18.472 Vali Acc: 0.489 Test Loss: 18.472 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.93381142616272
Epoch: 15, Steps: 32 | Train Loss: 0.015 Vali Loss: 18.340 Vali Acc: 0.481 Test Loss: 18.340 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.492132663726807
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.440 Vali Acc: 0.481 Test Loss: 18.440 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.32720398902893
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.378 Vali Acc: 0.466 Test Loss: 18.378 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.552645683288574
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.332 Vali Acc: 0.466 Test Loss: 18.332 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.470800399780273
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.330 Vali Acc: 0.466 Test Loss: 18.330 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.477306365966797
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.330 Vali Acc: 0.466 Test Loss: 18.330 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.339182376861572
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.314 Vali Acc: 0.466 Test Loss: 18.314 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.36635947227478
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.310 Vali Acc: 0.466 Test Loss: 18.310 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.528950691223145
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.308 Vali Acc: 0.466 Test Loss: 18.308 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 3014121
model size : 16.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.04830026626587
Epoch: 1, Steps: 32 | Train Loss: 3.778 Vali Loss: 5.839 Vali Acc: 0.183 Test Loss: 5.839 Test Acc: 0.183
Validation loss decreased (inf --> -0.183148).  Saving model ...
Epoch: 2 cost time: 9.350274085998535
Epoch: 2, Steps: 32 | Train Loss: 9.628 Vali Loss: 11.467 Vali Acc: 0.099 Test Loss: 11.467 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.41067123413086
Epoch: 3, Steps: 32 | Train Loss: 7.913 Vali Loss: 5.707 Vali Acc: 0.473 Test Loss: 5.707 Test Acc: 0.473
Validation loss decreased (-0.183148 --> -0.473225).  Saving model ...
Epoch: 4 cost time: 9.318421125411987
Epoch: 4, Steps: 32 | Train Loss: 3.115 Vali Loss: 7.653 Vali Acc: 0.412 Test Loss: 7.653 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.25811505317688
Epoch: 5, Steps: 32 | Train Loss: 5.914 Vali Loss: 11.621 Vali Acc: 0.466 Test Loss: 11.621 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.332340717315674
Epoch: 6, Steps: 32 | Train Loss: 1.414 Vali Loss: 18.483 Vali Acc: 0.519 Test Loss: 18.483 Test Acc: 0.519
Validation loss decreased (-0.473225 --> -0.518899).  Saving model ...
Epoch: 7 cost time: 9.290668249130249
Epoch: 7, Steps: 32 | Train Loss: 0.404 Vali Loss: 15.822 Vali Acc: 0.382 Test Loss: 15.822 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.186919689178467
Epoch: 8, Steps: 32 | Train Loss: 1.008 Vali Loss: 19.744 Vali Acc: 0.366 Test Loss: 19.744 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.178635597229004
Epoch: 9, Steps: 32 | Train Loss: 0.598 Vali Loss: 20.466 Vali Acc: 0.275 Test Loss: 20.466 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.378507375717163
Epoch: 10, Steps: 32 | Train Loss: 0.567 Vali Loss: 19.895 Vali Acc: 0.466 Test Loss: 19.895 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.354346990585327
Epoch: 11, Steps: 32 | Train Loss: 0.009 Vali Loss: 21.798 Vali Acc: 0.344 Test Loss: 21.798 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.328396081924438
Epoch: 12, Steps: 32 | Train Loss: 0.262 Vali Loss: 22.023 Vali Acc: 0.496 Test Loss: 22.023 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.318220376968384
Epoch: 13, Steps: 32 | Train Loss: 0.095 Vali Loss: 29.111 Vali Acc: 0.496 Test Loss: 29.111 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.415943622589111
Epoch: 14, Steps: 32 | Train Loss: 0.286 Vali Loss: 22.741 Vali Acc: 0.466 Test Loss: 22.741 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.44625973701477
Epoch: 15, Steps: 32 | Train Loss: 0.117 Vali Loss: 26.624 Vali Acc: 0.435 Test Loss: 26.624 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.46226716041565
Epoch: 16, Steps: 32 | Train Loss: 0.124 Vali Loss: 23.839 Vali Acc: 0.450 Test Loss: 23.839 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2870185
model size : 15.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.62602186203003
Epoch: 1, Steps: 32 | Train Loss: 5.667 Vali Loss: 5.493 Vali Acc: 0.099 Test Loss: 5.493 Test Acc: 0.099
Validation loss decreased (inf --> -0.099182).  Saving model ...
Epoch: 2 cost time: 9.581552743911743
Epoch: 2, Steps: 32 | Train Loss: 5.183 Vali Loss: 12.427 Vali Acc: 0.427 Test Loss: 12.427 Test Acc: 0.427
Validation loss decreased (-0.099182 --> -0.427357).  Saving model ...
Epoch: 3 cost time: 9.316633224487305
Epoch: 3, Steps: 32 | Train Loss: 12.542 Vali Loss: 7.677 Vali Acc: 0.214 Test Loss: 7.677 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.543719291687012
Epoch: 4, Steps: 32 | Train Loss: 5.899 Vali Loss: 12.439 Vali Acc: 0.466 Test Loss: 12.439 Test Acc: 0.466
Validation loss decreased (-0.427357 --> -0.465524).  Saving model ...
Epoch: 5 cost time: 9.288560152053833
Epoch: 5, Steps: 32 | Train Loss: 2.011 Vali Loss: 11.768 Vali Acc: 0.511 Test Loss: 11.768 Test Acc: 0.511
Validation loss decreased (-0.465524 --> -0.511333).  Saving model ...
Epoch: 6 cost time: 9.406473159790039
Epoch: 6, Steps: 32 | Train Loss: 2.367 Vali Loss: 12.734 Vali Acc: 0.489 Test Loss: 12.734 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.470392942428589
Epoch: 7, Steps: 32 | Train Loss: 0.714 Vali Loss: 16.844 Vali Acc: 0.511 Test Loss: 16.844 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.52456545829773
Epoch: 8, Steps: 32 | Train Loss: 0.472 Vali Loss: 21.698 Vali Acc: 0.420 Test Loss: 21.698 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.31623888015747
Epoch: 9, Steps: 32 | Train Loss: 0.629 Vali Loss: 17.474 Vali Acc: 0.519 Test Loss: 17.474 Test Acc: 0.519
Validation loss decreased (-0.511333 --> -0.518909).  Saving model ...
Epoch: 10 cost time: 9.387020587921143
Epoch: 10, Steps: 32 | Train Loss: 0.163 Vali Loss: 19.260 Vali Acc: 0.466 Test Loss: 19.260 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.370750188827515
Epoch: 11, Steps: 32 | Train Loss: 0.127 Vali Loss: 21.619 Vali Acc: 0.473 Test Loss: 21.619 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.4599130153656
Epoch: 12, Steps: 32 | Train Loss: 0.106 Vali Loss: 20.436 Vali Acc: 0.435 Test Loss: 20.436 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.449182271957397
Epoch: 13, Steps: 32 | Train Loss: 0.169 Vali Loss: 28.408 Vali Acc: 0.519 Test Loss: 28.408 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.404859781265259
Epoch: 14, Steps: 32 | Train Loss: 0.379 Vali Loss: 30.237 Vali Acc: 0.511 Test Loss: 30.237 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.271351099014282
Epoch: 15, Steps: 32 | Train Loss: 0.466 Vali Loss: 23.744 Vali Acc: 0.473 Test Loss: 23.744 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.485739946365356
Epoch: 16, Steps: 32 | Train Loss: 0.070 Vali Loss: 22.491 Vali Acc: 0.435 Test Loss: 22.491 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.399594783782959
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.646 Vali Acc: 0.473 Test Loss: 25.646 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.378939628601074
Epoch: 18, Steps: 32 | Train Loss: 0.004 Vali Loss: 28.482 Vali Acc: 0.389 Test Loss: 28.482 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.415950059890747
Epoch: 19, Steps: 32 | Train Loss: 0.721 Vali Loss: 28.819 Vali Acc: 0.382 Test Loss: 28.819 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2726249
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.235121965408325
Epoch: 1, Steps: 32 | Train Loss: 3.509 Vali Loss: 6.145 Vali Acc: 0.420 Test Loss: 6.145 Test Acc: 0.420
Validation loss decreased (inf --> -0.419786).  Saving model ...
Epoch: 2 cost time: 9.208338260650635
Epoch: 2, Steps: 32 | Train Loss: 7.500 Vali Loss: 8.821 Vali Acc: 0.176 Test Loss: 8.821 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.890265464782715
Epoch: 3, Steps: 32 | Train Loss: 11.953 Vali Loss: 7.970 Vali Acc: 0.130 Test Loss: 7.970 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.981711626052856
Epoch: 4, Steps: 32 | Train Loss: 5.708 Vali Loss: 15.542 Vali Acc: 0.481 Test Loss: 15.542 Test Acc: 0.481
Validation loss decreased (-0.419786 --> -0.480761).  Saving model ...
Epoch: 5 cost time: 9.039711713790894
Epoch: 5, Steps: 32 | Train Loss: 3.975 Vali Loss: 16.250 Vali Acc: 0.290 Test Loss: 16.250 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.0273118019104
Epoch: 6, Steps: 32 | Train Loss: 1.465 Vali Loss: 13.909 Vali Acc: 0.534 Test Loss: 13.909 Test Acc: 0.534
Validation loss decreased (-0.480761 --> -0.534212).  Saving model ...
Epoch: 7 cost time: 9.261008024215698
Epoch: 7, Steps: 32 | Train Loss: 0.971 Vali Loss: 19.768 Vali Acc: 0.466 Test Loss: 19.768 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.008463382720947
Epoch: 8, Steps: 32 | Train Loss: 0.858 Vali Loss: 22.760 Vali Acc: 0.458 Test Loss: 22.760 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.864890098571777
Epoch: 9, Steps: 32 | Train Loss: 0.527 Vali Loss: 20.782 Vali Acc: 0.466 Test Loss: 20.782 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.09352159500122
Epoch: 10, Steps: 32 | Train Loss: 0.513 Vali Loss: 19.339 Vali Acc: 0.443 Test Loss: 19.339 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.092936038970947
Epoch: 11, Steps: 32 | Train Loss: 0.171 Vali Loss: 19.527 Vali Acc: 0.466 Test Loss: 19.527 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.928106307983398
Epoch: 12, Steps: 32 | Train Loss: 0.060 Vali Loss: 20.862 Vali Acc: 0.443 Test Loss: 20.862 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.116836309432983
Epoch: 13, Steps: 32 | Train Loss: 0.118 Vali Loss: 20.475 Vali Acc: 0.450 Test Loss: 20.475 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.86228322982788
Epoch: 14, Steps: 32 | Train Loss: 0.150 Vali Loss: 26.736 Vali Acc: 0.496 Test Loss: 26.736 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.977227687835693
Epoch: 15, Steps: 32 | Train Loss: 1.097 Vali Loss: 28.016 Vali Acc: 0.504 Test Loss: 28.016 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.99052882194519
Epoch: 16, Steps: 32 | Train Loss: 0.079 Vali Loss: 24.177 Vali Acc: 0.427 Test Loss: 24.177 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2582313
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.490375757217407
Epoch: 1, Steps: 32 | Train Loss: 3.070 Vali Loss: 3.659 Vali Acc: 0.420 Test Loss: 3.659 Test Acc: 0.420
Validation loss decreased (inf --> -0.419811).  Saving model ...
Epoch: 2 cost time: 9.289751768112183
Epoch: 2, Steps: 32 | Train Loss: 4.926 Vali Loss: 7.200 Vali Acc: 0.389 Test Loss: 7.200 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.36332082748413
Epoch: 3, Steps: 32 | Train Loss: 5.253 Vali Loss: 4.134 Vali Acc: 0.458 Test Loss: 4.134 Test Acc: 0.458
Validation loss decreased (-0.419811 --> -0.457974).  Saving model ...
Epoch: 4 cost time: 9.62845778465271
Epoch: 4, Steps: 32 | Train Loss: 3.012 Vali Loss: 6.006 Vali Acc: 0.298 Test Loss: 6.006 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.242117404937744
Epoch: 5, Steps: 32 | Train Loss: 1.856 Vali Loss: 5.589 Vali Acc: 0.336 Test Loss: 5.589 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.252003908157349
Epoch: 6, Steps: 32 | Train Loss: 0.860 Vali Loss: 8.956 Vali Acc: 0.504 Test Loss: 8.956 Test Acc: 0.504
Validation loss decreased (-0.457974 --> -0.503727).  Saving model ...
Epoch: 7 cost time: 9.149422407150269
Epoch: 7, Steps: 32 | Train Loss: 0.101 Vali Loss: 7.083 Vali Acc: 0.496 Test Loss: 7.083 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.309196710586548
Epoch: 8, Steps: 32 | Train Loss: 0.205 Vali Loss: 8.223 Vali Acc: 0.458 Test Loss: 8.223 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.387267351150513
Epoch: 9, Steps: 32 | Train Loss: 0.064 Vali Loss: 8.108 Vali Acc: 0.397 Test Loss: 8.108 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.328395128250122
Epoch: 10, Steps: 32 | Train Loss: 0.067 Vali Loss: 9.578 Vali Acc: 0.458 Test Loss: 9.578 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.20008397102356
Epoch: 11, Steps: 32 | Train Loss: 0.026 Vali Loss: 8.037 Vali Acc: 0.351 Test Loss: 8.037 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.253071308135986
Epoch: 12, Steps: 32 | Train Loss: 0.032 Vali Loss: 7.749 Vali Acc: 0.427 Test Loss: 7.749 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.19844675064087
Epoch: 13, Steps: 32 | Train Loss: 0.004 Vali Loss: 9.359 Vali Acc: 0.435 Test Loss: 9.359 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.435721635818481
Epoch: 14, Steps: 32 | Train Loss: 0.127 Vali Loss: 9.386 Vali Acc: 0.511 Test Loss: 9.386 Test Acc: 0.511
Validation loss decreased (-0.503727 --> -0.511357).  Saving model ...
Epoch: 15 cost time: 9.318489074707031
Epoch: 15, Steps: 32 | Train Loss: 0.076 Vali Loss: 11.027 Vali Acc: 0.489 Test Loss: 11.027 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.306648015975952
Epoch: 16, Steps: 32 | Train Loss: 0.217 Vali Loss: 13.438 Vali Acc: 0.328 Test Loss: 13.438 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.552915811538696
Epoch: 17, Steps: 32 | Train Loss: 0.411 Vali Loss: 11.102 Vali Acc: 0.473 Test Loss: 11.102 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.306391954421997
Epoch: 18, Steps: 32 | Train Loss: 0.154 Vali Loss: 11.602 Vali Acc: 0.420 Test Loss: 11.602 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.539718389511108
Epoch: 19, Steps: 32 | Train Loss: 0.116 Vali Loss: 12.165 Vali Acc: 0.344 Test Loss: 12.165 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.382790565490723
Epoch: 20, Steps: 32 | Train Loss: 0.036 Vali Loss: 14.172 Vali Acc: 0.382 Test Loss: 14.172 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.16291332244873
Epoch: 21, Steps: 32 | Train Loss: 0.166 Vali Loss: 14.633 Vali Acc: 0.427 Test Loss: 14.633 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.382995843887329
Epoch: 22, Steps: 32 | Train Loss: 0.001 Vali Loss: 18.102 Vali Acc: 0.420 Test Loss: 18.102 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.337564468383789
Epoch: 23, Steps: 32 | Train Loss: 0.127 Vali Loss: 14.774 Vali Acc: 0.435 Test Loss: 14.774 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.496827602386475
Epoch: 24, Steps: 32 | Train Loss: 0.029 Vali Loss: 17.559 Vali Acc: 0.427 Test Loss: 17.559 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1716681
model size : 8.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.318081617355347
Epoch: 1, Steps: 32 | Train Loss: 3.513 Vali Loss: 2.944 Vali Acc: 0.214 Test Loss: 2.944 Test Acc: 0.214
Validation loss decreased (inf --> -0.213711).  Saving model ...
Epoch: 2 cost time: 9.179092168807983
Epoch: 2, Steps: 32 | Train Loss: 4.302 Vali Loss: 2.575 Vali Acc: 0.450 Test Loss: 2.575 Test Acc: 0.450
Validation loss decreased (-0.213711 --> -0.450356).  Saving model ...
Epoch: 3 cost time: 9.2654128074646
Epoch: 3, Steps: 32 | Train Loss: 2.919 Vali Loss: 6.498 Vali Acc: 0.359 Test Loss: 6.498 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.312631845474243
Epoch: 4, Steps: 32 | Train Loss: 3.557 Vali Loss: 6.721 Vali Acc: 0.435 Test Loss: 6.721 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.147984504699707
Epoch: 5, Steps: 32 | Train Loss: 0.972 Vali Loss: 13.541 Vali Acc: 0.252 Test Loss: 13.541 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.297657251358032
Epoch: 6, Steps: 32 | Train Loss: 0.623 Vali Loss: 10.258 Vali Acc: 0.496 Test Loss: 10.258 Test Acc: 0.496
Validation loss decreased (-0.450356 --> -0.496081).  Saving model ...
Epoch: 7 cost time: 9.1951425075531
Epoch: 7, Steps: 32 | Train Loss: 0.154 Vali Loss: 9.079 Vali Acc: 0.450 Test Loss: 9.079 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.321765184402466
Epoch: 8, Steps: 32 | Train Loss: 0.931 Vali Loss: 9.216 Vali Acc: 0.504 Test Loss: 9.216 Test Acc: 0.504
Validation loss decreased (-0.496081 --> -0.503725).  Saving model ...
Epoch: 9 cost time: 9.472288608551025
Epoch: 9, Steps: 32 | Train Loss: 0.002 Vali Loss: 10.558 Vali Acc: 0.458 Test Loss: 10.558 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.091182947158813
Epoch: 10, Steps: 32 | Train Loss: 0.008 Vali Loss: 11.786 Vali Acc: 0.336 Test Loss: 11.786 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.339468002319336
Epoch: 11, Steps: 32 | Train Loss: 0.306 Vali Loss: 10.854 Vali Acc: 0.420 Test Loss: 10.854 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.35534119606018
Epoch: 12, Steps: 32 | Train Loss: 0.228 Vali Loss: 12.233 Vali Acc: 0.412 Test Loss: 12.233 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.230058670043945
Epoch: 13, Steps: 32 | Train Loss: 0.002 Vali Loss: 12.733 Vali Acc: 0.427 Test Loss: 12.733 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.183926343917847
Epoch: 14, Steps: 32 | Train Loss: 0.087 Vali Loss: 17.352 Vali Acc: 0.366 Test Loss: 17.352 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.248065948486328
Epoch: 15, Steps: 32 | Train Loss: 0.078 Vali Loss: 16.757 Vali Acc: 0.443 Test Loss: 16.757 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.229058504104614
Epoch: 16, Steps: 32 | Train Loss: 0.002 Vali Loss: 14.689 Vali Acc: 0.527 Test Loss: 14.689 Test Acc: 0.527
Validation loss decreased (-0.503725 --> -0.526571).  Saving model ...
Epoch: 17 cost time: 9.398373365402222
Epoch: 17, Steps: 32 | Train Loss: 0.291 Vali Loss: 17.930 Vali Acc: 0.527 Test Loss: 17.930 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.337427377700806
Epoch: 18, Steps: 32 | Train Loss: 0.310 Vali Loss: 16.462 Vali Acc: 0.504 Test Loss: 16.462 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.056448221206665
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.050 Vali Acc: 0.466 Test Loss: 13.050 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.437776803970337
Epoch: 20, Steps: 32 | Train Loss: 0.001 Vali Loss: 15.144 Vali Acc: 0.420 Test Loss: 15.144 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.304447412490845
Epoch: 21, Steps: 32 | Train Loss: 0.031 Vali Loss: 15.154 Vali Acc: 0.427 Test Loss: 15.154 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.31980299949646
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.157 Vali Acc: 0.435 Test Loss: 15.157 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.375577211380005
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.158 Vali Acc: 0.435 Test Loss: 15.158 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.103208541870117
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.159 Vali Acc: 0.435 Test Loss: 15.159 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.163982629776001
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.161 Vali Acc: 0.435 Test Loss: 15.161 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.578297853469849
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.162 Vali Acc: 0.435 Test Loss: 15.162 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1644713
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.79245400428772
Epoch: 1, Steps: 32 | Train Loss: 2.982 Vali Loss: 5.465 Vali Acc: 0.099 Test Loss: 5.465 Test Acc: 0.099
Validation loss decreased (inf --> -0.099182).  Saving model ...
Epoch: 2 cost time: 9.201532363891602
Epoch: 2, Steps: 32 | Train Loss: 4.305 Vali Loss: 2.165 Vali Acc: 0.435 Test Loss: 2.165 Test Acc: 0.435
Validation loss decreased (-0.099182 --> -0.435093).  Saving model ...
Epoch: 3 cost time: 9.121333837509155
Epoch: 3, Steps: 32 | Train Loss: 5.182 Vali Loss: 5.443 Vali Acc: 0.489 Test Loss: 5.443 Test Acc: 0.489
Validation loss decreased (-0.435093 --> -0.488495).  Saving model ...
Epoch: 4 cost time: 9.362857103347778
Epoch: 4, Steps: 32 | Train Loss: 1.335 Vali Loss: 8.478 Vali Acc: 0.321 Test Loss: 8.478 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.271933555603027
Epoch: 5, Steps: 32 | Train Loss: 1.003 Vali Loss: 10.036 Vali Acc: 0.496 Test Loss: 10.036 Test Acc: 0.496
Validation loss decreased (-0.488495 --> -0.496083).  Saving model ...
Epoch: 6 cost time: 9.22053050994873
Epoch: 6, Steps: 32 | Train Loss: 0.484 Vali Loss: 8.171 Vali Acc: 0.496 Test Loss: 8.171 Test Acc: 0.496
Validation loss decreased (-0.496083 --> -0.496102).  Saving model ...
Epoch: 7 cost time: 9.106577634811401
Epoch: 7, Steps: 32 | Train Loss: 0.626 Vali Loss: 12.734 Vali Acc: 0.305 Test Loss: 12.734 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.387348175048828
Epoch: 8, Steps: 32 | Train Loss: 0.143 Vali Loss: 9.562 Vali Acc: 0.275 Test Loss: 9.562 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.211201667785645
Epoch: 9, Steps: 32 | Train Loss: 0.580 Vali Loss: 11.477 Vali Acc: 0.321 Test Loss: 11.477 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.214850425720215
Epoch: 10, Steps: 32 | Train Loss: 0.017 Vali Loss: 12.476 Vali Acc: 0.481 Test Loss: 12.476 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.32396149635315
Epoch: 11, Steps: 32 | Train Loss: 0.001 Vali Loss: 11.102 Vali Acc: 0.450 Test Loss: 11.102 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.105713844299316
Epoch: 12, Steps: 32 | Train Loss: 0.031 Vali Loss: 15.186 Vali Acc: 0.527 Test Loss: 15.186 Test Acc: 0.527
Validation loss decreased (-0.496102 --> -0.526566).  Saving model ...
Epoch: 13 cost time: 9.295752763748169
Epoch: 13, Steps: 32 | Train Loss: 0.040 Vali Loss: 11.566 Vali Acc: 0.389 Test Loss: 11.566 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.179081678390503
Epoch: 14, Steps: 32 | Train Loss: 0.097 Vali Loss: 14.298 Vali Acc: 0.511 Test Loss: 14.298 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.302801132202148
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.449 Vali Acc: 0.435 Test Loss: 13.449 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.022122144699097
Epoch: 16, Steps: 32 | Train Loss: 0.034 Vali Loss: 15.179 Vali Acc: 0.542 Test Loss: 15.179 Test Acc: 0.542
Validation loss decreased (-0.526566 --> -0.541833).  Saving model ...
Epoch: 17 cost time: 9.146981477737427
Epoch: 17, Steps: 32 | Train Loss: 0.018 Vali Loss: 16.176 Vali Acc: 0.519 Test Loss: 16.176 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.343918085098267
Epoch: 18, Steps: 32 | Train Loss: 0.009 Vali Loss: 15.002 Vali Acc: 0.519 Test Loss: 15.002 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.247277736663818
Epoch: 19, Steps: 32 | Train Loss: 0.019 Vali Loss: 13.857 Vali Acc: 0.435 Test Loss: 13.857 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.323070764541626
Epoch: 20, Steps: 32 | Train Loss: 0.109 Vali Loss: 13.919 Vali Acc: 0.405 Test Loss: 13.919 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.186325550079346
Epoch: 21, Steps: 32 | Train Loss: 0.002 Vali Loss: 14.765 Vali Acc: 0.542 Test Loss: 14.765 Test Acc: 0.542
Validation loss decreased (-0.541833 --> -0.541837).  Saving model ...
Epoch: 22 cost time: 9.20585012435913
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.477 Vali Acc: 0.534 Test Loss: 14.477 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.285057783126831
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.461 Vali Acc: 0.534 Test Loss: 14.461 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.205052852630615
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.461 Vali Acc: 0.534 Test Loss: 14.461 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.213138341903687
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.450 Vali Acc: 0.534 Test Loss: 14.450 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.014838695526123
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.444 Vali Acc: 0.534 Test Loss: 14.444 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.17531967163086
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.444 Vali Acc: 0.534 Test Loss: 14.444 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.018632411956787
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.443 Vali Acc: 0.534 Test Loss: 14.443 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.168316125869751
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.441 Vali Acc: 0.534 Test Loss: 14.441 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.239820718765259
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.441 Vali Acc: 0.534 Test Loss: 14.441 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.200985670089722
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.440 Vali Acc: 0.534 Test Loss: 14.440 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1572745
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.226718425750732
Epoch: 1, Steps: 32 | Train Loss: 2.681 Vali Loss: 3.624 Vali Acc: 0.176 Test Loss: 3.624 Test Acc: 0.176
Validation loss decreased (inf --> -0.175536).  Saving model ...
Epoch: 2 cost time: 8.874639511108398
Epoch: 2, Steps: 32 | Train Loss: 5.062 Vali Loss: 6.169 Vali Acc: 0.435 Test Loss: 6.169 Test Acc: 0.435
Validation loss decreased (-0.175536 --> -0.435053).  Saving model ...
Epoch: 3 cost time: 9.035063028335571
Epoch: 3, Steps: 32 | Train Loss: 6.353 Vali Loss: 5.071 Vali Acc: 0.389 Test Loss: 5.071 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.922660112380981
Epoch: 4, Steps: 32 | Train Loss: 2.171 Vali Loss: 5.916 Vali Acc: 0.344 Test Loss: 5.916 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.655059099197388
Epoch: 5, Steps: 32 | Train Loss: 2.405 Vali Loss: 7.794 Vali Acc: 0.504 Test Loss: 7.794 Test Acc: 0.504
Validation loss decreased (-0.435053 --> -0.503739).  Saving model ...
Epoch: 6 cost time: 8.766130924224854
Epoch: 6, Steps: 32 | Train Loss: 0.794 Vali Loss: 9.453 Vali Acc: 0.366 Test Loss: 9.453 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.789588451385498
Epoch: 7, Steps: 32 | Train Loss: 0.126 Vali Loss: 13.043 Vali Acc: 0.511 Test Loss: 13.043 Test Acc: 0.511
Validation loss decreased (-0.503739 --> -0.511320).  Saving model ...
Epoch: 8 cost time: 9.045369625091553
Epoch: 8, Steps: 32 | Train Loss: 0.345 Vali Loss: 12.290 Vali Acc: 0.435 Test Loss: 12.290 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.880297660827637
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 12.622 Vali Acc: 0.344 Test Loss: 12.622 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.856905698776245
Epoch: 10, Steps: 32 | Train Loss: 0.205 Vali Loss: 9.080 Vali Acc: 0.427 Test Loss: 9.080 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.009709596633911
Epoch: 11, Steps: 32 | Train Loss: 0.003 Vali Loss: 13.051 Vali Acc: 0.244 Test Loss: 13.051 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.93953824043274
Epoch: 12, Steps: 32 | Train Loss: 0.148 Vali Loss: 11.957 Vali Acc: 0.504 Test Loss: 11.957 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.030162572860718
Epoch: 13, Steps: 32 | Train Loss: 0.047 Vali Loss: 15.191 Vali Acc: 0.504 Test Loss: 15.191 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.927968263626099
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.554 Vali Acc: 0.473 Test Loss: 13.554 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.840885400772095
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.461 Vali Acc: 0.473 Test Loss: 13.461 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.282130241394043
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.436 Vali Acc: 0.466 Test Loss: 13.436 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.994430541992188
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.435 Vali Acc: 0.466 Test Loss: 13.435 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1500777
model size : 8.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.211671352386475
Epoch: 1, Steps: 32 | Train Loss: 3.005 Vali Loss: 3.636 Vali Acc: 0.420 Test Loss: 3.636 Test Acc: 0.420
Validation loss decreased (inf --> -0.419811).  Saving model ...
Epoch: 2 cost time: 9.022217035293579
Epoch: 2, Steps: 32 | Train Loss: 3.230 Vali Loss: 4.830 Vali Acc: 0.168 Test Loss: 4.830 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.209059715270996
Epoch: 3, Steps: 32 | Train Loss: 4.838 Vali Loss: 8.147 Vali Acc: 0.160 Test Loss: 8.147 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.9237642288208
Epoch: 4, Steps: 32 | Train Loss: 3.607 Vali Loss: 6.223 Vali Acc: 0.450 Test Loss: 6.223 Test Acc: 0.450
Validation loss decreased (-0.419811 --> -0.450319).  Saving model ...
Epoch: 5 cost time: 8.996363639831543
Epoch: 5, Steps: 32 | Train Loss: 1.467 Vali Loss: 9.301 Vali Acc: 0.542 Test Loss: 9.301 Test Acc: 0.542
Validation loss decreased (-0.450319 --> -0.541892).  Saving model ...
Epoch: 6 cost time: 9.08260464668274
Epoch: 6, Steps: 32 | Train Loss: 1.452 Vali Loss: 8.042 Vali Acc: 0.450 Test Loss: 8.042 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.149681091308594
Epoch: 7, Steps: 32 | Train Loss: 0.552 Vali Loss: 7.050 Vali Acc: 0.443 Test Loss: 7.050 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.879608392715454
Epoch: 8, Steps: 32 | Train Loss: 0.328 Vali Loss: 8.187 Vali Acc: 0.427 Test Loss: 8.187 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.301217317581177
Epoch: 9, Steps: 32 | Train Loss: 0.217 Vali Loss: 12.915 Vali Acc: 0.412 Test Loss: 12.915 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.18055534362793
Epoch: 10, Steps: 32 | Train Loss: 0.191 Vali Loss: 11.015 Vali Acc: 0.519 Test Loss: 11.015 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.900044918060303
Epoch: 11, Steps: 32 | Train Loss: 0.198 Vali Loss: 13.346 Vali Acc: 0.542 Test Loss: 13.346 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.213082551956177
Epoch: 12, Steps: 32 | Train Loss: 0.037 Vali Loss: 13.475 Vali Acc: 0.527 Test Loss: 13.475 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.142167329788208
Epoch: 13, Steps: 32 | Train Loss: 0.002 Vali Loss: 12.538 Vali Acc: 0.489 Test Loss: 12.538 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.120879650115967
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 12.337 Vali Acc: 0.519 Test Loss: 12.337 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.275094747543335
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 12.333 Vali Acc: 0.519 Test Loss: 12.333 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1550281
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.330186605453491
Epoch: 1, Steps: 32 | Train Loss: 4.110 Vali Loss: 5.683 Vali Acc: 0.137 Test Loss: 5.683 Test Acc: 0.137
Validation loss decreased (inf --> -0.137348).  Saving model ...
Epoch: 2 cost time: 8.947788953781128
Epoch: 2, Steps: 32 | Train Loss: 5.748 Vali Loss: 3.847 Vali Acc: 0.427 Test Loss: 3.847 Test Acc: 0.427
Validation loss decreased (-0.137348 --> -0.427442).  Saving model ...
Epoch: 3 cost time: 8.931792736053467
Epoch: 3, Steps: 32 | Train Loss: 3.961 Vali Loss: 4.833 Vali Acc: 0.450 Test Loss: 4.833 Test Acc: 0.450
Validation loss decreased (-0.427442 --> -0.450333).  Saving model ...
Epoch: 4 cost time: 8.848373651504517
Epoch: 4, Steps: 32 | Train Loss: 4.378 Vali Loss: 5.962 Vali Acc: 0.229 Test Loss: 5.962 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.103663682937622
Epoch: 5, Steps: 32 | Train Loss: 1.413 Vali Loss: 9.749 Vali Acc: 0.229 Test Loss: 9.749 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.132985830307007
Epoch: 6, Steps: 32 | Train Loss: 0.937 Vali Loss: 11.394 Vali Acc: 0.481 Test Loss: 11.394 Test Acc: 0.481
Validation loss decreased (-0.450333 --> -0.480802).  Saving model ...
Epoch: 7 cost time: 9.043356895446777
Epoch: 7, Steps: 32 | Train Loss: 0.885 Vali Loss: 9.035 Vali Acc: 0.527 Test Loss: 9.035 Test Acc: 0.527
Validation loss decreased (-0.480802 --> -0.526627).  Saving model ...
Epoch: 8 cost time: 9.003408670425415
Epoch: 8, Steps: 32 | Train Loss: 0.090 Vali Loss: 11.577 Vali Acc: 0.336 Test Loss: 11.577 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.0097815990448
Epoch: 9, Steps: 32 | Train Loss: 0.130 Vali Loss: 10.900 Vali Acc: 0.473 Test Loss: 10.900 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.091650009155273
Epoch: 10, Steps: 32 | Train Loss: 0.049 Vali Loss: 10.522 Vali Acc: 0.389 Test Loss: 10.522 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.149433135986328
Epoch: 11, Steps: 32 | Train Loss: 0.033 Vali Loss: 9.979 Vali Acc: 0.374 Test Loss: 9.979 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.033809661865234
Epoch: 12, Steps: 32 | Train Loss: 0.028 Vali Loss: 12.198 Vali Acc: 0.405 Test Loss: 12.198 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.809953451156616
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.524 Vali Acc: 0.412 Test Loss: 10.524 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.98859453201294
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.628 Vali Acc: 0.427 Test Loss: 10.628 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.125095129013062
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.633 Vali Acc: 0.427 Test Loss: 10.633 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.043309926986694
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.633 Vali Acc: 0.427 Test Loss: 10.633 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.00119924545288
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.624 Vali Acc: 0.427 Test Loss: 10.624 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1478313
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.272074222564697
Epoch: 1, Steps: 32 | Train Loss: 4.022 Vali Loss: 4.189 Vali Acc: 0.412 Test Loss: 4.189 Test Acc: 0.412
Validation loss decreased (inf --> -0.412172).  Saving model ...
Epoch: 2 cost time: 9.1741623878479
Epoch: 2, Steps: 32 | Train Loss: 3.561 Vali Loss: 4.269 Vali Acc: 0.160 Test Loss: 4.269 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.100935697555542
Epoch: 3, Steps: 32 | Train Loss: 5.643 Vali Loss: 6.720 Vali Acc: 0.183 Test Loss: 6.720 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.055861473083496
Epoch: 4, Steps: 32 | Train Loss: 3.925 Vali Loss: 6.211 Vali Acc: 0.435 Test Loss: 6.211 Test Acc: 0.435
Validation loss decreased (-0.412172 --> -0.435052).  Saving model ...
Epoch: 5 cost time: 8.990965843200684
Epoch: 5, Steps: 32 | Train Loss: 0.736 Vali Loss: 8.513 Vali Acc: 0.328 Test Loss: 8.513 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.203640699386597
Epoch: 6, Steps: 32 | Train Loss: 0.747 Vali Loss: 11.019 Vali Acc: 0.519 Test Loss: 11.019 Test Acc: 0.519
Validation loss decreased (-0.435052 --> -0.518974).  Saving model ...
Epoch: 7 cost time: 9.204867839813232
Epoch: 7, Steps: 32 | Train Loss: 0.282 Vali Loss: 9.847 Vali Acc: 0.344 Test Loss: 9.847 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.849520444869995
Epoch: 8, Steps: 32 | Train Loss: 0.286 Vali Loss: 8.910 Vali Acc: 0.489 Test Loss: 8.910 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.022133350372314
Epoch: 9, Steps: 32 | Train Loss: 0.385 Vali Loss: 11.708 Vali Acc: 0.466 Test Loss: 11.708 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.003531694412231
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 10.400 Vali Acc: 0.458 Test Loss: 10.400 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.08392333984375
Epoch: 11, Steps: 32 | Train Loss: 0.157 Vali Loss: 13.815 Vali Acc: 0.458 Test Loss: 13.815 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.152035236358643
Epoch: 12, Steps: 32 | Train Loss: 0.116 Vali Loss: 11.367 Vali Acc: 0.405 Test Loss: 11.367 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.887273788452148
Epoch: 13, Steps: 32 | Train Loss: 0.033 Vali Loss: 10.957 Vali Acc: 0.504 Test Loss: 10.957 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.882116794586182
Epoch: 14, Steps: 32 | Train Loss: 0.151 Vali Loss: 12.470 Vali Acc: 0.496 Test Loss: 12.470 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.000129699707031
Epoch: 15, Steps: 32 | Train Loss: 0.007 Vali Loss: 12.974 Vali Acc: 0.542 Test Loss: 12.974 Test Acc: 0.542
Validation loss decreased (-0.518974 --> -0.541855).  Saving model ...
Epoch: 16 cost time: 9.172643423080444
Epoch: 16, Steps: 32 | Train Loss: 0.433 Vali Loss: 16.515 Vali Acc: 0.573 Test Loss: 16.515 Test Acc: 0.573
Validation loss decreased (-0.541855 --> -0.572354).  Saving model ...
Epoch: 17 cost time: 9.082257986068726
Epoch: 17, Steps: 32 | Train Loss: 0.027 Vali Loss: 20.611 Vali Acc: 0.511 Test Loss: 20.611 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.873939752578735
Epoch: 18, Steps: 32 | Train Loss: 0.427 Vali Loss: 16.249 Vali Acc: 0.466 Test Loss: 16.249 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.820695877075195
Epoch: 19, Steps: 32 | Train Loss: 0.149 Vali Loss: 22.066 Vali Acc: 0.282 Test Loss: 22.066 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.03960371017456
Epoch: 20, Steps: 32 | Train Loss: 0.645 Vali Loss: 18.928 Vali Acc: 0.351 Test Loss: 18.928 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.021451950073242
Epoch: 21, Steps: 32 | Train Loss: 0.035 Vali Loss: 18.953 Vali Acc: 0.481 Test Loss: 18.953 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.116980791091919
Epoch: 22, Steps: 32 | Train Loss: 0.093 Vali Loss: 22.579 Vali Acc: 0.496 Test Loss: 22.579 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.023073673248291
Epoch: 23, Steps: 32 | Train Loss: 0.238 Vali Loss: 18.845 Vali Acc: 0.443 Test Loss: 18.845 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.929802656173706
Epoch: 24, Steps: 32 | Train Loss: 0.156 Vali Loss: 21.864 Vali Acc: 0.412 Test Loss: 21.864 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.908356666564941
Epoch: 25, Steps: 32 | Train Loss: 0.172 Vali Loss: 20.149 Vali Acc: 0.458 Test Loss: 20.149 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.032493591308594
Epoch: 26, Steps: 32 | Train Loss: 0.327 Vali Loss: 23.191 Vali Acc: 0.405 Test Loss: 23.191 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1406345
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.148273229598999
Epoch: 1, Steps: 32 | Train Loss: 3.275 Vali Loss: 2.592 Vali Acc: 0.099 Test Loss: 2.592 Test Acc: 0.099
Validation loss decreased (inf --> -0.099211).  Saving model ...
Epoch: 2 cost time: 8.564306020736694
Epoch: 2, Steps: 32 | Train Loss: 5.283 Vali Loss: 5.670 Vali Acc: 0.435 Test Loss: 5.670 Test Acc: 0.435
Validation loss decreased (-0.099211 --> -0.435058).  Saving model ...
Epoch: 3 cost time: 8.502153873443604
Epoch: 3, Steps: 32 | Train Loss: 3.798 Vali Loss: 4.664 Vali Acc: 0.244 Test Loss: 4.664 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.605885028839111
Epoch: 4, Steps: 32 | Train Loss: 1.686 Vali Loss: 8.346 Vali Acc: 0.481 Test Loss: 8.346 Test Acc: 0.481
Validation loss decreased (-0.435058 --> -0.480833).  Saving model ...
Epoch: 5 cost time: 8.617960929870605
Epoch: 5, Steps: 32 | Train Loss: 1.976 Vali Loss: 7.320 Vali Acc: 0.473 Test Loss: 7.320 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.573176145553589
Epoch: 6, Steps: 32 | Train Loss: 0.362 Vali Loss: 8.537 Vali Acc: 0.527 Test Loss: 8.537 Test Acc: 0.527
Validation loss decreased (-0.480833 --> -0.526632).  Saving model ...
Epoch: 7 cost time: 8.590759515762329
Epoch: 7, Steps: 32 | Train Loss: 0.571 Vali Loss: 10.228 Vali Acc: 0.511 Test Loss: 10.228 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.647610187530518
Epoch: 8, Steps: 32 | Train Loss: 0.232 Vali Loss: 9.920 Vali Acc: 0.420 Test Loss: 9.920 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.562650203704834
Epoch: 9, Steps: 32 | Train Loss: 0.072 Vali Loss: 9.044 Vali Acc: 0.427 Test Loss: 9.044 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.660043478012085
Epoch: 10, Steps: 32 | Train Loss: 0.118 Vali Loss: 9.418 Vali Acc: 0.511 Test Loss: 9.418 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.710368871688843
Epoch: 11, Steps: 32 | Train Loss: 0.055 Vali Loss: 12.231 Vali Acc: 0.519 Test Loss: 12.231 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.769484519958496
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.685 Vali Acc: 0.481 Test Loss: 9.685 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.75794243812561
Epoch: 13, Steps: 32 | Train Loss: 0.015 Vali Loss: 10.408 Vali Acc: 0.519 Test Loss: 10.408 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.836960554122925
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.732 Vali Acc: 0.489 Test Loss: 10.732 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.65366816520691
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.756 Vali Acc: 0.489 Test Loss: 10.756 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.732297897338867
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.743 Vali Acc: 0.489 Test Loss: 10.743 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1334377
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.73866319656372
Epoch: 1, Steps: 32 | Train Loss: 3.277 Vali Loss: 3.507 Vali Acc: 0.122 Test Loss: 3.507 Test Acc: 0.122
Validation loss decreased (inf --> -0.122102).  Saving model ...
Epoch: 2 cost time: 9.174787998199463
Epoch: 2, Steps: 32 | Train Loss: 4.192 Vali Loss: 4.888 Vali Acc: 0.160 Test Loss: 4.888 Test Acc: 0.160
Validation loss decreased (-0.122102 --> -0.160256).  Saving model ...
Epoch: 3 cost time: 8.847831010818481
Epoch: 3, Steps: 32 | Train Loss: 5.170 Vali Loss: 4.226 Vali Acc: 0.160 Test Loss: 4.226 Test Acc: 0.160
Validation loss decreased (-0.160256 --> -0.160263).  Saving model ...
Epoch: 4 cost time: 8.849025011062622
Epoch: 4, Steps: 32 | Train Loss: 2.127 Vali Loss: 8.623 Vali Acc: 0.229 Test Loss: 8.623 Test Acc: 0.229
Validation loss decreased (-0.160263 --> -0.228921).  Saving model ...
Epoch: 5 cost time: 8.999431610107422
Epoch: 5, Steps: 32 | Train Loss: 1.714 Vali Loss: 7.012 Vali Acc: 0.489 Test Loss: 7.012 Test Acc: 0.489
Validation loss decreased (-0.228921 --> -0.488479).  Saving model ...
Epoch: 6 cost time: 8.967749118804932
Epoch: 6, Steps: 32 | Train Loss: 1.364 Vali Loss: 13.563 Vali Acc: 0.473 Test Loss: 13.563 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.12194561958313
Epoch: 7, Steps: 32 | Train Loss: 0.515 Vali Loss: 10.951 Vali Acc: 0.473 Test Loss: 10.951 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.031620979309082
Epoch: 8, Steps: 32 | Train Loss: 0.512 Vali Loss: 13.281 Vali Acc: 0.458 Test Loss: 13.281 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.962288618087769
Epoch: 9, Steps: 32 | Train Loss: 0.858 Vali Loss: 18.642 Vali Acc: 0.527 Test Loss: 18.642 Test Acc: 0.527
Validation loss decreased (-0.488479 --> -0.526531).  Saving model ...
Epoch: 10 cost time: 8.907445430755615
Epoch: 10, Steps: 32 | Train Loss: 0.092 Vali Loss: 13.661 Vali Acc: 0.504 Test Loss: 13.661 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.883148670196533
Epoch: 11, Steps: 32 | Train Loss: 0.003 Vali Loss: 13.347 Vali Acc: 0.435 Test Loss: 13.347 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.952330350875854
Epoch: 12, Steps: 32 | Train Loss: 0.024 Vali Loss: 12.950 Vali Acc: 0.466 Test Loss: 12.950 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.135912418365479
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.353 Vali Acc: 0.458 Test Loss: 14.353 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.821599006652832
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.368 Vali Acc: 0.435 Test Loss: 14.368 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.96609377861023
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.382 Vali Acc: 0.435 Test Loss: 14.382 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.979808807373047
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.376 Vali Acc: 0.435 Test Loss: 14.376 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.929201602935791
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.372 Vali Acc: 0.435 Test Loss: 14.372 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.042927265167236
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.372 Vali Acc: 0.435 Test Loss: 14.372 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.975975513458252
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.374 Vali Acc: 0.435 Test Loss: 14.374 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1467081
model size : 7.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.149665594100952
Epoch: 1, Steps: 32 | Train Loss: 2.427 Vali Loss: 2.738 Vali Acc: 0.183 Test Loss: 2.738 Test Acc: 0.183
Validation loss decreased (inf --> -0.183179).  Saving model ...
Epoch: 2 cost time: 9.014054775238037
Epoch: 2, Steps: 32 | Train Loss: 4.123 Vali Loss: 3.706 Vali Acc: 0.420 Test Loss: 3.706 Test Acc: 0.420
Validation loss decreased (-0.183179 --> -0.419810).  Saving model ...
Epoch: 3 cost time: 9.00265645980835
Epoch: 3, Steps: 32 | Train Loss: 4.228 Vali Loss: 8.420 Vali Acc: 0.176 Test Loss: 8.420 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.962055444717407
Epoch: 4, Steps: 32 | Train Loss: 5.670 Vali Loss: 8.565 Vali Acc: 0.275 Test Loss: 8.565 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.819733142852783
Epoch: 5, Steps: 32 | Train Loss: 1.528 Vali Loss: 9.822 Vali Acc: 0.511 Test Loss: 9.822 Test Acc: 0.511
Validation loss decreased (-0.419810 --> -0.511352).  Saving model ...
Epoch: 6 cost time: 8.96262001991272
Epoch: 6, Steps: 32 | Train Loss: 0.696 Vali Loss: 7.452 Vali Acc: 0.481 Test Loss: 7.452 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.886540174484253
Epoch: 7, Steps: 32 | Train Loss: 1.816 Vali Loss: 8.886 Vali Acc: 0.466 Test Loss: 8.886 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.001410961151123
Epoch: 8, Steps: 32 | Train Loss: 0.724 Vali Loss: 15.164 Vali Acc: 0.511 Test Loss: 15.164 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.036942720413208
Epoch: 9, Steps: 32 | Train Loss: 0.294 Vali Loss: 10.100 Vali Acc: 0.366 Test Loss: 10.100 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.825369119644165
Epoch: 10, Steps: 32 | Train Loss: 0.772 Vali Loss: 11.657 Vali Acc: 0.527 Test Loss: 11.657 Test Acc: 0.527
Validation loss decreased (-0.511352 --> -0.526601).  Saving model ...
Epoch: 11 cost time: 8.79298710823059
Epoch: 11, Steps: 32 | Train Loss: 0.136 Vali Loss: 14.843 Vali Acc: 0.511 Test Loss: 14.843 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.925733089447021
Epoch: 12, Steps: 32 | Train Loss: 0.141 Vali Loss: 13.604 Vali Acc: 0.511 Test Loss: 13.604 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.820978164672852
Epoch: 13, Steps: 32 | Train Loss: 0.178 Vali Loss: 16.131 Vali Acc: 0.504 Test Loss: 16.131 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.000208139419556
Epoch: 14, Steps: 32 | Train Loss: 0.153 Vali Loss: 19.072 Vali Acc: 0.534 Test Loss: 19.072 Test Acc: 0.534
Validation loss decreased (-0.526601 --> -0.534160).  Saving model ...
Epoch: 15 cost time: 9.131305694580078
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.513 Vali Acc: 0.534 Test Loss: 19.513 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.282094955444336
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.176 Vali Acc: 0.519 Test Loss: 18.176 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.022475957870483
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.252 Vali Acc: 0.519 Test Loss: 18.252 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.963898181915283
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.353 Vali Acc: 0.527 Test Loss: 18.353 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.139581441879272
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.356 Vali Acc: 0.527 Test Loss: 18.356 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.917539119720459
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.356 Vali Acc: 0.527 Test Loss: 18.356 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.935293197631836
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.356 Vali Acc: 0.527 Test Loss: 18.356 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.075756311416626
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.356 Vali Acc: 0.527 Test Loss: 18.356 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.161009550094604
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.355 Vali Acc: 0.527 Test Loss: 18.355 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.875669956207275
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.352 Vali Acc: 0.527 Test Loss: 18.352 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1395113
model size : 7.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.774476528167725
Epoch: 1, Steps: 32 | Train Loss: 3.873 Vali Loss: 9.136 Vali Acc: 0.420 Test Loss: 9.136 Test Acc: 0.420
Validation loss decreased (inf --> -0.419756).  Saving model ...
Epoch: 2 cost time: 8.936159372329712
Epoch: 2, Steps: 32 | Train Loss: 5.882 Vali Loss: 5.521 Vali Acc: 0.275 Test Loss: 5.521 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.939316272735596
Epoch: 3, Steps: 32 | Train Loss: 5.641 Vali Loss: 5.444 Vali Acc: 0.466 Test Loss: 5.444 Test Acc: 0.466
Validation loss decreased (-0.419756 --> -0.465594).  Saving model ...
Epoch: 4 cost time: 9.1026771068573
Epoch: 4, Steps: 32 | Train Loss: 2.127 Vali Loss: 4.891 Vali Acc: 0.229 Test Loss: 4.891 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.055991172790527
Epoch: 5, Steps: 32 | Train Loss: 1.845 Vali Loss: 7.296 Vali Acc: 0.511 Test Loss: 7.296 Test Acc: 0.511
Validation loss decreased (-0.465594 --> -0.511377).  Saving model ...
Epoch: 6 cost time: 8.92487120628357
Epoch: 6, Steps: 32 | Train Loss: 0.498 Vali Loss: 8.287 Vali Acc: 0.412 Test Loss: 8.287 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.02859377861023
Epoch: 7, Steps: 32 | Train Loss: 0.540 Vali Loss: 6.629 Vali Acc: 0.412 Test Loss: 6.629 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.993241786956787
Epoch: 8, Steps: 32 | Train Loss: 0.146 Vali Loss: 9.752 Vali Acc: 0.489 Test Loss: 9.752 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.858672380447388
Epoch: 9, Steps: 32 | Train Loss: 0.089 Vali Loss: 8.011 Vali Acc: 0.450 Test Loss: 8.011 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.967729568481445
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.091 Vali Acc: 0.504 Test Loss: 8.091 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.849223852157593
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.829 Vali Acc: 0.466 Test Loss: 7.829 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.981850147247314
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.833 Vali Acc: 0.458 Test Loss: 7.833 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.10209846496582
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.815 Vali Acc: 0.458 Test Loss: 7.815 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.031810998916626
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.807 Vali Acc: 0.458 Test Loss: 7.807 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.957037210464478
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.810 Vali Acc: 0.458 Test Loss: 7.810 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1323145
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.959304571151733
Epoch: 1, Steps: 32 | Train Loss: 3.242 Vali Loss: 4.454 Vali Acc: 0.176 Test Loss: 4.454 Test Acc: 0.176
Validation loss decreased (inf --> -0.175528).  Saving model ...
Epoch: 2 cost time: 8.549008131027222
Epoch: 2, Steps: 32 | Train Loss: 4.343 Vali Loss: 3.573 Vali Acc: 0.099 Test Loss: 3.573 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.547269582748413
Epoch: 3, Steps: 32 | Train Loss: 4.941 Vali Loss: 6.188 Vali Acc: 0.481 Test Loss: 6.188 Test Acc: 0.481
Validation loss decreased (-0.175528 --> -0.480854).  Saving model ...
Epoch: 4 cost time: 8.57582974433899
Epoch: 4, Steps: 32 | Train Loss: 2.089 Vali Loss: 4.389 Vali Acc: 0.321 Test Loss: 4.389 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.571900844573975
Epoch: 5, Steps: 32 | Train Loss: 0.650 Vali Loss: 5.547 Vali Acc: 0.481 Test Loss: 5.547 Test Acc: 0.481
Validation loss decreased (-0.480854 --> -0.480861).  Saving model ...
Epoch: 6 cost time: 8.599183320999146
Epoch: 6, Steps: 32 | Train Loss: 0.969 Vali Loss: 6.087 Vali Acc: 0.397 Test Loss: 6.087 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.595401287078857
Epoch: 7, Steps: 32 | Train Loss: 0.195 Vali Loss: 7.713 Vali Acc: 0.435 Test Loss: 7.713 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.79992151260376
Epoch: 8, Steps: 32 | Train Loss: 0.345 Vali Loss: 13.934 Vali Acc: 0.489 Test Loss: 13.934 Test Acc: 0.489
Validation loss decreased (-0.480861 --> -0.488410).  Saving model ...
Epoch: 9 cost time: 8.55385160446167
Epoch: 9, Steps: 32 | Train Loss: 0.193 Vali Loss: 9.591 Vali Acc: 0.450 Test Loss: 9.591 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.652040719985962
Epoch: 10, Steps: 32 | Train Loss: 0.450 Vali Loss: 10.864 Vali Acc: 0.466 Test Loss: 10.864 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.780222654342651
Epoch: 11, Steps: 32 | Train Loss: 0.427 Vali Loss: 10.984 Vali Acc: 0.313 Test Loss: 10.984 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.631673574447632
Epoch: 12, Steps: 32 | Train Loss: 0.100 Vali Loss: 9.848 Vali Acc: 0.397 Test Loss: 9.848 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.497299909591675
Epoch: 13, Steps: 32 | Train Loss: 0.476 Vali Loss: 13.158 Vali Acc: 0.489 Test Loss: 13.158 Test Acc: 0.489
Validation loss decreased (-0.488410 --> -0.488418).  Saving model ...
Epoch: 14 cost time: 8.6449716091156
Epoch: 14, Steps: 32 | Train Loss: 0.070 Vali Loss: 12.481 Vali Acc: 0.382 Test Loss: 12.481 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.921991109848022
Epoch: 15, Steps: 32 | Train Loss: 0.009 Vali Loss: 14.696 Vali Acc: 0.511 Test Loss: 14.696 Test Acc: 0.511
Validation loss decreased (-0.488418 --> -0.511303).  Saving model ...
Epoch: 16 cost time: 8.764549970626831
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.033 Vali Acc: 0.511 Test Loss: 15.033 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.750472068786621
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.045 Vali Acc: 0.511 Test Loss: 15.045 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.551395893096924
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.045 Vali Acc: 0.511 Test Loss: 15.045 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.820655584335327
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.044 Vali Acc: 0.511 Test Loss: 15.044 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.783967971801758
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.045 Vali Acc: 0.511 Test Loss: 15.045 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.031836032867432
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.048 Vali Acc: 0.511 Test Loss: 15.048 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.771174907684326
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.049 Vali Acc: 0.511 Test Loss: 15.049 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.81077265739441
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.050 Vali Acc: 0.511 Test Loss: 15.050 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.600801706314087
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.051 Vali Acc: 0.511 Test Loss: 15.051 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.076619148254395
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.049 Vali Acc: 0.511 Test Loss: 15.049 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1251177
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.717390775680542
Epoch: 1, Steps: 32 | Train Loss: 2.395 Vali Loss: 2.657 Vali Acc: 0.420 Test Loss: 2.657 Test Acc: 0.420
Validation loss decreased (inf --> -0.419821).  Saving model ...
Epoch: 2 cost time: 9.013649940490723
Epoch: 2, Steps: 32 | Train Loss: 4.059 Vali Loss: 9.752 Vali Acc: 0.176 Test Loss: 9.752 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.915489673614502
Epoch: 3, Steps: 32 | Train Loss: 3.582 Vali Loss: 3.216 Vali Acc: 0.206 Test Loss: 3.216 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.98656153678894
Epoch: 4, Steps: 32 | Train Loss: 2.167 Vali Loss: 7.122 Vali Acc: 0.443 Test Loss: 7.122 Test Acc: 0.443
Validation loss decreased (-0.419821 --> -0.442677).  Saving model ...
Epoch: 5 cost time: 8.816429615020752
Epoch: 5, Steps: 32 | Train Loss: 2.586 Vali Loss: 9.369 Vali Acc: 0.244 Test Loss: 9.369 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.836999893188477
Epoch: 6, Steps: 32 | Train Loss: 1.261 Vali Loss: 10.444 Vali Acc: 0.382 Test Loss: 10.444 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.95835256576538
Epoch: 7, Steps: 32 | Train Loss: 0.377 Vali Loss: 9.535 Vali Acc: 0.473 Test Loss: 9.535 Test Acc: 0.473
Validation loss decreased (-0.442677 --> -0.473187).  Saving model ...
Epoch: 8 cost time: 9.077154874801636
Epoch: 8, Steps: 32 | Train Loss: 0.357 Vali Loss: 9.301 Vali Acc: 0.374 Test Loss: 9.301 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.710461854934692
Epoch: 9, Steps: 32 | Train Loss: 0.004 Vali Loss: 9.761 Vali Acc: 0.420 Test Loss: 9.761 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.89095687866211
Epoch: 10, Steps: 32 | Train Loss: 0.364 Vali Loss: 10.119 Vali Acc: 0.458 Test Loss: 10.119 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.973889350891113
Epoch: 11, Steps: 32 | Train Loss: 0.685 Vali Loss: 10.886 Vali Acc: 0.519 Test Loss: 10.886 Test Acc: 0.519
Validation loss decreased (-0.473187 --> -0.518975).  Saving model ...
Epoch: 12 cost time: 8.998110294342041
Epoch: 12, Steps: 32 | Train Loss: 0.298 Vali Loss: 14.782 Vali Acc: 0.351 Test Loss: 14.782 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.005463600158691
Epoch: 13, Steps: 32 | Train Loss: 0.159 Vali Loss: 13.417 Vali Acc: 0.473 Test Loss: 13.417 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.947152376174927
Epoch: 14, Steps: 32 | Train Loss: 0.122 Vali Loss: 14.441 Vali Acc: 0.527 Test Loss: 14.441 Test Acc: 0.527
Validation loss decreased (-0.518975 --> -0.526573).  Saving model ...
Epoch: 15 cost time: 8.778276443481445
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.582 Vali Acc: 0.527 Test Loss: 14.582 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.119884014129639
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.678 Vali Acc: 0.504 Test Loss: 13.678 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.88071870803833
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.636 Vali Acc: 0.496 Test Loss: 13.636 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.245540380477905
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.634 Vali Acc: 0.496 Test Loss: 13.634 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.02910304069519
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.634 Vali Acc: 0.496 Test Loss: 13.634 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.860981225967407
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.634 Vali Acc: 0.496 Test Loss: 13.634 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.907870054244995
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.634 Vali Acc: 0.496 Test Loss: 13.634 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.023044347763062
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.635 Vali Acc: 0.496 Test Loss: 13.635 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.084430456161499
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.635 Vali Acc: 0.496 Test Loss: 13.635 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.824194431304932
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.634 Vali Acc: 0.496 Test Loss: 13.634 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1425481
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.042536735534668
Epoch: 1, Steps: 32 | Train Loss: 2.507 Vali Loss: 4.394 Vali Acc: 0.420 Test Loss: 4.394 Test Acc: 0.420
Validation loss decreased (inf --> -0.419803).  Saving model ...
Epoch: 2 cost time: 9.027352333068848
Epoch: 2, Steps: 32 | Train Loss: 7.322 Vali Loss: 7.171 Vali Acc: 0.168 Test Loss: 7.171 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.068169832229614
Epoch: 3, Steps: 32 | Train Loss: 3.671 Vali Loss: 7.514 Vali Acc: 0.099 Test Loss: 7.514 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.161200046539307
Epoch: 4, Steps: 32 | Train Loss: 4.075 Vali Loss: 13.348 Vali Acc: 0.183 Test Loss: 13.348 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.81986951828003
Epoch: 5, Steps: 32 | Train Loss: 4.849 Vali Loss: 10.469 Vali Acc: 0.275 Test Loss: 10.469 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.050143718719482
Epoch: 6, Steps: 32 | Train Loss: 2.044 Vali Loss: 8.890 Vali Acc: 0.328 Test Loss: 8.890 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.741048336029053
Epoch: 7, Steps: 32 | Train Loss: 0.672 Vali Loss: 11.217 Vali Acc: 0.511 Test Loss: 11.217 Test Acc: 0.511
Validation loss decreased (-0.419803 --> -0.511338).  Saving model ...
Epoch: 8 cost time: 8.873700618743896
Epoch: 8, Steps: 32 | Train Loss: 0.443 Vali Loss: 9.811 Vali Acc: 0.481 Test Loss: 9.811 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.956374645233154
Epoch: 9, Steps: 32 | Train Loss: 0.999 Vali Loss: 12.266 Vali Acc: 0.466 Test Loss: 12.266 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.037231922149658
Epoch: 10, Steps: 32 | Train Loss: 0.806 Vali Loss: 10.641 Vali Acc: 0.450 Test Loss: 10.641 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.956328630447388
Epoch: 11, Steps: 32 | Train Loss: 0.201 Vali Loss: 10.248 Vali Acc: 0.458 Test Loss: 10.248 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.855917692184448
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.210 Vali Acc: 0.443 Test Loss: 10.210 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.838160753250122
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.224 Vali Acc: 0.443 Test Loss: 10.224 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.79625916481018
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.256 Vali Acc: 0.443 Test Loss: 10.256 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.064307451248169
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.249 Vali Acc: 0.443 Test Loss: 10.249 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.985674381256104
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.242 Vali Acc: 0.443 Test Loss: 10.242 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.13019061088562
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.254 Vali Acc: 0.443 Test Loss: 10.254 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1353513
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.491579532623291
Epoch: 1, Steps: 32 | Train Loss: 2.536 Vali Loss: 6.171 Vali Acc: 0.176 Test Loss: 6.171 Test Acc: 0.176
Validation loss decreased (inf --> -0.175511).  Saving model ...
Epoch: 2 cost time: 8.931519746780396
Epoch: 2, Steps: 32 | Train Loss: 4.165 Vali Loss: 4.902 Vali Acc: 0.191 Test Loss: 4.902 Test Acc: 0.191
Validation loss decreased (-0.175511 --> -0.190791).  Saving model ...
Epoch: 3 cost time: 9.035778760910034
Epoch: 3, Steps: 32 | Train Loss: 3.622 Vali Loss: 9.534 Vali Acc: 0.122 Test Loss: 9.534 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.997461318969727
Epoch: 4, Steps: 32 | Train Loss: 4.055 Vali Loss: 12.649 Vali Acc: 0.435 Test Loss: 12.649 Test Acc: 0.435
Validation loss decreased (-0.190791 --> -0.434988).  Saving model ...
Epoch: 5 cost time: 9.124227285385132
Epoch: 5, Steps: 32 | Train Loss: 1.750 Vali Loss: 5.817 Vali Acc: 0.427 Test Loss: 5.817 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.642625570297241
Epoch: 6, Steps: 32 | Train Loss: 1.287 Vali Loss: 7.634 Vali Acc: 0.290 Test Loss: 7.634 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.810885190963745
Epoch: 7, Steps: 32 | Train Loss: 1.147 Vali Loss: 9.220 Vali Acc: 0.489 Test Loss: 9.220 Test Acc: 0.489
Validation loss decreased (-0.434988 --> -0.488457).  Saving model ...
Epoch: 8 cost time: 9.221979141235352
Epoch: 8, Steps: 32 | Train Loss: 0.256 Vali Loss: 7.819 Vali Acc: 0.389 Test Loss: 7.819 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.063213109970093
Epoch: 9, Steps: 32 | Train Loss: 0.252 Vali Loss: 8.353 Vali Acc: 0.374 Test Loss: 8.353 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.264930248260498
Epoch: 10, Steps: 32 | Train Loss: 0.167 Vali Loss: 11.540 Vali Acc: 0.427 Test Loss: 11.540 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.341442584991455
Epoch: 11, Steps: 32 | Train Loss: 0.121 Vali Loss: 15.085 Vali Acc: 0.527 Test Loss: 15.085 Test Acc: 0.527
Validation loss decreased (-0.488457 --> -0.526567).  Saving model ...
Epoch: 12 cost time: 8.94876742362976
Epoch: 12, Steps: 32 | Train Loss: 0.118 Vali Loss: 10.107 Vali Acc: 0.405 Test Loss: 10.107 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.983352184295654
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.645 Vali Acc: 0.427 Test Loss: 10.645 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.022193431854248
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.667 Vali Acc: 0.427 Test Loss: 10.667 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.25473427772522
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.632 Vali Acc: 0.435 Test Loss: 10.632 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.839919567108154
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.627 Vali Acc: 0.435 Test Loss: 10.627 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.064894199371338
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.632 Vali Acc: 0.435 Test Loss: 10.632 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.194292306900024
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.633 Vali Acc: 0.435 Test Loss: 10.633 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.014728784561157
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.637 Vali Acc: 0.435 Test Loss: 10.637 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.004182577133179
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.640 Vali Acc: 0.435 Test Loss: 10.640 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.91152286529541
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.644 Vali Acc: 0.435 Test Loss: 10.644 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1281545
model size : 7.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.961596012115479
Epoch: 1, Steps: 32 | Train Loss: 3.935 Vali Loss: 4.080 Vali Acc: 0.137 Test Loss: 4.080 Test Acc: 0.137
Validation loss decreased (inf --> -0.137364).  Saving model ...
Epoch: 2 cost time: 8.566638946533203
Epoch: 2, Steps: 32 | Train Loss: 6.378 Vali Loss: 5.929 Vali Acc: 0.427 Test Loss: 5.929 Test Acc: 0.427
Validation loss decreased (-0.137364 --> -0.427422).  Saving model ...
Epoch: 3 cost time: 8.560208082199097
Epoch: 3, Steps: 32 | Train Loss: 5.249 Vali Loss: 9.954 Vali Acc: 0.168 Test Loss: 9.954 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.596118927001953
Epoch: 4, Steps: 32 | Train Loss: 5.058 Vali Loss: 8.797 Vali Acc: 0.206 Test Loss: 8.797 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.453171491622925
Epoch: 5, Steps: 32 | Train Loss: 2.612 Vali Loss: 7.505 Vali Acc: 0.244 Test Loss: 7.505 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.44003963470459
Epoch: 6, Steps: 32 | Train Loss: 0.716 Vali Loss: 11.625 Vali Acc: 0.504 Test Loss: 11.625 Test Acc: 0.504
Validation loss decreased (-0.427422 --> -0.503701).  Saving model ...
Epoch: 7 cost time: 8.938636302947998
Epoch: 7, Steps: 32 | Train Loss: 0.596 Vali Loss: 9.061 Vali Acc: 0.435 Test Loss: 9.061 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.588675498962402
Epoch: 8, Steps: 32 | Train Loss: 0.375 Vali Loss: 10.716 Vali Acc: 0.511 Test Loss: 10.716 Test Acc: 0.511
Validation loss decreased (-0.503701 --> -0.511343).  Saving model ...
Epoch: 9 cost time: 8.441489696502686
Epoch: 9, Steps: 32 | Train Loss: 0.250 Vali Loss: 11.816 Vali Acc: 0.519 Test Loss: 11.816 Test Acc: 0.519
Validation loss decreased (-0.511343 --> -0.518966).  Saving model ...
Epoch: 10 cost time: 8.549566268920898
Epoch: 10, Steps: 32 | Train Loss: 1.109 Vali Loss: 11.710 Vali Acc: 0.458 Test Loss: 11.710 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.508155107498169
Epoch: 11, Steps: 32 | Train Loss: 0.152 Vali Loss: 12.892 Vali Acc: 0.466 Test Loss: 12.892 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.565454483032227
Epoch: 12, Steps: 32 | Train Loss: 0.141 Vali Loss: 12.224 Vali Acc: 0.496 Test Loss: 12.224 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.566945791244507
Epoch: 13, Steps: 32 | Train Loss: 0.027 Vali Loss: 14.110 Vali Acc: 0.489 Test Loss: 14.110 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.657227039337158
Epoch: 14, Steps: 32 | Train Loss: 0.058 Vali Loss: 14.902 Vali Acc: 0.511 Test Loss: 14.902 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.503720760345459
Epoch: 15, Steps: 32 | Train Loss: 0.002 Vali Loss: 12.566 Vali Acc: 0.511 Test Loss: 12.566 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.44406270980835
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.161 Vali Acc: 0.504 Test Loss: 13.161 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.545928239822388
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.759 Vali Acc: 0.504 Test Loss: 13.759 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.647557258605957
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.081 Vali Acc: 0.511 Test Loss: 13.081 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.712029933929443
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 12.913 Vali Acc: 0.511 Test Loss: 12.913 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1209577
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.020363092422485
Epoch: 1, Steps: 32 | Train Loss: 36.297 Vali Loss: 58.222 Vali Acc: 0.191 Test Loss: 58.222 Test Acc: 0.191
Validation loss decreased (inf --> -0.190257).  Saving model ...
Epoch: 2 cost time: 9.512266397476196
Epoch: 2, Steps: 32 | Train Loss: 71.261 Vali Loss: 122.262 Vali Acc: 0.153 Test Loss: 122.262 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.412323951721191
Epoch: 3, Steps: 32 | Train Loss: 46.120 Vali Loss: 53.095 Vali Acc: 0.458 Test Loss: 53.095 Test Acc: 0.458
Validation loss decreased (-0.190257 --> -0.457484).  Saving model ...
Epoch: 4 cost time: 9.737565040588379
Epoch: 4, Steps: 32 | Train Loss: 16.057 Vali Loss: 78.511 Vali Acc: 0.466 Test Loss: 78.511 Test Acc: 0.466
Validation loss decreased (-0.457484 --> -0.464864).  Saving model ...
Epoch: 5 cost time: 9.523436546325684
Epoch: 5, Steps: 32 | Train Loss: 18.097 Vali Loss: 103.150 Vali Acc: 0.290 Test Loss: 103.150 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.544579029083252
Epoch: 6, Steps: 32 | Train Loss: 19.851 Vali Loss: 95.714 Vali Acc: 0.527 Test Loss: 95.714 Test Acc: 0.527
Validation loss decreased (-0.464864 --> -0.525760).  Saving model ...
Epoch: 7 cost time: 9.643802404403687
Epoch: 7, Steps: 32 | Train Loss: 17.124 Vali Loss: 103.840 Vali Acc: 0.534 Test Loss: 103.840 Test Acc: 0.534
Validation loss decreased (-0.525760 --> -0.533313).  Saving model ...
Epoch: 8 cost time: 9.521076679229736
Epoch: 8, Steps: 32 | Train Loss: 5.650 Vali Loss: 101.896 Vali Acc: 0.534 Test Loss: 101.896 Test Acc: 0.534
Validation loss decreased (-0.533313 --> -0.533332).  Saving model ...
Epoch: 9 cost time: 9.532787322998047
Epoch: 9, Steps: 32 | Train Loss: 5.497 Vali Loss: 90.018 Vali Acc: 0.481 Test Loss: 90.018 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.654099225997925
Epoch: 10, Steps: 32 | Train Loss: 0.819 Vali Loss: 107.869 Vali Acc: 0.534 Test Loss: 107.869 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.578075885772705
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.322 Vali Acc: 0.527 Test Loss: 105.322 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.7665433883667
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.643 Vali Acc: 0.519 Test Loss: 106.643 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.594599485397339
Epoch: 13, Steps: 32 | Train Loss: 0.118 Vali Loss: 121.595 Vali Acc: 0.496 Test Loss: 121.595 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.509433507919312
Epoch: 14, Steps: 32 | Train Loss: 0.421 Vali Loss: 118.032 Vali Acc: 0.496 Test Loss: 118.032 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.72053337097168
Epoch: 15, Steps: 32 | Train Loss: 6.740 Vali Loss: 164.966 Vali Acc: 0.473 Test Loss: 164.966 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.776557207107544
Epoch: 16, Steps: 32 | Train Loss: 1.435 Vali Loss: 202.152 Vali Acc: 0.450 Test Loss: 202.152 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.664204359054565
Epoch: 17, Steps: 32 | Train Loss: 3.844 Vali Loss: 216.362 Vali Acc: 0.443 Test Loss: 216.362 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.739412307739258
Epoch: 18, Steps: 32 | Train Loss: 5.148 Vali Loss: 210.272 Vali Acc: 0.389 Test Loss: 210.272 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 20103197
model size : 94.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.013854265213013
Epoch: 1, Steps: 32 | Train Loss: 24.957 Vali Loss: 80.806 Vali Acc: 0.420 Test Loss: 80.806 Test Acc: 0.420
Validation loss decreased (inf --> -0.419039).  Saving model ...
Epoch: 2 cost time: 9.847681760787964
Epoch: 2, Steps: 32 | Train Loss: 123.249 Vali Loss: 61.117 Vali Acc: 0.466 Test Loss: 61.117 Test Acc: 0.466
Validation loss decreased (-0.419039 --> -0.465038).  Saving model ...
Epoch: 3 cost time: 9.666256427764893
Epoch: 3, Steps: 32 | Train Loss: 32.912 Vali Loss: 70.088 Vali Acc: 0.504 Test Loss: 70.088 Test Acc: 0.504
Validation loss decreased (-0.465038 --> -0.503116).  Saving model ...
Epoch: 4 cost time: 9.726778507232666
Epoch: 4, Steps: 32 | Train Loss: 22.598 Vali Loss: 74.299 Vali Acc: 0.489 Test Loss: 74.299 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.625518798828125
Epoch: 5, Steps: 32 | Train Loss: 8.180 Vali Loss: 113.275 Vali Acc: 0.504 Test Loss: 113.275 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.494675159454346
Epoch: 6, Steps: 32 | Train Loss: 4.282 Vali Loss: 72.318 Vali Acc: 0.511 Test Loss: 72.318 Test Acc: 0.511
Validation loss decreased (-0.503116 --> -0.510727).  Saving model ...
Epoch: 7 cost time: 9.536969423294067
Epoch: 7, Steps: 32 | Train Loss: 1.259 Vali Loss: 114.437 Vali Acc: 0.458 Test Loss: 114.437 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.629594087600708
Epoch: 8, Steps: 32 | Train Loss: 3.445 Vali Loss: 125.093 Vali Acc: 0.496 Test Loss: 125.093 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.5025315284729
Epoch: 9, Steps: 32 | Train Loss: 9.150 Vali Loss: 147.224 Vali Acc: 0.534 Test Loss: 147.224 Test Acc: 0.534
Validation loss decreased (-0.510727 --> -0.532879).  Saving model ...
Epoch: 10 cost time: 9.755840301513672
Epoch: 10, Steps: 32 | Train Loss: 7.465 Vali Loss: 192.817 Vali Acc: 0.489 Test Loss: 192.817 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.617053985595703
Epoch: 11, Steps: 32 | Train Loss: 10.262 Vali Loss: 131.689 Vali Acc: 0.405 Test Loss: 131.689 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.511668682098389
Epoch: 12, Steps: 32 | Train Loss: 1.857 Vali Loss: 169.700 Vali Acc: 0.550 Test Loss: 169.700 Test Acc: 0.550
Validation loss decreased (-0.532879 --> -0.547921).  Saving model ...
Epoch: 13 cost time: 9.493250131607056
Epoch: 13, Steps: 32 | Train Loss: 2.769 Vali Loss: 137.608 Vali Acc: 0.489 Test Loss: 137.608 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.594391107559204
Epoch: 14, Steps: 32 | Train Loss: 0.860 Vali Loss: 158.764 Vali Acc: 0.443 Test Loss: 158.764 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.561775922775269
Epoch: 15, Steps: 32 | Train Loss: 0.587 Vali Loss: 151.223 Vali Acc: 0.458 Test Loss: 151.223 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.611003637313843
Epoch: 16, Steps: 32 | Train Loss: 2.926 Vali Loss: 160.391 Vali Acc: 0.443 Test Loss: 160.391 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.67989706993103
Epoch: 17, Steps: 32 | Train Loss: 5.712 Vali Loss: 192.714 Vali Acc: 0.527 Test Loss: 192.714 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.504571914672852
Epoch: 18, Steps: 32 | Train Loss: 2.537 Vali Loss: 172.029 Vali Acc: 0.511 Test Loss: 172.029 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.585881233215332
Epoch: 19, Steps: 32 | Train Loss: 0.679 Vali Loss: 167.474 Vali Acc: 0.382 Test Loss: 167.474 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.479736328125
Epoch: 20, Steps: 32 | Train Loss: 2.093 Vali Loss: 160.765 Vali Acc: 0.427 Test Loss: 160.765 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.483816862106323
Epoch: 21, Steps: 32 | Train Loss: 4.725 Vali Loss: 187.189 Vali Acc: 0.519 Test Loss: 187.189 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.647669076919556
Epoch: 22, Steps: 32 | Train Loss: 2.388 Vali Loss: 224.287 Vali Acc: 0.328 Test Loss: 224.287 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 19719453
model size : 92.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.737807750701904
Epoch: 1, Steps: 32 | Train Loss: 44.025 Vali Loss: 35.208 Vali Acc: 0.420 Test Loss: 35.208 Test Acc: 0.420
Validation loss decreased (inf --> -0.419495).  Saving model ...
Epoch: 2 cost time: 9.343374490737915
Epoch: 2, Steps: 32 | Train Loss: 80.121 Vali Loss: 189.719 Vali Acc: 0.137 Test Loss: 189.719 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.504959344863892
Epoch: 3, Steps: 32 | Train Loss: 82.517 Vali Loss: 53.840 Vali Acc: 0.405 Test Loss: 53.840 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.355806589126587
Epoch: 4, Steps: 32 | Train Loss: 18.925 Vali Loss: 74.174 Vali Acc: 0.389 Test Loss: 74.174 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.638194799423218
Epoch: 5, Steps: 32 | Train Loss: 11.325 Vali Loss: 102.951 Vali Acc: 0.519 Test Loss: 102.951 Test Acc: 0.519
Validation loss decreased (-0.419495 --> -0.518054).  Saving model ...
Epoch: 6 cost time: 9.703850030899048
Epoch: 6, Steps: 32 | Train Loss: 9.354 Vali Loss: 116.508 Vali Acc: 0.443 Test Loss: 116.508 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.638617038726807
Epoch: 7, Steps: 32 | Train Loss: 4.977 Vali Loss: 146.399 Vali Acc: 0.542 Test Loss: 146.399 Test Acc: 0.542
Validation loss decreased (-0.518054 --> -0.540521).  Saving model ...
Epoch: 8 cost time: 9.63308072090149
Epoch: 8, Steps: 32 | Train Loss: 4.722 Vali Loss: 124.923 Vali Acc: 0.527 Test Loss: 124.923 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.770138263702393
Epoch: 9, Steps: 32 | Train Loss: 3.468 Vali Loss: 132.531 Vali Acc: 0.496 Test Loss: 132.531 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.502264738082886
Epoch: 10, Steps: 32 | Train Loss: 0.289 Vali Loss: 135.303 Vali Acc: 0.496 Test Loss: 135.303 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.47451138496399
Epoch: 11, Steps: 32 | Train Loss: 0.893 Vali Loss: 134.416 Vali Acc: 0.496 Test Loss: 134.416 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.70677924156189
Epoch: 12, Steps: 32 | Train Loss: 0.148 Vali Loss: 140.221 Vali Acc: 0.496 Test Loss: 140.221 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.746806859970093
Epoch: 13, Steps: 32 | Train Loss: 0.521 Vali Loss: 142.257 Vali Acc: 0.420 Test Loss: 142.257 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.42839527130127
Epoch: 14, Steps: 32 | Train Loss: 2.253 Vali Loss: 175.983 Vali Acc: 0.466 Test Loss: 175.983 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.676984548568726
Epoch: 15, Steps: 32 | Train Loss: 8.746 Vali Loss: 159.231 Vali Acc: 0.504 Test Loss: 159.231 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.516099214553833
Epoch: 16, Steps: 32 | Train Loss: 0.452 Vali Loss: 176.220 Vali Acc: 0.557 Test Loss: 176.220 Test Acc: 0.557
Validation loss decreased (-0.540521 --> -0.555490).  Saving model ...
Epoch: 17 cost time: 9.614388465881348
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 169.007 Vali Acc: 0.511 Test Loss: 169.007 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.586079597473145
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 169.336 Vali Acc: 0.504 Test Loss: 169.336 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.772058725357056
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 169.358 Vali Acc: 0.496 Test Loss: 169.358 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.29912543296814
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 169.351 Vali Acc: 0.496 Test Loss: 169.351 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.226685523986816
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 168.123 Vali Acc: 0.519 Test Loss: 168.123 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.425345420837402
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 167.700 Vali Acc: 0.504 Test Loss: 167.700 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.445533514022827
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 167.702 Vali Acc: 0.504 Test Loss: 167.702 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.63048267364502
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 167.702 Vali Acc: 0.504 Test Loss: 167.702 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.440258979797363
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 167.702 Vali Acc: 0.504 Test Loss: 167.702 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.59424352645874
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 167.702 Vali Acc: 0.504 Test Loss: 167.702 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 19335709
model size : 91.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.477341175079346
Epoch: 1, Steps: 32 | Train Loss: 51.242 Vali Loss: 62.901 Vali Acc: 0.420 Test Loss: 62.901 Test Acc: 0.420
Validation loss decreased (inf --> -0.419218).  Saving model ...
Epoch: 2 cost time: 9.204478025436401
Epoch: 2, Steps: 32 | Train Loss: 66.807 Vali Loss: 83.152 Vali Acc: 0.168 Test Loss: 83.152 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.406339168548584
Epoch: 3, Steps: 32 | Train Loss: 48.856 Vali Loss: 45.797 Vali Acc: 0.450 Test Loss: 45.797 Test Acc: 0.450
Validation loss decreased (-0.419218 --> -0.449924).  Saving model ...
Epoch: 4 cost time: 9.127188682556152
Epoch: 4, Steps: 32 | Train Loss: 19.195 Vali Loss: 76.201 Vali Acc: 0.420 Test Loss: 76.201 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.287147045135498
Epoch: 5, Steps: 32 | Train Loss: 14.273 Vali Loss: 100.186 Vali Acc: 0.511 Test Loss: 100.186 Test Acc: 0.511
Validation loss decreased (-0.449924 --> -0.510449).  Saving model ...
Epoch: 6 cost time: 9.255808353424072
Epoch: 6, Steps: 32 | Train Loss: 10.114 Vali Loss: 105.436 Vali Acc: 0.427 Test Loss: 105.436 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.121551990509033
Epoch: 7, Steps: 32 | Train Loss: 3.040 Vali Loss: 103.049 Vali Acc: 0.450 Test Loss: 103.049 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.358532190322876
Epoch: 8, Steps: 32 | Train Loss: 2.099 Vali Loss: 138.670 Vali Acc: 0.519 Test Loss: 138.670 Test Acc: 0.519
Validation loss decreased (-0.510449 --> -0.517697).  Saving model ...
Epoch: 9 cost time: 9.224282026290894
Epoch: 9, Steps: 32 | Train Loss: 3.866 Vali Loss: 157.232 Vali Acc: 0.527 Test Loss: 157.232 Test Acc: 0.527
Validation loss decreased (-0.517697 --> -0.525145).  Saving model ...
Epoch: 10 cost time: 9.356153011322021
Epoch: 10, Steps: 32 | Train Loss: 2.246 Vali Loss: 158.041 Vali Acc: 0.519 Test Loss: 158.041 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.210969924926758
Epoch: 11, Steps: 32 | Train Loss: 2.365 Vali Loss: 161.430 Vali Acc: 0.511 Test Loss: 161.430 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.243317127227783
Epoch: 12, Steps: 32 | Train Loss: 2.057 Vali Loss: 152.032 Vali Acc: 0.458 Test Loss: 152.032 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.017483949661255
Epoch: 13, Steps: 32 | Train Loss: 2.243 Vali Loss: 172.145 Vali Acc: 0.328 Test Loss: 172.145 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.317848205566406
Epoch: 14, Steps: 32 | Train Loss: 3.754 Vali Loss: 165.842 Vali Acc: 0.557 Test Loss: 165.842 Test Acc: 0.557
Validation loss decreased (-0.525145 --> -0.555593).  Saving model ...
Epoch: 15 cost time: 9.223732471466064
Epoch: 15, Steps: 32 | Train Loss: 3.243 Vali Loss: 207.608 Vali Acc: 0.496 Test Loss: 207.608 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.226582050323486
Epoch: 16, Steps: 32 | Train Loss: 2.172 Vali Loss: 179.001 Vali Acc: 0.496 Test Loss: 179.001 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.333046197891235
Epoch: 17, Steps: 32 | Train Loss: 1.728 Vali Loss: 169.432 Vali Acc: 0.427 Test Loss: 169.432 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.206462383270264
Epoch: 18, Steps: 32 | Train Loss: 2.375 Vali Loss: 186.708 Vali Acc: 0.473 Test Loss: 186.708 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.284794092178345
Epoch: 19, Steps: 32 | Train Loss: 1.144 Vali Loss: 280.137 Vali Acc: 0.511 Test Loss: 280.137 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.12552785873413
Epoch: 20, Steps: 32 | Train Loss: 2.907 Vali Loss: 184.129 Vali Acc: 0.466 Test Loss: 184.129 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.220013856887817
Epoch: 21, Steps: 32 | Train Loss: 0.209 Vali Loss: 168.290 Vali Acc: 0.435 Test Loss: 168.290 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.15029788017273
Epoch: 22, Steps: 32 | Train Loss: 3.874 Vali Loss: 282.330 Vali Acc: 0.305 Test Loss: 282.330 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.178886413574219
Epoch: 23, Steps: 32 | Train Loss: 5.760 Vali Loss: 228.031 Vali Acc: 0.443 Test Loss: 228.031 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.137535095214844
Epoch: 24, Steps: 32 | Train Loss: 2.659 Vali Loss: 237.950 Vali Acc: 0.374 Test Loss: 237.950 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 18951965
model size : 89.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.728322505950928
Epoch: 1, Steps: 32 | Train Loss: 40.750 Vali Loss: 55.629 Vali Acc: 0.206 Test Loss: 55.629 Test Acc: 0.206
Validation loss decreased (inf --> -0.205551).  Saving model ...
Epoch: 2 cost time: 9.422075033187866
Epoch: 2, Steps: 32 | Train Loss: 62.233 Vali Loss: 42.392 Vali Acc: 0.191 Test Loss: 42.392 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.35973334312439
Epoch: 3, Steps: 32 | Train Loss: 22.770 Vali Loss: 60.786 Vali Acc: 0.267 Test Loss: 60.786 Test Acc: 0.267
Validation loss decreased (-0.205551 --> -0.266568).  Saving model ...
Epoch: 4 cost time: 9.444321155548096
Epoch: 4, Steps: 32 | Train Loss: 39.358 Vali Loss: 83.028 Vali Acc: 0.504 Test Loss: 83.028 Test Acc: 0.504
Validation loss decreased (-0.266568 --> -0.502987).  Saving model ...
Epoch: 5 cost time: 9.648205518722534
Epoch: 5, Steps: 32 | Train Loss: 14.407 Vali Loss: 136.377 Vali Acc: 0.527 Test Loss: 136.377 Test Acc: 0.527
Validation loss decreased (-0.502987 --> -0.525354).  Saving model ...
Epoch: 6 cost time: 9.381165981292725
Epoch: 6, Steps: 32 | Train Loss: 10.968 Vali Loss: 111.240 Vali Acc: 0.496 Test Loss: 111.240 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.298164129257202
Epoch: 7, Steps: 32 | Train Loss: 1.973 Vali Loss: 141.525 Vali Acc: 0.496 Test Loss: 141.525 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.38806700706482
Epoch: 8, Steps: 32 | Train Loss: 1.373 Vali Loss: 127.597 Vali Acc: 0.511 Test Loss: 127.597 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.392797708511353
Epoch: 9, Steps: 32 | Train Loss: 1.315 Vali Loss: 114.467 Vali Acc: 0.504 Test Loss: 114.467 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.451958656311035
Epoch: 10, Steps: 32 | Train Loss: 2.150 Vali Loss: 96.214 Vali Acc: 0.481 Test Loss: 96.214 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.47445297241211
Epoch: 11, Steps: 32 | Train Loss: 4.224 Vali Loss: 133.989 Vali Acc: 0.527 Test Loss: 133.989 Test Acc: 0.527
Validation loss decreased (-0.525354 --> -0.525378).  Saving model ...
Epoch: 12 cost time: 9.417851686477661
Epoch: 12, Steps: 32 | Train Loss: 3.936 Vali Loss: 194.714 Vali Acc: 0.527 Test Loss: 194.714 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.471774578094482
Epoch: 13, Steps: 32 | Train Loss: 8.938 Vali Loss: 163.368 Vali Acc: 0.489 Test Loss: 163.368 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.423908710479736
Epoch: 14, Steps: 32 | Train Loss: 2.846 Vali Loss: 183.073 Vali Acc: 0.542 Test Loss: 183.073 Test Acc: 0.542
Validation loss decreased (-0.525378 --> -0.540154).  Saving model ...
Epoch: 15 cost time: 9.441124439239502
Epoch: 15, Steps: 32 | Train Loss: 3.941 Vali Loss: 154.198 Vali Acc: 0.466 Test Loss: 154.198 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.65201735496521
Epoch: 16, Steps: 32 | Train Loss: 1.617 Vali Loss: 178.222 Vali Acc: 0.511 Test Loss: 178.222 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.558093786239624
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.990 Vali Acc: 0.519 Test Loss: 173.990 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.436586141586304
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.962 Vali Acc: 0.519 Test Loss: 173.962 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.495877027511597
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.566506385803223
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.50029706954956
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.498581409454346
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.43250322341919
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.505809307098389
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 173.961 Vali Acc: 0.519 Test Loss: 173.961 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 19315229
model size : 91.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.806420803070068
Epoch: 1, Steps: 32 | Train Loss: 29.262 Vali Loss: 51.712 Vali Acc: 0.435 Test Loss: 51.712 Test Acc: 0.435
Validation loss decreased (inf --> -0.434597).  Saving model ...
Epoch: 2 cost time: 9.185410261154175
Epoch: 2, Steps: 32 | Train Loss: 86.820 Vali Loss: 109.774 Vali Acc: 0.420 Test Loss: 109.774 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.139081716537476
Epoch: 3, Steps: 32 | Train Loss: 78.791 Vali Loss: 77.570 Vali Acc: 0.405 Test Loss: 77.570 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.225619792938232
Epoch: 4, Steps: 32 | Train Loss: 25.815 Vali Loss: 82.726 Vali Acc: 0.374 Test Loss: 82.726 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.4042489528656
Epoch: 5, Steps: 32 | Train Loss: 22.495 Vali Loss: 230.982 Vali Acc: 0.481 Test Loss: 230.982 Test Acc: 0.481
Validation loss decreased (-0.434597 --> -0.478606).  Saving model ...
Epoch: 6 cost time: 9.244247436523438
Epoch: 6, Steps: 32 | Train Loss: 13.941 Vali Loss: 134.946 Vali Acc: 0.481 Test Loss: 134.946 Test Acc: 0.481
Validation loss decreased (-0.478606 --> -0.479567).  Saving model ...
Epoch: 7 cost time: 9.531079292297363
Epoch: 7, Steps: 32 | Train Loss: 7.279 Vali Loss: 102.161 Vali Acc: 0.534 Test Loss: 102.161 Test Acc: 0.534
Validation loss decreased (-0.479567 --> -0.533330).  Saving model ...
Epoch: 8 cost time: 9.451475143432617
Epoch: 8, Steps: 32 | Train Loss: 1.911 Vali Loss: 122.480 Vali Acc: 0.366 Test Loss: 122.480 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.221524715423584
Epoch: 9, Steps: 32 | Train Loss: 2.072 Vali Loss: 107.454 Vali Acc: 0.473 Test Loss: 107.454 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.53239893913269
Epoch: 10, Steps: 32 | Train Loss: 3.655 Vali Loss: 126.377 Vali Acc: 0.542 Test Loss: 126.377 Test Acc: 0.542
Validation loss decreased (-0.533330 --> -0.540721).  Saving model ...
Epoch: 11 cost time: 9.286603689193726
Epoch: 11, Steps: 32 | Train Loss: 0.584 Vali Loss: 120.075 Vali Acc: 0.481 Test Loss: 120.075 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.323098421096802
Epoch: 12, Steps: 32 | Train Loss: 1.289 Vali Loss: 117.486 Vali Acc: 0.504 Test Loss: 117.486 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.356126070022583
Epoch: 13, Steps: 32 | Train Loss: 0.884 Vali Loss: 124.038 Vali Acc: 0.420 Test Loss: 124.038 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.457778453826904
Epoch: 14, Steps: 32 | Train Loss: 0.119 Vali Loss: 148.603 Vali Acc: 0.489 Test Loss: 148.603 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.344712972640991
Epoch: 15, Steps: 32 | Train Loss: 1.125 Vali Loss: 160.033 Vali Acc: 0.458 Test Loss: 160.033 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.421258211135864
Epoch: 16, Steps: 32 | Train Loss: 1.662 Vali Loss: 171.070 Vali Acc: 0.489 Test Loss: 171.070 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.196954488754272
Epoch: 17, Steps: 32 | Train Loss: 3.027 Vali Loss: 179.402 Vali Acc: 0.412 Test Loss: 179.402 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.384669303894043
Epoch: 18, Steps: 32 | Train Loss: 0.937 Vali Loss: 189.099 Vali Acc: 0.397 Test Loss: 189.099 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.309977293014526
Epoch: 19, Steps: 32 | Train Loss: 5.683 Vali Loss: 200.152 Vali Acc: 0.328 Test Loss: 200.152 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.551607131958008
Epoch: 20, Steps: 32 | Train Loss: 4.493 Vali Loss: 165.650 Vali Acc: 0.489 Test Loss: 165.650 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 18931485
model size : 89.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.505931854248047
Epoch: 1, Steps: 32 | Train Loss: 42.241 Vali Loss: 93.195 Vali Acc: 0.420 Test Loss: 93.195 Test Acc: 0.420
Validation loss decreased (inf --> -0.418915).  Saving model ...
Epoch: 2 cost time: 9.136157274246216
Epoch: 2, Steps: 32 | Train Loss: 85.782 Vali Loss: 97.248 Vali Acc: 0.183 Test Loss: 97.248 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.066887140274048
Epoch: 3, Steps: 32 | Train Loss: 62.040 Vali Loss: 56.396 Vali Acc: 0.351 Test Loss: 56.396 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.25842833518982
Epoch: 4, Steps: 32 | Train Loss: 25.072 Vali Loss: 129.518 Vali Acc: 0.466 Test Loss: 129.518 Test Acc: 0.466
Validation loss decreased (-0.418915 --> -0.464354).  Saving model ...
Epoch: 5 cost time: 9.175593852996826
Epoch: 5, Steps: 32 | Train Loss: 18.628 Vali Loss: 75.332 Vali Acc: 0.519 Test Loss: 75.332 Test Acc: 0.519
Validation loss decreased (-0.464354 --> -0.518331).  Saving model ...
Epoch: 6 cost time: 9.127246141433716
Epoch: 6, Steps: 32 | Train Loss: 3.720 Vali Loss: 67.748 Vali Acc: 0.519 Test Loss: 67.748 Test Acc: 0.519
Validation loss decreased (-0.518331 --> -0.518406).  Saving model ...
Epoch: 7 cost time: 9.258506298065186
Epoch: 7, Steps: 32 | Train Loss: 2.250 Vali Loss: 91.551 Vali Acc: 0.405 Test Loss: 91.551 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.12438154220581
Epoch: 8, Steps: 32 | Train Loss: 3.226 Vali Loss: 130.310 Vali Acc: 0.542 Test Loss: 130.310 Test Acc: 0.542
Validation loss decreased (-0.518406 --> -0.540682).  Saving model ...
Epoch: 9 cost time: 9.17306637763977
Epoch: 9, Steps: 32 | Train Loss: 2.611 Vali Loss: 96.969 Vali Acc: 0.534 Test Loss: 96.969 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.148844242095947
Epoch: 10, Steps: 32 | Train Loss: 7.096 Vali Loss: 125.466 Vali Acc: 0.450 Test Loss: 125.466 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.966383218765259
Epoch: 11, Steps: 32 | Train Loss: 9.907 Vali Loss: 123.574 Vali Acc: 0.427 Test Loss: 123.574 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.129387378692627
Epoch: 12, Steps: 32 | Train Loss: 3.219 Vali Loss: 138.227 Vali Acc: 0.481 Test Loss: 138.227 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.035494804382324
Epoch: 13, Steps: 32 | Train Loss: 0.425 Vali Loss: 153.259 Vali Acc: 0.504 Test Loss: 153.259 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.159547090530396
Epoch: 14, Steps: 32 | Train Loss: 0.032 Vali Loss: 122.675 Vali Acc: 0.420 Test Loss: 122.675 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.093274354934692
Epoch: 15, Steps: 32 | Train Loss: 0.107 Vali Loss: 147.553 Vali Acc: 0.405 Test Loss: 147.553 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.166112422943115
Epoch: 16, Steps: 32 | Train Loss: 3.085 Vali Loss: 136.811 Vali Acc: 0.450 Test Loss: 136.811 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.044498443603516
Epoch: 17, Steps: 32 | Train Loss: 0.282 Vali Loss: 133.971 Vali Acc: 0.351 Test Loss: 133.971 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.052750587463379
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 134.902 Vali Acc: 0.336 Test Loss: 134.902 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 18547741
model size : 88.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.274789571762085
Epoch: 1, Steps: 32 | Train Loss: 45.577 Vali Loss: 36.652 Vali Acc: 0.176 Test Loss: 36.652 Test Acc: 0.176
Validation loss decreased (inf --> -0.175206).  Saving model ...
Epoch: 2 cost time: 8.89875340461731
Epoch: 2, Steps: 32 | Train Loss: 81.952 Vali Loss: 116.619 Vali Acc: 0.427 Test Loss: 116.619 Test Acc: 0.427
Validation loss decreased (-0.175206 --> -0.426315).  Saving model ...
Epoch: 3 cost time: 8.825012683868408
Epoch: 3, Steps: 32 | Train Loss: 43.514 Vali Loss: 77.033 Vali Acc: 0.260 Test Loss: 77.033 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.920074701309204
Epoch: 4, Steps: 32 | Train Loss: 24.460 Vali Loss: 87.343 Vali Acc: 0.420 Test Loss: 87.343 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.699104309082031
Epoch: 5, Steps: 32 | Train Loss: 26.065 Vali Loss: 97.422 Vali Acc: 0.481 Test Loss: 97.422 Test Acc: 0.481
Validation loss decreased (-0.426315 --> -0.479942).  Saving model ...
Epoch: 6 cost time: 8.88335633277893
Epoch: 6, Steps: 32 | Train Loss: 6.855 Vali Loss: 97.111 Vali Acc: 0.458 Test Loss: 97.111 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.796700716018677
Epoch: 7, Steps: 32 | Train Loss: 6.709 Vali Loss: 122.645 Vali Acc: 0.504 Test Loss: 122.645 Test Acc: 0.504
Validation loss decreased (-0.479942 --> -0.502590).  Saving model ...
Epoch: 8 cost time: 8.786213397979736
Epoch: 8, Steps: 32 | Train Loss: 6.123 Vali Loss: 152.091 Vali Acc: 0.542 Test Loss: 152.091 Test Acc: 0.542
Validation loss decreased (-0.502590 --> -0.540464).  Saving model ...
Epoch: 9 cost time: 8.889257192611694
Epoch: 9, Steps: 32 | Train Loss: 1.962 Vali Loss: 137.618 Vali Acc: 0.565 Test Loss: 137.618 Test Acc: 0.565
Validation loss decreased (-0.540464 --> -0.563509).  Saving model ...
Epoch: 10 cost time: 9.137829542160034
Epoch: 10, Steps: 32 | Train Loss: 1.035 Vali Loss: 118.864 Vali Acc: 0.481 Test Loss: 118.864 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.848662376403809
Epoch: 11, Steps: 32 | Train Loss: 1.831 Vali Loss: 114.973 Vali Acc: 0.511 Test Loss: 114.973 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.998409509658813
Epoch: 12, Steps: 32 | Train Loss: 0.713 Vali Loss: 144.789 Vali Acc: 0.534 Test Loss: 144.789 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.882916450500488
Epoch: 13, Steps: 32 | Train Loss: 7.372 Vali Loss: 168.855 Vali Acc: 0.519 Test Loss: 168.855 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.852884769439697
Epoch: 14, Steps: 32 | Train Loss: 2.759 Vali Loss: 134.902 Vali Acc: 0.527 Test Loss: 134.902 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.829074621200562
Epoch: 15, Steps: 32 | Train Loss: 6.719 Vali Loss: 195.229 Vali Acc: 0.496 Test Loss: 195.229 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.865893602371216
Epoch: 16, Steps: 32 | Train Loss: 5.132 Vali Loss: 182.167 Vali Acc: 0.466 Test Loss: 182.167 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.026179313659668
Epoch: 17, Steps: 32 | Train Loss: 1.521 Vali Loss: 159.212 Vali Acc: 0.420 Test Loss: 159.212 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.855283260345459
Epoch: 18, Steps: 32 | Train Loss: 3.087 Vali Loss: 188.242 Vali Acc: 0.450 Test Loss: 188.242 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.773853302001953
Epoch: 19, Steps: 32 | Train Loss: 0.777 Vali Loss: 209.100 Vali Acc: 0.473 Test Loss: 209.100 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 18163997
model size : 86.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.55368185043335
Epoch: 1, Steps: 32 | Train Loss: 40.272 Vali Loss: 60.264 Vali Acc: 0.137 Test Loss: 60.264 Test Acc: 0.137
Validation loss decreased (inf --> -0.136802).  Saving model ...
Epoch: 2 cost time: 9.028165340423584
Epoch: 2, Steps: 32 | Train Loss: 96.634 Vali Loss: 101.825 Vali Acc: 0.099 Test Loss: 101.825 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.150184869766235
Epoch: 3, Steps: 32 | Train Loss: 96.188 Vali Loss: 78.798 Vali Acc: 0.481 Test Loss: 78.798 Test Acc: 0.481
Validation loss decreased (-0.136802 --> -0.480128).  Saving model ...
Epoch: 4 cost time: 9.142057180404663
Epoch: 4, Steps: 32 | Train Loss: 16.073 Vali Loss: 80.755 Vali Acc: 0.496 Test Loss: 80.755 Test Acc: 0.496
Validation loss decreased (-0.480128 --> -0.495376).  Saving model ...
Epoch: 5 cost time: 9.296374082565308
Epoch: 5, Steps: 32 | Train Loss: 23.753 Vali Loss: 115.215 Vali Acc: 0.489 Test Loss: 115.215 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.134527444839478
Epoch: 6, Steps: 32 | Train Loss: 9.138 Vali Loss: 80.643 Vali Acc: 0.412 Test Loss: 80.643 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.225503206253052
Epoch: 7, Steps: 32 | Train Loss: 15.807 Vali Loss: 134.526 Vali Acc: 0.427 Test Loss: 134.526 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.185605525970459
Epoch: 8, Steps: 32 | Train Loss: 8.810 Vali Loss: 111.546 Vali Acc: 0.481 Test Loss: 111.546 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.141136407852173
Epoch: 9, Steps: 32 | Train Loss: 1.631 Vali Loss: 191.911 Vali Acc: 0.511 Test Loss: 191.911 Test Acc: 0.511
Validation loss decreased (-0.495376 --> -0.509531).  Saving model ...
Epoch: 10 cost time: 9.125409364700317
Epoch: 10, Steps: 32 | Train Loss: 1.475 Vali Loss: 168.573 Vali Acc: 0.504 Test Loss: 168.573 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.249857902526855
Epoch: 11, Steps: 32 | Train Loss: 3.445 Vali Loss: 137.786 Vali Acc: 0.450 Test Loss: 137.786 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.20842957496643
Epoch: 12, Steps: 32 | Train Loss: 4.332 Vali Loss: 135.627 Vali Acc: 0.427 Test Loss: 135.627 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.165452480316162
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 137.947 Vali Acc: 0.504 Test Loss: 137.947 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.217188596725464
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.594 Vali Acc: 0.504 Test Loss: 138.594 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.094257354736328
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.618 Vali Acc: 0.504 Test Loss: 138.618 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.202441453933716
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.619 Vali Acc: 0.504 Test Loss: 138.619 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.10116171836853
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.619 Vali Acc: 0.504 Test Loss: 138.619 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.209411144256592
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.619 Vali Acc: 0.504 Test Loss: 138.619 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.206069231033325
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 138.619 Vali Acc: 0.504 Test Loss: 138.619 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 18921245
model size : 89.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.376000165939331
Epoch: 1, Steps: 32 | Train Loss: 48.808 Vali Loss: 37.232 Vali Acc: 0.420 Test Loss: 37.232 Test Acc: 0.420
Validation loss decreased (inf --> -0.419475).  Saving model ...
Epoch: 2 cost time: 9.241212606430054
Epoch: 2, Steps: 32 | Train Loss: 57.916 Vali Loss: 117.549 Vali Acc: 0.145 Test Loss: 117.549 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.083914995193481
Epoch: 3, Steps: 32 | Train Loss: 38.631 Vali Loss: 36.030 Vali Acc: 0.435 Test Loss: 36.030 Test Acc: 0.435
Validation loss decreased (-0.419475 --> -0.434754).  Saving model ...
Epoch: 4 cost time: 9.134937286376953
Epoch: 4, Steps: 32 | Train Loss: 18.956 Vali Loss: 136.583 Vali Acc: 0.466 Test Loss: 136.583 Test Acc: 0.466
Validation loss decreased (-0.434754 --> -0.464283).  Saving model ...
Epoch: 5 cost time: 9.08303189277649
Epoch: 5, Steps: 32 | Train Loss: 47.890 Vali Loss: 114.580 Vali Acc: 0.382 Test Loss: 114.580 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.249841690063477
Epoch: 6, Steps: 32 | Train Loss: 9.270 Vali Loss: 92.645 Vali Acc: 0.473 Test Loss: 92.645 Test Acc: 0.473
Validation loss decreased (-0.464283 --> -0.472356).  Saving model ...
Epoch: 7 cost time: 9.209975957870483
Epoch: 7, Steps: 32 | Train Loss: 4.722 Vali Loss: 106.647 Vali Acc: 0.481 Test Loss: 106.647 Test Acc: 0.481
Validation loss decreased (-0.472356 --> -0.479850).  Saving model ...
Epoch: 8 cost time: 9.164389848709106
Epoch: 8, Steps: 32 | Train Loss: 3.283 Vali Loss: 109.699 Vali Acc: 0.511 Test Loss: 109.699 Test Acc: 0.511
Validation loss decreased (-0.479850 --> -0.510353).  Saving model ...
Epoch: 9 cost time: 9.076613426208496
Epoch: 9, Steps: 32 | Train Loss: 1.892 Vali Loss: 127.887 Vali Acc: 0.519 Test Loss: 127.887 Test Acc: 0.519
Validation loss decreased (-0.510353 --> -0.517805).  Saving model ...
Epoch: 10 cost time: 9.059657335281372
Epoch: 10, Steps: 32 | Train Loss: 3.074 Vali Loss: 116.329 Vali Acc: 0.466 Test Loss: 116.329 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.116641283035278
Epoch: 11, Steps: 32 | Train Loss: 0.436 Vali Loss: 130.705 Vali Acc: 0.427 Test Loss: 130.705 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.244315147399902
Epoch: 12, Steps: 32 | Train Loss: 1.008 Vali Loss: 107.291 Vali Acc: 0.534 Test Loss: 107.291 Test Acc: 0.534
Validation loss decreased (-0.517805 --> -0.533278).  Saving model ...
Epoch: 13 cost time: 9.118473529815674
Epoch: 13, Steps: 32 | Train Loss: 1.049 Vali Loss: 110.998 Vali Acc: 0.496 Test Loss: 110.998 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.093315124511719
Epoch: 14, Steps: 32 | Train Loss: 0.276 Vali Loss: 115.703 Vali Acc: 0.527 Test Loss: 115.703 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.068135738372803
Epoch: 15, Steps: 32 | Train Loss: 3.089 Vali Loss: 119.146 Vali Acc: 0.534 Test Loss: 119.146 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.126687049865723
Epoch: 16, Steps: 32 | Train Loss: 3.365 Vali Loss: 112.684 Vali Acc: 0.496 Test Loss: 112.684 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.051544427871704
Epoch: 17, Steps: 32 | Train Loss: 1.020 Vali Loss: 101.772 Vali Acc: 0.450 Test Loss: 101.772 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.007251024246216
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 120.630 Vali Acc: 0.489 Test Loss: 120.630 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.167758464813232
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 121.186 Vali Acc: 0.489 Test Loss: 121.186 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.169906377792358
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 121.204 Vali Acc: 0.489 Test Loss: 121.204 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.191187381744385
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 121.204 Vali Acc: 0.489 Test Loss: 121.204 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.125740766525269
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 121.204 Vali Acc: 0.489 Test Loss: 121.204 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 18537501
model size : 88.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.383628606796265
Epoch: 1, Steps: 32 | Train Loss: 36.887 Vali Loss: 115.005 Vali Acc: 0.176 Test Loss: 115.005 Test Acc: 0.176
Validation loss decreased (inf --> -0.174422).  Saving model ...
Epoch: 2 cost time: 9.03346061706543
Epoch: 2, Steps: 32 | Train Loss: 111.954 Vali Loss: 132.262 Vali Acc: 0.176 Test Loss: 132.262 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.080105304718018
Epoch: 3, Steps: 32 | Train Loss: 56.141 Vali Loss: 58.877 Vali Acc: 0.290 Test Loss: 58.877 Test Acc: 0.290
Validation loss decreased (-0.174422 --> -0.289488).  Saving model ...
Epoch: 4 cost time: 9.074771642684937
Epoch: 4, Steps: 32 | Train Loss: 26.867 Vali Loss: 68.850 Vali Acc: 0.511 Test Loss: 68.850 Test Acc: 0.511
Validation loss decreased (-0.289488 --> -0.510762).  Saving model ...
Epoch: 5 cost time: 9.104043245315552
Epoch: 5, Steps: 32 | Train Loss: 16.676 Vali Loss: 127.299 Vali Acc: 0.496 Test Loss: 127.299 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.248929738998413
Epoch: 6, Steps: 32 | Train Loss: 12.606 Vali Loss: 113.421 Vali Acc: 0.519 Test Loss: 113.421 Test Acc: 0.519
Validation loss decreased (-0.510762 --> -0.517950).  Saving model ...
Epoch: 7 cost time: 9.137283086776733
Epoch: 7, Steps: 32 | Train Loss: 6.077 Vali Loss: 101.364 Vali Acc: 0.397 Test Loss: 101.364 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.932817459106445
Epoch: 8, Steps: 32 | Train Loss: 3.504 Vali Loss: 116.966 Vali Acc: 0.458 Test Loss: 116.966 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.085423707962036
Epoch: 9, Steps: 32 | Train Loss: 5.938 Vali Loss: 124.666 Vali Acc: 0.466 Test Loss: 124.666 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.094104528427124
Epoch: 10, Steps: 32 | Train Loss: 4.115 Vali Loss: 138.944 Vali Acc: 0.511 Test Loss: 138.944 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.15591287612915
Epoch: 11, Steps: 32 | Train Loss: 3.651 Vali Loss: 138.980 Vali Acc: 0.458 Test Loss: 138.980 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.07950735092163
Epoch: 12, Steps: 32 | Train Loss: 1.647 Vali Loss: 147.377 Vali Acc: 0.458 Test Loss: 147.377 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.072162866592407
Epoch: 13, Steps: 32 | Train Loss: 7.057 Vali Loss: 209.629 Vali Acc: 0.481 Test Loss: 209.629 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.987137794494629
Epoch: 14, Steps: 32 | Train Loss: 10.034 Vali Loss: 198.218 Vali Acc: 0.374 Test Loss: 198.218 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.996665716171265
Epoch: 15, Steps: 32 | Train Loss: 8.509 Vali Loss: 179.281 Vali Acc: 0.405 Test Loss: 179.281 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.073968410491943
Epoch: 16, Steps: 32 | Train Loss: 2.433 Vali Loss: 214.373 Vali Acc: 0.489 Test Loss: 214.373 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 18153757
model size : 86.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.946874380111694
Epoch: 1, Steps: 32 | Train Loss: 28.552 Vali Loss: 40.376 Vali Acc: 0.420 Test Loss: 40.376 Test Acc: 0.420
Validation loss decreased (inf --> -0.419444).  Saving model ...
Epoch: 2 cost time: 8.908430337905884
Epoch: 2, Steps: 32 | Train Loss: 83.195 Vali Loss: 91.140 Vali Acc: 0.198 Test Loss: 91.140 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.84186339378357
Epoch: 3, Steps: 32 | Train Loss: 49.608 Vali Loss: 54.239 Vali Acc: 0.458 Test Loss: 54.239 Test Acc: 0.458
Validation loss decreased (-0.419444 --> -0.457473).  Saving model ...
Epoch: 4 cost time: 8.74953818321228
Epoch: 4, Steps: 32 | Train Loss: 18.372 Vali Loss: 66.214 Vali Acc: 0.489 Test Loss: 66.214 Test Acc: 0.489
Validation loss decreased (-0.457473 --> -0.487887).  Saving model ...
Epoch: 5 cost time: 8.694149017333984
Epoch: 5, Steps: 32 | Train Loss: 14.654 Vali Loss: 116.132 Vali Acc: 0.489 Test Loss: 116.132 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.823760509490967
Epoch: 6, Steps: 32 | Train Loss: 24.930 Vali Loss: 106.743 Vali Acc: 0.511 Test Loss: 106.743 Test Acc: 0.511
Validation loss decreased (-0.487887 --> -0.510383).  Saving model ...
Epoch: 7 cost time: 8.813394546508789
Epoch: 7, Steps: 32 | Train Loss: 13.785 Vali Loss: 125.990 Vali Acc: 0.351 Test Loss: 125.990 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.745373487472534
Epoch: 8, Steps: 32 | Train Loss: 5.698 Vali Loss: 109.710 Vali Acc: 0.443 Test Loss: 109.710 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.896465301513672
Epoch: 9, Steps: 32 | Train Loss: 0.083 Vali Loss: 117.237 Vali Acc: 0.435 Test Loss: 117.237 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.90988826751709
Epoch: 10, Steps: 32 | Train Loss: 1.931 Vali Loss: 127.712 Vali Acc: 0.412 Test Loss: 127.712 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.909913063049316
Epoch: 11, Steps: 32 | Train Loss: 4.255 Vali Loss: 171.809 Vali Acc: 0.504 Test Loss: 171.809 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.791276693344116
Epoch: 12, Steps: 32 | Train Loss: 4.694 Vali Loss: 152.849 Vali Acc: 0.366 Test Loss: 152.849 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.11834168434143
Epoch: 13, Steps: 32 | Train Loss: 0.507 Vali Loss: 184.473 Vali Acc: 0.328 Test Loss: 184.473 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.886829614639282
Epoch: 14, Steps: 32 | Train Loss: 2.461 Vali Loss: 166.920 Vali Acc: 0.382 Test Loss: 166.920 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.090027093887329
Epoch: 15, Steps: 32 | Train Loss: 9.816 Vali Loss: 160.524 Vali Acc: 0.443 Test Loss: 160.524 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.848044395446777
Epoch: 16, Steps: 32 | Train Loss: 8.418 Vali Loss: 171.597 Vali Acc: 0.450 Test Loss: 171.597 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 17770013
model size : 85.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.260404109954834
Epoch: 1, Steps: 32 | Train Loss: 42.151 Vali Loss: 56.091 Vali Acc: 0.420 Test Loss: 56.091 Test Acc: 0.420
Validation loss decreased (inf --> -0.419286).  Saving model ...
Epoch: 2 cost time: 9.076215505599976
Epoch: 2, Steps: 32 | Train Loss: 98.715 Vali Loss: 159.750 Vali Acc: 0.183 Test Loss: 159.750 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.232131719589233
Epoch: 3, Steps: 32 | Train Loss: 77.763 Vali Loss: 108.833 Vali Acc: 0.450 Test Loss: 108.833 Test Acc: 0.450
Validation loss decreased (-0.419286 --> -0.449293).  Saving model ...
Epoch: 4 cost time: 9.405751705169678
Epoch: 4, Steps: 32 | Train Loss: 19.107 Vali Loss: 102.105 Vali Acc: 0.260 Test Loss: 102.105 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.355962038040161
Epoch: 5, Steps: 32 | Train Loss: 30.360 Vali Loss: 89.794 Vali Acc: 0.519 Test Loss: 89.794 Test Acc: 0.519
Validation loss decreased (-0.449293 --> -0.518186).  Saving model ...
Epoch: 6 cost time: 9.571483135223389
Epoch: 6, Steps: 32 | Train Loss: 16.104 Vali Loss: 113.439 Vali Acc: 0.504 Test Loss: 113.439 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.259173154830933
Epoch: 7, Steps: 32 | Train Loss: 8.320 Vali Loss: 104.699 Vali Acc: 0.366 Test Loss: 104.699 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.139840126037598
Epoch: 8, Steps: 32 | Train Loss: 4.174 Vali Loss: 119.471 Vali Acc: 0.481 Test Loss: 119.471 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.313755750656128
Epoch: 9, Steps: 32 | Train Loss: 5.792 Vali Loss: 103.761 Vali Acc: 0.427 Test Loss: 103.761 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.340964794158936
Epoch: 10, Steps: 32 | Train Loss: 7.127 Vali Loss: 134.695 Vali Acc: 0.489 Test Loss: 134.695 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.257204532623291
Epoch: 11, Steps: 32 | Train Loss: 2.231 Vali Loss: 129.691 Vali Acc: 0.496 Test Loss: 129.691 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.288250207901001
Epoch: 12, Steps: 32 | Train Loss: 6.276 Vali Loss: 128.644 Vali Acc: 0.412 Test Loss: 128.644 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.240393161773682
Epoch: 13, Steps: 32 | Train Loss: 0.577 Vali Loss: 224.711 Vali Acc: 0.198 Test Loss: 224.711 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.181814432144165
Epoch: 14, Steps: 32 | Train Loss: 10.048 Vali Loss: 122.908 Vali Acc: 0.504 Test Loss: 122.908 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.232127904891968
Epoch: 15, Steps: 32 | Train Loss: 2.225 Vali Loss: 126.075 Vali Acc: 0.336 Test Loss: 126.075 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 18724253
model size : 89.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.492504119873047
Epoch: 1, Steps: 32 | Train Loss: 48.247 Vali Loss: 94.296 Vali Acc: 0.168 Test Loss: 94.296 Test Acc: 0.168
Validation loss decreased (inf --> -0.166996).  Saving model ...
Epoch: 2 cost time: 9.049089670181274
Epoch: 2, Steps: 32 | Train Loss: 85.053 Vali Loss: 70.432 Vali Acc: 0.450 Test Loss: 70.432 Test Acc: 0.450
Validation loss decreased (-0.166996 --> -0.449677).  Saving model ...
Epoch: 3 cost time: 9.149492025375366
Epoch: 3, Steps: 32 | Train Loss: 99.475 Vali Loss: 67.134 Vali Acc: 0.298 Test Loss: 67.134 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.060083150863647
Epoch: 4, Steps: 32 | Train Loss: 25.847 Vali Loss: 57.644 Vali Acc: 0.534 Test Loss: 57.644 Test Acc: 0.534
Validation loss decreased (-0.449677 --> -0.533775).  Saving model ...
Epoch: 5 cost time: 9.010708093643188
Epoch: 5, Steps: 32 | Train Loss: 26.173 Vali Loss: 93.327 Vali Acc: 0.527 Test Loss: 93.327 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.0764639377594
Epoch: 6, Steps: 32 | Train Loss: 15.562 Vali Loss: 79.135 Vali Acc: 0.473 Test Loss: 79.135 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.101818799972534
Epoch: 7, Steps: 32 | Train Loss: 7.826 Vali Loss: 117.583 Vali Acc: 0.336 Test Loss: 117.583 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.11354923248291
Epoch: 8, Steps: 32 | Train Loss: 4.203 Vali Loss: 117.885 Vali Acc: 0.534 Test Loss: 117.885 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.161688089370728
Epoch: 9, Steps: 32 | Train Loss: 0.705 Vali Loss: 118.853 Vali Acc: 0.489 Test Loss: 118.853 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.060058355331421
Epoch: 10, Steps: 32 | Train Loss: 3.719 Vali Loss: 135.804 Vali Acc: 0.405 Test Loss: 135.804 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.04209303855896
Epoch: 11, Steps: 32 | Train Loss: 2.938 Vali Loss: 156.644 Vali Acc: 0.527 Test Loss: 156.644 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.06631875038147
Epoch: 12, Steps: 32 | Train Loss: 9.187 Vali Loss: 155.018 Vali Acc: 0.534 Test Loss: 155.018 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.918300867080688
Epoch: 13, Steps: 32 | Train Loss: 2.137 Vali Loss: 177.659 Vali Acc: 0.519 Test Loss: 177.659 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.052087545394897
Epoch: 14, Steps: 32 | Train Loss: 9.460 Vali Loss: 197.431 Vali Acc: 0.519 Test Loss: 197.431 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 18340509
model size : 87.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.447382688522339
Epoch: 1, Steps: 32 | Train Loss: 39.599 Vali Loss: 88.573 Vali Acc: 0.168 Test Loss: 88.573 Test Acc: 0.168
Validation loss decreased (inf --> -0.167053).  Saving model ...
Epoch: 2 cost time: 8.919989824295044
Epoch: 2, Steps: 32 | Train Loss: 96.414 Vali Loss: 77.971 Vali Acc: 0.191 Test Loss: 77.971 Test Acc: 0.191
Validation loss decreased (-0.167053 --> -0.190060).  Saving model ...
Epoch: 3 cost time: 9.064136743545532
Epoch: 3, Steps: 32 | Train Loss: 94.002 Vali Loss: 125.499 Vali Acc: 0.458 Test Loss: 125.499 Test Acc: 0.458
Validation loss decreased (-0.190060 --> -0.456760).  Saving model ...
Epoch: 4 cost time: 8.979873895645142
Epoch: 4, Steps: 32 | Train Loss: 39.931 Vali Loss: 71.494 Vali Acc: 0.473 Test Loss: 71.494 Test Acc: 0.473
Validation loss decreased (-0.456760 --> -0.472568).  Saving model ...
Epoch: 5 cost time: 9.074300289154053
Epoch: 5, Steps: 32 | Train Loss: 5.676 Vali Loss: 79.985 Vali Acc: 0.496 Test Loss: 79.985 Test Acc: 0.496
Validation loss decreased (-0.472568 --> -0.495383).  Saving model ...
Epoch: 6 cost time: 8.911762237548828
Epoch: 6, Steps: 32 | Train Loss: 10.368 Vali Loss: 102.876 Vali Acc: 0.450 Test Loss: 102.876 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.041682004928589
Epoch: 7, Steps: 32 | Train Loss: 7.876 Vali Loss: 105.313 Vali Acc: 0.458 Test Loss: 105.313 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.959981203079224
Epoch: 8, Steps: 32 | Train Loss: 4.480 Vali Loss: 140.702 Vali Acc: 0.496 Test Loss: 140.702 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.939444303512573
Epoch: 9, Steps: 32 | Train Loss: 5.683 Vali Loss: 145.491 Vali Acc: 0.412 Test Loss: 145.491 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.047970533370972
Epoch: 10, Steps: 32 | Train Loss: 3.310 Vali Loss: 144.897 Vali Acc: 0.504 Test Loss: 144.897 Test Acc: 0.504
Validation loss decreased (-0.495383 --> -0.502368).  Saving model ...
Epoch: 11 cost time: 8.889613151550293
Epoch: 11, Steps: 32 | Train Loss: 2.504 Vali Loss: 146.912 Vali Acc: 0.435 Test Loss: 146.912 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.86459732055664
Epoch: 12, Steps: 32 | Train Loss: 2.991 Vali Loss: 156.186 Vali Acc: 0.504 Test Loss: 156.186 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.937590599060059
Epoch: 13, Steps: 32 | Train Loss: 0.035 Vali Loss: 143.245 Vali Acc: 0.496 Test Loss: 143.245 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.006834030151367
Epoch: 14, Steps: 32 | Train Loss: 5.023 Vali Loss: 148.400 Vali Acc: 0.489 Test Loss: 148.400 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.91644024848938
Epoch: 15, Steps: 32 | Train Loss: 1.195 Vali Loss: 154.918 Vali Acc: 0.519 Test Loss: 154.918 Test Acc: 0.519
Validation loss decreased (-0.502368 --> -0.517535).  Saving model ...
Epoch: 16 cost time: 8.925656080245972
Epoch: 16, Steps: 32 | Train Loss: 1.344 Vali Loss: 153.990 Vali Acc: 0.473 Test Loss: 153.990 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.907974243164062
Epoch: 17, Steps: 32 | Train Loss: 2.732 Vali Loss: 196.405 Vali Acc: 0.588 Test Loss: 196.405 Test Acc: 0.588
Validation loss decreased (-0.517535 --> -0.585822).  Saving model ...
Epoch: 18 cost time: 8.896481037139893
Epoch: 18, Steps: 32 | Train Loss: 0.901 Vali Loss: 188.472 Vali Acc: 0.573 Test Loss: 188.472 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.850527286529541
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.361 Vali Acc: 0.573 Test Loss: 189.361 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.04707646369934
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.394 Vali Acc: 0.573 Test Loss: 189.394 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.976180076599121
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.004353046417236
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 8.997421026229858
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.005834102630615
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.863580465316772
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.009493589401245
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.064838647842407
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 189.395 Vali Acc: 0.573 Test Loss: 189.395 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 17956765
model size : 86.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.99816632270813
Epoch: 1, Steps: 32 | Train Loss: 28.834 Vali Loss: 92.963 Vali Acc: 0.168 Test Loss: 92.963 Test Acc: 0.168
Validation loss decreased (inf --> -0.167009).  Saving model ...
Epoch: 2 cost time: 8.664306163787842
Epoch: 2, Steps: 32 | Train Loss: 63.619 Vali Loss: 54.924 Vali Acc: 0.160 Test Loss: 54.924 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.740415096282959
Epoch: 3, Steps: 32 | Train Loss: 79.522 Vali Loss: 123.500 Vali Acc: 0.214 Test Loss: 123.500 Test Acc: 0.214
Validation loss decreased (-0.167009 --> -0.212505).  Saving model ...
Epoch: 4 cost time: 8.74936318397522
Epoch: 4, Steps: 32 | Train Loss: 33.676 Vali Loss: 102.096 Vali Acc: 0.527 Test Loss: 102.096 Test Acc: 0.527
Validation loss decreased (-0.212505 --> -0.525697).  Saving model ...
Epoch: 5 cost time: 8.727212190628052
Epoch: 5, Steps: 32 | Train Loss: 22.108 Vali Loss: 116.800 Vali Acc: 0.321 Test Loss: 116.800 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.710104703903198
Epoch: 6, Steps: 32 | Train Loss: 17.772 Vali Loss: 145.583 Vali Acc: 0.519 Test Loss: 145.583 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.783581256866455
Epoch: 7, Steps: 32 | Train Loss: 8.935 Vali Loss: 104.726 Vali Acc: 0.466 Test Loss: 104.726 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.735887050628662
Epoch: 8, Steps: 32 | Train Loss: 12.361 Vali Loss: 199.448 Vali Acc: 0.321 Test Loss: 199.448 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.883131742477417
Epoch: 9, Steps: 32 | Train Loss: 9.033 Vali Loss: 152.175 Vali Acc: 0.466 Test Loss: 152.175 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.70606517791748
Epoch: 10, Steps: 32 | Train Loss: 2.625 Vali Loss: 160.216 Vali Acc: 0.458 Test Loss: 160.216 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.746371746063232
Epoch: 11, Steps: 32 | Train Loss: 0.784 Vali Loss: 217.310 Vali Acc: 0.504 Test Loss: 217.310 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.857227325439453
Epoch: 12, Steps: 32 | Train Loss: 3.769 Vali Loss: 182.006 Vali Acc: 0.389 Test Loss: 182.006 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.682648658752441
Epoch: 13, Steps: 32 | Train Loss: 2.491 Vali Loss: 180.933 Vali Acc: 0.496 Test Loss: 180.933 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.792834043502808
Epoch: 14, Steps: 32 | Train Loss: 3.602 Vali Loss: 160.760 Vali Acc: 0.443 Test Loss: 160.760 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 17573021
model size : 84.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.825108766555786
Epoch: 1, Steps: 32 | Train Loss: 22.529 Vali Loss: 76.154 Vali Acc: 0.168 Test Loss: 76.154 Test Acc: 0.168
Validation loss decreased (inf --> -0.167177).  Saving model ...
Epoch: 2 cost time: 8.29446005821228
Epoch: 2, Steps: 32 | Train Loss: 43.832 Vali Loss: 42.850 Vali Acc: 0.214 Test Loss: 42.850 Test Acc: 0.214
Validation loss decreased (-0.167177 --> -0.213312).  Saving model ...
Epoch: 3 cost time: 8.400540590286255
Epoch: 3, Steps: 32 | Train Loss: 28.791 Vali Loss: 32.960 Vali Acc: 0.275 Test Loss: 32.960 Test Acc: 0.275
Validation loss decreased (-0.213312 --> -0.274480).  Saving model ...
Epoch: 4 cost time: 8.25121021270752
Epoch: 4, Steps: 32 | Train Loss: 18.664 Vali Loss: 37.236 Vali Acc: 0.527 Test Loss: 37.236 Test Acc: 0.527
Validation loss decreased (-0.274480 --> -0.526345).  Saving model ...
Epoch: 5 cost time: 8.31202244758606
Epoch: 5, Steps: 32 | Train Loss: 13.226 Vali Loss: 45.395 Vali Acc: 0.336 Test Loss: 45.395 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.362771272659302
Epoch: 6, Steps: 32 | Train Loss: 5.139 Vali Loss: 50.953 Vali Acc: 0.466 Test Loss: 50.953 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.387989521026611
Epoch: 7, Steps: 32 | Train Loss: 2.371 Vali Loss: 55.889 Vali Acc: 0.458 Test Loss: 55.889 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.414125442504883
Epoch: 8, Steps: 32 | Train Loss: 0.669 Vali Loss: 62.184 Vali Acc: 0.519 Test Loss: 62.184 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.378446578979492
Epoch: 9, Steps: 32 | Train Loss: 2.376 Vali Loss: 68.280 Vali Acc: 0.496 Test Loss: 68.280 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.354201078414917
Epoch: 10, Steps: 32 | Train Loss: 1.638 Vali Loss: 69.715 Vali Acc: 0.504 Test Loss: 69.715 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.360868692398071
Epoch: 11, Steps: 32 | Train Loss: 1.015 Vali Loss: 62.505 Vali Acc: 0.405 Test Loss: 62.505 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.353955507278442
Epoch: 12, Steps: 32 | Train Loss: 1.493 Vali Loss: 82.875 Vali Acc: 0.519 Test Loss: 82.875 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.215848207473755
Epoch: 13, Steps: 32 | Train Loss: 0.348 Vali Loss: 71.158 Vali Acc: 0.473 Test Loss: 71.158 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.229490518569946
Epoch: 14, Steps: 32 | Train Loss: 0.370 Vali Loss: 72.244 Vali Acc: 0.519 Test Loss: 72.244 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 9266717
model size : 44.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.340001821517944
Epoch: 1, Steps: 32 | Train Loss: 15.334 Vali Loss: 24.830 Vali Acc: 0.137 Test Loss: 24.830 Test Acc: 0.137
Validation loss decreased (inf --> -0.137156).  Saving model ...
Epoch: 2 cost time: 8.242908954620361
Epoch: 2, Steps: 32 | Train Loss: 57.397 Vali Loss: 67.255 Vali Acc: 0.168 Test Loss: 67.255 Test Acc: 0.168
Validation loss decreased (-0.137156 --> -0.167266).  Saving model ...
Epoch: 3 cost time: 8.283217668533325
Epoch: 3, Steps: 32 | Train Loss: 33.412 Vali Loss: 28.014 Vali Acc: 0.351 Test Loss: 28.014 Test Acc: 0.351
Validation loss decreased (-0.167266 --> -0.350865).  Saving model ...
Epoch: 4 cost time: 8.307910680770874
Epoch: 4, Steps: 32 | Train Loss: 9.782 Vali Loss: 47.609 Vali Acc: 0.489 Test Loss: 47.609 Test Acc: 0.489
Validation loss decreased (-0.350865 --> -0.488074).  Saving model ...
Epoch: 5 cost time: 8.146198511123657
Epoch: 5, Steps: 32 | Train Loss: 8.165 Vali Loss: 64.365 Vali Acc: 0.519 Test Loss: 64.365 Test Acc: 0.519
Validation loss decreased (-0.488074 --> -0.518440).  Saving model ...
Epoch: 6 cost time: 8.167002201080322
Epoch: 6, Steps: 32 | Train Loss: 0.988 Vali Loss: 39.756 Vali Acc: 0.481 Test Loss: 39.756 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.135292291641235
Epoch: 7, Steps: 32 | Train Loss: 4.050 Vali Loss: 99.279 Vali Acc: 0.511 Test Loss: 99.279 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.224601745605469
Epoch: 8, Steps: 32 | Train Loss: 5.578 Vali Loss: 65.663 Vali Acc: 0.298 Test Loss: 65.663 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.397314310073853
Epoch: 9, Steps: 32 | Train Loss: 4.415 Vali Loss: 60.727 Vali Acc: 0.412 Test Loss: 60.727 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.202110052108765
Epoch: 10, Steps: 32 | Train Loss: 0.153 Vali Loss: 65.391 Vali Acc: 0.511 Test Loss: 65.391 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.213618755340576
Epoch: 11, Steps: 32 | Train Loss: 2.669 Vali Loss: 63.746 Vali Acc: 0.397 Test Loss: 63.746 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.317203760147095
Epoch: 12, Steps: 32 | Train Loss: 2.530 Vali Loss: 65.852 Vali Acc: 0.450 Test Loss: 65.852 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.181923866271973
Epoch: 13, Steps: 32 | Train Loss: 2.613 Vali Loss: 83.361 Vali Acc: 0.573 Test Loss: 83.361 Test Acc: 0.573
Validation loss decreased (-0.518440 --> -0.571685).  Saving model ...
Epoch: 14 cost time: 8.339363813400269
Epoch: 14, Steps: 32 | Train Loss: 1.960 Vali Loss: 76.160 Vali Acc: 0.527 Test Loss: 76.160 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.22148609161377
Epoch: 15, Steps: 32 | Train Loss: 0.409 Vali Loss: 78.299 Vali Acc: 0.427 Test Loss: 78.299 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.156521081924438
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.833 Vali Acc: 0.496 Test Loss: 88.833 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.226587533950806
Epoch: 17, Steps: 32 | Train Loss: 1.299 Vali Loss: 82.039 Vali Acc: 0.412 Test Loss: 82.039 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.360501766204834
Epoch: 18, Steps: 32 | Train Loss: 3.306 Vali Loss: 93.181 Vali Acc: 0.489 Test Loss: 93.181 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.23062777519226
Epoch: 19, Steps: 32 | Train Loss: 2.168 Vali Loss: 113.861 Vali Acc: 0.511 Test Loss: 113.861 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.229054927825928
Epoch: 20, Steps: 32 | Train Loss: 0.469 Vali Loss: 111.799 Vali Acc: 0.534 Test Loss: 111.799 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.299884796142578
Epoch: 21, Steps: 32 | Train Loss: 1.574 Vali Loss: 104.021 Vali Acc: 0.519 Test Loss: 104.021 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.300380229949951
Epoch: 22, Steps: 32 | Train Loss: 2.573 Vali Loss: 108.894 Vali Acc: 0.427 Test Loss: 108.894 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.15151834487915
Epoch: 23, Steps: 32 | Train Loss: 0.054 Vali Loss: 116.176 Vali Acc: 0.443 Test Loss: 116.176 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 9074845
model size : 43.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.73415231704712
Epoch: 1, Steps: 32 | Train Loss: 23.877 Vali Loss: 58.112 Vali Acc: 0.099 Test Loss: 58.112 Test Acc: 0.099
Validation loss decreased (inf --> -0.098656).  Saving model ...
Epoch: 2 cost time: 8.423028707504272
Epoch: 2, Steps: 32 | Train Loss: 29.194 Vali Loss: 20.657 Vali Acc: 0.244 Test Loss: 20.657 Test Acc: 0.244
Validation loss decreased (-0.098656 --> -0.244068).  Saving model ...
Epoch: 3 cost time: 8.33123779296875
Epoch: 3, Steps: 32 | Train Loss: 22.828 Vali Loss: 33.480 Vali Acc: 0.481 Test Loss: 33.480 Test Acc: 0.481
Validation loss decreased (-0.244068 --> -0.480581).  Saving model ...
Epoch: 4 cost time: 8.36306381225586
Epoch: 4, Steps: 32 | Train Loss: 17.617 Vali Loss: 45.209 Vali Acc: 0.260 Test Loss: 45.209 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.153912782669067
Epoch: 5, Steps: 32 | Train Loss: 12.081 Vali Loss: 52.008 Vali Acc: 0.496 Test Loss: 52.008 Test Acc: 0.496
Validation loss decreased (-0.480581 --> -0.495663).  Saving model ...
Epoch: 6 cost time: 8.132961750030518
Epoch: 6, Steps: 32 | Train Loss: 6.966 Vali Loss: 41.947 Vali Acc: 0.450 Test Loss: 41.947 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.291625738143921
Epoch: 7, Steps: 32 | Train Loss: 1.515 Vali Loss: 44.037 Vali Acc: 0.489 Test Loss: 44.037 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.238869190216064
Epoch: 8, Steps: 32 | Train Loss: 0.036 Vali Loss: 43.857 Vali Acc: 0.511 Test Loss: 43.857 Test Acc: 0.511
Validation loss decreased (-0.495663 --> -0.511012).  Saving model ...
Epoch: 9 cost time: 8.20614743232727
Epoch: 9, Steps: 32 | Train Loss: 0.328 Vali Loss: 62.405 Vali Acc: 0.519 Test Loss: 62.405 Test Acc: 0.519
Validation loss decreased (-0.511012 --> -0.518460).  Saving model ...
Epoch: 10 cost time: 8.322447299957275
Epoch: 10, Steps: 32 | Train Loss: 1.901 Vali Loss: 63.107 Vali Acc: 0.481 Test Loss: 63.107 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.210501909255981
Epoch: 11, Steps: 32 | Train Loss: 0.492 Vali Loss: 73.799 Vali Acc: 0.374 Test Loss: 73.799 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.424662351608276
Epoch: 12, Steps: 32 | Train Loss: 5.345 Vali Loss: 83.933 Vali Acc: 0.511 Test Loss: 83.933 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.283847570419312
Epoch: 13, Steps: 32 | Train Loss: 3.053 Vali Loss: 78.152 Vali Acc: 0.496 Test Loss: 78.152 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.222488403320312
Epoch: 14, Steps: 32 | Train Loss: 0.920 Vali Loss: 102.369 Vali Acc: 0.527 Test Loss: 102.369 Test Acc: 0.527
Validation loss decreased (-0.518460 --> -0.525694).  Saving model ...
Epoch: 15 cost time: 8.419464826583862
Epoch: 15, Steps: 32 | Train Loss: 3.600 Vali Loss: 93.761 Vali Acc: 0.466 Test Loss: 93.761 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.195719957351685
Epoch: 16, Steps: 32 | Train Loss: 3.285 Vali Loss: 86.355 Vali Acc: 0.405 Test Loss: 86.355 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.362457990646362
Epoch: 17, Steps: 32 | Train Loss: 1.574 Vali Loss: 91.071 Vali Acc: 0.420 Test Loss: 91.071 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.348259210586548
Epoch: 18, Steps: 32 | Train Loss: 0.268 Vali Loss: 95.305 Vali Acc: 0.458 Test Loss: 95.305 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.410717964172363
Epoch: 19, Steps: 32 | Train Loss: 1.142 Vali Loss: 102.391 Vali Acc: 0.458 Test Loss: 102.391 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.3780198097229
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.030 Vali Acc: 0.458 Test Loss: 98.030 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.312548875808716
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.157 Vali Acc: 0.458 Test Loss: 98.157 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.397701025009155
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.213 Vali Acc: 0.458 Test Loss: 98.213 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.448032855987549
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.215 Vali Acc: 0.458 Test Loss: 98.215 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.460723638534546
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.215 Vali Acc: 0.458 Test Loss: 98.215 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 8882973
model size : 42.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.634143352508545
Epoch: 1, Steps: 32 | Train Loss: 19.430 Vali Loss: 18.735 Vali Acc: 0.206 Test Loss: 18.735 Test Acc: 0.206
Validation loss decreased (inf --> -0.205920).  Saving model ...
Epoch: 2 cost time: 8.010174036026001
Epoch: 2, Steps: 32 | Train Loss: 21.716 Vali Loss: 20.979 Vali Acc: 0.473 Test Loss: 20.979 Test Acc: 0.473
Validation loss decreased (-0.205920 --> -0.473073).  Saving model ...
Epoch: 3 cost time: 7.902096748352051
Epoch: 3, Steps: 32 | Train Loss: 25.045 Vali Loss: 59.208 Vali Acc: 0.229 Test Loss: 59.208 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.028835773468018
Epoch: 4, Steps: 32 | Train Loss: 21.419 Vali Loss: 46.309 Vali Acc: 0.435 Test Loss: 46.309 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.984960317611694
Epoch: 5, Steps: 32 | Train Loss: 9.076 Vali Loss: 56.024 Vali Acc: 0.519 Test Loss: 56.024 Test Acc: 0.519
Validation loss decreased (-0.473073 --> -0.518524).  Saving model ...
Epoch: 6 cost time: 8.067667245864868
Epoch: 6, Steps: 32 | Train Loss: 3.843 Vali Loss: 49.793 Vali Acc: 0.504 Test Loss: 49.793 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.96404504776001
Epoch: 7, Steps: 32 | Train Loss: 5.759 Vali Loss: 78.945 Vali Acc: 0.496 Test Loss: 78.945 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.213806867599487
Epoch: 8, Steps: 32 | Train Loss: 4.004 Vali Loss: 82.562 Vali Acc: 0.489 Test Loss: 82.562 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.117412567138672
Epoch: 9, Steps: 32 | Train Loss: 2.134 Vali Loss: 74.798 Vali Acc: 0.534 Test Loss: 74.798 Test Acc: 0.534
Validation loss decreased (-0.518524 --> -0.533603).  Saving model ...
Epoch: 10 cost time: 7.940450191497803
Epoch: 10, Steps: 32 | Train Loss: 0.443 Vali Loss: 63.590 Vali Acc: 0.527 Test Loss: 63.590 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.025788068771362
Epoch: 11, Steps: 32 | Train Loss: 1.353 Vali Loss: 63.706 Vali Acc: 0.466 Test Loss: 63.706 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.088833570480347
Epoch: 12, Steps: 32 | Train Loss: 1.880 Vali Loss: 68.365 Vali Acc: 0.550 Test Loss: 68.365 Test Acc: 0.550
Validation loss decreased (-0.533603 --> -0.548935).  Saving model ...
Epoch: 13 cost time: 7.986231327056885
Epoch: 13, Steps: 32 | Train Loss: 1.207 Vali Loss: 79.114 Vali Acc: 0.534 Test Loss: 79.114 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.9056761264801025
Epoch: 14, Steps: 32 | Train Loss: 0.650 Vali Loss: 92.333 Vali Acc: 0.527 Test Loss: 92.333 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.04108190536499
Epoch: 15, Steps: 32 | Train Loss: 3.154 Vali Loss: 87.088 Vali Acc: 0.542 Test Loss: 87.088 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.128135919570923
Epoch: 16, Steps: 32 | Train Loss: 0.675 Vali Loss: 91.145 Vali Acc: 0.412 Test Loss: 91.145 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.942596435546875
Epoch: 17, Steps: 32 | Train Loss: 2.317 Vali Loss: 118.939 Vali Acc: 0.344 Test Loss: 118.939 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.992707252502441
Epoch: 18, Steps: 32 | Train Loss: 0.517 Vali Loss: 115.557 Vali Acc: 0.504 Test Loss: 115.557 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.881403207778931
Epoch: 19, Steps: 32 | Train Loss: 5.304 Vali Loss: 111.139 Vali Acc: 0.458 Test Loss: 111.139 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.983062982559204
Epoch: 20, Steps: 32 | Train Loss: 0.678 Vali Loss: 123.771 Vali Acc: 0.489 Test Loss: 123.771 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.963469743728638
Epoch: 21, Steps: 32 | Train Loss: 1.016 Vali Loss: 112.721 Vali Acc: 0.527 Test Loss: 112.721 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.118674516677856
Epoch: 22, Steps: 32 | Train Loss: 1.596 Vali Loss: 108.522 Vali Acc: 0.527 Test Loss: 108.522 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 8691101
model size : 42.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.573840141296387
Epoch: 1, Steps: 32 | Train Loss: 13.647 Vali Loss: 20.751 Vali Acc: 0.176 Test Loss: 20.751 Test Acc: 0.176
Validation loss decreased (inf --> -0.175365).  Saving model ...
Epoch: 2 cost time: 8.312156438827515
Epoch: 2, Steps: 32 | Train Loss: 39.370 Vali Loss: 69.024 Vali Acc: 0.420 Test Loss: 69.024 Test Acc: 0.420
Validation loss decreased (-0.175365 --> -0.419157).  Saving model ...
Epoch: 3 cost time: 8.21590781211853
Epoch: 3, Steps: 32 | Train Loss: 69.701 Vali Loss: 71.658 Vali Acc: 0.458 Test Loss: 71.658 Test Acc: 0.458
Validation loss decreased (-0.419157 --> -0.457299).  Saving model ...
Epoch: 4 cost time: 8.125332832336426
Epoch: 4, Steps: 32 | Train Loss: 29.737 Vali Loss: 48.808 Vali Acc: 0.427 Test Loss: 48.808 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.278094053268433
Epoch: 5, Steps: 32 | Train Loss: 8.432 Vali Loss: 56.685 Vali Acc: 0.496 Test Loss: 56.685 Test Acc: 0.496
Validation loss decreased (-0.457299 --> -0.495616).  Saving model ...
Epoch: 6 cost time: 8.288258790969849
Epoch: 6, Steps: 32 | Train Loss: 2.860 Vali Loss: 63.220 Vali Acc: 0.473 Test Loss: 63.220 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.29795527458191
Epoch: 7, Steps: 32 | Train Loss: 2.773 Vali Loss: 66.818 Vali Acc: 0.496 Test Loss: 66.818 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.226966857910156
Epoch: 8, Steps: 32 | Train Loss: 4.049 Vali Loss: 79.755 Vali Acc: 0.511 Test Loss: 79.755 Test Acc: 0.511
Validation loss decreased (-0.495616 --> -0.510653).  Saving model ...
Epoch: 9 cost time: 8.30706000328064
Epoch: 9, Steps: 32 | Train Loss: 5.770 Vali Loss: 67.628 Vali Acc: 0.489 Test Loss: 67.628 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.22525405883789
Epoch: 10, Steps: 32 | Train Loss: 0.637 Vali Loss: 75.276 Vali Acc: 0.489 Test Loss: 75.276 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.185246706008911
Epoch: 11, Steps: 32 | Train Loss: 1.226 Vali Loss: 92.008 Vali Acc: 0.466 Test Loss: 92.008 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.220102787017822
Epoch: 12, Steps: 32 | Train Loss: 4.434 Vali Loss: 73.715 Vali Acc: 0.550 Test Loss: 73.715 Test Acc: 0.550
Validation loss decreased (-0.510653 --> -0.548881).  Saving model ...
Epoch: 13 cost time: 8.268947124481201
Epoch: 13, Steps: 32 | Train Loss: 0.493 Vali Loss: 93.261 Vali Acc: 0.496 Test Loss: 93.261 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.345532655715942
Epoch: 14, Steps: 32 | Train Loss: 2.541 Vali Loss: 80.703 Vali Acc: 0.504 Test Loss: 80.703 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.332544803619385
Epoch: 15, Steps: 32 | Train Loss: 1.214 Vali Loss: 95.782 Vali Acc: 0.511 Test Loss: 95.782 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.48846697807312
Epoch: 16, Steps: 32 | Train Loss: 1.347 Vali Loss: 89.305 Vali Acc: 0.504 Test Loss: 89.305 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.55253791809082
Epoch: 17, Steps: 32 | Train Loss: 0.213 Vali Loss: 94.957 Vali Acc: 0.443 Test Loss: 94.957 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.469228982925415
Epoch: 18, Steps: 32 | Train Loss: 0.516 Vali Loss: 114.093 Vali Acc: 0.527 Test Loss: 114.093 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.300769090652466
Epoch: 19, Steps: 32 | Train Loss: 0.777 Vali Loss: 105.272 Vali Acc: 0.542 Test Loss: 105.272 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.620611190795898
Epoch: 20, Steps: 32 | Train Loss: 0.383 Vali Loss: 106.965 Vali Acc: 0.534 Test Loss: 106.965 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.484273195266724
Epoch: 21, Steps: 32 | Train Loss: 0.547 Vali Loss: 103.885 Vali Acc: 0.481 Test Loss: 103.885 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.378388404846191
Epoch: 22, Steps: 32 | Train Loss: 2.788 Vali Loss: 129.188 Vali Acc: 0.481 Test Loss: 129.188 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 8871965
model size : 42.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.693295001983643
Epoch: 1, Steps: 32 | Train Loss: 20.665 Vali Loss: 20.321 Vali Acc: 0.420 Test Loss: 20.321 Test Acc: 0.420
Validation loss decreased (inf --> -0.419644).  Saving model ...
Epoch: 2 cost time: 8.090789318084717
Epoch: 2, Steps: 32 | Train Loss: 38.986 Vali Loss: 30.396 Vali Acc: 0.435 Test Loss: 30.396 Test Acc: 0.435
Validation loss decreased (-0.419644 --> -0.434811).  Saving model ...
Epoch: 3 cost time: 8.2542245388031
Epoch: 3, Steps: 32 | Train Loss: 36.300 Vali Loss: 47.064 Vali Acc: 0.481 Test Loss: 47.064 Test Acc: 0.481
Validation loss decreased (-0.434811 --> -0.480445).  Saving model ...
Epoch: 4 cost time: 8.20500373840332
Epoch: 4, Steps: 32 | Train Loss: 17.399 Vali Loss: 43.775 Vali Acc: 0.382 Test Loss: 43.775 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.23062014579773
Epoch: 5, Steps: 32 | Train Loss: 15.360 Vali Loss: 56.698 Vali Acc: 0.511 Test Loss: 56.698 Test Acc: 0.511
Validation loss decreased (-0.480445 --> -0.510883).  Saving model ...
Epoch: 6 cost time: 8.417015075683594
Epoch: 6, Steps: 32 | Train Loss: 11.104 Vali Loss: 73.427 Vali Acc: 0.496 Test Loss: 73.427 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.472025156021118
Epoch: 7, Steps: 32 | Train Loss: 8.951 Vali Loss: 74.627 Vali Acc: 0.351 Test Loss: 74.627 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.485249042510986
Epoch: 8, Steps: 32 | Train Loss: 4.781 Vali Loss: 72.634 Vali Acc: 0.458 Test Loss: 72.634 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.306005001068115
Epoch: 9, Steps: 32 | Train Loss: 0.213 Vali Loss: 84.903 Vali Acc: 0.489 Test Loss: 84.903 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.222525596618652
Epoch: 10, Steps: 32 | Train Loss: 2.279 Vali Loss: 80.529 Vali Acc: 0.542 Test Loss: 80.529 Test Acc: 0.542
Validation loss decreased (-0.510883 --> -0.541179).  Saving model ...
Epoch: 11 cost time: 8.362610101699829
Epoch: 11, Steps: 32 | Train Loss: 0.189 Vali Loss: 76.989 Vali Acc: 0.473 Test Loss: 76.989 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.300539493560791
Epoch: 12, Steps: 32 | Train Loss: 1.577 Vali Loss: 82.051 Vali Acc: 0.450 Test Loss: 82.051 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.693828344345093
Epoch: 13, Steps: 32 | Train Loss: 0.937 Vali Loss: 82.178 Vali Acc: 0.466 Test Loss: 82.178 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.32270884513855
Epoch: 14, Steps: 32 | Train Loss: 0.609 Vali Loss: 83.752 Vali Acc: 0.542 Test Loss: 83.752 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.36840271949768
Epoch: 15, Steps: 32 | Train Loss: 0.966 Vali Loss: 83.910 Vali Acc: 0.466 Test Loss: 83.910 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.576608657836914
Epoch: 16, Steps: 32 | Train Loss: 0.987 Vali Loss: 83.345 Vali Acc: 0.511 Test Loss: 83.345 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.260522842407227
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.425 Vali Acc: 0.427 Test Loss: 87.425 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.416086912155151
Epoch: 18, Steps: 32 | Train Loss: 0.334 Vali Loss: 88.919 Vali Acc: 0.511 Test Loss: 88.919 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.328693151473999
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.301 Vali Acc: 0.527 Test Loss: 108.301 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.145405292510986
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.937 Vali Acc: 0.519 Test Loss: 108.937 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 8680093
model size : 41.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.409895896911621
Epoch: 1, Steps: 32 | Train Loss: 18.157 Vali Loss: 38.689 Vali Acc: 0.137 Test Loss: 38.689 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 8.244276285171509
Epoch: 2, Steps: 32 | Train Loss: 48.066 Vali Loss: 40.377 Vali Acc: 0.176 Test Loss: 40.377 Test Acc: 0.176
Validation loss decreased (-0.137018 --> -0.175169).  Saving model ...
Epoch: 3 cost time: 8.151297092437744
Epoch: 3, Steps: 32 | Train Loss: 21.562 Vali Loss: 45.734 Vali Acc: 0.382 Test Loss: 45.734 Test Acc: 0.382
Validation loss decreased (-0.175169 --> -0.381222).  Saving model ...
Epoch: 4 cost time: 8.274101257324219
Epoch: 4, Steps: 32 | Train Loss: 15.405 Vali Loss: 36.903 Vali Acc: 0.496 Test Loss: 36.903 Test Acc: 0.496
Validation loss decreased (-0.381222 --> -0.495814).  Saving model ...
Epoch: 5 cost time: 8.237041234970093
Epoch: 5, Steps: 32 | Train Loss: 9.278 Vali Loss: 50.655 Vali Acc: 0.359 Test Loss: 50.655 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.073287725448608
Epoch: 6, Steps: 32 | Train Loss: 3.886 Vali Loss: 53.643 Vali Acc: 0.489 Test Loss: 53.643 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.116026878356934
Epoch: 7, Steps: 32 | Train Loss: 7.407 Vali Loss: 79.822 Vali Acc: 0.473 Test Loss: 79.822 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.128528594970703
Epoch: 8, Steps: 32 | Train Loss: 4.806 Vali Loss: 57.750 Vali Acc: 0.382 Test Loss: 57.750 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.297330141067505
Epoch: 9, Steps: 32 | Train Loss: 2.175 Vali Loss: 99.205 Vali Acc: 0.489 Test Loss: 99.205 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.225908041000366
Epoch: 10, Steps: 32 | Train Loss: 2.516 Vali Loss: 67.892 Vali Acc: 0.412 Test Loss: 67.892 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.218050003051758
Epoch: 11, Steps: 32 | Train Loss: 0.345 Vali Loss: 73.034 Vali Acc: 0.504 Test Loss: 73.034 Test Acc: 0.504
Validation loss decreased (-0.495814 --> -0.503086).  Saving model ...
Epoch: 12 cost time: 8.252955913543701
Epoch: 12, Steps: 32 | Train Loss: 0.108 Vali Loss: 90.186 Vali Acc: 0.466 Test Loss: 90.186 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.212336778640747
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.262 Vali Acc: 0.466 Test Loss: 91.262 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.02558422088623
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.273 Vali Acc: 0.466 Test Loss: 91.273 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.09279203414917
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.080363988876343
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.186231136322021
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.217425346374512
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.213989734649658
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.266813278198242
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.084285974502563
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.272 Vali Acc: 0.466 Test Loss: 91.272 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 8488221
model size : 41.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.03228497505188
Epoch: 1, Steps: 32 | Train Loss: 17.558 Vali Loss: 29.820 Vali Acc: 0.122 Test Loss: 29.820 Test Acc: 0.122
Validation loss decreased (inf --> -0.121839).  Saving model ...
Epoch: 2 cost time: 7.899069309234619
Epoch: 2, Steps: 32 | Train Loss: 51.496 Vali Loss: 97.920 Vali Acc: 0.183 Test Loss: 97.920 Test Acc: 0.183
Validation loss decreased (-0.121839 --> -0.182227).  Saving model ...
Epoch: 3 cost time: 8.02689266204834
Epoch: 3, Steps: 32 | Train Loss: 60.183 Vali Loss: 46.533 Vali Acc: 0.168 Test Loss: 46.533 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.861905336380005
Epoch: 4, Steps: 32 | Train Loss: 20.291 Vali Loss: 45.275 Vali Acc: 0.313 Test Loss: 45.275 Test Acc: 0.313
Validation loss decreased (-0.182227 --> -0.312524).  Saving model ...
Epoch: 5 cost time: 8.060579299926758
Epoch: 5, Steps: 32 | Train Loss: 7.590 Vali Loss: 64.904 Vali Acc: 0.481 Test Loss: 64.904 Test Acc: 0.481
Validation loss decreased (-0.312524 --> -0.480267).  Saving model ...
Epoch: 6 cost time: 7.865557909011841
Epoch: 6, Steps: 32 | Train Loss: 19.946 Vali Loss: 63.010 Vali Acc: 0.443 Test Loss: 63.010 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.955212831497192
Epoch: 7, Steps: 32 | Train Loss: 11.829 Vali Loss: 58.587 Vali Acc: 0.496 Test Loss: 58.587 Test Acc: 0.496
Validation loss decreased (-0.480267 --> -0.495597).  Saving model ...
Epoch: 8 cost time: 8.020018339157104
Epoch: 8, Steps: 32 | Train Loss: 2.895 Vali Loss: 78.518 Vali Acc: 0.542 Test Loss: 78.518 Test Acc: 0.542
Validation loss decreased (-0.495597 --> -0.541200).  Saving model ...
Epoch: 9 cost time: 7.9655749797821045
Epoch: 9, Steps: 32 | Train Loss: 0.244 Vali Loss: 76.265 Vali Acc: 0.489 Test Loss: 76.265 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.852942943572998
Epoch: 10, Steps: 32 | Train Loss: 0.322 Vali Loss: 91.226 Vali Acc: 0.534 Test Loss: 91.226 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.919070720672607
Epoch: 11, Steps: 32 | Train Loss: 0.622 Vali Loss: 74.159 Vali Acc: 0.443 Test Loss: 74.159 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.817614316940308
Epoch: 12, Steps: 32 | Train Loss: 0.507 Vali Loss: 82.764 Vali Acc: 0.412 Test Loss: 82.764 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.86452841758728
Epoch: 13, Steps: 32 | Train Loss: 1.987 Vali Loss: 86.616 Vali Acc: 0.420 Test Loss: 86.616 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.909956693649292
Epoch: 14, Steps: 32 | Train Loss: 1.159 Vali Loss: 99.976 Vali Acc: 0.481 Test Loss: 99.976 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.01070523262024
Epoch: 15, Steps: 32 | Train Loss: 0.330 Vali Loss: 105.412 Vali Acc: 0.511 Test Loss: 105.412 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.8481245040893555
Epoch: 16, Steps: 32 | Train Loss: 1.752 Vali Loss: 85.675 Vali Acc: 0.374 Test Loss: 85.675 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.809505939483643
Epoch: 17, Steps: 32 | Train Loss: 6.643 Vali Loss: 92.573 Vali Acc: 0.466 Test Loss: 92.573 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.830130577087402
Epoch: 18, Steps: 32 | Train Loss: 4.838 Vali Loss: 88.993 Vali Acc: 0.405 Test Loss: 88.993 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 8296349
model size : 40.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.682796478271484
Epoch: 1, Steps: 32 | Train Loss: 28.263 Vali Loss: 73.857 Vali Acc: 0.137 Test Loss: 73.857 Test Acc: 0.137
Validation loss decreased (inf --> -0.136666).  Saving model ...
Epoch: 2 cost time: 8.157942056655884
Epoch: 2, Steps: 32 | Train Loss: 51.362 Vali Loss: 31.340 Vali Acc: 0.420 Test Loss: 31.340 Test Acc: 0.420
Validation loss decreased (-0.136666 --> -0.419534).  Saving model ...
Epoch: 3 cost time: 8.257367849349976
Epoch: 3, Steps: 32 | Train Loss: 68.889 Vali Loss: 78.888 Vali Acc: 0.168 Test Loss: 78.888 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.229410886764526
Epoch: 4, Steps: 32 | Train Loss: 32.868 Vali Loss: 34.230 Vali Acc: 0.466 Test Loss: 34.230 Test Acc: 0.466
Validation loss decreased (-0.419534 --> -0.465307).  Saving model ...
Epoch: 5 cost time: 8.102865934371948
Epoch: 5, Steps: 32 | Train Loss: 10.226 Vali Loss: 41.275 Vali Acc: 0.443 Test Loss: 41.275 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.09726333618164
Epoch: 6, Steps: 32 | Train Loss: 4.057 Vali Loss: 60.292 Vali Acc: 0.275 Test Loss: 60.292 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.094890117645264
Epoch: 7, Steps: 32 | Train Loss: 4.210 Vali Loss: 80.782 Vali Acc: 0.534 Test Loss: 80.782 Test Acc: 0.534
Validation loss decreased (-0.465307 --> -0.533543).  Saving model ...
Epoch: 8 cost time: 8.33624529838562
Epoch: 8, Steps: 32 | Train Loss: 3.515 Vali Loss: 76.154 Vali Acc: 0.542 Test Loss: 76.154 Test Acc: 0.542
Validation loss decreased (-0.533543 --> -0.541223).  Saving model ...
Epoch: 9 cost time: 8.160225629806519
Epoch: 9, Steps: 32 | Train Loss: 0.705 Vali Loss: 96.842 Vali Acc: 0.504 Test Loss: 96.842 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.14499545097351
Epoch: 10, Steps: 32 | Train Loss: 2.662 Vali Loss: 81.164 Vali Acc: 0.359 Test Loss: 81.164 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.264618396759033
Epoch: 11, Steps: 32 | Train Loss: 3.948 Vali Loss: 87.595 Vali Acc: 0.481 Test Loss: 87.595 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.181174755096436
Epoch: 12, Steps: 32 | Train Loss: 3.205 Vali Loss: 100.573 Vali Acc: 0.519 Test Loss: 100.573 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.15832233428955
Epoch: 13, Steps: 32 | Train Loss: 1.962 Vali Loss: 108.323 Vali Acc: 0.504 Test Loss: 108.323 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.246953010559082
Epoch: 14, Steps: 32 | Train Loss: 5.409 Vali Loss: 111.151 Vali Acc: 0.427 Test Loss: 111.151 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.052765130996704
Epoch: 15, Steps: 32 | Train Loss: 2.379 Vali Loss: 96.408 Vali Acc: 0.481 Test Loss: 96.408 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.177152872085571
Epoch: 16, Steps: 32 | Train Loss: 1.083 Vali Loss: 98.205 Vali Acc: 0.489 Test Loss: 98.205 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.27770447731018
Epoch: 17, Steps: 32 | Train Loss: 1.182 Vali Loss: 119.789 Vali Acc: 0.382 Test Loss: 119.789 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.300311803817749
Epoch: 18, Steps: 32 | Train Loss: 2.498 Vali Loss: 106.497 Vali Acc: 0.458 Test Loss: 106.497 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 8674589
model size : 41.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.70066237449646
Epoch: 1, Steps: 32 | Train Loss: 18.615 Vali Loss: 33.796 Vali Acc: 0.168 Test Loss: 33.796 Test Acc: 0.168
Validation loss decreased (inf --> -0.167601).  Saving model ...
Epoch: 2 cost time: 8.20068907737732
Epoch: 2, Steps: 32 | Train Loss: 64.503 Vali Loss: 103.960 Vali Acc: 0.176 Test Loss: 103.960 Test Acc: 0.176
Validation loss decreased (-0.167601 --> -0.174533).  Saving model ...
Epoch: 3 cost time: 8.118186235427856
Epoch: 3, Steps: 32 | Train Loss: 48.876 Vali Loss: 39.699 Vali Acc: 0.458 Test Loss: 39.699 Test Acc: 0.458
Validation loss decreased (-0.174533 --> -0.457618).  Saving model ...
Epoch: 4 cost time: 8.117952823638916
Epoch: 4, Steps: 32 | Train Loss: 17.763 Vali Loss: 35.342 Vali Acc: 0.511 Test Loss: 35.342 Test Acc: 0.511
Validation loss decreased (-0.457618 --> -0.511097).  Saving model ...
Epoch: 5 cost time: 8.334102630615234
Epoch: 5, Steps: 32 | Train Loss: 10.781 Vali Loss: 51.930 Vali Acc: 0.328 Test Loss: 51.930 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.375315189361572
Epoch: 6, Steps: 32 | Train Loss: 7.120 Vali Loss: 87.554 Vali Acc: 0.519 Test Loss: 87.554 Test Acc: 0.519
Validation loss decreased (-0.511097 --> -0.518208).  Saving model ...
Epoch: 7 cost time: 8.455441951751709
Epoch: 7, Steps: 32 | Train Loss: 9.796 Vali Loss: 69.777 Vali Acc: 0.527 Test Loss: 69.777 Test Acc: 0.527
Validation loss decreased (-0.518208 --> -0.526020).  Saving model ...
Epoch: 8 cost time: 8.2556791305542
Epoch: 8, Steps: 32 | Train Loss: 0.085 Vali Loss: 82.664 Vali Acc: 0.511 Test Loss: 82.664 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.440348148345947
Epoch: 9, Steps: 32 | Train Loss: 0.651 Vali Loss: 63.054 Vali Acc: 0.489 Test Loss: 63.054 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.361375570297241
Epoch: 10, Steps: 32 | Train Loss: 0.731 Vali Loss: 89.710 Vali Acc: 0.511 Test Loss: 89.710 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.406676054000854
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.052 Vali Acc: 0.435 Test Loss: 72.052 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.454727172851562
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.217 Vali Acc: 0.427 Test Loss: 72.217 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.312443256378174
Epoch: 13, Steps: 32 | Train Loss: 0.457 Vali Loss: 91.603 Vali Acc: 0.496 Test Loss: 91.603 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.427892446517944
Epoch: 14, Steps: 32 | Train Loss: 4.685 Vali Loss: 92.075 Vali Acc: 0.450 Test Loss: 92.075 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.288330554962158
Epoch: 15, Steps: 32 | Train Loss: 4.835 Vali Loss: 103.372 Vali Acc: 0.443 Test Loss: 103.372 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.489476680755615
Epoch: 16, Steps: 32 | Train Loss: 3.066 Vali Loss: 99.684 Vali Acc: 0.443 Test Loss: 99.684 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.4588942527771
Epoch: 17, Steps: 32 | Train Loss: 0.683 Vali Loss: 100.433 Vali Acc: 0.534 Test Loss: 100.433 Test Acc: 0.534
Validation loss decreased (-0.526020 --> -0.533347).  Saving model ...
Epoch: 18 cost time: 8.50956392288208
Epoch: 18, Steps: 32 | Train Loss: 0.396 Vali Loss: 89.696 Vali Acc: 0.466 Test Loss: 89.696 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.391827821731567
Epoch: 19, Steps: 32 | Train Loss: 0.515 Vali Loss: 95.412 Vali Acc: 0.481 Test Loss: 95.412 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.3880136013031
Epoch: 20, Steps: 32 | Train Loss: 1.710 Vali Loss: 100.145 Vali Acc: 0.496 Test Loss: 100.145 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.576338052749634
Epoch: 21, Steps: 32 | Train Loss: 0.006 Vali Loss: 139.260 Vali Acc: 0.519 Test Loss: 139.260 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 8.39245891571045
Epoch: 22, Steps: 32 | Train Loss: 0.583 Vali Loss: 134.867 Vali Acc: 0.481 Test Loss: 134.867 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 8.39806318283081
Epoch: 23, Steps: 32 | Train Loss: 0.939 Vali Loss: 111.870 Vali Acc: 0.450 Test Loss: 111.870 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.482116460800171
Epoch: 24, Steps: 32 | Train Loss: 0.508 Vali Loss: 127.136 Vali Acc: 0.519 Test Loss: 127.136 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.533611059188843
Epoch: 25, Steps: 32 | Train Loss: 0.001 Vali Loss: 116.480 Vali Acc: 0.420 Test Loss: 116.480 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 8.561455726623535
Epoch: 26, Steps: 32 | Train Loss: 0.543 Vali Loss: 124.868 Vali Acc: 0.519 Test Loss: 124.868 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 8.275632619857788
Epoch: 27, Steps: 32 | Train Loss: 0.410 Vali Loss: 159.542 Vali Acc: 0.443 Test Loss: 159.542 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 8482717
model size : 41.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.349436521530151
Epoch: 1, Steps: 32 | Train Loss: 21.527 Vali Loss: 15.784 Vali Acc: 0.420 Test Loss: 15.784 Test Acc: 0.420
Validation loss decreased (inf --> -0.419689).  Saving model ...
Epoch: 2 cost time: 8.275622367858887
Epoch: 2, Steps: 32 | Train Loss: 30.888 Vali Loss: 12.763 Vali Acc: 0.191 Test Loss: 12.763 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.170345306396484
Epoch: 3, Steps: 32 | Train Loss: 37.149 Vali Loss: 33.015 Vali Acc: 0.160 Test Loss: 33.015 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.129127502441406
Epoch: 4, Steps: 32 | Train Loss: 23.977 Vali Loss: 37.523 Vali Acc: 0.351 Test Loss: 37.523 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.199135780334473
Epoch: 5, Steps: 32 | Train Loss: 15.970 Vali Loss: 63.116 Vali Acc: 0.481 Test Loss: 63.116 Test Acc: 0.481
Validation loss decreased (-0.419689 --> -0.480285).  Saving model ...
Epoch: 6 cost time: 8.181451320648193
Epoch: 6, Steps: 32 | Train Loss: 10.443 Vali Loss: 69.812 Vali Acc: 0.481 Test Loss: 69.812 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.03422737121582
Epoch: 7, Steps: 32 | Train Loss: 9.819 Vali Loss: 64.752 Vali Acc: 0.466 Test Loss: 64.752 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.30935788154602
Epoch: 8, Steps: 32 | Train Loss: 2.977 Vali Loss: 73.148 Vali Acc: 0.481 Test Loss: 73.148 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.333364486694336
Epoch: 9, Steps: 32 | Train Loss: 1.264 Vali Loss: 87.595 Vali Acc: 0.565 Test Loss: 87.595 Test Acc: 0.565
Validation loss decreased (-0.480285 --> -0.564010).  Saving model ...
Epoch: 10 cost time: 8.29450535774231
Epoch: 10, Steps: 32 | Train Loss: 2.647 Vali Loss: 83.892 Vali Acc: 0.527 Test Loss: 83.892 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.180999517440796
Epoch: 11, Steps: 32 | Train Loss: 0.450 Vali Loss: 77.720 Vali Acc: 0.481 Test Loss: 77.720 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.472314357757568
Epoch: 12, Steps: 32 | Train Loss: 1.024 Vali Loss: 79.812 Vali Acc: 0.504 Test Loss: 79.812 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.208693742752075
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.755 Vali Acc: 0.511 Test Loss: 81.755 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.371524572372437
Epoch: 14, Steps: 32 | Train Loss: 0.082 Vali Loss: 90.381 Vali Acc: 0.435 Test Loss: 90.381 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.17255973815918
Epoch: 15, Steps: 32 | Train Loss: 0.546 Vali Loss: 114.748 Vali Acc: 0.504 Test Loss: 114.748 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.240707874298096
Epoch: 16, Steps: 32 | Train Loss: 0.174 Vali Loss: 107.142 Vali Acc: 0.504 Test Loss: 107.142 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.522255659103394
Epoch: 17, Steps: 32 | Train Loss: 1.498 Vali Loss: 107.629 Vali Acc: 0.466 Test Loss: 107.629 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.118566036224365
Epoch: 18, Steps: 32 | Train Loss: 3.045 Vali Loss: 115.586 Vali Acc: 0.305 Test Loss: 115.586 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.20151424407959
Epoch: 19, Steps: 32 | Train Loss: 2.649 Vali Loss: 98.153 Vali Acc: 0.443 Test Loss: 98.153 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 8290845
model size : 40.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.343989849090576
Epoch: 1, Steps: 32 | Train Loss: 27.275 Vali Loss: 31.099 Vali Acc: 0.420 Test Loss: 31.099 Test Acc: 0.420
Validation loss decreased (inf --> -0.419536).  Saving model ...
Epoch: 2 cost time: 7.84114933013916
Epoch: 2, Steps: 32 | Train Loss: 38.402 Vali Loss: 44.070 Vali Acc: 0.168 Test Loss: 44.070 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.893783330917358
Epoch: 3, Steps: 32 | Train Loss: 45.127 Vali Loss: 60.213 Vali Acc: 0.191 Test Loss: 60.213 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.853027582168579
Epoch: 4, Steps: 32 | Train Loss: 20.941 Vali Loss: 46.812 Vali Acc: 0.427 Test Loss: 46.812 Test Acc: 0.427
Validation loss decreased (-0.419536 --> -0.427013).  Saving model ...
Epoch: 5 cost time: 7.895837306976318
Epoch: 5, Steps: 32 | Train Loss: 7.987 Vali Loss: 43.228 Vali Acc: 0.412 Test Loss: 43.228 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.973943471908569
Epoch: 6, Steps: 32 | Train Loss: 11.420 Vali Loss: 62.654 Vali Acc: 0.305 Test Loss: 62.654 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.853874206542969
Epoch: 7, Steps: 32 | Train Loss: 5.913 Vali Loss: 77.686 Vali Acc: 0.557 Test Loss: 77.686 Test Acc: 0.557
Validation loss decreased (-0.427013 --> -0.556475).  Saving model ...
Epoch: 8 cost time: 7.851795196533203
Epoch: 8, Steps: 32 | Train Loss: 4.764 Vali Loss: 81.502 Vali Acc: 0.489 Test Loss: 81.502 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.908801078796387
Epoch: 9, Steps: 32 | Train Loss: 3.882 Vali Loss: 77.105 Vali Acc: 0.496 Test Loss: 77.105 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.903268098831177
Epoch: 10, Steps: 32 | Train Loss: 1.420 Vali Loss: 121.560 Vali Acc: 0.511 Test Loss: 121.560 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.970357894897461
Epoch: 11, Steps: 32 | Train Loss: 2.505 Vali Loss: 104.176 Vali Acc: 0.527 Test Loss: 104.176 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.006716966629028
Epoch: 12, Steps: 32 | Train Loss: 1.274 Vali Loss: 83.471 Vali Acc: 0.496 Test Loss: 83.471 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.051731586456299
Epoch: 13, Steps: 32 | Train Loss: 0.157 Vali Loss: 102.272 Vali Acc: 0.527 Test Loss: 102.272 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.05869722366333
Epoch: 14, Steps: 32 | Train Loss: 0.840 Vali Loss: 81.949 Vali Acc: 0.481 Test Loss: 81.949 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.976233959197998
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.329 Vali Acc: 0.489 Test Loss: 81.329 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.869248867034912
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.361 Vali Acc: 0.489 Test Loss: 81.361 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.054595232009888
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.362 Vali Acc: 0.489 Test Loss: 81.362 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 8098973
model size : 39.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.843693733215332
Epoch: 1, Steps: 32 | Train Loss: 33.273 Vali Loss: 47.761 Vali Acc: 0.168 Test Loss: 47.761 Test Acc: 0.168
Validation loss decreased (inf --> -0.167461).  Saving model ...
Epoch: 2 cost time: 8.168855905532837
Epoch: 2, Steps: 32 | Train Loss: 49.747 Vali Loss: 34.902 Vali Acc: 0.420 Test Loss: 34.902 Test Acc: 0.420
Validation loss decreased (-0.167461 --> -0.419498).  Saving model ...
Epoch: 3 cost time: 8.174199342727661
Epoch: 3, Steps: 32 | Train Loss: 36.883 Vali Loss: 45.403 Vali Acc: 0.435 Test Loss: 45.403 Test Acc: 0.435
Validation loss decreased (-0.419498 --> -0.434660).  Saving model ...
Epoch: 4 cost time: 8.147094011306763
Epoch: 4, Steps: 32 | Train Loss: 23.529 Vali Loss: 57.688 Vali Acc: 0.435 Test Loss: 57.688 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.273415565490723
Epoch: 5, Steps: 32 | Train Loss: 15.687 Vali Loss: 54.397 Vali Acc: 0.504 Test Loss: 54.397 Test Acc: 0.504
Validation loss decreased (-0.434660 --> -0.503273).  Saving model ...
Epoch: 6 cost time: 8.269033432006836
Epoch: 6, Steps: 32 | Train Loss: 6.159 Vali Loss: 42.900 Vali Acc: 0.504 Test Loss: 42.900 Test Acc: 0.504
Validation loss decreased (-0.503273 --> -0.503388).  Saving model ...
Epoch: 7 cost time: 8.241804122924805
Epoch: 7, Steps: 32 | Train Loss: 4.616 Vali Loss: 69.212 Vali Acc: 0.351 Test Loss: 69.212 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.265660524368286
Epoch: 8, Steps: 32 | Train Loss: 5.946 Vali Loss: 56.718 Vali Acc: 0.534 Test Loss: 56.718 Test Acc: 0.534
Validation loss decreased (-0.503388 --> -0.533784).  Saving model ...
Epoch: 9 cost time: 8.258530855178833
Epoch: 9, Steps: 32 | Train Loss: 3.284 Vali Loss: 78.577 Vali Acc: 0.504 Test Loss: 78.577 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.421794176101685
Epoch: 10, Steps: 32 | Train Loss: 4.904 Vali Loss: 77.793 Vali Acc: 0.519 Test Loss: 77.793 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.315173387527466
Epoch: 11, Steps: 32 | Train Loss: 4.003 Vali Loss: 73.243 Vali Acc: 0.511 Test Loss: 73.243 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.245903015136719
Epoch: 12, Steps: 32 | Train Loss: 1.147 Vali Loss: 91.916 Vali Acc: 0.550 Test Loss: 91.916 Test Acc: 0.550
Validation loss decreased (-0.533784 --> -0.548699).  Saving model ...
Epoch: 13 cost time: 8.206338167190552
Epoch: 13, Steps: 32 | Train Loss: 1.354 Vali Loss: 111.460 Vali Acc: 0.511 Test Loss: 111.460 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.120993375778198
Epoch: 14, Steps: 32 | Train Loss: 1.437 Vali Loss: 94.637 Vali Acc: 0.534 Test Loss: 94.637 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.125057697296143
Epoch: 15, Steps: 32 | Train Loss: 0.954 Vali Loss: 82.216 Vali Acc: 0.519 Test Loss: 82.216 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.334247350692749
Epoch: 16, Steps: 32 | Train Loss: 0.401 Vali Loss: 98.000 Vali Acc: 0.542 Test Loss: 98.000 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.146066427230835
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.259 Vali Acc: 0.511 Test Loss: 100.259 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.377605438232422
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.491 Vali Acc: 0.511 Test Loss: 100.491 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.33802580833435
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.500 Vali Acc: 0.511 Test Loss: 100.500 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.325358390808105
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.500 Vali Acc: 0.511 Test Loss: 100.500 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.261237382888794
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.500 Vali Acc: 0.511 Test Loss: 100.500 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.403019189834595
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 100.500 Vali Acc: 0.511 Test Loss: 100.500 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 8575901
model size : 41.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.46610164642334
Epoch: 1, Steps: 32 | Train Loss: 14.442 Vali Loss: 23.005 Vali Acc: 0.420 Test Loss: 23.005 Test Acc: 0.420
Validation loss decreased (inf --> -0.419617).  Saving model ...
Epoch: 2 cost time: 8.095552444458008
Epoch: 2, Steps: 32 | Train Loss: 34.536 Vali Loss: 39.739 Vali Acc: 0.168 Test Loss: 39.739 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.285117626190186
Epoch: 3, Steps: 32 | Train Loss: 58.297 Vali Loss: 51.153 Vali Acc: 0.244 Test Loss: 51.153 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.358680248260498
Epoch: 4, Steps: 32 | Train Loss: 40.580 Vali Loss: 61.076 Vali Acc: 0.481 Test Loss: 61.076 Test Acc: 0.481
Validation loss decreased (-0.419617 --> -0.480305).  Saving model ...
Epoch: 5 cost time: 8.350537061691284
Epoch: 5, Steps: 32 | Train Loss: 14.023 Vali Loss: 62.283 Vali Acc: 0.489 Test Loss: 62.283 Test Acc: 0.489
Validation loss decreased (-0.480305 --> -0.487927).  Saving model ...
Epoch: 6 cost time: 8.286524534225464
Epoch: 6, Steps: 32 | Train Loss: 13.351 Vali Loss: 62.268 Vali Acc: 0.550 Test Loss: 62.268 Test Acc: 0.550
Validation loss decreased (-0.487927 --> -0.548996).  Saving model ...
Epoch: 7 cost time: 8.195608377456665
Epoch: 7, Steps: 32 | Train Loss: 10.869 Vali Loss: 60.029 Vali Acc: 0.519 Test Loss: 60.029 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.425130128860474
Epoch: 8, Steps: 32 | Train Loss: 3.435 Vali Loss: 61.396 Vali Acc: 0.550 Test Loss: 61.396 Test Acc: 0.550
Validation loss decreased (-0.548996 --> -0.549004).  Saving model ...
Epoch: 9 cost time: 8.29955267906189
Epoch: 9, Steps: 32 | Train Loss: 1.092 Vali Loss: 65.194 Vali Acc: 0.511 Test Loss: 65.194 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.303726196289062
Epoch: 10, Steps: 32 | Train Loss: 0.945 Vali Loss: 56.740 Vali Acc: 0.450 Test Loss: 56.740 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.129987955093384
Epoch: 11, Steps: 32 | Train Loss: 0.173 Vali Loss: 84.893 Vali Acc: 0.573 Test Loss: 84.893 Test Acc: 0.573
Validation loss decreased (-0.549004 --> -0.571670).  Saving model ...
Epoch: 12 cost time: 8.0665442943573
Epoch: 12, Steps: 32 | Train Loss: 0.471 Vali Loss: 65.536 Vali Acc: 0.504 Test Loss: 65.536 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.153120994567871
Epoch: 13, Steps: 32 | Train Loss: 0.186 Vali Loss: 61.023 Vali Acc: 0.450 Test Loss: 61.023 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.009453535079956
Epoch: 14, Steps: 32 | Train Loss: 0.879 Vali Loss: 87.789 Vali Acc: 0.534 Test Loss: 87.789 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.115694284439087
Epoch: 15, Steps: 32 | Train Loss: 3.567 Vali Loss: 108.914 Vali Acc: 0.473 Test Loss: 108.914 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.09416675567627
Epoch: 16, Steps: 32 | Train Loss: 3.646 Vali Loss: 91.508 Vali Acc: 0.443 Test Loss: 91.508 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.239116191864014
Epoch: 17, Steps: 32 | Train Loss: 0.171 Vali Loss: 88.849 Vali Acc: 0.450 Test Loss: 88.849 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.301628351211548
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 89.117 Vali Acc: 0.450 Test Loss: 89.117 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.18029260635376
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 89.127 Vali Acc: 0.450 Test Loss: 89.127 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.390344858169556
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 89.128 Vali Acc: 0.450 Test Loss: 89.128 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.449814796447754
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 89.128 Vali Acc: 0.450 Test Loss: 89.128 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 8384029
model size : 40.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.321370124816895
Epoch: 1, Steps: 32 | Train Loss: 21.461 Vali Loss: 46.585 Vali Acc: 0.176 Test Loss: 46.585 Test Acc: 0.176
Validation loss decreased (inf --> -0.175107).  Saving model ...
Epoch: 2 cost time: 7.896680116653442
Epoch: 2, Steps: 32 | Train Loss: 30.180 Vali Loss: 25.511 Vali Acc: 0.176 Test Loss: 25.511 Test Acc: 0.176
Validation loss decreased (-0.175107 --> -0.175317).  Saving model ...
Epoch: 3 cost time: 8.179437398910522
Epoch: 3, Steps: 32 | Train Loss: 27.625 Vali Loss: 47.646 Vali Acc: 0.168 Test Loss: 47.646 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.070450782775879
Epoch: 4, Steps: 32 | Train Loss: 21.528 Vali Loss: 42.287 Vali Acc: 0.237 Test Loss: 42.287 Test Acc: 0.237
Validation loss decreased (-0.175317 --> -0.236218).  Saving model ...
Epoch: 5 cost time: 8.123810529708862
Epoch: 5, Steps: 32 | Train Loss: 16.739 Vali Loss: 38.014 Vali Acc: 0.397 Test Loss: 38.014 Test Acc: 0.397
Validation loss decreased (-0.236218 --> -0.396566).  Saving model ...
Epoch: 6 cost time: 8.290284633636475
Epoch: 6, Steps: 32 | Train Loss: 11.894 Vali Loss: 64.934 Vali Acc: 0.481 Test Loss: 64.934 Test Acc: 0.481
Validation loss decreased (-0.396566 --> -0.480267).  Saving model ...
Epoch: 7 cost time: 8.100622177124023
Epoch: 7, Steps: 32 | Train Loss: 9.591 Vali Loss: 82.848 Vali Acc: 0.443 Test Loss: 82.848 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.022575378417969
Epoch: 8, Steps: 32 | Train Loss: 7.950 Vali Loss: 65.952 Vali Acc: 0.489 Test Loss: 65.952 Test Acc: 0.489
Validation loss decreased (-0.480267 --> -0.487890).  Saving model ...
Epoch: 9 cost time: 8.09402585029602
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 96.609 Vali Acc: 0.550 Test Loss: 96.609 Test Acc: 0.550
Validation loss decreased (-0.487890 --> -0.548652).  Saving model ...
Epoch: 10 cost time: 8.021750211715698
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.218 Vali Acc: 0.550 Test Loss: 99.218 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.201756238937378
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.320 Vali Acc: 0.550 Test Loss: 99.320 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.065285682678223
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.324 Vali Acc: 0.550 Test Loss: 99.324 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.151504039764404
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.060988903045654
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.093557596206665
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.120213031768799
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.05217456817627
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.98998761177063
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.088924407958984
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 99.323 Vali Acc: 0.550 Test Loss: 99.323 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 8192157
model size : 40.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.493250846862793
Epoch: 1, Steps: 32 | Train Loss: 16.585 Vali Loss: 26.333 Vali Acc: 0.420 Test Loss: 26.333 Test Acc: 0.420
Validation loss decreased (inf --> -0.419584).  Saving model ...
Epoch: 2 cost time: 7.810421705245972
Epoch: 2, Steps: 32 | Train Loss: 28.226 Vali Loss: 47.027 Vali Acc: 0.183 Test Loss: 47.027 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.886387348175049
Epoch: 3, Steps: 32 | Train Loss: 54.176 Vali Loss: 80.763 Vali Acc: 0.191 Test Loss: 80.763 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.725573778152466
Epoch: 4, Steps: 32 | Train Loss: 31.602 Vali Loss: 49.563 Vali Acc: 0.229 Test Loss: 49.563 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.704683303833008
Epoch: 5, Steps: 32 | Train Loss: 15.028 Vali Loss: 53.308 Vali Acc: 0.450 Test Loss: 53.308 Test Acc: 0.450
Validation loss decreased (-0.419584 --> -0.449849).  Saving model ...
Epoch: 6 cost time: 7.797816276550293
Epoch: 6, Steps: 32 | Train Loss: 5.636 Vali Loss: 55.187 Vali Acc: 0.519 Test Loss: 55.187 Test Acc: 0.519
Validation loss decreased (-0.449849 --> -0.518532).  Saving model ...
Epoch: 7 cost time: 7.902271509170532
Epoch: 7, Steps: 32 | Train Loss: 3.176 Vali Loss: 66.145 Vali Acc: 0.527 Test Loss: 66.145 Test Acc: 0.527
Validation loss decreased (-0.518532 --> -0.526056).  Saving model ...
Epoch: 8 cost time: 7.8630805015563965
Epoch: 8, Steps: 32 | Train Loss: 5.737 Vali Loss: 76.879 Vali Acc: 0.527 Test Loss: 76.879 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.043548345565796
Epoch: 9, Steps: 32 | Train Loss: 2.482 Vali Loss: 115.887 Vali Acc: 0.511 Test Loss: 115.887 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.891566753387451
Epoch: 10, Steps: 32 | Train Loss: 1.494 Vali Loss: 87.718 Vali Acc: 0.504 Test Loss: 87.718 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.954648971557617
Epoch: 11, Steps: 32 | Train Loss: 2.973 Vali Loss: 77.698 Vali Acc: 0.496 Test Loss: 77.698 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.873782396316528
Epoch: 12, Steps: 32 | Train Loss: 2.723 Vali Loss: 100.482 Vali Acc: 0.481 Test Loss: 100.482 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.934662103652954
Epoch: 13, Steps: 32 | Train Loss: 2.916 Vali Loss: 100.681 Vali Acc: 0.511 Test Loss: 100.681 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.029605150222778
Epoch: 14, Steps: 32 | Train Loss: 2.438 Vali Loss: 83.744 Vali Acc: 0.382 Test Loss: 83.744 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.775759696960449
Epoch: 15, Steps: 32 | Train Loss: 1.328 Vali Loss: 103.516 Vali Acc: 0.458 Test Loss: 103.516 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.900847434997559
Epoch: 16, Steps: 32 | Train Loss: 2.406 Vali Loss: 99.837 Vali Acc: 0.481 Test Loss: 99.837 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.845716714859009
Epoch: 17, Steps: 32 | Train Loss: 0.093 Vali Loss: 90.485 Vali Acc: 0.481 Test Loss: 90.485 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 8000285
model size : 39.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.541083574295044
Epoch: 1, Steps: 32 | Train Loss: 16.079 Vali Loss: 8.423 Vali Acc: 0.420 Test Loss: 8.423 Test Acc: 0.420
Validation loss decreased (inf --> -0.419763).  Saving model ...
Epoch: 2 cost time: 7.718391180038452
Epoch: 2, Steps: 32 | Train Loss: 14.389 Vali Loss: 22.405 Vali Acc: 0.435 Test Loss: 22.405 Test Acc: 0.435
Validation loss decreased (-0.419763 --> -0.434890).  Saving model ...
Epoch: 3 cost time: 7.930293083190918
Epoch: 3, Steps: 32 | Train Loss: 16.229 Vali Loss: 16.357 Vali Acc: 0.260 Test Loss: 16.357 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.857704401016235
Epoch: 4, Steps: 32 | Train Loss: 11.738 Vali Loss: 29.414 Vali Acc: 0.221 Test Loss: 29.414 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.880279779434204
Epoch: 5, Steps: 32 | Train Loss: 6.663 Vali Loss: 21.865 Vali Acc: 0.412 Test Loss: 21.865 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.998253345489502
Epoch: 6, Steps: 32 | Train Loss: 2.161 Vali Loss: 42.566 Vali Acc: 0.534 Test Loss: 42.566 Test Acc: 0.534
Validation loss decreased (-0.434890 --> -0.533925).  Saving model ...
Epoch: 7 cost time: 7.832843542098999
Epoch: 7, Steps: 32 | Train Loss: 5.722 Vali Loss: 32.153 Vali Acc: 0.458 Test Loss: 32.153 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.917146444320679
Epoch: 8, Steps: 32 | Train Loss: 1.128 Vali Loss: 29.627 Vali Acc: 0.382 Test Loss: 29.627 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.07263469696045
Epoch: 9, Steps: 32 | Train Loss: 0.243 Vali Loss: 42.779 Vali Acc: 0.435 Test Loss: 42.779 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.810905694961548
Epoch: 10, Steps: 32 | Train Loss: 0.254 Vali Loss: 44.725 Vali Acc: 0.557 Test Loss: 44.725 Test Acc: 0.557
Validation loss decreased (-0.533925 --> -0.556805).  Saving model ...
Epoch: 11 cost time: 7.870698690414429
Epoch: 11, Steps: 32 | Train Loss: 0.007 Vali Loss: 42.402 Vali Acc: 0.527 Test Loss: 42.402 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.810612678527832
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.563 Vali Acc: 0.557 Test Loss: 45.563 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.828259706497192
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.691 Vali Acc: 0.542 Test Loss: 45.691 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.871365070343018
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.690342664718628
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.998534679412842
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.952692031860352
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.738134145736694
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.920000076293945
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.8409423828125
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.696 Vali Acc: 0.542 Test Loss: 45.696 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 4438301
model size : 21.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.317549705505371
Epoch: 1, Steps: 32 | Train Loss: 9.515 Vali Loss: 18.022 Vali Acc: 0.099 Test Loss: 18.022 Test Acc: 0.099
Validation loss decreased (inf --> -0.099056).  Saving model ...
Epoch: 2 cost time: 7.80861759185791
Epoch: 2, Steps: 32 | Train Loss: 22.356 Vali Loss: 25.793 Vali Acc: 0.420 Test Loss: 25.793 Test Acc: 0.420
Validation loss decreased (-0.099056 --> -0.419589).  Saving model ...
Epoch: 3 cost time: 7.761968374252319
Epoch: 3, Steps: 32 | Train Loss: 12.788 Vali Loss: 11.566 Vali Acc: 0.458 Test Loss: 11.566 Test Acc: 0.458
Validation loss decreased (-0.419589 --> -0.457900).  Saving model ...
Epoch: 4 cost time: 7.840792179107666
Epoch: 4, Steps: 32 | Train Loss: 4.872 Vali Loss: 25.211 Vali Acc: 0.504 Test Loss: 25.211 Test Acc: 0.504
Validation loss decreased (-0.457900 --> -0.503565).  Saving model ...
Epoch: 5 cost time: 7.802493095397949
Epoch: 5, Steps: 32 | Train Loss: 2.727 Vali Loss: 28.831 Vali Acc: 0.458 Test Loss: 28.831 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.9198079109191895
Epoch: 6, Steps: 32 | Train Loss: 8.756 Vali Loss: 33.744 Vali Acc: 0.420 Test Loss: 33.744 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.9700164794921875
Epoch: 7, Steps: 32 | Train Loss: 7.427 Vali Loss: 33.759 Vali Acc: 0.527 Test Loss: 33.759 Test Acc: 0.527
Validation loss decreased (-0.503565 --> -0.526380).  Saving model ...
Epoch: 8 cost time: 7.739342927932739
Epoch: 8, Steps: 32 | Train Loss: 2.121 Vali Loss: 46.171 Vali Acc: 0.527 Test Loss: 46.171 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.98275089263916
Epoch: 9, Steps: 32 | Train Loss: 0.299 Vali Loss: 39.421 Vali Acc: 0.481 Test Loss: 39.421 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.920536041259766
Epoch: 10, Steps: 32 | Train Loss: 1.458 Vali Loss: 48.227 Vali Acc: 0.504 Test Loss: 48.227 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.977312803268433
Epoch: 11, Steps: 32 | Train Loss: 1.131 Vali Loss: 46.266 Vali Acc: 0.405 Test Loss: 46.266 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.9563939571380615
Epoch: 12, Steps: 32 | Train Loss: 0.305 Vali Loss: 50.352 Vali Acc: 0.344 Test Loss: 50.352 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.765446186065674
Epoch: 13, Steps: 32 | Train Loss: 0.469 Vali Loss: 44.839 Vali Acc: 0.443 Test Loss: 44.839 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.834859609603882
Epoch: 14, Steps: 32 | Train Loss: 0.522 Vali Loss: 45.121 Vali Acc: 0.489 Test Loss: 45.121 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.847509860992432
Epoch: 15, Steps: 32 | Train Loss: 0.545 Vali Loss: 58.574 Vali Acc: 0.511 Test Loss: 58.574 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.879033327102661
Epoch: 16, Steps: 32 | Train Loss: 0.063 Vali Loss: 48.268 Vali Acc: 0.473 Test Loss: 48.268 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.87142276763916
Epoch: 17, Steps: 32 | Train Loss: 0.685 Vali Loss: 47.950 Vali Acc: 0.412 Test Loss: 47.950 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 4342365
model size : 21.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.520740747451782
Epoch: 1, Steps: 32 | Train Loss: 8.866 Vali Loss: 19.469 Vali Acc: 0.420 Test Loss: 19.469 Test Acc: 0.420
Validation loss decreased (inf --> -0.419653).  Saving model ...
Epoch: 2 cost time: 7.808088541030884
Epoch: 2, Steps: 32 | Train Loss: 20.853 Vali Loss: 20.146 Vali Acc: 0.137 Test Loss: 20.146 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.739714860916138
Epoch: 3, Steps: 32 | Train Loss: 15.696 Vali Loss: 21.214 Vali Acc: 0.191 Test Loss: 21.214 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.848715543746948
Epoch: 4, Steps: 32 | Train Loss: 11.086 Vali Loss: 16.503 Vali Acc: 0.443 Test Loss: 16.503 Test Acc: 0.443
Validation loss decreased (-0.419653 --> -0.442583).  Saving model ...
Epoch: 5 cost time: 7.825117349624634
Epoch: 5, Steps: 32 | Train Loss: 5.901 Vali Loss: 36.278 Vali Acc: 0.489 Test Loss: 36.278 Test Acc: 0.489
Validation loss decreased (-0.442583 --> -0.488187).  Saving model ...
Epoch: 6 cost time: 8.125580787658691
Epoch: 6, Steps: 32 | Train Loss: 5.055 Vali Loss: 28.787 Vali Acc: 0.450 Test Loss: 28.787 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.7952821254730225
Epoch: 7, Steps: 32 | Train Loss: 5.298 Vali Loss: 35.382 Vali Acc: 0.496 Test Loss: 35.382 Test Acc: 0.496
Validation loss decreased (-0.488187 --> -0.495829).  Saving model ...
Epoch: 8 cost time: 7.895627975463867
Epoch: 8, Steps: 32 | Train Loss: 0.975 Vali Loss: 37.492 Vali Acc: 0.481 Test Loss: 37.492 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.904049873352051
Epoch: 9, Steps: 32 | Train Loss: 0.332 Vali Loss: 33.991 Vali Acc: 0.420 Test Loss: 33.991 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.714875221252441
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.292 Vali Acc: 0.496 Test Loss: 37.292 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.7778801918029785
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.550 Vali Acc: 0.504 Test Loss: 37.550 Test Acc: 0.504
Validation loss decreased (-0.495829 --> -0.503441).  Saving model ...
Epoch: 12 cost time: 7.864010334014893
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.904845476150513
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.560 Vali Acc: 0.504 Test Loss: 37.560 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.723221063613892
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.677481412887573
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.757379055023193
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.010079860687256
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.9826085567474365
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.949737310409546
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.559 Vali Acc: 0.504 Test Loss: 37.559 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.977555990219116
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.557 Vali Acc: 0.504 Test Loss: 37.557 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.8792197704315186
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.557 Vali Acc: 0.504 Test Loss: 37.557 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 4246429
model size : 20.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.825423240661621
Epoch: 1, Steps: 32 | Train Loss: 8.165 Vali Loss: 9.793 Vali Acc: 0.420 Test Loss: 9.793 Test Acc: 0.420
Validation loss decreased (inf --> -0.419749).  Saving model ...
Epoch: 2 cost time: 7.6558685302734375
Epoch: 2, Steps: 32 | Train Loss: 20.130 Vali Loss: 14.024 Vali Acc: 0.214 Test Loss: 14.024 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.6941752433776855
Epoch: 3, Steps: 32 | Train Loss: 11.086 Vali Loss: 28.234 Vali Acc: 0.435 Test Loss: 28.234 Test Acc: 0.435
Validation loss decreased (-0.419749 --> -0.434832).  Saving model ...
Epoch: 4 cost time: 7.649118661880493
Epoch: 4, Steps: 32 | Train Loss: 9.008 Vali Loss: 33.738 Vali Acc: 0.473 Test Loss: 33.738 Test Acc: 0.473
Validation loss decreased (-0.434832 --> -0.472945).  Saving model ...
Epoch: 5 cost time: 7.653313159942627
Epoch: 5, Steps: 32 | Train Loss: 5.259 Vali Loss: 17.329 Vali Acc: 0.344 Test Loss: 17.329 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.524770736694336
Epoch: 6, Steps: 32 | Train Loss: 3.202 Vali Loss: 24.946 Vali Acc: 0.412 Test Loss: 24.946 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.56500768661499
Epoch: 7, Steps: 32 | Train Loss: 1.571 Vali Loss: 35.743 Vali Acc: 0.504 Test Loss: 35.743 Test Acc: 0.504
Validation loss decreased (-0.472945 --> -0.503459).  Saving model ...
Epoch: 8 cost time: 7.65960693359375
Epoch: 8, Steps: 32 | Train Loss: 1.478 Vali Loss: 40.984 Vali Acc: 0.344 Test Loss: 40.984 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.585776329040527
Epoch: 9, Steps: 32 | Train Loss: 0.444 Vali Loss: 36.935 Vali Acc: 0.504 Test Loss: 36.935 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.510307312011719
Epoch: 10, Steps: 32 | Train Loss: 0.526 Vali Loss: 37.180 Vali Acc: 0.458 Test Loss: 37.180 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.542096376419067
Epoch: 11, Steps: 32 | Train Loss: 2.205 Vali Loss: 39.647 Vali Acc: 0.336 Test Loss: 39.647 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.785858392715454
Epoch: 12, Steps: 32 | Train Loss: 1.645 Vali Loss: 48.277 Vali Acc: 0.443 Test Loss: 48.277 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.552821397781372
Epoch: 13, Steps: 32 | Train Loss: 0.170 Vali Loss: 43.692 Vali Acc: 0.481 Test Loss: 43.692 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.645180940628052
Epoch: 14, Steps: 32 | Train Loss: 1.294 Vali Loss: 47.734 Vali Acc: 0.328 Test Loss: 47.734 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.539802074432373
Epoch: 15, Steps: 32 | Train Loss: 0.428 Vali Loss: 47.371 Vali Acc: 0.420 Test Loss: 47.371 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.50895094871521
Epoch: 16, Steps: 32 | Train Loss: 1.618 Vali Loss: 47.345 Vali Acc: 0.389 Test Loss: 47.345 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.572019815444946
Epoch: 17, Steps: 32 | Train Loss: 0.122 Vali Loss: 53.804 Vali Acc: 0.511 Test Loss: 53.804 Test Acc: 0.511
Validation loss decreased (-0.503459 --> -0.510912).  Saving model ...
Epoch: 18 cost time: 7.565721750259399
Epoch: 18, Steps: 32 | Train Loss: 0.071 Vali Loss: 58.980 Vali Acc: 0.519 Test Loss: 58.980 Test Acc: 0.519
Validation loss decreased (-0.510912 --> -0.518494).  Saving model ...
Epoch: 19 cost time: 7.518768787384033
Epoch: 19, Steps: 32 | Train Loss: 0.715 Vali Loss: 56.007 Vali Acc: 0.351 Test Loss: 56.007 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.861300945281982
Epoch: 20, Steps: 32 | Train Loss: 0.301 Vali Loss: 65.128 Vali Acc: 0.489 Test Loss: 65.128 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.531733989715576
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.090 Vali Acc: 0.481 Test Loss: 67.090 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.610692739486694
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.149 Vali Acc: 0.481 Test Loss: 67.149 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.659231662750244
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.673099517822266
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.582327604293823
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.519711017608643
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.679723501205444
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.569907903671265
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.151 Vali Acc: 0.481 Test Loss: 67.151 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 4150493
model size : 20.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.926927328109741
Epoch: 1, Steps: 32 | Train Loss: 5.758 Vali Loss: 9.509 Vali Acc: 0.420 Test Loss: 9.509 Test Acc: 0.420
Validation loss decreased (inf --> -0.419752).  Saving model ...
Epoch: 2 cost time: 7.800662517547607
Epoch: 2, Steps: 32 | Train Loss: 19.070 Vali Loss: 20.848 Vali Acc: 0.168 Test Loss: 20.848 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.88431715965271
Epoch: 3, Steps: 32 | Train Loss: 16.940 Vali Loss: 9.630 Vali Acc: 0.389 Test Loss: 9.630 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.756712198257446
Epoch: 4, Steps: 32 | Train Loss: 8.822 Vali Loss: 30.642 Vali Acc: 0.496 Test Loss: 30.642 Test Acc: 0.496
Validation loss decreased (-0.419752 --> -0.495877).  Saving model ...
Epoch: 5 cost time: 8.141428470611572
Epoch: 5, Steps: 32 | Train Loss: 8.444 Vali Loss: 28.641 Vali Acc: 0.489 Test Loss: 28.641 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.006211280822754
Epoch: 6, Steps: 32 | Train Loss: 4.207 Vali Loss: 21.733 Vali Acc: 0.496 Test Loss: 21.733 Test Acc: 0.496
Validation loss decreased (-0.495877 --> -0.495966).  Saving model ...
Epoch: 7 cost time: 7.916183710098267
Epoch: 7, Steps: 32 | Train Loss: 2.053 Vali Loss: 33.428 Vali Acc: 0.534 Test Loss: 33.428 Test Acc: 0.534
Validation loss decreased (-0.495966 --> -0.534017).  Saving model ...
Epoch: 8 cost time: 8.015444040298462
Epoch: 8, Steps: 32 | Train Loss: 1.241 Vali Loss: 39.855 Vali Acc: 0.412 Test Loss: 39.855 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.886330842971802
Epoch: 9, Steps: 32 | Train Loss: 1.838 Vali Loss: 39.467 Vali Acc: 0.489 Test Loss: 39.467 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.897322177886963
Epoch: 10, Steps: 32 | Train Loss: 0.707 Vali Loss: 49.987 Vali Acc: 0.511 Test Loss: 49.987 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.974836111068726
Epoch: 11, Steps: 32 | Train Loss: 0.771 Vali Loss: 68.188 Vali Acc: 0.511 Test Loss: 68.188 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.039875507354736
Epoch: 12, Steps: 32 | Train Loss: 1.283 Vali Loss: 53.296 Vali Acc: 0.473 Test Loss: 53.296 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.936732292175293
Epoch: 13, Steps: 32 | Train Loss: 1.305 Vali Loss: 57.898 Vali Acc: 0.405 Test Loss: 57.898 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.839070081710815
Epoch: 14, Steps: 32 | Train Loss: 0.456 Vali Loss: 58.084 Vali Acc: 0.542 Test Loss: 58.084 Test Acc: 0.542
Validation loss decreased (-0.534017 --> -0.541404).  Saving model ...
Epoch: 15 cost time: 7.917248487472534
Epoch: 15, Steps: 32 | Train Loss: 1.852 Vali Loss: 58.424 Vali Acc: 0.496 Test Loss: 58.424 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.720135927200317
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 62.762 Vali Acc: 0.450 Test Loss: 62.762 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.880831956863403
Epoch: 17, Steps: 32 | Train Loss: 0.877 Vali Loss: 58.920 Vali Acc: 0.443 Test Loss: 58.920 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.7895097732543945
Epoch: 18, Steps: 32 | Train Loss: 0.164 Vali Loss: 55.829 Vali Acc: 0.427 Test Loss: 55.829 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.877269983291626
Epoch: 19, Steps: 32 | Train Loss: 1.204 Vali Loss: 66.698 Vali Acc: 0.328 Test Loss: 66.698 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.022138118743896
Epoch: 20, Steps: 32 | Train Loss: 0.638 Vali Loss: 59.772 Vali Acc: 0.374 Test Loss: 59.772 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.82509183883667
Epoch: 21, Steps: 32 | Train Loss: 1.018 Vali Loss: 68.198 Vali Acc: 0.489 Test Loss: 68.198 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.983316421508789
Epoch: 22, Steps: 32 | Train Loss: 0.441 Vali Loss: 74.207 Vali Acc: 0.519 Test Loss: 74.207 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.864610195159912
Epoch: 23, Steps: 32 | Train Loss: 0.293 Vali Loss: 80.395 Vali Acc: 0.519 Test Loss: 80.395 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.817056894302368
Epoch: 24, Steps: 32 | Train Loss: 1.048 Vali Loss: 68.353 Vali Acc: 0.450 Test Loss: 68.353 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 4240157
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.936210632324219
Epoch: 1, Steps: 32 | Train Loss: 9.772 Vali Loss: 29.345 Vali Acc: 0.176 Test Loss: 29.345 Test Acc: 0.176
Validation loss decreased (inf --> -0.175279).  Saving model ...
Epoch: 2 cost time: 7.647733211517334
Epoch: 2, Steps: 32 | Train Loss: 19.520 Vali Loss: 13.165 Vali Acc: 0.153 Test Loss: 13.165 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.667102098464966
Epoch: 3, Steps: 32 | Train Loss: 17.198 Vali Loss: 23.189 Vali Acc: 0.450 Test Loss: 23.189 Test Acc: 0.450
Validation loss decreased (-0.175279 --> -0.450150).  Saving model ...
Epoch: 4 cost time: 7.665222644805908
Epoch: 4, Steps: 32 | Train Loss: 18.076 Vali Loss: 23.920 Vali Acc: 0.420 Test Loss: 23.920 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.694378614425659
Epoch: 5, Steps: 32 | Train Loss: 6.463 Vali Loss: 32.442 Vali Acc: 0.504 Test Loss: 32.442 Test Acc: 0.504
Validation loss decreased (-0.450150 --> -0.503492).  Saving model ...
Epoch: 6 cost time: 7.684377193450928
Epoch: 6, Steps: 32 | Train Loss: 4.906 Vali Loss: 45.382 Vali Acc: 0.496 Test Loss: 45.382 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.703271865844727
Epoch: 7, Steps: 32 | Train Loss: 2.797 Vali Loss: 45.747 Vali Acc: 0.473 Test Loss: 45.747 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.730989694595337
Epoch: 8, Steps: 32 | Train Loss: 2.159 Vali Loss: 32.918 Vali Acc: 0.481 Test Loss: 32.918 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.766753196716309
Epoch: 9, Steps: 32 | Train Loss: 2.962 Vali Loss: 40.278 Vali Acc: 0.382 Test Loss: 40.278 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.901363134384155
Epoch: 10, Steps: 32 | Train Loss: 1.361 Vali Loss: 50.054 Vali Acc: 0.458 Test Loss: 50.054 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.8957459926605225
Epoch: 11, Steps: 32 | Train Loss: 0.796 Vali Loss: 38.257 Vali Acc: 0.450 Test Loss: 38.257 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.989597797393799
Epoch: 12, Steps: 32 | Train Loss: 0.151 Vali Loss: 46.571 Vali Acc: 0.519 Test Loss: 46.571 Test Acc: 0.519
Validation loss decreased (-0.503492 --> -0.518618).  Saving model ...
Epoch: 13 cost time: 7.941513776779175
Epoch: 13, Steps: 32 | Train Loss: 0.128 Vali Loss: 52.104 Vali Acc: 0.504 Test Loss: 52.104 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.000007152557373
Epoch: 14, Steps: 32 | Train Loss: 0.087 Vali Loss: 49.350 Vali Acc: 0.504 Test Loss: 49.350 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.856141090393066
Epoch: 15, Steps: 32 | Train Loss: 0.860 Vali Loss: 57.949 Vali Acc: 0.527 Test Loss: 57.949 Test Acc: 0.527
Validation loss decreased (-0.518618 --> -0.526138).  Saving model ...
Epoch: 16 cost time: 7.891733169555664
Epoch: 16, Steps: 32 | Train Loss: 0.343 Vali Loss: 56.469 Vali Acc: 0.412 Test Loss: 56.469 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.798494577407837
Epoch: 17, Steps: 32 | Train Loss: 0.132 Vali Loss: 61.764 Vali Acc: 0.458 Test Loss: 61.764 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.722491264343262
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.638 Vali Acc: 0.405 Test Loss: 60.638 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.831622838973999
Epoch: 19, Steps: 32 | Train Loss: 0.084 Vali Loss: 78.405 Vali Acc: 0.511 Test Loss: 78.405 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.810879707336426
Epoch: 20, Steps: 32 | Train Loss: 1.629 Vali Loss: 72.036 Vali Acc: 0.450 Test Loss: 72.036 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.9885289669036865
Epoch: 21, Steps: 32 | Train Loss: 7.339 Vali Loss: 103.872 Vali Acc: 0.183 Test Loss: 103.872 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.80380916595459
Epoch: 22, Steps: 32 | Train Loss: 5.455 Vali Loss: 75.597 Vali Acc: 0.374 Test Loss: 75.597 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.74038028717041
Epoch: 23, Steps: 32 | Train Loss: 1.672 Vali Loss: 64.834 Vali Acc: 0.473 Test Loss: 64.834 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.812966346740723
Epoch: 24, Steps: 32 | Train Loss: 0.576 Vali Loss: 64.790 Vali Acc: 0.473 Test Loss: 64.790 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.97443151473999
Epoch: 25, Steps: 32 | Train Loss: 0.263 Vali Loss: 64.525 Vali Acc: 0.473 Test Loss: 64.525 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 4144221
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.018718957901001
Epoch: 1, Steps: 32 | Train Loss: 8.305 Vali Loss: 19.970 Vali Acc: 0.176 Test Loss: 19.970 Test Acc: 0.176
Validation loss decreased (inf --> -0.175373).  Saving model ...
Epoch: 2 cost time: 7.731507778167725
Epoch: 2, Steps: 32 | Train Loss: 27.277 Vali Loss: 34.148 Vali Acc: 0.183 Test Loss: 34.148 Test Acc: 0.183
Validation loss decreased (-0.175373 --> -0.182865).  Saving model ...
Epoch: 3 cost time: 7.690682411193848
Epoch: 3, Steps: 32 | Train Loss: 18.641 Vali Loss: 25.322 Vali Acc: 0.435 Test Loss: 25.322 Test Acc: 0.435
Validation loss decreased (-0.182865 --> -0.434861).  Saving model ...
Epoch: 4 cost time: 7.726658582687378
Epoch: 4, Steps: 32 | Train Loss: 15.716 Vali Loss: 29.366 Vali Acc: 0.458 Test Loss: 29.366 Test Acc: 0.458
Validation loss decreased (-0.434861 --> -0.457722).  Saving model ...
Epoch: 5 cost time: 7.63555645942688
Epoch: 5, Steps: 32 | Train Loss: 8.491 Vali Loss: 45.261 Vali Acc: 0.221 Test Loss: 45.261 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.629129409790039
Epoch: 6, Steps: 32 | Train Loss: 7.692 Vali Loss: 39.634 Vali Acc: 0.405 Test Loss: 39.634 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.6114747524261475
Epoch: 7, Steps: 32 | Train Loss: 5.138 Vali Loss: 49.647 Vali Acc: 0.496 Test Loss: 49.647 Test Acc: 0.496
Validation loss decreased (-0.457722 --> -0.495687).  Saving model ...
Epoch: 8 cost time: 7.684330463409424
Epoch: 8, Steps: 32 | Train Loss: 2.311 Vali Loss: 34.061 Vali Acc: 0.473 Test Loss: 34.061 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.68173885345459
Epoch: 9, Steps: 32 | Train Loss: 1.332 Vali Loss: 42.947 Vali Acc: 0.481 Test Loss: 42.947 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.849440813064575
Epoch: 10, Steps: 32 | Train Loss: 1.331 Vali Loss: 42.985 Vali Acc: 0.542 Test Loss: 42.985 Test Acc: 0.542
Validation loss decreased (-0.495687 --> -0.541555).  Saving model ...
Epoch: 11 cost time: 7.724938154220581
Epoch: 11, Steps: 32 | Train Loss: 0.441 Vali Loss: 33.902 Vali Acc: 0.542 Test Loss: 33.902 Test Acc: 0.542
Validation loss decreased (-0.541555 --> -0.541646).  Saving model ...
Epoch: 12 cost time: 7.528489589691162
Epoch: 12, Steps: 32 | Train Loss: 0.512 Vali Loss: 43.524 Vali Acc: 0.557 Test Loss: 43.524 Test Acc: 0.557
Validation loss decreased (-0.541646 --> -0.556817).  Saving model ...
Epoch: 13 cost time: 7.63632869720459
Epoch: 13, Steps: 32 | Train Loss: 0.264 Vali Loss: 45.821 Vali Acc: 0.542 Test Loss: 45.821 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.637002229690552
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.810 Vali Acc: 0.557 Test Loss: 48.810 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.676357269287109
Epoch: 15, Steps: 32 | Train Loss: 0.276 Vali Loss: 38.792 Vali Acc: 0.450 Test Loss: 38.792 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.716284990310669
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.057 Vali Acc: 0.542 Test Loss: 49.057 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.751448392868042
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.704 Vali Acc: 0.550 Test Loss: 46.704 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.804272174835205
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.462 Vali Acc: 0.550 Test Loss: 46.462 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.659291982650757
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.453 Vali Acc: 0.550 Test Loss: 46.453 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.699133396148682
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.453 Vali Acc: 0.550 Test Loss: 46.453 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.551223278045654
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.453 Vali Acc: 0.550 Test Loss: 46.453 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.567863702774048
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.453 Vali Acc: 0.550 Test Loss: 46.453 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 4048285
model size : 19.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.494998931884766
Epoch: 1, Steps: 32 | Train Loss: 7.371 Vali Loss: 11.346 Vali Acc: 0.153 Test Loss: 11.346 Test Acc: 0.153
Validation loss decreased (inf --> -0.152558).  Saving model ...
Epoch: 2 cost time: 7.464841365814209
Epoch: 2, Steps: 32 | Train Loss: 16.753 Vali Loss: 36.864 Vali Acc: 0.137 Test Loss: 36.864 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.439234018325806
Epoch: 3, Steps: 32 | Train Loss: 14.020 Vali Loss: 10.526 Vali Acc: 0.313 Test Loss: 10.526 Test Acc: 0.313
Validation loss decreased (-0.152558 --> -0.312872).  Saving model ...
Epoch: 4 cost time: 7.38165283203125
Epoch: 4, Steps: 32 | Train Loss: 14.431 Vali Loss: 18.831 Vali Acc: 0.336 Test Loss: 18.831 Test Acc: 0.336
Validation loss decreased (-0.312872 --> -0.335690).  Saving model ...
Epoch: 5 cost time: 7.398669958114624
Epoch: 5, Steps: 32 | Train Loss: 5.905 Vali Loss: 22.717 Vali Acc: 0.298 Test Loss: 22.717 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.299718379974365
Epoch: 6, Steps: 32 | Train Loss: 6.486 Vali Loss: 29.281 Vali Acc: 0.420 Test Loss: 29.281 Test Acc: 0.420
Validation loss decreased (-0.335690 --> -0.419555).  Saving model ...
Epoch: 7 cost time: 7.417139053344727
Epoch: 7, Steps: 32 | Train Loss: 2.437 Vali Loss: 26.973 Vali Acc: 0.511 Test Loss: 26.973 Test Acc: 0.511
Validation loss decreased (-0.419555 --> -0.511181).  Saving model ...
Epoch: 8 cost time: 7.548581838607788
Epoch: 8, Steps: 32 | Train Loss: 1.016 Vali Loss: 34.213 Vali Acc: 0.374 Test Loss: 34.213 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.399484872817993
Epoch: 9, Steps: 32 | Train Loss: 0.841 Vali Loss: 34.147 Vali Acc: 0.450 Test Loss: 34.147 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.590099334716797
Epoch: 10, Steps: 32 | Train Loss: 0.205 Vali Loss: 32.761 Vali Acc: 0.473 Test Loss: 32.761 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.5041868686676025
Epoch: 11, Steps: 32 | Train Loss: 0.854 Vali Loss: 38.845 Vali Acc: 0.489 Test Loss: 38.845 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.41689133644104
Epoch: 12, Steps: 32 | Train Loss: 0.105 Vali Loss: 37.033 Vali Acc: 0.481 Test Loss: 37.033 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.5516197681427
Epoch: 13, Steps: 32 | Train Loss: 0.365 Vali Loss: 39.997 Vali Acc: 0.481 Test Loss: 39.997 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.46678900718689
Epoch: 14, Steps: 32 | Train Loss: 1.749 Vali Loss: 45.439 Vali Acc: 0.466 Test Loss: 45.439 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.4163267612457275
Epoch: 15, Steps: 32 | Train Loss: 2.199 Vali Loss: 56.464 Vali Acc: 0.511 Test Loss: 56.464 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.503049373626709
Epoch: 16, Steps: 32 | Train Loss: 1.837 Vali Loss: 50.400 Vali Acc: 0.504 Test Loss: 50.400 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.384442090988159
Epoch: 17, Steps: 32 | Train Loss: 0.417 Vali Loss: 52.715 Vali Acc: 0.534 Test Loss: 52.715 Test Acc: 0.534
Validation loss decreased (-0.511181 --> -0.533824).  Saving model ...
Epoch: 18 cost time: 7.417991399765015
Epoch: 18, Steps: 32 | Train Loss: 0.948 Vali Loss: 51.496 Vali Acc: 0.496 Test Loss: 51.496 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.428109407424927
Epoch: 19, Steps: 32 | Train Loss: 0.593 Vali Loss: 66.124 Vali Acc: 0.511 Test Loss: 66.124 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.547474384307861
Epoch: 20, Steps: 32 | Train Loss: 0.762 Vali Loss: 51.302 Vali Acc: 0.359 Test Loss: 51.302 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.673191547393799
Epoch: 21, Steps: 32 | Train Loss: 0.513 Vali Loss: 52.129 Vali Acc: 0.527 Test Loss: 52.129 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.503786087036133
Epoch: 22, Steps: 32 | Train Loss: 1.600 Vali Loss: 44.846 Vali Acc: 0.473 Test Loss: 44.846 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.345537185668945
Epoch: 23, Steps: 32 | Train Loss: 3.095 Vali Loss: 58.040 Vali Acc: 0.542 Test Loss: 58.040 Test Acc: 0.542
Validation loss decreased (-0.533824 --> -0.541404).  Saving model ...
Epoch: 24 cost time: 7.436555624008179
Epoch: 24, Steps: 32 | Train Loss: 2.174 Vali Loss: 70.714 Vali Acc: 0.511 Test Loss: 70.714 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.429213285446167
Epoch: 25, Steps: 32 | Train Loss: 0.064 Vali Loss: 78.042 Vali Acc: 0.405 Test Loss: 78.042 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.56331467628479
Epoch: 26, Steps: 32 | Train Loss: 0.379 Vali Loss: 69.766 Vali Acc: 0.527 Test Loss: 69.766 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.501726388931274
Epoch: 27, Steps: 32 | Train Loss: 1.536 Vali Loss: 70.305 Vali Acc: 0.489 Test Loss: 70.305 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.479904413223267
Epoch: 28, Steps: 32 | Train Loss: 0.314 Vali Loss: 84.491 Vali Acc: 0.473 Test Loss: 84.491 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.442794561386108
Epoch: 29, Steps: 32 | Train Loss: 0.530 Vali Loss: 99.295 Vali Acc: 0.511 Test Loss: 99.295 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.486579895019531
Epoch: 30, Steps: 32 | Train Loss: 0.363 Vali Loss: 90.930 Vali Acc: 0.504 Test Loss: 90.930 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.489439010620117
Epoch: 31, Steps: 32 | Train Loss: 0.112 Vali Loss: 87.507 Vali Acc: 0.527 Test Loss: 87.507 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.454113960266113
Epoch: 32, Steps: 32 | Train Loss: 1.019 Vali Loss: 79.632 Vali Acc: 0.489 Test Loss: 79.632 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.502540826797485
Epoch: 33, Steps: 32 | Train Loss: 0.139 Vali Loss: 95.466 Vali Acc: 0.557 Test Loss: 95.466 Test Acc: 0.557
Validation loss decreased (-0.541404 --> -0.556297).  Saving model ...
Epoch: 34 cost time: 7.5207836627960205
Epoch: 34, Steps: 32 | Train Loss: 0.187 Vali Loss: 84.790 Vali Acc: 0.443 Test Loss: 84.790 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 7.792104482650757
Epoch: 35, Steps: 32 | Train Loss: 0.719 Vali Loss: 85.668 Vali Acc: 0.534 Test Loss: 85.668 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 7.681410789489746
Epoch: 36, Steps: 32 | Train Loss: 0.214 Vali Loss: 108.012 Vali Acc: 0.580 Test Loss: 108.012 Test Acc: 0.580
Validation loss decreased (-0.556297 --> -0.579073).  Saving model ...
Epoch: 37 cost time: 7.549601316452026
Epoch: 37, Steps: 32 | Train Loss: 1.423 Vali Loss: 96.251 Vali Acc: 0.489 Test Loss: 96.251 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.462657690048218
Epoch: 38, Steps: 32 | Train Loss: 0.097 Vali Loss: 92.720 Vali Acc: 0.527 Test Loss: 92.720 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.958364009857178
Epoch: 39, Steps: 32 | Train Loss: 1.063 Vali Loss: 118.103 Vali Acc: 0.542 Test Loss: 118.103 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 7.500738859176636
Epoch: 40, Steps: 32 | Train Loss: 0.986 Vali Loss: 90.673 Vali Acc: 0.481 Test Loss: 90.673 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 7.347896099090576
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 103.805 Vali Acc: 0.534 Test Loss: 103.805 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 7.543167352676392
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 104.445 Vali Acc: 0.534 Test Loss: 104.445 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 7.61812949180603
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 104.468 Vali Acc: 0.534 Test Loss: 104.468 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 7.6748878955841064
Epoch: 44, Steps: 32 | Train Loss: 0.000 Vali Loss: 104.469 Vali Acc: 0.534 Test Loss: 104.469 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 7.750223398208618
Epoch: 45, Steps: 32 | Train Loss: 0.000 Vali Loss: 104.469 Vali Acc: 0.534 Test Loss: 104.469 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 7.406037092208862
Epoch: 46, Steps: 32 | Train Loss: 0.000 Vali Loss: 104.469 Vali Acc: 0.534 Test Loss: 104.469 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3952349
model size : 19.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.892462730407715
Epoch: 1, Steps: 32 | Train Loss: 6.554 Vali Loss: 12.701 Vali Acc: 0.435 Test Loss: 12.701 Test Acc: 0.435
Validation loss decreased (inf --> -0.434987).  Saving model ...
Epoch: 2 cost time: 7.695074796676636
Epoch: 2, Steps: 32 | Train Loss: 23.096 Vali Loss: 20.559 Vali Acc: 0.420 Test Loss: 20.559 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.593756198883057
Epoch: 3, Steps: 32 | Train Loss: 15.741 Vali Loss: 6.192 Vali Acc: 0.336 Test Loss: 6.192 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.619600296020508
Epoch: 4, Steps: 32 | Train Loss: 10.352 Vali Loss: 26.675 Vali Acc: 0.198 Test Loss: 26.675 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.790769815444946
Epoch: 5, Steps: 32 | Train Loss: 11.961 Vali Loss: 20.553 Vali Acc: 0.542 Test Loss: 20.553 Test Acc: 0.542
Validation loss decreased (-0.434987 --> -0.541779).  Saving model ...
Epoch: 6 cost time: 7.642656087875366
Epoch: 6, Steps: 32 | Train Loss: 5.010 Vali Loss: 33.114 Vali Acc: 0.382 Test Loss: 33.114 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.678428411483765
Epoch: 7, Steps: 32 | Train Loss: 3.693 Vali Loss: 61.839 Vali Acc: 0.473 Test Loss: 61.839 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.665236949920654
Epoch: 8, Steps: 32 | Train Loss: 2.844 Vali Loss: 26.847 Vali Acc: 0.420 Test Loss: 26.847 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.752954721450806
Epoch: 9, Steps: 32 | Train Loss: 1.341 Vali Loss: 33.296 Vali Acc: 0.351 Test Loss: 33.296 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.577440023422241
Epoch: 10, Steps: 32 | Train Loss: 0.391 Vali Loss: 42.321 Vali Acc: 0.458 Test Loss: 42.321 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.765654563903809
Epoch: 11, Steps: 32 | Train Loss: 1.390 Vali Loss: 39.822 Vali Acc: 0.412 Test Loss: 39.822 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.789274454116821
Epoch: 12, Steps: 32 | Train Loss: 2.542 Vali Loss: 46.880 Vali Acc: 0.504 Test Loss: 46.880 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.887412786483765
Epoch: 13, Steps: 32 | Train Loss: 0.152 Vali Loss: 47.823 Vali Acc: 0.504 Test Loss: 47.823 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.61344838142395
Epoch: 14, Steps: 32 | Train Loss: 0.090 Vali Loss: 53.087 Vali Acc: 0.496 Test Loss: 53.087 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.778586387634277
Epoch: 15, Steps: 32 | Train Loss: 0.065 Vali Loss: 46.409 Vali Acc: 0.458 Test Loss: 46.409 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 4141085
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.698609590530396
Epoch: 1, Steps: 32 | Train Loss: 8.432 Vali Loss: 5.582 Vali Acc: 0.435 Test Loss: 5.582 Test Acc: 0.435
Validation loss decreased (inf --> -0.435059).  Saving model ...
Epoch: 2 cost time: 7.486952543258667
Epoch: 2, Steps: 32 | Train Loss: 21.420 Vali Loss: 37.392 Vali Acc: 0.420 Test Loss: 37.392 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.587157726287842
Epoch: 3, Steps: 32 | Train Loss: 26.603 Vali Loss: 35.196 Vali Acc: 0.214 Test Loss: 35.196 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.66912579536438
Epoch: 4, Steps: 32 | Train Loss: 13.274 Vali Loss: 13.376 Vali Acc: 0.282 Test Loss: 13.376 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.589590549468994
Epoch: 5, Steps: 32 | Train Loss: 15.332 Vali Loss: 46.805 Vali Acc: 0.412 Test Loss: 46.805 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.469963788986206
Epoch: 6, Steps: 32 | Train Loss: 11.723 Vali Loss: 35.278 Vali Acc: 0.511 Test Loss: 35.278 Test Acc: 0.511
Validation loss decreased (-0.435059 --> -0.511098).  Saving model ...
Epoch: 7 cost time: 7.730204343795776
Epoch: 7, Steps: 32 | Train Loss: 3.482 Vali Loss: 39.114 Vali Acc: 0.489 Test Loss: 39.114 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.615009784698486
Epoch: 8, Steps: 32 | Train Loss: 1.786 Vali Loss: 45.407 Vali Acc: 0.511 Test Loss: 45.407 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.473545074462891
Epoch: 9, Steps: 32 | Train Loss: 1.502 Vali Loss: 33.973 Vali Acc: 0.481 Test Loss: 33.973 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.469089508056641
Epoch: 10, Steps: 32 | Train Loss: 0.858 Vali Loss: 42.316 Vali Acc: 0.519 Test Loss: 42.316 Test Acc: 0.519
Validation loss decreased (-0.511098 --> -0.518661).  Saving model ...
Epoch: 11 cost time: 7.640665054321289
Epoch: 11, Steps: 32 | Train Loss: 0.337 Vali Loss: 48.939 Vali Acc: 0.351 Test Loss: 48.939 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.7337377071380615
Epoch: 12, Steps: 32 | Train Loss: 3.312 Vali Loss: 52.124 Vali Acc: 0.504 Test Loss: 52.124 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.611685514450073
Epoch: 13, Steps: 32 | Train Loss: 3.653 Vali Loss: 65.622 Vali Acc: 0.519 Test Loss: 65.622 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.6229612827301025
Epoch: 14, Steps: 32 | Train Loss: 0.344 Vali Loss: 46.172 Vali Acc: 0.511 Test Loss: 46.172 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.709616184234619
Epoch: 15, Steps: 32 | Train Loss: 1.099 Vali Loss: 53.574 Vali Acc: 0.542 Test Loss: 53.574 Test Acc: 0.542
Validation loss decreased (-0.518661 --> -0.541449).  Saving model ...
Epoch: 16 cost time: 7.548897743225098
Epoch: 16, Steps: 32 | Train Loss: 0.472 Vali Loss: 57.220 Vali Acc: 0.511 Test Loss: 57.220 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.700198173522949
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.195 Vali Acc: 0.489 Test Loss: 57.195 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.648763179779053
Epoch: 18, Steps: 32 | Train Loss: 0.042 Vali Loss: 63.346 Vali Acc: 0.527 Test Loss: 63.346 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.7663633823394775
Epoch: 19, Steps: 32 | Train Loss: 0.398 Vali Loss: 55.791 Vali Acc: 0.504 Test Loss: 55.791 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.608553886413574
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.120 Vali Acc: 0.496 Test Loss: 56.120 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.528242349624634
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.244 Vali Acc: 0.504 Test Loss: 56.244 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.706866502761841
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.395 Vali Acc: 0.504 Test Loss: 56.395 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.672496557235718
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.401 Vali Acc: 0.504 Test Loss: 56.401 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.5717573165893555
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.401 Vali Acc: 0.504 Test Loss: 56.401 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.506732225418091
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.401 Vali Acc: 0.504 Test Loss: 56.401 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 4045149
model size : 19.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.197184801101685
Epoch: 1, Steps: 32 | Train Loss: 7.174 Vali Loss: 9.329 Vali Acc: 0.420 Test Loss: 9.329 Test Acc: 0.420
Validation loss decreased (inf --> -0.419754).  Saving model ...
Epoch: 2 cost time: 7.600600481033325
Epoch: 2, Steps: 32 | Train Loss: 15.965 Vali Loss: 22.140 Vali Acc: 0.206 Test Loss: 22.140 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.6191935539245605
Epoch: 3, Steps: 32 | Train Loss: 24.049 Vali Loss: 43.682 Vali Acc: 0.168 Test Loss: 43.682 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.712308406829834
Epoch: 4, Steps: 32 | Train Loss: 25.196 Vali Loss: 35.381 Vali Acc: 0.443 Test Loss: 35.381 Test Acc: 0.443
Validation loss decreased (-0.419754 --> -0.442394).  Saving model ...
Epoch: 5 cost time: 7.844783067703247
Epoch: 5, Steps: 32 | Train Loss: 18.912 Vali Loss: 29.263 Vali Acc: 0.244 Test Loss: 29.263 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.979920387268066
Epoch: 6, Steps: 32 | Train Loss: 6.978 Vali Loss: 31.363 Vali Acc: 0.435 Test Loss: 31.363 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.719362497329712
Epoch: 7, Steps: 32 | Train Loss: 1.983 Vali Loss: 32.587 Vali Acc: 0.412 Test Loss: 32.587 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.648325681686401
Epoch: 8, Steps: 32 | Train Loss: 1.212 Vali Loss: 35.904 Vali Acc: 0.473 Test Loss: 35.904 Test Acc: 0.473
Validation loss decreased (-0.442394 --> -0.472923).  Saving model ...
Epoch: 9 cost time: 7.784225940704346
Epoch: 9, Steps: 32 | Train Loss: 1.484 Vali Loss: 43.753 Vali Acc: 0.481 Test Loss: 43.753 Test Acc: 0.481
Validation loss decreased (-0.472923 --> -0.480478).  Saving model ...
Epoch: 10 cost time: 7.765823125839233
Epoch: 10, Steps: 32 | Train Loss: 1.000 Vali Loss: 41.039 Vali Acc: 0.473 Test Loss: 41.039 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.765188932418823
Epoch: 11, Steps: 32 | Train Loss: 0.161 Vali Loss: 50.187 Vali Acc: 0.489 Test Loss: 50.187 Test Acc: 0.489
Validation loss decreased (-0.480478 --> -0.488048).  Saving model ...
Epoch: 12 cost time: 7.676313877105713
Epoch: 12, Steps: 32 | Train Loss: 0.931 Vali Loss: 55.212 Vali Acc: 0.565 Test Loss: 55.212 Test Acc: 0.565
Validation loss decreased (-0.488048 --> -0.564333).  Saving model ...
Epoch: 13 cost time: 7.987340211868286
Epoch: 13, Steps: 32 | Train Loss: 1.611 Vali Loss: 41.903 Vali Acc: 0.420 Test Loss: 41.903 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.731318235397339
Epoch: 14, Steps: 32 | Train Loss: 1.655 Vali Loss: 45.004 Vali Acc: 0.504 Test Loss: 45.004 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.541053533554077
Epoch: 15, Steps: 32 | Train Loss: 0.765 Vali Loss: 64.581 Vali Acc: 0.481 Test Loss: 64.581 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.7134575843811035
Epoch: 16, Steps: 32 | Train Loss: 0.954 Vali Loss: 52.815 Vali Acc: 0.443 Test Loss: 52.815 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.798389196395874
Epoch: 17, Steps: 32 | Train Loss: 0.981 Vali Loss: 59.113 Vali Acc: 0.542 Test Loss: 59.113 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.734909534454346
Epoch: 18, Steps: 32 | Train Loss: 1.255 Vali Loss: 53.731 Vali Acc: 0.534 Test Loss: 53.731 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.8311779499053955
Epoch: 19, Steps: 32 | Train Loss: 1.075 Vali Loss: 66.779 Vali Acc: 0.534 Test Loss: 66.779 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.722453355789185
Epoch: 20, Steps: 32 | Train Loss: 1.678 Vali Loss: 62.507 Vali Acc: 0.519 Test Loss: 62.507 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.659224033355713
Epoch: 21, Steps: 32 | Train Loss: 0.852 Vali Loss: 65.003 Vali Acc: 0.405 Test Loss: 65.003 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.842956066131592
Epoch: 22, Steps: 32 | Train Loss: 0.109 Vali Loss: 64.352 Vali Acc: 0.458 Test Loss: 64.352 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3949213
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.58359169960022
Epoch: 1, Steps: 32 | Train Loss: 7.340 Vali Loss: 9.872 Vali Acc: 0.137 Test Loss: 9.872 Test Acc: 0.137
Validation loss decreased (inf --> -0.137306).  Saving model ...
Epoch: 2 cost time: 7.404119968414307
Epoch: 2, Steps: 32 | Train Loss: 21.870 Vali Loss: 15.574 Vali Acc: 0.427 Test Loss: 15.574 Test Acc: 0.427
Validation loss decreased (-0.137306 --> -0.427325).  Saving model ...
Epoch: 3 cost time: 7.375018835067749
Epoch: 3, Steps: 32 | Train Loss: 20.412 Vali Loss: 17.550 Vali Acc: 0.450 Test Loss: 17.550 Test Acc: 0.450
Validation loss decreased (-0.427325 --> -0.450206).  Saving model ...
Epoch: 4 cost time: 7.401723861694336
Epoch: 4, Steps: 32 | Train Loss: 16.010 Vali Loss: 24.090 Vali Acc: 0.214 Test Loss: 24.090 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.2625977993011475
Epoch: 5, Steps: 32 | Train Loss: 6.683 Vali Loss: 26.976 Vali Acc: 0.527 Test Loss: 26.976 Test Acc: 0.527
Validation loss decreased (-0.450206 --> -0.526448).  Saving model ...
Epoch: 6 cost time: 7.365513801574707
Epoch: 6, Steps: 32 | Train Loss: 2.561 Vali Loss: 51.704 Vali Acc: 0.473 Test Loss: 51.704 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.392630100250244
Epoch: 7, Steps: 32 | Train Loss: 4.857 Vali Loss: 35.127 Vali Acc: 0.466 Test Loss: 35.127 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.440480470657349
Epoch: 8, Steps: 32 | Train Loss: 1.842 Vali Loss: 43.764 Vali Acc: 0.389 Test Loss: 43.764 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.34567403793335
Epoch: 9, Steps: 32 | Train Loss: 5.056 Vali Loss: 60.248 Vali Acc: 0.313 Test Loss: 60.248 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.279932260513306
Epoch: 10, Steps: 32 | Train Loss: 3.508 Vali Loss: 50.558 Vali Acc: 0.435 Test Loss: 50.558 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.217017650604248
Epoch: 11, Steps: 32 | Train Loss: 1.003 Vali Loss: 61.842 Vali Acc: 0.511 Test Loss: 61.842 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.444198369979858
Epoch: 12, Steps: 32 | Train Loss: 0.728 Vali Loss: 49.110 Vali Acc: 0.389 Test Loss: 49.110 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.39054012298584
Epoch: 13, Steps: 32 | Train Loss: 0.238 Vali Loss: 47.434 Vali Acc: 0.435 Test Loss: 47.434 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.384336709976196
Epoch: 14, Steps: 32 | Train Loss: 0.061 Vali Loss: 54.597 Vali Acc: 0.412 Test Loss: 54.597 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.390890836715698
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 55.031 Vali Acc: 0.412 Test Loss: 55.031 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3853277
model size : 19.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.228968381881714
Epoch: 1, Steps: 32 | Train Loss: 9.903 Vali Loss: 6.215 Vali Acc: 0.176 Test Loss: 6.215 Test Acc: 0.176
Validation loss decreased (inf --> -0.175510).  Saving model ...
Epoch: 2 cost time: 7.841257333755493
Epoch: 2, Steps: 32 | Train Loss: 10.618 Vali Loss: 10.995 Vali Acc: 0.183 Test Loss: 10.995 Test Acc: 0.183
Validation loss decreased (-0.175510 --> -0.183096).  Saving model ...
Epoch: 3 cost time: 7.692081689834595
Epoch: 3, Steps: 32 | Train Loss: 10.898 Vali Loss: 12.899 Vali Acc: 0.198 Test Loss: 12.899 Test Acc: 0.198
Validation loss decreased (-0.183096 --> -0.198344).  Saving model ...
Epoch: 4 cost time: 7.792168140411377
Epoch: 4, Steps: 32 | Train Loss: 8.957 Vali Loss: 20.869 Vali Acc: 0.168 Test Loss: 20.869 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.633949518203735
Epoch: 5, Steps: 32 | Train Loss: 19.994 Vali Loss: 34.376 Vali Acc: 0.427 Test Loss: 34.376 Test Acc: 0.427
Validation loss decreased (-0.198344 --> -0.427137).  Saving model ...
Epoch: 6 cost time: 7.777700185775757
Epoch: 6, Steps: 32 | Train Loss: 12.786 Vali Loss: 38.020 Vali Acc: 0.443 Test Loss: 38.020 Test Acc: 0.443
Validation loss decreased (-0.427137 --> -0.442368).  Saving model ...
Epoch: 7 cost time: 7.710739612579346
Epoch: 7, Steps: 32 | Train Loss: 3.856 Vali Loss: 26.481 Vali Acc: 0.397 Test Loss: 26.481 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.780815362930298
Epoch: 8, Steps: 32 | Train Loss: 1.388 Vali Loss: 52.889 Vali Acc: 0.489 Test Loss: 52.889 Test Acc: 0.489
Validation loss decreased (-0.442368 --> -0.488021).  Saving model ...
Epoch: 9 cost time: 7.63021445274353
Epoch: 9, Steps: 32 | Train Loss: 0.330 Vali Loss: 33.610 Vali Acc: 0.450 Test Loss: 33.610 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.523990154266357
Epoch: 10, Steps: 32 | Train Loss: 1.377 Vali Loss: 40.016 Vali Acc: 0.450 Test Loss: 40.016 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.566422462463379
Epoch: 11, Steps: 32 | Train Loss: 1.238 Vali Loss: 51.431 Vali Acc: 0.427 Test Loss: 51.431 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.714704275131226
Epoch: 12, Steps: 32 | Train Loss: 0.921 Vali Loss: 69.492 Vali Acc: 0.504 Test Loss: 69.492 Test Acc: 0.504
Validation loss decreased (-0.488021 --> -0.503122).  Saving model ...
Epoch: 13 cost time: 7.595937013626099
Epoch: 13, Steps: 32 | Train Loss: 1.926 Vali Loss: 63.809 Vali Acc: 0.473 Test Loss: 63.809 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.512190818786621
Epoch: 14, Steps: 32 | Train Loss: 1.276 Vali Loss: 53.821 Vali Acc: 0.412 Test Loss: 53.821 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.618293523788452
Epoch: 15, Steps: 32 | Train Loss: 0.370 Vali Loss: 79.253 Vali Acc: 0.504 Test Loss: 79.253 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.516097545623779
Epoch: 16, Steps: 32 | Train Loss: 0.774 Vali Loss: 62.112 Vali Acc: 0.412 Test Loss: 62.112 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.583181142807007
Epoch: 17, Steps: 32 | Train Loss: 0.125 Vali Loss: 62.677 Vali Acc: 0.504 Test Loss: 62.677 Test Acc: 0.504
Validation loss decreased (-0.503122 --> -0.503190).  Saving model ...
Epoch: 18 cost time: 7.872642755508423
Epoch: 18, Steps: 32 | Train Loss: 0.003 Vali Loss: 65.050 Vali Acc: 0.389 Test Loss: 65.050 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.646774530410767
Epoch: 19, Steps: 32 | Train Loss: 0.010 Vali Loss: 57.901 Vali Acc: 0.405 Test Loss: 57.901 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.696738958358765
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.806 Vali Acc: 0.412 Test Loss: 57.806 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.553339242935181
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.591951370239258
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.530768156051636
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.630824565887451
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.824256896972656
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.624896049499512
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.644417762756348
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.803 Vali Acc: 0.412 Test Loss: 57.803 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 4091549
model size : 20.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.021590232849121
Epoch: 1, Steps: 32 | Train Loss: 8.984 Vali Loss: 13.568 Vali Acc: 0.176 Test Loss: 13.568 Test Acc: 0.176
Validation loss decreased (inf --> -0.175437).  Saving model ...
Epoch: 2 cost time: 7.758971452713013
Epoch: 2, Steps: 32 | Train Loss: 17.231 Vali Loss: 17.633 Vali Acc: 0.366 Test Loss: 17.633 Test Acc: 0.366
Validation loss decreased (-0.175437 --> -0.366236).  Saving model ...
Epoch: 3 cost time: 7.4228293895721436
Epoch: 3, Steps: 32 | Train Loss: 22.833 Vali Loss: 15.227 Vali Acc: 0.412 Test Loss: 15.227 Test Acc: 0.412
Validation loss decreased (-0.366236 --> -0.412061).  Saving model ...
Epoch: 4 cost time: 7.615944862365723
Epoch: 4, Steps: 32 | Train Loss: 10.244 Vali Loss: 46.247 Vali Acc: 0.420 Test Loss: 46.247 Test Acc: 0.420
Validation loss decreased (-0.412061 --> -0.419385).  Saving model ...
Epoch: 5 cost time: 7.59826922416687
Epoch: 5, Steps: 32 | Train Loss: 10.438 Vali Loss: 33.885 Vali Acc: 0.489 Test Loss: 33.885 Test Acc: 0.489
Validation loss decreased (-0.419385 --> -0.488211).  Saving model ...
Epoch: 6 cost time: 7.825428485870361
Epoch: 6, Steps: 32 | Train Loss: 6.207 Vali Loss: 32.839 Vali Acc: 0.496 Test Loss: 32.839 Test Acc: 0.496
Validation loss decreased (-0.488211 --> -0.495855).  Saving model ...
Epoch: 7 cost time: 7.642925024032593
Epoch: 7, Steps: 32 | Train Loss: 4.167 Vali Loss: 34.961 Vali Acc: 0.382 Test Loss: 34.961 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.831011772155762
Epoch: 8, Steps: 32 | Train Loss: 3.240 Vali Loss: 41.648 Vali Acc: 0.481 Test Loss: 41.648 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.659903287887573
Epoch: 9, Steps: 32 | Train Loss: 2.696 Vali Loss: 38.140 Vali Acc: 0.435 Test Loss: 38.140 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.659350633621216
Epoch: 10, Steps: 32 | Train Loss: 0.955 Vali Loss: 62.861 Vali Acc: 0.504 Test Loss: 62.861 Test Acc: 0.504
Validation loss decreased (-0.495855 --> -0.503188).  Saving model ...
Epoch: 11 cost time: 7.702232122421265
Epoch: 11, Steps: 32 | Train Loss: 0.641 Vali Loss: 45.785 Vali Acc: 0.489 Test Loss: 45.785 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.741981744766235
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.028 Vali Acc: 0.458 Test Loss: 48.028 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.761968612670898
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.111 Vali Acc: 0.458 Test Loss: 48.111 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.655222415924072
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.5709545612335205
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.671522617340088
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.549018144607544
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.598482131958008
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.569969892501831
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.564582824707031
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.115 Vali Acc: 0.458 Test Loss: 48.115 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 3995613
model size : 19.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.12145709991455
Epoch: 1, Steps: 32 | Train Loss: 8.825 Vali Loss: 7.318 Vali Acc: 0.168 Test Loss: 7.318 Test Acc: 0.168
Validation loss decreased (inf --> -0.167866).  Saving model ...
Epoch: 2 cost time: 7.4246509075164795
Epoch: 2, Steps: 32 | Train Loss: 14.993 Vali Loss: 18.173 Vali Acc: 0.145 Test Loss: 18.173 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.378676176071167
Epoch: 3, Steps: 32 | Train Loss: 12.298 Vali Loss: 19.669 Vali Acc: 0.206 Test Loss: 19.669 Test Acc: 0.206
Validation loss decreased (-0.167866 --> -0.205910).  Saving model ...
Epoch: 4 cost time: 7.507742643356323
Epoch: 4, Steps: 32 | Train Loss: 15.754 Vali Loss: 24.435 Vali Acc: 0.336 Test Loss: 24.435 Test Acc: 0.336
Validation loss decreased (-0.205910 --> -0.335634).  Saving model ...
Epoch: 5 cost time: 7.517733812332153
Epoch: 5, Steps: 32 | Train Loss: 11.772 Vali Loss: 30.778 Vali Acc: 0.237 Test Loss: 30.778 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.653319597244263
Epoch: 6, Steps: 32 | Train Loss: 3.212 Vali Loss: 46.570 Vali Acc: 0.496 Test Loss: 46.570 Test Acc: 0.496
Validation loss decreased (-0.335634 --> -0.495718).  Saving model ...
Epoch: 7 cost time: 7.565065860748291
Epoch: 7, Steps: 32 | Train Loss: 5.683 Vali Loss: 33.022 Vali Acc: 0.458 Test Loss: 33.022 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.448648929595947
Epoch: 8, Steps: 32 | Train Loss: 2.895 Vali Loss: 41.823 Vali Acc: 0.427 Test Loss: 41.823 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.52887225151062
Epoch: 9, Steps: 32 | Train Loss: 2.725 Vali Loss: 44.864 Vali Acc: 0.389 Test Loss: 44.864 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.529587507247925
Epoch: 10, Steps: 32 | Train Loss: 3.788 Vali Loss: 60.309 Vali Acc: 0.473 Test Loss: 60.309 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.606975793838501
Epoch: 11, Steps: 32 | Train Loss: 0.720 Vali Loss: 49.273 Vali Acc: 0.557 Test Loss: 49.273 Test Acc: 0.557
Validation loss decreased (-0.495718 --> -0.556759).  Saving model ...
Epoch: 12 cost time: 7.421477556228638
Epoch: 12, Steps: 32 | Train Loss: 0.965 Vali Loss: 52.790 Vali Acc: 0.519 Test Loss: 52.790 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.446796655654907
Epoch: 13, Steps: 32 | Train Loss: 1.201 Vali Loss: 65.062 Vali Acc: 0.527 Test Loss: 65.062 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.6964545249938965
Epoch: 14, Steps: 32 | Train Loss: 0.219 Vali Loss: 56.942 Vali Acc: 0.519 Test Loss: 56.942 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.548752546310425
Epoch: 15, Steps: 32 | Train Loss: 0.102 Vali Loss: 60.195 Vali Acc: 0.382 Test Loss: 60.195 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.57976222038269
Epoch: 16, Steps: 32 | Train Loss: 1.082 Vali Loss: 56.011 Vali Acc: 0.519 Test Loss: 56.011 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.517806053161621
Epoch: 17, Steps: 32 | Train Loss: 0.830 Vali Loss: 62.256 Vali Acc: 0.519 Test Loss: 62.256 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.523449420928955
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 62.855 Vali Acc: 0.534 Test Loss: 62.855 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.7046849727630615
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 62.883 Vali Acc: 0.534 Test Loss: 62.883 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.463747262954712
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 62.805 Vali Acc: 0.534 Test Loss: 62.805 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.681386470794678
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 62.665 Vali Acc: 0.534 Test Loss: 62.665 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3899677
model size : 19.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.703135013580322
Epoch: 1, Steps: 32 | Train Loss: 9.361 Vali Loss: 23.839 Vali Acc: 0.168 Test Loss: 23.839 Test Acc: 0.168
Validation loss decreased (inf --> -0.167701).  Saving model ...
Epoch: 2 cost time: 7.299672365188599
Epoch: 2, Steps: 32 | Train Loss: 16.943 Vali Loss: 13.485 Vali Acc: 0.435 Test Loss: 13.485 Test Acc: 0.435
Validation loss decreased (-0.167701 --> -0.434980).  Saving model ...
Epoch: 3 cost time: 7.313149452209473
Epoch: 3, Steps: 32 | Train Loss: 18.594 Vali Loss: 29.820 Vali Acc: 0.458 Test Loss: 29.820 Test Acc: 0.458
Validation loss decreased (-0.434980 --> -0.457717).  Saving model ...
Epoch: 4 cost time: 7.396667003631592
Epoch: 4, Steps: 32 | Train Loss: 22.581 Vali Loss: 15.524 Vali Acc: 0.489 Test Loss: 15.524 Test Acc: 0.489
Validation loss decreased (-0.457717 --> -0.488394).  Saving model ...
Epoch: 5 cost time: 7.387904405593872
Epoch: 5, Steps: 32 | Train Loss: 7.459 Vali Loss: 19.999 Vali Acc: 0.427 Test Loss: 19.999 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.432074785232544
Epoch: 6, Steps: 32 | Train Loss: 4.934 Vali Loss: 35.239 Vali Acc: 0.450 Test Loss: 35.239 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.3394482135772705
Epoch: 7, Steps: 32 | Train Loss: 3.511 Vali Loss: 42.207 Vali Acc: 0.481 Test Loss: 42.207 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.3988611698150635
Epoch: 8, Steps: 32 | Train Loss: 2.864 Vali Loss: 39.845 Vali Acc: 0.527 Test Loss: 39.845 Test Acc: 0.527
Validation loss decreased (-0.488394 --> -0.526319).  Saving model ...
Epoch: 9 cost time: 7.4327709674835205
Epoch: 9, Steps: 32 | Train Loss: 1.944 Vali Loss: 49.582 Vali Acc: 0.496 Test Loss: 49.582 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.488189697265625
Epoch: 10, Steps: 32 | Train Loss: 3.846 Vali Loss: 41.122 Vali Acc: 0.435 Test Loss: 41.122 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.50641655921936
Epoch: 11, Steps: 32 | Train Loss: 1.110 Vali Loss: 57.536 Vali Acc: 0.504 Test Loss: 57.536 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.456446170806885
Epoch: 12, Steps: 32 | Train Loss: 0.820 Vali Loss: 52.448 Vali Acc: 0.481 Test Loss: 52.448 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.507819414138794
Epoch: 13, Steps: 32 | Train Loss: 0.041 Vali Loss: 54.519 Vali Acc: 0.473 Test Loss: 54.519 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.563557386398315
Epoch: 14, Steps: 32 | Train Loss: 0.132 Vali Loss: 49.402 Vali Acc: 0.519 Test Loss: 49.402 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.489043712615967
Epoch: 15, Steps: 32 | Train Loss: 0.443 Vali Loss: 48.407 Vali Acc: 0.534 Test Loss: 48.407 Test Acc: 0.534
Validation loss decreased (-0.526319 --> -0.533867).  Saving model ...
Epoch: 16 cost time: 7.4515602588653564
Epoch: 16, Steps: 32 | Train Loss: 3.261 Vali Loss: 50.885 Vali Acc: 0.427 Test Loss: 50.885 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.383945465087891
Epoch: 17, Steps: 32 | Train Loss: 1.070 Vali Loss: 50.012 Vali Acc: 0.412 Test Loss: 50.012 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.426891803741455
Epoch: 18, Steps: 32 | Train Loss: 1.395 Vali Loss: 56.753 Vali Acc: 0.489 Test Loss: 56.753 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.572880268096924
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.749 Vali Acc: 0.473 Test Loss: 54.749 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.474272727966309
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.354 Vali Acc: 0.443 Test Loss: 54.354 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.6055519580841064
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.346 Vali Acc: 0.443 Test Loss: 54.346 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.516709089279175
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.345 Vali Acc: 0.443 Test Loss: 54.345 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.422249794006348
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.345 Vali Acc: 0.443 Test Loss: 54.345 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.367110252380371
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.345 Vali Acc: 0.443 Test Loss: 54.345 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.323561429977417
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.345 Vali Acc: 0.443 Test Loss: 54.345 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3803741
model size : 18.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.709017992019653
Epoch: 1, Steps: 32 | Train Loss: 4.840 Vali Loss: 3.281 Vali Acc: 0.130 Test Loss: 3.281 Test Acc: 0.130
Validation loss decreased (inf --> -0.129738).  Saving model ...
Epoch: 2 cost time: 7.406402826309204
Epoch: 2, Steps: 32 | Train Loss: 13.357 Vali Loss: 16.729 Vali Acc: 0.130 Test Loss: 16.729 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.31361722946167
Epoch: 3, Steps: 32 | Train Loss: 14.981 Vali Loss: 5.880 Vali Acc: 0.206 Test Loss: 5.880 Test Acc: 0.206
Validation loss decreased (-0.129738 --> -0.206048).  Saving model ...
Epoch: 4 cost time: 7.297909259796143
Epoch: 4, Steps: 32 | Train Loss: 6.725 Vali Loss: 25.333 Vali Acc: 0.214 Test Loss: 25.333 Test Acc: 0.214
Validation loss decreased (-0.206048 --> -0.213487).  Saving model ...
Epoch: 5 cost time: 7.281599521636963
Epoch: 5, Steps: 32 | Train Loss: 4.811 Vali Loss: 16.058 Vali Acc: 0.443 Test Loss: 16.058 Test Acc: 0.443
Validation loss decreased (-0.213487 --> -0.442588).  Saving model ...
Epoch: 6 cost time: 7.454674005508423
Epoch: 6, Steps: 32 | Train Loss: 1.481 Vali Loss: 29.765 Vali Acc: 0.496 Test Loss: 29.765 Test Acc: 0.496
Validation loss decreased (-0.442588 --> -0.495886).  Saving model ...
Epoch: 7 cost time: 7.379534721374512
Epoch: 7, Steps: 32 | Train Loss: 3.282 Vali Loss: 16.787 Vali Acc: 0.458 Test Loss: 16.787 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.583807945251465
Epoch: 8, Steps: 32 | Train Loss: 2.248 Vali Loss: 26.010 Vali Acc: 0.511 Test Loss: 26.010 Test Acc: 0.511
Validation loss decreased (-0.495886 --> -0.511190).  Saving model ...
Epoch: 9 cost time: 7.476729154586792
Epoch: 9, Steps: 32 | Train Loss: 0.382 Vali Loss: 15.553 Vali Acc: 0.550 Test Loss: 15.553 Test Acc: 0.550
Validation loss decreased (-0.511190 --> -0.549463).  Saving model ...
Epoch: 10 cost time: 7.482726097106934
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.744 Vali Acc: 0.519 Test Loss: 22.744 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.531786680221558
Epoch: 11, Steps: 32 | Train Loss: 0.361 Vali Loss: 26.398 Vali Acc: 0.519 Test Loss: 26.398 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.45849871635437
Epoch: 12, Steps: 32 | Train Loss: 0.376 Vali Loss: 20.228 Vali Acc: 0.473 Test Loss: 20.228 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.603557109832764
Epoch: 13, Steps: 32 | Train Loss: 0.368 Vali Loss: 31.318 Vali Acc: 0.504 Test Loss: 31.318 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.327175855636597
Epoch: 14, Steps: 32 | Train Loss: 0.191 Vali Loss: 31.523 Vali Acc: 0.427 Test Loss: 31.523 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.544645071029663
Epoch: 15, Steps: 32 | Train Loss: 0.092 Vali Loss: 27.214 Vali Acc: 0.435 Test Loss: 27.214 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.35809063911438
Epoch: 16, Steps: 32 | Train Loss: 0.030 Vali Loss: 28.202 Vali Acc: 0.527 Test Loss: 28.202 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.608310699462891
Epoch: 17, Steps: 32 | Train Loss: 0.158 Vali Loss: 31.327 Vali Acc: 0.519 Test Loss: 31.327 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.5304529666900635
Epoch: 18, Steps: 32 | Train Loss: 0.019 Vali Loss: 26.152 Vali Acc: 0.405 Test Loss: 26.152 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.293746471405029
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.999 Vali Acc: 0.427 Test Loss: 25.999 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2171549
model size : 10.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.75579571723938
Epoch: 1, Steps: 32 | Train Loss: 4.120 Vali Loss: 7.342 Vali Acc: 0.443 Test Loss: 7.342 Test Acc: 0.443
Validation loss decreased (inf --> -0.442675).  Saving model ...
Epoch: 2 cost time: 7.464085102081299
Epoch: 2, Steps: 32 | Train Loss: 6.915 Vali Loss: 19.569 Vali Acc: 0.145 Test Loss: 19.569 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.328855991363525
Epoch: 3, Steps: 32 | Train Loss: 11.684 Vali Loss: 31.300 Vali Acc: 0.191 Test Loss: 31.300 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.409114122390747
Epoch: 4, Steps: 32 | Train Loss: 14.405 Vali Loss: 8.309 Vali Acc: 0.405 Test Loss: 8.309 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.507500886917114
Epoch: 5, Steps: 32 | Train Loss: 4.133 Vali Loss: 18.693 Vali Acc: 0.260 Test Loss: 18.693 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.632503271102905
Epoch: 6, Steps: 32 | Train Loss: 1.672 Vali Loss: 24.054 Vali Acc: 0.450 Test Loss: 24.054 Test Acc: 0.450
Validation loss decreased (-0.442675 --> -0.450141).  Saving model ...
Epoch: 7 cost time: 7.469683408737183
Epoch: 7, Steps: 32 | Train Loss: 2.099 Vali Loss: 18.749 Vali Acc: 0.466 Test Loss: 18.749 Test Acc: 0.466
Validation loss decreased (-0.450141 --> -0.465461).  Saving model ...
Epoch: 8 cost time: 7.468312978744507
Epoch: 8, Steps: 32 | Train Loss: 0.398 Vali Loss: 21.180 Vali Acc: 0.489 Test Loss: 21.180 Test Acc: 0.489
Validation loss decreased (-0.465461 --> -0.488338).  Saving model ...
Epoch: 9 cost time: 7.562443256378174
Epoch: 9, Steps: 32 | Train Loss: 1.104 Vali Loss: 25.172 Vali Acc: 0.511 Test Loss: 25.172 Test Acc: 0.511
Validation loss decreased (-0.488338 --> -0.511199).  Saving model ...
Epoch: 10 cost time: 7.629303693771362
Epoch: 10, Steps: 32 | Train Loss: 0.402 Vali Loss: 30.110 Vali Acc: 0.511 Test Loss: 30.110 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.262940168380737
Epoch: 11, Steps: 32 | Train Loss: 0.402 Vali Loss: 23.347 Vali Acc: 0.466 Test Loss: 23.347 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.437407732009888
Epoch: 12, Steps: 32 | Train Loss: 0.027 Vali Loss: 29.537 Vali Acc: 0.511 Test Loss: 29.537 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.469829559326172
Epoch: 13, Steps: 32 | Train Loss: 0.618 Vali Loss: 22.092 Vali Acc: 0.466 Test Loss: 22.092 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.477306127548218
Epoch: 14, Steps: 32 | Train Loss: 0.135 Vali Loss: 31.357 Vali Acc: 0.504 Test Loss: 31.357 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.541037321090698
Epoch: 15, Steps: 32 | Train Loss: 0.273 Vali Loss: 41.755 Vali Acc: 0.496 Test Loss: 41.755 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.482584238052368
Epoch: 16, Steps: 32 | Train Loss: 0.156 Vali Loss: 31.925 Vali Acc: 0.412 Test Loss: 31.925 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.438192129135132
Epoch: 17, Steps: 32 | Train Loss: 0.644 Vali Loss: 28.083 Vali Acc: 0.504 Test Loss: 28.083 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.660832643508911
Epoch: 18, Steps: 32 | Train Loss: 0.536 Vali Loss: 29.081 Vali Acc: 0.458 Test Loss: 29.081 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.303818941116333
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 39.870 Vali Acc: 0.466 Test Loss: 39.870 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2123581
model size : 10.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.747066020965576
Epoch: 1, Steps: 32 | Train Loss: 5.170 Vali Loss: 8.333 Vali Acc: 0.107 Test Loss: 8.333 Test Acc: 0.107
Validation loss decreased (inf --> -0.106787).  Saving model ...
Epoch: 2 cost time: 7.357170104980469
Epoch: 2, Steps: 32 | Train Loss: 12.098 Vali Loss: 5.128 Vali Acc: 0.168 Test Loss: 5.128 Test Acc: 0.168
Validation loss decreased (-0.106787 --> -0.167888).  Saving model ...
Epoch: 3 cost time: 7.455117464065552
Epoch: 3, Steps: 32 | Train Loss: 5.975 Vali Loss: 12.054 Vali Acc: 0.427 Test Loss: 12.054 Test Acc: 0.427
Validation loss decreased (-0.167888 --> -0.427360).  Saving model ...
Epoch: 4 cost time: 7.386304140090942
Epoch: 4, Steps: 32 | Train Loss: 3.362 Vali Loss: 12.916 Vali Acc: 0.282 Test Loss: 12.916 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.563291549682617
Epoch: 5, Steps: 32 | Train Loss: 4.817 Vali Loss: 21.600 Vali Acc: 0.221 Test Loss: 21.600 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.3450608253479
Epoch: 6, Steps: 32 | Train Loss: 4.933 Vali Loss: 16.307 Vali Acc: 0.527 Test Loss: 16.307 Test Acc: 0.527
Validation loss decreased (-0.427360 --> -0.526554).  Saving model ...
Epoch: 7 cost time: 7.237392902374268
Epoch: 7, Steps: 32 | Train Loss: 1.174 Vali Loss: 20.808 Vali Acc: 0.405 Test Loss: 20.808 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.516720294952393
Epoch: 8, Steps: 32 | Train Loss: 0.872 Vali Loss: 18.358 Vali Acc: 0.504 Test Loss: 18.358 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.353997468948364
Epoch: 9, Steps: 32 | Train Loss: 0.357 Vali Loss: 17.047 Vali Acc: 0.511 Test Loss: 17.047 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.6357598304748535
Epoch: 10, Steps: 32 | Train Loss: 0.032 Vali Loss: 18.866 Vali Acc: 0.496 Test Loss: 18.866 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.433002948760986
Epoch: 11, Steps: 32 | Train Loss: 0.555 Vali Loss: 17.589 Vali Acc: 0.511 Test Loss: 17.589 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.48412299156189
Epoch: 12, Steps: 32 | Train Loss: 0.257 Vali Loss: 23.881 Vali Acc: 0.519 Test Loss: 23.881 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.408156633377075
Epoch: 13, Steps: 32 | Train Loss: 0.501 Vali Loss: 24.013 Vali Acc: 0.527 Test Loss: 24.013 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.555652379989624
Epoch: 14, Steps: 32 | Train Loss: 0.069 Vali Loss: 27.924 Vali Acc: 0.542 Test Loss: 27.924 Test Acc: 0.542
Validation loss decreased (-0.526554 --> -0.541705).  Saving model ...
Epoch: 15 cost time: 7.693502187728882
Epoch: 15, Steps: 32 | Train Loss: 0.228 Vali Loss: 25.625 Vali Acc: 0.534 Test Loss: 25.625 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.274851322174072
Epoch: 16, Steps: 32 | Train Loss: 0.060 Vali Loss: 22.255 Vali Acc: 0.435 Test Loss: 22.255 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.514345407485962
Epoch: 17, Steps: 32 | Train Loss: 0.864 Vali Loss: 24.747 Vali Acc: 0.450 Test Loss: 24.747 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.38064169883728
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.533 Vali Acc: 0.519 Test Loss: 28.533 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.589867830276489
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.290 Vali Acc: 0.519 Test Loss: 28.290 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.413851261138916
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.281 Vali Acc: 0.519 Test Loss: 28.281 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.474904298782349
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.280 Vali Acc: 0.519 Test Loss: 28.280 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.58273458480835
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.280 Vali Acc: 0.519 Test Loss: 28.280 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.419452428817749
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.280 Vali Acc: 0.519 Test Loss: 28.280 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.444087266921997
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.280 Vali Acc: 0.519 Test Loss: 28.280 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2075613
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.588234901428223
Epoch: 1, Steps: 32 | Train Loss: 4.508 Vali Loss: 10.325 Vali Acc: 0.420 Test Loss: 10.325 Test Acc: 0.420
Validation loss decreased (inf --> -0.419744).  Saving model ...
Epoch: 2 cost time: 7.246286869049072
Epoch: 2, Steps: 32 | Train Loss: 15.302 Vali Loss: 6.950 Vali Acc: 0.183 Test Loss: 6.950 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.088062047958374
Epoch: 3, Steps: 32 | Train Loss: 11.966 Vali Loss: 7.373 Vali Acc: 0.382 Test Loss: 7.373 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.084943532943726
Epoch: 4, Steps: 32 | Train Loss: 4.589 Vali Loss: 10.666 Vali Acc: 0.519 Test Loss: 10.666 Test Acc: 0.519
Validation loss decreased (-0.419744 --> -0.518977).  Saving model ...
Epoch: 5 cost time: 7.098912954330444
Epoch: 5, Steps: 32 | Train Loss: 8.357 Vali Loss: 12.547 Vali Acc: 0.534 Test Loss: 12.547 Test Acc: 0.534
Validation loss decreased (-0.518977 --> -0.534226).  Saving model ...
Epoch: 6 cost time: 7.139107704162598
Epoch: 6, Steps: 32 | Train Loss: 0.970 Vali Loss: 15.022 Vali Acc: 0.458 Test Loss: 15.022 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.075828790664673
Epoch: 7, Steps: 32 | Train Loss: 1.063 Vali Loss: 21.677 Vali Acc: 0.252 Test Loss: 21.677 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.065492630004883
Epoch: 8, Steps: 32 | Train Loss: 1.639 Vali Loss: 27.839 Vali Acc: 0.481 Test Loss: 27.839 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.161005973815918
Epoch: 9, Steps: 32 | Train Loss: 3.291 Vali Loss: 24.455 Vali Acc: 0.527 Test Loss: 24.455 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.339734315872192
Epoch: 10, Steps: 32 | Train Loss: 0.901 Vali Loss: 19.104 Vali Acc: 0.435 Test Loss: 19.104 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.61572527885437
Epoch: 11, Steps: 32 | Train Loss: 1.397 Vali Loss: 24.116 Vali Acc: 0.351 Test Loss: 24.116 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.12349009513855
Epoch: 12, Steps: 32 | Train Loss: 0.418 Vali Loss: 23.046 Vali Acc: 0.443 Test Loss: 23.046 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.286258220672607
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.042 Vali Acc: 0.527 Test Loss: 28.042 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.295748472213745
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.342 Vali Acc: 0.527 Test Loss: 28.342 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.238559007644653
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.352 Vali Acc: 0.527 Test Loss: 28.352 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2027645
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.936841011047363
Epoch: 1, Steps: 32 | Train Loss: 4.513 Vali Loss: 4.483 Vali Acc: 0.458 Test Loss: 4.483 Test Acc: 0.458
Validation loss decreased (inf --> -0.457970).  Saving model ...
Epoch: 2 cost time: 7.252868413925171
Epoch: 2, Steps: 32 | Train Loss: 8.772 Vali Loss: 7.981 Vali Acc: 0.191 Test Loss: 7.981 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.302999019622803
Epoch: 3, Steps: 32 | Train Loss: 15.129 Vali Loss: 12.467 Vali Acc: 0.466 Test Loss: 12.467 Test Acc: 0.466
Validation loss decreased (-0.457970 --> -0.465524).  Saving model ...
Epoch: 4 cost time: 7.426788568496704
Epoch: 4, Steps: 32 | Train Loss: 9.905 Vali Loss: 16.502 Vali Acc: 0.176 Test Loss: 16.502 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.248311996459961
Epoch: 5, Steps: 32 | Train Loss: 4.497 Vali Loss: 15.705 Vali Acc: 0.313 Test Loss: 15.705 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.2850611209869385
Epoch: 6, Steps: 32 | Train Loss: 2.198 Vali Loss: 22.440 Vali Acc: 0.344 Test Loss: 22.440 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.239011526107788
Epoch: 7, Steps: 32 | Train Loss: 0.872 Vali Loss: 16.151 Vali Acc: 0.458 Test Loss: 16.151 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.200065851211548
Epoch: 8, Steps: 32 | Train Loss: 0.350 Vali Loss: 17.621 Vali Acc: 0.519 Test Loss: 17.621 Test Acc: 0.519
Validation loss decreased (-0.465524 --> -0.518908).  Saving model ...
Epoch: 9 cost time: 7.193004846572876
Epoch: 9, Steps: 32 | Train Loss: 0.574 Vali Loss: 29.064 Vali Acc: 0.504 Test Loss: 29.064 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.2790281772613525
Epoch: 10, Steps: 32 | Train Loss: 1.119 Vali Loss: 26.624 Vali Acc: 0.519 Test Loss: 26.624 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.175755262374878
Epoch: 11, Steps: 32 | Train Loss: 1.053 Vali Loss: 29.909 Vali Acc: 0.504 Test Loss: 29.909 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.326895713806152
Epoch: 12, Steps: 32 | Train Loss: 0.273 Vali Loss: 26.970 Vali Acc: 0.519 Test Loss: 26.970 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.232908010482788
Epoch: 13, Steps: 32 | Train Loss: 0.554 Vali Loss: 33.451 Vali Acc: 0.313 Test Loss: 33.451 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.394552707672119
Epoch: 14, Steps: 32 | Train Loss: 0.267 Vali Loss: 37.646 Vali Acc: 0.504 Test Loss: 37.646 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.348182439804077
Epoch: 15, Steps: 32 | Train Loss: 0.001 Vali Loss: 27.232 Vali Acc: 0.550 Test Loss: 27.232 Test Acc: 0.550
Validation loss decreased (-0.518908 --> -0.549346).  Saving model ...
Epoch: 16 cost time: 7.28412652015686
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.881 Vali Acc: 0.519 Test Loss: 23.881 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.171379089355469
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.070 Vali Acc: 0.504 Test Loss: 28.070 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.242442846298218
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.333 Vali Acc: 0.504 Test Loss: 28.333 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.299483060836792
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.378787994384766
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.261786699295044
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.535763740539551
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.42554497718811
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.417454481124878
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.631387948989868
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.343 Vali Acc: 0.504 Test Loss: 28.343 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2071709
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.5688316822052
Epoch: 1, Steps: 32 | Train Loss: 5.172 Vali Loss: 10.651 Vali Acc: 0.122 Test Loss: 10.651 Test Acc: 0.122
Validation loss decreased (inf --> -0.122031).  Saving model ...
Epoch: 2 cost time: 7.373206853866577
Epoch: 2, Steps: 32 | Train Loss: 15.620 Vali Loss: 8.519 Vali Acc: 0.122 Test Loss: 8.519 Test Acc: 0.122
Validation loss decreased (-0.122031 --> -0.122052).  Saving model ...
Epoch: 3 cost time: 7.439520835876465
Epoch: 3, Steps: 32 | Train Loss: 7.776 Vali Loss: 13.118 Vali Acc: 0.435 Test Loss: 13.118 Test Acc: 0.435
Validation loss decreased (-0.122052 --> -0.434983).  Saving model ...
Epoch: 4 cost time: 7.2148449420928955
Epoch: 4, Steps: 32 | Train Loss: 11.271 Vali Loss: 19.745 Vali Acc: 0.458 Test Loss: 19.745 Test Acc: 0.458
Validation loss decreased (-0.434983 --> -0.457818).  Saving model ...
Epoch: 5 cost time: 7.300349235534668
Epoch: 5, Steps: 32 | Train Loss: 3.256 Vali Loss: 15.896 Vali Acc: 0.504 Test Loss: 15.896 Test Acc: 0.504
Validation loss decreased (-0.457818 --> -0.503658).  Saving model ...
Epoch: 6 cost time: 7.263432025909424
Epoch: 6, Steps: 32 | Train Loss: 4.079 Vali Loss: 16.333 Vali Acc: 0.527 Test Loss: 16.333 Test Acc: 0.527
Validation loss decreased (-0.503658 --> -0.526554).  Saving model ...
Epoch: 7 cost time: 7.433678150177002
Epoch: 7, Steps: 32 | Train Loss: 0.629 Vali Loss: 20.736 Vali Acc: 0.527 Test Loss: 20.736 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.247872352600098
Epoch: 8, Steps: 32 | Train Loss: 1.166 Vali Loss: 30.691 Vali Acc: 0.221 Test Loss: 30.691 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.2118730545043945
Epoch: 9, Steps: 32 | Train Loss: 2.567 Vali Loss: 25.896 Vali Acc: 0.435 Test Loss: 25.896 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.39296817779541
Epoch: 10, Steps: 32 | Train Loss: 1.865 Vali Loss: 31.169 Vali Acc: 0.511 Test Loss: 31.169 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.329969644546509
Epoch: 11, Steps: 32 | Train Loss: 0.563 Vali Loss: 24.185 Vali Acc: 0.511 Test Loss: 24.185 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.422971248626709
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.506 Vali Acc: 0.527 Test Loss: 29.506 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.201766729354858
Epoch: 13, Steps: 32 | Train Loss: 0.228 Vali Loss: 25.888 Vali Acc: 0.511 Test Loss: 25.888 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.294295310974121
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.715 Vali Acc: 0.519 Test Loss: 27.715 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.263031005859375
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.790 Vali Acc: 0.519 Test Loss: 27.790 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.271796703338623
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.793 Vali Acc: 0.519 Test Loss: 27.793 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2023741
model size : 9.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.529419898986816
Epoch: 1, Steps: 32 | Train Loss: 4.853 Vali Loss: 10.025 Vali Acc: 0.420 Test Loss: 10.025 Test Acc: 0.420
Validation loss decreased (inf --> -0.419747).  Saving model ...
Epoch: 2 cost time: 7.156641483306885
Epoch: 2, Steps: 32 | Train Loss: 9.461 Vali Loss: 12.229 Vali Acc: 0.168 Test Loss: 12.229 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.317239046096802
Epoch: 3, Steps: 32 | Train Loss: 7.318 Vali Loss: 6.899 Vali Acc: 0.481 Test Loss: 6.899 Test Acc: 0.481
Validation loss decreased (-0.419747 --> -0.480847).  Saving model ...
Epoch: 4 cost time: 7.244351863861084
Epoch: 4, Steps: 32 | Train Loss: 4.818 Vali Loss: 8.349 Vali Acc: 0.443 Test Loss: 8.349 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.391713380813599
Epoch: 5, Steps: 32 | Train Loss: 4.515 Vali Loss: 36.930 Vali Acc: 0.450 Test Loss: 36.930 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.189939975738525
Epoch: 6, Steps: 32 | Train Loss: 4.079 Vali Loss: 17.057 Vali Acc: 0.504 Test Loss: 17.057 Test Acc: 0.504
Validation loss decreased (-0.480847 --> -0.503646).  Saving model ...
Epoch: 7 cost time: 7.371986150741577
Epoch: 7, Steps: 32 | Train Loss: 1.224 Vali Loss: 18.612 Vali Acc: 0.389 Test Loss: 18.612 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.260085821151733
Epoch: 8, Steps: 32 | Train Loss: 1.242 Vali Loss: 18.116 Vali Acc: 0.527 Test Loss: 18.116 Test Acc: 0.527
Validation loss decreased (-0.503646 --> -0.526536).  Saving model ...
Epoch: 9 cost time: 7.285198450088501
Epoch: 9, Steps: 32 | Train Loss: 1.466 Vali Loss: 22.294 Vali Acc: 0.542 Test Loss: 22.294 Test Acc: 0.542
Validation loss decreased (-0.526536 --> -0.541762).  Saving model ...
Epoch: 10 cost time: 7.21622896194458
Epoch: 10, Steps: 32 | Train Loss: 0.183 Vali Loss: 31.669 Vali Acc: 0.511 Test Loss: 31.669 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.381877183914185
Epoch: 11, Steps: 32 | Train Loss: 0.066 Vali Loss: 34.528 Vali Acc: 0.511 Test Loss: 34.528 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.245444059371948
Epoch: 12, Steps: 32 | Train Loss: 0.224 Vali Loss: 30.221 Vali Acc: 0.511 Test Loss: 30.221 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.290674924850464
Epoch: 13, Steps: 32 | Train Loss: 0.941 Vali Loss: 21.424 Vali Acc: 0.382 Test Loss: 21.424 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.4735143184661865
Epoch: 14, Steps: 32 | Train Loss: 0.415 Vali Loss: 26.139 Vali Acc: 0.496 Test Loss: 26.139 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.3887619972229
Epoch: 15, Steps: 32 | Train Loss: 0.209 Vali Loss: 37.949 Vali Acc: 0.412 Test Loss: 37.949 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.321947336196899
Epoch: 16, Steps: 32 | Train Loss: 0.185 Vali Loss: 36.435 Vali Acc: 0.519 Test Loss: 36.435 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.285699129104614
Epoch: 17, Steps: 32 | Train Loss: 0.182 Vali Loss: 32.294 Vali Acc: 0.351 Test Loss: 32.294 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.450340986251831
Epoch: 18, Steps: 32 | Train Loss: 1.329 Vali Loss: 44.803 Vali Acc: 0.374 Test Loss: 44.803 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.279422760009766
Epoch: 19, Steps: 32 | Train Loss: 0.257 Vali Loss: 32.044 Vali Acc: 0.382 Test Loss: 32.044 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1975773
model size : 9.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.148171424865723
Epoch: 1, Steps: 32 | Train Loss: 3.925 Vali Loss: 5.842 Vali Acc: 0.137 Test Loss: 5.842 Test Acc: 0.137
Validation loss decreased (inf --> -0.137346).  Saving model ...
Epoch: 2 cost time: 6.983568429946899
Epoch: 2, Steps: 32 | Train Loss: 7.508 Vali Loss: 10.449 Vali Acc: 0.198 Test Loss: 10.449 Test Acc: 0.198
Validation loss decreased (-0.137346 --> -0.198369).  Saving model ...
Epoch: 3 cost time: 7.066183805465698
Epoch: 3, Steps: 32 | Train Loss: 11.797 Vali Loss: 9.242 Vali Acc: 0.450 Test Loss: 9.242 Test Acc: 0.450
Validation loss decreased (-0.198369 --> -0.450289).  Saving model ...
Epoch: 4 cost time: 7.067467451095581
Epoch: 4, Steps: 32 | Train Loss: 8.055 Vali Loss: 10.707 Vali Acc: 0.427 Test Loss: 10.707 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.063154935836792
Epoch: 5, Steps: 32 | Train Loss: 6.416 Vali Loss: 15.166 Vali Acc: 0.511 Test Loss: 15.166 Test Acc: 0.511
Validation loss decreased (-0.450289 --> -0.511299).  Saving model ...
Epoch: 6 cost time: 7.059618234634399
Epoch: 6, Steps: 32 | Train Loss: 1.968 Vali Loss: 18.196 Vali Acc: 0.504 Test Loss: 18.196 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.1301069259643555
Epoch: 7, Steps: 32 | Train Loss: 0.936 Vali Loss: 17.930 Vali Acc: 0.412 Test Loss: 17.930 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.290740251541138
Epoch: 8, Steps: 32 | Train Loss: 0.183 Vali Loss: 21.178 Vali Acc: 0.351 Test Loss: 21.178 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.909330368041992
Epoch: 9, Steps: 32 | Train Loss: 1.552 Vali Loss: 23.759 Vali Acc: 0.511 Test Loss: 23.759 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.011404991149902
Epoch: 10, Steps: 32 | Train Loss: 0.224 Vali Loss: 23.318 Vali Acc: 0.511 Test Loss: 23.318 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.005739450454712
Epoch: 11, Steps: 32 | Train Loss: 0.106 Vali Loss: 21.551 Vali Acc: 0.511 Test Loss: 21.551 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.9809958934783936
Epoch: 12, Steps: 32 | Train Loss: 0.669 Vali Loss: 22.737 Vali Acc: 0.427 Test Loss: 22.737 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.143206357955933
Epoch: 13, Steps: 32 | Train Loss: 0.430 Vali Loss: 30.522 Vali Acc: 0.550 Test Loss: 30.522 Test Acc: 0.550
Validation loss decreased (-0.511299 --> -0.549313).  Saving model ...
Epoch: 14 cost time: 6.970792531967163
Epoch: 14, Steps: 32 | Train Loss: 0.283 Vali Loss: 25.757 Vali Acc: 0.473 Test Loss: 25.757 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.99825119972229
Epoch: 15, Steps: 32 | Train Loss: 0.192 Vali Loss: 28.020 Vali Acc: 0.450 Test Loss: 28.020 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.896969318389893
Epoch: 16, Steps: 32 | Train Loss: 0.194 Vali Loss: 33.679 Vali Acc: 0.519 Test Loss: 33.679 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.043649196624756
Epoch: 17, Steps: 32 | Train Loss: 0.607 Vali Loss: 29.369 Vali Acc: 0.450 Test Loss: 29.369 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.89628529548645
Epoch: 18, Steps: 32 | Train Loss: 0.045 Vali Loss: 39.452 Vali Acc: 0.511 Test Loss: 39.452 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.03940224647522
Epoch: 19, Steps: 32 | Train Loss: 0.035 Vali Loss: 33.538 Vali Acc: 0.420 Test Loss: 33.538 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.220784425735474
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.322 Vali Acc: 0.450 Test Loss: 34.322 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.066274881362915
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.386 Vali Acc: 0.450 Test Loss: 34.386 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.116604566574097
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.391 Vali Acc: 0.450 Test Loss: 34.391 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.9933576583862305
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.390 Vali Acc: 0.450 Test Loss: 34.390 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1927805
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.539966106414795
Epoch: 1, Steps: 32 | Train Loss: 4.806 Vali Loss: 9.100 Vali Acc: 0.221 Test Loss: 9.100 Test Acc: 0.221
Validation loss decreased (inf --> -0.221283).  Saving model ...
Epoch: 2 cost time: 7.102861642837524
Epoch: 2, Steps: 32 | Train Loss: 6.825 Vali Loss: 4.980 Vali Acc: 0.374 Test Loss: 4.980 Test Acc: 0.374
Validation loss decreased (-0.221283 --> -0.373996).  Saving model ...
Epoch: 3 cost time: 7.339674711227417
Epoch: 3, Steps: 32 | Train Loss: 9.728 Vali Loss: 8.176 Vali Acc: 0.168 Test Loss: 8.176 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.152762413024902
Epoch: 4, Steps: 32 | Train Loss: 6.605 Vali Loss: 18.656 Vali Acc: 0.176 Test Loss: 18.656 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.149764776229858
Epoch: 5, Steps: 32 | Train Loss: 7.578 Vali Loss: 16.497 Vali Acc: 0.489 Test Loss: 16.497 Test Acc: 0.489
Validation loss decreased (-0.373996 --> -0.488385).  Saving model ...
Epoch: 6 cost time: 7.390398740768433
Epoch: 6, Steps: 32 | Train Loss: 1.458 Vali Loss: 18.722 Vali Acc: 0.511 Test Loss: 18.722 Test Acc: 0.511
Validation loss decreased (-0.488385 --> -0.511263).  Saving model ...
Epoch: 7 cost time: 7.276586055755615
Epoch: 7, Steps: 32 | Train Loss: 0.841 Vali Loss: 21.574 Vali Acc: 0.489 Test Loss: 21.574 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.294594764709473
Epoch: 8, Steps: 32 | Train Loss: 2.406 Vali Loss: 21.450 Vali Acc: 0.496 Test Loss: 21.450 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.257683992385864
Epoch: 9, Steps: 32 | Train Loss: 1.592 Vali Loss: 18.285 Vali Acc: 0.397 Test Loss: 18.285 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.3527374267578125
Epoch: 10, Steps: 32 | Train Loss: 0.113 Vali Loss: 22.013 Vali Acc: 0.420 Test Loss: 22.013 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.335509777069092
Epoch: 11, Steps: 32 | Train Loss: 0.387 Vali Loss: 25.184 Vali Acc: 0.458 Test Loss: 25.184 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.4849231243133545
Epoch: 12, Steps: 32 | Train Loss: 0.945 Vali Loss: 22.161 Vali Acc: 0.466 Test Loss: 22.161 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.266286611557007
Epoch: 13, Steps: 32 | Train Loss: 0.234 Vali Loss: 25.039 Vali Acc: 0.458 Test Loss: 25.039 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.243215560913086
Epoch: 14, Steps: 32 | Train Loss: 0.365 Vali Loss: 29.605 Vali Acc: 0.504 Test Loss: 29.605 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.232492208480835
Epoch: 15, Steps: 32 | Train Loss: 0.200 Vali Loss: 30.403 Vali Acc: 0.427 Test Loss: 30.403 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.286502122879028
Epoch: 16, Steps: 32 | Train Loss: 0.222 Vali Loss: 25.168 Vali Acc: 0.450 Test Loss: 25.168 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2021789
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.149618864059448
Epoch: 1, Steps: 32 | Train Loss: 5.155 Vali Loss: 11.202 Vali Acc: 0.420 Test Loss: 11.202 Test Acc: 0.420
Validation loss decreased (inf --> -0.419735).  Saving model ...
Epoch: 2 cost time: 7.172680854797363
Epoch: 2, Steps: 32 | Train Loss: 9.495 Vali Loss: 6.986 Vali Acc: 0.191 Test Loss: 6.986 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.011709690093994
Epoch: 3, Steps: 32 | Train Loss: 8.801 Vali Loss: 14.640 Vali Acc: 0.153 Test Loss: 14.640 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.05328369140625
Epoch: 4, Steps: 32 | Train Loss: 9.618 Vali Loss: 13.669 Vali Acc: 0.458 Test Loss: 13.669 Test Acc: 0.458
Validation loss decreased (-0.419735 --> -0.457879).  Saving model ...
Epoch: 5 cost time: 7.0618062019348145
Epoch: 5, Steps: 32 | Train Loss: 10.100 Vali Loss: 12.175 Vali Acc: 0.298 Test Loss: 12.175 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.087881565093994
Epoch: 6, Steps: 32 | Train Loss: 2.294 Vali Loss: 17.280 Vali Acc: 0.481 Test Loss: 17.280 Test Acc: 0.481
Validation loss decreased (-0.457879 --> -0.480743).  Saving model ...
Epoch: 7 cost time: 7.107125997543335
Epoch: 7, Steps: 32 | Train Loss: 0.469 Vali Loss: 20.896 Vali Acc: 0.519 Test Loss: 20.896 Test Acc: 0.519
Validation loss decreased (-0.480743 --> -0.518875).  Saving model ...
Epoch: 8 cost time: 7.076483964920044
Epoch: 8, Steps: 32 | Train Loss: 0.993 Vali Loss: 23.721 Vali Acc: 0.229 Test Loss: 23.721 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.061006307601929
Epoch: 9, Steps: 32 | Train Loss: 2.014 Vali Loss: 29.343 Vali Acc: 0.366 Test Loss: 29.343 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.2084362506866455
Epoch: 10, Steps: 32 | Train Loss: 0.756 Vali Loss: 28.264 Vali Acc: 0.382 Test Loss: 28.264 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.959341764450073
Epoch: 11, Steps: 32 | Train Loss: 1.250 Vali Loss: 30.427 Vali Acc: 0.519 Test Loss: 30.427 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.144371032714844
Epoch: 12, Steps: 32 | Train Loss: 0.732 Vali Loss: 22.337 Vali Acc: 0.450 Test Loss: 22.337 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.100541591644287
Epoch: 13, Steps: 32 | Train Loss: 0.049 Vali Loss: 28.008 Vali Acc: 0.489 Test Loss: 28.008 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.169492244720459
Epoch: 14, Steps: 32 | Train Loss: 0.202 Vali Loss: 29.003 Vali Acc: 0.305 Test Loss: 29.003 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.208373069763184
Epoch: 15, Steps: 32 | Train Loss: 0.049 Vali Loss: 24.960 Vali Acc: 0.466 Test Loss: 24.960 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.268295526504517
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.223 Vali Acc: 0.466 Test Loss: 25.223 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.270216941833496
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.233 Vali Acc: 0.466 Test Loss: 25.233 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1973821
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.499817848205566
Epoch: 1, Steps: 32 | Train Loss: 5.653 Vali Loss: 5.605 Vali Acc: 0.107 Test Loss: 5.605 Test Acc: 0.107
Validation loss decreased (inf --> -0.106814).  Saving model ...
Epoch: 2 cost time: 6.986286640167236
Epoch: 2, Steps: 32 | Train Loss: 7.615 Vali Loss: 13.797 Vali Acc: 0.183 Test Loss: 13.797 Test Acc: 0.183
Validation loss decreased (-0.106814 --> -0.183068).  Saving model ...
Epoch: 3 cost time: 7.426717281341553
Epoch: 3, Steps: 32 | Train Loss: 12.830 Vali Loss: 7.711 Vali Acc: 0.183 Test Loss: 7.711 Test Acc: 0.183
Validation loss decreased (-0.183068 --> -0.183129).  Saving model ...
Epoch: 4 cost time: 7.189838409423828
Epoch: 4, Steps: 32 | Train Loss: 10.503 Vali Loss: 5.830 Vali Acc: 0.305 Test Loss: 5.830 Test Acc: 0.305
Validation loss decreased (-0.183129 --> -0.305285).  Saving model ...
Epoch: 5 cost time: 7.194965362548828
Epoch: 5, Steps: 32 | Train Loss: 6.551 Vali Loss: 9.509 Vali Acc: 0.252 Test Loss: 9.509 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.485573768615723
Epoch: 6, Steps: 32 | Train Loss: 4.884 Vali Loss: 14.453 Vali Acc: 0.435 Test Loss: 14.453 Test Acc: 0.435
Validation loss decreased (-0.305285 --> -0.434970).  Saving model ...
Epoch: 7 cost time: 7.294267654418945
Epoch: 7, Steps: 32 | Train Loss: 5.048 Vali Loss: 31.358 Vali Acc: 0.504 Test Loss: 31.358 Test Acc: 0.504
Validation loss decreased (-0.434970 --> -0.503503).  Saving model ...
Epoch: 8 cost time: 7.257956027984619
Epoch: 8, Steps: 32 | Train Loss: 1.330 Vali Loss: 25.375 Vali Acc: 0.534 Test Loss: 25.375 Test Acc: 0.534
Validation loss decreased (-0.503503 --> -0.534097).  Saving model ...
Epoch: 9 cost time: 7.374786138534546
Epoch: 9, Steps: 32 | Train Loss: 0.595 Vali Loss: 36.185 Vali Acc: 0.527 Test Loss: 36.185 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.05523681640625
Epoch: 10, Steps: 32 | Train Loss: 0.788 Vali Loss: 22.524 Vali Acc: 0.443 Test Loss: 22.524 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.284928560256958
Epoch: 11, Steps: 32 | Train Loss: 0.129 Vali Loss: 27.382 Vali Acc: 0.443 Test Loss: 27.382 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.4145965576171875
Epoch: 12, Steps: 32 | Train Loss: 0.193 Vali Loss: 25.928 Vali Acc: 0.489 Test Loss: 25.928 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.293092727661133
Epoch: 13, Steps: 32 | Train Loss: 0.125 Vali Loss: 28.092 Vali Acc: 0.489 Test Loss: 28.092 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.283097743988037
Epoch: 14, Steps: 32 | Train Loss: 0.334 Vali Loss: 32.977 Vali Acc: 0.382 Test Loss: 32.977 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.211180686950684
Epoch: 15, Steps: 32 | Train Loss: 0.235 Vali Loss: 26.815 Vali Acc: 0.496 Test Loss: 26.815 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.146178483963013
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.164 Vali Acc: 0.466 Test Loss: 24.164 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.194983959197998
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.110 Vali Acc: 0.458 Test Loss: 24.110 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.100285768508911
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.112 Vali Acc: 0.458 Test Loss: 24.112 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1925853
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.369551658630371
Epoch: 1, Steps: 32 | Train Loss: 6.317 Vali Loss: 7.267 Vali Acc: 0.420 Test Loss: 7.267 Test Acc: 0.420
Validation loss decreased (inf --> -0.419775).  Saving model ...
Epoch: 2 cost time: 7.146315097808838
Epoch: 2, Steps: 32 | Train Loss: 9.617 Vali Loss: 14.337 Vali Acc: 0.420 Test Loss: 14.337 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.024571657180786
Epoch: 3, Steps: 32 | Train Loss: 12.389 Vali Loss: 11.043 Vali Acc: 0.198 Test Loss: 11.043 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.960617780685425
Epoch: 4, Steps: 32 | Train Loss: 7.504 Vali Loss: 8.458 Vali Acc: 0.282 Test Loss: 8.458 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.9852776527404785
Epoch: 5, Steps: 32 | Train Loss: 7.196 Vali Loss: 26.869 Vali Acc: 0.137 Test Loss: 26.869 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.041423559188843
Epoch: 6, Steps: 32 | Train Loss: 4.507 Vali Loss: 22.829 Vali Acc: 0.435 Test Loss: 22.829 Test Acc: 0.435
Validation loss decreased (-0.419775 --> -0.434886).  Saving model ...
Epoch: 7 cost time: 6.80834436416626
Epoch: 7, Steps: 32 | Train Loss: 5.456 Vali Loss: 16.848 Vali Acc: 0.374 Test Loss: 16.848 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.077759742736816
Epoch: 8, Steps: 32 | Train Loss: 1.162 Vali Loss: 17.926 Vali Acc: 0.466 Test Loss: 17.926 Test Acc: 0.466
Validation loss decreased (-0.434886 --> -0.465470).  Saving model ...
Epoch: 9 cost time: 7.014856338500977
Epoch: 9, Steps: 32 | Train Loss: 0.204 Vali Loss: 26.594 Vali Acc: 0.534 Test Loss: 26.594 Test Acc: 0.534
Validation loss decreased (-0.465470 --> -0.534085).  Saving model ...
Epoch: 10 cost time: 6.9165120124816895
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 22.227 Vali Acc: 0.489 Test Loss: 22.227 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.043493270874023
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.135 Vali Acc: 0.504 Test Loss: 23.135 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.976361274719238
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.334 Vali Acc: 0.511 Test Loss: 23.334 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.181185722351074
Epoch: 13, Steps: 32 | Train Loss: 0.093 Vali Loss: 28.971 Vali Acc: 0.489 Test Loss: 28.971 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.95827841758728
Epoch: 14, Steps: 32 | Train Loss: 0.406 Vali Loss: 29.903 Vali Acc: 0.504 Test Loss: 29.903 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.918869733810425
Epoch: 15, Steps: 32 | Train Loss: 1.741 Vali Loss: 31.678 Vali Acc: 0.489 Test Loss: 31.678 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.939576625823975
Epoch: 16, Steps: 32 | Train Loss: 0.249 Vali Loss: 36.461 Vali Acc: 0.374 Test Loss: 36.461 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.960413694381714
Epoch: 17, Steps: 32 | Train Loss: 3.086 Vali Loss: 41.400 Vali Acc: 0.489 Test Loss: 41.400 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.038439035415649
Epoch: 18, Steps: 32 | Train Loss: 0.530 Vali Loss: 36.535 Vali Acc: 0.458 Test Loss: 36.535 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.0223469734191895
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.916 Vali Acc: 0.405 Test Loss: 38.916 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1877885
model size : 9.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.55685544013977
Epoch: 1, Steps: 32 | Train Loss: 6.584 Vali Loss: 6.959 Vali Acc: 0.092 Test Loss: 6.959 Test Acc: 0.092
Validation loss decreased (inf --> -0.091533).  Saving model ...
Epoch: 2 cost time: 7.2389116287231445
Epoch: 2, Steps: 32 | Train Loss: 10.628 Vali Loss: 19.782 Vali Acc: 0.168 Test Loss: 19.782 Test Acc: 0.168
Validation loss decreased (-0.091533 --> -0.167741).  Saving model ...
Epoch: 3 cost time: 7.18783712387085
Epoch: 3, Steps: 32 | Train Loss: 10.214 Vali Loss: 2.140 Vali Acc: 0.305 Test Loss: 2.140 Test Acc: 0.305
Validation loss decreased (-0.167741 --> -0.305322).  Saving model ...
Epoch: 4 cost time: 7.2785422801971436
Epoch: 4, Steps: 32 | Train Loss: 4.296 Vali Loss: 9.783 Vali Acc: 0.198 Test Loss: 9.783 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.336970329284668
Epoch: 5, Steps: 32 | Train Loss: 8.158 Vali Loss: 16.665 Vali Acc: 0.420 Test Loss: 16.665 Test Acc: 0.420
Validation loss decreased (-0.305322 --> -0.419681).  Saving model ...
Epoch: 6 cost time: 7.165348768234253
Epoch: 6, Steps: 32 | Train Loss: 3.503 Vali Loss: 18.987 Vali Acc: 0.267 Test Loss: 18.987 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.176093339920044
Epoch: 7, Steps: 32 | Train Loss: 3.018 Vali Loss: 17.526 Vali Acc: 0.313 Test Loss: 17.526 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.180877923965454
Epoch: 8, Steps: 32 | Train Loss: 1.431 Vali Loss: 16.602 Vali Acc: 0.420 Test Loss: 16.602 Test Acc: 0.420
Validation loss decreased (-0.419681 --> -0.419681).  Saving model ...
Epoch: 9 cost time: 7.272357225418091
Epoch: 9, Steps: 32 | Train Loss: 0.956 Vali Loss: 22.503 Vali Acc: 0.511 Test Loss: 22.503 Test Acc: 0.511
Validation loss decreased (-0.419681 --> -0.511225).  Saving model ...
Epoch: 10 cost time: 7.302350759506226
Epoch: 10, Steps: 32 | Train Loss: 0.980 Vali Loss: 29.358 Vali Acc: 0.496 Test Loss: 29.358 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.440819978713989
Epoch: 11, Steps: 32 | Train Loss: 0.829 Vali Loss: 26.924 Vali Acc: 0.405 Test Loss: 26.924 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.1518495082855225
Epoch: 12, Steps: 32 | Train Loss: 0.972 Vali Loss: 27.129 Vali Acc: 0.435 Test Loss: 27.129 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.263645648956299
Epoch: 13, Steps: 32 | Train Loss: 0.052 Vali Loss: 36.225 Vali Acc: 0.504 Test Loss: 36.225 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.233978986740112
Epoch: 14, Steps: 32 | Train Loss: 0.112 Vali Loss: 28.197 Vali Acc: 0.412 Test Loss: 28.197 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.295485496520996
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.946 Vali Acc: 0.374 Test Loss: 28.946 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.264514207839966
Epoch: 16, Steps: 32 | Train Loss: 0.016 Vali Loss: 23.524 Vali Acc: 0.389 Test Loss: 23.524 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.226901531219482
Epoch: 17, Steps: 32 | Train Loss: 0.613 Vali Loss: 26.211 Vali Acc: 0.443 Test Loss: 26.211 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.297368049621582
Epoch: 18, Steps: 32 | Train Loss: 0.990 Vali Loss: 26.305 Vali Acc: 0.389 Test Loss: 26.305 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.369672060012817
Epoch: 19, Steps: 32 | Train Loss: 0.166 Vali Loss: 33.864 Vali Acc: 0.527 Test Loss: 33.864 Test Acc: 0.527
Validation loss decreased (-0.511225 --> -0.526379).  Saving model ...
Epoch: 20 cost time: 7.184076309204102
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.669 Vali Acc: 0.489 Test Loss: 29.669 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.3071770668029785
Epoch: 21, Steps: 32 | Train Loss: 0.381 Vali Loss: 32.548 Vali Acc: 0.511 Test Loss: 32.548 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.19588565826416
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.112 Vali Acc: 0.481 Test Loss: 31.112 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.144037485122681
Epoch: 23, Steps: 32 | Train Loss: 0.047 Vali Loss: 40.816 Vali Acc: 0.534 Test Loss: 40.816 Test Acc: 0.534
Validation loss decreased (-0.526379 --> -0.533943).  Saving model ...
Epoch: 24 cost time: 7.60113525390625
Epoch: 24, Steps: 32 | Train Loss: 0.674 Vali Loss: 29.355 Vali Acc: 0.458 Test Loss: 29.355 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.62131142616272
Epoch: 25, Steps: 32 | Train Loss: 0.349 Vali Loss: 31.993 Vali Acc: 0.443 Test Loss: 31.993 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.944552659988403
Epoch: 26, Steps: 32 | Train Loss: 0.776 Vali Loss: 38.887 Vali Acc: 0.427 Test Loss: 38.887 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.729534864425659
Epoch: 27, Steps: 32 | Train Loss: 2.549 Vali Loss: 48.938 Vali Acc: 0.511 Test Loss: 48.938 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.432421445846558
Epoch: 28, Steps: 32 | Train Loss: 1.378 Vali Loss: 52.734 Vali Acc: 0.527 Test Loss: 52.734 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.480514764785767
Epoch: 29, Steps: 32 | Train Loss: 1.927 Vali Loss: 56.562 Vali Acc: 0.458 Test Loss: 56.562 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.5577919483184814
Epoch: 30, Steps: 32 | Train Loss: 0.168 Vali Loss: 48.201 Vali Acc: 0.489 Test Loss: 48.201 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.546138525009155
Epoch: 31, Steps: 32 | Train Loss: 0.079 Vali Loss: 46.986 Vali Acc: 0.504 Test Loss: 46.986 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.45173192024231
Epoch: 32, Steps: 32 | Train Loss: 0.084 Vali Loss: 52.554 Vali Acc: 0.450 Test Loss: 52.554 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.711750745773315
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.814 Vali Acc: 0.466 Test Loss: 53.814 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1996829
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.332579374313354
Epoch: 1, Steps: 32 | Train Loss: 6.536 Vali Loss: 14.025 Vali Acc: 0.168 Test Loss: 14.025 Test Acc: 0.168
Validation loss decreased (inf --> -0.167799).  Saving model ...
Epoch: 2 cost time: 7.287111282348633
Epoch: 2, Steps: 32 | Train Loss: 6.960 Vali Loss: 8.527 Vali Acc: 0.160 Test Loss: 8.527 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.485807180404663
Epoch: 3, Steps: 32 | Train Loss: 10.927 Vali Loss: 14.858 Vali Acc: 0.160 Test Loss: 14.858 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.962408542633057
Epoch: 4, Steps: 32 | Train Loss: 6.698 Vali Loss: 5.472 Vali Acc: 0.405 Test Loss: 5.472 Test Acc: 0.405
Validation loss decreased (-0.167799 --> -0.404525).  Saving model ...
Epoch: 5 cost time: 7.674987554550171
Epoch: 5, Steps: 32 | Train Loss: 4.922 Vali Loss: 11.592 Vali Acc: 0.282 Test Loss: 11.592 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.424393892288208
Epoch: 6, Steps: 32 | Train Loss: 4.648 Vali Loss: 18.176 Vali Acc: 0.489 Test Loss: 18.176 Test Acc: 0.489
Validation loss decreased (-0.404525 --> -0.488368).  Saving model ...
Epoch: 7 cost time: 7.7082977294921875
Epoch: 7, Steps: 32 | Train Loss: 2.879 Vali Loss: 23.824 Vali Acc: 0.275 Test Loss: 23.824 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.276763200759888
Epoch: 8, Steps: 32 | Train Loss: 1.941 Vali Loss: 21.684 Vali Acc: 0.351 Test Loss: 21.684 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.379728555679321
Epoch: 9, Steps: 32 | Train Loss: 1.049 Vali Loss: 24.284 Vali Acc: 0.443 Test Loss: 24.284 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.777214050292969
Epoch: 10, Steps: 32 | Train Loss: 1.213 Vali Loss: 21.670 Vali Acc: 0.481 Test Loss: 21.670 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.625827074050903
Epoch: 11, Steps: 32 | Train Loss: 0.309 Vali Loss: 21.094 Vali Acc: 0.489 Test Loss: 21.094 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.474593877792358
Epoch: 12, Steps: 32 | Train Loss: 0.551 Vali Loss: 27.840 Vali Acc: 0.496 Test Loss: 27.840 Test Acc: 0.496
Validation loss decreased (-0.488368 --> -0.495905).  Saving model ...
Epoch: 13 cost time: 7.429331541061401
Epoch: 13, Steps: 32 | Train Loss: 0.856 Vali Loss: 34.621 Vali Acc: 0.511 Test Loss: 34.621 Test Acc: 0.511
Validation loss decreased (-0.495905 --> -0.511104).  Saving model ...
Epoch: 14 cost time: 7.335949420928955
Epoch: 14, Steps: 32 | Train Loss: 0.005 Vali Loss: 34.075 Vali Acc: 0.344 Test Loss: 34.075 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.2477545738220215
Epoch: 15, Steps: 32 | Train Loss: 0.048 Vali Loss: 31.224 Vali Acc: 0.420 Test Loss: 31.224 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.01715087890625
Epoch: 16, Steps: 32 | Train Loss: 0.013 Vali Loss: 37.219 Vali Acc: 0.519 Test Loss: 37.219 Test Acc: 0.519
Validation loss decreased (-0.511104 --> -0.518712).  Saving model ...
Epoch: 17 cost time: 7.370951890945435
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.733 Vali Acc: 0.458 Test Loss: 31.733 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.910489797592163
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.691 Vali Acc: 0.443 Test Loss: 31.691 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.792465686798096
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.667945146560669
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.8425843715667725
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.964283466339111
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.597703218460083
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.771563529968262
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.562655448913574
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.886373996734619
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 31.692 Vali Acc: 0.443 Test Loss: 31.692 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1948861
model size : 9.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.83637809753418
Epoch: 1, Steps: 32 | Train Loss: 3.649 Vali Loss: 9.154 Vali Acc: 0.176 Test Loss: 9.154 Test Acc: 0.176
Validation loss decreased (inf --> -0.175481).  Saving model ...
Epoch: 2 cost time: 7.912258863449097
Epoch: 2, Steps: 32 | Train Loss: 12.156 Vali Loss: 19.113 Vali Acc: 0.137 Test Loss: 19.113 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.183943033218384
Epoch: 3, Steps: 32 | Train Loss: 12.316 Vali Loss: 7.728 Vali Acc: 0.099 Test Loss: 7.728 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.665584325790405
Epoch: 4, Steps: 32 | Train Loss: 10.365 Vali Loss: 14.778 Vali Acc: 0.435 Test Loss: 14.778 Test Acc: 0.435
Validation loss decreased (-0.175481 --> -0.434967).  Saving model ...
Epoch: 5 cost time: 7.970834493637085
Epoch: 5, Steps: 32 | Train Loss: 5.592 Vali Loss: 18.928 Vali Acc: 0.466 Test Loss: 18.928 Test Acc: 0.466
Validation loss decreased (-0.434967 --> -0.465460).  Saving model ...
Epoch: 6 cost time: 7.713125944137573
Epoch: 6, Steps: 32 | Train Loss: 5.780 Vali Loss: 15.966 Vali Acc: 0.496 Test Loss: 15.966 Test Acc: 0.496
Validation loss decreased (-0.465460 --> -0.496024).  Saving model ...
Epoch: 7 cost time: 7.523009300231934
Epoch: 7, Steps: 32 | Train Loss: 2.346 Vali Loss: 22.905 Vali Acc: 0.344 Test Loss: 22.905 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.803876876831055
Epoch: 8, Steps: 32 | Train Loss: 1.890 Vali Loss: 23.340 Vali Acc: 0.427 Test Loss: 23.340 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.847204923629761
Epoch: 9, Steps: 32 | Train Loss: 0.085 Vali Loss: 35.678 Vali Acc: 0.511 Test Loss: 35.678 Test Acc: 0.511
Validation loss decreased (-0.496024 --> -0.511094).  Saving model ...
Epoch: 10 cost time: 7.867936372756958
Epoch: 10, Steps: 32 | Train Loss: 0.200 Vali Loss: 21.264 Vali Acc: 0.450 Test Loss: 21.264 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.520590543746948
Epoch: 11, Steps: 32 | Train Loss: 0.687 Vali Loss: 27.533 Vali Acc: 0.397 Test Loss: 27.533 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.945970058441162
Epoch: 12, Steps: 32 | Train Loss: 1.667 Vali Loss: 28.598 Vali Acc: 0.443 Test Loss: 28.598 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.499079465866089
Epoch: 13, Steps: 32 | Train Loss: 0.731 Vali Loss: 37.672 Vali Acc: 0.305 Test Loss: 37.672 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.67389988899231
Epoch: 14, Steps: 32 | Train Loss: 1.764 Vali Loss: 26.333 Vali Acc: 0.412 Test Loss: 26.333 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.450085639953613
Epoch: 15, Steps: 32 | Train Loss: 0.149 Vali Loss: 32.190 Vali Acc: 0.458 Test Loss: 32.190 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.228138208389282
Epoch: 16, Steps: 32 | Train Loss: 0.010 Vali Loss: 31.027 Vali Acc: 0.466 Test Loss: 31.027 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.41658616065979
Epoch: 17, Steps: 32 | Train Loss: 0.113 Vali Loss: 30.314 Vali Acc: 0.443 Test Loss: 30.314 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.579296350479126
Epoch: 18, Steps: 32 | Train Loss: 0.132 Vali Loss: 32.306 Vali Acc: 0.450 Test Loss: 32.306 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.657145023345947
Epoch: 19, Steps: 32 | Train Loss: 0.171 Vali Loss: 37.266 Vali Acc: 0.473 Test Loss: 37.266 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 1900893
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.114082336425781
Epoch: 1, Steps: 32 | Train Loss: 5.243 Vali Loss: 12.043 Vali Acc: 0.176 Test Loss: 12.043 Test Acc: 0.176
Validation loss decreased (inf --> -0.175452).  Saving model ...
Epoch: 2 cost time: 7.219326734542847
Epoch: 2, Steps: 32 | Train Loss: 9.194 Vali Loss: 9.336 Vali Acc: 0.099 Test Loss: 9.336 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.494534254074097
Epoch: 3, Steps: 32 | Train Loss: 11.203 Vali Loss: 10.650 Vali Acc: 0.191 Test Loss: 10.650 Test Acc: 0.191
Validation loss decreased (-0.175452 --> -0.190733).  Saving model ...
Epoch: 4 cost time: 7.119243860244751
Epoch: 4, Steps: 32 | Train Loss: 7.541 Vali Loss: 8.107 Vali Acc: 0.527 Test Loss: 8.107 Test Acc: 0.527
Validation loss decreased (-0.190733 --> -0.526636).  Saving model ...
Epoch: 5 cost time: 7.310704469680786
Epoch: 5, Steps: 32 | Train Loss: 3.453 Vali Loss: 15.172 Vali Acc: 0.260 Test Loss: 15.172 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.42905068397522
Epoch: 6, Steps: 32 | Train Loss: 4.095 Vali Loss: 22.691 Vali Acc: 0.481 Test Loss: 22.691 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.423507213592529
Epoch: 7, Steps: 32 | Train Loss: 3.810 Vali Loss: 13.813 Vali Acc: 0.542 Test Loss: 13.813 Test Acc: 0.542
Validation loss decreased (-0.526636 --> -0.541847).  Saving model ...
Epoch: 8 cost time: 7.525115966796875
Epoch: 8, Steps: 32 | Train Loss: 2.400 Vali Loss: 23.829 Vali Acc: 0.481 Test Loss: 23.829 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.370882749557495
Epoch: 9, Steps: 32 | Train Loss: 1.189 Vali Loss: 23.709 Vali Acc: 0.542 Test Loss: 23.709 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.245270490646362
Epoch: 10, Steps: 32 | Train Loss: 0.357 Vali Loss: 21.236 Vali Acc: 0.290 Test Loss: 21.236 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.378611087799072
Epoch: 11, Steps: 32 | Train Loss: 1.108 Vali Loss: 23.896 Vali Acc: 0.481 Test Loss: 23.896 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.262470006942749
Epoch: 12, Steps: 32 | Train Loss: 1.469 Vali Loss: 35.354 Vali Acc: 0.489 Test Loss: 35.354 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.026336908340454
Epoch: 13, Steps: 32 | Train Loss: 1.375 Vali Loss: 37.590 Vali Acc: 0.481 Test Loss: 37.590 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.002472639083862
Epoch: 14, Steps: 32 | Train Loss: 1.499 Vali Loss: 39.324 Vali Acc: 0.389 Test Loss: 39.324 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.110925912857056
Epoch: 15, Steps: 32 | Train Loss: 0.182 Vali Loss: 36.902 Vali Acc: 0.359 Test Loss: 36.902 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.137704372406006
Epoch: 16, Steps: 32 | Train Loss: 0.106 Vali Loss: 41.169 Vali Acc: 0.504 Test Loss: 41.169 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.212369918823242
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.776 Vali Acc: 0.504 Test Loss: 40.776 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_Crossformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1852925
model size : 9.33MB
