Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8097705841064453
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.432 Vali Acc: 0.153 Test Loss: 2.432 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.9532184600830078
Epoch: 2, Steps: 7 | Train Loss: 2.418 Vali Loss: 1.896 Vali Acc: 0.514 Test Loss: 1.896 Test Acc: 0.514
Validation loss decreased (-0.152753 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 0.9926693439483643
Epoch: 3, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.513870 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 1.0549213886260986
Epoch: 4, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.619 Vali Acc: 0.792 Test Loss: 0.619 Test Acc: 0.792
Validation loss decreased (-0.666653 --> -0.791660).  Saving model ...
Epoch: 5 cost time: 1.071047067642212
Epoch: 5, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.791660 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 1.1315193176269531
Epoch: 6, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9897017478942871
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2139487266540527
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9277529716491699
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0234017372131348
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.926983118057251
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 1.0466620922088623
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.9489667415618896
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0504443645477295
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0271267890930176
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9130175113677979
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0178349018096924
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0693080425262451
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1223082542419434
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1532988548278809
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0448615550994873
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1179513931274414
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 14837064
model size : 61.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5759618282318115
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.396 Vali Acc: 0.181 Test Loss: 2.396 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.0630593299865723
Epoch: 2, Steps: 7 | Train Loss: 2.445 Vali Loss: 1.856 Vali Acc: 0.556 Test Loss: 1.856 Test Acc: 0.556
Validation loss decreased (-0.180532 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.304262638092041
Epoch: 3, Steps: 7 | Train Loss: 1.626 Vali Loss: 1.136 Vali Acc: 0.764 Test Loss: 1.136 Test Acc: 0.764
Validation loss decreased (-0.555537 --> -0.763878).  Saving model ...
Epoch: 4 cost time: 0.9501645565032959
Epoch: 4, Steps: 7 | Train Loss: 0.647 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.763878 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 0.9965505599975586
Epoch: 5, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0011885166168213
Epoch: 6, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9813416004180908
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.0485866069793701
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0172395706176758
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0054609775543213
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.9510533809661865
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9980971813201904
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.001053810119629
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0452263355255127
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0671112537384033
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0118398666381836
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.0737330913543701
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.2110273838043213
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9533720016479492
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.115610122680664
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.0891213417053223
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1654491424560547
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1068763732910156
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9423680305480957
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9752557277679443
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0894038677215576
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9570679664611816
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1021273136138916
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.999819278717041
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0582020282745361
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 14788936
model size : 61.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.487013101577759
Epoch: 1, Steps: 7 | Train Loss: 2.673 Vali Loss: 2.476 Vali Acc: 0.139 Test Loss: 2.476 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.0746278762817383
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
Validation loss decreased (-0.138864 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 1.399298906326294
Epoch: 3, Steps: 7 | Train Loss: 1.693 Vali Loss: 1.247 Vali Acc: 0.736 Test Loss: 1.247 Test Acc: 0.736
Validation loss decreased (-0.499979 --> -0.736099).  Saving model ...
Epoch: 4 cost time: 1.3737211227416992
Epoch: 4, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
Validation loss decreased (-0.736099 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.6027107238769531
Epoch: 5, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.749993 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.3961536884307861
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6572544574737549
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6898114681243896
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.488266944885254
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.46315598487854
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0093574523925781
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.4222180843353271
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2128584384918213
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.640087604522705
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2777862548828125
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.382505178451538
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.445523977279663
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1270956993103027
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3538334369659424
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.438953161239624
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0615923404693604
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4148616790771484
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 14740808
model size : 61.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2129971981048584
Epoch: 1, Steps: 7 | Train Loss: 2.679 Vali Loss: 2.456 Vali Acc: 0.139 Test Loss: 2.456 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.6361441612243652
Epoch: 2, Steps: 7 | Train Loss: 2.358 Vali Loss: 1.964 Vali Acc: 0.431 Test Loss: 1.964 Test Acc: 0.431
Validation loss decreased (-0.138864 --> -0.430536).  Saving model ...
Epoch: 3 cost time: 1.355179786682129
Epoch: 3, Steps: 7 | Train Loss: 1.791 Vali Loss: 1.235 Vali Acc: 0.722 Test Loss: 1.235 Test Acc: 0.722
Validation loss decreased (-0.430536 --> -0.722210).  Saving model ...
Epoch: 4 cost time: 1.5381896495819092
Epoch: 4, Steps: 7 | Train Loss: 0.781 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.722210 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.0787489414215088
Epoch: 5, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4561283588409424
Epoch: 6, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 1.5996057987213135
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4302785396575928
Epoch: 8, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.464859962463379
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5089006423950195
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.784010887145996
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.339857816696167
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2683908939361572
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3611760139465332
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5764045715332031
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5714044570922852
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5081026554107666
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5922491550445557
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3983471393585205
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.8495850563049316
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.421330213546753
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.4748249053955078
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.1446177959442139
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.2017970085144043
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.1558146476745605
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2824807167053223
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6035997867584229
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6883494853973389
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.6455974578857422
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.230886936187744
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 2.105381488800049
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0006790161132812
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5654172897338867
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9696736335754395
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.214214563369751
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.9410293102264404
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.37715220451355
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.1776607036590576
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 2.217217206954956
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.74444580078125
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.344895601272583
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4230031967163086
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 2.2409276962280273
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 2.3829047679901123
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.4047186374664307
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8370850086212158
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.0506153106689453
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.5550968647003174
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.5157899856567383
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.745044231414795
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.349722385406494
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.5052356719970703
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.0196824073791504
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.480177164077759
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 14692680
model size : 61.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.618154048919678
Epoch: 1, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.364 Vali Acc: 0.139 Test Loss: 2.364 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 3.5918056964874268
Epoch: 2, Steps: 7 | Train Loss: 2.323 Vali Loss: 1.828 Vali Acc: 0.653 Test Loss: 1.828 Test Acc: 0.653
Validation loss decreased (-0.138865 --> -0.652759).  Saving model ...
Epoch: 3 cost time: 4.1908159255981445
Epoch: 3, Steps: 7 | Train Loss: 1.471 Vali Loss: 1.040 Vali Acc: 0.792 Test Loss: 1.040 Test Acc: 0.792
Validation loss decreased (-0.652759 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 3.5136494636535645
Epoch: 4, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 3.32559871673584
Epoch: 5, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 3.8144338130950928
Epoch: 6, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.323 Vali Acc: 0.847 Test Loss: 0.323 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9089794158935547
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 2.4864017963409424
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888887).  Saving model ...
Epoch: 9 cost time: 3.1914849281311035
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.888887 --> -0.916665).  Saving model ...
Epoch: 10 cost time: 4.3980491161346436
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 4.182683944702148
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 3.892540216445923
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 4.132267236709595
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.622421979904175
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.411985158920288
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.150771617889404
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.38953971862793
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8622443675994873
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5888118743896484
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4692749977111816
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.947780132293701
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3375744819641113
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 12473160
model size : 52.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.050001621246338
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.374 Vali Acc: 0.083 Test Loss: 2.374 Test Acc: 0.083
Validation loss decreased (inf --> -0.083310).  Saving model ...
Epoch: 2 cost time: 3.39460825920105
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 1.873 Vali Acc: 0.597 Test Loss: 1.873 Test Acc: 0.597
Validation loss decreased (-0.083310 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 3.283874273300171
Epoch: 3, Steps: 7 | Train Loss: 1.575 Vali Loss: 1.154 Vali Acc: 0.736 Test Loss: 1.154 Test Acc: 0.736
Validation loss decreased (-0.597203 --> -0.736100).  Saving model ...
Epoch: 4 cost time: 3.2308552265167236
Epoch: 4, Steps: 7 | Train Loss: 0.704 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
Validation loss decreased (-0.736100 --> -0.805550).  Saving model ...
Epoch: 5 cost time: 2.9512999057769775
Epoch: 5, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.423 Vali Acc: 0.847 Test Loss: 0.423 Test Acc: 0.847
Validation loss decreased (-0.805550 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 2.9570670127868652
Epoch: 6, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.414 Vali Acc: 0.847 Test Loss: 0.414 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 3.9746718406677246
Epoch: 7, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 3.001811981201172
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 3.21364164352417
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 3.754530429840088
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.665071725845337
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.4193058013916016
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.889354705810547
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.8735663890838623
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.371159076690674
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.902121067047119
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.749948501586914
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3765275478363037
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2941830158233643
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7266831398010254
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9510722160339355
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.82291316986084
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.890676259994507
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 12425032
model size : 52.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.130396604537964
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.374 Vali Acc: 0.236 Test Loss: 2.374 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 3.6432487964630127
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 1.879 Vali Acc: 0.625 Test Loss: 1.879 Test Acc: 0.625
Validation loss decreased (-0.236087 --> -0.624981).  Saving model ...
Epoch: 3 cost time: 3.801971197128296
Epoch: 3, Steps: 7 | Train Loss: 1.640 Vali Loss: 1.161 Vali Acc: 0.792 Test Loss: 1.161 Test Acc: 0.792
Validation loss decreased (-0.624981 --> -0.791655).  Saving model ...
Epoch: 4 cost time: 3.85809588432312
Epoch: 4, Steps: 7 | Train Loss: 0.734 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 3.573845863342285
Epoch: 5, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.819438 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 2.16392183303833
Epoch: 6, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6123104095458984
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8130080699920654
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 3.512388229370117
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 2.6663053035736084
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 2.8820598125457764
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3885395526885986
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.378584384918213
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8550195693969727
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.419708490371704
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9860095977783203
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2407658100128174
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0104973316192627
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.3737425804138184
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.611302614212036
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 12376904
model size : 52.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.6723363399505615
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.323 Vali Acc: 0.250 Test Loss: 2.323 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 2.366955280303955
Epoch: 2, Steps: 7 | Train Loss: 2.323 Vali Loss: 1.730 Vali Acc: 0.667 Test Loss: 1.730 Test Acc: 0.667
Validation loss decreased (-0.249977 --> -0.666649).  Saving model ...
Epoch: 3 cost time: 2.3884103298187256
Epoch: 3, Steps: 7 | Train Loss: 1.433 Vali Loss: 1.004 Vali Acc: 0.778 Test Loss: 1.004 Test Acc: 0.778
Validation loss decreased (-0.666649 --> -0.777768).  Saving model ...
Epoch: 4 cost time: 2.342057704925537
Epoch: 4, Steps: 7 | Train Loss: 0.581 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.777768 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 2.779376983642578
Epoch: 5, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.847217 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 3.0252132415771484
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.205535888671875
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5577399730682373
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.813016414642334
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1776862144470215
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.923097610473633
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.012829303741455
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 3.408689260482788
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.7908859252929688
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 3.3077733516693115
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 3.435706377029419
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9655330181121826
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4817516803741455
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2561275959014893
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.369124412536621
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1813931465148926
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4886467456817627
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4628350734710693
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.214635133743286
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.262281656265259
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 12328776
model size : 52.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.860576391220093
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.445 Vali Acc: 0.278 Test Loss: 2.445 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 3.509115695953369
Epoch: 2, Steps: 7 | Train Loss: 2.353 Vali Loss: 1.895 Vali Acc: 0.569 Test Loss: 1.895 Test Acc: 0.569
Validation loss decreased (-0.277753 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 3.5027709007263184
Epoch: 3, Steps: 7 | Train Loss: 1.621 Vali Loss: 1.204 Vali Acc: 0.708 Test Loss: 1.204 Test Acc: 0.708
Validation loss decreased (-0.569425 --> -0.708321).  Saving model ...
Epoch: 4 cost time: 2.642284870147705
Epoch: 4, Steps: 7 | Train Loss: 0.831 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
Validation loss decreased (-0.708321 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 3.7719480991363525
Epoch: 5, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 3.1134777069091797
Epoch: 6, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.850084066390991
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 4.103931665420532
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 3.212104558944702
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 3.430246353149414
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 3.7103431224823
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7643754482269287
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4838333129882812
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.033933162689209
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7196481227874756
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7693703174591064
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 3.9978318214416504
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.549690008163452
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 3.3136205673217773
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.9605016708374023
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.648301839828491
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 3.450453758239746
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.881232261657715
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.478022813796997
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.212395429611206
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2323997020721436
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.999194860458374
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.167638063430786
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 4.037391185760498
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.143224000930786
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 3.9036974906921387
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3919785022735596
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 3.3687963485717773
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 3.7682621479034424
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 3.266366481781006
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.057800054550171
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5230841636657715
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.5590572357177734
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.6060051918029785
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.826556921005249
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.1775364875793457
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.806044340133667
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0449163913726807
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.046715259552002
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 11291208
model size : 48.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.528512477874756
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.422 Vali Acc: 0.028 Test Loss: 2.422 Test Acc: 0.028
Validation loss decreased (inf --> -0.027754).  Saving model ...
Epoch: 2 cost time: 3.118445634841919
Epoch: 2, Steps: 7 | Train Loss: 2.447 Vali Loss: 1.988 Vali Acc: 0.569 Test Loss: 1.988 Test Acc: 0.569
Validation loss decreased (-0.027754 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 3.3837621212005615
Epoch: 3, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.275 Vali Acc: 0.708 Test Loss: 1.275 Test Acc: 0.708
Validation loss decreased (-0.569425 --> -0.708321).  Saving model ...
Epoch: 4 cost time: 3.4148576259613037
Epoch: 4, Steps: 7 | Train Loss: 0.764 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
Validation loss decreased (-0.708321 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 3.3030600547790527
Epoch: 5, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.413 Vali Acc: 0.847 Test Loss: 0.413 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.269204616546631
Epoch: 6, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.861105 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 3.179095506668091
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 8 cost time: 2.7494699954986572
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.357 Vali Acc: 0.847 Test Loss: 0.357 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.611259698867798
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.250204086303711
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9125187397003174
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.790140390396118
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5646286010742188
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8937482833862305
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6889488697052
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1096837520599365
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.569091558456421
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 11243080
model size : 47.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.846337080001831
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.444 Vali Acc: 0.111 Test Loss: 2.444 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 2.612643241882324
Epoch: 2, Steps: 7 | Train Loss: 2.509 Vali Loss: 1.998 Vali Acc: 0.444 Test Loss: 1.998 Test Acc: 0.444
Validation loss decreased (-0.111087 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 3.0021474361419678
Epoch: 3, Steps: 7 | Train Loss: 1.749 Vali Loss: 1.255 Vali Acc: 0.694 Test Loss: 1.255 Test Acc: 0.694
Validation loss decreased (-0.444424 --> -0.694432).  Saving model ...
Epoch: 4 cost time: 2.95717191696167
Epoch: 4, Steps: 7 | Train Loss: 0.880 Vali Loss: 0.685 Vali Acc: 0.819 Test Loss: 0.685 Test Acc: 0.819
Validation loss decreased (-0.694432 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 3.140472173690796
Epoch: 5, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.819438 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 2.7504055500030518
Epoch: 6, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.789827823638916
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.096755027770996
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.6184780597686768
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7088022232055664
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.147531747817993
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.453580379486084
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7547876834869385
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.826111316680908
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2844810485839844
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0903608798980713
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.136040210723877
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.617051124572754
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 11194952
model size : 47.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.261339902877808
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.327 Vali Acc: 0.306 Test Loss: 2.327 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 2.913839817047119
Epoch: 2, Steps: 7 | Train Loss: 2.407 Vali Loss: 1.825 Vali Acc: 0.500 Test Loss: 1.825 Test Acc: 0.500
Validation loss decreased (-0.305532 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 2.934171438217163
Epoch: 3, Steps: 7 | Train Loss: 1.640 Vali Loss: 1.215 Vali Acc: 0.653 Test Loss: 1.215 Test Acc: 0.653
Validation loss decreased (-0.499982 --> -0.652766).  Saving model ...
Epoch: 4 cost time: 2.4890222549438477
Epoch: 4, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
Validation loss decreased (-0.652766 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 2.7788264751434326
Epoch: 5, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.578 Vali Acc: 0.778 Test Loss: 0.578 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9410057067871094
Epoch: 6, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.819438 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 3.1692306995391846
Epoch: 7, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.563474655151367
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3346948623657227
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 3.1122148036956787
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7931997776031494
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8356847763061523
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3083715438842773
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3886868953704834
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.081122875213623
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5529308319091797
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.964972496032715
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 3.2728357315063477
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 3.3320844173431396
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.9431090354919434
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 3.115483522415161
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 3.3088912963867188
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 3.6930620670318604
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6523923873901367
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8118810653686523
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.512404441833496
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.46722149848938
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9765799045562744
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3555047512054443
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2088632583618164
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 2.4937853813171387
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1932926177978516
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.4534807205200195
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.7042932510375977
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.7873470783233643
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.3037846088409424
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.443784236907959
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.1670005321502686
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.3773624897003174
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5210940837860107
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 11146824
model size : 47.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.912001609802246
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.397 Vali Acc: 0.278 Test Loss: 2.397 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 3.2376925945281982
Epoch: 2, Steps: 7 | Train Loss: 2.310 Vali Loss: 1.949 Vali Acc: 0.444 Test Loss: 1.949 Test Acc: 0.444
Validation loss decreased (-0.277754 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 2.172086477279663
Epoch: 3, Steps: 7 | Train Loss: 1.664 Vali Loss: 1.202 Vali Acc: 0.736 Test Loss: 1.202 Test Acc: 0.736
Validation loss decreased (-0.444425 --> -0.736099).  Saving model ...
Epoch: 4 cost time: 3.4266507625579834
Epoch: 4, Steps: 7 | Train Loss: 0.741 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.736099 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 3.3180158138275146
Epoch: 5, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 3.255255937576294
Epoch: 6, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 3.4890244007110596
Epoch: 7, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.847 Test Loss: 0.378 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.664196491241455
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 3.484668493270874
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6392931938171387
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0302274227142334
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.607851982116699
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.226219892501831
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1613683700561523
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 3.0556230545043945
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 3.3920066356658936
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.7030584812164307
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.457418203353882
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1680002212524414
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9048573970794678
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.3688998222351074
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.218630075454712
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.082087755203247
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3414289951324463
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3822968006134033
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.5798535346984863
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 10700232
model size : 45.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.945278644561768
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.344 Vali Acc: 0.222 Test Loss: 2.344 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 3.616025686264038
Epoch: 2, Steps: 7 | Train Loss: 2.305 Vali Loss: 1.885 Vali Acc: 0.625 Test Loss: 1.885 Test Acc: 0.625
Validation loss decreased (-0.222199 --> -0.624981).  Saving model ...
Epoch: 3 cost time: 3.7806124687194824
Epoch: 3, Steps: 7 | Train Loss: 1.583 Vali Loss: 1.249 Vali Acc: 0.694 Test Loss: 1.249 Test Acc: 0.694
Validation loss decreased (-0.624981 --> -0.694432).  Saving model ...
Epoch: 4 cost time: 1.9895262718200684
Epoch: 4, Steps: 7 | Train Loss: 0.749 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.694432 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 3.635162591934204
Epoch: 5, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 3.160048484802246
Epoch: 6, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 3.780214309692383
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 3.3769829273223877
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 3.5354177951812744
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3773140907287598
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.380600929260254
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.227537155151367
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.9776692390441895
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.1357851028442383
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.179595708847046
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.614532709121704
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.030487060546875
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4907472133636475
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1461472511291504
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8664822578430176
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6458072662353516
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.175478219985962
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0820436477661133
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8897204399108887
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10652104
model size : 45.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.71329402923584
Epoch: 1, Steps: 7 | Train Loss: 2.634 Vali Loss: 2.422 Vali Acc: 0.208 Test Loss: 2.422 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 3.2801196575164795
Epoch: 2, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.020 Vali Acc: 0.444 Test Loss: 2.020 Test Acc: 0.444
Validation loss decreased (-0.208309 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 3.2134692668914795
Epoch: 3, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.275 Vali Acc: 0.625 Test Loss: 1.275 Test Acc: 0.625
Validation loss decreased (-0.444424 --> -0.624987).  Saving model ...
Epoch: 4 cost time: 3.394366979598999
Epoch: 4, Steps: 7 | Train Loss: 0.876 Vali Loss: 0.729 Vali Acc: 0.861 Test Loss: 0.729 Test Acc: 0.861
Validation loss decreased (-0.624987 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 2.431405544281006
Epoch: 5, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 3.4135448932647705
Epoch: 6, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.379 Vali Acc: 0.847 Test Loss: 0.379 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6052722930908203
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 3.087435483932495
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 3.214886426925659
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 2.864985942840576
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 3.235992908477783
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.404707431793213
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6366147994995117
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.733051061630249
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4503307342529297
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8545122146606445
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.752495050430298
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3468620777130127
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.5316131114959717
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9749817848205566
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 10603976
model size : 45.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5214593410491943
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.369 Vali Acc: 0.264 Test Loss: 2.369 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 2.137192726135254
Epoch: 2, Steps: 7 | Train Loss: 2.296 Vali Loss: 1.860 Vali Acc: 0.653 Test Loss: 1.860 Test Acc: 0.653
Validation loss decreased (-0.263865 --> -0.652759).  Saving model ...
Epoch: 3 cost time: 2.064359188079834
Epoch: 3, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.164 Vali Acc: 0.806 Test Loss: 1.164 Test Acc: 0.806
Validation loss decreased (-0.652759 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 2.034302234649658
Epoch: 4, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 2.437798023223877
Epoch: 5, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.833328 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 2.7580831050872803
Epoch: 6, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9279587268829346
Epoch: 7, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 2.6139349937438965
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.8616394996643066
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.919966220855713
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 2.490684747695923
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8539304733276367
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4898900985717773
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.482947587966919
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 3.3182191848754883
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1410160064697266
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.477511167526245
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7124009132385254
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7562224864959717
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5245699882507324
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.103208065032959
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.281667470932007
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.258272409439087
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6982810497283936
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 10555848
model size : 45.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.935469627380371
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.445 Vali Acc: 0.056 Test Loss: 2.445 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 3.205533027648926
Epoch: 2, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.327 Vali Acc: 0.139 Test Loss: 2.327 Test Acc: 0.139
Validation loss decreased (-0.055531 --> -0.138866).  Saving model ...
Epoch: 3 cost time: 2.5391736030578613
Epoch: 3, Steps: 7 | Train Loss: 2.130 Vali Loss: 1.951 Vali Acc: 0.431 Test Loss: 1.951 Test Acc: 0.431
Validation loss decreased (-0.138866 --> -0.430536).  Saving model ...
Epoch: 4 cost time: 3.4065887928009033
Epoch: 4, Steps: 7 | Train Loss: 1.688 Vali Loss: 1.272 Vali Acc: 0.778 Test Loss: 1.272 Test Acc: 0.778
Validation loss decreased (-0.430536 --> -0.777765).  Saving model ...
Epoch: 5 cost time: 1.3054242134094238
Epoch: 5, Steps: 7 | Train Loss: 0.822 Vali Loss: 0.798 Vali Acc: 0.778 Test Loss: 0.798 Test Acc: 0.778
Validation loss decreased (-0.777765 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 2.8517613410949707
Epoch: 6, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.777770 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 2.9581499099731445
Epoch: 7, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 2.1882429122924805
Epoch: 8, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 2.97627592086792
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.732933759689331
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 2.9115591049194336
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.1189887523651123
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.183873414993286
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5646977424621582
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.271556854248047
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7910926342010498
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4518649578094482
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6735472679138184
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.8057470321655273
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7188832759857178
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7482266426086426
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5063880
model size : 21.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.954892158508301
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.429 Vali Acc: 0.181 Test Loss: 2.429 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 3.8303959369659424
Epoch: 2, Steps: 7 | Train Loss: 2.474 Vali Loss: 2.232 Vali Acc: 0.347 Test Loss: 2.232 Test Acc: 0.347
Validation loss decreased (-0.180531 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 3.4258840084075928
Epoch: 3, Steps: 7 | Train Loss: 2.113 Vali Loss: 1.796 Vali Acc: 0.569 Test Loss: 1.796 Test Acc: 0.569
Validation loss decreased (-0.347200 --> -0.569426).  Saving model ...
Epoch: 4 cost time: 3.6844654083251953
Epoch: 4, Steps: 7 | Train Loss: 1.459 Vali Loss: 1.127 Vali Acc: 0.861 Test Loss: 1.127 Test Acc: 0.861
Validation loss decreased (-0.569426 --> -0.861100).  Saving model ...
Epoch: 5 cost time: 3.4462928771972656
Epoch: 5, Steps: 7 | Train Loss: 0.698 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 3.9001498222351074
Epoch: 6, Steps: 7 | Train Loss: 0.276 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 3.7929372787475586
Epoch: 7, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 3.3226616382598877
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 3.2247047424316406
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.935643434524536
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 3.6811654567718506
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4877564907073975
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.292137622833252
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.173210620880127
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.522075891494751
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.561434030532837
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.6250193119049072
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.478447914123535
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.903 Test Loss: 0.190 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.096773862838745
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.903 Test Loss: 0.191 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7783701419830322
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.903 Test Loss: 0.193 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5039816
model size : 21.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.364313364028931
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.483 Vali Acc: 0.111 Test Loss: 2.483 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.7562689781188965
Epoch: 2, Steps: 7 | Train Loss: 2.531 Vali Loss: 2.284 Vali Acc: 0.250 Test Loss: 2.284 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 2.5712788105010986
Epoch: 3, Steps: 7 | Train Loss: 1.990 Vali Loss: 1.747 Vali Acc: 0.583 Test Loss: 1.747 Test Acc: 0.583
Validation loss decreased (-0.249977 --> -0.583316).  Saving model ...
Epoch: 4 cost time: 2.6823389530181885
Epoch: 4, Steps: 7 | Train Loss: 1.426 Vali Loss: 1.106 Vali Acc: 0.792 Test Loss: 1.106 Test Acc: 0.792
Validation loss decreased (-0.583316 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 2.811832904815674
Epoch: 5, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.791656 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 3.122319459915161
Epoch: 6, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 3.7075881958007812
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 3.371326208114624
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 3.7127318382263184
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 3.0632219314575195
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 3.649078130722046
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 3.2588934898376465
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.54807710647583
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7994143962860107
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8456993103027344
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.786036729812622
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9240481853485107
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.799170970916748
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5248119831085205
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.492189884185791
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.382558584213257
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5015752
model size : 21.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.57771635055542
Epoch: 1, Steps: 7 | Train Loss: 2.737 Vali Loss: 2.557 Vali Acc: 0.042 Test Loss: 2.557 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 3.1502740383148193
Epoch: 2, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.400 Vali Acc: 0.167 Test Loss: 2.400 Test Acc: 0.167
Validation loss decreased (-0.041641 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 3.282942533493042
Epoch: 3, Steps: 7 | Train Loss: 2.214 Vali Loss: 1.972 Vali Acc: 0.403 Test Loss: 1.972 Test Acc: 0.403
Validation loss decreased (-0.166643 --> -0.402758).  Saving model ...
Epoch: 4 cost time: 2.982304334640503
Epoch: 4, Steps: 7 | Train Loss: 1.574 Vali Loss: 1.275 Vali Acc: 0.722 Test Loss: 1.275 Test Acc: 0.722
Validation loss decreased (-0.402758 --> -0.722209).  Saving model ...
Epoch: 5 cost time: 3.2438547611236572
Epoch: 5, Steps: 7 | Train Loss: 0.838 Vali Loss: 0.864 Vali Acc: 0.792 Test Loss: 0.864 Test Acc: 0.792
Validation loss decreased (-0.722209 --> -0.791658).  Saving model ...
Epoch: 6 cost time: 3.0336503982543945
Epoch: 6, Steps: 7 | Train Loss: 0.319 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
Validation loss decreased (-0.791658 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 2.690401792526245
Epoch: 7, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 3.068375825881958
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 3.093964099884033
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.875671863555908
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.609137773513794
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 3.439817190170288
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 2.9028141498565674
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 2.38879656791687
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 2.6732025146484375
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 2.478485107421875
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 2.4068868160247803
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 2.1772825717926025
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9738028049468994
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 3.3102993965148926
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 3.5963025093078613
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 3.5229363441467285
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0629122257232666
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.145857334136963
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4631881713867188
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2001004219055176
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.941755533218384
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.533435821533203
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 2.3750901222229004
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 3.163597345352173
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 3.429961681365967
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 3.1196560859680176
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 2.3360588550567627
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 3.0902533531188965
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 3.0286552906036377
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 3.108250617980957
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.253917694091797
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.7190260887145996
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3685948848724365
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.492758274078369
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.9546945095062256
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.2698347568511963
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.0245869159698486
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.443664312362671
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 2.943129301071167
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.759908437728882
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 2.642083168029785
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 3.340363025665283
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 3.3386919498443604
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 3.2172768115997314
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.2490508556365967
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 3.646810531616211
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 3.7375428676605225
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 54 cost time: 2.4165217876434326
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.166498899459839
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.346336841583252
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.616741895675659
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.0135724544525146
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.4439167976379395
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.2098758220672607
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.2358076572418213
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.11702561378479
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.261357069015503
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4991688
model size : 21.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.495102167129517
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.433 Vali Acc: 0.125 Test Loss: 2.433 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.191568613052368
Epoch: 2, Steps: 7 | Train Loss: 2.464 Vali Loss: 2.295 Vali Acc: 0.167 Test Loss: 2.295 Test Acc: 0.167
Validation loss decreased (-0.124976 --> -0.166644).  Saving model ...
Epoch: 3 cost time: 3.465161085128784
Epoch: 3, Steps: 7 | Train Loss: 2.187 Vali Loss: 1.915 Vali Acc: 0.611 Test Loss: 1.915 Test Acc: 0.611
Validation loss decreased (-0.166644 --> -0.611092).  Saving model ...
Epoch: 4 cost time: 3.900858163833618
Epoch: 4, Steps: 7 | Train Loss: 1.687 Vali Loss: 1.374 Vali Acc: 0.750 Test Loss: 1.374 Test Acc: 0.750
Validation loss decreased (-0.611092 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 3.5238630771636963
Epoch: 5, Steps: 7 | Train Loss: 0.989 Vali Loss: 0.815 Vali Acc: 0.861 Test Loss: 0.815 Test Acc: 0.861
Validation loss decreased (-0.749986 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 3.563477039337158
Epoch: 6, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3363091945648193
Epoch: 7, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 3.4456610679626465
Epoch: 8, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.381 Vali Acc: 0.847 Test Loss: 0.381 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.547938585281372
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 2.766322135925293
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.245404005050659
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.266592264175415
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.604429244995117
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 4.037841320037842
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6605613231658936
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.239396095275879
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.575575828552246
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.26774001121521
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.358085870742798
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.633749008178711
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.177396535873413
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4723708629608154
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5493886470794678
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3879624
model size : 17.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.7283241748809814
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.438 Vali Acc: 0.139 Test Loss: 2.438 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 3.8467068672180176
Epoch: 2, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.256 Vali Acc: 0.194 Test Loss: 2.256 Test Acc: 0.194
Validation loss decreased (-0.138865 --> -0.194422).  Saving model ...
Epoch: 3 cost time: 3.413804769515991
Epoch: 3, Steps: 7 | Train Loss: 2.170 Vali Loss: 1.932 Vali Acc: 0.583 Test Loss: 1.932 Test Acc: 0.583
Validation loss decreased (-0.194422 --> -0.583314).  Saving model ...
Epoch: 4 cost time: 3.226525068283081
Epoch: 4, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.208 Vali Acc: 0.833 Test Loss: 1.208 Test Acc: 0.833
Validation loss decreased (-0.583314 --> -0.833321).  Saving model ...
Epoch: 5 cost time: 3.6613848209381104
Epoch: 5, Steps: 7 | Train Loss: 0.879 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.833321 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 3.5292515754699707
Epoch: 6, Steps: 7 | Train Loss: 0.341 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 3.8432059288024902
Epoch: 7, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4002182483673096
Epoch: 8, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 3.2015540599823
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.795264720916748
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.153719425201416
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.5538058280944824
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 2.6919195652008057
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 2.341618061065674
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 3.11197566986084
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 3.2780470848083496
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 2.7361152172088623
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.984157085418701
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 3.8007864952087402
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 3.5170974731445312
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5073447227478027
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.886967658996582
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 3.467719316482544
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 3.1829609870910645
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 3.5040695667266846
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 3.426861524581909
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 3.4384677410125732
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 3.9654428958892822
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 2.5817668437957764
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6257505416870117
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.470834970474243
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 3.8732666969299316
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 3.3907158374786377
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 3.3460195064544678
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 3.111041784286499
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 3.903963804244995
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.81089186668396
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.485764265060425
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 2.7298285961151123
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 3.5912137031555176
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 3.7276084423065186
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 3.6937382221221924
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 3.3069581985473633
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.3730905055999756
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6077449321746826
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 3.595055341720581
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 3.427870512008667
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 2.923895835876465
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 3.593797206878662
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 3.6889352798461914
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.4698777198791504
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.1116416454315186
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.8158349990844727
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.8511178493499756
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.525991439819336
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.2463459968566895
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.6551034450531006
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.321364641189575
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.255117416381836
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3855560
model size : 17.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.243939638137817
Epoch: 1, Steps: 7 | Train Loss: 2.647 Vali Loss: 2.422 Vali Acc: 0.208 Test Loss: 2.422 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.2887871265411377
Epoch: 2, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.203 Vali Acc: 0.319 Test Loss: 2.203 Test Acc: 0.319
Validation loss decreased (-0.208309 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 2.343325138092041
Epoch: 3, Steps: 7 | Train Loss: 2.158 Vali Loss: 1.870 Vali Acc: 0.542 Test Loss: 1.870 Test Acc: 0.542
Validation loss decreased (-0.319422 --> -0.541648).  Saving model ...
Epoch: 4 cost time: 2.762437105178833
Epoch: 4, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.268 Vali Acc: 0.778 Test Loss: 1.268 Test Acc: 0.778
Validation loss decreased (-0.541648 --> -0.777765).  Saving model ...
Epoch: 5 cost time: 2.6422016620635986
Epoch: 5, Steps: 7 | Train Loss: 0.927 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
Validation loss decreased (-0.777765 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 3.072166919708252
Epoch: 6, Steps: 7 | Train Loss: 0.438 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9577651023864746
Epoch: 7, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 3.349575996398926
Epoch: 8, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6959235668182373
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.055522203445435
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6769461631774902
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.461214303970337
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.4578564167022705
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 2.510606527328491
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8558413982391357
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.024500846862793
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 3.3895153999328613
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 3.313048839569092
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 3.46329927444458
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 2.8639988899230957
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 2.984163522720337
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 3.3631069660186768
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 3.565690040588379
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 3.3174636363983154
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 3.4592363834381104
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 2.7240889072418213
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 3.6851274967193604
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 3.3948006629943848
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 3.5803472995758057
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 3.3001391887664795
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.91007399559021
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 3.4659364223480225
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 3.212672233581543
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3127825260162354
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 3.40118408203125
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 3.196796178817749
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9609735012054443
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.8216142654418945
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.6336545944213867
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.707249641418457
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.241910696029663
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 3.8231518268585205
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 2.09686541557312
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.8169004917144775
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 4.367993354797363
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 3.955894708633423
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 3.7333998680114746
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 3.1168816089630127
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.4709365367889404
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.9271657466888428
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.664012908935547
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.7356412410736084
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.1174144744873047
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.8196191787719727
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.7936513423919678
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.9098613262176514
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.870704174041748
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3831496
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.625638008117676
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.419 Vali Acc: 0.139 Test Loss: 2.419 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 2.0794079303741455
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.256 Vali Acc: 0.361 Test Loss: 2.256 Test Acc: 0.361
Validation loss decreased (-0.138865 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 3.2041757106781006
Epoch: 3, Steps: 7 | Train Loss: 2.229 Vali Loss: 1.954 Vali Acc: 0.486 Test Loss: 1.954 Test Acc: 0.486
Validation loss decreased (-0.361089 --> -0.486092).  Saving model ...
Epoch: 4 cost time: 3.1574440002441406
Epoch: 4, Steps: 7 | Train Loss: 1.619 Vali Loss: 1.299 Vali Acc: 0.736 Test Loss: 1.299 Test Acc: 0.736
Validation loss decreased (-0.486092 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 2.772789478302002
Epoch: 5, Steps: 7 | Train Loss: 0.891 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.736098 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 3.3203377723693848
Epoch: 6, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 3.320927381515503
Epoch: 7, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.419451951980591
Epoch: 8, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.562903881072998
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.426182508468628
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 3.534419536590576
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 3.9727466106414795
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.583585500717163
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.0887153148651123
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 2.9078361988067627
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.452374219894409
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5323173999786377
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.499027967453003
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6836209297180176
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.541757106781006
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3984174728393555
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.679654121398926
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2977712154388428
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7347617149353027
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3807432
model size : 17.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.106643438339233
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.439 Vali Acc: 0.125 Test Loss: 2.439 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.6088433265686035
Epoch: 2, Steps: 7 | Train Loss: 2.485 Vali Loss: 2.397 Vali Acc: 0.222 Test Loss: 2.397 Test Acc: 0.222
Validation loss decreased (-0.124976 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 2.5388925075531006
Epoch: 3, Steps: 7 | Train Loss: 2.200 Vali Loss: 1.977 Vali Acc: 0.333 Test Loss: 1.977 Test Acc: 0.333
Validation loss decreased (-0.222198 --> -0.333314).  Saving model ...
Epoch: 4 cost time: 2.4695279598236084
Epoch: 4, Steps: 7 | Train Loss: 1.738 Vali Loss: 1.417 Vali Acc: 0.861 Test Loss: 1.417 Test Acc: 0.861
Validation loss decreased (-0.333314 --> -0.861097).  Saving model ...
Epoch: 5 cost time: 3.4838743209838867
Epoch: 5, Steps: 7 | Train Loss: 1.034 Vali Loss: 0.858 Vali Acc: 0.847 Test Loss: 0.858 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4649837017059326
Epoch: 6, Steps: 7 | Train Loss: 0.478 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
Validation loss decreased (-0.861097 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 3.285971164703369
Epoch: 7, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 3.5593349933624268
Epoch: 8, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 3.759523391723633
Epoch: 9, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 3.51713228225708
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4891703128814697
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 3.8670856952667236
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 3.4571778774261475
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 3.075366735458374
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3079447746276855
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4650936126708984
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9031622409820557
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.146423101425171
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.681096076965332
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.892723798751831
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.118569850921631
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.29582142829895
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.4740633964538574
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3287496
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.787651062011719
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.470 Vali Acc: 0.111 Test Loss: 2.470 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 3.381042957305908
Epoch: 2, Steps: 7 | Train Loss: 2.505 Vali Loss: 2.347 Vali Acc: 0.236 Test Loss: 2.347 Test Acc: 0.236
Validation loss decreased (-0.111086 --> -0.236088).  Saving model ...
Epoch: 3 cost time: 3.497969627380371
Epoch: 3, Steps: 7 | Train Loss: 2.200 Vali Loss: 1.969 Vali Acc: 0.375 Test Loss: 1.969 Test Acc: 0.375
Validation loss decreased (-0.236088 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 3.5382306575775146
Epoch: 4, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.480 Vali Acc: 0.694 Test Loss: 1.480 Test Acc: 0.694
Validation loss decreased (-0.374980 --> -0.694430).  Saving model ...
Epoch: 5 cost time: 3.6042215824127197
Epoch: 5, Steps: 7 | Train Loss: 1.164 Vali Loss: 0.920 Vali Acc: 0.819 Test Loss: 0.920 Test Acc: 0.819
Validation loss decreased (-0.694430 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 3.3379299640655518
Epoch: 6, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 3.856210947036743
Epoch: 7, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.443 Vali Acc: 0.847 Test Loss: 0.443 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.360321521759033
Epoch: 8, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.594081401824951
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 3.2904281616210938
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8360660076141357
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 3.59125018119812
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 3.169285535812378
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.3190228939056396
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.273514986038208
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.375473976135254
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1814515590667725
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.254509925842285
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.264096260070801
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2607743740081787
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 3.046867609024048
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.7185487747192383
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.424715280532837
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.303480386734009
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5054216384887695
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 3.5878257751464844
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3989603519439697
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2143006324768066
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7372782230377197
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.327404022216797
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.671494483947754
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 2.4334330558776855
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 3.6077113151550293
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.7881357669830322
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 3.1275620460510254
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.3979034423828125
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.954573392868042
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.725996732711792
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.3082804679870605
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.3992981910705566
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 3.1635935306549072
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.48539137840271
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 3.0331764221191406
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 2.9661834239959717
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.6110126972198486
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.6258544921875
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.660836696624756
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.0621581077575684
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.3989429473876953
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.2517898082733154
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 3.2176523208618164
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.496574878692627
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 3.709868907928467
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 3.712167501449585
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 3.7364180088043213
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.652146577835083
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.5737335681915283
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.8038856983184814
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.5269930362701416
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.673582077026367
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.837341785430908
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.276967763900757
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.3765869140625
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.122117280960083
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3263432
model size : 15.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.145497798919678
Epoch: 1, Steps: 7 | Train Loss: 2.631 Vali Loss: 2.486 Vali Acc: 0.042 Test Loss: 2.486 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 3.3682701587677
Epoch: 2, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.358 Vali Acc: 0.264 Test Loss: 2.358 Test Acc: 0.264
Validation loss decreased (-0.041642 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 3.4168617725372314
Epoch: 3, Steps: 7 | Train Loss: 2.201 Vali Loss: 2.002 Vali Acc: 0.486 Test Loss: 2.002 Test Acc: 0.486
Validation loss decreased (-0.263865 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 3.4412007331848145
Epoch: 4, Steps: 7 | Train Loss: 1.823 Vali Loss: 1.557 Vali Acc: 0.708 Test Loss: 1.557 Test Acc: 0.708
Validation loss decreased (-0.486091 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 2.9024510383605957
Epoch: 5, Steps: 7 | Train Loss: 1.218 Vali Loss: 1.080 Vali Acc: 0.792 Test Loss: 1.080 Test Acc: 0.792
Validation loss decreased (-0.708318 --> -0.791656).  Saving model ...
Epoch: 6 cost time: 3.128333806991577
Epoch: 6, Steps: 7 | Train Loss: 0.639 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819439).  Saving model ...
Epoch: 7 cost time: 3.3497543334960938
Epoch: 7, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 3.707132339477539
Epoch: 8, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 3.3427867889404297
Epoch: 9, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 2.7932627201080322
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 3.2567811012268066
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.103440284729004
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.193617105484009
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7365238666534424
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.256565809249878
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4741885662078857
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 2.7829411029815674
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 2.865983247756958
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 3.601323366165161
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 3.4221277236938477
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0403921604156494
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.180863380432129
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7740466594696045
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.12138295173645
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.467777729034424
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.533942699432373
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.4517931938171387
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.448134183883667
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.042755603790283
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3239368
model size : 14.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.385374546051025
Epoch: 1, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.412 Vali Acc: 0.250 Test Loss: 2.412 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 3.0653722286224365
Epoch: 2, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.220 Vali Acc: 0.333 Test Loss: 2.220 Test Acc: 0.333
Validation loss decreased (-0.249976 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 3.1239631175994873
Epoch: 3, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.686 Vali Acc: 0.764 Test Loss: 1.686 Test Acc: 0.764
Validation loss decreased (-0.333311 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 3.35296630859375
Epoch: 4, Steps: 7 | Train Loss: 1.425 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3958804607391357
Epoch: 5, Steps: 7 | Train Loss: 0.743 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
Validation loss decreased (-0.763872 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 2.7528905868530273
Epoch: 6, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 2.2744438648223877
Epoch: 7, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.626102924346924
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.888884 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 3.0194363594055176
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3314883708953857
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3897788524627686
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 3.7359752655029297
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1421756744384766
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7879958152770996
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6094040870666504
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.652384042739868
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.562297821044922
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.440211772918701
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.135866165161133
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.438371419906616
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.673002243041992
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3215304
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.522665023803711
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.416 Vali Acc: 0.167 Test Loss: 2.416 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 3.7578506469726562
Epoch: 2, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.282 Vali Acc: 0.250 Test Loss: 2.282 Test Acc: 0.250
Validation loss decreased (-0.166643 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 3.662778377532959
Epoch: 3, Steps: 7 | Train Loss: 2.127 Vali Loss: 1.945 Vali Acc: 0.403 Test Loss: 1.945 Test Acc: 0.403
Validation loss decreased (-0.249977 --> -0.402758).  Saving model ...
Epoch: 4 cost time: 3.719078302383423
Epoch: 4, Steps: 7 | Train Loss: 1.721 Vali Loss: 1.437 Vali Acc: 0.806 Test Loss: 1.437 Test Acc: 0.806
Validation loss decreased (-0.402758 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 3.4319562911987305
Epoch: 5, Steps: 7 | Train Loss: 1.127 Vali Loss: 0.938 Vali Acc: 0.792 Test Loss: 0.938 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8933889865875244
Epoch: 6, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 3.312025308609009
Epoch: 7, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 3.7121706008911133
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 3.7462618350982666
Epoch: 9, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.870516300201416
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.198550224304199
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.6553399562835693
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4602115154266357
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5777697563171387
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.681044340133667
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.089812278747559
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 3.1165647506713867
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0178754329681396
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.8497612476348877
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.5935022830963135
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 3.224003314971924
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0292422771453857
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5145552158355713
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 3.1718432903289795
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 3.152646064758301
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 3.7473626136779785
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4332358837127686
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 3.5729422569274902
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5396296977996826
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9857213497161865
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.840181827545166
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.8313398361206055
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.6302764415740967
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.7031726837158203
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 3.2343544960021973
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.6905806064605713
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 3.1170949935913086
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 3.4865546226501465
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 3.3487305641174316
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.239424228668213
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.909644603729248
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2419145107269287
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.5662026405334473
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.383539915084839
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.7789969444274902
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.8132121562957764
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.819955348968506
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.5556299686431885
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2991432
model size : 14.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.68980598449707
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.1587018966674805
Epoch: 2, Steps: 7 | Train Loss: 2.417 Vali Loss: 2.307 Vali Acc: 0.319 Test Loss: 2.307 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 3.5054571628570557
Epoch: 3, Steps: 7 | Train Loss: 2.136 Vali Loss: 1.983 Vali Acc: 0.569 Test Loss: 1.983 Test Acc: 0.569
Validation loss decreased (-0.319421 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 2.873781204223633
Epoch: 4, Steps: 7 | Train Loss: 1.654 Vali Loss: 1.420 Vali Acc: 0.750 Test Loss: 1.420 Test Acc: 0.750
Validation loss decreased (-0.569425 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 3.1182589530944824
Epoch: 5, Steps: 7 | Train Loss: 1.058 Vali Loss: 0.941 Vali Acc: 0.833 Test Loss: 0.941 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 2.772195339202881
Epoch: 6, Steps: 7 | Train Loss: 0.502 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 3.092372179031372
Epoch: 7, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 3.654580593109131
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4978761672973633
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.199524402618408
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.670994281768799
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.875 Test Loss: 0.245 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.956193208694458
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 3.151946783065796
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 3.1069178581237793
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 2.85332989692688
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 3.136363983154297
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7739651203155518
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4462387561798096
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.288475275039673
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.850951671600342
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9140968322753906
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4290759563446045
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4587507247924805
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.243523597717285
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.502218246459961
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2967368
model size : 13.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.9690842628479
Epoch: 1, Steps: 7 | Train Loss: 2.655 Vali Loss: 2.503 Vali Acc: 0.125 Test Loss: 2.503 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.953188896179199
Epoch: 2, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.386 Vali Acc: 0.236 Test Loss: 2.386 Test Acc: 0.236
Validation loss decreased (-0.124975 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 1.7932729721069336
Epoch: 3, Steps: 7 | Train Loss: 2.297 Vali Loss: 2.013 Vali Acc: 0.639 Test Loss: 2.013 Test Acc: 0.639
Validation loss decreased (-0.236087 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 2.77138614654541
Epoch: 4, Steps: 7 | Train Loss: 1.854 Vali Loss: 1.677 Vali Acc: 0.514 Test Loss: 1.677 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.058603286743164
Epoch: 5, Steps: 7 | Train Loss: 1.267 Vali Loss: 0.989 Vali Acc: 0.833 Test Loss: 0.989 Test Acc: 0.833
Validation loss decreased (-0.638869 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 2.1914725303649902
Epoch: 6, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.504868745803833
Epoch: 7, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 2.2131574153900146
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9353363513946533
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7541542053222656
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.523303270339966
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 2.891868829727173
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 2.7319495677948
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 3.0900492668151855
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 3.1633694171905518
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5777745246887207
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4165642261505127
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.758341073989868
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7418735027313232
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5303163528442383
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3907511234283447
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2139337062835693
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.941276788711548
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.974543571472168
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 2943304
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.438990354537964
Epoch: 1, Steps: 7 | Train Loss: 2.646 Vali Loss: 2.520 Vali Acc: 0.069 Test Loss: 2.520 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 3.0051796436309814
Epoch: 2, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.383 Vali Acc: 0.167 Test Loss: 2.383 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 3.036865234375
Epoch: 3, Steps: 7 | Train Loss: 2.228 Vali Loss: 2.024 Vali Acc: 0.444 Test Loss: 2.024 Test Acc: 0.444
Validation loss decreased (-0.166643 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 2.741373300552368
Epoch: 4, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.479 Vali Acc: 0.667 Test Loss: 1.479 Test Acc: 0.667
Validation loss decreased (-0.444424 --> -0.666652).  Saving model ...
Epoch: 5 cost time: 2.6898648738861084
Epoch: 5, Steps: 7 | Train Loss: 1.040 Vali Loss: 0.930 Vali Acc: 0.778 Test Loss: 0.930 Test Acc: 0.778
Validation loss decreased (-0.666652 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 3.192566156387329
Epoch: 6, Steps: 7 | Train Loss: 0.476 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.777768 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 2.9710588455200195
Epoch: 7, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8782942295074463
Epoch: 8, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.3668816089630127
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.370 Vali Acc: 0.847 Test Loss: 0.370 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1981582641601562
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 3.4590089321136475
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.886251449584961
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8799891471862793
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.918854236602783
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1993932723999023
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 2.159846305847168
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 2.971834659576416
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 2.3841822147369385
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.703237533569336
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9164772033691406
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1969730854034424
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6208837032318115
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.683237314224243
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.386176824569702
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1403489112854004
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 2.765714645385742
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6440834999084473
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8943793773651123
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.983912706375122
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.039604902267456
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0880730152130127
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.846651792526245
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 2.9402294158935547
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 2.9224987030029297
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 3.243968963623047
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 2.964205741882324
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9591832160949707
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.999981641769409
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.90762996673584
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.2024054527282715
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.7040505409240723
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.035804271697998
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 2.706552267074585
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 2.568101406097412
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 1.8961474895477295
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 2.5997846126556396
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 2.700451135635376
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 2.574556589126587
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 3.169363021850586
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.8570351600646973
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 2.627122640609741
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 2.4874069690704346
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.48268461227417
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.3838658332824707
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 2.1432526111602783
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 2.3947694301605225
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.3609321117401123
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.0093889236450195
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.4086310863494873
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.846850633621216
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.871201276779175
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 3.096383810043335
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.687350273132324
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 2.649998188018799
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.967798948287964
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2919240
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.558981657028198
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.517 Vali Acc: 0.097 Test Loss: 2.517 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.5301918983459473
Epoch: 2, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.453 Vali Acc: 0.208 Test Loss: 2.453 Test Acc: 0.208
Validation loss decreased (-0.097197 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 3.2310471534729004
Epoch: 3, Steps: 7 | Train Loss: 2.405 Vali Loss: 2.231 Vali Acc: 0.389 Test Loss: 2.231 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 2.275601863861084
Epoch: 4, Steps: 7 | Train Loss: 2.043 Vali Loss: 1.920 Vali Acc: 0.528 Test Loss: 1.920 Test Acc: 0.528
Validation loss decreased (-0.388867 --> -0.527759).  Saving model ...
Epoch: 5 cost time: 3.1047418117523193
Epoch: 5, Steps: 7 | Train Loss: 1.539 Vali Loss: 1.359 Vali Acc: 0.778 Test Loss: 1.359 Test Acc: 0.778
Validation loss decreased (-0.527759 --> -0.777764).  Saving model ...
Epoch: 6 cost time: 3.0967495441436768
Epoch: 6, Steps: 7 | Train Loss: 0.965 Vali Loss: 0.923 Vali Acc: 0.792 Test Loss: 0.923 Test Acc: 0.792
Validation loss decreased (-0.777764 --> -0.791657).  Saving model ...
Epoch: 7 cost time: 2.736889600753784
Epoch: 7, Steps: 7 | Train Loss: 0.499 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
Validation loss decreased (-0.791657 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 2.9258275032043457
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 2.956815004348755
Epoch: 9, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 3.186044692993164
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.648165702819824
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 2.5707457065582275
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9384100437164307
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9837138652801514
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7486813068389893
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.086228609085083
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.994882345199585
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.756295680999756
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.899808645248413
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.53458571434021
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3880436420440674
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1946760
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.006712913513184
Epoch: 1, Steps: 7 | Train Loss: 2.629 Vali Loss: 2.478 Vali Acc: 0.125 Test Loss: 2.478 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.4217677116394043
Epoch: 2, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.337 Vali Acc: 0.292 Test Loss: 2.337 Test Acc: 0.292
Validation loss decreased (-0.124975 --> -0.291643).  Saving model ...
Epoch: 3 cost time: 2.391583204269409
Epoch: 3, Steps: 7 | Train Loss: 2.315 Vali Loss: 2.176 Vali Acc: 0.472 Test Loss: 2.176 Test Acc: 0.472
Validation loss decreased (-0.291643 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 2.4700369834899902
Epoch: 4, Steps: 7 | Train Loss: 1.992 Vali Loss: 1.829 Vali Acc: 0.569 Test Loss: 1.829 Test Acc: 0.569
Validation loss decreased (-0.472200 --> -0.569426).  Saving model ...
Epoch: 5 cost time: 2.6042730808258057
Epoch: 5, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.342 Vali Acc: 0.750 Test Loss: 1.342 Test Acc: 0.750
Validation loss decreased (-0.569426 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 3.034322738647461
Epoch: 6, Steps: 7 | Train Loss: 0.980 Vali Loss: 0.913 Vali Acc: 0.819 Test Loss: 0.913 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819435).  Saving model ...
Epoch: 7 cost time: 2.7410075664520264
Epoch: 7, Steps: 7 | Train Loss: 0.564 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8506646156311035
Epoch: 8, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
Validation loss decreased (-0.819435 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 2.6966686248779297
Epoch: 9, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 2.9483489990234375
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9870381355285645
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.3206698894500732
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 3.2240822315216064
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.5801994800567627
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.4000580310821533
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.976358413696289
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.07906174659729
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3483164310455322
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.202310562133789
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.050766706466675
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.314512252807617
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.6661555767059326
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.0104641914367676
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.908276081085205
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0726680755615234
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.030850410461426
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.917116165161133
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6938974857330322
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0486104488372803
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.374019145965576
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.9764719009399414
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 2.5570755004882812
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.5128872394561768
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.3028576374053955
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.3303070068359375
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.565953254699707
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.4406960010528564
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.5393688678741455
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.0314419269561768
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8412392139434814
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.7416775226593018
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1934728
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.11175012588501
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.470 Vali Acc: 0.125 Test Loss: 2.470 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.762795925140381
Epoch: 2, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.415 Vali Acc: 0.194 Test Loss: 2.415 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 2.576737880706787
Epoch: 3, Steps: 7 | Train Loss: 2.409 Vali Loss: 2.265 Vali Acc: 0.208 Test Loss: 2.265 Test Acc: 0.208
Validation loss decreased (-0.194420 --> -0.208311).  Saving model ...
Epoch: 4 cost time: 2.724036693572998
Epoch: 4, Steps: 7 | Train Loss: 2.172 Vali Loss: 2.016 Vali Acc: 0.333 Test Loss: 2.016 Test Acc: 0.333
Validation loss decreased (-0.208311 --> -0.333313).  Saving model ...
Epoch: 5 cost time: 2.766472816467285
Epoch: 5, Steps: 7 | Train Loss: 1.699 Vali Loss: 1.503 Vali Acc: 0.681 Test Loss: 1.503 Test Acc: 0.681
Validation loss decreased (-0.333313 --> -0.680541).  Saving model ...
Epoch: 6 cost time: 3.1525590419769287
Epoch: 6, Steps: 7 | Train Loss: 1.118 Vali Loss: 1.018 Vali Acc: 0.764 Test Loss: 1.018 Test Acc: 0.764
Validation loss decreased (-0.680541 --> -0.763879).  Saving model ...
Epoch: 7 cost time: 3.1838021278381348
Epoch: 7, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
Validation loss decreased (-0.763879 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 2.6546478271484375
Epoch: 8, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.441 Vali Acc: 0.917 Test Loss: 0.441 Test Acc: 0.917
Validation loss decreased (-0.861105 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 2.3907251358032227
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9941654205322266
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.013477325439453
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.450347423553467
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 3.189870834350586
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.392660140991211
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.4700989723205566
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 2.7061848640441895
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1269614696502686
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.866056203842163
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 2.671217441558838
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9849958419799805
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 3.098666191101074
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2074310779571533
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7311630249023438
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 2.4595322608947754
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5902624130249023
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 2.5115559101104736
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.44012451171875
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 2.566457986831665
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9301578998565674
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.556007146835327
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 2.6507272720336914
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.6413521766662598
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.8665237426757812
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.9281771183013916
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 2.2900054454803467
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 2.4449517726898193
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4870407581329346
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.7990779876708984
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7617969512939453
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.8093323707580566
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.6680445671081543
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.871387481689453
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.0138168334960938
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.390669107437134
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.111034631729126
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1922696
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.2242491245269775
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.438 Vali Acc: 0.167 Test Loss: 2.438 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.0524444580078125
Epoch: 2, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.313 Vali Acc: 0.208 Test Loss: 2.313 Test Acc: 0.208
Validation loss decreased (-0.166642 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 2.155985116958618
Epoch: 3, Steps: 7 | Train Loss: 2.207 Vali Loss: 2.086 Vali Acc: 0.569 Test Loss: 2.086 Test Acc: 0.569
Validation loss decreased (-0.208310 --> -0.569424).  Saving model ...
Epoch: 4 cost time: 2.3311574459075928
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.668 Vali Acc: 0.597 Test Loss: 1.668 Test Acc: 0.597
Validation loss decreased (-0.569424 --> -0.597206).  Saving model ...
Epoch: 5 cost time: 2.044206380844116
Epoch: 5, Steps: 7 | Train Loss: 1.320 Vali Loss: 1.124 Vali Acc: 0.792 Test Loss: 1.124 Test Acc: 0.792
Validation loss decreased (-0.597206 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 2.242518186569214
Epoch: 6, Steps: 7 | Train Loss: 0.758 Vali Loss: 0.758 Vali Acc: 0.847 Test Loss: 0.758 Test Acc: 0.847
Validation loss decreased (-0.791655 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 2.582796096801758
Epoch: 7, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.508 Vali Acc: 0.917 Test Loss: 0.508 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 2.3703696727752686
Epoch: 8, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7447166442871094
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 2.612006425857544
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8938021659851074
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.321047067642212
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.197255849838257
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.6768219470977783
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.302276372909546
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2636568546295166
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.1378090381622314
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.292534828186035
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.1646814346313477
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0206782817840576
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.203151226043701
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 2.6109349727630615
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.314178705215454
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 2.447171926498413
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 2.600260019302368
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.259650468826294
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4704079627990723
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8773467540740967
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.458280324935913
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6402947902679443
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.7109427452087402
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.1430768966674805
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.87569260597229
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.596186399459839
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.926970958709717
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 2.4776523113250732
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9003067016601562
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.6710121631622314
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.738901376724243
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.346306324005127
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 2.706928253173828
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.629234790802002
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.3192243576049805
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.411123275756836
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 2.35237979888916
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.4154739379882812
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.723895788192749
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.2753660678863525
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.634155750274658
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.012763023376465
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.3752024173736572
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.1867947578430176
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.8096137046813965
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.032247304916382
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.9384148120880127
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.8055317401885986
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.003377676010132
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.216202735900879
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1910664
model size : 8.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.107996463775635
Epoch: 1, Steps: 7 | Train Loss: 2.716 Vali Loss: 2.507 Vali Acc: 0.097 Test Loss: 2.507 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.24115252494812
Epoch: 2, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.524 Vali Acc: 0.250 Test Loss: 2.524 Test Acc: 0.250
Validation loss decreased (-0.097197 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 2.5524094104766846
Epoch: 3, Steps: 7 | Train Loss: 2.472 Vali Loss: 2.302 Vali Acc: 0.333 Test Loss: 2.302 Test Acc: 0.333
Validation loss decreased (-0.249975 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 2.872896432876587
Epoch: 4, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.025 Vali Acc: 0.500 Test Loss: 2.025 Test Acc: 0.500
Validation loss decreased (-0.333310 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 3.0984718799591064
Epoch: 5, Steps: 7 | Train Loss: 1.851 Vali Loss: 1.688 Vali Acc: 0.667 Test Loss: 1.688 Test Acc: 0.667
Validation loss decreased (-0.499980 --> -0.666650).  Saving model ...
Epoch: 6 cost time: 2.5288631916046143
Epoch: 6, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.224 Vali Acc: 0.847 Test Loss: 1.224 Test Acc: 0.847
Validation loss decreased (-0.666650 --> -0.847210).  Saving model ...
Epoch: 7 cost time: 3.276998281478882
Epoch: 7, Steps: 7 | Train Loss: 0.849 Vali Loss: 0.791 Vali Acc: 0.889 Test Loss: 0.791 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888881).  Saving model ...
Epoch: 8 cost time: 3.2831759452819824
Epoch: 8, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0072991847991943
Epoch: 9, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 3.3486499786376953
Epoch: 10, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.3885040283203125
Epoch: 11, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.045847177505493
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.7231483459472656
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.949842929840088
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.846074342727661
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0319559574127197
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.858328342437744
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.908541202545166
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.788984775543213
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.5657477378845215
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.9614078998565674
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.309842348098755
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 3.2122719287872314
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 3.030339241027832
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 2.813546895980835
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 2.247676134109497
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 2.54744815826416
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 2.6894216537475586
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.6574862003326416
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.967691659927368
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7657153606414795
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.8948373794555664
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.528797149658203
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0045337677001953
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6018450260162354
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0623605251312256
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9252948760986328
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 2.1065163612365723
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 3.2095863819122314
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 2.787290334701538
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.5506041049957275
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.31596302986145
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.400073528289795
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.40061354637146
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9548532962799072
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 1.9309382438659668
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 2.709195613861084
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.3976755142211914
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.8054745197296143
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.742202043533325
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.888651132583618
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.097273111343384
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.3163349628448486
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.7164077758789062
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.5682413578033447
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.564265727996826
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.942652702331543
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.621663808822632
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1352328
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.625364065170288
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.491 Vali Acc: 0.125 Test Loss: 2.491 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.3394742012023926
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.350 Vali Acc: 0.208 Test Loss: 2.350 Test Acc: 0.208
Validation loss decreased (-0.124975 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 2.5628457069396973
Epoch: 3, Steps: 7 | Train Loss: 2.347 Vali Loss: 2.159 Vali Acc: 0.389 Test Loss: 2.159 Test Acc: 0.389
Validation loss decreased (-0.208310 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 2.442291021347046
Epoch: 4, Steps: 7 | Train Loss: 2.051 Vali Loss: 1.866 Vali Acc: 0.667 Test Loss: 1.866 Test Acc: 0.667
Validation loss decreased (-0.388867 --> -0.666648).  Saving model ...
Epoch: 5 cost time: 2.9006028175354004
Epoch: 5, Steps: 7 | Train Loss: 1.565 Vali Loss: 1.371 Vali Acc: 0.694 Test Loss: 1.371 Test Acc: 0.694
Validation loss decreased (-0.666648 --> -0.694431).  Saving model ...
Epoch: 6 cost time: 2.3295249938964844
Epoch: 6, Steps: 7 | Train Loss: 1.057 Vali Loss: 0.948 Vali Acc: 0.861 Test Loss: 0.948 Test Acc: 0.861
Validation loss decreased (-0.694431 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 2.6163570880889893
Epoch: 7, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2210147380828857
Epoch: 8, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.013049840927124
Epoch: 9, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 2.7864832878112793
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 2.7171199321746826
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.8034954071044922
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 2.978825330734253
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.8215954303741455
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.009174346923828
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.908188581466675
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3042123317718506
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.675093412399292
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.900045394897461
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.4810218811035156
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.8119192123413086
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.181823968887329
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.1594290733337402
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.8726894855499268
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.0928359031677246
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 2.2799136638641357
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.5326287746429443
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.763183116912842
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.6773195266723633
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 3.027205228805542
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.896714448928833
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 2.5845415592193604
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 2.838860034942627
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 2.634383201599121
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.446735382080078
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0458219051361084
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.50588321685791
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.842376947402954
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.7513482570648193
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.186203956604004
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.475243091583252
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 2.756708860397339
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 3.3799386024475098
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.615480422973633
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.9639780521392822
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.444211959838867
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.6544837951660156
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.472787380218506
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.521308422088623
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.646428108215332
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.7489418983459473
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.907742738723755
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 2.7924327850341797
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 2.7663214206695557
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 2.3842806816101074
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 2.9349801540374756
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 2.3860228061676025
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 2.5977702140808105
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 2.4841065406799316
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.1534101963043213
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 2.5549638271331787
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 2.690659284591675
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 2.533055305480957
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 2.5700578689575195
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 2.2436628341674805
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.376884698867798
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.76261043548584
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.6164233684539795
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.235983371734619
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.4698634147644043
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.4419069290161133
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.9658408164978027
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 2.9738974571228027
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.5937888622283936
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 2.758608341217041
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 2.750377655029297
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.9579267501831055
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.4558260440826416
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.969714641571045
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.426647186279297
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.9680280685424805
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.9522533416748047
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 2.7623181343078613
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 2.8425490856170654
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 2.9467618465423584
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 1.9840013980865479
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.6570582389831543
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.688647508621216
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 2.9081673622131348
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 3.0597894191741943
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 2.9232890605926514
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 2.8345067501068115
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 2.5853869915008545
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 2.7303035259246826
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 2.7620134353637695
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 2.9819467067718506
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 2.9399306774139404
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 98 cost time: 3.136709451675415
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 2.8103599548339844
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 100 cost time: 2.9816441535949707
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1340296
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.642137050628662
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.493 Vali Acc: 0.069 Test Loss: 2.493 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 2.2810463905334473
Epoch: 2, Steps: 7 | Train Loss: 2.496 Vali Loss: 2.370 Vali Acc: 0.153 Test Loss: 2.370 Test Acc: 0.153
Validation loss decreased (-0.069420 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 2.1877214908599854
Epoch: 3, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.226 Vali Acc: 0.375 Test Loss: 2.226 Test Acc: 0.375
Validation loss decreased (-0.152754 --> -0.374978).  Saving model ...
Epoch: 4 cost time: 2.4028093814849854
Epoch: 4, Steps: 7 | Train Loss: 2.119 Vali Loss: 1.957 Vali Acc: 0.639 Test Loss: 1.957 Test Acc: 0.639
Validation loss decreased (-0.374978 --> -0.638869).  Saving model ...
Epoch: 5 cost time: 2.760683298110962
Epoch: 5, Steps: 7 | Train Loss: 1.782 Vali Loss: 1.554 Vali Acc: 0.625 Test Loss: 1.554 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.931011199951172
Epoch: 6, Steps: 7 | Train Loss: 1.273 Vali Loss: 1.111 Vali Acc: 0.792 Test Loss: 1.111 Test Acc: 0.792
Validation loss decreased (-0.638869 --> -0.791656).  Saving model ...
Epoch: 7 cost time: 3.1603281497955322
Epoch: 7, Steps: 7 | Train Loss: 0.743 Vali Loss: 0.727 Vali Acc: 0.903 Test Loss: 0.727 Test Acc: 0.903
Validation loss decreased (-0.791656 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 2.5067124366760254
Epoch: 8, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7190232276916504
Epoch: 9, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.377 Vali Acc: 0.931 Test Loss: 0.377 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 2.303995370864868
Epoch: 10, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.452803373336792
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 3.0162513256073
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.9572863578796387
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.2945823669433594
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.6781413555145264
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.376058340072632
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6885178089141846
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.6572721004486084
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 2.7274088859558105
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 2.5417375564575195
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 2.8231394290924072
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7309012413024902
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.686673879623413
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 2.7548699378967285
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 2.5857555866241455
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.617229461669922
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.621508836746216
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8636670112609863
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.741551399230957
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5765955448150635
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.235800266265869
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.293452739715576
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.3885748386383057
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 2.2340664863586426
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.507817506790161
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 2.4801008701324463
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.6293818950653076
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4864320755004883
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.6268303394317627
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.9521968364715576
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.814330577850342
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.770963430404663
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.982215166091919
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.7129571437835693
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.8880937099456787
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.554382801055908
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.5544159412384033
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.7123279571533203
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.5287623405456543
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 2.3884801864624023
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 2.406675338745117
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 2.9925074577331543
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.76016902923584
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.3849613666534424
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.61724853515625
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.64009428024292
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.815871238708496
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.671469211578369
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.790397882461548
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.5052106380462646
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.814131736755371
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1328264
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.590918779373169
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.471 Vali Acc: 0.069 Test Loss: 2.471 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 2.225689172744751
Epoch: 2, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.401 Vali Acc: 0.208 Test Loss: 2.401 Test Acc: 0.208
Validation loss decreased (-0.069420 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 2.4560282230377197
Epoch: 3, Steps: 7 | Train Loss: 2.375 Vali Loss: 2.270 Vali Acc: 0.389 Test Loss: 2.270 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 2.52506422996521
Epoch: 4, Steps: 7 | Train Loss: 2.123 Vali Loss: 2.046 Vali Acc: 0.556 Test Loss: 2.046 Test Acc: 0.556
Validation loss decreased (-0.388866 --> -0.555535).  Saving model ...
Epoch: 5 cost time: 2.112412929534912
Epoch: 5, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.679 Vali Acc: 0.556 Test Loss: 1.679 Test Acc: 0.556
Validation loss decreased (-0.555535 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 2.184023857116699
Epoch: 6, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.241 Vali Acc: 0.806 Test Loss: 1.241 Test Acc: 0.806
Validation loss decreased (-0.555539 --> -0.805543).  Saving model ...
Epoch: 7 cost time: 2.859740972518921
Epoch: 7, Steps: 7 | Train Loss: 0.879 Vali Loss: 0.828 Vali Acc: 0.861 Test Loss: 0.828 Test Acc: 0.861
Validation loss decreased (-0.805543 --> -0.861103).  Saving model ...
Epoch: 8 cost time: 2.135007619857788
Epoch: 8, Steps: 7 | Train Loss: 0.436 Vali Loss: 0.486 Vali Acc: 0.931 Test Loss: 0.486 Test Acc: 0.931
Validation loss decreased (-0.861103 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 2.5680465698242188
Epoch: 9, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 2.59234356880188
Epoch: 10, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.616854190826416
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.167208671569824
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.530989408493042
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.5880770683288574
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.2019240856170654
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4112091064453125
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 2.2257020473480225
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 2.174288272857666
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 2.4863100051879883
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 2.866133689880371
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.685049295425415
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 2.4521384239196777
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 2.862353801727295
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4286062717437744
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.559807300567627
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.005892276763916
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5558249950408936
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 2.4358105659484863
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 2.7036118507385254
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4571311473846436
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 2.3204567432403564
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.5519278049468994
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 2.316132068634033
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.9572830200195312
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6887824535369873
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 1.994072437286377
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 2.3780598640441895
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.6892476081848145
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.452561140060425
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.2681586742401123
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.003322124481201
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.6580147743225098
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.216542959213257
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.6352505683898926
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.512942314147949
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 2.8905999660491943
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 2.688399314880371
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.334670066833496
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 2.3312981128692627
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.805041551589966
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.3218936920166016
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.302258253097534
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.5579681396484375
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.7224841117858887
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 2.4657251834869385
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.8435170650482178
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.5053839683532715
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.4051148891448975
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.7103540897369385
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.462662696838379
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 2.20650315284729
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.4066224098205566
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.3691370487213135
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.2472963333129883
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 2.7017011642456055
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.9089462757110596
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 2.929457187652588
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 2.4989023208618164
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 2.3513784408569336
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 2.574920654296875
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1316232
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.850889205932617
Epoch: 1, Steps: 7 | Train Loss: 2.638 Vali Loss: 2.526 Vali Acc: 0.139 Test Loss: 2.526 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.9446027278900146
Epoch: 2, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.406 Vali Acc: 0.097 Test Loss: 2.406 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.181652307510376
Epoch: 3, Steps: 7 | Train Loss: 2.313 Vali Loss: 2.226 Vali Acc: 0.375 Test Loss: 2.226 Test Acc: 0.375
Validation loss decreased (-0.138864 --> -0.374978).  Saving model ...
Epoch: 4 cost time: 2.146291971206665
Epoch: 4, Steps: 7 | Train Loss: 2.112 Vali Loss: 2.000 Vali Acc: 0.528 Test Loss: 2.000 Test Acc: 0.528
Validation loss decreased (-0.374978 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 2.143763780593872
Epoch: 5, Steps: 7 | Train Loss: 1.740 Vali Loss: 1.596 Vali Acc: 0.722 Test Loss: 1.596 Test Acc: 0.722
Validation loss decreased (-0.527758 --> -0.722206).  Saving model ...
Epoch: 6 cost time: 2.030303478240967
Epoch: 6, Steps: 7 | Train Loss: 1.284 Vali Loss: 1.146 Vali Acc: 0.833 Test Loss: 1.146 Test Acc: 0.833
Validation loss decreased (-0.722206 --> -0.833322).  Saving model ...
Epoch: 7 cost time: 2.643928050994873
Epoch: 7, Steps: 7 | Train Loss: 0.773 Vali Loss: 0.827 Vali Acc: 0.847 Test Loss: 0.827 Test Acc: 0.847
Validation loss decreased (-0.833322 --> -0.847214).  Saving model ...
Epoch: 8 cost time: 2.2025983333587646
Epoch: 8, Steps: 7 | Train Loss: 0.434 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.2316370010375977
Epoch: 9, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 2.421724796295166
Epoch: 10, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 2.3813464641571045
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.374328851699829
Epoch: 12, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.6423702239990234
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5017929077148438
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9431653022766113
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.586404800415039
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.605379343032837
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.876131534576416
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.7883336544036865
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.6409502029418945
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.6932246685028076
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.623483657836914
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.735513210296631
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.619469404220581
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.4114692211151123
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.4055089950561523
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.4584476947784424
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.580573320388794
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 2.7244420051574707
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.7666873931884766
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 2.0469534397125244
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 2.8912947177886963
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 2.6358063220977783
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 2.7248897552490234
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 2.65617299079895
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.787787914276123
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.6485483646392822
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.3112804889678955
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9200429916381836
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.967360019683838
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.9572570323944092
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.8481323719024658
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.3777172565460205
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 2.5149149894714355
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 2.204078197479248
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.60390567779541
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.7190518379211426
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.1608541011810303
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.302900791168213
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.453014612197876
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.6747469902038574
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8833415508270264
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.5304393768310547
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.3182241916656494
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1055112
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.8229711055755615
Epoch: 1, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.499 Vali Acc: 0.069 Test Loss: 2.499 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.560105562210083
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.390 Vali Acc: 0.264 Test Loss: 2.390 Test Acc: 0.264
Validation loss decreased (-0.069419 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 2.2451040744781494
Epoch: 3, Steps: 7 | Train Loss: 2.317 Vali Loss: 2.233 Vali Acc: 0.444 Test Loss: 2.233 Test Acc: 0.444
Validation loss decreased (-0.263865 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 2.665191411972046
Epoch: 4, Steps: 7 | Train Loss: 2.019 Vali Loss: 1.961 Vali Acc: 0.556 Test Loss: 1.961 Test Acc: 0.556
Validation loss decreased (-0.444422 --> -0.555536).  Saving model ...
Epoch: 5 cost time: 2.1490182876586914
Epoch: 5, Steps: 7 | Train Loss: 1.658 Vali Loss: 1.522 Vali Acc: 0.750 Test Loss: 1.522 Test Acc: 0.750
Validation loss decreased (-0.555536 --> -0.749985).  Saving model ...
Epoch: 6 cost time: 3.3595356941223145
Epoch: 6, Steps: 7 | Train Loss: 1.151 Vali Loss: 1.082 Vali Acc: 0.778 Test Loss: 1.082 Test Acc: 0.778
Validation loss decreased (-0.749985 --> -0.777767).  Saving model ...
Epoch: 7 cost time: 2.876455783843994
Epoch: 7, Steps: 7 | Train Loss: 0.643 Vali Loss: 0.710 Vali Acc: 0.903 Test Loss: 0.710 Test Acc: 0.903
Validation loss decreased (-0.777767 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 2.761199474334717
Epoch: 8, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.61989688873291
Epoch: 9, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.994213581085205
Epoch: 10, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.6781117916107178
Epoch: 11, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.590927839279175
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.6239185333251953
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.084017038345337
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9091882705688477
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6091315746307373
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.322597026824951
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.163675308227539
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.3617444038391113
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.5394959449768066
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 2.5165491104125977
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4372506141662598
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.406473159790039
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 2.402834892272949
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 2.276477813720703
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 2.722196578979492
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 2.708203077316284
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 2.5400640964508057
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.52089524269104
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.666515827178955
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.1680829524993896
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.6300840377807617
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.559088945388794
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 2.4177396297454834
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.5289487838745117
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.505223274230957
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 2.185663938522339
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 2.7513644695281982
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.4018332958221436
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 2.2236690521240234
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 2.3595938682556152
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 2.4515066146850586
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.480635166168213
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 2.1756930351257324
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.7495815753936768
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 2.906916618347168
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.9339990615844727
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.0725491046905518
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.693942070007324
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.0324978828430176
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 2.278681755065918
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.883394241333008
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 2.762920379638672
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 2.9653708934783936
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.8051321506500244
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.0497450828552246
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.43456768989563
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 2.2923521995544434
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 2.263798236846924
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.089590311050415
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.339138984680176
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.5543911457061768
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 2.5640406608581543
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.494276762008667
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 1.868213176727295
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.270704984664917
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.623382568359375
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.5909178256988525
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.2528598308563232
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.2887279987335205
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 3.1816582679748535
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.822066307067871
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 3.131232738494873
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 3.1135215759277344
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1043080
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.789651155471802
Epoch: 1, Steps: 7 | Train Loss: 2.654 Vali Loss: 2.540 Vali Acc: 0.069 Test Loss: 2.540 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.131075143814087
Epoch: 2, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.405 Vali Acc: 0.167 Test Loss: 2.405 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.654892921447754
Epoch: 3, Steps: 7 | Train Loss: 2.409 Vali Loss: 2.294 Vali Acc: 0.264 Test Loss: 2.294 Test Acc: 0.264
Validation loss decreased (-0.166643 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 2.4898808002471924
Epoch: 4, Steps: 7 | Train Loss: 2.207 Vali Loss: 2.092 Vali Acc: 0.611 Test Loss: 2.092 Test Acc: 0.611
Validation loss decreased (-0.263866 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 2.3050343990325928
Epoch: 5, Steps: 7 | Train Loss: 1.914 Vali Loss: 1.788 Vali Acc: 0.569 Test Loss: 1.788 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.137730121612549
Epoch: 6, Steps: 7 | Train Loss: 1.600 Vali Loss: 1.411 Vali Acc: 0.639 Test Loss: 1.411 Test Acc: 0.639
Validation loss decreased (-0.611090 --> -0.638875).  Saving model ...
Epoch: 7 cost time: 2.7988035678863525
Epoch: 7, Steps: 7 | Train Loss: 1.055 Vali Loss: 0.975 Vali Acc: 0.833 Test Loss: 0.975 Test Acc: 0.833
Validation loss decreased (-0.638875 --> -0.833324).  Saving model ...
Epoch: 8 cost time: 2.5649056434631348
Epoch: 8, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.650 Vali Acc: 0.847 Test Loss: 0.650 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847216).  Saving model ...
Epoch: 9 cost time: 2.7016148567199707
Epoch: 9, Steps: 7 | Train Loss: 0.311 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 2.3881592750549316
Epoch: 10, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 2.743058919906616
Epoch: 11, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 2.467700481414795
Epoch: 12, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.239760398864746
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.6467490196228027
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.3065614700317383
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.6370012760162354
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.8456926345825195
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.671708583831787
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.612577199935913
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 2.2642176151275635
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 2.2302792072296143
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 2.32846736907959
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 1.9512488842010498
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.3253307342529297
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 2.5622267723083496
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.5828285217285156
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.9757633209228516
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.4774444103240967
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6653501987457275
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.659531354904175
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.379931688308716
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 2.0360991954803467
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.3411953449249268
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.4525294303894043
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.5854876041412354
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 2.662558078765869
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2710962295532227
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.248279571533203
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 2.14093017578125
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 2.1707842350006104
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 2.25388240814209
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.6241707801818848
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 2.7416164875030518
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 2.502977132797241
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 2.6325721740722656
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 2.3722405433654785
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 2.5317509174346924
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.5294930934906006
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 2.583742618560791
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 2.5011253356933594
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 2.5630462169647217
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 2.6333889961242676
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 2.662766456604004
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 2.184938430786133
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 2.656764030456543
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.7951698303222656
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 2.4439122676849365
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.4492392539978027
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.5190491676330566
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 2.405231475830078
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 2.803846597671509
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.320366144180298
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.4411566257476807
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 2.114169120788574
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 2.100933313369751
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 2.482156276702881
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 2.51934814453125
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 2.713425397872925
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 2.245267868041992
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.3778910636901855
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 2.264779567718506
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 2.423102617263794
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.32991361618042
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 2.5091004371643066
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 2.106081962585449
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.5205836296081543
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.3463191986083984
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.320408821105957
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 2.2002665996551514
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.0820319652557373
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 2.2108609676361084
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 2.08125376701355
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 83 cost time: 1.9887781143188477
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.522692918777466
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.8050084114074707
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 2.3740358352661133
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 2.5867955684661865
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.265923500061035
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 2.3644938468933105
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.990560293197632
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 2.8711998462677
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 2.9278762340545654
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 2.7070438861846924
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 2.2031426429748535
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 2.781827449798584
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 2.4535181522369385
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 2.6429030895233154
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 2.287468194961548
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1031048
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.065801382064819
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.501 Vali Acc: 0.056 Test Loss: 2.501 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 2.4555578231811523
Epoch: 2, Steps: 7 | Train Loss: 2.432 Vali Loss: 2.333 Vali Acc: 0.194 Test Loss: 2.333 Test Acc: 0.194
Validation loss decreased (-0.055531 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.109083652496338
Epoch: 3, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.177 Vali Acc: 0.361 Test Loss: 2.177 Test Acc: 0.361
Validation loss decreased (-0.194421 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 2.5172152519226074
Epoch: 4, Steps: 7 | Train Loss: 2.015 Vali Loss: 1.844 Vali Acc: 0.597 Test Loss: 1.844 Test Acc: 0.597
Validation loss decreased (-0.361089 --> -0.597204).  Saving model ...
Epoch: 5 cost time: 2.019683361053467
Epoch: 5, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.410 Vali Acc: 0.722 Test Loss: 1.410 Test Acc: 0.722
Validation loss decreased (-0.597204 --> -0.722208).  Saving model ...
Epoch: 6 cost time: 2.4315950870513916
Epoch: 6, Steps: 7 | Train Loss: 1.044 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
Validation loss decreased (-0.722208 --> -0.833324).  Saving model ...
Epoch: 7 cost time: 2.6741626262664795
Epoch: 7, Steps: 7 | Train Loss: 0.638 Vali Loss: 0.706 Vali Acc: 0.847 Test Loss: 0.706 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 2.425171375274658
Epoch: 8, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.5004587173461914
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 2.807621955871582
Epoch: 10, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.9217000007629395
Epoch: 11, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5262563228607178
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4631710052490234
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.009169578552246
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.9744548797607422
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.790708303451538
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 2.472677707672119
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.8529894351959229
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 1.9396190643310547
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 2.392742395401001
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 2.0809152126312256
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.884439468383789
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 2.028877019882202
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 1.8640103340148926
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 2.2965872287750244
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 2.2060396671295166
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 2.3376362323760986
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.491821050643921
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.891855001449585
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.5212972164154053
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.42849063873291
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2150447368621826
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.667433261871338
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9527666568756104
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.4908552169799805
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 2.39817476272583
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.6506669521331787
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 2.1856086254119873
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.499333381652832
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 2.026048421859741
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 2.1033260822296143
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 2.3066327571868896
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.9364471435546875
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.2147207260131836
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0085198879241943
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 2.5334408283233643
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 2.365734577178955
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.6199774742126465
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.5053870677948
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 2.4327280521392822
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9580702781677246
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.018413543701172
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.9119312763214111
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 2.041472911834717
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 2.066570520401001
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 2.0144026279449463
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.5068435668945312
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.4578864574432373
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.1187727451324463
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.6311047077178955
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.4015917778015137
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 1.9659476280212402
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.5167689323425293
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.2515501976013184
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.2229766845703125
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.3870656490325928
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.523263454437256
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 2.261099338531494
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.6489789485931396
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.242272138595581
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 2.302419900894165
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1019016
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.162654399871826
Epoch: 1, Steps: 7 | Train Loss: 2.756 Vali Loss: 2.525 Vali Acc: 0.111 Test Loss: 2.525 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.6597065925598145
Epoch: 2, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.466 Vali Acc: 0.222 Test Loss: 2.466 Test Acc: 0.222
Validation loss decreased (-0.111086 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 2.793025493621826
Epoch: 3, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.316 Vali Acc: 0.264 Test Loss: 2.316 Test Acc: 0.264
Validation loss decreased (-0.222198 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 2.6102333068847656
Epoch: 4, Steps: 7 | Train Loss: 2.215 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
Validation loss decreased (-0.263866 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 2.637676239013672
Epoch: 5, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.745 Vali Acc: 0.681 Test Loss: 1.745 Test Acc: 0.681
Validation loss decreased (-0.499980 --> -0.680538).  Saving model ...
Epoch: 6 cost time: 2.043710947036743
Epoch: 6, Steps: 7 | Train Loss: 1.493 Vali Loss: 1.353 Vali Acc: 0.778 Test Loss: 1.353 Test Acc: 0.778
Validation loss decreased (-0.680538 --> -0.777764).  Saving model ...
Epoch: 7 cost time: 2.7223093509674072
Epoch: 7, Steps: 7 | Train Loss: 1.035 Vali Loss: 0.949 Vali Acc: 0.875 Test Loss: 0.949 Test Acc: 0.875
Validation loss decreased (-0.777764 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 2.4441564083099365
Epoch: 8, Steps: 7 | Train Loss: 0.597 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 9 cost time: 2.4508919715881348
Epoch: 9, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 1.9935235977172852
Epoch: 10, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4608237743377686
Epoch: 11, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.242447853088379
Epoch: 12, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4797658920288086
Epoch: 13, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.368190050125122
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.011888265609741
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.9968860149383545
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.465333938598633
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.382204055786133
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4520456790924072
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.217827796936035
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 2.5300145149230957
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 2.4345412254333496
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 2.4137895107269287
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 1.8496880531311035
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9189693927764893
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.9793052673339844
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 2.508989095687866
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 2.127283811569214
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0421745777130127
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.688040256500244
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.5738561153411865
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7453300952911377
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.5582566261291504
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 2.9344449043273926
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.588355302810669
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 2.915703296661377
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 2.4277143478393555
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 2.7948811054229736
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.3721611499786377
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 2.539806365966797
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.5322465896606445
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.764601230621338
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.508206367492676
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.6173324584960938
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 2.3968865871429443
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 2.5009968280792236
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 2.0247671604156494
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.5092897415161133
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.711787462234497
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.6965866088867188
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.664032220840454
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.5878117084503174
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.4571993350982666
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 2.5251245498657227
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8140456676483154
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.5257890224456787
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.580476999282837
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.525536298751831
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.453737497329712
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.888841152191162
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.7543892860412598
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.9053139686584473
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.489203691482544
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 906504
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.61465048789978
Epoch: 1, Steps: 7 | Train Loss: 2.708 Vali Loss: 2.521 Vali Acc: 0.056 Test Loss: 2.521 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 2.22672963142395
Epoch: 2, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.445 Vali Acc: 0.125 Test Loss: 2.445 Test Acc: 0.125
Validation loss decreased (-0.055530 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.9209630489349365
Epoch: 3, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.330 Vali Acc: 0.097 Test Loss: 2.330 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.905926465988159
Epoch: 4, Steps: 7 | Train Loss: 2.207 Vali Loss: 2.113 Vali Acc: 0.431 Test Loss: 2.113 Test Acc: 0.431
Validation loss decreased (-0.124976 --> -0.430534).  Saving model ...
Epoch: 5 cost time: 2.4346089363098145
Epoch: 5, Steps: 7 | Train Loss: 1.982 Vali Loss: 1.852 Vali Acc: 0.583 Test Loss: 1.852 Test Acc: 0.583
Validation loss decreased (-0.430534 --> -0.583315).  Saving model ...
Epoch: 6 cost time: 1.774066686630249
Epoch: 6, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.445 Vali Acc: 0.778 Test Loss: 1.445 Test Acc: 0.778
Validation loss decreased (-0.583315 --> -0.777763).  Saving model ...
Epoch: 7 cost time: 2.439237356185913
Epoch: 7, Steps: 7 | Train Loss: 1.125 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
Validation loss decreased (-0.777763 --> -0.861101).  Saving model ...
Epoch: 8 cost time: 2.501131534576416
Epoch: 8, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.712 Vali Acc: 0.819 Test Loss: 0.712 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6674716472625732
Epoch: 9, Steps: 7 | Train Loss: 0.339 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.861101 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 2.816002130508423
Epoch: 10, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7182111740112305
Epoch: 11, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7363269329071045
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.371601104736328
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.1197454929351807
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.7844624519348145
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 3.189531087875366
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0506222248077393
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.066910743713379
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.257265090942383
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.5362722873687744
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.2160308361053467
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.9507222175598145
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.15895414352417
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.9206762313842773
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.9896578788757324
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.9043407440185547
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7379846572875977
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4503490924835205
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3163046836853027
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1656455993652344
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0651116371154785
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 2.08549165725708
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 2.122544050216675
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.112396001815796
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 2.352354049682617
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.5580711364746094
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.5394866466522217
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.312507390975952
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.5386962890625
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.5062320232391357
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 2.7459726333618164
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 2.6453633308410645
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.9989981651306152
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.6527633666992188
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.2979843616485596
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.5691957473754883
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 2.8099184036254883
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.7956900596618652
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.14526629447937
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 2.240105628967285
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 2.2073636054992676
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 2.533978223800659
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.3221747875213623
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.441667318344116
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.6893091201782227
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.5018742084503174
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 2.203993320465088
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 2.684842109680176
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 2.318986177444458
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 2.011617660522461
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 2.332732677459717
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 1.9620933532714844
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.9032142162322998
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.087038278579712
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.2058470249176025
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.3620712757110596
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.2566044330596924
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 2.5475666522979736
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.511295795440674
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.8853812217712402
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 2.417201042175293
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 2.387289047241211
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.5034356117248535
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 2.437011480331421
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 2.2246761322021484
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.122659683227539
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.5339279174804688
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.6353020668029785
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 2.4986300468444824
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.1991405487060547
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.4385898113250732
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 2.121309995651245
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 2.359609842300415
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 2.600825786590576
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 894472
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.939279794692993
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.442 Vali Acc: 0.181 Test Loss: 2.442 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.2956483364105225
Epoch: 2, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.351 Vali Acc: 0.181 Test Loss: 2.351 Test Acc: 0.181
Validation loss decreased (-0.180531 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 2.661234140396118
Epoch: 3, Steps: 7 | Train Loss: 2.314 Vali Loss: 2.148 Vali Acc: 0.319 Test Loss: 2.148 Test Acc: 0.319
Validation loss decreased (-0.180532 --> -0.319423).  Saving model ...
Epoch: 4 cost time: 2.233328342437744
Epoch: 4, Steps: 7 | Train Loss: 2.069 Vali Loss: 1.840 Vali Acc: 0.694 Test Loss: 1.840 Test Acc: 0.694
Validation loss decreased (-0.319423 --> -0.694426).  Saving model ...
Epoch: 5 cost time: 2.2899882793426514
Epoch: 5, Steps: 7 | Train Loss: 1.724 Vali Loss: 1.475 Vali Acc: 0.861 Test Loss: 1.475 Test Acc: 0.861
Validation loss decreased (-0.694426 --> -0.861096).  Saving model ...
Epoch: 6 cost time: 2.334239959716797
Epoch: 6, Steps: 7 | Train Loss: 1.278 Vali Loss: 1.122 Vali Acc: 0.736 Test Loss: 1.122 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6077041625976562
Epoch: 7, Steps: 7 | Train Loss: 0.774 Vali Loss: 0.717 Vali Acc: 0.903 Test Loss: 0.717 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 2.287942409515381
Epoch: 8, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 2.454254150390625
Epoch: 9, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.375176191329956
Epoch: 10, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.121828079223633
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6024792194366455
Epoch: 12, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.5146915912628174
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.9449143409729004
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.9588663578033447
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3736391067504883
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.562922477722168
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.1667680740356445
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.3728089332580566
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.3354454040527344
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.192692756652832
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.428605079650879
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.069072961807251
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.69046688079834
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.2991650104522705
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 2.189972162246704
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.330035924911499
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.5881316661834717
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.5523505210876465
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.4690918922424316
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.5139899253845215
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.1748526096343994
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.2642014026641846
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 2.0597281455993652
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.3905723094940186
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8849332332611084
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 1.913649559020996
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.21846866607666
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.577949047088623
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 1.8580915927886963
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.238246440887451
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.5663163661956787
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.6612958908081055
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 2.275869846343994
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 1.9690186977386475
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 2.1826207637786865
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 2.331901788711548
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.051405429840088
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.411025047302246
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 2.5746378898620605
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.2967307567596436
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.60842227935791
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.266950845718384
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.3584587574005127
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 2.368724822998047
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 2.5979249477386475
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.422701835632324
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.527648687362671
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 2.6215460300445557
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 2.5508334636688232
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 2.324079990386963
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 2.0741965770721436
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.365898609161377
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 2.854475975036621
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 2.8181276321411133
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 2.4740922451019287
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 2.844557285308838
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.071258068084717
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.612886905670166
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 2.6539804935455322
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.270341157913208
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.355619192123413
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.987701416015625
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.9220924377441406
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 2.4146499633789062
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 2.753736734390259
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 2.0030767917633057
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 2.313603639602661
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 2.5499072074890137
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 2.6344408988952637
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 2.633871078491211
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.9780678749084473
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 2.129598379135132
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.7193548679351807
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.362111806869507
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 2.4313371181488037
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 2.5257601737976074
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.81874418258667
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 2.813443660736084
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 2.205608606338501
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 2.3699212074279785
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 2.190937042236328
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 2.5430538654327393
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 2.459949493408203
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 2.5809731483459473
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 2.411264181137085
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 97 cost time: 2.2907004356384277
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.270151376724243
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.538607120513916
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 2.1017391681671143
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 882440
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.468157529830933
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.459 Vali Acc: 0.181 Test Loss: 2.459 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.3250925540924072
Epoch: 2, Steps: 7 | Train Loss: 2.402 Vali Loss: 2.305 Vali Acc: 0.208 Test Loss: 2.305 Test Acc: 0.208
Validation loss decreased (-0.180531 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 2.2332985401153564
Epoch: 3, Steps: 7 | Train Loss: 2.311 Vali Loss: 2.157 Vali Acc: 0.458 Test Loss: 2.157 Test Acc: 0.458
Validation loss decreased (-0.208310 --> -0.458312).  Saving model ...
Epoch: 4 cost time: 1.7214820384979248
Epoch: 4, Steps: 7 | Train Loss: 2.053 Vali Loss: 1.848 Vali Acc: 0.597 Test Loss: 1.848 Test Acc: 0.597
Validation loss decreased (-0.458312 --> -0.597204).  Saving model ...
Epoch: 5 cost time: 2.156703472137451
Epoch: 5, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.480 Vali Acc: 0.806 Test Loss: 1.480 Test Acc: 0.806
Validation loss decreased (-0.597204 --> -0.805541).  Saving model ...
Epoch: 6 cost time: 1.9286394119262695
Epoch: 6, Steps: 7 | Train Loss: 1.178 Vali Loss: 1.044 Vali Acc: 0.764 Test Loss: 1.044 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.136141777038574
Epoch: 7, Steps: 7 | Train Loss: 0.669 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
Validation loss decreased (-0.805541 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 1.9062836170196533
Epoch: 8, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 2.4100098609924316
Epoch: 9, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 2.0855331420898438
Epoch: 10, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 2.227067232131958
Epoch: 11, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3052730560302734
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9838271141052246
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.408189058303833
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8367013931274414
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6710195541381836
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4095911979675293
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.219860553741455
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.2904090881347656
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.3128836154937744
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.176575183868408
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.106829881668091
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.9227790832519531
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7777776718139648
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9642586708068848
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3975179195404053
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.214782238006592
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.149711847305298
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.258288621902466
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.4045212268829346
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 2.1967239379882812
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 1.9546489715576172
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.2127621173858643
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2843878269195557
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 2.1329638957977295
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 2.3458657264709473
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1840720176696777
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1235342025756836
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6555798053741455
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 2.5003914833068848
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 2.2396678924560547
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 1.8509724140167236
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.098076820373535
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.3704912662506104
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.153904914855957
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 2.5250842571258545
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 2.4143176078796387
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.276021718978882
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.3321735858917236
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.3466789722442627
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8457276821136475
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 2.4747180938720703
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 2.0449697971343994
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 1.9221489429473877
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 2.6399004459381104
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.233994722366333
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.5663676261901855
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.2021074295043945
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 2.2196009159088135
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.3370330333709717
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.270501136779785
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.4643869400024414
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.310526132583618
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 2.4437432289123535
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 2.3549420833587646
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 2.278149127960205
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 2.195812940597534
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 2.40073299407959
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 2.0655863285064697
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 1.993713140487671
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6481704711914062
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 1.494964599609375
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 1.656128168106079
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 2.134058713912964
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.8678724765777588
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.7555346488952637
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.384955406188965
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.22061824798584
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 2.1590046882629395
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 2.226210594177246
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.9546988010406494
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 2.379621744155884
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 2.198331117630005
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 870408
model size : 4.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.4560546875
Epoch: 1, Steps: 7 | Train Loss: 2.708 Vali Loss: 2.624 Vali Acc: 0.097 Test Loss: 2.624 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 1.897465467453003
Epoch: 2, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.432 Vali Acc: 0.125 Test Loss: 2.432 Test Acc: 0.125
Validation loss decreased (-0.097196 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.1804001331329346
Epoch: 3, Steps: 7 | Train Loss: 2.391 Vali Loss: 2.328 Vali Acc: 0.264 Test Loss: 2.328 Test Acc: 0.264
Validation loss decreased (-0.124976 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 2.3150336742401123
Epoch: 4, Steps: 7 | Train Loss: 2.250 Vali Loss: 2.142 Vali Acc: 0.431 Test Loss: 2.142 Test Acc: 0.431
Validation loss decreased (-0.263866 --> -0.430534).  Saving model ...
Epoch: 5 cost time: 1.9417994022369385
Epoch: 5, Steps: 7 | Train Loss: 1.994 Vali Loss: 1.853 Vali Acc: 0.611 Test Loss: 1.853 Test Acc: 0.611
Validation loss decreased (-0.430534 --> -0.611093).  Saving model ...
Epoch: 6 cost time: 2.396899700164795
Epoch: 6, Steps: 7 | Train Loss: 1.607 Vali Loss: 1.519 Vali Acc: 0.694 Test Loss: 1.519 Test Acc: 0.694
Validation loss decreased (-0.611093 --> -0.694429).  Saving model ...
Epoch: 7 cost time: 2.6127328872680664
Epoch: 7, Steps: 7 | Train Loss: 1.217 Vali Loss: 1.178 Vali Acc: 0.722 Test Loss: 1.178 Test Acc: 0.722
Validation loss decreased (-0.694429 --> -0.722210).  Saving model ...
Epoch: 8 cost time: 2.2726776599884033
Epoch: 8, Steps: 7 | Train Loss: 0.832 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.722210 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 2.8044445514678955
Epoch: 9, Steps: 7 | Train Loss: 0.552 Vali Loss: 0.718 Vali Acc: 0.833 Test Loss: 0.718 Test Acc: 0.833
Validation loss decreased (-0.749991 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 2.7304296493530273
Epoch: 10, Steps: 7 | Train Loss: 0.356 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 2.390146255493164
Epoch: 11, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 2.202744722366333
Epoch: 12, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.451 Vali Acc: 0.847 Test Loss: 0.451 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3465940952301025
Epoch: 13, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.4517009258270264
Epoch: 14, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 2.3217437267303467
Epoch: 15, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 2.520416021347046
Epoch: 16, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 2.2466557025909424
Epoch: 17, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.223379373550415
Epoch: 18, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.9712755680084229
Epoch: 19, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.1403510570526123
Epoch: 20, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.062302350997925
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.1591789722442627
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.413611650466919
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.799626350402832
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.19016432762146
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.9155941009521484
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.9578161239624023
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.6751680374145508
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.1285953521728516
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.1625139713287354
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8273732662200928
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 2.2517805099487305
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.9744596481323242
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.4927024841308594
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 2.6965231895446777
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 2.2398433685302734
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.4120805263519287
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.119812250137329
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 2.0192513465881348
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.516758441925049
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.8876378536224365
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.54600191116333
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0317864418029785
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.6720800399780273
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.3352792263031006
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.3253750801086426
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.2552669048309326
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.249610424041748
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.200496196746826
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.6069228649139404
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.842351198196411
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 830568
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.222071409225464
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.498 Vali Acc: 0.083 Test Loss: 2.498 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.0942816734313965
Epoch: 2, Steps: 7 | Train Loss: 2.542 Vali Loss: 2.424 Vali Acc: 0.139 Test Loss: 2.424 Test Acc: 0.139
Validation loss decreased (-0.083308 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 2.020219087600708
Epoch: 3, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.362 Vali Acc: 0.194 Test Loss: 2.362 Test Acc: 0.194
Validation loss decreased (-0.138865 --> -0.194421).  Saving model ...
Epoch: 4 cost time: 2.5292954444885254
Epoch: 4, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.192 Vali Acc: 0.375 Test Loss: 2.192 Test Acc: 0.375
Validation loss decreased (-0.194421 --> -0.374978).  Saving model ...
Epoch: 5 cost time: 2.063896656036377
Epoch: 5, Steps: 7 | Train Loss: 2.066 Vali Loss: 1.930 Vali Acc: 0.514 Test Loss: 1.930 Test Acc: 0.514
Validation loss decreased (-0.374978 --> -0.513870).  Saving model ...
Epoch: 6 cost time: 2.0978617668151855
Epoch: 6, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.583 Vali Acc: 0.611 Test Loss: 1.583 Test Acc: 0.611
Validation loss decreased (-0.513870 --> -0.611095).  Saving model ...
Epoch: 7 cost time: 2.2933924198150635
Epoch: 7, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.206 Vali Acc: 0.792 Test Loss: 1.206 Test Acc: 0.792
Validation loss decreased (-0.611095 --> -0.791655).  Saving model ...
Epoch: 8 cost time: 2.1764254570007324
Epoch: 8, Steps: 7 | Train Loss: 0.840 Vali Loss: 0.877 Vali Acc: 0.875 Test Loss: 0.877 Test Acc: 0.875
Validation loss decreased (-0.791655 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 1.9817044734954834
Epoch: 9, Steps: 7 | Train Loss: 0.534 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2636234760284424
Epoch: 10, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 2.091280460357666
Epoch: 11, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2911906242370605
Epoch: 12, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.999772071838379
Epoch: 13, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 2.054474353790283
Epoch: 14, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2510569095611572
Epoch: 15, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3368611335754395
Epoch: 16, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.399820566177368
Epoch: 17, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.350099802017212
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9700984954833984
Epoch: 19, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.440234661102295
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.2290215492248535
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.8860859870910645
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.8985047340393066
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.0262644290924072
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.83150315284729
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.7574222087860107
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0992603302001953
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4075429439544678
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.250783681869507
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.1569674015045166
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.4674510955810547
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.902585744857788
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.0449728965759277
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.4085869789123535
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9646639823913574
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.743983507156372
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.300607442855835
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.063033103942871
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2024872303009033
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 2.6572446823120117
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9337196350097656
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.236323356628418
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9154102802276611
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 2.506173849105835
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.456610679626465
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1238582134246826
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.6457195281982422
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.9812700748443604
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.170459508895874
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 2.3499488830566406
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.208036184310913
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.3769006729125977
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.324732780456543
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.505925178527832
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.1448469161987305
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.343553304672241
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 2.215571403503418
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.022737503051758
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.1122968196868896
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.289546489715576
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 2.1976428031921387
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.448887586593628
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 2.206843614578247
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 2.2979161739349365
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.0906620025634766
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.046144723892212
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.387110710144043
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.1700642108917236
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.447662115097046
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.7428271770477295
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.1485586166381836
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.0915889739990234
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.9474310874938965
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 824552
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.5751588344573975
Epoch: 1, Steps: 7 | Train Loss: 2.684 Vali Loss: 2.519 Vali Acc: 0.111 Test Loss: 2.519 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.8266935348510742
Epoch: 2, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.400 Vali Acc: 0.236 Test Loss: 2.400 Test Acc: 0.236
Validation loss decreased (-0.111086 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 2.2272706031799316
Epoch: 3, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.308 Vali Acc: 0.264 Test Loss: 2.308 Test Acc: 0.264
Validation loss decreased (-0.236087 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 2.252863883972168
Epoch: 4, Steps: 7 | Train Loss: 2.256 Vali Loss: 2.131 Vali Acc: 0.431 Test Loss: 2.131 Test Acc: 0.431
Validation loss decreased (-0.263866 --> -0.430534).  Saving model ...
Epoch: 5 cost time: 2.0370311737060547
Epoch: 5, Steps: 7 | Train Loss: 2.049 Vali Loss: 1.897 Vali Acc: 0.528 Test Loss: 1.897 Test Acc: 0.528
Validation loss decreased (-0.430534 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 2.393984317779541
Epoch: 6, Steps: 7 | Train Loss: 1.723 Vali Loss: 1.568 Vali Acc: 0.681 Test Loss: 1.568 Test Acc: 0.681
Validation loss decreased (-0.527759 --> -0.680540).  Saving model ...
Epoch: 7 cost time: 2.362710952758789
Epoch: 7, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.186 Vali Acc: 0.764 Test Loss: 1.186 Test Acc: 0.764
Validation loss decreased (-0.680540 --> -0.763877).  Saving model ...
Epoch: 8 cost time: 2.1348612308502197
Epoch: 8, Steps: 7 | Train Loss: 0.934 Vali Loss: 0.920 Vali Acc: 0.889 Test Loss: 0.920 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888880).  Saving model ...
Epoch: 9 cost time: 2.0092732906341553
Epoch: 9, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.687 Vali Acc: 0.917 Test Loss: 0.687 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 2.0713376998901367
Epoch: 10, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9441072940826416
Epoch: 11, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 1.841336727142334
Epoch: 12, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 2.148010730743408
Epoch: 13, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1942999362945557
Epoch: 14, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.8409733772277832
Epoch: 15, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.0228934288024902
Epoch: 16, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8835434913635254
Epoch: 17, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.551447868347168
Epoch: 18, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9820330142974854
Epoch: 19, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0286333560943604
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1666300296783447
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8401787281036377
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.008211612701416
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.9206976890563965
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8662347793579102
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.563772201538086
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.209094524383545
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2795372009277344
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9376046657562256
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0355148315429688
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 2.1262118816375732
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4001636505126953
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.631532907485962
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.188161611557007
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3514394760131836
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 2.1060245037078857
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.997901439666748
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.039579153060913
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.053370237350464
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0996029376983643
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1914777755737305
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.8586633205413818
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.668703556060791
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9781060218811035
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8976082801818848
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.222005605697632
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.8619070053100586
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8531019687652588
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.0292184352874756
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.204501152038574
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.2604594230651855
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.0596249103546143
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.0911784172058105
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.2835958003997803
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.7381911277770996
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.2110164165496826
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 818536
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.648213148117065
Epoch: 1, Steps: 7 | Train Loss: 2.696 Vali Loss: 2.591 Vali Acc: 0.097 Test Loss: 2.591 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 2.181344509124756
Epoch: 2, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.458 Vali Acc: 0.125 Test Loss: 2.458 Test Acc: 0.125
Validation loss decreased (-0.097196 --> -0.124975).  Saving model ...
Epoch: 3 cost time: 1.9914937019348145
Epoch: 3, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.383 Vali Acc: 0.306 Test Loss: 2.383 Test Acc: 0.306
Validation loss decreased (-0.124975 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 2.0787718296051025
Epoch: 4, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.224 Vali Acc: 0.403 Test Loss: 2.224 Test Acc: 0.403
Validation loss decreased (-0.305532 --> -0.402756).  Saving model ...
Epoch: 5 cost time: 2.1661226749420166
Epoch: 5, Steps: 7 | Train Loss: 2.096 Vali Loss: 2.031 Vali Acc: 0.472 Test Loss: 2.031 Test Acc: 0.472
Validation loss decreased (-0.402756 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 1.851320743560791
Epoch: 6, Steps: 7 | Train Loss: 1.809 Vali Loss: 1.731 Vali Acc: 0.722 Test Loss: 1.731 Test Acc: 0.722
Validation loss decreased (-0.472202 --> -0.722205).  Saving model ...
Epoch: 7 cost time: 1.835170030593872
Epoch: 7, Steps: 7 | Train Loss: 1.461 Vali Loss: 1.333 Vali Acc: 0.778 Test Loss: 1.333 Test Acc: 0.778
Validation loss decreased (-0.722205 --> -0.777764).  Saving model ...
Epoch: 8 cost time: 1.9374268054962158
Epoch: 8, Steps: 7 | Train Loss: 1.034 Vali Loss: 1.021 Vali Acc: 0.847 Test Loss: 1.021 Test Acc: 0.847
Validation loss decreased (-0.777764 --> -0.847212).  Saving model ...
Epoch: 9 cost time: 2.0423171520233154
Epoch: 9, Steps: 7 | Train Loss: 0.723 Vali Loss: 0.793 Vali Acc: 0.861 Test Loss: 0.793 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861103).  Saving model ...
Epoch: 10 cost time: 2.2190582752227783
Epoch: 10, Steps: 7 | Train Loss: 0.446 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 1.7874443531036377
Epoch: 11, Steps: 7 | Train Loss: 0.276 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 1.750180959701538
Epoch: 12, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9447808265686035
Epoch: 13, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0395925045013428
Epoch: 14, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.763340950012207
Epoch: 15, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 1.9415655136108398
Epoch: 16, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 2.193997621536255
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.8942811489105225
Epoch: 18, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.043187141418457
Epoch: 19, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1746082305908203
Epoch: 20, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8932948112487793
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2770934104919434
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.167630195617676
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.165224313735962
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9048283100128174
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.15645432472229
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.906693458557129
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.9029674530029297
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.8572087287902832
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.843703269958496
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.9339466094970703
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.219545364379883
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.9831392765045166
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.042310953140259
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.141493558883667
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 2.264096975326538
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.164747953414917
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.8782567977905273
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 2.1599628925323486
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.731475830078125
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.234753370285034
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.817080020904541
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.930776834487915
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.0771172046661377
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.068143844604492
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.049633502960205
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.6745965480804443
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.9282896518707275
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 812520
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.290379285812378
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.562 Vali Acc: 0.069 Test Loss: 2.562 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.491971492767334
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.472 Vali Acc: 0.083 Test Loss: 2.472 Test Acc: 0.083
Validation loss decreased (-0.069419 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 2.2104196548461914
Epoch: 3, Steps: 7 | Train Loss: 2.351 Vali Loss: 2.365 Vali Acc: 0.278 Test Loss: 2.365 Test Acc: 0.278
Validation loss decreased (-0.083309 --> -0.277754).  Saving model ...
Epoch: 4 cost time: 2.609156847000122
Epoch: 4, Steps: 7 | Train Loss: 2.211 Vali Loss: 2.202 Vali Acc: 0.361 Test Loss: 2.202 Test Acc: 0.361
Validation loss decreased (-0.277754 --> -0.361089).  Saving model ...
Epoch: 5 cost time: 2.1642212867736816
Epoch: 5, Steps: 7 | Train Loss: 2.004 Vali Loss: 1.960 Vali Acc: 0.542 Test Loss: 1.960 Test Acc: 0.542
Validation loss decreased (-0.361089 --> -0.541647).  Saving model ...
Epoch: 6 cost time: 2.0203514099121094
Epoch: 6, Steps: 7 | Train Loss: 1.687 Vali Loss: 1.641 Vali Acc: 0.694 Test Loss: 1.641 Test Acc: 0.694
Validation loss decreased (-0.541647 --> -0.694428).  Saving model ...
Epoch: 7 cost time: 1.8401679992675781
Epoch: 7, Steps: 7 | Train Loss: 1.297 Vali Loss: 1.294 Vali Acc: 0.806 Test Loss: 1.294 Test Acc: 0.806
Validation loss decreased (-0.694428 --> -0.805543).  Saving model ...
Epoch: 8 cost time: 1.821601390838623
Epoch: 8, Steps: 7 | Train Loss: 0.961 Vali Loss: 0.992 Vali Acc: 0.806 Test Loss: 0.992 Test Acc: 0.806
Validation loss decreased (-0.805543 --> -0.805546).  Saving model ...
Epoch: 9 cost time: 2.3637359142303467
Epoch: 9, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.781 Vali Acc: 0.819 Test Loss: 0.781 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819437).  Saving model ...
Epoch: 10 cost time: 2.4341044425964355
Epoch: 10, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.819437 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 2.1705665588378906
Epoch: 11, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 2.328169584274292
Epoch: 12, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 2.4333271980285645
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.1645212173461914
Epoch: 14, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2133052349090576
Epoch: 15, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 2.6467881202697754
Epoch: 16, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 1.9288251399993896
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.0586800575256348
Epoch: 18, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.9051282405853271
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.042764663696289
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.4828362464904785
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.2187838554382324
Epoch: 22, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.290658473968506
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.628377914428711
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.2773098945617676
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.3440494537353516
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.0619935989379883
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.1008870601654053
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.272515058517456
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.485299825668335
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.0132997035980225
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 2.38634991645813
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.1089305877685547
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.2992565631866455
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.447035789489746
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.9801545143127441
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.7378406524658203
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.8540375232696533
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 2.037189483642578
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 2.0260682106018066
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.7749590873718262
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.008925199508667
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9030990600585938
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.955841064453125
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 2.188472270965576
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.9666388034820557
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.1577341556549072
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 2.3487637042999268
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 2.3648386001586914
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.0868594646453857
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.5836548805236816
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 2.363208770751953
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 2.26253342628479
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.258185386657715
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.6691854000091553
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.9340879917144775
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 2.474325180053711
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.7476239204406738
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.7428393363952637
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.966702938079834
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 1.4134840965270996
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 2.0342607498168945
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 2.0073835849761963
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.9635651111602783
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 1.9793040752410889
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.336412191390991
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.6666700839996338
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9239132404327393
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.136768102645874
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 2.1039321422576904
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 2.1523213386535645
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 2.168091058731079
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 2.439943313598633
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 1.8975989818572998
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.904728889465332
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.285720109939575
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.3217456340789795
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.035332202911377
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 2.0502893924713135
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 2.2674763202667236
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 2.591622829437256
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 2.3246679306030273
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 2.263920307159424
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.4290926456451416
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.40024733543396
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.9512715339660645
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 2.4050850868225098
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 2.305656671524048
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 2.206798553466797
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.959275245666504
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 2.145381212234497
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 2.381669521331787
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 2.4448697566986084
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 2.3842270374298096
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 2.095027446746826
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 2.3592958450317383
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 2.0969908237457275
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 98 cost time: 2.3166615962982178
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 2.2762908935546875
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 2.1867637634277344
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 531048
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.15332293510437
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.525 Vali Acc: 0.153 Test Loss: 2.525 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 2.362386703491211
Epoch: 2, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.394 Vali Acc: 0.125 Test Loss: 2.394 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2634525299072266
Epoch: 3, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.328 Vali Acc: 0.236 Test Loss: 2.328 Test Acc: 0.236
Validation loss decreased (-0.152753 --> -0.236088).  Saving model ...
Epoch: 4 cost time: 2.3937108516693115
Epoch: 4, Steps: 7 | Train Loss: 2.286 Vali Loss: 2.196 Vali Acc: 0.306 Test Loss: 2.196 Test Acc: 0.306
Validation loss decreased (-0.236088 --> -0.305534).  Saving model ...
Epoch: 5 cost time: 2.0981605052948
Epoch: 5, Steps: 7 | Train Loss: 2.077 Vali Loss: 1.985 Vali Acc: 0.611 Test Loss: 1.985 Test Acc: 0.611
Validation loss decreased (-0.305534 --> -0.611091).  Saving model ...
Epoch: 6 cost time: 2.0157363414764404
Epoch: 6, Steps: 7 | Train Loss: 1.800 Vali Loss: 1.660 Vali Acc: 0.694 Test Loss: 1.660 Test Acc: 0.694
Validation loss decreased (-0.611091 --> -0.694428).  Saving model ...
Epoch: 7 cost time: 2.2328343391418457
Epoch: 7, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.351 Vali Acc: 0.722 Test Loss: 1.351 Test Acc: 0.722
Validation loss decreased (-0.694428 --> -0.722209).  Saving model ...
Epoch: 8 cost time: 2.454111099243164
Epoch: 8, Steps: 7 | Train Loss: 1.082 Vali Loss: 1.056 Vali Acc: 0.792 Test Loss: 1.056 Test Acc: 0.792
Validation loss decreased (-0.722209 --> -0.791656).  Saving model ...
Epoch: 9 cost time: 2.4781670570373535
Epoch: 9, Steps: 7 | Train Loss: 0.732 Vali Loss: 0.812 Vali Acc: 0.806 Test Loss: 0.812 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805547).  Saving model ...
Epoch: 10 cost time: 1.7314157485961914
Epoch: 10, Steps: 7 | Train Loss: 0.494 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
Validation loss decreased (-0.805547 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 2.3403263092041016
Epoch: 11, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 1.8579423427581787
Epoch: 12, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2927167415618896
Epoch: 13, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.1212143898010254
Epoch: 14, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 2.126490831375122
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 1.8360602855682373
Epoch: 16, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0911216735839844
Epoch: 17, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 2.1888070106506348
Epoch: 18, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8041925430297852
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.9104666709899902
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.1649816036224365
Epoch: 21, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.483241319656372
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2354862689971924
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.8923125267028809
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.9963247776031494
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.9795279502868652
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.138826847076416
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.244760513305664
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.0980472564697266
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.1451075077056885
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.8906033039093018
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0538487434387207
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.9525492191314697
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.9086501598358154
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.885582685470581
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.7533931732177734
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8368957042694092
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.9122796058654785
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.9318809509277344
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.236268997192383
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2989063262939453
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 2.083416700363159
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 2.2341995239257812
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.3163154125213623
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.2916736602783203
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 2.216294765472412
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.177980899810791
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8531010150909424
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.452198028564453
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.217747449874878
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 2.335207462310791
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 2.2942631244659424
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.295365571975708
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 2.0995028018951416
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.1635138988494873
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.3801114559173584
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.2858169078826904
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.1650896072387695
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 2.0775067806243896
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.3489716053009033
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 2.13559627532959
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 1.6976659297943115
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.2262446880340576
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.882568359375
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.311105489730835
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.0943825244903564
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 2.0944385528564453
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.353611707687378
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.473802089691162
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.364497184753418
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.3223154544830322
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 1.949493646621704
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.8184947967529297
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 2.2799482345581055
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 2.2933530807495117
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 2.476635694503784
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.0546863079071045
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.415924310684204
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.251816749572754
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.2471084594726562
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 2.0506203174591064
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 2.4947285652160645
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 2.095327854156494
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 2.5372889041900635
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 2.2700915336608887
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 2.0830843448638916
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 2.887552261352539
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 88 cost time: 2.2434747219085693
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.890526294708252
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 2.3497774600982666
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 2.198084831237793
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7251126766204834
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 2.1846702098846436
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 2.147559404373169
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 1.96000075340271
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 2.1832189559936523
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 1.8084492683410645
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.295624256134033
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 1.866718053817749
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 2.1980695724487305
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 525032
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.73372483253479
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.498 Vali Acc: 0.111 Test Loss: 2.498 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.023203134536743
Epoch: 2, Steps: 7 | Train Loss: 2.509 Vali Loss: 2.400 Vali Acc: 0.236 Test Loss: 2.400 Test Acc: 0.236
Validation loss decreased (-0.111086 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 1.940734624862671
Epoch: 3, Steps: 7 | Train Loss: 2.376 Vali Loss: 2.327 Vali Acc: 0.319 Test Loss: 2.327 Test Acc: 0.319
Validation loss decreased (-0.236087 --> -0.319421).  Saving model ...
Epoch: 4 cost time: 2.0078325271606445
Epoch: 4, Steps: 7 | Train Loss: 2.248 Vali Loss: 2.169 Vali Acc: 0.597 Test Loss: 2.169 Test Acc: 0.597
Validation loss decreased (-0.319421 --> -0.597201).  Saving model ...
Epoch: 5 cost time: 1.9131522178649902
Epoch: 5, Steps: 7 | Train Loss: 2.044 Vali Loss: 1.924 Vali Acc: 0.625 Test Loss: 1.924 Test Acc: 0.625
Validation loss decreased (-0.597201 --> -0.624981).  Saving model ...
Epoch: 6 cost time: 1.9460139274597168
Epoch: 6, Steps: 7 | Train Loss: 1.746 Vali Loss: 1.636 Vali Acc: 0.750 Test Loss: 1.636 Test Acc: 0.750
Validation loss decreased (-0.624981 --> -0.749984).  Saving model ...
Epoch: 7 cost time: 2.1607508659362793
Epoch: 7, Steps: 7 | Train Loss: 1.320 Vali Loss: 1.287 Vali Acc: 0.792 Test Loss: 1.287 Test Acc: 0.792
Validation loss decreased (-0.749984 --> -0.791654).  Saving model ...
Epoch: 8 cost time: 2.05368971824646
Epoch: 8, Steps: 7 | Train Loss: 0.981 Vali Loss: 0.985 Vali Acc: 0.792 Test Loss: 0.985 Test Acc: 0.792
Validation loss decreased (-0.791654 --> -0.791657).  Saving model ...
Epoch: 9 cost time: 1.9206092357635498
Epoch: 9, Steps: 7 | Train Loss: 0.651 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.791657 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 1.986870288848877
Epoch: 10, Steps: 7 | Train Loss: 0.428 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 1.9394450187683105
Epoch: 11, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 1.8059113025665283
Epoch: 12, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.7304954528808594
Epoch: 13, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 1.504127025604248
Epoch: 14, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 2.418637990951538
Epoch: 15, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.146848440170288
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 2.2146999835968018
Epoch: 17, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.9949641227722168
Epoch: 18, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.4269864559173584
Epoch: 19, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.051591157913208
Epoch: 20, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3943095207214355
Epoch: 21, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.1146469116210938
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 2.0249414443969727
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.0109236240386963
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8803832530975342
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1378724575042725
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.1769535541534424
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.1194217205047607
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 2.097594976425171
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.04221248626709
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9914617538452148
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.214871644973755
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.1125900745391846
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1480493545532227
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.9093132019042969
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.8635988235473633
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.8927433490753174
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.7859265804290771
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.7061903476715088
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6231741905212402
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.5003130435943604
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.7573585510253906
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.6746852397918701
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 2.0941500663757324
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.484100341796875
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.645758867263794
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7768127918243408
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.1547062397003174
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0711541175842285
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.0732743740081787
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.9464695453643799
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.063167095184326
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.831068515777588
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 519016
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.548475742340088
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.523 Vali Acc: 0.083 Test Loss: 2.523 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.0350356101989746
Epoch: 2, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.457 Vali Acc: 0.111 Test Loss: 2.457 Test Acc: 0.111
Validation loss decreased (-0.083308 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 2.104585647583008
Epoch: 3, Steps: 7 | Train Loss: 2.417 Vali Loss: 2.391 Vali Acc: 0.167 Test Loss: 2.391 Test Acc: 0.167
Validation loss decreased (-0.111087 --> -0.166643).  Saving model ...
Epoch: 4 cost time: 2.0851569175720215
Epoch: 4, Steps: 7 | Train Loss: 2.282 Vali Loss: 2.271 Vali Acc: 0.292 Test Loss: 2.271 Test Acc: 0.292
Validation loss decreased (-0.166643 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 2.0012049674987793
Epoch: 5, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.106 Vali Acc: 0.556 Test Loss: 2.106 Test Acc: 0.556
Validation loss decreased (-0.291644 --> -0.555534).  Saving model ...
Epoch: 6 cost time: 1.9327542781829834
Epoch: 6, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.875 Vali Acc: 0.750 Test Loss: 1.875 Test Acc: 0.750
Validation loss decreased (-0.555534 --> -0.749981).  Saving model ...
Epoch: 7 cost time: 1.8285305500030518
Epoch: 7, Steps: 7 | Train Loss: 1.583 Vali Loss: 1.527 Vali Acc: 0.750 Test Loss: 1.527 Test Acc: 0.750
Validation loss decreased (-0.749981 --> -0.749985).  Saving model ...
Epoch: 8 cost time: 1.8916363716125488
Epoch: 8, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.172 Vali Acc: 0.819 Test Loss: 1.172 Test Acc: 0.819
Validation loss decreased (-0.749985 --> -0.819433).  Saving model ...
Epoch: 9 cost time: 2.2226195335388184
Epoch: 9, Steps: 7 | Train Loss: 0.825 Vali Loss: 0.882 Vali Acc: 0.847 Test Loss: 0.882 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847213).  Saving model ...
Epoch: 10 cost time: 2.0716001987457275
Epoch: 10, Steps: 7 | Train Loss: 0.537 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 1.9210896492004395
Epoch: 11, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9573447704315186
Epoch: 12, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 1.9280104637145996
Epoch: 13, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.170853853225708
Epoch: 14, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 2.2791707515716553
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 1.9026951789855957
Epoch: 16, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7208452224731445
Epoch: 17, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7363128662109375
Epoch: 18, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.0195837020874023
Epoch: 19, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.035515546798706
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.1198229789733887
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.872830867767334
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.214324474334717
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.0907652378082275
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.3588707447052
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.7254059314727783
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.0169575214385986
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.9878876209259033
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.7472550868988037
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.8674075603485107
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.7926597595214844
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.8053534030914307
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.3120639324188232
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8903732299804688
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0583181381225586
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2394702434539795
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.0945310592651367
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0070459842681885
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 2.145051956176758
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 2.2515056133270264
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9742374420166016
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.05720591545105
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.001499891281128
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.3450417518615723
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.363229513168335
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.4813125133514404
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9345734119415283
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.206031560897827
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.3765690326690674
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 513000
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.782136917114258
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.509 Vali Acc: 0.097 Test Loss: 2.509 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.104246139526367
Epoch: 2, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.428 Vali Acc: 0.111 Test Loss: 2.428 Test Acc: 0.111
Validation loss decreased (-0.097197 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 2.168583393096924
Epoch: 3, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.354 Vali Acc: 0.208 Test Loss: 2.354 Test Acc: 0.208
Validation loss decreased (-0.111087 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 2.1929423809051514
Epoch: 4, Steps: 7 | Train Loss: 2.344 Vali Loss: 2.262 Vali Acc: 0.292 Test Loss: 2.262 Test Acc: 0.292
Validation loss decreased (-0.208310 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 2.3420753479003906
Epoch: 5, Steps: 7 | Train Loss: 2.176 Vali Loss: 2.094 Vali Acc: 0.569 Test Loss: 2.094 Test Acc: 0.569
Validation loss decreased (-0.291644 --> -0.569424).  Saving model ...
Epoch: 6 cost time: 2.430450201034546
Epoch: 6, Steps: 7 | Train Loss: 1.968 Vali Loss: 1.843 Vali Acc: 0.583 Test Loss: 1.843 Test Acc: 0.583
Validation loss decreased (-0.569424 --> -0.583315).  Saving model ...
Epoch: 7 cost time: 2.1487081050872803
Epoch: 7, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.502 Vali Acc: 0.778 Test Loss: 1.502 Test Acc: 0.778
Validation loss decreased (-0.583315 --> -0.777763).  Saving model ...
Epoch: 8 cost time: 2.502946138381958
Epoch: 8, Steps: 7 | Train Loss: 1.257 Vali Loss: 1.172 Vali Acc: 0.819 Test Loss: 1.172 Test Acc: 0.819
Validation loss decreased (-0.777763 --> -0.819433).  Saving model ...
Epoch: 9 cost time: 2.490022659301758
Epoch: 9, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.864 Vali Acc: 0.875 Test Loss: 0.864 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 2.432697057723999
Epoch: 10, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0209860801696777
Epoch: 11, Steps: 7 | Train Loss: 0.354 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 2.2506113052368164
Epoch: 12, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 2.436927556991577
Epoch: 13, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 2.2478959560394287
Epoch: 14, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.513338327407837
Epoch: 15, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.315279006958008
Epoch: 16, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.9743072986602783
Epoch: 17, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.8203322887420654
Epoch: 18, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.335178852081299
Epoch: 19, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 2.1880087852478027
Epoch: 20, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 2.375127077102661
Epoch: 21, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 2.3974902629852295
Epoch: 22, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 2.1179704666137695
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.082045316696167
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 2.1693685054779053
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 2.1058101654052734
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 2.348644971847534
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 2.3162999153137207
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 2.428910970687866
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 2.4422519207000732
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 2.1197452545166016
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 2.2100625038146973
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 2.0667107105255127
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 2.1472854614257812
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 2.3318991661071777
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 1.8793656826019287
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 2.5278868675231934
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 2.4356374740600586
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 1.926884651184082
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 2.149782657623291
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 2.1651558876037598
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 2.408036947250366
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 2.4415435791015625
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 2.1557304859161377
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.1909356117248535
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 2.2023096084594727
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 2.061905860900879
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.269352436065674
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.417938709259033
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 1.9276809692382812
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 2.3030242919921875
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9566905498504639
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.1544618606567383
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 2.2978200912475586
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 2.1459591388702393
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.4163014888763428
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.408813714981079
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.2985219955444336
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 2.198582172393799
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 2.099252700805664
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.442646026611328
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 2.1853272914886475
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 63 cost time: 2.432093620300293
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 64 cost time: 2.0001704692840576
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 65 cost time: 2.1128990650177
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.121743679046631
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.30975079536438
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.3423163890838623
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.279395580291748
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.1627743244171143
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.2886836528778076
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 72 cost time: 2.1138250827789307
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 73 cost time: 2.300945997238159
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.10229229927063
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.0241050720214844
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 76 cost time: 2.3426222801208496
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.2159321308135986
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.287343978881836
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 79 cost time: 2.308907985687256
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 80 cost time: 2.329362630844116
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 2.2391517162323
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 2.4117250442504883
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 2.284919500350952
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 2.121786594390869
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 85 cost time: 1.964217185974121
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.32057523727417
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.4398515224456787
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 2.1739957332611084
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.9916136264801025
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 2.4154460430145264
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 2.2808585166931152
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 2.4847006797790527
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 2.450622081756592
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 2.2537217140197754
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 381288
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.663135528564453
Epoch: 1, Steps: 7 | Train Loss: 2.536 Vali Loss: 2.515 Vali Acc: 0.056 Test Loss: 2.515 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 1.7703502178192139
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.390 Vali Acc: 0.194 Test Loss: 2.390 Test Acc: 0.194
Validation loss decreased (-0.055530 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 2.025695562362671
Epoch: 3, Steps: 7 | Train Loss: 2.317 Vali Loss: 2.271 Vali Acc: 0.250 Test Loss: 2.271 Test Acc: 0.250
Validation loss decreased (-0.194421 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 2.13330078125
Epoch: 4, Steps: 7 | Train Loss: 2.197 Vali Loss: 2.135 Vali Acc: 0.458 Test Loss: 2.135 Test Acc: 0.458
Validation loss decreased (-0.249977 --> -0.458312).  Saving model ...
Epoch: 5 cost time: 1.90966796875
Epoch: 5, Steps: 7 | Train Loss: 1.994 Vali Loss: 1.940 Vali Acc: 0.528 Test Loss: 1.940 Test Acc: 0.528
Validation loss decreased (-0.458312 --> -0.527758).  Saving model ...
Epoch: 6 cost time: 2.0011093616485596
Epoch: 6, Steps: 7 | Train Loss: 1.713 Vali Loss: 1.664 Vali Acc: 0.667 Test Loss: 1.664 Test Acc: 0.667
Validation loss decreased (-0.527758 --> -0.666650).  Saving model ...
Epoch: 7 cost time: 2.065389633178711
Epoch: 7, Steps: 7 | Train Loss: 1.387 Vali Loss: 1.348 Vali Acc: 0.819 Test Loss: 1.348 Test Acc: 0.819
Validation loss decreased (-0.666650 --> -0.819431).  Saving model ...
Epoch: 8 cost time: 1.9438745975494385
Epoch: 8, Steps: 7 | Train Loss: 1.046 Vali Loss: 1.062 Vali Acc: 0.792 Test Loss: 1.062 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.242292642593384
Epoch: 9, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.827 Vali Acc: 0.778 Test Loss: 0.827 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3251376152038574
Epoch: 10, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.638 Vali Acc: 0.847 Test Loss: 0.638 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847216).  Saving model ...
Epoch: 11 cost time: 1.8379263877868652
Epoch: 11, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 2.196763515472412
Epoch: 12, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8196194171905518
Epoch: 13, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7971079349517822
Epoch: 14, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 1.8835036754608154
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 1.7700386047363281
Epoch: 16, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 1.822338581085205
Epoch: 17, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.7559094429016113
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.7734143733978271
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.9531681537628174
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 2.130465269088745
Epoch: 21, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.9190952777862549
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9697446823120117
Epoch: 23, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.026315450668335
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8084700107574463
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.295602321624756
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.8784468173980713
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.194021701812744
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.9914770126342773
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1365549564361572
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.15842342376709
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.8628084659576416
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9823498725891113
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.8639051914215088
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.8018381595611572
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.9571528434753418
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.042541027069092
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.851963996887207
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 2.4818215370178223
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 2.3537700176239014
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 2.3883566856384277
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 2.250432014465332
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 2.328623056411743
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 2.2478561401367188
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.0144877433776855
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.564507246017456
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0903334617614746
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.085458278656006
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.1339218616485596
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.1777098178863525
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.1749258041381836
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 2.378941535949707
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 2.175781726837158
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.7061054706573486
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.7366423606872559
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.9927804470062256
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.8306753635406494
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.8443148136138916
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.8123631477355957
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 2.3798024654388428
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 1.6028833389282227
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 2.042064905166626
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.8853247165679932
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.7916932106018066
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 2.1395559310913086
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.9411273002624512
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.8149356842041016
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.0771045684814453
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.9209671020507812
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.6952259540557861
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 2.1044344902038574
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.6095643043518066
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.523343801498413
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.3892333507537842
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.5890474319458008
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 2.0377914905548096
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 2.0163521766662598
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 2.149564743041992
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 2.1089141368865967
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 2.1559948921203613
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 2.045423984527588
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 2.057840347290039
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 2.0562188625335693
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.8168416023254395
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 2.036058187484741
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 2.0808777809143066
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.961582899093628
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.8879504203796387
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 1.7621934413909912
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 2.144216299057007
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 2.0274784564971924
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 2.1185667514801025
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 2.037104368209839
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.7621574401855469
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 2.1429574489593506
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 2.0601680278778076
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 2.0262796878814697
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 98 cost time: 1.955822229385376
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.824124813079834
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 2.1689858436584473
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 375272
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.070858955383301
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.465 Vali Acc: 0.097 Test Loss: 2.465 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.9491477012634277
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.378 Vali Acc: 0.181 Test Loss: 2.378 Test Acc: 0.181
Validation loss decreased (-0.097198 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 1.8906712532043457
Epoch: 3, Steps: 7 | Train Loss: 2.386 Vali Loss: 2.276 Vali Acc: 0.389 Test Loss: 2.276 Test Acc: 0.389
Validation loss decreased (-0.180532 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 1.894338846206665
Epoch: 4, Steps: 7 | Train Loss: 2.244 Vali Loss: 2.149 Vali Acc: 0.486 Test Loss: 2.149 Test Acc: 0.486
Validation loss decreased (-0.388866 --> -0.486090).  Saving model ...
Epoch: 5 cost time: 1.9998276233673096
Epoch: 5, Steps: 7 | Train Loss: 2.070 Vali Loss: 1.943 Vali Acc: 0.597 Test Loss: 1.943 Test Acc: 0.597
Validation loss decreased (-0.486090 --> -0.597203).  Saving model ...
Epoch: 6 cost time: 1.7980778217315674
Epoch: 6, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.675 Vali Acc: 0.764 Test Loss: 1.675 Test Acc: 0.764
Validation loss decreased (-0.597203 --> -0.763872).  Saving model ...
Epoch: 7 cost time: 1.9567623138427734
Epoch: 7, Steps: 7 | Train Loss: 1.456 Vali Loss: 1.351 Vali Acc: 0.736 Test Loss: 1.351 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0318994522094727
Epoch: 8, Steps: 7 | Train Loss: 1.084 Vali Loss: 1.042 Vali Acc: 0.861 Test Loss: 1.042 Test Acc: 0.861
Validation loss decreased (-0.763872 --> -0.861101).  Saving model ...
Epoch: 9 cost time: 2.0836849212646484
Epoch: 9, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.809 Vali Acc: 0.889 Test Loss: 0.809 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 2.1085152626037598
Epoch: 10, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.628 Vali Acc: 0.903 Test Loss: 0.628 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902771).  Saving model ...
Epoch: 11 cost time: 1.8527393341064453
Epoch: 11, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 1.936725378036499
Epoch: 12, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 1.950850248336792
Epoch: 13, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.313674211502075
Epoch: 14, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2226176261901855
Epoch: 15, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 2.0589325428009033
Epoch: 16, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 2.0827836990356445
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.1244866847991943
Epoch: 18, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.8865509033203125
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.315196990966797
Epoch: 20, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.681161880493164
Epoch: 21, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.424682140350342
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.1364269256591797
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.3975627422332764
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.2260615825653076
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 2.3889071941375732
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.0777475833892822
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.277474880218506
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.3476924896240234
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.1219394207000732
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.9237616062164307
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4757375717163086
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 2.5325052738189697
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 2.294297695159912
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 2.472130298614502
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2895138263702393
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.081326961517334
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.281024217605591
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 2.2061820030212402
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 2.391080141067505
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 2.118102550506592
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.4579083919525146
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 2.360755443572998
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 2.1172714233398438
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.0250308513641357
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 2.2381186485290527
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 2.494645118713379
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 2.2030835151672363
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.5281436443328857
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.2178027629852295
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.102675437927246
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.3082714080810547
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.529527425765991
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.544247627258301
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.1915128231048584
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.4658491611480713
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 2.0924484729766846
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 2.3348941802978516
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 2.5095038414001465
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.647181749343872
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.5338244438171387
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.2483737468719482
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.890559196472168
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.24296236038208
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 2.092855215072632
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.0993144512176514
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.2326323986053467
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 2.478830575942993
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 2.4290289878845215
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 2.338977575302124
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 2.3959333896636963
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.293360710144043
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 1.8162083625793457
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.696821928024292
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.1841752529144287
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.2523555755615234
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 2.755650281906128
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 2.019254684448242
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 2.2790067195892334
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 2.3979506492614746
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 2.361022710800171
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 2.222715377807617
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 2.1349685192108154
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 2.111961603164673
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.106349468231201
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.0274741649627686
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 2.2677652835845947
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 2.593470811843872
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 2.043552875518799
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 2.5738978385925293
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 2.266500949859619
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 2.4418246746063232
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 2.6534016132354736
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 369256
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6830708980560303
Epoch: 1, Steps: 7 | Train Loss: 2.650 Vali Loss: 2.518 Vali Acc: 0.083 Test Loss: 2.518 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.0897037982940674
Epoch: 2, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.427 Vali Acc: 0.167 Test Loss: 2.427 Test Acc: 0.167
Validation loss decreased (-0.083308 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 2.3099396228790283
Epoch: 3, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.370 Vali Acc: 0.069 Test Loss: 2.370 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4537060260772705
Epoch: 4, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.261 Vali Acc: 0.292 Test Loss: 2.261 Test Acc: 0.292
Validation loss decreased (-0.166642 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 2.064265012741089
Epoch: 5, Steps: 7 | Train Loss: 2.204 Vali Loss: 2.105 Vali Acc: 0.431 Test Loss: 2.105 Test Acc: 0.431
Validation loss decreased (-0.291644 --> -0.430535).  Saving model ...
Epoch: 6 cost time: 1.844973087310791
Epoch: 6, Steps: 7 | Train Loss: 1.976 Vali Loss: 1.865 Vali Acc: 0.611 Test Loss: 1.865 Test Acc: 0.611
Validation loss decreased (-0.430535 --> -0.611092).  Saving model ...
Epoch: 7 cost time: 1.7450439929962158
Epoch: 7, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.550 Vali Acc: 0.708 Test Loss: 1.550 Test Acc: 0.708
Validation loss decreased (-0.611092 --> -0.708318).  Saving model ...
Epoch: 8 cost time: 1.7010247707366943
Epoch: 8, Steps: 7 | Train Loss: 1.303 Vali Loss: 1.207 Vali Acc: 0.875 Test Loss: 1.207 Test Acc: 0.875
Validation loss decreased (-0.708318 --> -0.874988).  Saving model ...
Epoch: 9 cost time: 1.7220385074615479
Epoch: 9, Steps: 7 | Train Loss: 0.928 Vali Loss: 0.936 Vali Acc: 0.806 Test Loss: 0.936 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.784898042678833
Epoch: 10, Steps: 7 | Train Loss: 0.615 Vali Loss: 0.716 Vali Acc: 0.847 Test Loss: 0.716 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.254417657852173
Epoch: 11, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6410670280456543
Epoch: 12, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 2.070082187652588
Epoch: 13, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.076420783996582
Epoch: 14, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 2.1357786655426025
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7640457153320312
Epoch: 16, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.345731496810913
Epoch: 17, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.247933864593506
Epoch: 18, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.171370506286621
Epoch: 19, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.1135051250457764
Epoch: 20, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1190714836120605
Epoch: 21, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2077319622039795
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8939156532287598
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3927669525146484
Epoch: 24, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8237230777740479
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0002427101135254
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.267876386642456
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9301223754882812
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.2836480140686035
Epoch: 29, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.306983232498169
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.3489532470703125
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.252525568008423
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.367124080657959
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.260033369064331
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5194365978240967
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.5955357551574707
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.135390520095825
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 2.582301616668701
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9573261737823486
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.1555745601654053
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 2.2319881916046143
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 2.014545202255249
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.512795925140381
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.614126443862915
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 2.2878191471099854
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 2.333207130432129
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 2.3703227043151855
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9940338134765625
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.594182014465332
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.162181854248047
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 2.3442749977111816
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 2.0470292568206787
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7685718536376953
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7618088722229004
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.7400696277618408
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.7679762840270996
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 2.0870368480682373
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.215993881225586
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 1.9626445770263672
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 2.1100196838378906
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 61 cost time: 2.1433637142181396
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 62 cost time: 2.0888314247131348
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 63 cost time: 2.359687328338623
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.500236988067627
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.2245535850524902
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.118741035461426
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 67 cost time: 2.2021634578704834
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 1.9893662929534912
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.163921594619751
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.511457681655884
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.521635055541992
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.4610464572906494
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 73 cost time: 2.370898962020874
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 74 cost time: 2.192003011703491
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 75 cost time: 2.284900426864624
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 76 cost time: 2.4089670181274414
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.136748790740967
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.2219531536102295
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.5043399333953857
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.460339069366455
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 2.3003807067871094
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.10221791267395
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 2.517636775970459
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 2.5364577770233154
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 2.3295392990112305
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 363240
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.371236562728882
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.515 Vali Acc: 0.111 Test Loss: 2.515 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.9416096210479736
Epoch: 2, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.419 Vali Acc: 0.167 Test Loss: 2.419 Test Acc: 0.167
Validation loss decreased (-0.111086 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 2.456699848175049
Epoch: 3, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.336 Vali Acc: 0.292 Test Loss: 2.336 Test Acc: 0.292
Validation loss decreased (-0.166642 --> -0.291643).  Saving model ...
Epoch: 4 cost time: 2.2578110694885254
Epoch: 4, Steps: 7 | Train Loss: 2.347 Vali Loss: 2.220 Vali Acc: 0.333 Test Loss: 2.220 Test Acc: 0.333
Validation loss decreased (-0.291643 --> -0.333311).  Saving model ...
Epoch: 5 cost time: 1.8738970756530762
Epoch: 5, Steps: 7 | Train Loss: 2.125 Vali Loss: 2.065 Vali Acc: 0.528 Test Loss: 2.065 Test Acc: 0.528
Validation loss decreased (-0.333311 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 2.646850824356079
Epoch: 6, Steps: 7 | Train Loss: 1.965 Vali Loss: 1.842 Vali Acc: 0.611 Test Loss: 1.842 Test Acc: 0.611
Validation loss decreased (-0.527757 --> -0.611093).  Saving model ...
Epoch: 7 cost time: 2.1126015186309814
Epoch: 7, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.576 Vali Acc: 0.792 Test Loss: 1.576 Test Acc: 0.792
Validation loss decreased (-0.611093 --> -0.791651).  Saving model ...
Epoch: 8 cost time: 1.9281141757965088
Epoch: 8, Steps: 7 | Train Loss: 1.355 Vali Loss: 1.276 Vali Acc: 0.833 Test Loss: 1.276 Test Acc: 0.833
Validation loss decreased (-0.791651 --> -0.833321).  Saving model ...
Epoch: 9 cost time: 2.1381723880767822
Epoch: 9, Steps: 7 | Train Loss: 0.979 Vali Loss: 0.984 Vali Acc: 0.903 Test Loss: 0.984 Test Acc: 0.903
Validation loss decreased (-0.833321 --> -0.902768).  Saving model ...
Epoch: 10 cost time: 2.2109906673431396
Epoch: 10, Steps: 7 | Train Loss: 0.704 Vali Loss: 0.768 Vali Acc: 0.861 Test Loss: 0.768 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.305338144302368
Epoch: 11, Steps: 7 | Train Loss: 0.450 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.385817527770996
Epoch: 12, Steps: 7 | Train Loss: 0.310 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9806578159332275
Epoch: 13, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.435 Vali Acc: 0.903 Test Loss: 0.435 Test Acc: 0.903
Validation loss decreased (-0.902768 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 1.9659149646759033
Epoch: 14, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 2.1755776405334473
Epoch: 15, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4333279132843018
Epoch: 16, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 2.3880999088287354
Epoch: 17, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 2.76104998588562
Epoch: 18, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 1.9366815090179443
Epoch: 19, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 2.3888580799102783
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.150266647338867
Epoch: 21, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.9296400547027588
Epoch: 22, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.2649331092834473
Epoch: 23, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.0910139083862305
Epoch: 24, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.031588554382324
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.4819185733795166
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.243704319000244
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.3764877319335938
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5779502391815186
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7731060981750488
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9272871017456055
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3356854915618896
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.2811594009399414
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.069603204727173
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.4235129356384277
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9516477584838867
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.795642375946045
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 2.0152854919433594
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.9000017642974854
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7768409252166748
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3250551223754883
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.693488359451294
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.8603339195251465
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9657857418060303
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.3663859367370605
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.1873393058776855
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6116695404052734
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.2055866718292236
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.0634188652038574
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.8283007144927979
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.0588765144348145
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.3076741695404053
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 306408
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.591555595397949
Epoch: 1, Steps: 7 | Train Loss: 2.643 Vali Loss: 2.583 Vali Acc: 0.069 Test Loss: 2.583 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.588364601135254
Epoch: 2, Steps: 7 | Train Loss: 2.542 Vali Loss: 2.480 Vali Acc: 0.167 Test Loss: 2.480 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 2.2071807384490967
Epoch: 3, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.437 Vali Acc: 0.111 Test Loss: 2.437 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.338819980621338
Epoch: 4, Steps: 7 | Train Loss: 2.435 Vali Loss: 2.360 Vali Acc: 0.167 Test Loss: 2.360 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166643).  Saving model ...
Epoch: 5 cost time: 2.167742967605591
Epoch: 5, Steps: 7 | Train Loss: 2.339 Vali Loss: 2.278 Vali Acc: 0.444 Test Loss: 2.278 Test Acc: 0.444
Validation loss decreased (-0.166643 --> -0.444422).  Saving model ...
Epoch: 6 cost time: 2.0715231895446777
Epoch: 6, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.139 Vali Acc: 0.486 Test Loss: 2.139 Test Acc: 0.486
Validation loss decreased (-0.444422 --> -0.486090).  Saving model ...
Epoch: 7 cost time: 2.188969373703003
Epoch: 7, Steps: 7 | Train Loss: 2.072 Vali Loss: 1.918 Vali Acc: 0.597 Test Loss: 1.918 Test Acc: 0.597
Validation loss decreased (-0.486090 --> -0.597203).  Saving model ...
Epoch: 8 cost time: 2.5985896587371826
Epoch: 8, Steps: 7 | Train Loss: 1.798 Vali Loss: 1.639 Vali Acc: 0.722 Test Loss: 1.639 Test Acc: 0.722
Validation loss decreased (-0.597203 --> -0.722206).  Saving model ...
Epoch: 9 cost time: 2.652132511138916
Epoch: 9, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.308 Vali Acc: 0.806 Test Loss: 1.308 Test Acc: 0.806
Validation loss decreased (-0.722206 --> -0.805542).  Saving model ...
Epoch: 10 cost time: 2.22302508354187
Epoch: 10, Steps: 7 | Train Loss: 0.975 Vali Loss: 0.966 Vali Acc: 0.833 Test Loss: 0.966 Test Acc: 0.833
Validation loss decreased (-0.805542 --> -0.833324).  Saving model ...
Epoch: 11 cost time: 2.160522937774658
Epoch: 11, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.717 Vali Acc: 0.847 Test Loss: 0.717 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 2.3271241188049316
Epoch: 12, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847217).  Saving model ...
Epoch: 13 cost time: 2.766751766204834
Epoch: 13, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 14 cost time: 2.3190970420837402
Epoch: 14, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 15 cost time: 2.6627378463745117
Epoch: 15, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 2.1150734424591064
Epoch: 16, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.380 Vali Acc: 0.847 Test Loss: 0.380 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.349940776824951
Epoch: 17, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 2.406320095062256
Epoch: 18, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.269930839538574
Epoch: 19, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.0625407695770264
Epoch: 20, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4675233364105225
Epoch: 21, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2849369049072266
Epoch: 22, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.391495704650879
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3781542778015137
Epoch: 24, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8368220329284668
Epoch: 25, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9340367317199707
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.16987943649292
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.3381333351135254
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.313676595687866
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.153254985809326
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.552102565765381
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.3081469535827637
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 2.4750630855560303
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.3817882537841797
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 2.0261826515197754
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 2.1835129261016846
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.0584750175476074
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.6689822673797607
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 2.523414134979248
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.2271740436553955
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.8505842685699463
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 2.329822540283203
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 2.170806407928467
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 2.3627209663391113
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 2.6702511310577393
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 2.3070597648620605
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 2.244901180267334
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 2.0647945404052734
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.7586989402770996
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.9961373805999756
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 2.0687077045440674
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.5600178241729736
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.3711743354797363
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.9447412490844727
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.2813363075256348
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.364414691925049
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.115469217300415
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 2.349839687347412
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.979435682296753
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 2.358705520629883
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 2.526381731033325
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.71750545501709
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 1.9532511234283447
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.271315336227417
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 2.1241679191589355
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 2.48226261138916
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.396747589111328
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.1456480026245117
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.5824782848358154
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 2.2010412216186523
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 2.4909355640411377
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.134305715560913
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.3773326873779297
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 2.0210258960723877
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 2.0121445655822754
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 2.366771936416626
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 2.4480764865875244
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 2.3146910667419434
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 2.2736947536468506
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 1.9726245403289795
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 2.410144805908203
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 2.1991283893585205
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 2.298417568206787
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 2.0288538932800293
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 2.2568342685699463
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.2422139644622803
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 1.9440240859985352
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 2.222273111343384
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 2.1344127655029297
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.9520833492279053
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 2.5778636932373047
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 2.1809298992156982
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 2.3410139083862305
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 94 cost time: 2.2958409786224365
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 2.293060779571533
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 96 cost time: 2.270798921585083
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 2.1702237129211426
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.592435598373413
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 2.3752479553222656
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 2.4530417919158936
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 300392
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.424532175064087
Epoch: 1, Steps: 7 | Train Loss: 2.700 Vali Loss: 2.601 Vali Acc: 0.111 Test Loss: 2.601 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 2.4969472885131836
Epoch: 2, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.509 Vali Acc: 0.097 Test Loss: 2.509 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9990065097808838
Epoch: 3, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.480 Vali Acc: 0.111 Test Loss: 2.480 Test Acc: 0.111
Validation loss decreased (-0.111085 --> -0.111086).  Saving model ...
Epoch: 4 cost time: 2.5776872634887695
Epoch: 4, Steps: 7 | Train Loss: 2.504 Vali Loss: 2.448 Vali Acc: 0.167 Test Loss: 2.448 Test Acc: 0.167
Validation loss decreased (-0.111086 --> -0.166642).  Saving model ...
Epoch: 5 cost time: 1.897812843322754
Epoch: 5, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.371 Vali Acc: 0.236 Test Loss: 2.371 Test Acc: 0.236
Validation loss decreased (-0.166642 --> -0.236087).  Saving model ...
Epoch: 6 cost time: 2.2043347358703613
Epoch: 6, Steps: 7 | Train Loss: 2.359 Vali Loss: 2.286 Vali Acc: 0.361 Test Loss: 2.286 Test Acc: 0.361
Validation loss decreased (-0.236087 --> -0.361088).  Saving model ...
Epoch: 7 cost time: 2.132143259048462
Epoch: 7, Steps: 7 | Train Loss: 2.226 Vali Loss: 2.123 Vali Acc: 0.528 Test Loss: 2.123 Test Acc: 0.528
Validation loss decreased (-0.361088 --> -0.527757).  Saving model ...
Epoch: 8 cost time: 2.103034019470215
Epoch: 8, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.902 Vali Acc: 0.639 Test Loss: 1.902 Test Acc: 0.639
Validation loss decreased (-0.527757 --> -0.638870).  Saving model ...
Epoch: 9 cost time: 2.2554261684417725
Epoch: 9, Steps: 7 | Train Loss: 1.695 Vali Loss: 1.577 Vali Acc: 0.750 Test Loss: 1.577 Test Acc: 0.750
Validation loss decreased (-0.638870 --> -0.749984).  Saving model ...
Epoch: 10 cost time: 1.9203453063964844
Epoch: 10, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.208 Vali Acc: 0.792 Test Loss: 1.208 Test Acc: 0.792
Validation loss decreased (-0.749984 --> -0.791655).  Saving model ...
Epoch: 11 cost time: 2.0994739532470703
Epoch: 11, Steps: 7 | Train Loss: 0.913 Vali Loss: 0.895 Vali Acc: 0.847 Test Loss: 0.895 Test Acc: 0.847
Validation loss decreased (-0.791655 --> -0.847213).  Saving model ...
Epoch: 12 cost time: 2.2558958530426025
Epoch: 12, Steps: 7 | Train Loss: 0.573 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.439422369003296
Epoch: 13, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847217).  Saving model ...
Epoch: 14 cost time: 2.3717596530914307
Epoch: 14, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 1.904613971710205
Epoch: 15, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2321183681488037
Epoch: 16, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 1.6670663356781006
Epoch: 17, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7793927192687988
Epoch: 18, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 1.6179368495941162
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 1.9445438385009766
Epoch: 20, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 2.0608978271484375
Epoch: 21, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 2.035828113555908
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 2.2664921283721924
Epoch: 23, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 2.1228761672973633
Epoch: 24, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.026989221572876
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1395554542541504
Epoch: 26, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3481032848358154
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 1.9863698482513428
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 2.5170319080352783
Epoch: 29, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 1.8736071586608887
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 2.213923931121826
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.212644577026367
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.037738800048828
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2206454277038574
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.4067957401275635
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 2.249361991882324
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 2.022563934326172
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 2.120532989501953
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 2.2687175273895264
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 2.284609079360962
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 2.2683050632476807
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 2.2019059658050537
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 2.485480785369873
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 2.1389715671539307
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 2.253831386566162
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 2.2012627124786377
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0473382472991943
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.670153856277466
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.032562494277954
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 1.8853850364685059
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9531400203704834
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 1.8608183860778809
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 1.9733014106750488
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 1.9494884014129639
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 2.011662006378174
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 2.621943950653076
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.57258939743042
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.0101680755615234
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.0299363136291504
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.43259596824646
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.95762038230896
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 2.6211092472076416
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 2.1997475624084473
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.293750286102295
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.64225435256958
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.163071870803833
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.2836246490478516
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.5712523460388184
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.0762767791748047
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.1623995304107666
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.551105499267578
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 2.3031845092773438
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 2.7658615112304688
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 1.8126976490020752
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 2.0631816387176514
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 2.072802782058716
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.9806859493255615
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.1366121768951416
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.992400884628296
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.0689122676849365
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.420861005783081
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.2923038005828857
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 2.6435277462005615
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 2.068647861480713
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 2.4607818126678467
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 294376
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.805511951446533
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.513 Vali Acc: 0.125 Test Loss: 2.513 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.8029775619506836
Epoch: 2, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.430 Vali Acc: 0.181 Test Loss: 2.430 Test Acc: 0.181
Validation loss decreased (-0.124975 --> -0.180531).  Saving model ...
Epoch: 3 cost time: 1.8232486248016357
Epoch: 3, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.390 Vali Acc: 0.181 Test Loss: 2.390 Test Acc: 0.181
Validation loss decreased (-0.180531 --> -0.180532).  Saving model ...
Epoch: 4 cost time: 2.2574048042297363
Epoch: 4, Steps: 7 | Train Loss: 2.379 Vali Loss: 2.337 Vali Acc: 0.194 Test Loss: 2.337 Test Acc: 0.194
Validation loss decreased (-0.180532 --> -0.194421).  Saving model ...
Epoch: 5 cost time: 2.312671661376953
Epoch: 5, Steps: 7 | Train Loss: 2.339 Vali Loss: 2.233 Vali Acc: 0.444 Test Loss: 2.233 Test Acc: 0.444
Validation loss decreased (-0.194421 --> -0.444422).  Saving model ...
Epoch: 6 cost time: 2.1749532222747803
Epoch: 6, Steps: 7 | Train Loss: 2.215 Vali Loss: 2.078 Vali Acc: 0.556 Test Loss: 2.078 Test Acc: 0.556
Validation loss decreased (-0.444422 --> -0.555535).  Saving model ...
Epoch: 7 cost time: 1.9706189632415771
Epoch: 7, Steps: 7 | Train Loss: 1.977 Vali Loss: 1.857 Vali Acc: 0.667 Test Loss: 1.857 Test Acc: 0.667
Validation loss decreased (-0.555535 --> -0.666648).  Saving model ...
Epoch: 8 cost time: 2.161324977874756
Epoch: 8, Steps: 7 | Train Loss: 1.719 Vali Loss: 1.555 Vali Acc: 0.736 Test Loss: 1.555 Test Acc: 0.736
Validation loss decreased (-0.666648 --> -0.736096).  Saving model ...
Epoch: 9 cost time: 2.044983386993408
Epoch: 9, Steps: 7 | Train Loss: 1.341 Vali Loss: 1.230 Vali Acc: 0.778 Test Loss: 1.230 Test Acc: 0.778
Validation loss decreased (-0.736096 --> -0.777765).  Saving model ...
Epoch: 10 cost time: 1.7805259227752686
Epoch: 10, Steps: 7 | Train Loss: 0.956 Vali Loss: 0.961 Vali Acc: 0.792 Test Loss: 0.961 Test Acc: 0.792
Validation loss decreased (-0.777765 --> -0.791657).  Saving model ...
Epoch: 11 cost time: 2.20708966255188
Epoch: 11, Steps: 7 | Train Loss: 0.649 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.791657 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 1.9604458808898926
Epoch: 12, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 1.8316669464111328
Epoch: 13, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9754390716552734
Epoch: 14, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.801609754562378
Epoch: 15, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 1.939323902130127
Epoch: 16, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 1.8117411136627197
Epoch: 17, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 1.4194140434265137
Epoch: 18, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.295133113861084
Epoch: 19, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 2.3630306720733643
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8357539176940918
Epoch: 21, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4738373756408691
Epoch: 22, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.8018884658813477
Epoch: 23, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.204324245452881
Epoch: 24, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.9847347736358643
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.9220166206359863
Epoch: 26, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 2.203784465789795
Epoch: 27, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.8485987186431885
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.0298233032226562
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9996612071990967
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0762863159179688
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9957129955291748
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8903989791870117
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.6585631370544434
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.005448818206787
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8438944816589355
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.921541690826416
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.8038525581359863
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6636009216308594
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7732925415039062
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.7290940284729004
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.8624529838562012
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.6835412979125977
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 1.879410743713379
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9920177459716797
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.159569025039673
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.4760386943817139
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9873161315917969
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.7746613025665283
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.9486839771270752
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.9568822383880615
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 1.8209781646728516
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6588687896728516
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9390738010406494
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.193765163421631
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.8286900520324707
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.8690941333770752
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.882842779159546
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 2.0574257373809814
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 2.0734944343566895
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 1.9512970447540283
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 2.0634024143218994
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 2.1758389472961426
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.9156036376953125
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.1878304481506348
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.9835963249206543
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 1.9102320671081543
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.5566534996032715
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 2.0674121379852295
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 1.9290332794189453
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 1.9473354816436768
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.011924982070923
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.990722417831421
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.0923845767974854
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.0654938220977783
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 2.2384870052337646
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 1.6145191192626953
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 1.5840928554534912
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 1.9956245422363281
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 2.0021297931671143
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 2.126607894897461
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.9228014945983887
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 2.0370571613311768
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 2.087568521499634
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 2.118812322616577
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 1.905630350112915
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.8242530822753906
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.240767478942871
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 1.9550750255584717
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 2.0083088874816895
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 1.9600200653076172
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 1.7587339878082275
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 1.9813666343688965
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 94 cost time: 1.5647261142730713
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 95 cost time: 1.9297642707824707
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 96 cost time: 1.868156909942627
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.0189108848571777
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.69124436378479
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 2.451317548751831
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 100 cost time: 2.0630407333374023
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 288360
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.17781662940979
Epoch: 1, Steps: 7 | Train Loss: 2.647 Vali Loss: 2.340 Vali Acc: 0.264 Test Loss: 2.340 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 3.1418778896331787
Epoch: 2, Steps: 7 | Train Loss: 2.247 Vali Loss: 1.848 Vali Acc: 0.611 Test Loss: 1.848 Test Acc: 0.611
Validation loss decreased (-0.263865 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 2.5933640003204346
Epoch: 3, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.611093 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 3.283823251724243
Epoch: 4, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.685 Vali Acc: 0.764 Test Loss: 0.685 Test Acc: 0.764
Validation loss decreased (-0.749989 --> -0.763882).  Saving model ...
Epoch: 5 cost time: 3.1698758602142334
Epoch: 5, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.763882 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 3.0994856357574463
Epoch: 6, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.988125801086426
Epoch: 7, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 2.592747211456299
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.492 Vali Acc: 0.792 Test Loss: 0.492 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.165168285369873
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 3.0951900482177734
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 3.0073084831237793
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3334834575653076
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.778 Test Loss: 0.699 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.954314947128296
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.974630355834961
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.919616222381592
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.847 Test Loss: 0.637 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.077327013015747
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4371938705444336
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5514464378356934
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8192665576934814
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.933518886566162
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 11878972
model size : 50.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.076112270355225
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.323 Vali Acc: 0.194 Test Loss: 2.323 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 2.8761861324310303
Epoch: 2, Steps: 7 | Train Loss: 2.211 Vali Loss: 1.788 Vali Acc: 0.569 Test Loss: 1.788 Test Acc: 0.569
Validation loss decreased (-0.194421 --> -0.569427).  Saving model ...
Epoch: 3 cost time: 3.368441581726074
Epoch: 3, Steps: 7 | Train Loss: 1.509 Vali Loss: 0.866 Vali Acc: 0.736 Test Loss: 0.866 Test Acc: 0.736
Validation loss decreased (-0.569427 --> -0.736102).  Saving model ...
Epoch: 4 cost time: 2.903420925140381
Epoch: 4, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
Validation loss decreased (-0.736102 --> -0.819439).  Saving model ...
Epoch: 5 cost time: 2.3372466564178467
Epoch: 5, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 3.1901402473449707
Epoch: 6, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 3.492612838745117
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.475 Vali Acc: 0.806 Test Loss: 0.475 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7081544399261475
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 2.986722946166992
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.185397148132324
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4843273162841797
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.037794589996338
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8899412155151367
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1683707237243652
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0206987857818604
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7768616676330566
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.128492593765259
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2912862300872803
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 3.1431450843811035
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 2.998241424560547
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 3.0376880168914795
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 3.040006399154663
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 3.093026638031006
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 2.921992778778076
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 2.791140556335449
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 2.461444854736328
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 2.5747814178466797
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 2.9250760078430176
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.397876024246216
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0277273654937744
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.193254232406616
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.8747165203094482
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.381502628326416
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.051328659057617
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5993900299072266
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.453355073928833
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.3066303730010986
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 11834172
model size : 50.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.634074449539185
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.379 Vali Acc: 0.139 Test Loss: 2.379 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 3.0129125118255615
Epoch: 2, Steps: 7 | Train Loss: 2.206 Vali Loss: 1.811 Vali Acc: 0.472 Test Loss: 1.811 Test Acc: 0.472
Validation loss decreased (-0.138865 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 3.057706832885742
Epoch: 3, Steps: 7 | Train Loss: 1.367 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.472204 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 3.0327672958374023
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 3.1015117168426514
Epoch: 5, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 2.698373794555664
Epoch: 6, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 3.046072244644165
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.810358762741089
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8932902812957764
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.679326057434082
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3654019832611084
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0734081268310547
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.360600471496582
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.916665 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 2.94425630569458
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 2.6929872035980225
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 2.91296648979187
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 17 cost time: 2.636996269226074
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 3.0414888858795166
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 2.420224189758301
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 3.1554501056671143
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 3.0994443893432617
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 3.1729989051818848
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 3.058753728866577
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 2.7952611446380615
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 3.267073392868042
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 2.8707408905029297
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 2.595888614654541
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.442660093307495
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.88175630569458
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.674508810043335
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7652783393859863
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.485790729522705
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.4988718032836914
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.225081443786621
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.644874334335327
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.4731199741363525
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 11789372
model size : 50.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.847041845321655
Epoch: 1, Steps: 7 | Train Loss: 2.631 Vali Loss: 2.431 Vali Acc: 0.083 Test Loss: 2.431 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.77097225189209
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 1.728 Vali Acc: 0.583 Test Loss: 1.728 Test Acc: 0.583
Validation loss decreased (-0.083309 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 2.665370225906372
Epoch: 3, Steps: 7 | Train Loss: 1.159 Vali Loss: 0.866 Vali Acc: 0.778 Test Loss: 0.866 Test Acc: 0.778
Validation loss decreased (-0.583316 --> -0.777769).  Saving model ...
Epoch: 4 cost time: 3.2766263484954834
Epoch: 4, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.633 Vali Acc: 0.847 Test Loss: 0.633 Test Acc: 0.847
Validation loss decreased (-0.777769 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 2.5816802978515625
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 2.8502604961395264
Epoch: 6, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.443 Vali Acc: 0.861 Test Loss: 0.443 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.974869966506958
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 2.908977746963501
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8666908740997314
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 3.168538808822632
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3626420497894287
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.691472053527832
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 3.0381643772125244
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.433849811553955
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.8202850818634033
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 2.9457333087921143
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 2.736232042312622
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 2.751338005065918
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.067596673965454
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.271721363067627
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0540614128112793
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.004305362701416
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9726929664611816
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8096988201141357
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6894235610961914
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8058736324310303
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.702798843383789
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 11744572
model size : 49.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.999488353729248
Epoch: 1, Steps: 7 | Train Loss: 2.582 Vali Loss: 2.365 Vali Acc: 0.222 Test Loss: 2.365 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 2.754937171936035
Epoch: 2, Steps: 7 | Train Loss: 2.595 Vali Loss: 1.868 Vali Acc: 0.444 Test Loss: 1.868 Test Acc: 0.444
Validation loss decreased (-0.222199 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 3.1312296390533447
Epoch: 3, Steps: 7 | Train Loss: 1.458 Vali Loss: 1.126 Vali Acc: 0.597 Test Loss: 1.126 Test Acc: 0.597
Validation loss decreased (-0.444426 --> -0.597211).  Saving model ...
Epoch: 4 cost time: 2.633451461791992
Epoch: 4, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
Validation loss decreased (-0.597211 --> -0.819440).  Saving model ...
Epoch: 5 cost time: 3.579482078552246
Epoch: 5, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.766 Vali Acc: 0.792 Test Loss: 0.766 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.068192481994629
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.819440 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 3.422431468963623
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.23928165435791
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.787501335144043
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.936251640319824
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.632819890975952
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.996938705444336
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.434032678604126
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.643240213394165
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.382312297821045
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 2.3520448207855225
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 2.1722829341888428
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.405940055847168
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3553967475891113
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.999926805496216
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 3.5588219165802
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3596935272216797
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0561461448669434
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2243027687072754
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.336686134338379
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.427579641342163
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.913912296295166
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9579660892486572
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6071696281433105
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.458162784576416
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10040380
model size : 43.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.145702362060547
Epoch: 1, Steps: 7 | Train Loss: 2.672 Vali Loss: 2.418 Vali Acc: 0.083 Test Loss: 2.418 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.9190800189971924
Epoch: 2, Steps: 7 | Train Loss: 2.370 Vali Loss: 1.805 Vali Acc: 0.569 Test Loss: 1.805 Test Acc: 0.569
Validation loss decreased (-0.083309 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 2.588329315185547
Epoch: 3, Steps: 7 | Train Loss: 1.478 Vali Loss: 0.974 Vali Acc: 0.792 Test Loss: 0.974 Test Acc: 0.792
Validation loss decreased (-0.569426 --> -0.791657).  Saving model ...
Epoch: 4 cost time: 3.519716501235962
Epoch: 4, Steps: 7 | Train Loss: 0.514 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.791657 --> -0.791661).  Saving model ...
Epoch: 5 cost time: 2.9379220008850098
Epoch: 5, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.791661 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 3.2557990550994873
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.910080671310425
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.935727119445801
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.995340585708618
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.220932722091675
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.631115674972534
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2286033630371094
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.137711763381958
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.106311559677124
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5422754287719727
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1672210693359375
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.934385061264038
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 9995580
model size : 43.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.961551189422607
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.347 Vali Acc: 0.167 Test Loss: 2.347 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.923020601272583
Epoch: 2, Steps: 7 | Train Loss: 2.254 Vali Loss: 1.729 Vali Acc: 0.583 Test Loss: 1.729 Test Acc: 0.583
Validation loss decreased (-0.166643 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 2.6636478900909424
Epoch: 3, Steps: 7 | Train Loss: 1.351 Vali Loss: 0.884 Vali Acc: 0.819 Test Loss: 0.884 Test Acc: 0.819
Validation loss decreased (-0.583316 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 2.511456251144409
Epoch: 4, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.819436 --> -0.819440).  Saving model ...
Epoch: 5 cost time: 3.133403778076172
Epoch: 5, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.621 Vali Acc: 0.806 Test Loss: 0.621 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9102048873901367
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
Validation loss decreased (-0.819440 --> -0.819440).  Saving model ...
Epoch: 7 cost time: 1.7652194499969482
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.819440 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.840744972229004
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.3197085857391357
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 2.9286227226257324
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.6004695892333984
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.20096492767334
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.628326892852783
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1026923656463623
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1472060680389404
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.370755434036255
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1431822776794434
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.316103458404541
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.398728847503662
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.319406270980835
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9950780
model size : 42.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.519651889801025
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.366 Vali Acc: 0.306 Test Loss: 2.366 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 2.51904559135437
Epoch: 2, Steps: 7 | Train Loss: 2.243 Vali Loss: 1.646 Vali Acc: 0.542 Test Loss: 1.646 Test Acc: 0.542
Validation loss decreased (-0.305532 --> -0.541650).  Saving model ...
Epoch: 3 cost time: 2.5981476306915283
Epoch: 3, Steps: 7 | Train Loss: 1.253 Vali Loss: 0.824 Vali Acc: 0.792 Test Loss: 0.824 Test Acc: 0.792
Validation loss decreased (-0.541650 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 2.315619707107544
Epoch: 4, Steps: 7 | Train Loss: 0.409 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.791658 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 2.6289560794830322
Epoch: 5, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.833327 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 2.3029603958129883
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.52423357963562
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5296413898468018
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.622493267059326
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.64863657951355
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6697888374328613
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.7282133102416992
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 2.7148730754852295
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 2.691457509994507
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 2.749319314956665
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 2.8642828464508057
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 2.2355129718780518
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 2.5292270183563232
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.4573192596435547
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9131226539611816
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.312631845474243
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8332061767578125
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 2.4805564880371094
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.7513351440429688
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 2.727189779281616
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 2.765073537826538
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.767659902572632
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.198326587677002
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7398173809051514
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 2.897669553756714
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 2.9817380905151367
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4939382076263428
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 2.8259263038635254
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 2.8303334712982178
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 2.7243432998657227
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.898991346359253
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 2.575554847717285
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 2.702927350997925
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 2.6803886890411377
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 2.895721197128296
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 2.543846845626831
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.5298008918762207
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 2.5492045879364014
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 2.149268388748169
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.1960859298706055
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.4256908893585205
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 2.6696925163269043
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 2.7353992462158203
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 2.4867091178894043
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.676910638809204
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.9313769340515137
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.5628743171691895
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 2.371243715286255
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 1.696483850479126
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 2.882033586502075
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 3.3136041164398193
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 2.3605546951293945
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 1.9897387027740479
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.7272887229919434
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.270256280899048
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.906890630722046
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.9087574481964111
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.597003698348999
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.6596200466156006
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.636051893234253
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 2.5279364585876465
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.508533239364624
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 9905980
model size : 42.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.956674098968506
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.373 Vali Acc: 0.236 Test Loss: 2.373 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 2.7965126037597656
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 1.735 Vali Acc: 0.528 Test Loss: 1.735 Test Acc: 0.528
Validation loss decreased (-0.236087 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 2.491595983505249
Epoch: 3, Steps: 7 | Train Loss: 1.404 Vali Loss: 0.903 Vali Acc: 0.722 Test Loss: 0.903 Test Acc: 0.722
Validation loss decreased (-0.527760 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 2.725618600845337
Epoch: 4, Steps: 7 | Train Loss: 0.437 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.722213 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 2.9407241344451904
Epoch: 5, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.833329 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 2.122415542602539
Epoch: 6, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1949808597564697
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4943788051605225
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3592545986175537
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4119045734405518
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.289229154586792
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.138583183288574
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.448575973510742
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1401214599609375
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5516653060913086
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9121084
model size : 39.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.696810007095337
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.392 Vali Acc: 0.167 Test Loss: 2.392 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 3.025029182434082
Epoch: 2, Steps: 7 | Train Loss: 2.230 Vali Loss: 1.738 Vali Acc: 0.583 Test Loss: 1.738 Test Acc: 0.583
Validation loss decreased (-0.166643 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 2.8697121143341064
Epoch: 3, Steps: 7 | Train Loss: 1.251 Vali Loss: 1.140 Vali Acc: 0.694 Test Loss: 1.140 Test Acc: 0.694
Validation loss decreased (-0.583316 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 3.3496267795562744
Epoch: 4, Steps: 7 | Train Loss: 0.509 Vali Loss: 0.594 Vali Acc: 0.792 Test Loss: 0.594 Test Acc: 0.792
Validation loss decreased (-0.694433 --> -0.791661).  Saving model ...
Epoch: 5 cost time: 2.917459011077881
Epoch: 5, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
Validation loss decreased (-0.791661 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 3.243128776550293
Epoch: 6, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4636881351470947
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.466344118118286
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 2.5967655181884766
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 3.380160093307495
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.874997 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.6498963832855225
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 3.661734104156494
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1257786750793457
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6587278842926025
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.610391139984131
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3480002880096436
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.176298141479492
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9199092388153076
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2282238006591797
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0826871395111084
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6194756031036377
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9076284
model size : 39.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.735230922698975
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.369 Vali Acc: 0.208 Test Loss: 2.369 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.8010382652282715
Epoch: 2, Steps: 7 | Train Loss: 2.263 Vali Loss: 1.683 Vali Acc: 0.583 Test Loss: 1.683 Test Acc: 0.583
Validation loss decreased (-0.208310 --> -0.583317).  Saving model ...
Epoch: 3 cost time: 2.630068302154541
Epoch: 3, Steps: 7 | Train Loss: 1.346 Vali Loss: 0.922 Vali Acc: 0.764 Test Loss: 0.922 Test Acc: 0.764
Validation loss decreased (-0.583317 --> -0.763880).  Saving model ...
Epoch: 4 cost time: 2.9534149169921875
Epoch: 4, Steps: 7 | Train Loss: 0.521 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.763880 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 2.0585737228393555
Epoch: 5, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.676 Vali Acc: 0.792 Test Loss: 0.676 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1830151081085205
Epoch: 6, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 2.8116674423217773
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.906 Vali Acc: 0.806 Test Loss: 0.906 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.815049886703491
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.491 Vali Acc: 0.903 Test Loss: 0.491 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 2.73097825050354
Epoch: 9, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 2.912682294845581
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7992892265319824
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 2.853283166885376
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.9698410034179688
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.712850570678711
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.619615316390991
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.648904323577881
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6437902450561523
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.414193630218506
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.962775945663452
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.064343214035034
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.908881425857544
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.068622350692749
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2659411430358887
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 9031484
model size : 39.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.211527347564697
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.426 Vali Acc: 0.194 Test Loss: 2.426 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.420515298843384
Epoch: 2, Steps: 7 | Train Loss: 2.123 Vali Loss: 1.581 Vali Acc: 0.722 Test Loss: 1.581 Test Acc: 0.722
Validation loss decreased (-0.194420 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 2.014585256576538
Epoch: 3, Steps: 7 | Train Loss: 1.156 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.722206 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 2.453752040863037
Epoch: 4, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.749991 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 2.7999844551086426
Epoch: 5, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.66340708732605
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 3.1019845008850098
Epoch: 7, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0829434394836426
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6960864067077637
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6985585689544678
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 2.0809764862060547
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 3.030064105987549
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 2.7357177734375
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.651113986968994
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.7411129474639893
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.7919421195983887
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.5079033374786377
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.7338244915008545
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.186171770095825
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5710384845733643
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.642143487930298
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.913233995437622
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7676806449890137
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.340245008468628
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0924909114837646
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.469076633453369
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.601921319961548
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.577932119369507
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 8986684
model size : 39.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.367100238800049
Epoch: 1, Steps: 7 | Train Loss: 2.687 Vali Loss: 2.439 Vali Acc: 0.153 Test Loss: 2.439 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.3653733730316162
Epoch: 2, Steps: 7 | Train Loss: 2.473 Vali Loss: 1.882 Vali Acc: 0.569 Test Loss: 1.882 Test Acc: 0.569
Validation loss decreased (-0.152753 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 2.6804213523864746
Epoch: 3, Steps: 7 | Train Loss: 1.540 Vali Loss: 1.127 Vali Acc: 0.653 Test Loss: 1.127 Test Acc: 0.653
Validation loss decreased (-0.569426 --> -0.652767).  Saving model ...
Epoch: 4 cost time: 2.6173267364501953
Epoch: 4, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.652767 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 3.1159870624542236
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 3.181760311126709
Epoch: 6, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 2.9727590084075928
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.5935916900634766
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8892924785614014
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.666839122772217
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.563337802886963
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.175765037536621
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0011324882507324
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8465073108673096
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5274267196655273
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4871158599853516
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.969393491744995
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7012276649475098
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.756056547164917
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8661436
model size : 38.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.87164044380188
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.347 Vali Acc: 0.208 Test Loss: 2.347 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 3.252079486846924
Epoch: 2, Steps: 7 | Train Loss: 2.162 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
Validation loss decreased (-0.208310 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 3.065415620803833
Epoch: 3, Steps: 7 | Train Loss: 1.185 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
Validation loss decreased (-0.499984 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 2.582797050476074
Epoch: 4, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.722213 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 2.516479969024658
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.40777587890625
Epoch: 6, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3539116382598877
Epoch: 7, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 2.325688600540161
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.645090103149414
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5230062007904053
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5494935512542725
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.223217248916626
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3631858825683594
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9918053150177002
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1115052700042725
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8621740341186523
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.262220621109009
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 8616636
model size : 37.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.0361785888671875
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.445 Vali Acc: 0.181 Test Loss: 2.445 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.977837324142456
Epoch: 2, Steps: 7 | Train Loss: 2.314 Vali Loss: 1.750 Vali Acc: 0.569 Test Loss: 1.750 Test Acc: 0.569
Validation loss decreased (-0.180531 --> -0.569427).  Saving model ...
Epoch: 3 cost time: 2.3844668865203857
Epoch: 3, Steps: 7 | Train Loss: 1.382 Vali Loss: 0.999 Vali Acc: 0.764 Test Loss: 0.999 Test Acc: 0.764
Validation loss decreased (-0.569427 --> -0.763879).  Saving model ...
Epoch: 4 cost time: 2.7407848834991455
Epoch: 4, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.571 Vali Acc: 0.847 Test Loss: 0.571 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 2.56284761428833
Epoch: 5, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.524 Vali Acc: 0.792 Test Loss: 0.524 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8763253688812256
Epoch: 6, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.847217 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.352057456970215
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.558 Vali Acc: 0.847 Test Loss: 0.558 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5919411182403564
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.13130259513855
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8447701930999756
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 2.924445629119873
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6266863346099854
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 2.5763111114501953
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.944 Test Loss: 0.149 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 2.3956398963928223
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.931 Test Loss: 0.131 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.198664665222168
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.931 Test Loss: 0.127 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8138675689697266
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.931 Test Loss: 0.127 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7440531253814697
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.931 Test Loss: 0.128 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4728000164031982
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.931 Test Loss: 0.128 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.929888963699341
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.931 Test Loss: 0.128 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.911754846572876
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.931 Test Loss: 0.128 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.88342022895813
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.931 Test Loss: 0.128 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.2861244678497314
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.7539024353027344
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 2.448023557662964
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8834850788116455
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8090574741363525
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.988837480545044
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3718957901000977
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.944 Test Loss: 0.129 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.890160083770752
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.944 Test Loss: 0.129 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.6158993244171143
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.944 Test Loss: 0.129 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.756847620010376
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.944 Test Loss: 0.129 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.8801350593566895
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.944 Test Loss: 0.130 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.479048490524292
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.944 Test Loss: 0.130 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8571836
model size : 37.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.959195375442505
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.369 Vali Acc: 0.222 Test Loss: 2.369 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 2.8957815170288086
Epoch: 2, Steps: 7 | Train Loss: 2.197 Vali Loss: 1.642 Vali Acc: 0.597 Test Loss: 1.642 Test Acc: 0.597
Validation loss decreased (-0.222199 --> -0.597206).  Saving model ...
Epoch: 3 cost time: 1.9214136600494385
Epoch: 3, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.031 Vali Acc: 0.722 Test Loss: 1.031 Test Acc: 0.722
Validation loss decreased (-0.597206 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 2.405592918395996
Epoch: 4, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.722212 --> -0.819439).  Saving model ...
Epoch: 5 cost time: 2.6256942749023438
Epoch: 5, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.819439 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 2.7973902225494385
Epoch: 6, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 2.6025257110595703
Epoch: 7, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9036753177642822
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.755669593811035
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7559945583343506
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2388832569122314
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1641275882720947
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 2.176476001739502
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.931 Test Loss: 0.337 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 2.6733624935150146
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 2.357381820678711
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 2.700388193130493
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 2.332791805267334
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 2.5303637981414795
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 2.713477611541748
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.345684051513672
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6112585067749023
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.93975567817688
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9689457416534424
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6989219188690186
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6504404544830322
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7810285091400146
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.5886619091033936
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.806821584701538
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8527036
model size : 37.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.959871053695679
Epoch: 1, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.454 Vali Acc: 0.097 Test Loss: 2.454 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.849072217941284
Epoch: 2, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.216 Vali Acc: 0.264 Test Loss: 2.216 Test Acc: 0.264
Validation loss decreased (-0.097198 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 2.7133498191833496
Epoch: 3, Steps: 7 | Train Loss: 2.079 Vali Loss: 1.808 Vali Acc: 0.458 Test Loss: 1.808 Test Acc: 0.458
Validation loss decreased (-0.263867 --> -0.458315).  Saving model ...
Epoch: 4 cost time: 2.670600414276123
Epoch: 4, Steps: 7 | Train Loss: 1.287 Vali Loss: 1.017 Vali Acc: 0.778 Test Loss: 1.017 Test Acc: 0.778
Validation loss decreased (-0.458315 --> -0.777768).  Saving model ...
Epoch: 5 cost time: 2.901604413986206
Epoch: 5, Steps: 7 | Train Loss: 0.512 Vali Loss: 0.521 Vali Acc: 0.903 Test Loss: 0.521 Test Acc: 0.903
Validation loss decreased (-0.777768 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 2.90322208404541
Epoch: 6, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3411126136779785
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.125441551208496
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.902773 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 2.752023696899414
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1195781230926514
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2905075550079346
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7887449264526367
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5723249912261963
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3528153896331787
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7365176677703857
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.638993263244629
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9282619953155518
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.024902582168579
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4108092
model size : 18.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.040016412734985
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.431 Vali Acc: 0.153 Test Loss: 2.431 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 2.946584463119507
Epoch: 2, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.203 Vali Acc: 0.194 Test Loss: 2.203 Test Acc: 0.194
Validation loss decreased (-0.152753 --> -0.194422).  Saving model ...
Epoch: 3 cost time: 3.0420920848846436
Epoch: 3, Steps: 7 | Train Loss: 2.020 Vali Loss: 1.684 Vali Acc: 0.569 Test Loss: 1.684 Test Acc: 0.569
Validation loss decreased (-0.194422 --> -0.569428).  Saving model ...
Epoch: 4 cost time: 3.5972673892974854
Epoch: 4, Steps: 7 | Train Loss: 1.285 Vali Loss: 0.956 Vali Acc: 0.736 Test Loss: 0.956 Test Acc: 0.736
Validation loss decreased (-0.569428 --> -0.736102).  Saving model ...
Epoch: 5 cost time: 3.4136030673980713
Epoch: 5, Steps: 7 | Train Loss: 0.494 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.736102 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 3.441286325454712
Epoch: 6, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.439 Vali Acc: 0.819 Test Loss: 0.439 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.567007303237915
Epoch: 7, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 3.052797555923462
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.6988518238067627
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 3.034111499786377
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0273947715759277
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0101616382598877
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.948152542114258
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.237804889678955
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.071986675262451
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.4137074947357178
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 3.1256065368652344
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 3.1921019554138184
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 3.0272016525268555
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.3453257083892822
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5088658332824707
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9141879081726074
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.980119228363037
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0540544986724854
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 3.049440383911133
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 2.478620767593384
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 2.4142425060272217
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 2.471656322479248
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.6929807662963867
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.9306700229644775
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2849957942962646
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4669785499572754
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.872180938720703
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.7811241149902344
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 3.12835693359375
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 2.9357762336730957
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.036609649658203
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 3.4769644737243652
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 3.357984781265259
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 2.87561297416687
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 2.842670440673828
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.5531327724456787
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.834953546524048
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.5663633346557617
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.388554096221924
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 3.325117588043213
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 2.94773006439209
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 3.125842809677124
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 1.9008135795593262
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 2.3323309421539307
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 2.717327117919922
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.674532175064087
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.72713565826416
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.1599698066711426
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.809506416320801
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.414768695831299
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.8526835441589355
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 2.693641424179077
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 2.9186313152313232
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 2.971090316772461
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 3.2880516052246094
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 2.6658334732055664
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 2.6694564819335938
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 2.4163098335266113
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.9290552139282227
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.386495351791382
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.118016481399536
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.450331449508667
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 3.156001567840576
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 3.030911445617676
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 3.350428819656372
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.767416000366211
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 3.097856044769287
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4085692
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.267409086227417
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.360 Vali Acc: 0.194 Test Loss: 2.360 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 3.1824564933776855
Epoch: 2, Steps: 7 | Train Loss: 2.351 Vali Loss: 1.999 Vali Acc: 0.486 Test Loss: 1.999 Test Acc: 0.486
Validation loss decreased (-0.194421 --> -0.486091).  Saving model ...
Epoch: 3 cost time: 2.9255237579345703
Epoch: 3, Steps: 7 | Train Loss: 1.771 Vali Loss: 1.323 Vali Acc: 0.764 Test Loss: 1.323 Test Acc: 0.764
Validation loss decreased (-0.486091 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 2.935338258743286
Epoch: 4, Steps: 7 | Train Loss: 0.927 Vali Loss: 0.751 Vali Acc: 0.819 Test Loss: 0.751 Test Acc: 0.819
Validation loss decreased (-0.763876 --> -0.819437).  Saving model ...
Epoch: 5 cost time: 2.582232713699341
Epoch: 5, Steps: 7 | Train Loss: 0.366 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.819437 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 2.718186616897583
Epoch: 6, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4475324153900146
Epoch: 7, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.9929301738739014
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5082833766937256
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.813300848007202
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.037607192993164
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.6448824405670166
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.566432237625122
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2850492000579834
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 2.285064220428467
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 2.402193546295166
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 2.753730058670044
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1711084842681885
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.299875020980835
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4171767234802246
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.408820152282715
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.684849500656128
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.775315999984741
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1006340980529785
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.813960075378418
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.372304916381836
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4063292
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.053239345550537
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.394 Vali Acc: 0.264 Test Loss: 2.394 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 2.6272783279418945
Epoch: 2, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.070 Vali Acc: 0.556 Test Loss: 2.070 Test Acc: 0.556
Validation loss decreased (-0.263865 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 2.731623649597168
Epoch: 3, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.394 Vali Acc: 0.639 Test Loss: 1.394 Test Acc: 0.639
Validation loss decreased (-0.555535 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 2.322312116622925
Epoch: 4, Steps: 7 | Train Loss: 1.003 Vali Loss: 0.803 Vali Acc: 0.806 Test Loss: 0.803 Test Acc: 0.806
Validation loss decreased (-0.638875 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 2.050532102584839
Epoch: 5, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.431 Vali Acc: 0.931 Test Loss: 0.431 Test Acc: 0.931
Validation loss decreased (-0.805548 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 2.322234630584717
Epoch: 6, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.893721103668213
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.111693859100342
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1895792484283447
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5726864337921143
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 3.1672372817993164
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.5519275665283203
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.728746175765991
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.9488096237182617
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7884907722473145
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5365614891052246
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.688622236251831
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2160890102386475
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6046087741851807
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.081911325454712
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.690978765487671
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7531726360321045
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.402395248413086
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4040892
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.167879343032837
Epoch: 1, Steps: 7 | Train Loss: 2.691 Vali Loss: 2.452 Vali Acc: 0.097 Test Loss: 2.452 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.875554084777832
Epoch: 2, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.192 Vali Acc: 0.458 Test Loss: 2.192 Test Acc: 0.458
Validation loss decreased (-0.097198 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 2.308940887451172
Epoch: 3, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.696 Vali Acc: 0.514 Test Loss: 1.696 Test Acc: 0.514
Validation loss decreased (-0.458311 --> -0.513872).  Saving model ...
Epoch: 4 cost time: 2.0552077293395996
Epoch: 4, Steps: 7 | Train Loss: 1.294 Vali Loss: 1.044 Vali Acc: 0.778 Test Loss: 1.044 Test Acc: 0.778
Validation loss decreased (-0.513872 --> -0.777767).  Saving model ...
Epoch: 5 cost time: 2.746302604675293
Epoch: 5, Steps: 7 | Train Loss: 0.564 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.777767 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 2.874917507171631
Epoch: 6, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9263739585876465
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6466259956359863
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.5448153018951416
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 2.5277998447418213
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1833913326263428
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.702697277069092
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.032358407974243
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.451756715774536
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.674027681350708
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.683833599090576
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.6841084957122803
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 3.0606582164764404
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.2683281898498535
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 3.038638114929199
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.272671699523926
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.599086046218872
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1369340419769287
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.855229377746582
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.183068037033081
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4530017375946045
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 3.228947877883911
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.86588716506958
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.8174428939819336
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.9518563747406006
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.9634969234466553
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.98518443107605
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.7685296535491943
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.946946144104004
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.330430269241333
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.9532511234283447
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.505096673965454
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.73677396774292
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.883009433746338
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.722105026245117
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 3187004
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.545666217803955
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.460 Vali Acc: 0.069 Test Loss: 2.460 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 2.176607131958008
Epoch: 2, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.240 Vali Acc: 0.264 Test Loss: 2.240 Test Acc: 0.264
Validation loss decreased (-0.069420 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 2.567922592163086
Epoch: 3, Steps: 7 | Train Loss: 2.109 Vali Loss: 1.799 Vali Acc: 0.556 Test Loss: 1.799 Test Acc: 0.556
Validation loss decreased (-0.263866 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 2.5230839252471924
Epoch: 4, Steps: 7 | Train Loss: 1.380 Vali Loss: 1.184 Vali Acc: 0.736 Test Loss: 1.184 Test Acc: 0.736
Validation loss decreased (-0.555538 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 2.8243203163146973
Epoch: 5, Steps: 7 | Train Loss: 0.689 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
Validation loss decreased (-0.736099 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.7710833549499512
Epoch: 6, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
Validation loss decreased (-0.833327 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 3.507302761077881
Epoch: 7, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.448364019393921
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1603238582611084
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2764780521392822
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.847 Test Loss: 0.389 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9348297119140625
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 3.166860580444336
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.591217041015625
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 2.938262939453125
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 1.9664645195007324
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 2.9205729961395264
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 3.1182994842529297
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.5728559494018555
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 2.905726194381714
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.804690361022949
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.892090082168579
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6839945316314697
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0945186614990234
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8115427494049072
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 3.3719682693481445
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 3.035771608352661
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.8943660259246826
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9599080085754395
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0837531089782715
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.753605365753174
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1939070224761963
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 2.6258554458618164
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 2.737018585205078
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.6828856468200684
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.1814804077148438
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.552112579345703
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.8438496589660645
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.467776298522949
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 2.6393041610717773
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 2.1949734687805176
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 2.633535861968994
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.273973226547241
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 3.091937303543091
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 2.7481493949890137
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 3.1487069129943848
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 2.477348566055298
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.36322021484375
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 2.4797492027282715
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 2.483750581741333
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.976106882095337
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 2.430567741394043
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 2.5746591091156006
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 2.5029797554016113
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 2.3131561279296875
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 2.7066874504089355
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 2.5354714393615723
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.6936147212982178
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.7238762378692627
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.371006727218628
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.1117451190948486
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.0730702877044678
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 2.7165629863739014
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 2.748349189758301
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 2.744138717651367
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 2.5968081951141357
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.0803942680358887
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 2.749739170074463
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.196991443634033
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 2.8088538646698
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 2.815966844558716
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 2.963979721069336
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.782870054244995
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.490715980529785
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.665935754776001
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.546755075454712
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.121436834335327
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 2.9971330165863037
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 3.3138716220855713
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 3.0044333934783936
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 2.2307400703430176
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 2.7299771308898926
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 82 cost time: 3.008723020553589
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 2.793596029281616
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 3.252561569213867
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 3.19260311126709
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 2.938812255859375
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 3.0536091327667236
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.3097681999206543
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 2.83699631690979
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 2.886857271194458
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 2.8335318565368652
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 2.527702569961548
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3164604
model size : 14.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.792226552963257
Epoch: 1, Steps: 7 | Train Loss: 2.655 Vali Loss: 2.437 Vali Acc: 0.181 Test Loss: 2.437 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.483935832977295
Epoch: 2, Steps: 7 | Train Loss: 2.380 Vali Loss: 2.027 Vali Acc: 0.528 Test Loss: 2.027 Test Acc: 0.528
Validation loss decreased (-0.180531 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 2.706153392791748
Epoch: 3, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.471 Vali Acc: 0.736 Test Loss: 1.471 Test Acc: 0.736
Validation loss decreased (-0.527758 --> -0.736096).  Saving model ...
Epoch: 4 cost time: 2.6500513553619385
Epoch: 4, Steps: 7 | Train Loss: 1.036 Vali Loss: 0.902 Vali Acc: 0.806 Test Loss: 0.902 Test Acc: 0.806
Validation loss decreased (-0.736096 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 2.847532033920288
Epoch: 5, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 2.5814592838287354
Epoch: 6, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.903454065322876
Epoch: 7, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.325178623199463
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.227088689804077
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0569305419921875
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.737924337387085
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 2.770989418029785
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.0747575759887695
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9568047523498535
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6805484294891357
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7428810596466064
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.876929759979248
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.580000400543213
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.3443472385406494
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.188493013381958
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.301557779312134
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.6356849670410156
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.4966394901275635
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.107483386993408
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.912374496459961
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.50400447845459
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.629404306411743
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.711787462234497
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.5561931133270264
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.284883737564087
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 2.6694157123565674
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.926377296447754
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.848907470703125
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.926342248916626
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.833235263824463
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2338733673095703
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.2374038696289062
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.9414470195770264
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.9046690464019775
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.801443576812744
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.1234488487243652
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3142204
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.50441575050354
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.375 Vali Acc: 0.167 Test Loss: 2.375 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.3654937744140625
Epoch: 2, Steps: 7 | Train Loss: 2.389 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
Validation loss decreased (-0.166643 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 2.312880516052246
Epoch: 3, Steps: 7 | Train Loss: 2.033 Vali Loss: 1.649 Vali Acc: 0.556 Test Loss: 1.649 Test Acc: 0.556
Validation loss decreased (-0.499979 --> -0.555539).  Saving model ...
Epoch: 4 cost time: 2.195924997329712
Epoch: 4, Steps: 7 | Train Loss: 1.270 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.555539 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 2.7601962089538574
Epoch: 5, Steps: 7 | Train Loss: 0.572 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.624989 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 2.5965137481689453
Epoch: 6, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 2.5048623085021973
Epoch: 7, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.667403221130371
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 2.7821969985961914
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.8512177467346191
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.799400806427002
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.504148483276367
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.639425277709961
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6271746158599854
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.524367332458496
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.5481832027435303
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2454850673675537
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.5094454288482666
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.820234775543213
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.8489627838134766
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.674043655395508
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.938791275024414
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2576725482940674
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6906964778900146
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1677846908569336
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2532689571380615
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3447775840759277
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7623331546783447
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.334712505340576
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6782755851745605
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3119804
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.819119930267334
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.382 Vali Acc: 0.167 Test Loss: 2.382 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.8795087337493896
Epoch: 2, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.138 Vali Acc: 0.403 Test Loss: 2.138 Test Acc: 0.403
Validation loss decreased (-0.166643 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 2.2675299644470215
Epoch: 3, Steps: 7 | Train Loss: 1.926 Vali Loss: 1.745 Vali Acc: 0.403 Test Loss: 1.745 Test Acc: 0.403
Validation loss decreased (-0.402756 --> -0.402760).  Saving model ...
Epoch: 4 cost time: 2.9709601402282715
Epoch: 4, Steps: 7 | Train Loss: 1.189 Vali Loss: 1.095 Vali Acc: 0.764 Test Loss: 1.095 Test Acc: 0.764
Validation loss decreased (-0.402760 --> -0.763878).  Saving model ...
Epoch: 5 cost time: 2.160304546356201
Epoch: 5, Steps: 7 | Train Loss: 0.784 Vali Loss: 0.638 Vali Acc: 0.792 Test Loss: 0.638 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791660).  Saving model ...
Epoch: 6 cost time: 2.350001811981201
Epoch: 6, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
Validation loss decreased (-0.791660 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 2.6928460597991943
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8565874099731445
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.986065149307251
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 3.291043758392334
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.681062698364258
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.82216215133667
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.511859655380249
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.9663889408111572
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.8811938762664795
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8143739700317383
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0928823947906494
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.750833034515381
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.892249584197998
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.844691276550293
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8722012042999268
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6710205078125
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.211229085922241
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.965550184249878
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2726460
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2594852447509766
Epoch: 1, Steps: 7 | Train Loss: 2.647 Vali Loss: 2.463 Vali Acc: 0.167 Test Loss: 2.463 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.8680648803710938
Epoch: 2, Steps: 7 | Train Loss: 2.481 Vali Loss: 2.178 Vali Acc: 0.528 Test Loss: 2.178 Test Acc: 0.528
Validation loss decreased (-0.166642 --> -0.527756).  Saving model ...
Epoch: 3 cost time: 1.7460529804229736
Epoch: 3, Steps: 7 | Train Loss: 2.060 Vali Loss: 1.806 Vali Acc: 0.417 Test Loss: 1.806 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.25984525680542
Epoch: 4, Steps: 7 | Train Loss: 1.337 Vali Loss: 1.210 Vali Acc: 0.611 Test Loss: 1.210 Test Acc: 0.611
Validation loss decreased (-0.527756 --> -0.611099).  Saving model ...
Epoch: 5 cost time: 2.224137783050537
Epoch: 5, Steps: 7 | Train Loss: 0.751 Vali Loss: 0.682 Vali Acc: 0.889 Test Loss: 0.682 Test Acc: 0.889
Validation loss decreased (-0.611099 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 2.179518222808838
Epoch: 6, Steps: 7 | Train Loss: 0.263 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 2.573392629623413
Epoch: 7, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.088700771331787
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 2.289710521697998
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0899252891540527
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.8937828540802002
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.458142042160034
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.709226131439209
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.3644134998321533
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.529648780822754
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.602670192718506
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6123263835906982
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5438032150268555
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5922443866729736
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6104929447174072
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6516599655151367
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.783083915710449
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7627665996551514
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2704060
model size : 12.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.789447069168091
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.406 Vali Acc: 0.181 Test Loss: 2.406 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 2.477586030960083
Epoch: 2, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.049 Vali Acc: 0.431 Test Loss: 2.049 Test Acc: 0.431
Validation loss decreased (-0.180531 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 2.3396944999694824
Epoch: 3, Steps: 7 | Train Loss: 1.902 Vali Loss: 1.650 Vali Acc: 0.583 Test Loss: 1.650 Test Acc: 0.583
Validation loss decreased (-0.430535 --> -0.583317).  Saving model ...
Epoch: 4 cost time: 2.494398832321167
Epoch: 4, Steps: 7 | Train Loss: 1.180 Vali Loss: 1.015 Vali Acc: 0.792 Test Loss: 1.015 Test Acc: 0.792
Validation loss decreased (-0.583317 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 2.7841880321502686
Epoch: 5, Steps: 7 | Train Loss: 0.630 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
Validation loss decreased (-0.791657 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 2.3094680309295654
Epoch: 6, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.127147674560547
Epoch: 7, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1208574771881104
Epoch: 8, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.51252818107605
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 2.510256290435791
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.0533692836761475
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.171534538269043
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7582311630249023
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.306156873703003
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 2.4889841079711914
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 2.460580825805664
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3492071628570557
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.556454658508301
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5704658031463623
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6158392429351807
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7321362495422363
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.657167673110962
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2668333053588867
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 2.813060998916626
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.638659954071045
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 2.9651076793670654
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.602536916732788
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.847184181213379
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.13008975982666
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.46212100982666
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.80352783203125
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.6019415855407715
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.454439401626587
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.425046920776367
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.550957679748535
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.560091018676758
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 2.712318181991577
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.4226577281951904
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.4900012016296387
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 2.4866034984588623
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 2.5011532306671143
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 2.2344260215759277
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 2.7028608322143555
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 2.3082425594329834
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 2.6727678775787354
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 2.274600028991699
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 2.6610686779022217
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.275820255279541
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 2.501267433166504
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 2.5124475955963135
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 2.488760232925415
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.429872751235962
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 2.829787254333496
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 2.408174753189087
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.7167341709136963
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.743743896484375
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.9635138511657715
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.4888758659362793
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.598069429397583
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.962527275085449
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.4410085678100586
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.9947054386138916
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.6921212673187256
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2681660
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.727246999740601
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.390 Vali Acc: 0.111 Test Loss: 2.390 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.972506046295166
Epoch: 2, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.025 Vali Acc: 0.444 Test Loss: 2.025 Test Acc: 0.444
Validation loss decreased (-0.111087 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 2.260169267654419
Epoch: 3, Steps: 7 | Train Loss: 1.748 Vali Loss: 1.509 Vali Acc: 0.556 Test Loss: 1.509 Test Acc: 0.556
Validation loss decreased (-0.444424 --> -0.555540).  Saving model ...
Epoch: 4 cost time: 2.151621103286743
Epoch: 4, Steps: 7 | Train Loss: 1.037 Vali Loss: 0.913 Vali Acc: 0.736 Test Loss: 0.913 Test Acc: 0.736
Validation loss decreased (-0.555540 --> -0.736102).  Saving model ...
Epoch: 5 cost time: 1.8376057147979736
Epoch: 5, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.736102 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 2.0407254695892334
Epoch: 6, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.406 Vali Acc: 0.847 Test Loss: 0.406 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8439409732818604
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 2.12503981590271
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.564840316772461
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 2.7504053115844727
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.433931589126587
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.6653764247894287
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.1713156700134277
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.00052809715271
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2670106887817383
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.470182180404663
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.0383522510528564
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.667206287384033
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.61360764503479
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.4686856269836426
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.2526988983154297
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.387237548828125
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3620951175689697
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.355102777481079
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.247377634048462
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1950957775115967
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3426826000213623
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3497273921966553
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.7175426483154297
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.219266891479492
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5490007400512695
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2344205379486084
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 2.3708903789520264
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.03521466255188
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6975343227386475
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.297506809234619
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.4879941940307617
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.421375036239624
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.5456900596618652
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.5228848457336426
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.5718441009521484
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.0605993270874023
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9897432327270508
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2659260
model size : 12.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.513737201690674
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.410 Vali Acc: 0.208 Test Loss: 2.410 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 2.987764835357666
Epoch: 2, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.105 Vali Acc: 0.431 Test Loss: 2.105 Test Acc: 0.431
Validation loss decreased (-0.208309 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 3.0383684635162354
Epoch: 3, Steps: 7 | Train Loss: 1.964 Vali Loss: 1.759 Vali Acc: 0.583 Test Loss: 1.759 Test Acc: 0.583
Validation loss decreased (-0.430535 --> -0.583316).  Saving model ...
Epoch: 4 cost time: 2.800424098968506
Epoch: 4, Steps: 7 | Train Loss: 1.352 Vali Loss: 1.067 Vali Acc: 0.833 Test Loss: 1.067 Test Acc: 0.833
Validation loss decreased (-0.583316 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 3.008683443069458
Epoch: 5, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3207345008850098
Epoch: 6, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.833323 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 3.008817195892334
Epoch: 7, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.743912696838379
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.577997922897339
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.6354954242706299
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.6010122299194336
Epoch: 11, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.078267812728882
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9123001098632812
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.175738573074341
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.1642205715179443
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.3463780879974365
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9992268085479736
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9690468311309814
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.4636685848236084
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.9906604290008545
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.594087600708008
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7207350730895996
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3044650554656982
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.867211103439331
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.31811785697937
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.023916721343994
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6850831508636475
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.729142904281616
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.688835382461548
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.341568946838379
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.8321025371551514
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.7257630825042725
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.583883762359619
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.2765252590179443
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2496188
model size : 12.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.333467960357666
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.461 Vali Acc: 0.125 Test Loss: 2.461 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.4903347492218018
Epoch: 2, Steps: 7 | Train Loss: 2.320 Vali Loss: 2.157 Vali Acc: 0.389 Test Loss: 2.157 Test Acc: 0.389
Validation loss decreased (-0.124975 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 2.685109853744507
Epoch: 3, Steps: 7 | Train Loss: 1.966 Vali Loss: 1.694 Vali Acc: 0.486 Test Loss: 1.694 Test Acc: 0.486
Validation loss decreased (-0.388867 --> -0.486094).  Saving model ...
Epoch: 4 cost time: 2.7991461753845215
Epoch: 4, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.211 Vali Acc: 0.736 Test Loss: 1.211 Test Acc: 0.736
Validation loss decreased (-0.486094 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 2.4384195804595947
Epoch: 5, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.674 Vali Acc: 0.847 Test Loss: 0.674 Test Acc: 0.847
Validation loss decreased (-0.736099 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 2.5004496574401855
Epoch: 6, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 2.5120222568511963
Epoch: 7, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 2.793757677078247
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 2.4931766986846924
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.8996422290802
Epoch: 10, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9825878143310547
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.508239507675171
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8637871742248535
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.9958322048187256
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.916417360305786
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 2.59513521194458
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9098706245422363
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2681024074554443
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.248353958129883
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 2.473067045211792
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 2.6400258541107178
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.43636155128479
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8598830699920654
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.769050121307373
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.609800338745117
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6642472743988037
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.7621638774871826
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3913042545318604
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.730501890182495
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.6391680240631104
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.680521011352539
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.7156176567077637
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 3.125788688659668
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.7833714485168457
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.4979794025421143
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 2.6674931049346924
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.4743895530700684
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.642005443572998
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 2.121098279953003
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 3.191847324371338
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.7178375720977783
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 3.2952449321746826
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 3.7319514751434326
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.760737180709839
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 2.459134817123413
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 2.0566020011901855
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 2.8900725841522217
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 2.6646158695220947
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.762287139892578
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.5129446983337402
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.9279086589813232
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.34918212890625
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.571953296661377
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.1604113578796387
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 2.7583842277526855
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.1904776096343994
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.725029706954956
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.9412190914154053
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.8879199028015137
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.357581853866577
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.0651049613952637
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.9786152839660645
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.957087755203247
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.6168909072875977
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2473788
model size : 12.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.450121164321899
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.413 Vali Acc: 0.153 Test Loss: 2.413 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 3.1625471115112305
Epoch: 2, Steps: 7 | Train Loss: 2.451 Vali Loss: 2.172 Vali Acc: 0.333 Test Loss: 2.172 Test Acc: 0.333
Validation loss decreased (-0.152754 --> -0.333312).  Saving model ...
Epoch: 3 cost time: 2.7448630332946777
Epoch: 3, Steps: 7 | Train Loss: 2.062 Vali Loss: 1.753 Vali Acc: 0.597 Test Loss: 1.753 Test Acc: 0.597
Validation loss decreased (-0.333312 --> -0.597205).  Saving model ...
Epoch: 4 cost time: 2.5593631267547607
Epoch: 4, Steps: 7 | Train Loss: 1.475 Vali Loss: 1.234 Vali Acc: 0.764 Test Loss: 1.234 Test Acc: 0.764
Validation loss decreased (-0.597205 --> -0.763877).  Saving model ...
Epoch: 5 cost time: 2.8783276081085205
Epoch: 5, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.691 Vali Acc: 0.861 Test Loss: 0.691 Test Acc: 0.861
Validation loss decreased (-0.763877 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 2.5226547718048096
Epoch: 6, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.746506690979004
Epoch: 7, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 2.4456281661987305
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 3.119683265686035
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.593820095062256
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.710625171661377
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.4090774059295654
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.661835193634033
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.492670774459839
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.3047215938568115
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 2.650132894515991
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 2.471775531768799
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 2.5799825191497803
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.8100435733795166
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.9895448684692383
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.627120018005371
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.262108564376831
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 2.5119497776031494
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.493037700653076
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.4084744453430176
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.708125114440918
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.3288283348083496
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.635385513305664
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1661691665649414
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7066402435302734
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.375027656555176
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.585761547088623
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.6333107948303223
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.6523125171661377
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.6981728076934814
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.5128703117370605
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2451388
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.475508213043213
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.1091976165771484
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.216 Vali Acc: 0.236 Test Loss: 2.216 Test Acc: 0.236
Validation loss decreased (-0.124976 --> -0.236089).  Saving model ...
Epoch: 3 cost time: 2.3930628299713135
Epoch: 3, Steps: 7 | Train Loss: 2.049 Vali Loss: 1.803 Vali Acc: 0.361 Test Loss: 1.803 Test Acc: 0.361
Validation loss decreased (-0.236089 --> -0.361093).  Saving model ...
Epoch: 4 cost time: 2.5960946083068848
Epoch: 4, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.173 Vali Acc: 0.792 Test Loss: 1.173 Test Acc: 0.792
Validation loss decreased (-0.361093 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 2.329271078109741
Epoch: 5, Steps: 7 | Train Loss: 0.727 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
Validation loss decreased (-0.791655 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 2.5133304595947266
Epoch: 6, Steps: 7 | Train Loss: 0.318 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2119033336639404
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 2.213564395904541
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.1197025775909424
Epoch: 9, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.549341917037964
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5490119457244873
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6858370304107666
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.5601959228515625
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.548720121383667
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8034000396728516
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3333511352539062
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.6818060874938965
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 2.1415162086486816
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7080514430999756
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 2.745151996612549
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 2.6809091567993164
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 2.090646982192993
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 2.261305570602417
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 2.464202880859375
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 2.320971965789795
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 2.080181360244751
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.469062328338623
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 2.429257392883301
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 2.4360296726226807
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.26651930809021
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3512485027313232
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.1038358211517334
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7962193489074707
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2527146339416504
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 1.8452918529510498
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 1.8690857887268066
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 2.264997959136963
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 2.252185821533203
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 2.105154275894165
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.383634328842163
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.055410623550415
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.3199026584625244
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.600677967071533
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.42690372467041
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0020267963409424
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.4623336791992188
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.3151211738586426
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.496971607208252
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2428988
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.447214126586914
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.398 Vali Acc: 0.194 Test Loss: 2.398 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 2.8429272174835205
Epoch: 2, Steps: 7 | Train Loss: 2.372 Vali Loss: 2.337 Vali Acc: 0.264 Test Loss: 2.337 Test Acc: 0.264
Validation loss decreased (-0.194420 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 2.717074155807495
Epoch: 3, Steps: 7 | Train Loss: 2.215 Vali Loss: 2.010 Vali Acc: 0.625 Test Loss: 2.010 Test Acc: 0.625
Validation loss decreased (-0.263866 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 2.2109227180480957
Epoch: 4, Steps: 7 | Train Loss: 1.725 Vali Loss: 1.462 Vali Acc: 0.736 Test Loss: 1.462 Test Acc: 0.736
Validation loss decreased (-0.624980 --> -0.736096).  Saving model ...
Epoch: 5 cost time: 2.5366036891937256
Epoch: 5, Steps: 7 | Train Loss: 1.058 Vali Loss: 0.988 Vali Acc: 0.806 Test Loss: 0.988 Test Acc: 0.806
Validation loss decreased (-0.736096 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 2.364783763885498
Epoch: 6, Steps: 7 | Train Loss: 0.537 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
Validation loss decreased (-0.805546 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 2.7057361602783203
Epoch: 7, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1823313236236572
Epoch: 8, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 2.564133405685425
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4939379692077637
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 2.645841360092163
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.3384673595428467
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.3037290573120117
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2704050540924072
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.0418832302093506
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.2353641986846924
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.2697885036468506
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.01190185546875
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.565012216567993
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.523571491241455
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1193482875823975
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.178253173828125
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.5803892612457275
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.486546039581299
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.9118726253509521
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9983525276184082
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.270897626876831
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.68410325050354
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.455321788787842
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.1262738704681396
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.672292709350586
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6725406646728516
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.971853017807007
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.803187847137451
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 2.740312099456787
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 2.8113341331481934
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 2.7419025897979736
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.6977455615997314
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.552635431289673
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.692841053009033
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.6029610633850098
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.5124974250793457
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.8516762256622314
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.8291876316070557
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.6223881244659424
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.5136139392852783
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.3982059955596924
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1598908
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.356369733810425
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.466 Vali Acc: 0.097 Test Loss: 2.466 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.176450490951538
Epoch: 2, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.295 Vali Acc: 0.278 Test Loss: 2.295 Test Acc: 0.278
Validation loss decreased (-0.097198 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 2.54506254196167
Epoch: 3, Steps: 7 | Train Loss: 2.103 Vali Loss: 1.945 Vali Acc: 0.569 Test Loss: 1.945 Test Acc: 0.569
Validation loss decreased (-0.277755 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 2.2692337036132812
Epoch: 4, Steps: 7 | Train Loss: 1.740 Vali Loss: 1.454 Vali Acc: 0.667 Test Loss: 1.454 Test Acc: 0.667
Validation loss decreased (-0.569425 --> -0.666652).  Saving model ...
Epoch: 5 cost time: 2.7109758853912354
Epoch: 5, Steps: 7 | Train Loss: 1.078 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.666652 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.871117353439331
Epoch: 6, Steps: 7 | Train Loss: 0.537 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
Validation loss decreased (-0.749990 --> -0.819439).  Saving model ...
Epoch: 7 cost time: 2.7673144340515137
Epoch: 7, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
Validation loss decreased (-0.819439 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 2.4070446491241455
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 2.8497700691223145
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.4734466075897217
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.58825945854187
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.0649185180664062
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 2.2374989986419678
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.9880986213684082
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.9642505645751953
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.030444622039795
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.838824987411499
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0579993724823
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.155806541442871
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.291513681411743
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.377332925796509
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3895936012268066
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6292521953582764
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.150113105773926
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.176485776901245
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1587708
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.127348899841309
Epoch: 1, Steps: 7 | Train Loss: 2.650 Vali Loss: 2.542 Vali Acc: 0.014 Test Loss: 2.542 Test Acc: 0.014
Validation loss decreased (inf --> -0.013863).  Saving model ...
Epoch: 2 cost time: 2.4046106338500977
Epoch: 2, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.436 Vali Acc: 0.139 Test Loss: 2.436 Test Acc: 0.139
Validation loss decreased (-0.013863 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 2.6685240268707275
Epoch: 3, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.222 Vali Acc: 0.333 Test Loss: 2.222 Test Acc: 0.333
Validation loss decreased (-0.138865 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 2.334855794906616
Epoch: 4, Steps: 7 | Train Loss: 2.068 Vali Loss: 1.880 Vali Acc: 0.597 Test Loss: 1.880 Test Acc: 0.597
Validation loss decreased (-0.333311 --> -0.597203).  Saving model ...
Epoch: 5 cost time: 2.3262698650360107
Epoch: 5, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.370 Vali Acc: 0.667 Test Loss: 1.370 Test Acc: 0.667
Validation loss decreased (-0.597203 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 2.6817307472229004
Epoch: 6, Steps: 7 | Train Loss: 0.921 Vali Loss: 0.824 Vali Acc: 0.889 Test Loss: 0.824 Test Acc: 0.889
Validation loss decreased (-0.666653 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 2.4593608379364014
Epoch: 7, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 2.360154628753662
Epoch: 8, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.392 Vali Acc: 0.917 Test Loss: 0.392 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 2.5638604164123535
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.778848648071289
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.172106981277466
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.4194066524505615
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.401090621948242
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.4176931381225586
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.565638303756714
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.315286159515381
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9865598678588867
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 2.0774600505828857
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.7996392250061035
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 2.2605109214782715
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 2.06136155128479
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4098708629608154
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0815656185150146
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1425633430480957
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.3017756938934326
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8407413959503174
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.127683162689209
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8828182220458984
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.138127565383911
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.6121246814727783
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 2.369291067123413
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.5242645740509033
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 2.251136302947998
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 2.3467257022857666
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.030694007873535
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3404791355133057
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.4342761039733887
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 2.3916826248168945
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 2.284592866897583
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 2.533143997192383
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 2.249052047729492
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 2.3352718353271484
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.9653525352478027
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.9145236015319824
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.843447208404541
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.95314621925354
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.839017629623413
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.794276237487793
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.8934555053710938
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 1.955611228942871
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.8386127948760986
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.895514726638794
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 2.0149054527282715
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.027756929397583
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.1924097537994385
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 2.0699610710144043
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.2877066135406494
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.9918899536132812
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.426206350326538
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.38789439201355
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.166802167892456
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.2896006107330322
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.0231597423553467
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.9943444728851318
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.294358968734741
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1576508
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.4058263301849365
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.459 Vali Acc: 0.097 Test Loss: 2.459 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.699413776397705
Epoch: 2, Steps: 7 | Train Loss: 2.437 Vali Loss: 2.332 Vali Acc: 0.167 Test Loss: 2.332 Test Acc: 0.167
Validation loss decreased (-0.097198 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.0488929748535156
Epoch: 3, Steps: 7 | Train Loss: 2.163 Vali Loss: 1.959 Vali Acc: 0.472 Test Loss: 1.959 Test Acc: 0.472
Validation loss decreased (-0.166643 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 2.1125359535217285
Epoch: 4, Steps: 7 | Train Loss: 1.695 Vali Loss: 1.497 Vali Acc: 0.694 Test Loss: 1.497 Test Acc: 0.694
Validation loss decreased (-0.472203 --> -0.694429).  Saving model ...
Epoch: 5 cost time: 2.232499361038208
Epoch: 5, Steps: 7 | Train Loss: 1.084 Vali Loss: 0.944 Vali Acc: 0.778 Test Loss: 0.944 Test Acc: 0.778
Validation loss decreased (-0.694429 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 2.34767484664917
Epoch: 6, Steps: 7 | Train Loss: 0.569 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
Validation loss decreased (-0.777768 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 2.4082493782043457
Epoch: 7, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.096733331680298
Epoch: 8, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.0817041397094727
Epoch: 9, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.338047504425049
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.31317400932312
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.1960580348968506
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0937466621398926
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.289031982421875
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.232030153274536
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8989672660827637
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0373830795288086
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8591961860656738
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.971865177154541
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9058337211608887
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1106042861938477
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1565308
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.204200029373169
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.460 Vali Acc: 0.083 Test Loss: 2.460 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.1394405364990234
Epoch: 2, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.346 Vali Acc: 0.181 Test Loss: 2.346 Test Acc: 0.181
Validation loss decreased (-0.083309 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 1.8094017505645752
Epoch: 3, Steps: 7 | Train Loss: 2.298 Vali Loss: 2.153 Vali Acc: 0.444 Test Loss: 2.153 Test Acc: 0.444
Validation loss decreased (-0.180532 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 2.1969971656799316
Epoch: 4, Steps: 7 | Train Loss: 2.044 Vali Loss: 1.785 Vali Acc: 0.611 Test Loss: 1.785 Test Acc: 0.611
Validation loss decreased (-0.444423 --> -0.611093).  Saving model ...
Epoch: 5 cost time: 2.260148048400879
Epoch: 5, Steps: 7 | Train Loss: 1.513 Vali Loss: 1.312 Vali Acc: 0.806 Test Loss: 1.312 Test Acc: 0.806
Validation loss decreased (-0.611093 --> -0.805542).  Saving model ...
Epoch: 6 cost time: 2.2313196659088135
Epoch: 6, Steps: 7 | Train Loss: 0.920 Vali Loss: 0.802 Vali Acc: 0.917 Test Loss: 0.802 Test Acc: 0.917
Validation loss decreased (-0.805542 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 2.36716365814209
Epoch: 7, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.229628086090088
Epoch: 8, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.627904176712036
Epoch: 9, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8366801738739014
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7646870613098145
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.709442615509033
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.4662623405456543
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.3759493827819824
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.7241287231445312
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.8801023960113525
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 2.980355739593506
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 2.7277672290802
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 2.590505599975586
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 1.845383644104004
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 1.8129229545593262
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 2.015430450439453
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.6929714679718018
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0302224159240723
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.7934582233428955
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.9558496475219727
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.8547172546386719
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6628186702728271
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1618804931640625
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.073373794555664
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 2.219444751739502
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.5850913524627686
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 2.4585728645324707
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.358772039413452
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.734607219696045
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2031071186065674
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.2016844749450684
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6879708766937256
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.810096025466919
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.0808374881744385
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7561585903167725
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.127864122390747
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.969573736190796
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.4010462760925293
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.195112943649292
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 2.5934653282165527
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 2.495656728744507
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 2.4200961589813232
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 2.45369815826416
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.2459781169891357
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.933379888534546
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 2.131765127182007
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.2967004776000977
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.388231039047241
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.139432191848755
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.174180746078491
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.1815977096557617
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.7161052227020264
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.0036303997039795
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.7235689163208008
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.8279855251312256
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1136572
model size : 5.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.375460386276245
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.480 Vali Acc: 0.083 Test Loss: 2.480 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 2.4386379718780518
Epoch: 2, Steps: 7 | Train Loss: 2.513 Vali Loss: 2.339 Vali Acc: 0.306 Test Loss: 2.339 Test Acc: 0.306
Validation loss decreased (-0.083309 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 2.500515937805176
Epoch: 3, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
Validation loss decreased (-0.305532 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 2.885779857635498
Epoch: 4, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.661 Vali Acc: 0.722 Test Loss: 1.661 Test Acc: 0.722
Validation loss decreased (-0.499980 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 2.4877679347991943
Epoch: 5, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.149 Vali Acc: 0.750 Test Loss: 1.149 Test Acc: 0.750
Validation loss decreased (-0.722206 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 3.0794332027435303
Epoch: 6, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
Validation loss decreased (-0.749989 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 3.061343193054199
Epoch: 7, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.473 Vali Acc: 0.917 Test Loss: 0.473 Test Acc: 0.917
Validation loss decreased (-0.833326 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 2.9461781978607178
Epoch: 8, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.393 Vali Acc: 0.917 Test Loss: 0.393 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 3.0595932006835938
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.244044780731201
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.5849251747131348
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5226247310638428
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4392967224121094
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.265442132949829
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.9501996040344238
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.8394956588745117
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.6828055381774902
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.8574862480163574
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5696589946746826
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.903386116027832
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.986603021621704
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.157073497772217
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.44877290725708
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.0085456371307373
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.4108715057373047
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.8365042209625244
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.555049180984497
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.7731120586395264
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 2.26344633102417
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.6329517364501953
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.7417032718658447
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.7713418006896973
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.8964307308197021
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.9684031009674072
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.9469645023345947
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6943426132202148
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 2.134194850921631
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.1566598415374756
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 2.353618621826172
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 2.2436609268188477
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 2.3689839839935303
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.2538397312164307
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 2.3185677528381348
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.239853620529175
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.2633352279663086
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 2.3174989223480225
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 2.2497901916503906
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 2.3322741985321045
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 2.2939343452453613
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 2.339780807495117
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 2.248481273651123
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 1.9166734218597412
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.0590593814849854
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 2.031599283218384
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 2.050813913345337
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.6900725364685059
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 1.603083848953247
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.9382259845733643
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.672034502029419
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 2.4461002349853516
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 2.431346893310547
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 2.4528965950012207
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 2.2435834407806396
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 2.2411460876464844
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 2.337390184402466
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 66 cost time: 2.3397693634033203
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 1.4501194953918457
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 68 cost time: 2.3206632137298584
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 2.2445876598358154
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 2.1845245361328125
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 2.2950406074523926
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 2.0230660438537598
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 2.3252506256103516
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 2.2929680347442627
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.37229061126709
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 2.3722598552703857
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 2.4501216411590576
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.385577440261841
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.64951491355896
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 2.5387072563171387
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 2.2995495796203613
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 82 cost time: 2.3399438858032227
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 2.387310743331909
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 2.446087121963501
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 2.3342413902282715
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.4348905086517334
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.260014295578003
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 2.6171317100524902
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 2.317889451980591
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 2.3227310180664062
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 2.4655539989471436
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 2.32540225982666
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 1.7308812141418457
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 1.9385547637939453
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1125372
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.486042499542236
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.466 Vali Acc: 0.111 Test Loss: 2.466 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.8805420398712158
Epoch: 2, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.273 Vali Acc: 0.264 Test Loss: 2.273 Test Acc: 0.264
Validation loss decreased (-0.111086 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 1.9459586143493652
Epoch: 3, Steps: 7 | Train Loss: 2.120 Vali Loss: 1.919 Vali Acc: 0.542 Test Loss: 1.919 Test Acc: 0.542
Validation loss decreased (-0.263866 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 1.9350838661193848
Epoch: 4, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.512 Vali Acc: 0.708 Test Loss: 1.512 Test Acc: 0.708
Validation loss decreased (-0.541647 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 1.9438166618347168
Epoch: 5, Steps: 7 | Train Loss: 1.080 Vali Loss: 0.921 Vali Acc: 0.875 Test Loss: 0.921 Test Acc: 0.875
Validation loss decreased (-0.708318 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 1.9503061771392822
Epoch: 6, Steps: 7 | Train Loss: 0.580 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.796283483505249
Epoch: 7, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 2.3573038578033447
Epoch: 8, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3450193405151367
Epoch: 9, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3632662296295166
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 2.148897409439087
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.6948704719543457
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1888837814331055
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.188307762145996
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6862521171569824
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.41774320602417
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.941720962524414
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2741270065307617
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.244762897491455
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2431888580322266
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8107810020446777
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 2.351280689239502
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1665515899658203
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3351547718048096
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2973039150238037
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8084633350372314
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 2.2081544399261475
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 2.934638023376465
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 2.6200523376464844
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 2.881985902786255
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 2.289790630340576
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 2.561159610748291
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 2.500246524810791
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.328944683074951
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.384852647781372
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3242568969726562
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9110438823699951
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 2.320796489715576
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9365720748901367
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9908874034881592
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 2.109419107437134
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 2.379115104675293
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 2.3557932376861572
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.348989725112915
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 1.8153300285339355
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 2.0650525093078613
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.113889217376709
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.210618257522583
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.1532771587371826
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.2484652996063232
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.8874690532684326
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.089799642562866
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 2.0666253566741943
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 1.6091303825378418
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 1.918621301651001
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 1.8816819190979004
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 1.426407814025879
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 1.9038729667663574
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.9000704288482666
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.15788197517395
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.114118814468384
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.309474468231201
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.975961685180664
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.5174973011016846
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.9497382640838623
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.8977971076965332
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.1247429847717285
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1114172
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9841744899749756
Epoch: 1, Steps: 7 | Train Loss: 2.658 Vali Loss: 2.527 Vali Acc: 0.069 Test Loss: 2.527 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 2.2994580268859863
Epoch: 2, Steps: 7 | Train Loss: 2.518 Vali Loss: 2.418 Vali Acc: 0.083 Test Loss: 2.418 Test Acc: 0.083
Validation loss decreased (-0.069419 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 2.295818328857422
Epoch: 3, Steps: 7 | Train Loss: 2.322 Vali Loss: 2.164 Vali Acc: 0.347 Test Loss: 2.164 Test Acc: 0.347
Validation loss decreased (-0.083309 --> -0.347201).  Saving model ...
Epoch: 4 cost time: 2.3582873344421387
Epoch: 4, Steps: 7 | Train Loss: 1.966 Vali Loss: 1.828 Vali Acc: 0.514 Test Loss: 1.828 Test Acc: 0.514
Validation loss decreased (-0.347201 --> -0.513871).  Saving model ...
Epoch: 5 cost time: 1.9572079181671143
Epoch: 5, Steps: 7 | Train Loss: 1.568 Vali Loss: 1.348 Vali Acc: 0.750 Test Loss: 1.348 Test Acc: 0.750
Validation loss decreased (-0.513871 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 2.594709634780884
Epoch: 6, Steps: 7 | Train Loss: 0.928 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
Validation loss decreased (-0.749987 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 1.8439409732818604
Epoch: 7, Steps: 7 | Train Loss: 0.435 Vali Loss: 0.600 Vali Acc: 0.889 Test Loss: 0.600 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 2.4346697330474854
Epoch: 8, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.415 Vali Acc: 0.917 Test Loss: 0.415 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 2.277623414993286
Epoch: 9, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.721888780593872
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.7381811141967773
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8584551811218262
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.901371717453003
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.068822145462036
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7899363040924072
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.619053602218628
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.10778546333313
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0964114665985107
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2392544746398926
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.020122528076172
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.6791932582855225
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.0744659900665283
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.6921041011810303
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.2658934593200684
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.8509182929992676
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.9902162551879883
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.8847603797912598
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.291243314743042
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1224656105041504
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.89243745803833
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 2.1433417797088623
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.934744119644165
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0146243572235107
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.838426113128662
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6939423084259033
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8580093383789062
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.8756089210510254
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.664914608001709
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 2.1084372997283936
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.029785633087158
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 2.242778778076172
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 2.0971803665161133
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 2.1324405670166016
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.106638193130493
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0307822227478027
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.239922046661377
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2359745502471924
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.9060027599334717
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 2.427452325820923
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 1.8850057125091553
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 1.9710702896118164
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 1.6947007179260254
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.139310359954834
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.1010217666625977
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.321840524673462
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.0751917362213135
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.823556661605835
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.9200143814086914
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.494719982147217
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.86505126953125
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.4504785537719727
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1102972
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.875205039978027
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.427 Vali Acc: 0.125 Test Loss: 2.427 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.0798838138580322
Epoch: 2, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.302 Vali Acc: 0.222 Test Loss: 2.302 Test Acc: 0.222
Validation loss decreased (-0.124976 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 1.895036220550537
Epoch: 3, Steps: 7 | Train Loss: 2.120 Vali Loss: 1.921 Vali Acc: 0.514 Test Loss: 1.921 Test Acc: 0.514
Validation loss decreased (-0.222199 --> -0.513870).  Saving model ...
Epoch: 4 cost time: 1.9178340435028076
Epoch: 4, Steps: 7 | Train Loss: 1.658 Vali Loss: 1.476 Vali Acc: 0.778 Test Loss: 1.476 Test Acc: 0.778
Validation loss decreased (-0.513870 --> -0.777763).  Saving model ...
Epoch: 5 cost time: 1.8098630905151367
Epoch: 5, Steps: 7 | Train Loss: 1.124 Vali Loss: 1.021 Vali Acc: 0.875 Test Loss: 1.021 Test Acc: 0.875
Validation loss decreased (-0.777763 --> -0.874990).  Saving model ...
Epoch: 6 cost time: 2.2219343185424805
Epoch: 6, Steps: 7 | Train Loss: 0.599 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.9211459159851074
Epoch: 7, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 2.0530102252960205
Epoch: 8, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.8373901844024658
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.948509931564331
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2054402828216553
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.9200108051300049
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.1809778213500977
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.084652900695801
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.0422279834747314
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.15932297706604
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.3935563564300537
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.255185127258301
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.4697208404541016
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.727480411529541
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.3602538108825684
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.5084731578826904
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.248448371887207
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.909860372543335
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5911333560943604
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 2.479139566421509
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.462153911590576
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.1138453483581543
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.3569209575653076
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.286220073699951
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.390617847442627
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.266474485397339
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.222534418106079
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 2.2285563945770264
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 2.0858194828033447
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.8214945793151855
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.0590245723724365
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.0922634601593018
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8400561809539795
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.7340214252471924
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8089492321014404
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 2.1686606407165527
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 2.0125529766082764
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 2.143256664276123
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.897406816482544
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.9641366004943848
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.7949678897857666
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 2.225848436355591
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.4234321117401123
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.986450433731079
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.356198787689209
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 2.0293805599212646
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 1.8851590156555176
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 1.443366289138794
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6988525390625
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.1228785514831543
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.8745875358581543
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.492483377456665
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.2480952739715576
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9366014003753662
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.8110506534576416
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.167893886566162
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.559013843536377
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 905404
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.536186218261719
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.485 Vali Acc: 0.111 Test Loss: 2.485 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 2.509500026702881
Epoch: 2, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.367 Vali Acc: 0.111 Test Loss: 2.367 Test Acc: 0.111
Validation loss decreased (-0.111086 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 2.1931231021881104
Epoch: 3, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.014 Vali Acc: 0.556 Test Loss: 2.014 Test Acc: 0.556
Validation loss decreased (-0.111087 --> -0.555535).  Saving model ...
Epoch: 4 cost time: 2.4058001041412354
Epoch: 4, Steps: 7 | Train Loss: 1.855 Vali Loss: 1.652 Vali Acc: 0.639 Test Loss: 1.652 Test Acc: 0.639
Validation loss decreased (-0.555535 --> -0.638872).  Saving model ...
Epoch: 5 cost time: 2.6039540767669678
Epoch: 5, Steps: 7 | Train Loss: 1.271 Vali Loss: 1.153 Vali Acc: 0.833 Test Loss: 1.153 Test Acc: 0.833
Validation loss decreased (-0.638872 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 2.2099084854125977
Epoch: 6, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.708 Vali Acc: 0.847 Test Loss: 0.708 Test Acc: 0.847
Validation loss decreased (-0.833322 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 1.9576215744018555
Epoch: 7, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 1.9386866092681885
Epoch: 8, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.4457263946533203
Epoch: 9, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 2.2068588733673096
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.176811933517456
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2093067169189453
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 2.0501601696014404
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.202680826187134
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.137545108795166
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.119992733001709
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 17 cost time: 2.3412022590637207
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 18 cost time: 2.064922332763672
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2507662773132324
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 20 cost time: 1.714156150817871
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 21 cost time: 1.6430275440216064
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 22 cost time: 1.5876133441925049
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 23 cost time: 1.7543621063232422
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 24 cost time: 1.7415368556976318
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.864095687866211
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.216420888900757
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 27 cost time: 1.8045241832733154
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 28 cost time: 1.9892423152923584
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.888887 --> -0.902776).  Saving model ...
Epoch: 29 cost time: 2.705841302871704
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6925432682037354
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.889883279800415
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.011323928833008
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 33 cost time: 1.691777229309082
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 34 cost time: 1.6810624599456787
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 35 cost time: 1.6836581230163574
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 36 cost time: 1.982752799987793
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9153048992156982
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 1.8082654476165771
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.822016954421997
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9204766750335693
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.383540630340576
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.180131673812866
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.9029169082641602
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2859280109405518
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 1.8839902877807617
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 1.7356233596801758
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 2.0450167655944824
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9296307563781738
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.1573009490966797
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.9444248676300049
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.0793278217315674
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.182598829269409
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 2.318171501159668
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 54 cost time: 2.139068603515625
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 55 cost time: 2.2349445819854736
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 2.228527307510376
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 2.3632140159606934
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 58 cost time: 2.0595579147338867
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 2.204719066619873
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.1429154872894287
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.9679296016693115
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.8851189613342285
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.931349515914917
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.8941304683685303
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 2.5283665657043457
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 66 cost time: 2.041663408279419
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 67 cost time: 2.2041680812835693
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.0480239391326904
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.7521300315856934
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.3795125484466553
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.316070795059204
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.2859885692596436
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.2115869522094727
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.1951894760131836
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.361680269241333
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 2.3839120864868164
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 894204
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9016997814178467
Epoch: 1, Steps: 7 | Train Loss: 2.660 Vali Loss: 2.454 Vali Acc: 0.111 Test Loss: 2.454 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.9674921035766602
Epoch: 2, Steps: 7 | Train Loss: 2.505 Vali Loss: 2.391 Vali Acc: 0.292 Test Loss: 2.391 Test Acc: 0.292
Validation loss decreased (-0.111087 --> -0.291643).  Saving model ...
Epoch: 3 cost time: 1.6459264755249023
Epoch: 3, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.095 Vali Acc: 0.444 Test Loss: 2.095 Test Acc: 0.444
Validation loss decreased (-0.291643 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 1.8576738834381104
Epoch: 4, Steps: 7 | Train Loss: 2.033 Vali Loss: 1.846 Vali Acc: 0.611 Test Loss: 1.846 Test Acc: 0.611
Validation loss decreased (-0.444423 --> -0.611093).  Saving model ...
Epoch: 5 cost time: 2.0247104167938232
Epoch: 5, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.355 Vali Acc: 0.792 Test Loss: 1.355 Test Acc: 0.792
Validation loss decreased (-0.611093 --> -0.791653).  Saving model ...
Epoch: 6 cost time: 2.011258363723755
Epoch: 6, Steps: 7 | Train Loss: 0.984 Vali Loss: 0.879 Vali Acc: 0.806 Test Loss: 0.879 Test Acc: 0.806
Validation loss decreased (-0.791653 --> -0.805547).  Saving model ...
Epoch: 7 cost time: 2.090998411178589
Epoch: 7, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
Validation loss decreased (-0.805547 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 1.9543347358703613
Epoch: 8, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.809260368347168
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 2.154399871826172
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9715657234191895
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.754002332687378
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.721280813217163
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.5159733295440674
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.5846843719482422
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6978216171264648
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.63228440284729
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8979291915893555
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8122901916503906
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5090906620025635
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.261066436767578
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.035396099090576
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.142897129058838
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8099143505096436
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 883004
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.144225358963013
Epoch: 1, Steps: 7 | Train Loss: 2.727 Vali Loss: 2.468 Vali Acc: 0.083 Test Loss: 2.468 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.8238351345062256
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.341 Vali Acc: 0.167 Test Loss: 2.341 Test Acc: 0.167
Validation loss decreased (-0.083309 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 2.1669790744781494
Epoch: 3, Steps: 7 | Train Loss: 2.254 Vali Loss: 2.011 Vali Acc: 0.542 Test Loss: 2.011 Test Acc: 0.542
Validation loss decreased (-0.166643 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 1.77018404006958
Epoch: 4, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.669 Vali Acc: 0.653 Test Loss: 1.669 Test Acc: 0.653
Validation loss decreased (-0.541647 --> -0.652761).  Saving model ...
Epoch: 5 cost time: 2.304658889770508
Epoch: 5, Steps: 7 | Train Loss: 1.372 Vali Loss: 1.183 Vali Acc: 0.778 Test Loss: 1.183 Test Acc: 0.778
Validation loss decreased (-0.652761 --> -0.777766).  Saving model ...
Epoch: 6 cost time: 2.0375866889953613
Epoch: 6, Steps: 7 | Train Loss: 0.800 Vali Loss: 0.760 Vali Acc: 0.847 Test Loss: 0.760 Test Acc: 0.847
Validation loss decreased (-0.777766 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 2.462085723876953
Epoch: 7, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.8156611919403076
Epoch: 8, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 2.3329436779022217
Epoch: 9, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1546614170074463
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.386998176574707
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.1551032066345215
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.162332773208618
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9418537616729736
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 2.372352361679077
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 2.278526544570923
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 2.1359353065490723
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.1920835971832275
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.01800799369812
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9638495445251465
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6048753261566162
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8928439617156982
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7047016620635986
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.983177661895752
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8694660663604736
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.481656312942505
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.8782951831817627
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9878084659576416
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.649052619934082
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5266761779785156
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2806713581085205
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.217426300048828
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.467453718185425
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9932329654693604
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7743024826049805
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7882554531097412
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 871804
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.030241966247559
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.487 Vali Acc: 0.083 Test Loss: 2.487 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.241788148880005
Epoch: 2, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.318 Vali Acc: 0.167 Test Loss: 2.318 Test Acc: 0.167
Validation loss decreased (-0.083308 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 1.9955239295959473
Epoch: 3, Steps: 7 | Train Loss: 2.208 Vali Loss: 2.001 Vali Acc: 0.639 Test Loss: 2.001 Test Acc: 0.639
Validation loss decreased (-0.166643 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 2.1608033180236816
Epoch: 4, Steps: 7 | Train Loss: 1.810 Vali Loss: 1.668 Vali Acc: 0.681 Test Loss: 1.668 Test Acc: 0.681
Validation loss decreased (-0.638869 --> -0.680539).  Saving model ...
Epoch: 5 cost time: 1.9964518547058105
Epoch: 5, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.191 Vali Acc: 0.819 Test Loss: 1.191 Test Acc: 0.819
Validation loss decreased (-0.680539 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 2.2395706176757812
Epoch: 6, Steps: 7 | Train Loss: 0.822 Vali Loss: 0.810 Vali Acc: 0.819 Test Loss: 0.810 Test Acc: 0.819
Validation loss decreased (-0.819433 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 2.167370557785034
Epoch: 7, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 2.543792247772217
Epoch: 8, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9241259098052979
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.9635450839996338
Epoch: 10, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7676067352294922
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8846795558929443
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.345947504043579
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.6292154788970947
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6783311367034912
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2518413066864014
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.257615089416504
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8195405006408691
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2540431022644043
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1786468029022217
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6776142120361328
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9078974723815918
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.121995449066162
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 789820
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.302564382553101
Epoch: 1, Steps: 7 | Train Loss: 2.675 Vali Loss: 2.489 Vali Acc: 0.083 Test Loss: 2.489 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.234503984451294
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.360 Vali Acc: 0.139 Test Loss: 2.360 Test Acc: 0.139
Validation loss decreased (-0.083308 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 2.047499895095825
Epoch: 3, Steps: 7 | Train Loss: 2.308 Vali Loss: 2.080 Vali Acc: 0.417 Test Loss: 2.080 Test Acc: 0.417
Validation loss decreased (-0.138865 --> -0.416646).  Saving model ...
Epoch: 4 cost time: 2.222057342529297
Epoch: 4, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.774 Vali Acc: 0.583 Test Loss: 1.774 Test Acc: 0.583
Validation loss decreased (-0.416646 --> -0.583316).  Saving model ...
Epoch: 5 cost time: 2.0649986267089844
Epoch: 5, Steps: 7 | Train Loss: 1.482 Vali Loss: 1.291 Vali Acc: 0.819 Test Loss: 1.291 Test Acc: 0.819
Validation loss decreased (-0.583316 --> -0.819432).  Saving model ...
Epoch: 6 cost time: 2.3052501678466797
Epoch: 6, Steps: 7 | Train Loss: 0.996 Vali Loss: 0.871 Vali Acc: 0.847 Test Loss: 0.871 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 2.034965991973877
Epoch: 7, Steps: 7 | Train Loss: 0.475 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 2.0722086429595947
Epoch: 8, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 2.1439402103424072
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.7759673595428467
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.9911091327667236
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3871755599975586
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3457112312316895
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1236252784729004
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7271449565887451
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8605332374572754
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 1.952021598815918
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 2.017242431640625
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.8441970348358154
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 1.5830605030059814
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.853823184967041
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 2.2253332138061523
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5954339504241943
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 2.575385093688965
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 2.1449718475341797
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.318066358566284
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.3810179233551025
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 2.4207651615142822
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 2.54510235786438
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.9303772449493408
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 2.3219618797302246
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 2.362776517868042
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 2.0090882778167725
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8991916179656982
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.2436773777008057
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 2.066783905029297
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 2.222522735595703
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 2.1383676528930664
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 2.161357879638672
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 2.1803958415985107
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 2.2427427768707275
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 2.0132884979248047
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 2.2480082511901855
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 2.0369620323181152
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.089698553085327
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.667182445526123
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.326037883758545
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.881955862045288
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.2295081615448
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.6504993438720703
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.4326825141906738
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 2.09671688079834
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 1.9519834518432617
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8840792179107666
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 1.4570286273956299
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.9893648624420166
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.3348681926727295
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.375112295150757
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.5057754516601562
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.2715249061584473
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.2673468589782715
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 2.241053581237793
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 2.2385001182556152
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 2.325927495956421
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.3884193897247314
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.2989871501922607
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.7235805988311768
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.405675172805786
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 2.093444347381592
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.113654136657715
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.0615711212158203
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.987196922302246
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.4395012855529785
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 2.209307909011841
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 2.2706470489501953
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 2.161407947540283
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 2.29388689994812
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 2.4286060333251953
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 2.2853024005889893
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 2.345759153366089
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.9135370254516602
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.6514148712158203
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.4107332229614258
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.8807146549224854
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.9764339923858643
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 2.35300350189209
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 2.317951202392578
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 778620
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6655290126800537
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.405 Vali Acc: 0.167 Test Loss: 2.405 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.1860573291778564
Epoch: 2, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.214 Vali Acc: 0.250 Test Loss: 2.214 Test Acc: 0.250
Validation loss decreased (-0.166643 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 1.6723129749298096
Epoch: 3, Steps: 7 | Train Loss: 2.071 Vali Loss: 1.849 Vali Acc: 0.625 Test Loss: 1.849 Test Acc: 0.625
Validation loss decreased (-0.249978 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 2.249957799911499
Epoch: 4, Steps: 7 | Train Loss: 1.590 Vali Loss: 1.459 Vali Acc: 0.708 Test Loss: 1.459 Test Acc: 0.708
Validation loss decreased (-0.624982 --> -0.708319).  Saving model ...
Epoch: 5 cost time: 1.9452159404754639
Epoch: 5, Steps: 7 | Train Loss: 1.103 Vali Loss: 0.995 Vali Acc: 0.861 Test Loss: 0.995 Test Acc: 0.861
Validation loss decreased (-0.708319 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 2.217113494873047
Epoch: 6, Steps: 7 | Train Loss: 0.597 Vali Loss: 0.637 Vali Acc: 0.903 Test Loss: 0.637 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 2.011878728866577
Epoch: 7, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 2.0235981941223145
Epoch: 8, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1982245445251465
Epoch: 9, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3349671363830566
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.3497626781463623
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9074501991271973
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.1385815143585205
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1576366424560547
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9014708995819092
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7214200496673584
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7642784118652344
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9134750366210938
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4767589569091797
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.107541561126709
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.914566993713379
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4025685787200928
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 767420
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.244955062866211
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.369 Vali Acc: 0.278 Test Loss: 2.369 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 1.7212765216827393
Epoch: 2, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.235 Vali Acc: 0.333 Test Loss: 2.235 Test Acc: 0.333
Validation loss decreased (-0.277754 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 1.6723392009735107
Epoch: 3, Steps: 7 | Train Loss: 2.139 Vali Loss: 1.931 Vali Acc: 0.583 Test Loss: 1.931 Test Acc: 0.583
Validation loss decreased (-0.333311 --> -0.583314).  Saving model ...
Epoch: 4 cost time: 1.626343011856079
Epoch: 4, Steps: 7 | Train Loss: 1.785 Vali Loss: 1.552 Vali Acc: 0.750 Test Loss: 1.552 Test Acc: 0.750
Validation loss decreased (-0.583314 --> -0.749984).  Saving model ...
Epoch: 5 cost time: 1.6948423385620117
Epoch: 5, Steps: 7 | Train Loss: 1.292 Vali Loss: 1.140 Vali Acc: 0.708 Test Loss: 1.140 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.748133897781372
Epoch: 6, Steps: 7 | Train Loss: 0.798 Vali Loss: 0.714 Vali Acc: 0.903 Test Loss: 0.714 Test Acc: 0.903
Validation loss decreased (-0.749984 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 1.9361495971679688
Epoch: 7, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.131131410598755
Epoch: 8, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.6048552989959717
Epoch: 9, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8249645233154297
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0393965244293213
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.103825569152832
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.767831802368164
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.1466758251190186
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8262979984283447
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.8328890800476074
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 1.784510850906372
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.0355138778686523
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9277679920196533
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9722275733947754
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.187133312225342
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0542733669281006
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8559904098510742
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7725200653076172
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.8098971843719482
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.942061424255371
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.948763132095337
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 2.109086036682129
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.4594810009002686
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.9177093505859375
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.8578650951385498
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.9829504489898682
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.8102872371673584
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.6075701713562012
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.749103307723999
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7387475967407227
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 2.104358434677124
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.171790361404419
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.6000046730041504
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 1.6878843307495117
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9388599395751953
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6391448974609375
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.7751412391662598
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 2.0117335319519043
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.8717162609100342
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.7518036365509033
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.043241262435913
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.094539165496826
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.9519619941711426
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 1.8814198970794678
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.9784975051879883
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.8912177085876465
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 2.158601760864258
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 2.030719757080078
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.502286672592163
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.9369125366210938
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.8799564838409424
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.311297655105591
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.7429099082946777
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.5488364696502686
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6025066375732422
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.5975942611694336
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.5964395999908447
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 756220
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.606706380844116
Epoch: 1, Steps: 7 | Train Loss: 2.708 Vali Loss: 2.509 Vali Acc: 0.083 Test Loss: 2.509 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.9470281600952148
Epoch: 2, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.401 Vali Acc: 0.236 Test Loss: 2.401 Test Acc: 0.236
Validation loss decreased (-0.083308 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 2.0235981941223145
Epoch: 3, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.290 Vali Acc: 0.264 Test Loss: 2.290 Test Acc: 0.264
Validation loss decreased (-0.236087 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 1.8913218975067139
Epoch: 4, Steps: 7 | Train Loss: 2.246 Vali Loss: 2.054 Vali Acc: 0.486 Test Loss: 2.054 Test Acc: 0.486
Validation loss decreased (-0.263866 --> -0.486091).  Saving model ...
Epoch: 5 cost time: 2.014228343963623
Epoch: 5, Steps: 7 | Train Loss: 1.905 Vali Loss: 1.734 Vali Acc: 0.764 Test Loss: 1.734 Test Acc: 0.764
Validation loss decreased (-0.486091 --> -0.763872).  Saving model ...
Epoch: 6 cost time: 1.6588551998138428
Epoch: 6, Steps: 7 | Train Loss: 1.431 Vali Loss: 1.241 Vali Acc: 0.847 Test Loss: 1.241 Test Acc: 0.847
Validation loss decreased (-0.763872 --> -0.847210).  Saving model ...
Epoch: 7 cost time: 1.986267328262329
Epoch: 7, Steps: 7 | Train Loss: 0.915 Vali Loss: 0.878 Vali Acc: 0.847 Test Loss: 0.878 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847213).  Saving model ...
Epoch: 8 cost time: 1.81601881980896
Epoch: 8, Steps: 7 | Train Loss: 0.512 Vali Loss: 0.651 Vali Acc: 0.875 Test Loss: 0.651 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.9643332958221436
Epoch: 9, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6359286308288574
Epoch: 10, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9556021690368652
Epoch: 11, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.9334924221038818
Epoch: 12, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 2.0169315338134766
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.476536512374878
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7214360237121582
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.831369400024414
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.4283294677734375
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.674708366394043
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.4904191493988037
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.7967591285705566
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.8513634204864502
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.7095654010772705
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.8561387062072754
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.547323226928711
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8072481155395508
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.1535723209381104
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.624443769454956
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.0080418586730957
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6325576305389404
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6578295230865479
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.7309060096740723
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.8259856700897217
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.5569491386413574
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.5231719017028809
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.6962296962738037
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.7180778980255127
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.7103614807128906
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.6543970108032227
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.537043809890747
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.9417927265167236
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 2.054583787918091
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.7608909606933594
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.6710445880889893
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9307260513305664
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 2.0180821418762207
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 2.0431885719299316
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.988778829574585
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.7875442504882812
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8586828708648682
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 2.0749764442443848
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.9318392276763916
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.8552849292755127
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.6094250679016113
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.933842658996582
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.9398550987243652
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.8454115390777588
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.6909267902374268
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.5840504169464111
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.570768117904663
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.9755804538726807
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.0274598598480225
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.994372844696045
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.9827117919921875
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.152005910873413
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 2.0582540035247803
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.8205571174621582
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 2.197732925415039
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.8089838027954102
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.9998857975006104
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.9875249862670898
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.7603278160095215
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.0987255573272705
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 1.7443654537200928
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 1.8616094589233398
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 1.989548921585083
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 2.037494421005249
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 2.2480437755584717
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.880908727645874
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 1.9414865970611572
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 1.776822566986084
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 2.1360580921173096
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 1.9227406978607178
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 1.8935856819152832
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 1.81221604347229
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.8660953044891357
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.8718795776367188
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 1.9400510787963867
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 1.9114654064178467
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 89 cost time: 1.9167933464050293
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 90 cost time: 1.8161444664001465
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 91 cost time: 1.657609224319458
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7510571479797363
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 93 cost time: 1.753251552581787
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 94 cost time: 1.9079008102416992
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 95 cost time: 2.0158910751342773
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7622733116149902
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 97 cost time: 1.9855406284332275
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 98 cost time: 2.1295721530914307
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 99 cost time: 2.0210118293762207
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 100 cost time: 1.8778090476989746
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 688380
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.019383430480957
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.477 Vali Acc: 0.167 Test Loss: 2.477 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.8999290466308594
Epoch: 2, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.391 Vali Acc: 0.167 Test Loss: 2.391 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 1.7970750331878662
Epoch: 3, Steps: 7 | Train Loss: 2.347 Vali Loss: 2.263 Vali Acc: 0.292 Test Loss: 2.263 Test Acc: 0.292
Validation loss decreased (-0.166643 --> -0.291644).  Saving model ...
Epoch: 4 cost time: 1.752469539642334
Epoch: 4, Steps: 7 | Train Loss: 2.201 Vali Loss: 2.037 Vali Acc: 0.486 Test Loss: 2.037 Test Acc: 0.486
Validation loss decreased (-0.291644 --> -0.486091).  Saving model ...
Epoch: 5 cost time: 1.8418290615081787
Epoch: 5, Steps: 7 | Train Loss: 1.881 Vali Loss: 1.680 Vali Acc: 0.625 Test Loss: 1.680 Test Acc: 0.625
Validation loss decreased (-0.486091 --> -0.624983).  Saving model ...
Epoch: 6 cost time: 1.7703030109405518
Epoch: 6, Steps: 7 | Train Loss: 1.453 Vali Loss: 1.238 Vali Acc: 0.806 Test Loss: 1.238 Test Acc: 0.806
Validation loss decreased (-0.624983 --> -0.805543).  Saving model ...
Epoch: 7 cost time: 1.7202868461608887
Epoch: 7, Steps: 7 | Train Loss: 0.901 Vali Loss: 0.853 Vali Acc: 0.847 Test Loss: 0.853 Test Acc: 0.847
Validation loss decreased (-0.805543 --> -0.847214).  Saving model ...
Epoch: 8 cost time: 1.7464125156402588
Epoch: 8, Steps: 7 | Train Loss: 0.500 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861105).  Saving model ...
Epoch: 9 cost time: 1.4801421165466309
Epoch: 9, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.6164484024047852
Epoch: 10, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9791922569274902
Epoch: 11, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.677992582321167
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.8899571895599365
Epoch: 13, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.691281795501709
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6321372985839844
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8484416007995605
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8436551094055176
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5284943580627441
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7481591701507568
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5792112350463867
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5127489566802979
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.5249688625335693
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 1.5294148921966553
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 1.3401610851287842
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.6972312927246094
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.9794414043426514
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.6609125137329102
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.7029075622558594
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.895946741104126
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.64178466796875
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.6585547924041748
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.8385531902313232
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.8144605159759521
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.4788265228271484
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.931107521057129
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.8429701328277588
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.8788580894470215
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9346718788146973
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 1.889549732208252
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7845087051391602
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9024255275726318
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 2.0403096675872803
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 1.9591960906982422
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 1.7537400722503662
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 1.785202980041504
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 1.7799842357635498
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 1.801374912261963
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6944725513458252
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9883415699005127
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8359730243682861
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.8664309978485107
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 1.6047532558441162
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 1.7183442115783691
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 54 cost time: 1.7061786651611328
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 55 cost time: 2.1046338081359863
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 1.7415881156921387
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 1.6665339469909668
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 58 cost time: 1.8036472797393799
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 1.6566755771636963
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.3904671669006348
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.5160093307495117
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 62 cost time: 1.6075248718261719
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 63 cost time: 1.5586097240447998
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 64 cost time: 1.5566413402557373
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 1.836596965789795
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.952042579650879
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.6500341892242432
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.8610222339630127
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.0888962745666504
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.8428971767425537
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.7334990501403809
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.7575106620788574
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.7761926651000977
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.8495965003967285
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 682780
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8436992168426514
Epoch: 1, Steps: 7 | Train Loss: 2.653 Vali Loss: 2.546 Vali Acc: 0.069 Test Loss: 2.546 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.9240033626556396
Epoch: 2, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.452 Vali Acc: 0.069 Test Loss: 2.452 Test Acc: 0.069
Validation loss decreased (-0.069419 --> -0.069420).  Saving model ...
Epoch: 3 cost time: 1.7568013668060303
Epoch: 3, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.326 Vali Acc: 0.361 Test Loss: 2.326 Test Acc: 0.361
Validation loss decreased (-0.069420 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.510082483291626
Epoch: 4, Steps: 7 | Train Loss: 2.253 Vali Loss: 2.150 Vali Acc: 0.403 Test Loss: 2.150 Test Acc: 0.403
Validation loss decreased (-0.361088 --> -0.402756).  Saving model ...
Epoch: 5 cost time: 1.4581844806671143
Epoch: 5, Steps: 7 | Train Loss: 1.978 Vali Loss: 1.844 Vali Acc: 0.528 Test Loss: 1.844 Test Acc: 0.528
Validation loss decreased (-0.402756 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 1.699995517730713
Epoch: 6, Steps: 7 | Train Loss: 1.568 Vali Loss: 1.371 Vali Acc: 0.778 Test Loss: 1.371 Test Acc: 0.778
Validation loss decreased (-0.527759 --> -0.777764).  Saving model ...
Epoch: 7 cost time: 1.720433235168457
Epoch: 7, Steps: 7 | Train Loss: 1.059 Vali Loss: 0.988 Vali Acc: 0.792 Test Loss: 0.988 Test Acc: 0.792
Validation loss decreased (-0.777764 --> -0.791657).  Saving model ...
Epoch: 8 cost time: 1.8324270248413086
Epoch: 8, Steps: 7 | Train Loss: 0.606 Vali Loss: 0.696 Vali Acc: 0.819 Test Loss: 0.696 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819437).  Saving model ...
Epoch: 9 cost time: 1.9438621997833252
Epoch: 9, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 2.0252013206481934
Epoch: 10, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.212006092071533
Epoch: 11, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.8413174152374268
Epoch: 12, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.7264304161071777
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.7454833984375
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.873802661895752
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.9914238452911377
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8888380527496338
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.903632402420044
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9764702320098877
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7439322471618652
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7311577796936035
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8653972148895264
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.6773202419281006
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.9125218391418457
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.5993380546569824
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.514946460723877
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9619817733764648
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.8542842864990234
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.8502600193023682
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.7079336643218994
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8315184116363525
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.7107329368591309
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.5982425212860107
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.922156810760498
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.9200139045715332
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 2.0060458183288574
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 2.014732837677002
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8156607151031494
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7528951168060303
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.950044870376587
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.8548097610473633
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.66650390625
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.8209002017974854
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 1.5304393768310547
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.6879303455352783
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.7712750434875488
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.8595759868621826
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.5417780876159668
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.7956905364990234
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.19899582862854
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.8519690036773682
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 1.8022816181182861
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 1.6650469303131104
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 1.4174907207489014
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 1.633976936340332
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 1.8662679195404053
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.6382107734680176
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6017467975616455
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 1.7764146327972412
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 1.872868299484253
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 1.380025863647461
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 1.9824247360229492
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 1.7457404136657715
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.9140946865081787
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 1.721989631652832
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.5656001567840576
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.8112802505493164
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.7440030574798584
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.7570767402648926
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 1.676701307296753
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 1.654529333114624
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 1.6179742813110352
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 1.5517678260803223
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 1.5637085437774658
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 1.5373694896697998
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 1.912571668624878
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6065599918365479
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 1.8544774055480957
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.6813287734985352
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.7477102279663086
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.5049209594726562
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.7687020301818848
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 1.6175627708435059
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 1.720707893371582
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 1.880887508392334
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.7658352851867676
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.7251503467559814
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 1.8908929824829102
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 89 cost time: 1.9669883251190186
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 1.7208163738250732
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 1.816889762878418
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 1.5070703029632568
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 1.880671739578247
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 1.4530868530273438
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 1.6901874542236328
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 96 cost time: 1.6449899673461914
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.950974702835083
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.7513487339019775
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.6467821598052979
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.815006971359253
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 677180
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.659414768218994
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.363 Vali Acc: 0.292 Test Loss: 2.363 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 1.9602534770965576
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.263 Vali Acc: 0.389 Test Loss: 2.263 Test Acc: 0.389
Validation loss decreased (-0.291643 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 1.9663667678833008
Epoch: 3, Steps: 7 | Train Loss: 2.257 Vali Loss: 2.052 Vali Acc: 0.542 Test Loss: 2.052 Test Acc: 0.542
Validation loss decreased (-0.388866 --> -0.541646).  Saving model ...
Epoch: 4 cost time: 1.557774305343628
Epoch: 4, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.729 Vali Acc: 0.694 Test Loss: 1.729 Test Acc: 0.694
Validation loss decreased (-0.541646 --> -0.694427).  Saving model ...
Epoch: 5 cost time: 1.7524733543395996
Epoch: 5, Steps: 7 | Train Loss: 1.539 Vali Loss: 1.307 Vali Acc: 0.806 Test Loss: 1.307 Test Acc: 0.806
Validation loss decreased (-0.694427 --> -0.805542).  Saving model ...
Epoch: 6 cost time: 1.831357479095459
Epoch: 6, Steps: 7 | Train Loss: 1.040 Vali Loss: 0.921 Vali Acc: 0.847 Test Loss: 0.921 Test Acc: 0.847
Validation loss decreased (-0.805542 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 1.7975215911865234
Epoch: 7, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9143047332763672
Epoch: 8, Steps: 7 | Train Loss: 0.341 Vali Loss: 0.486 Vali Acc: 0.917 Test Loss: 0.486 Test Acc: 0.917
Validation loss decreased (-0.847213 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 1.6637349128723145
Epoch: 9, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.416 Vali Acc: 0.917 Test Loss: 0.416 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 1.487379550933838
Epoch: 10, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7791728973388672
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5919978618621826
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.3641488552093506
Epoch: 13, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6488347053527832
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8340940475463867
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7825407981872559
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.4938433170318604
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.6180379390716553
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.7873377799987793
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.4266936779022217
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.7295286655426025
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.4669196605682373
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.8639602661132812
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.6368422508239746
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.849447250366211
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.5319750308990479
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5469677448272705
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.571401596069336
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.5974626541137695
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.7466509342193604
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.4767138957977295
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.2810368537902832
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.478633165359497
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.3760783672332764
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.4973807334899902
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.5905399322509766
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5271492004394531
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.5496861934661865
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.6663367748260498
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.3561794757843018
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.500166416168213
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.683600902557373
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.4620273113250732
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 1.9890730381011963
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.5233030319213867
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.8028287887573242
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.4954006671905518
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.7842223644256592
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.4963371753692627
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.7447099685668945
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.7248902320861816
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 2.1654694080352783
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 1.6571438312530518
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 1.5519664287567139
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 1.587982177734375
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 2.016336441040039
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.9623322486877441
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.9699361324310303
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.9405806064605713
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.9641828536987305
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 1.7548255920410156
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 1.303725004196167
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.8400814533233643
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.6125853061676025
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.5014464855194092
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.8544261455535889
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.5150301456451416
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.8917453289031982
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 1.517225980758667
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 1.7473785877227783
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 1.5834262371063232
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 1.5399694442749023
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.4516937732696533
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 1.3679304122924805
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 1.4871551990509033
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 1.622654676437378
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 1.5263948440551758
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.5752360820770264
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.7075414657592773
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.6088247299194336
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.7808265686035156
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.6287834644317627
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.3891050815582275
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.6630942821502686
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.4698786735534668
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.9062175750732422
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 671580
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7563281059265137
Epoch: 1, Steps: 7 | Train Loss: 2.598 Vali Loss: 2.493 Vali Acc: 0.125 Test Loss: 2.493 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.4864649772644043
Epoch: 2, Steps: 7 | Train Loss: 2.520 Vali Loss: 2.405 Vali Acc: 0.139 Test Loss: 2.405 Test Acc: 0.139
Validation loss decreased (-0.124975 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 1.6360976696014404
Epoch: 3, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.266 Vali Acc: 0.181 Test Loss: 2.266 Test Acc: 0.181
Validation loss decreased (-0.138865 --> -0.180533).  Saving model ...
Epoch: 4 cost time: 1.4138238430023193
Epoch: 4, Steps: 7 | Train Loss: 2.192 Vali Loss: 2.020 Vali Acc: 0.528 Test Loss: 2.020 Test Acc: 0.528
Validation loss decreased (-0.180533 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 1.5289099216461182
Epoch: 5, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.703 Vali Acc: 0.778 Test Loss: 1.703 Test Acc: 0.778
Validation loss decreased (-0.527758 --> -0.777761).  Saving model ...
Epoch: 6 cost time: 1.5836329460144043
Epoch: 6, Steps: 7 | Train Loss: 1.473 Vali Loss: 1.305 Vali Acc: 0.861 Test Loss: 1.305 Test Acc: 0.861
Validation loss decreased (-0.777761 --> -0.861098).  Saving model ...
Epoch: 7 cost time: 2.025629997253418
Epoch: 7, Steps: 7 | Train Loss: 0.934 Vali Loss: 0.892 Vali Acc: 0.931 Test Loss: 0.892 Test Acc: 0.931
Validation loss decreased (-0.861098 --> -0.930547).  Saving model ...
Epoch: 8 cost time: 1.5582430362701416
Epoch: 8, Steps: 7 | Train Loss: 0.531 Vali Loss: 0.600 Vali Acc: 0.917 Test Loss: 0.600 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.923842191696167
Epoch: 9, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.437 Vali Acc: 0.931 Test Loss: 0.437 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 1.8579716682434082
Epoch: 10, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 2.051582098007202
Epoch: 11, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 2.0009875297546387
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0710222721099854
Epoch: 13, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.141474962234497
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.878021478652954
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7029318809509277
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.7028639316558838
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6636440753936768
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.737914800643921
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.6277477741241455
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5357375144958496
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.547497272491455
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4699833393096924
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0204715728759766
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0879321098327637
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.062600612640381
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.127775192260742
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7606925964355469
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.2739710807800293
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 455420
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8719470500946045
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.527 Vali Acc: 0.111 Test Loss: 2.527 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.973376989364624
Epoch: 2, Steps: 7 | Train Loss: 2.417 Vali Loss: 2.378 Vali Acc: 0.278 Test Loss: 2.378 Test Acc: 0.278
Validation loss decreased (-0.111086 --> -0.277754).  Saving model ...
Epoch: 3 cost time: 1.9891109466552734
Epoch: 3, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.252 Vali Acc: 0.278 Test Loss: 2.252 Test Acc: 0.278
Validation loss decreased (-0.277754 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 2.0384371280670166
Epoch: 4, Steps: 7 | Train Loss: 2.230 Vali Loss: 2.119 Vali Acc: 0.528 Test Loss: 2.119 Test Acc: 0.528
Validation loss decreased (-0.277755 --> -0.527757).  Saving model ...
Epoch: 5 cost time: 1.8786311149597168
Epoch: 5, Steps: 7 | Train Loss: 1.964 Vali Loss: 1.831 Vali Acc: 0.625 Test Loss: 1.831 Test Acc: 0.625
Validation loss decreased (-0.527757 --> -0.624982).  Saving model ...
Epoch: 6 cost time: 2.1309268474578857
Epoch: 6, Steps: 7 | Train Loss: 1.558 Vali Loss: 1.464 Vali Acc: 0.681 Test Loss: 1.464 Test Acc: 0.681
Validation loss decreased (-0.624982 --> -0.680541).  Saving model ...
Epoch: 7 cost time: 2.2643625736236572
Epoch: 7, Steps: 7 | Train Loss: 1.140 Vali Loss: 1.109 Vali Acc: 0.778 Test Loss: 1.109 Test Acc: 0.778
Validation loss decreased (-0.680541 --> -0.777767).  Saving model ...
Epoch: 8 cost time: 1.5720391273498535
Epoch: 8, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.781 Vali Acc: 0.819 Test Loss: 0.781 Test Acc: 0.819
Validation loss decreased (-0.777767 --> -0.819437).  Saving model ...
Epoch: 9 cost time: 2.1349174976348877
Epoch: 9, Steps: 7 | Train Loss: 0.436 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8604137897491455
Epoch: 10, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.819437 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 1.8085365295410156
Epoch: 11, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.407 Vali Acc: 0.847 Test Loss: 0.407 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4562015533447266
Epoch: 12, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1328275203704834
Epoch: 13, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.3062944412231445
Epoch: 14, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 2.332247018814087
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.044929027557373
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.7984251976013184
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.4578351974487305
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.6561641693115234
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.510071039199829
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.769979476928711
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9507255554199219
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5161399841308594
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.31581449508667
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.499342918395996
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.6692736148834229
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.5907435417175293
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6205461025238037
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7805347442626953
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2427937984466553
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.920830488204956
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8486580848693848
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9815330505371094
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8480231761932373
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5315372943878174
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.8756093978881836
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.59440279006958
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.8219294548034668
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.8844635486602783
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.7100443840026855
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.114741802215576
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8326971530914307
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.81734037399292
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0910701751708984
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.844937801361084
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 2.1723241806030273
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 2.186107873916626
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 2.1253156661987305
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.7514262199401855
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 2.1008217334747314
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.7031898498535156
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 2.218271255493164
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 1.6901628971099854
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9120113849639893
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.079390287399292
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.6957128047943115
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.9617233276367188
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.0786139965057373
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.093472719192505
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 2.1917638778686523
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.2650039196014404
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.1742236614227295
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.6890056133270264
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 2.4123847484588623
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.9343085289001465
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.8722429275512695
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 1.6646478176116943
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 1.644979476928711
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 1.6444611549377441
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 1.5144610404968262
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 1.6617870330810547
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 1.796745777130127
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 1.9951355457305908
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.9029030799865723
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.8716788291931152
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.9952852725982666
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 2.1301352977752686
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.8043992519378662
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.9643504619598389
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.9122278690338135
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 1.8441648483276367
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 1.843085765838623
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 2.2188496589660645
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 1.8764026165008545
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.0330135822296143
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.077965259552002
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 1.953514575958252
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.9219005107879639
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.9019150733947754
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.8563101291656494
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 2.2222187519073486
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 92 cost time: 1.7673065662384033
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 1.8727433681488037
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.9758174419403076
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 2.4640495777130127
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 2.1246018409729004
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 2.306267738342285
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 98 cost time: 1.654287338256836
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 2.1646053791046143
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 100 cost time: 1.5072128772735596
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 449820
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.446354389190674
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.474 Vali Acc: 0.153 Test Loss: 2.474 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.8655354976654053
Epoch: 2, Steps: 7 | Train Loss: 2.533 Vali Loss: 2.402 Vali Acc: 0.167 Test Loss: 2.402 Test Acc: 0.167
Validation loss decreased (-0.152753 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 1.7679855823516846
Epoch: 3, Steps: 7 | Train Loss: 2.408 Vali Loss: 2.312 Vali Acc: 0.250 Test Loss: 2.312 Test Acc: 0.250
Validation loss decreased (-0.166643 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 1.6703977584838867
Epoch: 4, Steps: 7 | Train Loss: 2.221 Vali Loss: 2.107 Vali Acc: 0.514 Test Loss: 2.107 Test Acc: 0.514
Validation loss decreased (-0.249977 --> -0.513868).  Saving model ...
Epoch: 5 cost time: 2.02641224861145
Epoch: 5, Steps: 7 | Train Loss: 1.970 Vali Loss: 1.858 Vali Acc: 0.583 Test Loss: 1.858 Test Acc: 0.583
Validation loss decreased (-0.513868 --> -0.583315).  Saving model ...
Epoch: 6 cost time: 1.9015915393829346
Epoch: 6, Steps: 7 | Train Loss: 1.627 Vali Loss: 1.500 Vali Acc: 0.750 Test Loss: 1.500 Test Acc: 0.750
Validation loss decreased (-0.583315 --> -0.749985).  Saving model ...
Epoch: 7 cost time: 2.4501774311065674
Epoch: 7, Steps: 7 | Train Loss: 1.194 Vali Loss: 1.092 Vali Acc: 0.819 Test Loss: 1.092 Test Acc: 0.819
Validation loss decreased (-0.749985 --> -0.819434).  Saving model ...
Epoch: 8 cost time: 2.001577138900757
Epoch: 8, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.766 Vali Acc: 0.861 Test Loss: 0.766 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861103).  Saving model ...
Epoch: 9 cost time: 2.007878541946411
Epoch: 9, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 2.0629353523254395
Epoch: 10, Steps: 7 | Train Loss: 0.210 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 2.039625883102417
Epoch: 11, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.716841697692871
Epoch: 12, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 2.0098681449890137
Epoch: 13, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.0144431591033936
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.7912087440490723
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 2.208216667175293
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.5862982273101807
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.9019250869750977
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.0681023597717285
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 1.977921485900879
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 1.8087091445922852
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.7633812427520752
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.2011659145355225
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.1249172687530518
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8890860080718994
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.107128143310547
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.998795986175537
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6479406356811523
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.347935914993286
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.709439992904663
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.424283504486084
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.263110876083374
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9275412559509277
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3471908569335938
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.140653610229492
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0243759155273438
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.8826079368591309
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.9304349422454834
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.563187837600708
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.28179669380188
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7636933326721191
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.240832567214966
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.1981208324432373
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.1099154949188232
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.338428020477295
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.820155382156372
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.8013474941253662
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.9440009593963623
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 2.381871223449707
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5530633926391602
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.7191390991210938
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.9077136516571045
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7194769382476807
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.6322660446166992
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.6996362209320068
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.2353153228759766
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.3828580379486084
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.5920438766479492
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 444220
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6898157596588135
Epoch: 1, Steps: 7 | Train Loss: 2.652 Vali Loss: 2.487 Vali Acc: 0.083 Test Loss: 2.487 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.027509927749634
Epoch: 2, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.425 Vali Acc: 0.125 Test Loss: 2.425 Test Acc: 0.125
Validation loss decreased (-0.083308 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 2.1112964153289795
Epoch: 3, Steps: 7 | Train Loss: 2.380 Vali Loss: 2.308 Vali Acc: 0.264 Test Loss: 2.308 Test Acc: 0.264
Validation loss decreased (-0.124976 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 1.3260622024536133
Epoch: 4, Steps: 7 | Train Loss: 2.152 Vali Loss: 2.033 Vali Acc: 0.569 Test Loss: 2.033 Test Acc: 0.569
Validation loss decreased (-0.263866 --> -0.569424).  Saving model ...
Epoch: 5 cost time: 1.6387887001037598
Epoch: 5, Steps: 7 | Train Loss: 1.859 Vali Loss: 1.712 Vali Acc: 0.653 Test Loss: 1.712 Test Acc: 0.653
Validation loss decreased (-0.569424 --> -0.652761).  Saving model ...
Epoch: 6 cost time: 2.1088531017303467
Epoch: 6, Steps: 7 | Train Loss: 1.461 Vali Loss: 1.319 Vali Acc: 0.778 Test Loss: 1.319 Test Acc: 0.778
Validation loss decreased (-0.652761 --> -0.777765).  Saving model ...
Epoch: 7 cost time: 1.3769590854644775
Epoch: 7, Steps: 7 | Train Loss: 0.964 Vali Loss: 0.939 Vali Acc: 0.833 Test Loss: 0.939 Test Acc: 0.833
Validation loss decreased (-0.777765 --> -0.833324).  Saving model ...
Epoch: 8 cost time: 1.5443987846374512
Epoch: 8, Steps: 7 | Train Loss: 0.587 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.7748498916625977
Epoch: 9, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.4074907302856445
Epoch: 10, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8673968315124512
Epoch: 11, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.437105417251587
Epoch: 12, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.849877119064331
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.8376741409301758
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.6065173149108887
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.966153860092163
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8235599994659424
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.9426438808441162
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.4121737480163574
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.8850979804992676
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8227472305297852
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.814450740814209
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.90325927734375
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.4576184749603271
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.0355212688446045
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.7206733226776123
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.7230198383331299
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.122673511505127
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.8987066745758057
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.707719326019287
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.9424355030059814
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.8237764835357666
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.6127283573150635
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.0218331813812256
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.7255516052246094
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.5083396434783936
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.785475254058838
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5682532787322998
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9741859436035156
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.6698079109191895
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.7520122528076172
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.885500431060791
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7227752208709717
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.81451416015625
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.044684410095215
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.9389348030090332
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.5567395687103271
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.9753060340881348
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.7858376502990723
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.7176923751831055
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 2.1353492736816406
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.6064395904541016
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.406395673751831
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8668785095214844
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.576911211013794
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.5833170413970947
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.868234634399414
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.9488303661346436
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.7640101909637451
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.7686619758605957
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.7734394073486328
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.3956503868103027
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 438620
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.741250276565552
Epoch: 1, Steps: 7 | Train Loss: 2.701 Vali Loss: 2.557 Vali Acc: 0.097 Test Loss: 2.557 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.139549493789673
Epoch: 2, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.404 Vali Acc: 0.125 Test Loss: 2.404 Test Acc: 0.125
Validation loss decreased (-0.097197 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 1.940857172012329
Epoch: 3, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.288 Vali Acc: 0.250 Test Loss: 2.288 Test Acc: 0.250
Validation loss decreased (-0.124976 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 1.847367525100708
Epoch: 4, Steps: 7 | Train Loss: 2.255 Vali Loss: 2.130 Vali Acc: 0.472 Test Loss: 2.130 Test Acc: 0.472
Validation loss decreased (-0.249977 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 2.3369011878967285
Epoch: 5, Steps: 7 | Train Loss: 2.057 Vali Loss: 1.939 Vali Acc: 0.569 Test Loss: 1.939 Test Acc: 0.569
Validation loss decreased (-0.472201 --> -0.569425).  Saving model ...
Epoch: 6 cost time: 1.8383994102478027
Epoch: 6, Steps: 7 | Train Loss: 1.706 Vali Loss: 1.574 Vali Acc: 0.778 Test Loss: 1.574 Test Acc: 0.778
Validation loss decreased (-0.569425 --> -0.777762).  Saving model ...
Epoch: 7 cost time: 2.2626664638519287
Epoch: 7, Steps: 7 | Train Loss: 1.334 Vali Loss: 1.211 Vali Acc: 0.778 Test Loss: 1.211 Test Acc: 0.778
Validation loss decreased (-0.777762 --> -0.777766).  Saving model ...
Epoch: 8 cost time: 2.260413885116577
Epoch: 8, Steps: 7 | Train Loss: 0.880 Vali Loss: 0.882 Vali Acc: 0.861 Test Loss: 0.882 Test Acc: 0.861
Validation loss decreased (-0.777766 --> -0.861102).  Saving model ...
Epoch: 9 cost time: 1.6774849891662598
Epoch: 9, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 2.149667978286743
Epoch: 10, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 1.710608959197998
Epoch: 11, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 1.9660489559173584
Epoch: 12, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.095059633255005
Epoch: 13, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9215726852416992
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.0262041091918945
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.9295058250427246
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.9638290405273438
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.915700912475586
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9779751300811768
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.756638765335083
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.650848627090454
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.2087841033935547
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.8386201858520508
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.2941644191741943
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.091721534729004
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.0046706199645996
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2537100315093994
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.6822779178619385
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.8841850757598877
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.5704121589660645
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.5804378986358643
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4617822170257568
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.67861008644104
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.713470458984375
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.7046637535095215
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.6425957679748535
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7805938720703125
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 2.4779317378997803
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.8603410720825195
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 2.3267829418182373
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 2.004121780395508
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 2.0370798110961914
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.2510035037994385
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.662290334701538
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8910446166992188
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.015148162841797
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.203129768371582
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.9496569633483887
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.4949734210968018
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 2.2272140979766846
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.7865216732025146
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 1.8962759971618652
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 2.4890758991241455
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.0783748626708984
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 2.088294267654419
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.913297414779663
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.2524778842926025
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.9939653873443604
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.3563733100891113
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.6324408054351807
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 2.264887809753418
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.2346527576446533
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.9679527282714844
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.1474339962005615
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.4417486190795898
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.1442370414733887
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.9534618854522705
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 2.2793242931365967
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 2.0558409690856934
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 1.9844317436218262
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.0911176204681396
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.781846046447754
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.115690231323242
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.3825979232788086
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 1.7931218147277832
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 2.31396222114563
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 1.9536538124084473
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 1.9725010395050049
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 2.020709991455078
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 1.9267163276672363
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.811000108718872
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.917628288269043
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.794809103012085
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.6719927787780762
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.9346325397491455
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 2.0179872512817383
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 2.1667473316192627
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 2.0434858798980713
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 2.3761231899261475
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 1.9505109786987305
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 2.136859655380249
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 2.2111682891845703
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 1.8585402965545654
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 2.0320611000061035
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.9308440685272217
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.9758431911468506
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.7272331714630127
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 2.1233596801757812
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 2.154215097427368
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 1.9437050819396973
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 338940
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.295620918273926
Epoch: 1, Steps: 7 | Train Loss: 2.634 Vali Loss: 2.518 Vali Acc: 0.069 Test Loss: 2.518 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.7653837203979492
Epoch: 2, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.394 Vali Acc: 0.125 Test Loss: 2.394 Test Acc: 0.125
Validation loss decreased (-0.069419 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 1.7493958473205566
Epoch: 3, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.230 Vali Acc: 0.319 Test Loss: 2.230 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319422).  Saving model ...
Epoch: 4 cost time: 1.55409836769104
Epoch: 4, Steps: 7 | Train Loss: 2.216 Vali Loss: 2.040 Vali Acc: 0.583 Test Loss: 2.040 Test Acc: 0.583
Validation loss decreased (-0.319422 --> -0.583313).  Saving model ...
Epoch: 5 cost time: 2.3292624950408936
Epoch: 5, Steps: 7 | Train Loss: 1.898 Vali Loss: 1.777 Vali Acc: 0.681 Test Loss: 1.777 Test Acc: 0.681
Validation loss decreased (-0.583313 --> -0.680538).  Saving model ...
Epoch: 6 cost time: 1.6978733539581299
Epoch: 6, Steps: 7 | Train Loss: 1.572 Vali Loss: 1.471 Vali Acc: 0.764 Test Loss: 1.471 Test Acc: 0.764
Validation loss decreased (-0.680538 --> -0.763874).  Saving model ...
Epoch: 7 cost time: 1.4518604278564453
Epoch: 7, Steps: 7 | Train Loss: 1.148 Vali Loss: 1.114 Vali Acc: 0.806 Test Loss: 1.114 Test Acc: 0.806
Validation loss decreased (-0.763874 --> -0.805544).  Saving model ...
Epoch: 8 cost time: 2.1473968029022217
Epoch: 8, Steps: 7 | Train Loss: 0.722 Vali Loss: 0.771 Vali Acc: 0.861 Test Loss: 0.771 Test Acc: 0.861
Validation loss decreased (-0.805544 --> -0.861103).  Saving model ...
Epoch: 9 cost time: 1.8970177173614502
Epoch: 9, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 1.7025566101074219
Epoch: 10, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 1.93418288230896
Epoch: 11, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.858755350112915
Epoch: 12, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8868236541748047
Epoch: 13, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8182518482208252
Epoch: 14, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.7347323894500732
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 2.1549794673919678
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9527835845947266
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 2.065878391265869
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.014124631881714
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 2.0947370529174805
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 1.8850328922271729
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 2.119399309158325
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 1.9966542720794678
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 2.3303885459899902
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.022036552429199
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.9056518077850342
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.8772640228271484
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7654736042022705
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 1.694913625717163
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 2.1023952960968018
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 1.3793277740478516
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.177572011947632
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.523782730102539
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 1.8064367771148682
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9185452461242676
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 2.0057036876678467
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6376070976257324
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 1.8364107608795166
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 2.1274020671844482
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9465551376342773
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6288666725158691
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.7904536724090576
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0911874771118164
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.1484901905059814
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.7431650161743164
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.113125801086426
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.678375244140625
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 2.025582790374756
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.9572088718414307
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.5962250232696533
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.870905876159668
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2873544692993164
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8636128902435303
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.6541213989257812
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.9328639507293701
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.305152654647827
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.0062105655670166
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.8378996849060059
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.7320053577423096
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.7118844985961914
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 333340
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.175640106201172
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.520 Vali Acc: 0.139 Test Loss: 2.520 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.687063455581665
Epoch: 2, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.372 Vali Acc: 0.153 Test Loss: 2.372 Test Acc: 0.153
Validation loss decreased (-0.138864 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 1.9342997074127197
Epoch: 3, Steps: 7 | Train Loss: 2.366 Vali Loss: 2.245 Vali Acc: 0.333 Test Loss: 2.245 Test Acc: 0.333
Validation loss decreased (-0.152754 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 1.9105281829833984
Epoch: 4, Steps: 7 | Train Loss: 2.197 Vali Loss: 2.057 Vali Acc: 0.431 Test Loss: 2.057 Test Acc: 0.431
Validation loss decreased (-0.333311 --> -0.430535).  Saving model ...
Epoch: 5 cost time: 1.7361798286437988
Epoch: 5, Steps: 7 | Train Loss: 1.941 Vali Loss: 1.822 Vali Acc: 0.625 Test Loss: 1.822 Test Acc: 0.625
Validation loss decreased (-0.430535 --> -0.624982).  Saving model ...
Epoch: 6 cost time: 1.9348773956298828
Epoch: 6, Steps: 7 | Train Loss: 1.550 Vali Loss: 1.454 Vali Acc: 0.778 Test Loss: 1.454 Test Acc: 0.778
Validation loss decreased (-0.624982 --> -0.777763).  Saving model ...
Epoch: 7 cost time: 1.824674367904663
Epoch: 7, Steps: 7 | Train Loss: 1.116 Vali Loss: 1.076 Vali Acc: 0.819 Test Loss: 1.076 Test Acc: 0.819
Validation loss decreased (-0.777763 --> -0.819434).  Saving model ...
Epoch: 8 cost time: 1.4999241828918457
Epoch: 8, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 2.034977912902832
Epoch: 9, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 1.8105664253234863
Epoch: 10, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8285746574401855
Epoch: 11, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9860448837280273
Epoch: 12, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.6814193725585938
Epoch: 13, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 1.8121836185455322
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.7623965740203857
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.9749515056610107
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.1290037631988525
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.8330845832824707
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.943408489227295
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.01570987701416
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.734818696975708
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.9492285251617432
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.1662163734436035
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.1711692810058594
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.473933458328247
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.7377963066101074
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.898463249206543
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.9271717071533203
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.7383005619049072
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.8189043998718262
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.574955940246582
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.5070607662200928
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.398183822631836
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.702333688735962
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.5143609046936035
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.9581527709960938
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.664659023284912
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7341797351837158
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0344293117523193
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.489694595336914
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.7819287776947021
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 2.5648815631866455
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 2.098130226135254
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 2.0691978931427
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.7165782451629639
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.5960497856140137
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.8686914443969727
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.8733036518096924
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8371539115905762
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 2.0382602214813232
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.7620649337768555
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5426263809204102
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.5920109748840332
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.600771188735962
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.7224969863891602
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.8353087902069092
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.331486701965332
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.6744239330291748
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.6548736095428467
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.7186205387115479
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.8075196743011475
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.760162353515625
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.6101388931274414
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.7937543392181396
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 1.2100152969360352
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.284313678741455
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.1438913345336914
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.4022483825683594
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.3588237762451172
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.4944028854370117
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.5742604732513428
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.9436018466949463
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 1.5541324615478516
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.819582462310791
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.8971495628356934
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.626863956451416
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.918668508529663
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.8774335384368896
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.5101182460784912
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.5663361549377441
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.5196666717529297
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.5148570537567139
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 327740
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.609886407852173
Epoch: 1, Steps: 7 | Train Loss: 2.678 Vali Loss: 2.531 Vali Acc: 0.097 Test Loss: 2.531 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.79679536819458
Epoch: 2, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.387 Vali Acc: 0.153 Test Loss: 2.387 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 2.045872926712036
Epoch: 3, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.310 Vali Acc: 0.306 Test Loss: 2.310 Test Acc: 0.306
Validation loss decreased (-0.152754 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 2.02657151222229
Epoch: 4, Steps: 7 | Train Loss: 2.198 Vali Loss: 2.040 Vali Acc: 0.528 Test Loss: 2.040 Test Acc: 0.528
Validation loss decreased (-0.305532 --> -0.527757).  Saving model ...
Epoch: 5 cost time: 1.9135189056396484
Epoch: 5, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.796 Vali Acc: 0.639 Test Loss: 1.796 Test Acc: 0.639
Validation loss decreased (-0.527757 --> -0.638871).  Saving model ...
Epoch: 6 cost time: 2.341262102127075
Epoch: 6, Steps: 7 | Train Loss: 1.524 Vali Loss: 1.442 Vali Acc: 0.736 Test Loss: 1.442 Test Acc: 0.736
Validation loss decreased (-0.638871 --> -0.736097).  Saving model ...
Epoch: 7 cost time: 2.133173942565918
Epoch: 7, Steps: 7 | Train Loss: 1.134 Vali Loss: 1.069 Vali Acc: 0.819 Test Loss: 1.069 Test Acc: 0.819
Validation loss decreased (-0.736097 --> -0.819434).  Saving model ...
Epoch: 8 cost time: 1.8917675018310547
Epoch: 8, Steps: 7 | Train Loss: 0.772 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819437).  Saving model ...
Epoch: 9 cost time: 2.003441572189331
Epoch: 9, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
Validation loss decreased (-0.819437 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 1.9166274070739746
Epoch: 10, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0393500328063965
Epoch: 11, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 2.031636953353882
Epoch: 12, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.988755226135254
Epoch: 13, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8023953437805176
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.0335159301757812
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.720435619354248
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.126885175704956
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6663670539855957
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1884443759918213
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0158498287200928
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5622210502624512
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.699399709701538
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9444749355316162
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4122850894927979
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.536067008972168
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.610846996307373
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 322140
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.194177627563477
Epoch: 1, Steps: 7 | Train Loss: 2.674 Vali Loss: 2.510 Vali Acc: 0.097 Test Loss: 2.510 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 2.0934181213378906
Epoch: 2, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.399 Vali Acc: 0.222 Test Loss: 2.399 Test Acc: 0.222
Validation loss decreased (-0.097197 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 2.014322519302368
Epoch: 3, Steps: 7 | Train Loss: 2.363 Vali Loss: 2.276 Vali Acc: 0.292 Test Loss: 2.276 Test Acc: 0.292
Validation loss decreased (-0.222198 --> -0.291644).  Saving model ...
Epoch: 4 cost time: 1.7916233539581299
Epoch: 4, Steps: 7 | Train Loss: 2.189 Vali Loss: 2.100 Vali Acc: 0.486 Test Loss: 2.100 Test Acc: 0.486
Validation loss decreased (-0.291644 --> -0.486090).  Saving model ...
Epoch: 5 cost time: 1.9373972415924072
Epoch: 5, Steps: 7 | Train Loss: 1.962 Vali Loss: 1.885 Vali Acc: 0.556 Test Loss: 1.885 Test Acc: 0.556
Validation loss decreased (-0.486090 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 2.0122897624969482
Epoch: 6, Steps: 7 | Train Loss: 1.663 Vali Loss: 1.536 Vali Acc: 0.750 Test Loss: 1.536 Test Acc: 0.750
Validation loss decreased (-0.555537 --> -0.749985).  Saving model ...
Epoch: 7 cost time: 1.8773422241210938
Epoch: 7, Steps: 7 | Train Loss: 1.246 Vali Loss: 1.185 Vali Acc: 0.792 Test Loss: 1.185 Test Acc: 0.792
Validation loss decreased (-0.749985 --> -0.791655).  Saving model ...
Epoch: 8 cost time: 2.293285369873047
Epoch: 8, Steps: 7 | Train Loss: 0.785 Vali Loss: 0.840 Vali Acc: 0.889 Test Loss: 0.840 Test Acc: 0.889
Validation loss decreased (-0.791655 --> -0.888880).  Saving model ...
Epoch: 9 cost time: 1.985896110534668
Epoch: 9, Steps: 7 | Train Loss: 0.496 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7943072319030762
Epoch: 10, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9783251285552979
Epoch: 11, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.408 Vali Acc: 0.917 Test Loss: 0.408 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.374835729598999
Epoch: 12, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0795109272003174
Epoch: 13, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.7233920097351074
Epoch: 14, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.9624009132385254
Epoch: 15, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.919032096862793
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.7649891376495361
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.8392970561981201
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.9045751094818115
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.8361575603485107
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0263328552246094
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.8565714359283447
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.6434907913208008
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9629871845245361
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7270143032073975
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.9561994075775146
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.5684189796447754
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.118609666824341
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.0312862396240234
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.7981693744659424
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.9684641361236572
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.846160888671875
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.1146552562713623
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.7843191623687744
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8479583263397217
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.6417551040649414
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6064088344573975
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.693530797958374
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.561934471130371
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.8118388652801514
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.990633487701416
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 2.297895669937134
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.596450090408325
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8683786392211914
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.381312608718872
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.0431504249572754
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.7992832660675049
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.9849178791046143
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.233566999435425
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.3316125869750977
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.8835351467132568
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.5216293334960938
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 2.0957653522491455
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.775547981262207
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0207924842834473
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.302363872528076
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.501784563064575
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.2647430896759033
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.2574045658111572
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 2.053926467895508
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.1303598880767822
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.4125943183898926
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 2.066464900970459
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.1191539764404297
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.8563249111175537
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.9057400226593018
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.9895596504211426
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.362644672393799
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.430027723312378
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 280700
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.542192459106445
Epoch: 1, Steps: 7 | Train Loss: 2.696 Vali Loss: 2.533 Vali Acc: 0.083 Test Loss: 2.533 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.8247113227844238
Epoch: 2, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.469 Vali Acc: 0.125 Test Loss: 2.469 Test Acc: 0.125
Validation loss decreased (-0.083308 --> -0.124975).  Saving model ...
Epoch: 3 cost time: 2.2266056537628174
Epoch: 3, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.444 Vali Acc: 0.194 Test Loss: 2.444 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 4 cost time: 1.8902289867401123
Epoch: 4, Steps: 7 | Train Loss: 2.359 Vali Loss: 2.247 Vali Acc: 0.194 Test Loss: 2.247 Test Acc: 0.194
Validation loss decreased (-0.194420 --> -0.194422).  Saving model ...
Epoch: 5 cost time: 1.9299180507659912
Epoch: 5, Steps: 7 | Train Loss: 2.212 Vali Loss: 2.065 Vali Acc: 0.556 Test Loss: 2.065 Test Acc: 0.556
Validation loss decreased (-0.194422 --> -0.555535).  Saving model ...
Epoch: 6 cost time: 2.4638726711273193
Epoch: 6, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.836 Vali Acc: 0.667 Test Loss: 1.836 Test Acc: 0.667
Validation loss decreased (-0.555535 --> -0.666648).  Saving model ...
Epoch: 7 cost time: 2.0165343284606934
Epoch: 7, Steps: 7 | Train Loss: 1.615 Vali Loss: 1.499 Vali Acc: 0.778 Test Loss: 1.499 Test Acc: 0.778
Validation loss decreased (-0.666648 --> -0.777763).  Saving model ...
Epoch: 8 cost time: 2.093000650405884
Epoch: 8, Steps: 7 | Train Loss: 1.205 Vali Loss: 1.097 Vali Acc: 0.875 Test Loss: 1.097 Test Acc: 0.875
Validation loss decreased (-0.777763 --> -0.874989).  Saving model ...
Epoch: 9 cost time: 1.737912654876709
Epoch: 9, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.812 Vali Acc: 0.847 Test Loss: 0.812 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9401977062225342
Epoch: 10, Steps: 7 | Train Loss: 0.432 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 1.9474716186523438
Epoch: 11, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 1.8623003959655762
Epoch: 12, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 2.3420777320861816
Epoch: 13, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7547285556793213
Epoch: 14, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 2.0023224353790283
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.8197872638702393
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8148462772369385
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.9913277626037598
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.5232923030853271
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.3614678382873535
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.7674455642700195
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7997870445251465
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5309906005859375
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.624678134918213
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.7796876430511475
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.6508533954620361
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.560260534286499
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.6112442016601562
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.7756757736206055
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.953728437423706
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.2168338298797607
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 2.2362966537475586
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.0084471702575684
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.2355899810791016
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 2.2131073474884033
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 2.103238105773926
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.0253102779388428
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.9119298458099365
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.277212381362915
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5184569358825684
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.264237880706787
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.274324893951416
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.9164202213287354
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 2.1883978843688965
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.7368807792663574
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.7721900939941406
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.6556923389434814
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.5437579154968262
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.9788575172424316
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.6664440631866455
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.9342083930969238
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.9144985675811768
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 2.1228113174438477
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.9799797534942627
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.615126132965088
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 2.1269710063934326
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.9960169792175293
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 2.0507404804229736
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 2.1746633052825928
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.9988112449645996
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 1.9755849838256836
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 1.8473856449127197
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.985779047012329
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 64 cost time: 2.1740450859069824
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 1.705146312713623
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 66 cost time: 1.6425225734710693
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 67 cost time: 2.2021520137786865
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 2.1287591457366943
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.9277598857879639
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 2.0317208766937256
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 1.6514027118682861
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.1868433952331543
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.9403245449066162
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.1439878940582275
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.4272074699401855
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.9555609226226807
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.9922099113464355
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 1.9171061515808105
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 1.8192298412322998
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.9294230937957764
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 2.005401134490967
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.9474716186523438
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 2.0433461666107178
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 2.242861032485962
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 2.0605342388153076
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.5242791175842285
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.5749258995056152
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 1.568319320678711
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.5714359283447266
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 1.4648494720458984
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 1.84132719039917
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 1.6752979755401611
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 2.137464761734009
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 94 cost time: 2.247183322906494
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.7570199966430664
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 2.1220860481262207
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 97 cost time: 1.7275705337524414
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 98 cost time: 2.0065321922302246
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 99 cost time: 2.2391200065612793
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.9177923202514648
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 275100
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.75514554977417
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.491 Vali Acc: 0.083 Test Loss: 2.491 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.8537170886993408
Epoch: 2, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.422 Vali Acc: 0.125 Test Loss: 2.422 Test Acc: 0.125
Validation loss decreased (-0.083308 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 1.9814231395721436
Epoch: 3, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.385 Vali Acc: 0.111 Test Loss: 2.385 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4536495208740234
Epoch: 4, Steps: 7 | Train Loss: 2.364 Vali Loss: 2.230 Vali Acc: 0.403 Test Loss: 2.230 Test Acc: 0.403
Validation loss decreased (-0.124976 --> -0.402755).  Saving model ...
Epoch: 5 cost time: 1.9260542392730713
Epoch: 5, Steps: 7 | Train Loss: 2.194 Vali Loss: 2.067 Vali Acc: 0.500 Test Loss: 2.067 Test Acc: 0.500
Validation loss decreased (-0.402755 --> -0.499979).  Saving model ...
Epoch: 6 cost time: 1.9749412536621094
Epoch: 6, Steps: 7 | Train Loss: 1.953 Vali Loss: 1.786 Vali Acc: 0.667 Test Loss: 1.786 Test Acc: 0.667
Validation loss decreased (-0.499979 --> -0.666649).  Saving model ...
Epoch: 7 cost time: 1.887068271636963
Epoch: 7, Steps: 7 | Train Loss: 1.576 Vali Loss: 1.460 Vali Acc: 0.861 Test Loss: 1.460 Test Acc: 0.861
Validation loss decreased (-0.666649 --> -0.861097).  Saving model ...
Epoch: 8 cost time: 1.6631560325622559
Epoch: 8, Steps: 7 | Train Loss: 1.165 Vali Loss: 1.070 Vali Acc: 0.819 Test Loss: 1.070 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.869992733001709
Epoch: 9, Steps: 7 | Train Loss: 0.759 Vali Loss: 0.765 Vali Acc: 0.861 Test Loss: 0.765 Test Acc: 0.861
Validation loss decreased (-0.861097 --> -0.861103).  Saving model ...
Epoch: 10 cost time: 1.6942977905273438
Epoch: 10, Steps: 7 | Train Loss: 0.432 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 2.0171966552734375
Epoch: 11, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9550764560699463
Epoch: 12, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 1.8555576801300049
Epoch: 13, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.95552396774292
Epoch: 14, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.5764374732971191
Epoch: 15, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.176769733428955
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.9287924766540527
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.106478214263916
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.072361946105957
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0981571674346924
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0515012741088867
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.6791462898254395
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.9804797172546387
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.809962511062622
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.7174499034881592
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.765178918838501
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.597797155380249
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.550663709640503
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8329365253448486
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6060619354248047
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.955409288406372
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9009754657745361
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7191836833953857
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9193267822265625
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.8043510913848877
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.036770820617676
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7038023471832275
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.821108341217041
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.098755121231079
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.0674068927764893
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.964385986328125
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.174376964569092
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9408493041992188
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.2759768962860107
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 269500
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.777390480041504
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.553 Vali Acc: 0.042 Test Loss: 2.553 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 1.8179478645324707
Epoch: 2, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.421 Vali Acc: 0.181 Test Loss: 2.421 Test Acc: 0.181
Validation loss decreased (-0.041641 --> -0.180531).  Saving model ...
Epoch: 3 cost time: 1.730034589767456
Epoch: 3, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.318 Vali Acc: 0.375 Test Loss: 2.318 Test Acc: 0.375
Validation loss decreased (-0.180531 --> -0.374977).  Saving model ...
Epoch: 4 cost time: 1.8686611652374268
Epoch: 4, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.184 Vali Acc: 0.514 Test Loss: 2.184 Test Acc: 0.514
Validation loss decreased (-0.374977 --> -0.513867).  Saving model ...
Epoch: 5 cost time: 1.9542639255523682
Epoch: 5, Steps: 7 | Train Loss: 2.064 Vali Loss: 1.996 Vali Acc: 0.556 Test Loss: 1.996 Test Acc: 0.556
Validation loss decreased (-0.513867 --> -0.555536).  Saving model ...
Epoch: 6 cost time: 1.6033110618591309
Epoch: 6, Steps: 7 | Train Loss: 1.773 Vali Loss: 1.688 Vali Acc: 0.639 Test Loss: 1.688 Test Acc: 0.639
Validation loss decreased (-0.555536 --> -0.638872).  Saving model ...
Epoch: 7 cost time: 1.9135818481445312
Epoch: 7, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.326 Vali Acc: 0.736 Test Loss: 1.326 Test Acc: 0.736
Validation loss decreased (-0.638872 --> -0.736098).  Saving model ...
Epoch: 8 cost time: 2.0182406902313232
Epoch: 8, Steps: 7 | Train Loss: 0.996 Vali Loss: 0.989 Vali Acc: 0.736 Test Loss: 0.989 Test Acc: 0.736
Validation loss decreased (-0.736098 --> -0.736101).  Saving model ...
Epoch: 9 cost time: 1.7916414737701416
Epoch: 9, Steps: 7 | Train Loss: 0.631 Vali Loss: 0.725 Vali Acc: 0.792 Test Loss: 0.725 Test Acc: 0.792
Validation loss decreased (-0.736101 --> -0.791659).  Saving model ...
Epoch: 10 cost time: 1.7273919582366943
Epoch: 10, Steps: 7 | Train Loss: 0.357 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.791659 --> -0.819439).  Saving model ...
Epoch: 11 cost time: 2.2111146450042725
Epoch: 11, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.819439 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 1.9217069149017334
Epoch: 12, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 2.0430288314819336
Epoch: 13, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.76705002784729
Epoch: 14, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2753973007202148
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.6144917011260986
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 1.8838224411010742
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.040210008621216
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7929410934448242
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.753103494644165
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8360726833343506
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5128283500671387
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5079879760742188
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4293320178985596
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.3948371410369873
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.536374807357788
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.159278154373169
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.0315983295440674
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.504115343093872
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.993109941482544
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.717764139175415
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.97971510887146
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1902897357940674
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.038832664489746
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8599860668182373
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9164915084838867
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5556704998016357
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.9794857501983643
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9412841796875
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4845495223999023
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.9761481285095215
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 263900
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.716200590133667
Epoch: 1, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.441 Vali Acc: 0.306 Test Loss: 2.441 Test Acc: 0.306
Validation loss decreased (inf --> -0.305531).  Saving model ...
Epoch: 2 cost time: 2.8989310264587402
Epoch: 2, Steps: 7 | Train Loss: 2.231 Vali Loss: 1.761 Vali Acc: 0.611 Test Loss: 1.761 Test Acc: 0.611
Validation loss decreased (-0.305531 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 2.5338337421417236
Epoch: 3, Steps: 7 | Train Loss: 1.037 Vali Loss: 1.291 Vali Acc: 0.667 Test Loss: 1.291 Test Acc: 0.667
Validation loss decreased (-0.611093 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 2.447749137878418
Epoch: 4, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.722 Vali Acc: 0.861 Test Loss: 0.722 Test Acc: 0.861
Validation loss decreased (-0.666654 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 2.3606221675872803
Epoch: 5, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3666646480560303
Epoch: 6, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.466 Vali Acc: 0.847 Test Loss: 0.466 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5095129013061523
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 2.109818458557129
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.736 Test Loss: 1.401 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.39703106880188
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 2.320657730102539
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 2.634958028793335
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.806 Test Loss: 1.016 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4577927589416504
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5174813270568848
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.903 Test Loss: 0.689 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902771).  Saving model ...
Epoch: 14 cost time: 2.021749496459961
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.903 Test Loss: 0.696 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4543278217315674
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9921984672546387
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.861 Test Loss: 0.994 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3902676105499268
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.861 Test Loss: 0.859 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.300790309906006
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5413055419921875
Epoch: 19, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.423147439956665
Epoch: 20, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.698 Vali Acc: 0.847 Test Loss: 0.698 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9518976211547852
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.205 Vali Acc: 0.819 Test Loss: 1.205 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8245196342468262
Epoch: 22, Steps: 7 | Train Loss: 0.118 Vali Loss: 1.028 Vali Acc: 0.806 Test Loss: 1.028 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2657530307769775
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 9148208
model size : 39.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.22507643699646
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.685 Vali Acc: 0.097 Test Loss: 2.685 Test Acc: 0.097
Validation loss decreased (inf --> -0.097195).  Saving model ...
Epoch: 2 cost time: 1.6927828788757324
Epoch: 2, Steps: 7 | Train Loss: 2.433 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
Validation loss decreased (-0.097195 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 2.322970390319824
Epoch: 3, Steps: 7 | Train Loss: 1.100 Vali Loss: 0.995 Vali Acc: 0.625 Test Loss: 0.995 Test Acc: 0.625
Validation loss decreased (-0.499983 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 2.1115190982818604
Epoch: 4, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.624990 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 2.2044782638549805
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0822207927703857
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.778491497039795
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.82491135597229
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 2.744856834411621
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.469011068344116
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.903 Test Loss: 0.685 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902771).  Saving model ...
Epoch: 11 cost time: 1.7529191970825195
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.430 Vali Acc: 0.903 Test Loss: 0.430 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 1.7483348846435547
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.819 Test Loss: 1.393 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8779497146606445
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.815 Vali Acc: 0.861 Test Loss: 0.815 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.745697259902954
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 1.701206922531128
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.8140530586242676
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4120101928710938
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1536543369293213
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.070462226867676
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.819 Test Loss: 0.969 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2829222679138184
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.833 Test Loss: 0.910 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.108750343322754
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5610830783843994
Epoch: 22, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.847 Vali Acc: 0.861 Test Loss: 0.847 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3640894889831543
Epoch: 23, Steps: 7 | Train Loss: 0.210 Vali Loss: 1.065 Vali Acc: 0.833 Test Loss: 1.065 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.224168062210083
Epoch: 24, Steps: 7 | Train Loss: 0.296 Vali Loss: 1.014 Vali Acc: 0.792 Test Loss: 1.014 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.36214280128479
Epoch: 25, Steps: 7 | Train Loss: 0.380 Vali Loss: 1.854 Vali Acc: 0.875 Test Loss: 1.854 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9109808
model size : 39.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.158534288406372
Epoch: 1, Steps: 7 | Train Loss: 2.658 Vali Loss: 2.434 Vali Acc: 0.097 Test Loss: 2.434 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 2.096705198287964
Epoch: 2, Steps: 7 | Train Loss: 2.161 Vali Loss: 1.723 Vali Acc: 0.472 Test Loss: 1.723 Test Acc: 0.472
Validation loss decreased (-0.097198 --> -0.472205).  Saving model ...
Epoch: 3 cost time: 2.1799395084381104
Epoch: 3, Steps: 7 | Train Loss: 0.961 Vali Loss: 0.744 Vali Acc: 0.847 Test Loss: 0.744 Test Acc: 0.847
Validation loss decreased (-0.472205 --> -0.847215).  Saving model ...
Epoch: 4 cost time: 2.377042293548584
Epoch: 4, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8498713970184326
Epoch: 5, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 2.1472361087799072
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.8436574935913086
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 2.4177565574645996
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.8507912158966064
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.113652229309082
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.215580701828003
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8567938804626465
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.847 Test Loss: 0.826 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8874588012695312
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.847 Test Loss: 0.706 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5933406352996826
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7044904232025146
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9028677940368652
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7904841899871826
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9135997295379639
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 9071408
model size : 39.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.236785173416138
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.495 Vali Acc: 0.278 Test Loss: 2.495 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 2.35071063041687
Epoch: 2, Steps: 7 | Train Loss: 2.127 Vali Loss: 1.353 Vali Acc: 0.681 Test Loss: 1.353 Test Acc: 0.681
Validation loss decreased (-0.277753 --> -0.680542).  Saving model ...
Epoch: 3 cost time: 2.6245532035827637
Epoch: 3, Steps: 7 | Train Loss: 0.757 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
Validation loss decreased (-0.680542 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.8935139179229736
Epoch: 4, Steps: 7 | Train Loss: 0.439 Vali Loss: 0.866 Vali Acc: 0.792 Test Loss: 0.866 Test Acc: 0.792
Validation loss decreased (-0.749993 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.9872972965240479
Epoch: 5, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
Validation loss decreased (-0.791658 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.9354853630065918
Epoch: 6, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 2.160947561264038
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.216 Vali Acc: 0.847 Test Loss: 1.216 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.516871452331543
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.534 Vali Acc: 0.931 Test Loss: 0.534 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930550).  Saving model ...
Epoch: 9 cost time: 2.187854528427124
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.426 Vali Acc: 0.903 Test Loss: 0.426 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.864819049835205
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.232343912124634
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.057448148727417
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 2.2556746006011963
Epoch: 13, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.497 Vali Acc: 0.931 Test Loss: 0.497 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.161129951477051
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.4617156982421875
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.067533254623413
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.024681806564331
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0821330547332764
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.291118621826172
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.220489025115967
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.931 Test Loss: 0.383 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.221590042114258
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.931 Test Loss: 0.384 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7535102367401123
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.931 Test Loss: 0.385 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.340794086456299
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.931 Test Loss: 0.385 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2307212352752686
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9033008
model size : 39.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.5045952796936035
Epoch: 1, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.556 Vali Acc: 0.139 Test Loss: 2.556 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 2.322248935699463
Epoch: 2, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.485 Vali Acc: 0.444 Test Loss: 1.485 Test Acc: 0.444
Validation loss decreased (-0.138863 --> -0.444430).  Saving model ...
Epoch: 3 cost time: 2.361123561859131
Epoch: 3, Steps: 7 | Train Loss: 0.840 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.444430 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 2.2024521827697754
Epoch: 4, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.970160961151123
Epoch: 5, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.663149356842041
Epoch: 6, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9813592433929443
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.785 Vali Acc: 0.819 Test Loss: 0.785 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7911555767059326
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 2.2058470249176025
Epoch: 9, Steps: 7 | Train Loss: 0.070 Vali Loss: 1.064 Vali Acc: 0.861 Test Loss: 1.064 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8720905780792236
Epoch: 10, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 2.1777541637420654
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.533 Vali Acc: 0.806 Test Loss: 1.533 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.253448247909546
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 1.048 Vali Acc: 0.819 Test Loss: 1.048 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8168988227844238
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.861 Test Loss: 0.960 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.827566385269165
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.917 Test Loss: 0.487 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 1.9528703689575195
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7958416938781738
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6509106159210205
Epoch: 17, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.521 Vali Acc: 0.917 Test Loss: 0.521 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6160643100738525
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.271639347076416
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.3417298793792725
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.567023754119873
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.103473424911499
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.889 Test Loss: 0.667 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9975616931915283
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.889 Test Loss: 0.681 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.953188180923462
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8378560543060303
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.889 Test Loss: 0.673 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4337971210479736
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.889 Test Loss: 0.665 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3753647804260254
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9231371879577637
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.2390596866607666
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7834928
model size : 34.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.1022515296936035
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.512 Vali Acc: 0.181 Test Loss: 2.512 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 2.3740875720977783
Epoch: 2, Steps: 7 | Train Loss: 2.106 Vali Loss: 1.505 Vali Acc: 0.417 Test Loss: 1.505 Test Acc: 0.417
Validation loss decreased (-0.180530 --> -0.416652).  Saving model ...
Epoch: 3 cost time: 2.165558099746704
Epoch: 3, Steps: 7 | Train Loss: 1.144 Vali Loss: 1.017 Vali Acc: 0.722 Test Loss: 1.017 Test Acc: 0.722
Validation loss decreased (-0.416652 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 1.583813190460205
Epoch: 4, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.675 Vali Acc: 0.764 Test Loss: 0.675 Test Acc: 0.764
Validation loss decreased (-0.722212 --> -0.763882).  Saving model ...
Epoch: 5 cost time: 2.325491189956665
Epoch: 5, Steps: 7 | Train Loss: 0.201 Vali Loss: 1.420 Vali Acc: 0.667 Test Loss: 1.420 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6957268714904785
Epoch: 6, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.701 Vali Acc: 0.792 Test Loss: 0.701 Test Acc: 0.792
Validation loss decreased (-0.763882 --> -0.791660).  Saving model ...
Epoch: 7 cost time: 1.6685802936553955
Epoch: 7, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9691860675811768
Epoch: 8, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
Validation loss decreased (-0.791660 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 1.6473968029022217
Epoch: 9, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.857 Vali Acc: 0.792 Test Loss: 0.857 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0003209114074707
Epoch: 10, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.934 Vali Acc: 0.833 Test Loss: 0.934 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8745040893554688
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.525 Vali Acc: 0.778 Test Loss: 1.525 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9700467586517334
Epoch: 12, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9946386814117432
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.465 Vali Acc: 0.903 Test Loss: 0.465 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 1.7514731884002686
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8675169944763184
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.903 Test Loss: 0.468 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7652745246887207
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7650022506713867
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.200 Vali Acc: 0.792 Test Loss: 1.200 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.09187912940979
Epoch: 18, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8540894985198975
Epoch: 19, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.778 Vali Acc: 0.847 Test Loss: 0.778 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.239638566970825
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.889 Test Loss: 0.719 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.274656057357788
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.889 Test Loss: 0.775 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3665850162506104
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.889 Test Loss: 0.795 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1018221378326416
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.889 Test Loss: 0.862 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1166892051696777
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.903 Test Loss: 0.895 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7796528
model size : 34.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.687084913253784
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.400 Vali Acc: 0.167 Test Loss: 2.400 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.9835386276245117
Epoch: 2, Steps: 7 | Train Loss: 1.919 Vali Loss: 1.421 Vali Acc: 0.667 Test Loss: 1.421 Test Acc: 0.667
Validation loss decreased (-0.166643 --> -0.666652).  Saving model ...
Epoch: 3 cost time: 1.9332549571990967
Epoch: 3, Steps: 7 | Train Loss: 0.830 Vali Loss: 0.978 Vali Acc: 0.611 Test Loss: 0.978 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1596922874450684
Epoch: 4, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.950 Vali Acc: 0.792 Test Loss: 0.950 Test Acc: 0.792
Validation loss decreased (-0.666652 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 2.2932987213134766
Epoch: 5, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.574 Vali Acc: 0.847 Test Loss: 0.574 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 2.0483431816101074
Epoch: 6, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.638 Vali Acc: 0.806 Test Loss: 0.638 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2575817108154297
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.860 Vali Acc: 0.833 Test Loss: 0.860 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7386109828948975
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 2.0268120765686035
Epoch: 9, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1679952144622803
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.780 Vali Acc: 0.861 Test Loss: 0.780 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.379056930541992
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.087 Vali Acc: 0.847 Test Loss: 1.087 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2712302207946777
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8770246505737305
Epoch: 13, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.738 Vali Acc: 0.861 Test Loss: 0.738 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.669011116027832
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8493101596832275
Epoch: 15, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.545 Vali Acc: 0.917 Test Loss: 0.545 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916661).  Saving model ...
Epoch: 16 cost time: 2.611849308013916
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.847 Test Loss: 0.608 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9895288944244385
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.766 Vali Acc: 0.764 Test Loss: 1.766 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.074803113937378
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.508 Vali Acc: 0.806 Test Loss: 1.508 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.096113920211792
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.272 Vali Acc: 0.861 Test Loss: 1.272 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8735485076904297
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.875 Test Loss: 0.749 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8965113162994385
Epoch: 21, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9299383163452148
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.847 Test Loss: 0.787 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6936700344085693
Epoch: 23, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4131956100463867
Epoch: 24, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 1.9220333099365234
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.861 Test Loss: 1.123 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2158052921295166
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.875 Test Loss: 0.930 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.283271551132202
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.861 Test Loss: 0.989 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.351208209991455
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.861 Test Loss: 0.826 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.078552722930908
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9833779335021973
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.179811954498291
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.875 Test Loss: 0.688 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9569566249847412
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4070420265197754
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0212512016296387
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 7758128
model size : 34.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4722812175750732
Epoch: 1, Steps: 7 | Train Loss: 2.719 Vali Loss: 2.493 Vali Acc: 0.139 Test Loss: 2.493 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 2.0822291374206543
Epoch: 2, Steps: 7 | Train Loss: 2.058 Vali Loss: 1.766 Vali Acc: 0.528 Test Loss: 1.766 Test Acc: 0.528
Validation loss decreased (-0.138864 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 1.8551609516143799
Epoch: 3, Steps: 7 | Train Loss: 1.386 Vali Loss: 0.884 Vali Acc: 0.708 Test Loss: 0.884 Test Acc: 0.708
Validation loss decreased (-0.527760 --> -0.708324).  Saving model ...
Epoch: 4 cost time: 1.8301482200622559
Epoch: 4, Steps: 7 | Train Loss: 0.696 Vali Loss: 0.593 Vali Acc: 0.792 Test Loss: 0.593 Test Acc: 0.792
Validation loss decreased (-0.708324 --> -0.791661).  Saving model ...
Epoch: 5 cost time: 1.7999746799468994
Epoch: 5, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.791661 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 1.724947452545166
Epoch: 6, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.819439 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.8552792072296143
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.721996784210205
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.472 Vali Acc: 0.903 Test Loss: 0.472 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 2.064194917678833
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.439756155014038
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.931 Test Loss: 0.521 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930550).  Saving model ...
Epoch: 11 cost time: 1.6481616497039795
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.861 Test Loss: 0.769 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4693403244018555
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.546004295349121
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.875 Test Loss: 0.855 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4121949672698975
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 1.4899015426635742
Epoch: 15, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.126 Vali Acc: 0.958 Test Loss: 0.126 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 1.4010446071624756
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.889 Test Loss: 1.074 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6592683792114258
Epoch: 17, Steps: 7 | Train Loss: 0.032 Vali Loss: 1.183 Vali Acc: 0.889 Test Loss: 1.183 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.030944585800171
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.903 Test Loss: 0.791 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2344932556152344
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.889 Test Loss: 0.760 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.072148084640503
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.889 Test Loss: 0.841 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6323473453521729
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.875 Test Loss: 0.958 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8560802936553955
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.889 Test Loss: 0.940 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8971259593963623
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1137678623199463
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.889 Test Loss: 0.783 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5104379653930664
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.903 Test Loss: 0.743 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 7719728
model size : 34.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9434032440185547
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.561 Vali Acc: 0.236 Test Loss: 2.561 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 1.9110894203186035
Epoch: 2, Steps: 7 | Train Loss: 1.921 Vali Loss: 1.493 Vali Acc: 0.611 Test Loss: 1.493 Test Acc: 0.611
Validation loss decreased (-0.236086 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.8109002113342285
Epoch: 3, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
Validation loss decreased (-0.611096 --> -0.819437).  Saving model ...
Epoch: 4 cost time: 1.9744389057159424
Epoch: 4, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847218).  Saving model ...
Epoch: 5 cost time: 2.0024826526641846
Epoch: 5, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.706 Vali Acc: 0.819 Test Loss: 0.706 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1324541568756104
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 2.212662696838379
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902776).  Saving model ...
Epoch: 8 cost time: 1.8692169189453125
Epoch: 8, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.902776 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 2.6015079021453857
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1496880054473877
Epoch: 10, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 2.395883083343506
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9463646411895752
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1862823963165283
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8862934112548828
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 2.2865798473358154
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8362059593200684
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.182619571685791
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4457406997680664
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0246081352233887
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4744670391082764
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8474771976470947
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1603198051452637
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6328065395355225
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.584254264831543
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7178288
model size : 32.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.642197608947754
Epoch: 1, Steps: 7 | Train Loss: 2.658 Vali Loss: 2.373 Vali Acc: 0.111 Test Loss: 2.373 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 2.046383857727051
Epoch: 2, Steps: 7 | Train Loss: 2.104 Vali Loss: 1.573 Vali Acc: 0.500 Test Loss: 1.573 Test Acc: 0.500
Validation loss decreased (-0.111087 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 2.143942356109619
Epoch: 3, Steps: 7 | Train Loss: 0.873 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
Validation loss decreased (-0.499984 --> -0.819437).  Saving model ...
Epoch: 4 cost time: 1.899444580078125
Epoch: 4, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.390 Vali Acc: 0.847 Test Loss: 0.390 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847218).  Saving model ...
Epoch: 5 cost time: 1.9116742610931396
Epoch: 5, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.938 Vali Acc: 0.819 Test Loss: 0.938 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.265883445739746
Epoch: 6, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.715 Vali Acc: 0.806 Test Loss: 0.715 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1135339736938477
Epoch: 7, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1853723526000977
Epoch: 8, Steps: 7 | Train Loss: 0.244 Vali Loss: 1.446 Vali Acc: 0.736 Test Loss: 1.446 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2646775245666504
Epoch: 9, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.880 Vali Acc: 0.889 Test Loss: 0.880 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888880).  Saving model ...
Epoch: 10 cost time: 1.9013524055480957
Epoch: 10, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8732035160064697
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.833 Test Loss: 1.146 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7979822158813477
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.833 Test Loss: 1.301 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8790180683135986
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.819 Test Loss: 1.229 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2850656509399414
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.861 Test Loss: 0.989 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3177363872528076
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.861 Test Loss: 0.878 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9837172031402588
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.861 Test Loss: 0.827 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.256166934967041
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.861 Test Loss: 0.800 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1269338130950928
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.861 Test Loss: 0.785 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6964552402496338
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 7139888
model size : 32.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.028683423995972
Epoch: 1, Steps: 7 | Train Loss: 2.647 Vali Loss: 2.432 Vali Acc: 0.222 Test Loss: 2.432 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.9832499027252197
Epoch: 2, Steps: 7 | Train Loss: 2.175 Vali Loss: 1.324 Vali Acc: 0.583 Test Loss: 1.324 Test Acc: 0.583
Validation loss decreased (-0.222198 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 2.0990607738494873
Epoch: 3, Steps: 7 | Train Loss: 0.972 Vali Loss: 1.155 Vali Acc: 0.583 Test Loss: 1.155 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583322).  Saving model ...
Epoch: 4 cost time: 2.2096893787384033
Epoch: 4, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.662 Vali Acc: 0.764 Test Loss: 0.662 Test Acc: 0.764
Validation loss decreased (-0.583322 --> -0.763882).  Saving model ...
Epoch: 5 cost time: 2.371885299682617
Epoch: 5, Steps: 7 | Train Loss: 0.132 Vali Loss: 1.206 Vali Acc: 0.736 Test Loss: 1.206 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8714003562927246
Epoch: 6, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.763882 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 2.375955581665039
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 2.177910804748535
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.100721597671509
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 2.332012414932251
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9966840744018555
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3161611557006836
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7560415267944336
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1266448497772217
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0225329399108887
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.172769784927368
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.306072950363159
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.759230613708496
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.088252067565918
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 7101488
model size : 32.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.892953395843506
Epoch: 1, Steps: 7 | Train Loss: 2.649 Vali Loss: 2.455 Vali Acc: 0.181 Test Loss: 2.455 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 1.6151490211486816
Epoch: 2, Steps: 7 | Train Loss: 2.014 Vali Loss: 1.947 Vali Acc: 0.444 Test Loss: 1.947 Test Acc: 0.444
Validation loss decreased (-0.180531 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 1.4628064632415771
Epoch: 3, Steps: 7 | Train Loss: 1.263 Vali Loss: 1.177 Vali Acc: 0.667 Test Loss: 1.177 Test Acc: 0.667
Validation loss decreased (-0.444425 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 1.6001152992248535
Epoch: 4, Steps: 7 | Train Loss: 0.564 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
Validation loss decreased (-0.666655 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 1.451617956161499
Epoch: 5, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.607 Vali Acc: 0.847 Test Loss: 0.607 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.696256399154663
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.796 Vali Acc: 0.764 Test Loss: 0.796 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.883302927017212
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.699 Vali Acc: 0.861 Test Loss: 0.699 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 1.7484383583068848
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.593 Vali Acc: 0.847 Test Loss: 0.593 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6028995513916016
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.861104 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.8287742137908936
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.882 Vali Acc: 0.806 Test Loss: 0.882 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6537139415740967
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.279 Vali Acc: 0.819 Test Loss: 1.279 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.016888380050659
Epoch: 12, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.972 Vali Acc: 0.847 Test Loss: 0.972 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7767224311828613
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.664 Vali Acc: 0.847 Test Loss: 0.664 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4010019302368164
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9482922554016113
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.175 Vali Acc: 0.833 Test Loss: 1.175 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8415729999542236
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.747 Vali Acc: 0.819 Test Loss: 1.747 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8898937702178955
Epoch: 17, Steps: 7 | Train Loss: 0.064 Vali Loss: 1.377 Vali Acc: 0.792 Test Loss: 1.377 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7912256717681885
Epoch: 18, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.980 Vali Acc: 0.847 Test Loss: 0.980 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.119934558868408
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.742 Vali Acc: 0.764 Test Loss: 1.742 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7063088
model size : 31.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6306583881378174
Epoch: 1, Steps: 7 | Train Loss: 2.618 Vali Loss: 2.594 Vali Acc: 0.181 Test Loss: 2.594 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 1.9648418426513672
Epoch: 2, Steps: 7 | Train Loss: 2.077 Vali Loss: 1.352 Vali Acc: 0.639 Test Loss: 1.352 Test Acc: 0.639
Validation loss decreased (-0.180530 --> -0.638875).  Saving model ...
Epoch: 3 cost time: 1.7291045188903809
Epoch: 3, Steps: 7 | Train Loss: 0.785 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.638875 --> -0.833327).  Saving model ...
Epoch: 4 cost time: 2.030346155166626
Epoch: 4, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.527 Vali Acc: 0.792 Test Loss: 0.527 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7191312313079834
Epoch: 5, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 2.2281715869903564
Epoch: 6, Steps: 7 | Train Loss: 0.072 Vali Loss: 1.001 Vali Acc: 0.833 Test Loss: 1.001 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6500258445739746
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.498 Vali Acc: 0.917 Test Loss: 0.498 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 1.6527597904205322
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.890 Vali Acc: 0.847 Test Loss: 0.890 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7377870082855225
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9196832180023193
Epoch: 10, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.575 Vali Acc: 0.917 Test Loss: 0.575 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.114896535873413
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.889 Test Loss: 1.071 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8808746337890625
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.121664047241211
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.248674154281616
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.620462417602539
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.068 Vali Acc: 0.792 Test Loss: 1.068 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2886993885040283
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.691023349761963
Epoch: 17, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9994559288024902
Epoch: 18, Steps: 7 | Train Loss: 0.026 Vali Loss: 1.270 Vali Acc: 0.792 Test Loss: 1.270 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.080174684524536
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.457 Vali Acc: 0.792 Test Loss: 1.457 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.672682523727417
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.181 Vali Acc: 0.847 Test Loss: 1.181 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1045610904693604
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.833 Test Loss: 1.696 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7361786365509033
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.806 Test Loss: 1.956 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.657313585281372
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.819 Test Loss: 1.843 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 6849968
model size : 31.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.210320711135864
Epoch: 1, Steps: 7 | Train Loss: 2.630 Vali Loss: 2.330 Vali Acc: 0.111 Test Loss: 2.330 Test Acc: 0.111
Validation loss decreased (inf --> -0.111088).  Saving model ...
Epoch: 2 cost time: 2.2443504333496094
Epoch: 2, Steps: 7 | Train Loss: 1.821 Vali Loss: 1.715 Vali Acc: 0.528 Test Loss: 1.715 Test Acc: 0.528
Validation loss decreased (-0.111088 --> -0.527761).  Saving model ...
Epoch: 3 cost time: 1.8166606426239014
Epoch: 3, Steps: 7 | Train Loss: 0.888 Vali Loss: 0.952 Vali Acc: 0.667 Test Loss: 0.952 Test Acc: 0.667
Validation loss decreased (-0.527761 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.070784568786621
Epoch: 4, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.666657 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 2.00014591217041
Epoch: 5, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.759 Vali Acc: 0.847 Test Loss: 0.759 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1568801403045654
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.855 Vali Acc: 0.778 Test Loss: 0.855 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.091883420944214
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7958762645721436
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.942 Vali Acc: 0.792 Test Loss: 0.942 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7619085311889648
Epoch: 9, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 2.3598923683166504
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
Validation loss decreased (-0.902774 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.9856410026550293
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.847 Test Loss: 0.751 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7074127197265625
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.561 Vali Acc: 0.903 Test Loss: 0.561 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.28225040435791
Epoch: 13, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.026843547821045
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.492 Vali Acc: 0.778 Test Loss: 1.492 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.154820442199707
Epoch: 15, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.855 Vali Acc: 0.889 Test Loss: 0.855 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0417964458465576
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2470483779907227
Epoch: 17, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8919978141784668
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.354 Vali Acc: 0.806 Test Loss: 1.354 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9844107627868652
Epoch: 19, Steps: 7 | Train Loss: 0.067 Vali Loss: 1.235 Vali Acc: 0.833 Test Loss: 1.235 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1926426887512207
Epoch: 20, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.789 Vali Acc: 0.861 Test Loss: 0.789 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 6811568
model size : 30.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5106844902038574
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.408 Vali Acc: 0.347 Test Loss: 2.408 Test Acc: 0.347
Validation loss decreased (inf --> -0.347198).  Saving model ...
Epoch: 2 cost time: 1.953138828277588
Epoch: 2, Steps: 7 | Train Loss: 2.063 Vali Loss: 1.650 Vali Acc: 0.431 Test Loss: 1.650 Test Acc: 0.431
Validation loss decreased (-0.347198 --> -0.430539).  Saving model ...
Epoch: 3 cost time: 1.6292228698730469
Epoch: 3, Steps: 7 | Train Loss: 0.916 Vali Loss: 0.819 Vali Acc: 0.764 Test Loss: 0.819 Test Acc: 0.764
Validation loss decreased (-0.430539 --> -0.763881).  Saving model ...
Epoch: 4 cost time: 1.757253885269165
Epoch: 4, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.763881 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.468590497970581
Epoch: 5, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 1.683805227279663
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.861106 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.473210334777832
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7870116233825684
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1233086585998535
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8785536289215088
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.0752103328704834
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.861 Test Loss: 0.950 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6202068328857422
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.875 Test Loss: 0.736 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0554285049438477
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7124106884002686
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0256333351135254
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.847 Test Loss: 0.727 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7380082607269287
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5028047561645508
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9841978549957275
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.187476634979248
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.903 Test Loss: 0.502 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9737005233764648
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.903 Test Loss: 0.496 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 6773168
model size : 30.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7802889347076416
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.423 Vali Acc: 0.167 Test Loss: 2.423 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.506044626235962
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 1.667 Vali Acc: 0.444 Test Loss: 1.667 Test Acc: 0.444
Validation loss decreased (-0.166642 --> -0.444428).  Saving model ...
Epoch: 3 cost time: 1.5709450244903564
Epoch: 3, Steps: 7 | Train Loss: 1.133 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.444428 --> -0.833327).  Saving model ...
Epoch: 4 cost time: 1.642073631286621
Epoch: 4, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.748 Vali Acc: 0.792 Test Loss: 0.748 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.657019853591919
Epoch: 5, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.534 Vali Acc: 0.806 Test Loss: 0.534 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.714820384979248
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.798 Vali Acc: 0.847 Test Loss: 0.798 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 1.4686002731323242
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.770 Vali Acc: 0.806 Test Loss: 0.770 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5679876804351807
Epoch: 8, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 1.8649201393127441
Epoch: 9, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4615983963012695
Epoch: 10, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 1.7642240524291992
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.0190610885620117
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.779205322265625
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9068191051483154
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.654012680053711
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6092734336853027
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8343138694763184
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.703768014907837
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8406784534454346
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6570873260498047
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6678798198699951
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 6734768
model size : 30.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6802499294281006
Epoch: 1, Steps: 7 | Train Loss: 2.653 Vali Loss: 2.436 Vali Acc: 0.069 Test Loss: 2.436 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 1.6168930530548096
Epoch: 2, Steps: 7 | Train Loss: 2.233 Vali Loss: 1.856 Vali Acc: 0.542 Test Loss: 1.856 Test Acc: 0.542
Validation loss decreased (-0.069420 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 1.9045538902282715
Epoch: 3, Steps: 7 | Train Loss: 1.517 Vali Loss: 1.133 Vali Acc: 0.750 Test Loss: 1.133 Test Acc: 0.750
Validation loss decreased (-0.541648 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 1.73167085647583
Epoch: 4, Steps: 7 | Train Loss: 0.738 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.749989 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.7527551651000977
Epoch: 5, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.5986387729644775
Epoch: 6, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5978188514709473
Epoch: 7, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4976036548614502
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.2978713512420654
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7519428730010986
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.78092622756958
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 1.6620700359344482
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 2.0116357803344727
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 1.261420726776123
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 1.7193596363067627
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.819962739944458
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 1.9449067115783691
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 1.8724496364593506
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.7120931148529053
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8868293762207031
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4690988063812256
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.221890926361084
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.011739492416382
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9651176929473877
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8916363716125488
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5849039554595947
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.03655743598938
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9305627346038818
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3265968
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.684723377227783
Epoch: 1, Steps: 7 | Train Loss: 2.674 Vali Loss: 2.489 Vali Acc: 0.111 Test Loss: 2.489 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.9558227062225342
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 1.859 Vali Acc: 0.569 Test Loss: 1.859 Test Acc: 0.569
Validation loss decreased (-0.111086 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 1.7040820121765137
Epoch: 3, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.218 Vali Acc: 0.764 Test Loss: 1.218 Test Acc: 0.764
Validation loss decreased (-0.569426 --> -0.763877).  Saving model ...
Epoch: 4 cost time: 1.973633050918579
Epoch: 4, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.770 Vali Acc: 0.819 Test Loss: 0.770 Test Acc: 0.819
Validation loss decreased (-0.763877 --> -0.819437).  Saving model ...
Epoch: 5 cost time: 2.1590209007263184
Epoch: 5, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.819437 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.8981645107269287
Epoch: 6, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1410884857177734
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.092607021331787
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.540116786956787
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.170741081237793
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1196088790893555
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2486412525177
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.931 Test Loss: 0.334 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 1.9433598518371582
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.485048294067383
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0436289310455322
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7252321243286133
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5559780597686768
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.880713701248169
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0265045166015625
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5455687046051025
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6859357357025146
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7195682525634766
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3246768
model size : 14.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.382803201675415
Epoch: 1, Steps: 7 | Train Loss: 2.637 Vali Loss: 2.377 Vali Acc: 0.069 Test Loss: 2.377 Test Acc: 0.069
Validation loss decreased (inf --> -0.069421).  Saving model ...
Epoch: 2 cost time: 2.091327667236328
Epoch: 2, Steps: 7 | Train Loss: 2.327 Vali Loss: 1.879 Vali Acc: 0.444 Test Loss: 1.879 Test Acc: 0.444
Validation loss decreased (-0.069421 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 1.2854912281036377
Epoch: 3, Steps: 7 | Train Loss: 1.649 Vali Loss: 1.244 Vali Acc: 0.667 Test Loss: 1.244 Test Acc: 0.667
Validation loss decreased (-0.444426 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 1.9864916801452637
Epoch: 4, Steps: 7 | Train Loss: 0.774 Vali Loss: 0.633 Vali Acc: 0.806 Test Loss: 0.633 Test Acc: 0.806
Validation loss decreased (-0.666654 --> -0.805549).  Saving model ...
Epoch: 5 cost time: 1.5987353324890137
Epoch: 5, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.6677415370941162
Epoch: 6, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.7234652042388916
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.847 Test Loss: 0.374 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.346435785293579
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.861107 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.5207593441009521
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5455570220947266
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4486949443817139
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.5625364780426025
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4134562015533447
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.5302565097808838
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.6064889430999756
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.7881641387939453
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.9391720294952393
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.734199047088623
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.9932081699371338
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.6570985317230225
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.545670509338379
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.9583687782287598
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.506880521774292
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.6038191318511963
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.5694456100463867
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.7147774696350098
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.769270420074463
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.8774588108062744
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.4713342189788818
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.206397771835327
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.9767608642578125
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.839853048324585
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.7817184925079346
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.4006860256195068
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.133255958557129
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4137279987335205
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.877074956893921
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.3780362606048584
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.9786744117736816
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.599323034286499
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.2718751430511475
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.4300532341003418
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.3961398601531982
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.846233606338501
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.8466525077819824
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1673119068145752
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 2.0139617919921875
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.636777400970459
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 1.5648839473724365
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.4594800472259521
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 1.8919808864593506
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 1.812615156173706
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 1.740419864654541
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.8448987007141113
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 2.104382276535034
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.6962432861328125
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 2.0150413513183594
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 2.0107593536376953
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 1.8825106620788574
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.9819262027740479
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.1521213054656982
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.73581862449646
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.14577054977417
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.5126302242279053
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 2.062514305114746
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.8548698425292969
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 67 cost time: 2.139580488204956
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.0910425186157227
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 69 cost time: 1.6144578456878662
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 70 cost time: 1.407165765762329
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 71 cost time: 1.640378475189209
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.8033928871154785
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.826613187789917
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.1246528625488281
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 75 cost time: 1.4862205982208252
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.425912857055664
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 77 cost time: 1.230621337890625
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 78 cost time: 1.5904569625854492
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 79 cost time: 1.2729332447052002
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 80 cost time: 1.9855263233184814
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 81 cost time: 1.735811710357666
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.9662082195281982
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.8310093879699707
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.7627415657043457
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.4586460590362549
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.524625539779663
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.5620272159576416
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.5405657291412354
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.5012526512145996
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.5097954273223877
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3227568
model size : 14.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4789304733276367
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.375 Vali Acc: 0.153 Test Loss: 2.375 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.4676587581634521
Epoch: 2, Steps: 7 | Train Loss: 2.341 Vali Loss: 1.814 Vali Acc: 0.653 Test Loss: 1.814 Test Acc: 0.653
Validation loss decreased (-0.152754 --> -0.652760).  Saving model ...
Epoch: 3 cost time: 1.8023366928100586
Epoch: 3, Steps: 7 | Train Loss: 1.537 Vali Loss: 1.093 Vali Acc: 0.694 Test Loss: 1.093 Test Acc: 0.694
Validation loss decreased (-0.652760 --> -0.694434).  Saving model ...
Epoch: 4 cost time: 2.007333517074585
Epoch: 4, Steps: 7 | Train Loss: 0.680 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
Validation loss decreased (-0.694434 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.6928231716156006
Epoch: 5, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8210561275482178
Epoch: 6, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.8425509929656982
Epoch: 7, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.4502522945404053
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0200700759887695
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9605381488800049
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.046661853790283
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9321832656860352
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1841323375701904
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.5223796367645264
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.6101024150848389
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.7359323501586914
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.4862980842590332
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.7914295196533203
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.5736010074615479
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.6582286357879639
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.9024405479431152
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.941758632659912
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.8620874881744385
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.1064436435699463
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.8937129974365234
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.7363464832305908
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.9323780536651611
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.339463710784912
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.6680431365966797
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.9088263511657715
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.9097332954406738
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.4782764911651611
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.7707064151763916
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.8151206970214844
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 2.049967050552368
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.9183619022369385
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.4781913757324219
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.5986158847808838
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.5722758769989014
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.5165224075317383
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.092116355895996
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.5873172283172607
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.5233824253082275
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.4815945625305176
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.2179720401763916
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.8306798934936523
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 1.6530587673187256
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 2.091404914855957
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4203190803527832
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 1.8278522491455078
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.5069730281829834
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 1.9803926944732666
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 1.9930543899536133
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 54 cost time: 1.8492448329925537
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5517714023590088
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 1.6300222873687744
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 57 cost time: 1.9028770923614502
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 58 cost time: 1.5538110733032227
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5061278343200684
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 60 cost time: 1.543534278869629
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 61 cost time: 1.5349719524383545
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 62 cost time: 1.6460139751434326
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 63 cost time: 1.4135942459106445
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 64 cost time: 1.3848857879638672
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 65 cost time: 1.7121493816375732
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 66 cost time: 1.3359174728393555
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 67 cost time: 1.9290997982025146
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 68 cost time: 1.4589037895202637
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 69 cost time: 2.1687676906585693
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 70 cost time: 1.3235468864440918
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 71 cost time: 1.8500964641571045
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 72 cost time: 1.5515491962432861
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 73 cost time: 1.7765734195709229
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.5802936553955078
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.0755226612091064
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 76 cost time: 1.9359545707702637
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 77 cost time: 1.7777490615844727
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.5140597820281982
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.6727960109710693
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 80 cost time: 1.5509393215179443
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 81 cost time: 1.6272494792938232
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 82 cost time: 1.5538771152496338
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 83 cost time: 1.9016215801239014
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 84 cost time: 1.3516085147857666
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 85 cost time: 1.5432848930358887
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 86 cost time: 1.3998138904571533
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 87 cost time: 1.380850076675415
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 88 cost time: 1.4509084224700928
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 89 cost time: 1.3856239318847656
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.4722650051116943
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 91 cost time: 1.6121962070465088
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7582201957702637
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.6485257148742676
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 94 cost time: 1.4140467643737793
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 95 cost time: 1.7801916599273682
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.848233699798584
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 97 cost time: 1.8799071311950684
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.778210163116455
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.7962267398834229
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 100 cost time: 1.804527997970581
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3208368
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.642893075942993
Epoch: 1, Steps: 7 | Train Loss: 2.625 Vali Loss: 2.354 Vali Acc: 0.264 Test Loss: 2.354 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 1.9103782176971436
Epoch: 2, Steps: 7 | Train Loss: 2.327 Vali Loss: 1.926 Vali Acc: 0.514 Test Loss: 1.926 Test Acc: 0.514
Validation loss decreased (-0.263865 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 1.9233386516571045
Epoch: 3, Steps: 7 | Train Loss: 1.618 Vali Loss: 1.368 Vali Acc: 0.583 Test Loss: 1.368 Test Acc: 0.583
Validation loss decreased (-0.513870 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 2.1056039333343506
Epoch: 4, Steps: 7 | Train Loss: 0.910 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.583320 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.7148051261901855
Epoch: 5, Steps: 7 | Train Loss: 0.276 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.749991 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 2.0270659923553467
Epoch: 6, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.819439 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.392261028289795
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 2.0282840728759766
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.614 Vali Acc: 0.931 Test Loss: 0.614 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930549).  Saving model ...
Epoch: 9 cost time: 1.3927900791168213
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7751736640930176
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.7142810821533203
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.917 Test Loss: 0.634 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3911173343658447
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4832258224487305
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 1.1109802722930908
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9478449821472168
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4829380512237549
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.650599479675293
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3708648681640625
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8506183624267578
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6354937553405762
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0163464546203613
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7762107849121094
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0805346965789795
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2608048
model size : 12.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6578989028930664
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.446 Vali Acc: 0.250 Test Loss: 2.446 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 1.5761871337890625
Epoch: 2, Steps: 7 | Train Loss: 2.295 Vali Loss: 1.790 Vali Acc: 0.458 Test Loss: 1.790 Test Acc: 0.458
Validation loss decreased (-0.249976 --> -0.458315).  Saving model ...
Epoch: 3 cost time: 1.740922212600708
Epoch: 3, Steps: 7 | Train Loss: 1.588 Vali Loss: 1.204 Vali Acc: 0.764 Test Loss: 1.204 Test Acc: 0.764
Validation loss decreased (-0.458315 --> -0.763877).  Saving model ...
Epoch: 4 cost time: 1.5473260879516602
Epoch: 4, Steps: 7 | Train Loss: 0.813 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.763877 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.757523536682129
Epoch: 5, Steps: 7 | Train Loss: 0.353 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6141180992126465
Epoch: 6, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.833327 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.6839189529418945
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5843794345855713
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8864736557006836
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9904885292053223
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6837096214294434
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 2.0291996002197266
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.849452018737793
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.8188822269439697
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.7663254737854004
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.5505146980285645
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.5308337211608887
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.883709192276001
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.492774486541748
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.4950671195983887
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.5240557193756104
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.7444088459014893
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.896301031112671
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9154210090637207
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3274431228637695
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9317855834960938
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.757051706314087
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.406900405883789
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.8036251068115234
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 2.1152753829956055
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.7147397994995117
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.7770581245422363
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.8472228050231934
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.6305391788482666
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 2.0412793159484863
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.8064584732055664
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7948732376098633
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.9103114604949951
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.700453758239746
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.5714397430419922
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.7085752487182617
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 2.1852240562438965
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.9211301803588867
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.286302089691162
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.2303342819213867
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4254765510559082
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 1.520249366760254
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6540453433990479
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 1.5592365264892578
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 1.4177253246307373
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.9804987907409668
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 1.8724942207336426
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 1.6054010391235352
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8963098526000977
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 55 cost time: 1.4740700721740723
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 1.9112021923065186
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 57 cost time: 2.150153875350952
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.866647481918335
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.9848377704620361
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.955679178237915
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 61 cost time: 2.1149144172668457
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 62 cost time: 1.9376487731933594
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 63 cost time: 2.0118677616119385
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.6566381454467773
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.0740342140197754
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.5510966777801514
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.9591572284698486
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.6234800815582275
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.070160388946533
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.085989475250244
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.0096023082733154
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.6601636409759521
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2588848
model size : 12.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7127840518951416
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.376 Vali Acc: 0.153 Test Loss: 2.376 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.658792495727539
Epoch: 2, Steps: 7 | Train Loss: 2.379 Vali Loss: 1.837 Vali Acc: 0.556 Test Loss: 1.837 Test Acc: 0.556
Validation loss decreased (-0.152754 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.7290115356445312
Epoch: 3, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.214 Vali Acc: 0.736 Test Loss: 1.214 Test Acc: 0.736
Validation loss decreased (-0.555537 --> -0.736099).  Saving model ...
Epoch: 4 cost time: 1.7587502002716064
Epoch: 4, Steps: 7 | Train Loss: 0.876 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
Validation loss decreased (-0.736099 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.1838114261627197
Epoch: 5, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.063075542449951
Epoch: 6, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3659040927886963
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3055391311645508
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.3841919898986816
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0538835525512695
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.889 Test Loss: 0.708 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6485378742218018
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.32063627243042
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4882538318634033
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1936981678009033
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.084829330444336
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.2710750102996826
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972221).  Saving model ...
Epoch: 17 cost time: 1.5038373470306396
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.861 Test Loss: 0.691 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2285537719726562
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.542931079864502
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6297686100006104
Epoch: 20, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5338835716247559
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2163844108581543
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.775 Vali Acc: 0.847 Test Loss: 0.775 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5422191619873047
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.847 Test Loss: 0.792 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.214829206466675
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.903 Test Loss: 0.527 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3825271129608154
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.889 Test Loss: 0.509 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.114288568496704
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 2569648
model size : 12.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.117481231689453
Epoch: 1, Steps: 7 | Train Loss: 2.696 Vali Loss: 2.443 Vali Acc: 0.153 Test Loss: 2.443 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.6983332633972168
Epoch: 2, Steps: 7 | Train Loss: 2.250 Vali Loss: 1.803 Vali Acc: 0.611 Test Loss: 1.803 Test Acc: 0.611
Validation loss decreased (-0.152753 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 1.544396162033081
Epoch: 3, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.204 Vali Acc: 0.708 Test Loss: 1.204 Test Acc: 0.708
Validation loss decreased (-0.611093 --> -0.708321).  Saving model ...
Epoch: 4 cost time: 1.9274117946624756
Epoch: 4, Steps: 7 | Train Loss: 0.925 Vali Loss: 0.689 Vali Acc: 0.792 Test Loss: 0.689 Test Acc: 0.792
Validation loss decreased (-0.708321 --> -0.791660).  Saving model ...
Epoch: 5 cost time: 1.7427310943603516
Epoch: 5, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.791660 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.9287567138671875
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.906264066696167
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4606208801269531
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.510000228881836
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.958 Test Loss: 0.122 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 1.683349370956421
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.944 Test Loss: 0.109 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9870221614837646
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.944 Test Loss: 0.113 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0818610191345215
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.958 Test Loss: 0.118 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 1.6122803688049316
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.958 Test Loss: 0.122 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8139207363128662
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.516627550125122
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6209986209869385
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.661522388458252
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6573383808135986
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4378650188446045
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5097122192382812
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9225490093231201
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.944 Test Loss: 0.147 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8588218688964844
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.944 Test Loss: 0.149 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2550448
model size : 12.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6628873348236084
Epoch: 1, Steps: 7 | Train Loss: 2.653 Vali Loss: 2.410 Vali Acc: 0.111 Test Loss: 2.410 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.944058895111084
Epoch: 2, Steps: 7 | Train Loss: 2.345 Vali Loss: 1.869 Vali Acc: 0.444 Test Loss: 1.869 Test Acc: 0.444
Validation loss decreased (-0.111087 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 1.535248041152954
Epoch: 3, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.242 Vali Acc: 0.778 Test Loss: 1.242 Test Acc: 0.778
Validation loss decreased (-0.444426 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 1.537804365158081
Epoch: 4, Steps: 7 | Train Loss: 0.824 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.777765 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 1.822683572769165
Epoch: 5, Steps: 7 | Train Loss: 0.331 Vali Loss: 0.805 Vali Acc: 0.722 Test Loss: 0.805 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.046936511993408
Epoch: 6, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.9693005084991455
Epoch: 7, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.858609914779663
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.8214356899261475
Epoch: 9, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.646 Vali Acc: 0.847 Test Loss: 0.646 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8955857753753662
Epoch: 10, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 2.116842746734619
Epoch: 11, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.8022215366363525
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.056090831756592
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.7949542999267578
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6534292697906494
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6611886024475098
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7346673011779785
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.780318021774292
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6009056568145752
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.164574146270752
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.885371446609497
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.8105690479278564
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.9876935482025146
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.032414674758911
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.7835659980773926
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.9743943214416504
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.7224352359771729
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.8338501453399658
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.4714252948760986
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.2960577011108398
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.7418301105499268
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.4974684715270996
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.5467095375061035
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.5581059455871582
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.947542428970337
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.675734043121338
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 2.009410858154297
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9627413749694824
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.456970453262329
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8813369274139404
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 2.2329840660095215
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.5509488582611084
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 2.0730793476104736
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.5288670063018799
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.746155023574829
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.9536807537078857
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0312609672546387
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.476391077041626
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 2.2181708812713623
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 2.0090954303741455
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 2.05497670173645
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 2.1446545124053955
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 2.1186790466308594
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.571399450302124
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.9043452739715576
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.6570825576782227
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.8700542449951172
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.17158579826355
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.8271596431732178
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.1769492626190186
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.0147275924682617
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.7115118503570557
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2279088
model size : 11.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.60178804397583
Epoch: 1, Steps: 7 | Train Loss: 2.638 Vali Loss: 2.481 Vali Acc: 0.139 Test Loss: 2.481 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.6005308628082275
Epoch: 2, Steps: 7 | Train Loss: 2.223 Vali Loss: 1.919 Vali Acc: 0.569 Test Loss: 1.919 Test Acc: 0.569
Validation loss decreased (-0.138864 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 1.6939079761505127
Epoch: 3, Steps: 7 | Train Loss: 1.713 Vali Loss: 1.248 Vali Acc: 0.681 Test Loss: 1.248 Test Acc: 0.681
Validation loss decreased (-0.569425 --> -0.680543).  Saving model ...
Epoch: 4 cost time: 2.207303762435913
Epoch: 4, Steps: 7 | Train Loss: 0.806 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
Validation loss decreased (-0.680543 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 1.732093334197998
Epoch: 5, Steps: 7 | Train Loss: 0.352 Vali Loss: 0.416 Vali Acc: 0.917 Test Loss: 0.416 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.992711067199707
Epoch: 6, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0340871810913086
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.2480967044830322
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.916663 --> -0.972220).  Saving model ...
Epoch: 9 cost time: 2.195348024368286
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.967137098312378
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6975345611572266
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7029871940612793
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7445271015167236
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.427504539489746
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8949503898620605
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7960026264190674
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6309247016906738
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.117187023162842
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 2259888
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.207083225250244
Epoch: 1, Steps: 7 | Train Loss: 2.752 Vali Loss: 2.392 Vali Acc: 0.167 Test Loss: 2.392 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.4740009307861328
Epoch: 2, Steps: 7 | Train Loss: 2.350 Vali Loss: 1.873 Vali Acc: 0.597 Test Loss: 1.873 Test Acc: 0.597
Validation loss decreased (-0.166643 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 1.888686180114746
Epoch: 3, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.154 Vali Acc: 0.750 Test Loss: 1.154 Test Acc: 0.750
Validation loss decreased (-0.597203 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 1.6113524436950684
Epoch: 4, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6770851612091064
Epoch: 5, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.749988 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.5454940795898438
Epoch: 6, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.7018961906433105
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3832659721374512
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.502 Vali Acc: 0.903 Test Loss: 0.502 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.8752973079681396
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3274497985839844
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1789920330047607
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.612360954284668
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.7259089946746826
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.5939154624938965
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.9186365604400635
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6822686195373535
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9203119277954102
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.5164382457733154
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.8524935245513916
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3269476890563965
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.632140874862671
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5527524948120117
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.439382553100586
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7472493648529053
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5728356838226318
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7208383083343506
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7181482315063477
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8626861572265625
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2240688
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3990871906280518
Epoch: 1, Steps: 7 | Train Loss: 2.650 Vali Loss: 2.440 Vali Acc: 0.222 Test Loss: 2.440 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 2.184973955154419
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
Validation loss decreased (-0.222198 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.561065912246704
Epoch: 3, Steps: 7 | Train Loss: 1.610 Vali Loss: 1.172 Vali Acc: 0.667 Test Loss: 1.172 Test Acc: 0.667
Validation loss decreased (-0.499981 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 1.5362358093261719
Epoch: 4, Steps: 7 | Train Loss: 0.732 Vali Loss: 0.692 Vali Acc: 0.889 Test Loss: 0.692 Test Acc: 0.889
Validation loss decreased (-0.666655 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 1.6296474933624268
Epoch: 5, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.390453815460205
Epoch: 6, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.4997925758361816
Epoch: 7, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.6773030757904053
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5469062328338623
Epoch: 9, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8467955589294434
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6008026599884033
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8005776405334473
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.8468823432922363
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.4235384464263916
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.7746424674987793
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7518196105957031
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8706960678100586
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7572205066680908
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6755564212799072
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6202497482299805
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8022067546844482
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7979764938354492
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7638013362884521
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6221909523010254
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8447785377502441
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5777034759521484
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2221488
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.748547077178955
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.421 Vali Acc: 0.125 Test Loss: 2.421 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.6525743007659912
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 1.946 Vali Acc: 0.597 Test Loss: 1.946 Test Acc: 0.597
Validation loss decreased (-0.124976 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 1.4122014045715332
Epoch: 3, Steps: 7 | Train Loss: 1.765 Vali Loss: 1.466 Vali Acc: 0.639 Test Loss: 1.466 Test Acc: 0.639
Validation loss decreased (-0.597203 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.5716795921325684
Epoch: 4, Steps: 7 | Train Loss: 1.105 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
Validation loss decreased (-0.638874 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 1.8534367084503174
Epoch: 5, Steps: 7 | Train Loss: 0.535 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777771).  Saving model ...
Epoch: 6 cost time: 1.5292863845825195
Epoch: 6, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.777771 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.6822988986968994
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4733145236968994
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4649291038513184
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8289554119110107
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.7014496326446533
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9782419204711914
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3675792217254639
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.068269968032837
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8397250175476074
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.667771577835083
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8065803050994873
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7121739387512207
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9767036437988281
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4074997901916504
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2114608
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8481569290161133
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.423 Vali Acc: 0.222 Test Loss: 2.423 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 2.0181376934051514
Epoch: 2, Steps: 7 | Train Loss: 2.293 Vali Loss: 1.846 Vali Acc: 0.403 Test Loss: 1.846 Test Acc: 0.403
Validation loss decreased (-0.222198 --> -0.402759).  Saving model ...
Epoch: 3 cost time: 1.6761884689331055
Epoch: 3, Steps: 7 | Train Loss: 1.685 Vali Loss: 1.266 Vali Acc: 0.833 Test Loss: 1.266 Test Acc: 0.833
Validation loss decreased (-0.402759 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 1.7806570529937744
Epoch: 4, Steps: 7 | Train Loss: 0.912 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5726373195648193
Epoch: 5, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.808840274810791
Epoch: 6, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.6381874084472656
Epoch: 7, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.386439561843872
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.3939950466156006
Epoch: 9, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4246275424957275
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.774791955947876
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4305429458618164
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5973410606384277
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9176721572875977
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7963950634002686
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7161052227020264
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3909740447998047
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.311131238937378
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2095408
model size : 10.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0458574295043945
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.418 Vali Acc: 0.264 Test Loss: 2.418 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 1.355818271636963
Epoch: 2, Steps: 7 | Train Loss: 2.238 Vali Loss: 1.894 Vali Acc: 0.556 Test Loss: 1.894 Test Acc: 0.556
Validation loss decreased (-0.263865 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.811645269393921
Epoch: 3, Steps: 7 | Train Loss: 1.587 Vali Loss: 1.224 Vali Acc: 0.722 Test Loss: 1.224 Test Acc: 0.722
Validation loss decreased (-0.555537 --> -0.722210).  Saving model ...
Epoch: 4 cost time: 2.058617115020752
Epoch: 4, Steps: 7 | Train Loss: 0.843 Vali Loss: 0.841 Vali Acc: 0.778 Test Loss: 0.841 Test Acc: 0.778
Validation loss decreased (-0.722210 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 1.478074073791504
Epoch: 5, Steps: 7 | Train Loss: 0.368 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.777769 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.5705223083496094
Epoch: 6, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.833328 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.833549976348877
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.8091375827789307
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0691709518432617
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.771 Vali Acc: 0.806 Test Loss: 0.771 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.849121332168579
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 1.5306763648986816
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.5204532146453857
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 1.3942437171936035
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4674947261810303
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5725557804107666
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2150969505310059
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.722090244293213
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.533492088317871
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7544095516204834
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9228870868682861
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9307074546813965
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.996894121170044
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.96256422996521
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.6573805809020996
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.6040196418762207
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.6273715496063232
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.6441380977630615
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.8833706378936768
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.5074987411499023
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.8212532997131348
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.8441288471221924
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.6453144550323486
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.4842746257781982
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.962120771408081
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.8751587867736816
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.5977256298065186
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.5171194076538086
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.8459300994873047
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.6272742748260498
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.5134153366088867
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.876173496246338
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.5997521877288818
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.6787269115447998
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 1.3404767513275146
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.7924892902374268
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.4568254947662354
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.539184331893921
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.6178336143493652
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.706388235092163
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.688321828842163
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.7711608409881592
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 1.4039859771728516
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6277272701263428
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6551363468170166
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 1.5427665710449219
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.4867057800292969
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.733410120010376
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.8035833835601807
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.7210564613342285
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.401780366897583
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 1.6994140148162842
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 1.9877090454101562
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 1.5443570613861084
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 1.925873041152954
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.8731772899627686
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.7959935665130615
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.825326681137085
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5329103469848633
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 1.938774585723877
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 1.708404541015625
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 1.7100608348846436
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 2.1295769214630127
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 1.912013292312622
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 1.9112272262573242
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 1.714365005493164
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 1.787708044052124
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 1.8847661018371582
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 1.698564052581787
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 1.8321783542633057
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.7591662406921387
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.7630729675292969
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 1.7075607776641846
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.5552549362182617
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.566962480545044
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 1.5927526950836182
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.9064314365386963
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 87 cost time: 1.6905217170715332
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 88 cost time: 1.681241750717163
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 1.7057769298553467
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 1.9443202018737793
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.8040859699249268
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 1.1866176128387451
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 1.7534785270690918
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.8423118591308594
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.9162075519561768
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 1.8380839824676514
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 1.3860974311828613
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.1726233959198
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.1008167266845703
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.4795806407928467
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2076208
model size : 10.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7677597999572754
Epoch: 1, Steps: 7 | Train Loss: 2.679 Vali Loss: 2.458 Vali Acc: 0.153 Test Loss: 2.458 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.3397574424743652
Epoch: 2, Steps: 7 | Train Loss: 2.464 Vali Loss: 1.937 Vali Acc: 0.542 Test Loss: 1.937 Test Acc: 0.542
Validation loss decreased (-0.152753 --> -0.541647).  Saving model ...
Epoch: 3 cost time: 1.0906283855438232
Epoch: 3, Steps: 7 | Train Loss: 1.630 Vali Loss: 1.299 Vali Acc: 0.722 Test Loss: 1.299 Test Acc: 0.722
Validation loss decreased (-0.541647 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 1.6319780349731445
Epoch: 4, Steps: 7 | Train Loss: 0.911 Vali Loss: 0.845 Vali Acc: 0.819 Test Loss: 0.845 Test Acc: 0.819
Validation loss decreased (-0.722209 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 1.6857283115386963
Epoch: 5, Steps: 7 | Train Loss: 0.363 Vali Loss: 0.754 Vali Acc: 0.764 Test Loss: 0.754 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7843756675720215
Epoch: 6, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.599 Vali Acc: 0.764 Test Loss: 0.599 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.268043041229248
Epoch: 7, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.819436 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.4319818019866943
Epoch: 8, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1904709339141846
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6522259712219238
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.903 Test Loss: 0.521 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4916226863861084
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5194127559661865
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.76655912399292
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8405945301055908
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8609259128570557
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8839573860168457
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6970748901367188
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.088261365890503
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.8483738899230957
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6334285736083984
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5806090831756592
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5506415367126465
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3518211841583252
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.371635913848877
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4630279541015625
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.442011833190918
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5281214714050293
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3083157539367676
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2057008
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.69614577293396
Epoch: 1, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.418 Vali Acc: 0.208 Test Loss: 2.418 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.5530147552490234
Epoch: 2, Steps: 7 | Train Loss: 2.420 Vali Loss: 2.205 Vali Acc: 0.403 Test Loss: 2.205 Test Acc: 0.403
Validation loss decreased (-0.208309 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 1.7885096073150635
Epoch: 3, Steps: 7 | Train Loss: 1.970 Vali Loss: 1.726 Vali Acc: 0.472 Test Loss: 1.726 Test Acc: 0.472
Validation loss decreased (-0.402756 --> -0.472205).  Saving model ...
Epoch: 4 cost time: 1.7930047512054443
Epoch: 4, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.088 Vali Acc: 0.875 Test Loss: 1.088 Test Acc: 0.875
Validation loss decreased (-0.472205 --> -0.874989).  Saving model ...
Epoch: 5 cost time: 1.4444925785064697
Epoch: 5, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1261377334594727
Epoch: 6, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
Validation loss decreased (-0.874989 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.7009356021881104
Epoch: 7, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6333072185516357
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5502848625183105
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3313930034637451
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.266627550125122
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5451195240020752
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.314873218536377
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.6192874908447266
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8839607238769531
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.451678991317749
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5823564529418945
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5101122856140137
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7736420631408691
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8289918899536133
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3567438125610352
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6628820896148682
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7828998565673828
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7288398742675781
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9605584144592285
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1307888
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5526719093322754
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.390 Vali Acc: 0.194 Test Loss: 2.390 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.6748943328857422
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.119 Vali Acc: 0.417 Test Loss: 2.119 Test Acc: 0.417
Validation loss decreased (-0.194421 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 1.8735082149505615
Epoch: 3, Steps: 7 | Train Loss: 2.058 Vali Loss: 1.778 Vali Acc: 0.542 Test Loss: 1.778 Test Acc: 0.542
Validation loss decreased (-0.416645 --> -0.541649).  Saving model ...
Epoch: 4 cost time: 1.6013524532318115
Epoch: 4, Steps: 7 | Train Loss: 1.347 Vali Loss: 1.099 Vali Acc: 0.778 Test Loss: 1.099 Test Acc: 0.778
Validation loss decreased (-0.541649 --> -0.777767).  Saving model ...
Epoch: 5 cost time: 1.8864150047302246
Epoch: 5, Steps: 7 | Train Loss: 0.707 Vali Loss: 0.679 Vali Acc: 0.861 Test Loss: 0.679 Test Acc: 0.861
Validation loss decreased (-0.777767 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 1.6553423404693604
Epoch: 6, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.445 Vali Acc: 0.806 Test Loss: 0.445 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.753929853439331
Epoch: 7, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.5850114822387695
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.4259014129638672
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3465001583099365
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.5072500705718994
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 1.5793311595916748
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 1.6131956577301025
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3535127639770508
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0131008625030518
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5948240756988525
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1331498622894287
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.705199956893921
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.7085492610931396
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.4974944591522217
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 1.4985065460205078
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 1.7150373458862305
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 1.8162741661071777
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 1.6536481380462646
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.5506532192230225
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.7867040634155273
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.7137560844421387
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 1.5527596473693848
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 1.2588496208190918
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.2734277248382568
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.1952910423278809
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.740691900253296
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.6470468044281006
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.572098970413208
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 1.8291306495666504
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4738125801086426
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 1.477919578552246
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4280221462249756
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6343412399291992
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6728835105895996
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.931 Test Loss: 0.162 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4382755756378174
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.931 Test Loss: 0.162 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5696632862091064
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.850407600402832
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.6046979427337646
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.5335817337036133
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.5541532039642334
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1298288
model size : 6.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.68845534324646
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.420 Vali Acc: 0.208 Test Loss: 2.420 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.9336254596710205
Epoch: 2, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.226 Vali Acc: 0.250 Test Loss: 2.226 Test Acc: 0.250
Validation loss decreased (-0.208309 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 1.4555504322052002
Epoch: 3, Steps: 7 | Train Loss: 2.080 Vali Loss: 1.842 Vali Acc: 0.556 Test Loss: 1.842 Test Acc: 0.556
Validation loss decreased (-0.249978 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 2.033160448074341
Epoch: 4, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.215 Vali Acc: 0.847 Test Loss: 1.215 Test Acc: 0.847
Validation loss decreased (-0.555537 --> -0.847210).  Saving model ...
Epoch: 5 cost time: 1.8332109451293945
Epoch: 5, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.745 Vali Acc: 0.847 Test Loss: 0.745 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 1.4701709747314453
Epoch: 6, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.7189207077026367
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5165085792541504
Epoch: 8, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.153245449066162
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4685864448547363
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 1.5826072692871094
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8261792659759521
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.6295950412750244
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.9682707786560059
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.513214349746704
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.4198410511016846
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.531764030456543
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.6461331844329834
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9130022525787354
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8000221252441406
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.83164381980896
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4796221256256104
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7885186672210693
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.6470708847045898
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.5781733989715576
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.345580816268921
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.4993829727172852
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.4131677150726318
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.4858732223510742
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.5879766941070557
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.2112374305725098
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 1.498910903930664
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6280491352081299
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 1.4867255687713623
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 1.8534953594207764
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7611773014068604
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 1.4853155612945557
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 1.6736514568328857
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 1.421576738357544
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 1.772127389907837
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 1.4976544380187988
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 1.7218968868255615
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 1.4160394668579102
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 1.719764232635498
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 1.9073619842529297
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 1.8801448345184326
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 1.7730937004089355
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.981170892715454
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4330241680145264
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 2.0092456340789795
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 51 cost time: 1.9180068969726562
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 52 cost time: 1.7766621112823486
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 53 cost time: 1.677475929260254
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 54 cost time: 1.8655686378479004
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 55 cost time: 1.83860182762146
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 56 cost time: 1.7340819835662842
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 57 cost time: 1.6799376010894775
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 58 cost time: 1.4529368877410889
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 59 cost time: 1.4575989246368408
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 60 cost time: 1.2802979946136475
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 61 cost time: 1.722078800201416
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 62 cost time: 1.4652247428894043
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 63 cost time: 1.603686809539795
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 64 cost time: 1.876699686050415
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.8528728485107422
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.6429588794708252
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.103799819946289
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.0127029418945312
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 69 cost time: 1.5332605838775635
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 70 cost time: 2.0202434062957764
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6006453037261963
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 72 cost time: 2.0644166469573975
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 73 cost time: 1.5145699977874756
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 74 cost time: 2.2046127319335938
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 75 cost time: 1.6957192420959473
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 76 cost time: 1.370814561843872
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 77 cost time: 1.7891130447387695
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 78 cost time: 1.5650553703308105
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 79 cost time: 1.421539306640625
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 80 cost time: 1.4404981136322021
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.3890352249145508
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.9646508693695068
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.735245704650879
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.906618595123291
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.9916479587554932
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.9542644023895264
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.468050241470337
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.7630760669708252
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 1.878873586654663
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1288688
model size : 6.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5599868297576904
Epoch: 1, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.376 Vali Acc: 0.181 Test Loss: 2.376 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.6622421741485596
Epoch: 2, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.167 Vali Acc: 0.347 Test Loss: 2.167 Test Acc: 0.347
Validation loss decreased (-0.180532 --> -0.347201).  Saving model ...
Epoch: 3 cost time: 1.6869101524353027
Epoch: 3, Steps: 7 | Train Loss: 1.933 Vali Loss: 1.662 Vali Acc: 0.403 Test Loss: 1.662 Test Acc: 0.403
Validation loss decreased (-0.347201 --> -0.402761).  Saving model ...
Epoch: 4 cost time: 1.2894277572631836
Epoch: 4, Steps: 7 | Train Loss: 1.218 Vali Loss: 1.092 Vali Acc: 0.819 Test Loss: 1.092 Test Acc: 0.819
Validation loss decreased (-0.402761 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 1.4240427017211914
Epoch: 5, Steps: 7 | Train Loss: 0.620 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 1.6157188415527344
Epoch: 6, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.386 Vali Acc: 0.917 Test Loss: 0.386 Test Acc: 0.917
Validation loss decreased (-0.861105 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.2154161930084229
Epoch: 7, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4634790420532227
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
Validation loss decreased (-0.916663 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 1.7958247661590576
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.435243844985962
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4292576313018799
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5579383373260498
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4660089015960693
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6595361232757568
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6614069938659668
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.861276626586914
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.4939591884613037
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.5110509395599365
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.8075098991394043
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.6054022312164307
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.4815845489501953
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.458289623260498
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.606926441192627
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.5192499160766602
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4216651916503906
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8222682476043701
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.3311662673950195
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.7695584297180176
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.7079343795776367
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.6774115562438965
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.6803748607635498
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.6080706119537354
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.5189671516418457
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.853795051574707
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.7038919925689697
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6927549839019775
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.5445613861083984
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.716559886932373
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6783668994903564
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6830239295959473
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5064024925231934
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6226310729980469
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3791861534118652
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4545080661773682
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.5794105529785156
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.507312297821045
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1279088
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5562312602996826
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.431 Vali Acc: 0.125 Test Loss: 2.431 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.648228645324707
Epoch: 2, Steps: 7 | Train Loss: 2.438 Vali Loss: 2.189 Vali Acc: 0.375 Test Loss: 2.189 Test Acc: 0.375
Validation loss decreased (-0.124976 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 1.4982504844665527
Epoch: 3, Steps: 7 | Train Loss: 2.049 Vali Loss: 1.920 Vali Acc: 0.444 Test Loss: 1.920 Test Acc: 0.444
Validation loss decreased (-0.374978 --> -0.444425).  Saving model ...
Epoch: 4 cost time: 1.5181348323822021
Epoch: 4, Steps: 7 | Train Loss: 1.509 Vali Loss: 1.342 Vali Acc: 0.542 Test Loss: 1.342 Test Acc: 0.542
Validation loss decreased (-0.444425 --> -0.541653).  Saving model ...
Epoch: 5 cost time: 2.0113847255706787
Epoch: 5, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.823 Vali Acc: 0.889 Test Loss: 0.823 Test Acc: 0.889
Validation loss decreased (-0.541653 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 1.8356685638427734
Epoch: 6, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7381007671356201
Epoch: 7, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.432 Vali Acc: 0.847 Test Loss: 0.432 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.627530813217163
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.7618415355682373
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.072152853012085
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.632122278213501
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6883304119110107
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6259233951568604
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3044779300689697
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8307795524597168
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.98075270652771
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5161161422729492
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1813161373138428
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4717435836791992
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 1.9023933410644531
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5302348136901855
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.981720209121704
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6174509525299072
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.759296178817749
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6429343223571777
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 1.9589483737945557
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4723129272460938
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4568848609924316
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.545386791229248
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.6469755172729492
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.664424180984497
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.6581311225891113
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.703354835510254
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.1533889770507812
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3625342845916748
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7634432315826416
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6567633152008057
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6632359027862549
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.3705642223358154
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 1.7005650997161865
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 1.9408152103424072
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7963242530822754
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.7936816215515137
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.3628768920898438
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9736156463623047
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.8405301570892334
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.0488903522491455
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.897799015045166
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0463757514953613
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6766910552978516
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.753450632095337
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.8556973934173584
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.0290019512176514
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7168829441070557
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.6025044918060303
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.7923316955566406
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.2550408840179443
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 1.8398644924163818
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 1.7759089469909668
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 1.9595215320587158
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 1.4724721908569336
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5545387268066406
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.7055933475494385
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.7660548686981201
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.9849796295166016
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.7115411758422852
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.8382208347320557
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.8865184783935547
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.4084033966064453
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 2.2242326736450195
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 977648
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.219883441925049
Epoch: 1, Steps: 7 | Train Loss: 2.768 Vali Loss: 2.505 Vali Acc: 0.125 Test Loss: 2.505 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.666135549545288
Epoch: 2, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.223 Vali Acc: 0.389 Test Loss: 2.223 Test Acc: 0.389
Validation loss decreased (-0.124975 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.571051836013794
Epoch: 3, Steps: 7 | Train Loss: 1.986 Vali Loss: 1.722 Vali Acc: 0.569 Test Loss: 1.722 Test Acc: 0.569
Validation loss decreased (-0.388867 --> -0.569427).  Saving model ...
Epoch: 4 cost time: 1.393369436264038
Epoch: 4, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.148 Vali Acc: 0.819 Test Loss: 1.148 Test Acc: 0.819
Validation loss decreased (-0.569427 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 1.2167212963104248
Epoch: 5, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
Validation loss decreased (-0.819433 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 1.4419524669647217
Epoch: 6, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 1.4067816734313965
Epoch: 7, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.5256969928741455
Epoch: 8, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.306990146636963
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.5688436031341553
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.5350539684295654
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.65793776512146
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.3885433673858643
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.4039998054504395
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7276008129119873
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5281362533569336
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8334190845489502
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0817186832427979
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6816864013671875
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4152052402496338
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7856934070587158
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5362200736999512
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4695971012115479
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 968048
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9828648567199707
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.386 Vali Acc: 0.236 Test Loss: 2.386 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 1.68013334274292
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.019 Vali Acc: 0.431 Test Loss: 2.019 Test Acc: 0.431
Validation loss decreased (-0.236087 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 1.7166450023651123
Epoch: 3, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.561 Vali Acc: 0.639 Test Loss: 1.561 Test Acc: 0.639
Validation loss decreased (-0.430535 --> -0.638873).  Saving model ...
Epoch: 4 cost time: 1.2319927215576172
Epoch: 4, Steps: 7 | Train Loss: 1.119 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
Validation loss decreased (-0.638873 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 0.9273202419281006
Epoch: 5, Steps: 7 | Train Loss: 0.569 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.749990 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.4072694778442383
Epoch: 6, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.23439359664917
Epoch: 7, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5032470226287842
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1521649360656738
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.874996 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.6413733959197998
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.279465913772583
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3755719661712646
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2779548168182373
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2423231601715088
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2801191806793213
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2807960510253906
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2952888011932373
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.5639567375183105
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.2965164184570312
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.403756856918335
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.4022810459136963
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.4514527320861816
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.3195734024047852
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.1345555782318115
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4209818840026855
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4237921237945557
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8182806968688965
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1324388980865479
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5053253173828125
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.492548942565918
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.548100471496582
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5318455696105957
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.6911954879760742
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 1.3274815082550049
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 1.6611883640289307
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 1.3517284393310547
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 1.3022046089172363
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 1.278017520904541
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 1.4677517414093018
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.6103339195251465
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.3847031593322754
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.678964376449585
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.4611451625823975
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.6699035167694092
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.3140208721160889
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.725264310836792
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4112274646759033
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5426373481750488
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4057652950286865
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3885657787322998
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.380640983581543
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2657649517059326
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 1.4230973720550537
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5048162937164307
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 55 cost time: 1.2470688819885254
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 1.5347199440002441
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5358703136444092
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.109391450881958
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3524620532989502
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.446138858795166
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.217672348022461
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.4392757415771484
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.407820463180542
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.4920299053192139
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.4741642475128174
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 958448
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5331523418426514
Epoch: 1, Steps: 7 | Train Loss: 2.630 Vali Loss: 2.483 Vali Acc: 0.097 Test Loss: 2.483 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.32503080368042
Epoch: 2, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.220 Vali Acc: 0.264 Test Loss: 2.220 Test Acc: 0.264
Validation loss decreased (-0.097197 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 1.580735445022583
Epoch: 3, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.914 Vali Acc: 0.556 Test Loss: 1.914 Test Acc: 0.556
Validation loss decreased (-0.263867 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 1.027921438217163
Epoch: 4, Steps: 7 | Train Loss: 1.464 Vali Loss: 1.288 Vali Acc: 0.667 Test Loss: 1.288 Test Acc: 0.667
Validation loss decreased (-0.555536 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 1.505640983581543
Epoch: 5, Steps: 7 | Train Loss: 0.806 Vali Loss: 0.794 Vali Acc: 0.861 Test Loss: 0.794 Test Acc: 0.861
Validation loss decreased (-0.666654 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 1.293926477432251
Epoch: 6, Steps: 7 | Train Loss: 0.319 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.253931999206543
Epoch: 7, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5107252597808838
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.4873764514923096
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.5481865406036377
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.1240041255950928
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.7996292114257812
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.2337408065795898
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.6431207656860352
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.455200433731079
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7156410217285156
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.5216538906097412
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.5418493747711182
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.4924628734588623
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.4412429332733154
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.5891978740692139
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.4160864353179932
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7163987159729004
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.601616621017456
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.6097280979156494
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.3796627521514893
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.1561167240142822
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.2632591724395752
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.3789374828338623
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.4780731201171875
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.3300259113311768
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.4581475257873535
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.1665761470794678
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.699004888534546
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.6411666870117188
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.3259732723236084
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.5215251445770264
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5646064281463623
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.1708974838256836
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5713512897491455
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.571281909942627
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.2739901542663574
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.2479946613311768
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.4986224174499512
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.2998661994934082
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7589995861053467
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 1.3629791736602783
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7003755569458008
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 1.3413493633270264
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 1.610255241394043
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.2580370903015137
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 1.3495728969573975
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 1.296252965927124
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.462388277053833
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 1.3459711074829102
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.196160078048706
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.3886175155639648
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.3104338645935059
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3601305484771729
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 1.4734885692596436
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 1.4067537784576416
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 1.166947364807129
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 1.2331230640411377
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 1.4606907367706299
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2358129024505615
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.515777826309204
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 1.3489885330200195
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 1.5930564403533936
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.4626061916351318
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.5753719806671143
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.3567416667938232
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 1.5125951766967773
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.4824919700622559
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3229937553405762
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.4257512092590332
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.2559621334075928
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.4687294960021973
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.0407357215881348
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.2802741527557373
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.4007039070129395
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.0845670700073242
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.2241878509521484
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 948848
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1192715167999268
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.403 Vali Acc: 0.194 Test Loss: 2.403 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.5063531398773193
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.104 Vali Acc: 0.472 Test Loss: 2.104 Test Acc: 0.472
Validation loss decreased (-0.194420 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 1.3201427459716797
Epoch: 3, Steps: 7 | Train Loss: 1.899 Vali Loss: 1.741 Vali Acc: 0.528 Test Loss: 1.741 Test Acc: 0.528
Validation loss decreased (-0.472201 --> -0.527760).  Saving model ...
Epoch: 4 cost time: 1.3393230438232422
Epoch: 4, Steps: 7 | Train Loss: 1.379 Vali Loss: 1.166 Vali Acc: 0.750 Test Loss: 1.166 Test Acc: 0.750
Validation loss decreased (-0.527760 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 1.561946153640747
Epoch: 5, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.738 Vali Acc: 0.917 Test Loss: 0.738 Test Acc: 0.917
Validation loss decreased (-0.749988 --> -0.916659).  Saving model ...
Epoch: 6 cost time: 1.7296717166900635
Epoch: 6, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7829968929290771
Epoch: 7, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.481701135635376
Epoch: 8, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.7996513843536377
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.332012414932251
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.4784109592437744
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.474994421005249
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2805416584014893
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.6622138023376465
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.2339787483215332
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5887458324432373
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5901200771331787
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.1363334655761719
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1190903186798096
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.339341640472412
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2585484981536865
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1045541763305664
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.218339204788208
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4320182800292969
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8532533645629883
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.640073537826538
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8267128467559814
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.6011402606964111
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8432729244232178
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6525535583496094
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.816101312637329
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6326446533203125
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.6341259479522705
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.789254903793335
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.4663524627685547
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.7117784023284912
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.613208532333374
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.4938089847564697
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 1.7057476043701172
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5236942768096924
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4946258068084717
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7523105144500732
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7126500606536865
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.758434534072876
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5590465068817139
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.571237325668335
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 1.490886926651001
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 1.596996545791626
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 1.3307273387908936
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 1.5149338245391846
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2965481281280518
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.0454635620117188
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.49588942527771
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.5861918926239014
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.5857365131378174
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.7225334644317627
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.695199966430664
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.5050714015960693
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.4781889915466309
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 812528
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3682546615600586
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.386 Vali Acc: 0.125 Test Loss: 2.386 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.587479829788208
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.094 Vali Acc: 0.431 Test Loss: 2.094 Test Acc: 0.431
Validation loss decreased (-0.124976 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 1.6673009395599365
Epoch: 3, Steps: 7 | Train Loss: 1.956 Vali Loss: 1.634 Vali Acc: 0.583 Test Loss: 1.634 Test Acc: 0.583
Validation loss decreased (-0.430535 --> -0.583317).  Saving model ...
Epoch: 4 cost time: 1.7008395195007324
Epoch: 4, Steps: 7 | Train Loss: 1.419 Vali Loss: 1.161 Vali Acc: 0.792 Test Loss: 1.161 Test Acc: 0.792
Validation loss decreased (-0.583317 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 1.5667455196380615
Epoch: 5, Steps: 7 | Train Loss: 0.792 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 1.2696545124053955
Epoch: 6, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.5694713592529297
Epoch: 7, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 1.3690590858459473
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5571980476379395
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.572570562362671
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.3370649814605713
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.233940601348877
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 1.1112244129180908
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.2577219009399414
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 1.723005771636963
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 1.1984412670135498
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 17 cost time: 1.81317138671875
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8222930431365967
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.4080917835235596
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 1.6036758422851562
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 1.5870394706726074
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 1.8613307476043701
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 1.3669488430023193
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.305584192276001
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.786139726638794
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5869896411895752
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9640240669250488
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6455059051513672
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.686352252960205
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2980294227600098
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.308009147644043
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5948281288146973
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 802928
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.000271558761597
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.405 Vali Acc: 0.083 Test Loss: 2.405 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.712630033493042
Epoch: 2, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.133 Vali Acc: 0.278 Test Loss: 2.133 Test Acc: 0.278
Validation loss decreased (-0.083309 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 1.2904772758483887
Epoch: 3, Steps: 7 | Train Loss: 1.965 Vali Loss: 1.718 Vali Acc: 0.694 Test Loss: 1.718 Test Acc: 0.694
Validation loss decreased (-0.277756 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 1.5854082107543945
Epoch: 4, Steps: 7 | Train Loss: 1.383 Vali Loss: 1.232 Vali Acc: 0.806 Test Loss: 1.232 Test Acc: 0.806
Validation loss decreased (-0.694427 --> -0.805543).  Saving model ...
Epoch: 5 cost time: 1.5684077739715576
Epoch: 5, Steps: 7 | Train Loss: 0.832 Vali Loss: 0.768 Vali Acc: 0.875 Test Loss: 0.768 Test Acc: 0.875
Validation loss decreased (-0.805543 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 1.5692486763000488
Epoch: 6, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
Validation loss decreased (-0.874992 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.5371029376983643
Epoch: 7, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5446670055389404
Epoch: 8, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.7635278701782227
Epoch: 9, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5293657779693604
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0436954498291016
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6752445697784424
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.5677273273468018
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.773425579071045
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.5193276405334473
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.7183058261871338
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.6146726608276367
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.375004529953003
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.7866127490997314
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.759157419204712
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6814055442810059
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.8713932037353516
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.6579711437225342
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.7804889678955078
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.578742504119873
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.835386037826538
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.622621774673462
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.8290188312530518
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.7149033546447754
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.865218162536621
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.547159194946289
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 2.048999309539795
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 2.0866057872772217
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 2.1083498001098633
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9829962253570557
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8622207641601562
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.209280014038086
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.3584191799163818
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.4507966041564941
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7318551540374756
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.299511194229126
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6197845935821533
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.3692882061004639
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.4258098602294922
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 1.8110902309417725
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.4915478229522705
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4392025470733643
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4180598258972168
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.1961185932159424
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.4078295230865479
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2287650108337402
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.4598276615142822
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.44270920753479
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.7025561332702637
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.7415940761566162
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7580535411834717
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 1.8331212997436523
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.561398983001709
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 1.520719051361084
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 1.46736478805542
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 1.6701598167419434
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 1.479541301727295
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 1.4994757175445557
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 1.8786115646362305
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.5764596462249756
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.560873031616211
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.6908543109893799
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.5813837051391602
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 1.4738833904266357
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.4811997413635254
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.7291576862335205
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.708972454071045
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.4295563697814941
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 1.5769379138946533
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.370642900466919
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 1.6660239696502686
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.7752327919006348
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.4656836986541748
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.3699285984039307
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 1.5870144367218018
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 1.552051067352295
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.5962328910827637
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 1.7103800773620605
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 1.755828619003296
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 1.3845136165618896
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 1.6186208724975586
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.5905976295471191
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 1.4764556884765625
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 1.6343963146209717
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.604710340499878
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.5586717128753662
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.8374907970428467
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.6396701335906982
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.3818273544311523
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.421692132949829
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.705207347869873
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.4720594882965088
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 1.5022296905517578
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 793328
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2946996688842773
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.394 Vali Acc: 0.167 Test Loss: 2.394 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.2784197330474854
Epoch: 2, Steps: 7 | Train Loss: 2.273 Vali Loss: 2.059 Vali Acc: 0.431 Test Loss: 2.059 Test Acc: 0.431
Validation loss decreased (-0.166643 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 1.3063814640045166
Epoch: 3, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.583 Vali Acc: 0.653 Test Loss: 1.583 Test Acc: 0.653
Validation loss decreased (-0.430535 --> -0.652762).  Saving model ...
Epoch: 4 cost time: 1.2155804634094238
Epoch: 4, Steps: 7 | Train Loss: 1.145 Vali Loss: 1.187 Vali Acc: 0.722 Test Loss: 1.187 Test Acc: 0.722
Validation loss decreased (-0.652762 --> -0.722210).  Saving model ...
Epoch: 5 cost time: 1.170220136642456
Epoch: 5, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.722210 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 1.307668924331665
Epoch: 6, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1722934246063232
Epoch: 7, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.3222403526306152
Epoch: 8, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.401338815689087
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 1.503450632095337
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.6262414455413818
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.334 Vali Acc: 0.931 Test Loss: 0.334 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 1.252533197402954
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.1997294425964355
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.545421838760376
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.553440809249878
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7220251560211182
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.4478325843811035
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5188400745391846
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9228675365447998
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.731189489364624
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.842834711074829
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.5269880294799805
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.460949420928955
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.683112382888794
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.5122926235198975
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.809340476989746
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.6893951892852783
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.381641149520874
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.737034559249878
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5382168292999268
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8969519138336182
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4254562854766846
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.110701560974121
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1197829246520996
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.4524047374725342
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7344446182250977
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2964367866516113
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.6733143329620361
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.757129192352295
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5308353900909424
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3761608600616455
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7332956790924072
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.73091459274292
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.261404037475586
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.9740564823150635
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.8547627925872803
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.8999683856964111
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7846565246582031
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5161585807800293
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.655637264251709
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.6043124198913574
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.7620196342468262
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.5047917366027832
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.884932041168213
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.4120419025421143
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.622279405593872
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 783728
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.993597984313965
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.463 Vali Acc: 0.069 Test Loss: 2.463 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 1.4193274974822998
Epoch: 2, Steps: 7 | Train Loss: 2.385 Vali Loss: 2.224 Vali Acc: 0.347 Test Loss: 2.224 Test Acc: 0.347
Validation loss decreased (-0.069420 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 1.3656604290008545
Epoch: 3, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.760 Vali Acc: 0.639 Test Loss: 1.760 Test Acc: 0.639
Validation loss decreased (-0.347200 --> -0.638871).  Saving model ...
Epoch: 4 cost time: 1.4434397220611572
Epoch: 4, Steps: 7 | Train Loss: 1.443 Vali Loss: 1.316 Vali Acc: 0.708 Test Loss: 1.316 Test Acc: 0.708
Validation loss decreased (-0.638871 --> -0.708320).  Saving model ...
Epoch: 5 cost time: 1.8434395790100098
Epoch: 5, Steps: 7 | Train Loss: 0.872 Vali Loss: 0.841 Vali Acc: 0.833 Test Loss: 0.841 Test Acc: 0.833
Validation loss decreased (-0.708320 --> -0.833325).  Saving model ...
Epoch: 6 cost time: 1.5267584323883057
Epoch: 6, Steps: 7 | Train Loss: 0.493 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
Validation loss decreased (-0.833325 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 2.044867515563965
Epoch: 7, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8325607776641846
Epoch: 8, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.7450408935546875
Epoch: 9, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.079198122024536
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0591516494750977
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.2628536224365234
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.4476542472839355
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.4975082874298096
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.6726670265197754
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4289076328277588
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.479863166809082
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.331636905670166
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.266191244125366
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7345612049102783
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.026719331741333
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.3458518981933594
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.201942205429077
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0646157264709473
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6889088153839111
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6111719608306885
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.722884178161621
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.6984126567840576
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.177093982696533
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7006933689117432
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.973785400390625
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.7117700576782227
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.1319198608398438
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.7954771518707275
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 1.3552131652832031
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 1.057530403137207
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2452771663665771
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7936253547668457
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.008096933364868
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5461549758911133
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 1.9486885070800781
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 1.2492790222167969
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 2.2161827087402344
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9023973941802979
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7168803215026855
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4213001728057861
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3912444114685059
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4944489002227783
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.6020748615264893
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5026326179504395
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 2.027292013168335
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.7704811096191406
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 1.6652960777282715
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4687020778656006
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.079563856124878
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.9679713249206543
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.6590676307678223
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.4298245906829834
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.350372552871704
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5668730735778809
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.4891040325164795
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3402743339538574
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.7486677169799805
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.079227924346924
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.474778652191162
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.7282426357269287
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 1.414527416229248
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 1.454986572265625
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 1.154496192932129
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 1.5716655254364014
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.7226371765136719
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 1.8954756259918213
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.8191564083099365
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.8408992290496826
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.8531785011291504
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.6477978229522705
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.8865787982940674
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.3513455390930176
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.3439617156982422
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.389859914779663
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.5790154933929443
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.445643663406372
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 1.4126193523406982
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 2.1380343437194824
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.8690671920776367
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 1.376028299331665
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.6468579769134521
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 1.4466724395751953
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 2.18326735496521
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 1.558018445968628
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 1.974865436553955
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 1.777571201324463
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.556408166885376
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.241225242614746
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.7586421966552734
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 2.095240831375122
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.5866179466247559
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 98 cost time: 1.96305251121521
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 99 cost time: 1.3555376529693604
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 2.2482805252075195
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 729968
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6182477474212646
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.434 Vali Acc: 0.139 Test Loss: 2.434 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.9165818691253662
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.138 Vali Acc: 0.458 Test Loss: 2.138 Test Acc: 0.458
Validation loss decreased (-0.138865 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 1.9264445304870605
Epoch: 3, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.725 Vali Acc: 0.556 Test Loss: 1.725 Test Acc: 0.556
Validation loss decreased (-0.458312 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 1.9886329174041748
Epoch: 4, Steps: 7 | Train Loss: 1.461 Vali Loss: 1.217 Vali Acc: 0.792 Test Loss: 1.217 Test Acc: 0.792
Validation loss decreased (-0.555538 --> -0.791654).  Saving model ...
Epoch: 5 cost time: 1.8705687522888184
Epoch: 5, Steps: 7 | Train Loss: 0.920 Vali Loss: 0.879 Vali Acc: 0.889 Test Loss: 0.879 Test Acc: 0.889
Validation loss decreased (-0.791654 --> -0.888880).  Saving model ...
Epoch: 6 cost time: 1.743316650390625
Epoch: 6, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 2.267092704772949
Epoch: 7, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3244609832763672
Epoch: 8, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9109869003295898
Epoch: 9, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5982203483581543
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.6250720024108887
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.59212327003479
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.890202283859253
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8689892292022705
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.904923677444458
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7776625156402588
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8389923572540283
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.923527717590332
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.5233404636383057
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.8828554153442383
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5611553192138672
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3920633792877197
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.443488359451294
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.5606591701507568
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.1621057987213135
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.374603509902954
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.4823782444000244
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.297123908996582
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4277393817901611
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.197767734527588
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1318423748016357
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.853614091873169
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.019777536392212
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8660619258880615
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.595961093902588
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4487645626068115
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3056790828704834
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 720368
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5030694007873535
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.395 Vali Acc: 0.111 Test Loss: 2.395 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.998586654663086
Epoch: 2, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.138 Vali Acc: 0.403 Test Loss: 2.138 Test Acc: 0.403
Validation loss decreased (-0.111087 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 1.30531907081604
Epoch: 3, Steps: 7 | Train Loss: 1.944 Vali Loss: 1.698 Vali Acc: 0.556 Test Loss: 1.698 Test Acc: 0.556
Validation loss decreased (-0.402756 --> -0.555539).  Saving model ...
Epoch: 4 cost time: 1.921797752380371
Epoch: 4, Steps: 7 | Train Loss: 1.321 Vali Loss: 1.216 Vali Acc: 0.806 Test Loss: 1.216 Test Acc: 0.806
Validation loss decreased (-0.555539 --> -0.805543).  Saving model ...
Epoch: 5 cost time: 1.7056140899658203
Epoch: 5, Steps: 7 | Train Loss: 0.819 Vali Loss: 0.818 Vali Acc: 0.847 Test Loss: 0.818 Test Acc: 0.847
Validation loss decreased (-0.805543 --> -0.847214).  Saving model ...
Epoch: 6 cost time: 2.276244878768921
Epoch: 6, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 1.873598575592041
Epoch: 7, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.123270273208618
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.535186529159546
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.9353740215301514
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.6369411945343018
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 1.671316385269165
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.5959243774414062
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0759615898132324
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8086364269256592
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.196213722229004
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5463941097259521
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9450457096099854
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.8743770122528076
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.8225526809692383
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.8637335300445557
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6569726467132568
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.7841663360595703
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.836082935333252
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.8649787902832031
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2809672355651855
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.6574020385742188
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3867721557617188
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.2777094841003418
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 1.825843095779419
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.275944471359253
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2756872177124023
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3832025527954102
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2409889698028564
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2236015796661377
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3196978569030762
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3126590251922607
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1692588329315186
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4854724407196045
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 710768
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8236565589904785
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.422 Vali Acc: 0.153 Test Loss: 2.422 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.3743834495544434
Epoch: 2, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.193 Vali Acc: 0.472 Test Loss: 2.193 Test Acc: 0.472
Validation loss decreased (-0.152754 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 1.6595373153686523
Epoch: 3, Steps: 7 | Train Loss: 1.975 Vali Loss: 1.757 Vali Acc: 0.486 Test Loss: 1.757 Test Acc: 0.486
Validation loss decreased (-0.472200 --> -0.486094).  Saving model ...
Epoch: 4 cost time: 1.6797072887420654
Epoch: 4, Steps: 7 | Train Loss: 1.417 Vali Loss: 1.231 Vali Acc: 0.681 Test Loss: 1.231 Test Acc: 0.681
Validation loss decreased (-0.486094 --> -0.680543).  Saving model ...
Epoch: 5 cost time: 1.6048712730407715
Epoch: 5, Steps: 7 | Train Loss: 0.855 Vali Loss: 0.841 Vali Acc: 0.819 Test Loss: 0.841 Test Acc: 0.819
Validation loss decreased (-0.680543 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 1.4861366748809814
Epoch: 6, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 1.5268728733062744
Epoch: 7, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.3541605472564697
Epoch: 8, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6344056129455566
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.4104650020599365
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.6524834632873535
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.2843830585479736
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8192613124847412
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.7832789421081543
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5136501789093018
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5491414070129395
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8799464702606201
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8681223392486572
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8408267498016357
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.785459041595459
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8297569751739502
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9791278839111328
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1655385494232178
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 701168
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1397738456726074
Epoch: 1, Steps: 7 | Train Loss: 2.686 Vali Loss: 2.507 Vali Acc: 0.069 Test Loss: 2.507 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.4737486839294434
Epoch: 2, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.432 Vali Acc: 0.167 Test Loss: 2.432 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 1.6037015914916992
Epoch: 3, Steps: 7 | Train Loss: 2.355 Vali Loss: 2.207 Vali Acc: 0.264 Test Loss: 2.207 Test Acc: 0.264
Validation loss decreased (-0.166642 --> -0.263867).  Saving model ...
Epoch: 4 cost time: 1.6962459087371826
Epoch: 4, Steps: 7 | Train Loss: 2.064 Vali Loss: 1.895 Vali Acc: 0.472 Test Loss: 1.895 Test Acc: 0.472
Validation loss decreased (-0.263867 --> -0.472203).  Saving model ...
Epoch: 5 cost time: 1.3646979331970215
Epoch: 5, Steps: 7 | Train Loss: 1.566 Vali Loss: 1.422 Vali Acc: 0.750 Test Loss: 1.422 Test Acc: 0.750
Validation loss decreased (-0.472203 --> -0.749986).  Saving model ...
Epoch: 6 cost time: 1.6974871158599854
Epoch: 6, Steps: 7 | Train Loss: 1.060 Vali Loss: 0.941 Vali Acc: 0.806 Test Loss: 0.941 Test Acc: 0.806
Validation loss decreased (-0.749986 --> -0.805546).  Saving model ...
Epoch: 7 cost time: 1.3482108116149902
Epoch: 7, Steps: 7 | Train Loss: 0.550 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 1.6928777694702148
Epoch: 8, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.566479206085205
Epoch: 9, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3893098831176758
Epoch: 10, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6334893703460693
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.902773 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.4182178974151611
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2675111293792725
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4096643924713135
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4860496520996094
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3453102111816406
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1092686653137207
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7932124137878418
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.346344232559204
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.516752004623413
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.720794916152954
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 574608
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.700082540512085
Epoch: 1, Steps: 7 | Train Loss: 2.695 Vali Loss: 2.515 Vali Acc: 0.069 Test Loss: 2.515 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.717905044555664
Epoch: 2, Steps: 7 | Train Loss: 2.518 Vali Loss: 2.453 Vali Acc: 0.222 Test Loss: 2.453 Test Acc: 0.222
Validation loss decreased (-0.069419 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 1.5243337154388428
Epoch: 3, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.171 Vali Acc: 0.417 Test Loss: 2.171 Test Acc: 0.417
Validation loss decreased (-0.222198 --> -0.416645).  Saving model ...
Epoch: 4 cost time: 1.649538278579712
Epoch: 4, Steps: 7 | Train Loss: 1.961 Vali Loss: 1.852 Vali Acc: 0.625 Test Loss: 1.852 Test Acc: 0.625
Validation loss decreased (-0.416645 --> -0.624981).  Saving model ...
Epoch: 5 cost time: 1.6737432479858398
Epoch: 5, Steps: 7 | Train Loss: 1.598 Vali Loss: 1.447 Vali Acc: 0.681 Test Loss: 1.447 Test Acc: 0.681
Validation loss decreased (-0.624981 --> -0.680541).  Saving model ...
Epoch: 6 cost time: 1.8315293788909912
Epoch: 6, Steps: 7 | Train Loss: 1.021 Vali Loss: 0.936 Vali Acc: 0.917 Test Loss: 0.936 Test Acc: 0.917
Validation loss decreased (-0.680541 --> -0.916657).  Saving model ...
Epoch: 7 cost time: 1.5478901863098145
Epoch: 7, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5649075508117676
Epoch: 8, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7865722179412842
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7898180484771729
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.690319299697876
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0263655185699463
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.8742718696594238
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.9038424491882324
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.6017405986785889
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.056004524230957
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5274784564971924
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.9236981868743896
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.796415090560913
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9792606830596924
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4892222881317139
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8975765705108643
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8489348888397217
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.984670639038086
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.6023528575897217
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 2.0480031967163086
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.6979780197143555
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 2.0473811626434326
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.6352617740631104
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 2.1268131732940674
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5339155197143555
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1751697063446045
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9149408340454102
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9056289196014404
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6978251934051514
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0821373462677
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.2801826000213623
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7579102516174316
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 2.0314388275146484
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.7927863597869873
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.7843017578125
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6752538681030273
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.5453519821166992
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.9411885738372803
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.6641929149627686
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.869180679321289
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.540795087814331
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.621854305267334
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.6294326782226562
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 1.7824325561523438
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.6887834072113037
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7972064018249512
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.848006248474121
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.626342535018921
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 1.1410088539123535
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 1.4201788902282715
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3033299446105957
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4927043914794922
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.661860466003418
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 1.883169174194336
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 1.6934292316436768
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.8578522205352783
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.973132848739624
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 1.6725432872772217
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 1.8332946300506592
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.6144218444824219
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.9364631175994873
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.6640126705169678
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.1658668518066406
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.8573060035705566
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.121320962905884
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.9988298416137695
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.7950575351715088
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.77396559715271
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.8260693550109863
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.9099884033203125
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.940039873123169
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.839616060256958
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.8419113159179688
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 1.5217318534851074
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.614466667175293
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 2.3230412006378174
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.6122949123382568
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 1.9227690696716309
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 1.8662199974060059
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.823636531829834
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.0209529399871826
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.947014570236206
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 2.0101468563079834
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.6743757724761963
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 2.016245126724243
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.905005693435669
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.9456391334533691
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 2.0139811038970947
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.7360999584197998
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 96 cost time: 1.3349390029907227
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.0921270847320557
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.6076531410217285
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.88802170753479
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 1.9891698360443115
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 569808
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.47930908203125
Epoch: 1, Steps: 7 | Train Loss: 2.692 Vali Loss: 2.496 Vali Acc: 0.125 Test Loss: 2.496 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.4580066204071045
Epoch: 2, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.439 Vali Acc: 0.194 Test Loss: 2.439 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 1.4781920909881592
Epoch: 3, Steps: 7 | Train Loss: 2.327 Vali Loss: 2.183 Vali Acc: 0.444 Test Loss: 2.183 Test Acc: 0.444
Validation loss decreased (-0.194420 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 1.4585466384887695
Epoch: 4, Steps: 7 | Train Loss: 2.048 Vali Loss: 1.899 Vali Acc: 0.542 Test Loss: 1.899 Test Acc: 0.542
Validation loss decreased (-0.444423 --> -0.541648).  Saving model ...
Epoch: 5 cost time: 1.8764939308166504
Epoch: 5, Steps: 7 | Train Loss: 1.647 Vali Loss: 1.505 Vali Acc: 0.694 Test Loss: 1.505 Test Acc: 0.694
Validation loss decreased (-0.541648 --> -0.694429).  Saving model ...
Epoch: 6 cost time: 1.2129995822906494
Epoch: 6, Steps: 7 | Train Loss: 1.101 Vali Loss: 1.021 Vali Acc: 0.778 Test Loss: 1.021 Test Acc: 0.778
Validation loss decreased (-0.694429 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 1.8441574573516846
Epoch: 7, Steps: 7 | Train Loss: 0.607 Vali Loss: 0.636 Vali Acc: 0.861 Test Loss: 0.636 Test Acc: 0.861
Validation loss decreased (-0.777768 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 1.3462193012237549
Epoch: 8, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.5550775527954102
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5635707378387451
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.210101842880249
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.278162956237793
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.3869669437408447
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.4707701206207275
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.3559660911560059
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.5186288356781006
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.8788173198699951
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.407921314239502
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.439523696899414
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.3742539882659912
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.5411303043365479
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.1533639430999756
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.274608850479126
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2515459060668945
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1693246364593506
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7621519565582275
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.657167911529541
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.4666180610656738
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.2132856845855713
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.3564083576202393
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.6677985191345215
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.235792636871338
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4578113555908203
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.5388667583465576
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.7606239318847656
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.5833802223205566
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.35211181640625
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.4870870113372803
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5878705978393555
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6120266914367676
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2657337188720703
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.58174729347229
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.2425527572631836
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.792511224746704
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5399301052093506
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.834752082824707
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 1.7145586013793945
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 1.4598381519317627
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 1.420773983001709
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6092183589935303
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.7265167236328125
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2632055282592773
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6779778003692627
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.7267704010009766
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3665785789489746
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5824642181396484
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.213129997253418
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1246213912963867
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1513738632202148
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1756386756896973
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 565008
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1490397453308105
Epoch: 1, Steps: 7 | Train Loss: 2.698 Vali Loss: 2.473 Vali Acc: 0.167 Test Loss: 2.473 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.313337802886963
Epoch: 2, Steps: 7 | Train Loss: 2.463 Vali Loss: 2.274 Vali Acc: 0.264 Test Loss: 2.274 Test Acc: 0.264
Validation loss decreased (-0.166642 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 1.4495840072631836
Epoch: 3, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.005 Vali Acc: 0.542 Test Loss: 2.005 Test Acc: 0.542
Validation loss decreased (-0.263866 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 1.5336525440216064
Epoch: 4, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.626 Vali Acc: 0.542 Test Loss: 1.626 Test Acc: 0.542
Validation loss decreased (-0.541647 --> -0.541650).  Saving model ...
Epoch: 5 cost time: 1.5747287273406982
Epoch: 5, Steps: 7 | Train Loss: 1.315 Vali Loss: 1.137 Vali Acc: 0.806 Test Loss: 1.137 Test Acc: 0.806
Validation loss decreased (-0.541650 --> -0.805544).  Saving model ...
Epoch: 6 cost time: 1.2666914463043213
Epoch: 6, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.805544 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 1.5915253162384033
Epoch: 7, Steps: 7 | Train Loss: 0.408 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.432060718536377
Epoch: 8, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.4920969009399414
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.6620230674743652
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2620892524719238
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4690923690795898
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.392425537109375
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.6011478900909424
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4227750301361084
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7602128982543945
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7385621070861816
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.4846906661987305
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.5507545471191406
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4676167964935303
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.635331153869629
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.6488375663757324
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.7662060260772705
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.28668212890625
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9046554565429688
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.457282304763794
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.236485481262207
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2545249462127686
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6137335300445557
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0849382877349854
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.736889362335205
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3881776332855225
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 560208
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.716179370880127
Epoch: 1, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.330 Vali Acc: 0.250 Test Loss: 2.330 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.8368163108825684
Epoch: 2, Steps: 7 | Train Loss: 2.293 Vali Loss: 2.174 Vali Acc: 0.389 Test Loss: 2.174 Test Acc: 0.389
Validation loss decreased (-0.249977 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 2.1135289669036865
Epoch: 3, Steps: 7 | Train Loss: 2.032 Vali Loss: 1.876 Vali Acc: 0.556 Test Loss: 1.876 Test Acc: 0.556
Validation loss decreased (-0.388867 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 1.6536693572998047
Epoch: 4, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.536 Vali Acc: 0.736 Test Loss: 1.536 Test Acc: 0.736
Validation loss decreased (-0.555537 --> -0.736096).  Saving model ...
Epoch: 5 cost time: 2.1585323810577393
Epoch: 5, Steps: 7 | Train Loss: 1.260 Vali Loss: 1.097 Vali Acc: 0.806 Test Loss: 1.097 Test Acc: 0.806
Validation loss decreased (-0.736096 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 1.545034646987915
Epoch: 6, Steps: 7 | Train Loss: 0.781 Vali Loss: 0.794 Vali Acc: 0.875 Test Loss: 0.794 Test Acc: 0.875
Validation loss decreased (-0.805545 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 2.087005615234375
Epoch: 7, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 1.5196030139923096
Epoch: 8, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.6671779155731201
Epoch: 9, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.8208794593811035
Epoch: 10, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.825852632522583
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.9200334548950195
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8961610794067383
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2359824180603027
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.841413974761963
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2461917400360107
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.990738868713379
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.7717931270599365
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.8448185920715332
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.6067049503326416
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.7319645881652832
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.8058197498321533
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9287474155426025
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6543185710906982
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3021230697631836
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6001787185668945
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5912673473358154
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.361048698425293
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.451413869857788
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.958524227142334
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7934274673461914
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8689732551574707
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9899373054504395
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5312116146087646
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.483851671218872
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3190186023712158
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6269490718841553
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6228163242340088
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2990210056304932
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 408208
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4758408069610596
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.433 Vali Acc: 0.153 Test Loss: 2.433 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.6444063186645508
Epoch: 2, Steps: 7 | Train Loss: 2.464 Vali Loss: 2.368 Vali Acc: 0.194 Test Loss: 2.368 Test Acc: 0.194
Validation loss decreased (-0.152753 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 1.6587581634521484
Epoch: 3, Steps: 7 | Train Loss: 2.340 Vali Loss: 2.102 Vali Acc: 0.500 Test Loss: 2.102 Test Acc: 0.500
Validation loss decreased (-0.194421 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 1.681868314743042
Epoch: 4, Steps: 7 | Train Loss: 2.028 Vali Loss: 1.858 Vali Acc: 0.472 Test Loss: 1.858 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7569570541381836
Epoch: 5, Steps: 7 | Train Loss: 1.579 Vali Loss: 1.459 Vali Acc: 0.736 Test Loss: 1.459 Test Acc: 0.736
Validation loss decreased (-0.499979 --> -0.736097).  Saving model ...
Epoch: 6 cost time: 1.8830316066741943
Epoch: 6, Steps: 7 | Train Loss: 1.141 Vali Loss: 1.008 Vali Acc: 0.792 Test Loss: 1.008 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791657).  Saving model ...
Epoch: 7 cost time: 1.344864845275879
Epoch: 7, Steps: 7 | Train Loss: 0.614 Vali Loss: 0.703 Vali Acc: 0.889 Test Loss: 0.703 Test Acc: 0.889
Validation loss decreased (-0.791657 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 1.9539902210235596
Epoch: 8, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 1.3370184898376465
Epoch: 9, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9530606269836426
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6668212413787842
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3954882621765137
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.5815212726593018
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.3847622871398926
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.281087875366211
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5249385833740234
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.4512007236480713
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.4842891693115234
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6180336475372314
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4360597133636475
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7434816360473633
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.359879732131958
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1896014213562012
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.269538164138794
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.403634786605835
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.314753532409668
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4205470085144043
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7885382175445557
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.2792747020721436
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.8806464672088623
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.557870864868164
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.300611972808838
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.625617504119873
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.5693423748016357
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.6372597217559814
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.4827961921691895
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.9268367290496826
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.390211582183838
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.809844970703125
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5016300678253174
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.7181506156921387
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.6768138408660889
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.1802973747253418
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.393481969833374
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9055235385894775
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.789531946182251
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.538689136505127
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.8404786586761475
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2056686878204346
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.7573692798614502
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4332616329193115
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.7798566818237305
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.848757266998291
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.7250761985778809
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.6942310333251953
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.8079819679260254
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 1.7989318370819092
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 1.4320166110992432
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 1.1623516082763672
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.354511022567749
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1561377048492432
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.3570218086242676
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.22749662399292
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3458256721496582
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1543664932250977
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.6612846851348877
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 1.654594898223877
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.447159767150879
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.3332715034484863
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.638188123703003
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.8665122985839844
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.3574507236480713
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 1.4876103401184082
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 1.5815966129302979
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 1.7985923290252686
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 1.2816383838653564
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6037712097167969
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 1.282641887664795
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 1.5594673156738281
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.4777941703796387
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 1.4652323722839355
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 82 cost time: 1.7492082118988037
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.9031939506530762
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.886493444442749
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.7678194046020508
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 86 cost time: 1.4531242847442627
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 1.5992209911346436
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 1.7469713687896729
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.6267552375793457
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 1.5484933853149414
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 1.3984084129333496
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 1.3386988639831543
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.5620701313018799
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.5085251331329346
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.5299062728881836
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.3501501083374023
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.2129762172698975
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 1.3766028881072998
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 1.451244831085205
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 1.415182113647461
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 403408
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1310839653015137
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.468 Vali Acc: 0.139 Test Loss: 2.468 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.6443994045257568
Epoch: 2, Steps: 7 | Train Loss: 2.407 Vali Loss: 2.297 Vali Acc: 0.278 Test Loss: 2.297 Test Acc: 0.278
Validation loss decreased (-0.138864 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 1.2266945838928223
Epoch: 3, Steps: 7 | Train Loss: 2.205 Vali Loss: 2.038 Vali Acc: 0.597 Test Loss: 2.038 Test Acc: 0.597
Validation loss decreased (-0.277755 --> -0.597202).  Saving model ...
Epoch: 4 cost time: 1.6570978164672852
Epoch: 4, Steps: 7 | Train Loss: 1.839 Vali Loss: 1.689 Vali Acc: 0.694 Test Loss: 1.689 Test Acc: 0.694
Validation loss decreased (-0.597202 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 1.9704351425170898
Epoch: 5, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.260 Vali Acc: 0.736 Test Loss: 1.260 Test Acc: 0.736
Validation loss decreased (-0.694428 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 1.7945332527160645
Epoch: 6, Steps: 7 | Train Loss: 0.937 Vali Loss: 0.902 Vali Acc: 0.861 Test Loss: 0.902 Test Acc: 0.861
Validation loss decreased (-0.736099 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 1.7107717990875244
Epoch: 7, Steps: 7 | Train Loss: 0.489 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.3755486011505127
Epoch: 8, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.7613048553466797
Epoch: 9, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6305489540100098
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.9425652027130127
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.7780120372772217
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3613495826721191
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.3389613628387451
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.573805332183838
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.779221534729004
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3087959289550781
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7137384414672852
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7451834678649902
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9386732578277588
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.5547688007354736
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.7620563507080078
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.9023499488830566
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.440138578414917
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8179497718811035
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.7429547309875488
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6807472705841064
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.6916794776916504
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.054873466491699
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.2453985214233398
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.892216444015503
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5824272632598877
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.7628414630889893
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5363609790802002
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3429203033447266
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7205018997192383
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.0244853496551514
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.286442756652832
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.8262560367584229
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.743692398071289
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7577400207519531
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6846647262573242
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.771240234375
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.9265892505645752
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.5419318675994873
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.324674367904663
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.8995509147644043
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.1353063583374023
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7347283363342285
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3297796249389648
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.524911880493164
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 1.4859678745269775
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 1.3612396717071533
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4828307628631592
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 55 cost time: 1.493211030960083
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 1.8428633213043213
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 1.4969048500061035
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 58 cost time: 1.8119945526123047
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 1.442859411239624
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.7309000492095947
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.4678282737731934
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.947200059890747
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.5070090293884277
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.537895917892456
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 1.6656715869903564
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 66 cost time: 1.8272416591644287
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 67 cost time: 1.6083827018737793
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 1.7019565105438232
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.4711482524871826
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.8153948783874512
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.9055469036102295
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.058964967727661
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.6515119075775146
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.74495530128479
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.702483892440796
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.3592684268951416
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 1.292943000793457
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 78 cost time: 1.3478357791900635
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 79 cost time: 1.46580171585083
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 80 cost time: 1.4177982807159424
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 1.3536672592163086
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 1.5986697673797607
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 1.7051281929016113
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 1.4830470085144043
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.5925142765045166
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.7135140895843506
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.5364100933074951
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.3571641445159912
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 89 cost time: 1.6490850448608398
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 1.4307951927185059
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.6378014087677002
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 92 cost time: 1.3883872032165527
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 1.2014741897583008
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 94 cost time: 1.584127426147461
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 1.2907288074493408
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 96 cost time: 1.3712341785430908
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 1.203932523727417
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.4593415260314941
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.7133450508117676
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 100 cost time: 1.5559229850769043
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 398608
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.259803295135498
Epoch: 1, Steps: 7 | Train Loss: 2.658 Vali Loss: 2.508 Vali Acc: 0.069 Test Loss: 2.508 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.6174745559692383
Epoch: 2, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.301 Vali Acc: 0.222 Test Loss: 2.301 Test Acc: 0.222
Validation loss decreased (-0.069419 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 1.3424429893493652
Epoch: 3, Steps: 7 | Train Loss: 2.271 Vali Loss: 2.007 Vali Acc: 0.486 Test Loss: 2.007 Test Acc: 0.486
Validation loss decreased (-0.222199 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 1.3749754428863525
Epoch: 4, Steps: 7 | Train Loss: 1.936 Vali Loss: 1.748 Vali Acc: 0.556 Test Loss: 1.748 Test Acc: 0.556
Validation loss decreased (-0.486091 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 1.6374728679656982
Epoch: 5, Steps: 7 | Train Loss: 1.418 Vali Loss: 1.269 Vali Acc: 0.847 Test Loss: 1.269 Test Acc: 0.847
Validation loss decreased (-0.555538 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 1.27522611618042
Epoch: 6, Steps: 7 | Train Loss: 0.906 Vali Loss: 0.845 Vali Acc: 0.903 Test Loss: 0.845 Test Acc: 0.903
Validation loss decreased (-0.847210 --> -0.902769).  Saving model ...
Epoch: 7 cost time: 1.5924901962280273
Epoch: 7, Steps: 7 | Train Loss: 0.497 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.425614356994629
Epoch: 8, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4619684219360352
Epoch: 9, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 1.5553934574127197
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.5602588653564453
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5448665618896484
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.3197708129882812
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.593616008758545
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.415928602218628
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.5298268795013428
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.545687198638916
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4261884689331055
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3484854698181152
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0402045249938965
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5040843486785889
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.297884464263916
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.272829532623291
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3584589958190918
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3513808250427246
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5396342277526855
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6174712181091309
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.3889052867889404
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.587071180343628
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.4988210201263428
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.3785779476165771
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.6947448253631592
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.615494966506958
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.3603277206420898
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.6738591194152832
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.472761631011963
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.5952494144439697
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.5350525379180908
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.6069698333740234
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.5844125747680664
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.6052541732788086
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.4960081577301025
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.329496145248413
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6702547073364258
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4073302745819092
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5549254417419434
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.7212615013122559
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8286545276641846
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 1.5802748203277588
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 1.7707922458648682
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.1953787803649902
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.880896806716919
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.079831600189209
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 54 cost time: 2.0044667720794678
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 55 cost time: 1.6719043254852295
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6065881252288818
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 57 cost time: 1.170515775680542
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 58 cost time: 1.3942327499389648
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 59 cost time: 1.3548643589019775
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 60 cost time: 1.8544423580169678
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 61 cost time: 1.456221103668213
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 62 cost time: 1.293515920639038
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3644218444824219
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.628896713256836
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2039895057678223
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 66 cost time: 1.5512909889221191
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 67 cost time: 1.2172040939331055
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 68 cost time: 1.899782419204712
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 69 cost time: 1.651656150817871
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 70 cost time: 1.489220142364502
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.387160062789917
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.7192246913909912
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.6715474128723145
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.4447689056396484
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.7840521335601807
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.7241129875183105
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.5589957237243652
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.737004041671753
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.3115897178649902
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 393808
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.469195604324341
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.557 Vali Acc: 0.056 Test Loss: 2.557 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 1.6626203060150146
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.363 Vali Acc: 0.236 Test Loss: 2.363 Test Acc: 0.236
Validation loss decreased (-0.055530 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 1.4957365989685059
Epoch: 3, Steps: 7 | Train Loss: 2.182 Vali Loss: 2.040 Vali Acc: 0.514 Test Loss: 2.040 Test Acc: 0.514
Validation loss decreased (-0.236087 --> -0.513868).  Saving model ...
Epoch: 4 cost time: 1.1812348365783691
Epoch: 4, Steps: 7 | Train Loss: 1.828 Vali Loss: 1.707 Vali Acc: 0.653 Test Loss: 1.707 Test Acc: 0.653
Validation loss decreased (-0.513868 --> -0.652761).  Saving model ...
Epoch: 5 cost time: 1.4249932765960693
Epoch: 5, Steps: 7 | Train Loss: 1.348 Vali Loss: 1.292 Vali Acc: 0.750 Test Loss: 1.292 Test Acc: 0.750
Validation loss decreased (-0.652761 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 1.4296925067901611
Epoch: 6, Steps: 7 | Train Loss: 0.904 Vali Loss: 0.965 Vali Acc: 0.764 Test Loss: 0.965 Test Acc: 0.764
Validation loss decreased (-0.749987 --> -0.763879).  Saving model ...
Epoch: 7 cost time: 1.6632440090179443
Epoch: 7, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.656 Vali Acc: 0.847 Test Loss: 0.656 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 1.5284574031829834
Epoch: 8, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 1.3728814125061035
Epoch: 9, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.4232664108276367
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.951040267944336
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.5605621337890625
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.0065038204193115
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7367103099822998
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7182109355926514
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9559056758880615
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.4221584796905518
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.4167909622192383
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.4678857326507568
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.507678508758545
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.7804112434387207
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.0140318870544434
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.5383222103118896
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.661038875579834
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.5502893924713135
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3978395462036133
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.372934103012085
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4487733840942383
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4886000156402588
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4721190929412842
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.3719964027404785
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8103344440460205
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3626303672790527
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.7424209117889404
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.4534215927124023
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.7280840873718262
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.710766315460205
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5197117328643799
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 2.046823740005493
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.766416072845459
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.7650816440582275
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.5480687618255615
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.5672962665557861
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8564436435699463
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.3489313125610352
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.9088873863220215
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.6464128494262695
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.6643171310424805
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 1.5699830055236816
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.5113744735717773
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 1.7778325080871582
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.6423168182373047
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 1.6657445430755615
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.7096166610717773
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.660733938217163
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.6806435585021973
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 1.271369218826294
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2565746307373047
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.7330656051635742
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 1.7653076648712158
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 2.111483573913574
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 1.7170472145080566
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 2.047234535217285
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.8517041206359863
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 1.323725700378418
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.467573642730713
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 1.714317798614502
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 1.7705321311950684
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.5054078102111816
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.5287818908691406
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.9313466548919678
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.6835300922393799
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.6052660942077637
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.565335988998413
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 1.241072654724121
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 1.8368794918060303
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.4381828308105469
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 1.2466819286346436
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 1.386871099472046
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 1.2981338500976562
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 1.69279146194458
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 1.5354070663452148
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 1.345496416091919
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 1.5896337032318115
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 1.573983907699585
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 86 cost time: 1.513916015625
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.9562547206878662
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 88 cost time: 1.7416493892669678
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.658719778060913
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.4874956607818604
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 1.7486183643341064
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.4171538352966309
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 1.4225249290466309
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 1.3766570091247559
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.3820278644561768
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.6352708339691162
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.5431170463562012
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 1.466691017150879
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 99 cost time: 1.9986722469329834
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 1.4994099140167236
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 325008
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7885093688964844
Epoch: 1, Steps: 7 | Train Loss: 2.631 Vali Loss: 2.440 Vali Acc: 0.097 Test Loss: 2.440 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.4362351894378662
Epoch: 2, Steps: 7 | Train Loss: 2.431 Vali Loss: 2.312 Vali Acc: 0.194 Test Loss: 2.312 Test Acc: 0.194
Validation loss decreased (-0.097198 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 1.430027723312378
Epoch: 3, Steps: 7 | Train Loss: 2.121 Vali Loss: 1.938 Vali Acc: 0.625 Test Loss: 1.938 Test Acc: 0.625
Validation loss decreased (-0.194421 --> -0.624981).  Saving model ...
Epoch: 4 cost time: 1.7510077953338623
Epoch: 4, Steps: 7 | Train Loss: 1.712 Vali Loss: 1.580 Vali Acc: 0.736 Test Loss: 1.580 Test Acc: 0.736
Validation loss decreased (-0.624981 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 1.7503302097320557
Epoch: 5, Steps: 7 | Train Loss: 1.285 Vali Loss: 1.227 Vali Acc: 0.861 Test Loss: 1.227 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 1.7411885261535645
Epoch: 6, Steps: 7 | Train Loss: 0.846 Vali Loss: 0.845 Vali Acc: 0.833 Test Loss: 0.845 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0966663360595703
Epoch: 7, Steps: 7 | Train Loss: 0.449 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6473782062530518
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.8781836032867432
Epoch: 9, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.756011724472046
Epoch: 10, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.6429340839385986
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.5295770168304443
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.874021053314209
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.1130905151367188
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.528062105178833
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7585020065307617
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8032803535461426
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.4072840213775635
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.7348709106445312
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.8912558555603027
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.3660283088684082
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9838502407073975
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.7972736358642578
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.0951483249664307
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.9804322719573975
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.8096702098846436
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.236595869064331
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5711352825164795
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7563221454620361
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5967519283294678
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.6017792224884033
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 2.0770819187164307
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.901979684829712
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.1769847869873047
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6004948616027832
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.673891305923462
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.8600983619689941
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 2.017430305480957
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.614654302597046
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.6326770782470703
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.5687766075134277
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7047615051269531
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9344773292541504
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9001126289367676
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5073590278625488
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.800797462463379
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.8970420360565186
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.507042646408081
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.4917941093444824
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.4522480964660645
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4965829849243164
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.470513105392456
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.5794565677642822
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.6102182865142822
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.572962999343872
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.7938261032104492
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.92686128616333
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.9277551174163818
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.3657829761505127
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.8477873802185059
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.065422773361206
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.1156749725341797
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 1.7115168571472168
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 1.9619650840759277
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.8311231136322021
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.6756160259246826
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 1.5871763229370117
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.771371841430664
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.6753919124603271
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.5211448669433594
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.5826032161712646
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.908174991607666
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 2.075457811355591
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 1.6537261009216309
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 1.643012285232544
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 1.4813249111175537
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6507494449615479
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.5378310680389404
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.8742845058441162
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.613426685333252
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.6709611415863037
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.186652898788452
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.4374668598175049
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.5808124542236328
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.3367993831634521
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 320208
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7997772693634033
Epoch: 1, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.396 Vali Acc: 0.083 Test Loss: 2.396 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.2070198059082031
Epoch: 2, Steps: 7 | Train Loss: 2.395 Vali Loss: 2.245 Vali Acc: 0.292 Test Loss: 2.245 Test Acc: 0.292
Validation loss decreased (-0.083309 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 1.3889312744140625
Epoch: 3, Steps: 7 | Train Loss: 2.105 Vali Loss: 1.938 Vali Acc: 0.611 Test Loss: 1.938 Test Acc: 0.611
Validation loss decreased (-0.291644 --> -0.611092).  Saving model ...
Epoch: 4 cost time: 1.2110395431518555
Epoch: 4, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.648 Vali Acc: 0.653 Test Loss: 1.648 Test Acc: 0.653
Validation loss decreased (-0.611092 --> -0.652761).  Saving model ...
Epoch: 5 cost time: 1.5013246536254883
Epoch: 5, Steps: 7 | Train Loss: 1.375 Vali Loss: 1.268 Vali Acc: 0.847 Test Loss: 1.268 Test Acc: 0.847
Validation loss decreased (-0.652761 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 1.220282793045044
Epoch: 6, Steps: 7 | Train Loss: 0.916 Vali Loss: 0.911 Vali Acc: 0.833 Test Loss: 0.911 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.477100133895874
Epoch: 7, Steps: 7 | Train Loss: 0.524 Vali Loss: 0.579 Vali Acc: 0.903 Test Loss: 0.579 Test Acc: 0.903
Validation loss decreased (-0.847210 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 1.2375710010528564
Epoch: 8, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.3567395210266113
Epoch: 9, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5779197216033936
Epoch: 10, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.2128117084503174
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.7248554229736328
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.264695167541504
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5843358039855957
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4744620323181152
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.5625677108764648
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.554997205734253
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.7690680027008057
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.3531897068023682
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.711643934249878
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.5173759460449219
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.7299418449401855
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.297084093093872
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.6410224437713623
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5559260845184326
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.267183780670166
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3398125171661377
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3462069034576416
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2007839679718018
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3740813732147217
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6400246620178223
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.293057918548584
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4535233974456787
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 315408
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.380038022994995
Epoch: 1, Steps: 7 | Train Loss: 2.710 Vali Loss: 2.590 Vali Acc: 0.042 Test Loss: 2.590 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 1.5835297107696533
Epoch: 2, Steps: 7 | Train Loss: 2.536 Vali Loss: 2.426 Vali Acc: 0.139 Test Loss: 2.426 Test Acc: 0.139
Validation loss decreased (-0.041641 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 1.1153793334960938
Epoch: 3, Steps: 7 | Train Loss: 2.331 Vali Loss: 2.156 Vali Acc: 0.375 Test Loss: 2.156 Test Acc: 0.375
Validation loss decreased (-0.138865 --> -0.374978).  Saving model ...
Epoch: 4 cost time: 1.8050391674041748
Epoch: 4, Steps: 7 | Train Loss: 2.025 Vali Loss: 1.916 Vali Acc: 0.528 Test Loss: 1.916 Test Acc: 0.528
Validation loss decreased (-0.374978 --> -0.527759).  Saving model ...
Epoch: 5 cost time: 1.3020215034484863
Epoch: 5, Steps: 7 | Train Loss: 1.592 Vali Loss: 1.496 Vali Acc: 0.833 Test Loss: 1.496 Test Acc: 0.833
Validation loss decreased (-0.527759 --> -0.833318).  Saving model ...
Epoch: 6 cost time: 1.6755845546722412
Epoch: 6, Steps: 7 | Train Loss: 1.122 Vali Loss: 1.075 Vali Acc: 0.875 Test Loss: 1.075 Test Acc: 0.875
Validation loss decreased (-0.833318 --> -0.874989).  Saving model ...
Epoch: 7 cost time: 1.1366503238677979
Epoch: 7, Steps: 7 | Train Loss: 0.692 Vali Loss: 0.780 Vali Acc: 0.861 Test Loss: 0.780 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5378100872039795
Epoch: 8, Steps: 7 | Train Loss: 0.396 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.4184060096740723
Epoch: 9, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 1.3169317245483398
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.472989559173584
Epoch: 11, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.5164682865142822
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3228542804718018
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1711127758026123
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.6091656684875488
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.2931101322174072
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4338204860687256
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.25986909866333
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.492699384689331
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.591667890548706
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.605872631072998
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.5466375350952148
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.6890654563903809
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.2372047901153564
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.6611602306365967
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.719038486480713
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7929329872131348
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5109350681304932
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2872836589813232
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8108553886413574
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.4869730472564697
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5933160781860352
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.185753583908081
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.662341594696045
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.283747673034668
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.6386868953704834
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.9561195373535156
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.5298466682434082
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.6433327198028564
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.4858341217041016
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.5891401767730713
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7386682033538818
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.1158318519592285
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5743966102600098
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.949678659439087
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.3940000534057617
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.7910478115081787
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.5858900547027588
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5254631042480469
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4814589023590088
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4533135890960693
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.6530675888061523
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3604884147644043
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 1.6658735275268555
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 1.7418005466461182
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.2331759929656982
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.411329746246338
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.8177053928375244
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.3867337703704834
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6590802669525146
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 1.3970441818237305
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 1.4823620319366455
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 1.1954457759857178
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 1.505309820175171
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.4537863731384277
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.3705012798309326
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6903715133666992
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.7047970294952393
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7204291820526123
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3868589401245117
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.7012460231781006
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.8162147998809814
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.6252150535583496
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.4955854415893555
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 1.6070764064788818
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 1.7616586685180664
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.7354347705841064
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 1.6744384765625
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.3743469715118408
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.888800859451294
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.5075371265411377
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.5830655097961426
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.9126687049865723
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 84 cost time: 1.6734619140625
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 1.3556849956512451
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 1.424785852432251
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 87 cost time: 1.6590895652770996
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 1.3535151481628418
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.641758918762207
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.6596016883850098
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.7193057537078857
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.9084978103637695
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.63946533203125
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.6092450618743896
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 2.157970666885376
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.598048210144043
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.436906099319458
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 310608
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.60144305229187
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.486 Vali Acc: 0.097 Test Loss: 2.486 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.4024341106414795
Epoch: 2, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.331 Vali Acc: 0.208 Test Loss: 2.331 Test Acc: 0.208
Validation loss decreased (-0.097197 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 1.9089667797088623
Epoch: 3, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.093 Vali Acc: 0.472 Test Loss: 2.093 Test Acc: 0.472
Validation loss decreased (-0.208310 --> -0.472201).  Saving model ...
Epoch: 4 cost time: 1.9471216201782227
Epoch: 4, Steps: 7 | Train Loss: 2.027 Vali Loss: 1.860 Vali Acc: 0.542 Test Loss: 1.860 Test Acc: 0.542
Validation loss decreased (-0.472201 --> -0.541648).  Saving model ...
Epoch: 5 cost time: 1.2919743061065674
Epoch: 5, Steps: 7 | Train Loss: 1.586 Vali Loss: 1.450 Vali Acc: 0.625 Test Loss: 1.450 Test Acc: 0.625
Validation loss decreased (-0.541648 --> -0.624985).  Saving model ...
Epoch: 6 cost time: 1.5627903938293457
Epoch: 6, Steps: 7 | Train Loss: 1.163 Vali Loss: 1.112 Vali Acc: 0.819 Test Loss: 1.112 Test Acc: 0.819
Validation loss decreased (-0.624985 --> -0.819433).  Saving model ...
Epoch: 7 cost time: 1.5764055252075195
Epoch: 7, Steps: 7 | Train Loss: 0.724 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
Validation loss decreased (-0.819433 --> -0.888881).  Saving model ...
Epoch: 8 cost time: 1.3312938213348389
Epoch: 8, Steps: 7 | Train Loss: 0.426 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 1.75439453125
Epoch: 9, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.7642159461975098
Epoch: 10, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.395531415939331
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 1.6640732288360596
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.4626727104187012
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.1703693866729736
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.474233865737915
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.3365609645843506
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.5397751331329346
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.992011308670044
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.4384126663208008
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3193421363830566
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1358978748321533
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3685877323150635
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.405369520187378
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4842560291290283
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.2560365200042725
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.3449103832244873
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5028231143951416
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.3165905475616455
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.379206895828247
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.3668813705444336
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.3597691059112549
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.7603034973144531
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.5479621887207031
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.422879695892334
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.9572887420654297
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.7849397659301758
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.6886446475982666
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.329162359237671
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.5499284267425537
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 1.6095106601715088
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4878735542297363
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4549920558929443
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.2977478504180908
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.3450145721435547
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.696631669998169
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7694871425628662
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.216968059539795
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4176952838897705
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5094850063323975
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.4703030586242676
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3256850242614746
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.311840534210205
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 1.1533117294311523
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 1.5914747714996338
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 1.6485347747802734
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 1.384896993637085
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 1.6877622604370117
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 1.487025499343872
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 1.6294069290161133
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 1.6521224975585938
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 1.551384449005127
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.7880287170410156
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.6881484985351562
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1897521018981934
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.5672760009765625
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 66 cost time: 1.3815867900848389
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 1.4986882209777832
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 68 cost time: 1.3836424350738525
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7616724967956543
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.589184284210205
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 1.48701810836792
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 1.5399956703186035
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 1.4991958141326904
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.6571810245513916
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.4804511070251465
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.643458366394043
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 1.5795631408691406
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.5090367794036865
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.4748926162719727
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.1809310913085938
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.897439956665039
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.9388601779937744
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 2.0147480964660645
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 1.8734819889068604
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 1.925788164138794
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 86 cost time: 1.6355915069580078
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 1.9419095516204834
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.4599664211273193
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.9124820232391357
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.8568782806396484
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 1.499608039855957
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 1.2842607498168945
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 1.693770408630371
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 1.5514194965362549
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 1.2886066436767578
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 96 cost time: 1.5233259201049805
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 97 cost time: 1.6203792095184326
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.715094804763794
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.8746578693389893
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 1.4752693176269531
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 283408
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.2898595333099365
Epoch: 1, Steps: 7 | Train Loss: 2.669 Vali Loss: 2.499 Vali Acc: 0.056 Test Loss: 2.499 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 1.9028902053833008
Epoch: 2, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.360 Vali Acc: 0.167 Test Loss: 2.360 Test Acc: 0.167
Validation loss decreased (-0.055531 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 1.5489075183868408
Epoch: 3, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.218 Vali Acc: 0.417 Test Loss: 2.218 Test Acc: 0.417
Validation loss decreased (-0.166643 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 2.075618267059326
Epoch: 4, Steps: 7 | Train Loss: 2.024 Vali Loss: 1.926 Vali Acc: 0.639 Test Loss: 1.926 Test Acc: 0.639
Validation loss decreased (-0.416644 --> -0.638870).  Saving model ...
Epoch: 5 cost time: 1.625539779663086
Epoch: 5, Steps: 7 | Train Loss: 1.742 Vali Loss: 1.631 Vali Acc: 0.667 Test Loss: 1.631 Test Acc: 0.667
Validation loss decreased (-0.638870 --> -0.666650).  Saving model ...
Epoch: 6 cost time: 1.3912477493286133
Epoch: 6, Steps: 7 | Train Loss: 1.329 Vali Loss: 1.307 Vali Acc: 0.722 Test Loss: 1.307 Test Acc: 0.722
Validation loss decreased (-0.666650 --> -0.722209).  Saving model ...
Epoch: 7 cost time: 1.8293447494506836
Epoch: 7, Steps: 7 | Train Loss: 0.907 Vali Loss: 0.967 Vali Acc: 0.861 Test Loss: 0.967 Test Acc: 0.861
Validation loss decreased (-0.722209 --> -0.861101).  Saving model ...
Epoch: 8 cost time: 1.5629196166992188
Epoch: 8, Steps: 7 | Train Loss: 0.521 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.8426949977874756
Epoch: 9, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 1.2568752765655518
Epoch: 10, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.3626883029937744
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4906768798828125
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.3474624156951904
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9716107845306396
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.765615701675415
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4439687728881836
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.035567283630371
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.050861358642578
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7592089176177979
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8418445587158203
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8221983909606934
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5599212646484375
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 278608
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.451730251312256
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.486 Vali Acc: 0.028 Test Loss: 2.486 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 1.6892797946929932
Epoch: 2, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.433 Vali Acc: 0.167 Test Loss: 2.433 Test Acc: 0.167
Validation loss decreased (-0.027753 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 1.4913899898529053
Epoch: 3, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.239 Vali Acc: 0.389 Test Loss: 2.239 Test Acc: 0.389
Validation loss decreased (-0.166642 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 1.5063834190368652
Epoch: 4, Steps: 7 | Train Loss: 2.147 Vali Loss: 2.053 Vali Acc: 0.361 Test Loss: 2.053 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.397533893585205
Epoch: 5, Steps: 7 | Train Loss: 1.891 Vali Loss: 1.758 Vali Acc: 0.625 Test Loss: 1.758 Test Acc: 0.625
Validation loss decreased (-0.388867 --> -0.624982).  Saving model ...
Epoch: 6 cost time: 1.3805286884307861
Epoch: 6, Steps: 7 | Train Loss: 1.512 Vali Loss: 1.517 Vali Acc: 0.528 Test Loss: 1.517 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3869800567626953
Epoch: 7, Steps: 7 | Train Loss: 1.117 Vali Loss: 1.052 Vali Acc: 0.792 Test Loss: 1.052 Test Acc: 0.792
Validation loss decreased (-0.624982 --> -0.791656).  Saving model ...
Epoch: 8 cost time: 1.4390089511871338
Epoch: 8, Steps: 7 | Train Loss: 0.690 Vali Loss: 0.717 Vali Acc: 0.875 Test Loss: 0.717 Test Acc: 0.875
Validation loss decreased (-0.791656 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.6154332160949707
Epoch: 9, Steps: 7 | Train Loss: 0.341 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3502357006072998
Epoch: 10, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 1.664961814880371
Epoch: 11, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.5649960041046143
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.425567626953125
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.395 Vali Acc: 0.847 Test Loss: 0.395 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2155239582061768
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.2059125900268555
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1180853843688965
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0747768878936768
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.1498684883117676
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.283897876739502
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.230062484741211
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.3423919677734375
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.546074390411377
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.2760753631591797
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5445225238800049
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3790669441223145
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3014812469482422
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6351659297943115
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5733749866485596
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.6630709171295166
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.4104974269866943
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.6959476470947266
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.4364831447601318
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.4069411754608154
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.7083497047424316
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.4054181575775146
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.251236915588379
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1672422885894775
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.345646619796753
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.2727906703948975
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.437302827835083
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.6542177200317383
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.296973705291748
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.3823082447052002
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3040616512298584
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.577108383178711
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.1270692348480225
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.6230344772338867
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.333113193511963
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.3089044094085693
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.378004789352417
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.3265221118927002
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 1.5702030658721924
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.4653749465942383
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6529622077941895
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.7951631546020508
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.5018665790557861
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.450467824935913
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.6808581352233887
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.5069873332977295
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.768601894378662
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.4181509017944336
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.4120280742645264
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1230478286743164
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.5270655155181885
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.2899456024169922
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.2070503234863281
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.3919155597686768
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.119154453277588
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.3334741592407227
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 273808
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.199920654296875
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.460 Vali Acc: 0.125 Test Loss: 2.460 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.4258172512054443
Epoch: 2, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.314 Vali Acc: 0.208 Test Loss: 2.314 Test Acc: 0.208
Validation loss decreased (-0.124975 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 1.2162394523620605
Epoch: 3, Steps: 7 | Train Loss: 2.210 Vali Loss: 2.067 Vali Acc: 0.528 Test Loss: 2.067 Test Acc: 0.528
Validation loss decreased (-0.208310 --> -0.527757).  Saving model ...
Epoch: 4 cost time: 1.5261237621307373
Epoch: 4, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.796 Vali Acc: 0.694 Test Loss: 1.796 Test Acc: 0.694
Validation loss decreased (-0.527757 --> -0.694426).  Saving model ...
Epoch: 5 cost time: 1.2770342826843262
Epoch: 5, Steps: 7 | Train Loss: 1.539 Vali Loss: 1.485 Vali Acc: 0.722 Test Loss: 1.485 Test Acc: 0.722
Validation loss decreased (-0.694426 --> -0.722207).  Saving model ...
Epoch: 6 cost time: 1.298182725906372
Epoch: 6, Steps: 7 | Train Loss: 1.167 Vali Loss: 1.077 Vali Acc: 0.806 Test Loss: 1.077 Test Acc: 0.806
Validation loss decreased (-0.722207 --> -0.805545).  Saving model ...
Epoch: 7 cost time: 1.3486995697021484
Epoch: 7, Steps: 7 | Train Loss: 0.730 Vali Loss: 0.866 Vali Acc: 0.806 Test Loss: 0.866 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805547).  Saving model ...
Epoch: 8 cost time: 1.4954936504364014
Epoch: 8, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.5248913764953613
Epoch: 9, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1088042259216309
Epoch: 10, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.400012493133545
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6116480827331543
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 1.6199352741241455
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.288621187210083
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.4747707843780518
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.0237655639648438
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.4388608932495117
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.235107183456421
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4062623977661133
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.522362232208252
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.384613037109375
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5538551807403564
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1575660705566406
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3822414875030518
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7703335285186768
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1410746574401855
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 269008
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4872989654541016
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.994 Vali Acc: 0.139 Test Loss: 2.994 Test Acc: 0.139
Validation loss decreased (inf --> -0.138859).  Saving model ...
Epoch: 2 cost time: 1.5219624042510986
Epoch: 2, Steps: 7 | Train Loss: 2.200 Vali Loss: 1.562 Vali Acc: 0.528 Test Loss: 1.562 Test Acc: 0.528
Validation loss decreased (-0.138859 --> -0.527762).  Saving model ...
Epoch: 3 cost time: 1.5280358791351318
Epoch: 3, Steps: 7 | Train Loss: 0.616 Vali Loss: 0.618 Vali Acc: 0.778 Test Loss: 0.618 Test Acc: 0.778
Validation loss decreased (-0.527762 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 1.3880176544189453
Epoch: 4, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6738829612731934
Epoch: 5, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805549).  Saving model ...
Epoch: 6 cost time: 1.8045752048492432
Epoch: 6, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.791 Vali Acc: 0.764 Test Loss: 0.791 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4884910583496094
Epoch: 7, Steps: 7 | Train Loss: 0.126 Vali Loss: 1.067 Vali Acc: 0.806 Test Loss: 1.067 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9068553447723389
Epoch: 8, Steps: 7 | Train Loss: 0.088 Vali Loss: 1.749 Vali Acc: 0.750 Test Loss: 1.749 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4256436824798584
Epoch: 9, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.805549 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 1.385915756225586
Epoch: 10, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.478 Vali Acc: 0.833 Test Loss: 1.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2297346591949463
Epoch: 11, Steps: 7 | Train Loss: 0.156 Vali Loss: 2.252 Vali Acc: 0.819 Test Loss: 2.252 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8289151191711426
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.847 Test Loss: 1.591 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8857295513153076
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 1.111 Vali Acc: 0.861 Test Loss: 1.111 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861100).  Saving model ...
Epoch: 14 cost time: 1.7924644947052002
Epoch: 14, Steps: 7 | Train Loss: 0.036 Vali Loss: 1.116 Vali Acc: 0.875 Test Loss: 1.116 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874989).  Saving model ...
Epoch: 15 cost time: 1.6539747714996338
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.043 Vali Acc: 0.792 Test Loss: 2.043 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8250706195831299
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 4.079 Vali Acc: 0.694 Test Loss: 4.079 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3989753723144531
Epoch: 17, Steps: 7 | Train Loss: 0.062 Vali Loss: 2.529 Vali Acc: 0.833 Test Loss: 2.529 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5039608478546143
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.819 Test Loss: 2.297 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5034167766571045
Epoch: 19, Steps: 7 | Train Loss: 0.035 Vali Loss: 3.514 Vali Acc: 0.819 Test Loss: 3.514 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7386727333068848
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 2.936 Vali Acc: 0.833 Test Loss: 2.936 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5363657474517822
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.163 Vali Acc: 0.861 Test Loss: 1.163 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6628451347351074
Epoch: 22, Steps: 7 | Train Loss: 0.312 Vali Loss: 1.430 Vali Acc: 0.861 Test Loss: 1.430 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6850316524505615
Epoch: 23, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.943 Vali Acc: 0.819 Test Loss: 1.943 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.664964199066162
Epoch: 24, Steps: 7 | Train Loss: 0.104 Vali Loss: 1.894 Vali Acc: 0.861 Test Loss: 1.894 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 6852644
model size : 31.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3669958114624023
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.578 Vali Acc: 0.097 Test Loss: 2.578 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 1.9851288795471191
Epoch: 2, Steps: 7 | Train Loss: 2.274 Vali Loss: 1.549 Vali Acc: 0.458 Test Loss: 1.549 Test Acc: 0.458
Validation loss decreased (-0.097196 --> -0.458318).  Saving model ...
Epoch: 3 cost time: 1.917661428451538
Epoch: 3, Steps: 7 | Train Loss: 0.744 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.458318 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 1.628321647644043
Epoch: 4, Steps: 7 | Train Loss: 0.482 Vali Loss: 2.701 Vali Acc: 0.597 Test Loss: 2.701 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7211871147155762
Epoch: 5, Steps: 7 | Train Loss: 0.573 Vali Loss: 2.381 Vali Acc: 0.708 Test Loss: 2.381 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5479686260223389
Epoch: 6, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.073 Vali Acc: 0.819 Test Loss: 1.073 Test Acc: 0.819
Validation loss decreased (-0.722214 --> -0.819434).  Saving model ...
Epoch: 7 cost time: 1.4698493480682373
Epoch: 7, Steps: 7 | Train Loss: 0.389 Vali Loss: 1.596 Vali Acc: 0.833 Test Loss: 1.596 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833317).  Saving model ...
Epoch: 8 cost time: 1.4877443313598633
Epoch: 8, Steps: 7 | Train Loss: 0.172 Vali Loss: 1.761 Vali Acc: 0.750 Test Loss: 1.761 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5361628532409668
Epoch: 9, Steps: 7 | Train Loss: 0.104 Vali Loss: 1.558 Vali Acc: 0.861 Test Loss: 1.558 Test Acc: 0.861
Validation loss decreased (-0.833317 --> -0.861096).  Saving model ...
Epoch: 10 cost time: 1.538839340209961
Epoch: 10, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.630 Vali Acc: 0.847 Test Loss: 1.630 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5669560432434082
Epoch: 11, Steps: 7 | Train Loss: 0.382 Vali Loss: 0.776 Vali Acc: 0.917 Test Loss: 0.776 Test Acc: 0.917
Validation loss decreased (-0.861096 --> -0.916659).  Saving model ...
Epoch: 12 cost time: 1.8630783557891846
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.229 Vali Acc: 0.889 Test Loss: 1.229 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4806773662567139
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.570 Vali Acc: 0.875 Test Loss: 1.570 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5476274490356445
Epoch: 14, Steps: 7 | Train Loss: 0.084 Vali Loss: 1.072 Vali Acc: 0.903 Test Loss: 1.072 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.719224452972412
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.159 Vali Acc: 0.847 Test Loss: 2.159 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5302157402038574
Epoch: 16, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.800 Vali Acc: 0.875 Test Loss: 1.800 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7457399368286133
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.861 Test Loss: 1.709 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8713698387145996
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.847 Test Loss: 1.833 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.637737512588501
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.847 Test Loss: 1.985 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5386040210723877
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.073 Vali Acc: 0.833 Test Loss: 2.073 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1249775886535645
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.833 Test Loss: 2.120 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 6827044
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.449373483657837
Epoch: 1, Steps: 7 | Train Loss: 2.650 Vali Loss: 2.520 Vali Acc: 0.264 Test Loss: 2.520 Test Acc: 0.264
Validation loss decreased (inf --> -0.263864).  Saving model ...
Epoch: 2 cost time: 1.599806785583496
Epoch: 2, Steps: 7 | Train Loss: 2.052 Vali Loss: 2.232 Vali Acc: 0.319 Test Loss: 2.232 Test Acc: 0.319
Validation loss decreased (-0.263864 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 1.6007435321807861
Epoch: 3, Steps: 7 | Train Loss: 0.968 Vali Loss: 1.145 Vali Acc: 0.667 Test Loss: 1.145 Test Acc: 0.667
Validation loss decreased (-0.319422 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 1.8314361572265625
Epoch: 4, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.890 Vali Acc: 0.792 Test Loss: 0.890 Test Acc: 0.792
Validation loss decreased (-0.666655 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.5354557037353516
Epoch: 5, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.857 Vali Acc: 0.764 Test Loss: 0.857 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4840126037597656
Epoch: 6, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
Validation loss decreased (-0.791658 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 1.5694708824157715
Epoch: 7, Steps: 7 | Train Loss: 0.088 Vali Loss: 1.413 Vali Acc: 0.778 Test Loss: 1.413 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4879744052886963
Epoch: 8, Steps: 7 | Train Loss: 0.172 Vali Loss: 1.095 Vali Acc: 0.889 Test Loss: 1.095 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888878).  Saving model ...
Epoch: 9 cost time: 1.3887343406677246
Epoch: 9, Steps: 7 | Train Loss: 0.064 Vali Loss: 1.193 Vali Acc: 0.903 Test Loss: 1.193 Test Acc: 0.903
Validation loss decreased (-0.888878 --> -0.902766).  Saving model ...
Epoch: 10 cost time: 1.3069381713867188
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6476709842681885
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.564 Vali Acc: 0.792 Test Loss: 1.564 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6755876541137695
Epoch: 12, Steps: 7 | Train Loss: 0.186 Vali Loss: 1.532 Vali Acc: 0.806 Test Loss: 1.532 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.348921775817871
Epoch: 13, Steps: 7 | Train Loss: 0.457 Vali Loss: 3.668 Vali Acc: 0.667 Test Loss: 3.668 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5153064727783203
Epoch: 14, Steps: 7 | Train Loss: 0.298 Vali Loss: 1.295 Vali Acc: 0.847 Test Loss: 1.295 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.372147798538208
Epoch: 15, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.850 Vali Acc: 0.889 Test Loss: 0.850 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7501304149627686
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.617 Vali Acc: 0.847 Test Loss: 1.617 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4432175159454346
Epoch: 17, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.738 Vali Acc: 0.819 Test Loss: 1.738 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.537583827972412
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.911 Vali Acc: 0.764 Test Loss: 1.911 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1859660148620605
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.290 Vali Acc: 0.792 Test Loss: 2.290 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 6801444
model size : 30.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0698328018188477
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.408 Vali Acc: 0.139 Test Loss: 2.408 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.1565191745758057
Epoch: 2, Steps: 7 | Train Loss: 2.017 Vali Loss: 2.103 Vali Acc: 0.292 Test Loss: 2.103 Test Acc: 0.292
Validation loss decreased (-0.138865 --> -0.291646).  Saving model ...
Epoch: 3 cost time: 1.1616475582122803
Epoch: 3, Steps: 7 | Train Loss: 1.010 Vali Loss: 1.176 Vali Acc: 0.639 Test Loss: 1.176 Test Acc: 0.639
Validation loss decreased (-0.291646 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 1.2428629398345947
Epoch: 4, Steps: 7 | Train Loss: 0.579 Vali Loss: 0.876 Vali Acc: 0.792 Test Loss: 0.876 Test Acc: 0.792
Validation loss decreased (-0.638877 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.2689886093139648
Epoch: 5, Steps: 7 | Train Loss: 0.171 Vali Loss: 1.202 Vali Acc: 0.806 Test Loss: 1.202 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805544).  Saving model ...
Epoch: 6 cost time: 1.371140956878662
Epoch: 6, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.685 Vali Acc: 0.819 Test Loss: 0.685 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 1.1319241523742676
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 1.125 Vali Acc: 0.819 Test Loss: 1.125 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6290593147277832
Epoch: 8, Steps: 7 | Train Loss: 0.441 Vali Loss: 1.863 Vali Acc: 0.778 Test Loss: 1.863 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6007261276245117
Epoch: 9, Steps: 7 | Train Loss: 0.220 Vali Loss: 1.524 Vali Acc: 0.792 Test Loss: 1.524 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5971882343292236
Epoch: 10, Steps: 7 | Train Loss: 0.115 Vali Loss: 1.809 Vali Acc: 0.750 Test Loss: 1.809 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6485848426818848
Epoch: 11, Steps: 7 | Train Loss: 0.112 Vali Loss: 1.492 Vali Acc: 0.875 Test Loss: 1.492 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874985).  Saving model ...
Epoch: 12 cost time: 1.6621918678283691
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.833 Test Loss: 1.231 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5989108085632324
Epoch: 13, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.791 Vali Acc: 0.903 Test Loss: 0.791 Test Acc: 0.903
Validation loss decreased (-0.874985 --> -0.902770).  Saving model ...
Epoch: 14 cost time: 1.3097872734069824
Epoch: 14, Steps: 7 | Train Loss: 0.181 Vali Loss: 1.830 Vali Acc: 0.833 Test Loss: 1.830 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.492952823638916
Epoch: 15, Steps: 7 | Train Loss: 0.232 Vali Loss: 1.992 Vali Acc: 0.889 Test Loss: 1.992 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3125500679016113
Epoch: 16, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.959 Vali Acc: 0.889 Test Loss: 0.959 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6058688163757324
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.903 Test Loss: 0.791 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.476292371749878
Epoch: 18, Steps: 7 | Train Loss: 0.078 Vali Loss: 1.212 Vali Acc: 0.847 Test Loss: 1.212 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4666666984558105
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.847 Test Loss: 1.345 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6403298377990723
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.819 Test Loss: 1.460 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5239176750183105
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.833 Test Loss: 1.395 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.521578073501587
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.847 Test Loss: 1.408 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4906096458435059
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.847 Test Loss: 1.436 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 6775844
model size : 30.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5392324924468994
Epoch: 1, Steps: 7 | Train Loss: 2.727 Vali Loss: 2.808 Vali Acc: 0.167 Test Loss: 2.808 Test Acc: 0.167
Validation loss decreased (inf --> -0.166639).  Saving model ...
Epoch: 2 cost time: 1.669539213180542
Epoch: 2, Steps: 7 | Train Loss: 1.824 Vali Loss: 1.774 Vali Acc: 0.472 Test Loss: 1.774 Test Acc: 0.472
Validation loss decreased (-0.166639 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 1.6484034061431885
Epoch: 3, Steps: 7 | Train Loss: 0.954 Vali Loss: 1.392 Vali Acc: 0.542 Test Loss: 1.392 Test Acc: 0.542
Validation loss decreased (-0.472204 --> -0.541653).  Saving model ...
Epoch: 4 cost time: 1.173384189605713
Epoch: 4, Steps: 7 | Train Loss: 0.672 Vali Loss: 1.212 Vali Acc: 0.764 Test Loss: 1.212 Test Acc: 0.764
Validation loss decreased (-0.541653 --> -0.763877).  Saving model ...
Epoch: 5 cost time: 1.6376066207885742
Epoch: 5, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.763877 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.6950266361236572
Epoch: 6, Steps: 7 | Train Loss: 0.153 Vali Loss: 2.713 Vali Acc: 0.639 Test Loss: 2.713 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6149044036865234
Epoch: 7, Steps: 7 | Train Loss: 0.114 Vali Loss: 1.125 Vali Acc: 0.764 Test Loss: 1.125 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.178877592086792
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.755 Vali Acc: 0.847 Test Loss: 0.755 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4439020156860352
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.117 Vali Acc: 0.847 Test Loss: 1.117 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4055137634277344
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 2.755 Vali Acc: 0.750 Test Loss: 2.755 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3729660511016846
Epoch: 11, Steps: 7 | Train Loss: 0.137 Vali Loss: 1.201 Vali Acc: 0.889 Test Loss: 1.201 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5631873607635498
Epoch: 12, Steps: 7 | Train Loss: 0.293 Vali Loss: 1.589 Vali Acc: 0.792 Test Loss: 1.589 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.283109426498413
Epoch: 13, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.336 Vali Acc: 0.847 Test Loss: 1.336 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2496180534362793
Epoch: 14, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.744 Vali Acc: 0.819 Test Loss: 1.744 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.287621021270752
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.861 Test Loss: 1.718 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 6064676
model size : 28.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.726997137069702
Epoch: 1, Steps: 7 | Train Loss: 2.665 Vali Loss: 2.662 Vali Acc: 0.236 Test Loss: 2.662 Test Acc: 0.236
Validation loss decreased (inf --> -0.236084).  Saving model ...
Epoch: 2 cost time: 1.2962331771850586
Epoch: 2, Steps: 7 | Train Loss: 1.853 Vali Loss: 1.916 Vali Acc: 0.403 Test Loss: 1.916 Test Acc: 0.403
Validation loss decreased (-0.236084 --> -0.402759).  Saving model ...
Epoch: 3 cost time: 1.3856408596038818
Epoch: 3, Steps: 7 | Train Loss: 0.683 Vali Loss: 1.111 Vali Acc: 0.681 Test Loss: 1.111 Test Acc: 0.681
Validation loss decreased (-0.402759 --> -0.680544).  Saving model ...
Epoch: 4 cost time: 1.5162129402160645
Epoch: 4, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.680544 --> -0.819439).  Saving model ...
Epoch: 5 cost time: 1.4632720947265625
Epoch: 5, Steps: 7 | Train Loss: 0.197 Vali Loss: 1.156 Vali Acc: 0.764 Test Loss: 1.156 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.580955982208252
Epoch: 6, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4004371166229248
Epoch: 7, Steps: 7 | Train Loss: 0.340 Vali Loss: 1.231 Vali Acc: 0.806 Test Loss: 1.231 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5725204944610596
Epoch: 8, Steps: 7 | Train Loss: 0.163 Vali Loss: 1.895 Vali Acc: 0.708 Test Loss: 1.895 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2345688343048096
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 1.059 Vali Acc: 0.861 Test Loss: 1.059 Test Acc: 0.861
Validation loss decreased (-0.819439 --> -0.861101).  Saving model ...
Epoch: 10 cost time: 1.4911220073699951
Epoch: 10, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.506 Vali Acc: 0.917 Test Loss: 0.506 Test Acc: 0.917
Validation loss decreased (-0.861101 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 1.1487200260162354
Epoch: 11, Steps: 7 | Train Loss: 0.054 Vali Loss: 1.782 Vali Acc: 0.861 Test Loss: 1.782 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5282244682312012
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.668 Vali Acc: 0.861 Test Loss: 1.668 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2830746173858643
Epoch: 13, Steps: 7 | Train Loss: 0.046 Vali Loss: 1.172 Vali Acc: 0.875 Test Loss: 1.172 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6505985260009766
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 2.507 Vali Acc: 0.806 Test Loss: 2.507 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.507676601409912
Epoch: 15, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.935 Vali Acc: 0.889 Test Loss: 0.935 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5270822048187256
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.033 Vali Acc: 0.833 Test Loss: 3.033 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.33174729347229
Epoch: 17, Steps: 7 | Train Loss: 0.889 Vali Loss: 0.589 Vali Acc: 0.917 Test Loss: 0.589 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6403937339782715
Epoch: 18, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.296 Vali Acc: 0.861 Test Loss: 1.296 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6346771717071533
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.479 Vali Acc: 0.958 Test Loss: 0.479 Test Acc: 0.958
Validation loss decreased (-0.916662 --> -0.958329).  Saving model ...
Epoch: 20 cost time: 1.3690226078033447
Epoch: 20, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.850 Vali Acc: 0.833 Test Loss: 0.850 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6910076141357422
Epoch: 21, Steps: 7 | Train Loss: 0.108 Vali Loss: 1.559 Vali Acc: 0.819 Test Loss: 1.559 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6333129405975342
Epoch: 22, Steps: 7 | Train Loss: 0.090 Vali Loss: 4.830 Vali Acc: 0.750 Test Loss: 4.830 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3401825428009033
Epoch: 23, Steps: 7 | Train Loss: 0.047 Vali Loss: 4.135 Vali Acc: 0.764 Test Loss: 4.135 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5522632598876953
Epoch: 24, Steps: 7 | Train Loss: 0.082 Vali Loss: 3.713 Vali Acc: 0.806 Test Loss: 3.713 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.17319917678833
Epoch: 25, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.673 Vali Acc: 0.833 Test Loss: 1.673 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4085719585418701
Epoch: 26, Steps: 7 | Train Loss: 0.069 Vali Loss: 3.123 Vali Acc: 0.806 Test Loss: 3.123 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3565518856048584
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.733 Vali Acc: 0.764 Test Loss: 4.733 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7314538955688477
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 3.519 Vali Acc: 0.750 Test Loss: 3.519 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6866791248321533
Epoch: 29, Steps: 7 | Train Loss: 0.330 Vali Loss: 3.496 Vali Acc: 0.736 Test Loss: 3.496 Test Acc: 0.736
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 6039076
model size : 27.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8251681327819824
Epoch: 1, Steps: 7 | Train Loss: 2.704 Vali Loss: 2.280 Vali Acc: 0.347 Test Loss: 2.280 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 1.443030595779419
Epoch: 2, Steps: 7 | Train Loss: 1.993 Vali Loss: 2.017 Vali Acc: 0.542 Test Loss: 2.017 Test Acc: 0.542
Validation loss decreased (-0.347199 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 1.3229072093963623
Epoch: 3, Steps: 7 | Train Loss: 1.231 Vali Loss: 1.184 Vali Acc: 0.708 Test Loss: 1.184 Test Acc: 0.708
Validation loss decreased (-0.541646 --> -0.708321).  Saving model ...
Epoch: 4 cost time: 1.6917004585266113
Epoch: 4, Steps: 7 | Train Loss: 0.431 Vali Loss: 0.886 Vali Acc: 0.778 Test Loss: 0.886 Test Acc: 0.778
Validation loss decreased (-0.708321 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 1.3987667560577393
Epoch: 5, Steps: 7 | Train Loss: 0.106 Vali Loss: 1.095 Vali Acc: 0.819 Test Loss: 1.095 Test Acc: 0.819
Validation loss decreased (-0.777769 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 1.3832204341888428
Epoch: 6, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5778436660766602
Epoch: 7, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
Validation loss decreased (-0.819433 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 1.4985740184783936
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 1.352 Vali Acc: 0.792 Test Loss: 1.352 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4596869945526123
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 1.147 Vali Acc: 0.819 Test Loss: 1.147 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4827773571014404
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 2.129 Vali Acc: 0.792 Test Loss: 2.129 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.264439344406128
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.71779203414917
Epoch: 12, Steps: 7 | Train Loss: 0.054 Vali Loss: 1.664 Vali Acc: 0.875 Test Loss: 1.664 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874983).  Saving model ...
Epoch: 13 cost time: 1.7161962985992432
Epoch: 13, Steps: 7 | Train Loss: 0.382 Vali Loss: 1.172 Vali Acc: 0.861 Test Loss: 1.172 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0370137691497803
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.857 Vali Acc: 0.819 Test Loss: 0.857 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4558851718902588
Epoch: 15, Steps: 7 | Train Loss: 0.126 Vali Loss: 2.748 Vali Acc: 0.819 Test Loss: 2.748 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7862491607666016
Epoch: 16, Steps: 7 | Train Loss: 0.054 Vali Loss: 3.030 Vali Acc: 0.792 Test Loss: 3.030 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7645800113677979
Epoch: 17, Steps: 7 | Train Loss: 0.054 Vali Loss: 2.788 Vali Acc: 0.861 Test Loss: 2.788 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8065509796142578
Epoch: 18, Steps: 7 | Train Loss: 0.063 Vali Loss: 2.505 Vali Acc: 0.833 Test Loss: 2.505 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.650766372680664
Epoch: 19, Steps: 7 | Train Loss: 0.117 Vali Loss: 3.479 Vali Acc: 0.861 Test Loss: 3.479 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6625440120697021
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.861 Test Loss: 4.149 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3379004001617432
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.874 Vali Acc: 0.819 Test Loss: 4.874 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0646378993988037
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.026 Vali Acc: 0.819 Test Loss: 5.026 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 6013476
model size : 27.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.966576099395752
Epoch: 1, Steps: 7 | Train Loss: 2.680 Vali Loss: 2.309 Vali Acc: 0.292 Test Loss: 2.309 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 1.393394947052002
Epoch: 2, Steps: 7 | Train Loss: 1.960 Vali Loss: 1.271 Vali Acc: 0.694 Test Loss: 1.271 Test Acc: 0.694
Validation loss decreased (-0.291644 --> -0.694432).  Saving model ...
Epoch: 3 cost time: 1.2979435920715332
Epoch: 3, Steps: 7 | Train Loss: 0.859 Vali Loss: 1.276 Vali Acc: 0.611 Test Loss: 1.276 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4259486198425293
Epoch: 4, Steps: 7 | Train Loss: 0.304 Vali Loss: 1.016 Vali Acc: 0.639 Test Loss: 1.016 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3242518901824951
Epoch: 5, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
Validation loss decreased (-0.694432 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 1.5844500064849854
Epoch: 6, Steps: 7 | Train Loss: 0.257 Vali Loss: 1.089 Vali Acc: 0.847 Test Loss: 1.089 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7888762950897217
Epoch: 7, Steps: 7 | Train Loss: 0.132 Vali Loss: 1.022 Vali Acc: 0.792 Test Loss: 1.022 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.404214859008789
Epoch: 8, Steps: 7 | Train Loss: 0.062 Vali Loss: 1.441 Vali Acc: 0.819 Test Loss: 1.441 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4469573497772217
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.141 Vali Acc: 0.764 Test Loss: 2.141 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3499255180358887
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.312 Vali Acc: 0.819 Test Loss: 1.312 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3763320446014404
Epoch: 11, Steps: 7 | Train Loss: 0.094 Vali Loss: 1.191 Vali Acc: 0.861 Test Loss: 1.191 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4618399143218994
Epoch: 12, Steps: 7 | Train Loss: 0.067 Vali Loss: 1.277 Vali Acc: 0.875 Test Loss: 1.277 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874987).  Saving model ...
Epoch: 13 cost time: 1.1834986209869385
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.432 Vali Acc: 0.819 Test Loss: 2.432 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2880637645721436
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.833 Test Loss: 1.131 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.651118278503418
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 2.190 Vali Acc: 0.847 Test Loss: 2.190 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3299055099487305
Epoch: 16, Steps: 7 | Train Loss: 0.949 Vali Loss: 2.808 Vali Acc: 0.833 Test Loss: 2.808 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3259096145629883
Epoch: 17, Steps: 7 | Train Loss: 0.218 Vali Loss: 4.813 Vali Acc: 0.750 Test Loss: 4.813 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6763746738433838
Epoch: 18, Steps: 7 | Train Loss: 0.429 Vali Loss: 2.192 Vali Acc: 0.847 Test Loss: 2.192 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.628849983215332
Epoch: 19, Steps: 7 | Train Loss: 0.281 Vali Loss: 2.545 Vali Acc: 0.833 Test Loss: 2.545 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.56693434715271
Epoch: 20, Steps: 7 | Train Loss: 0.133 Vali Loss: 2.416 Vali Acc: 0.861 Test Loss: 2.416 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6543936729431152
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 6.860 Vali Acc: 0.764 Test Loss: 6.860 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.532515048980713
Epoch: 22, Steps: 7 | Train Loss: 0.043 Vali Loss: 3.434 Vali Acc: 0.833 Test Loss: 3.434 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 5987876
model size : 27.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.637691020965576
Epoch: 1, Steps: 7 | Train Loss: 2.656 Vali Loss: 2.872 Vali Acc: 0.167 Test Loss: 2.872 Test Acc: 0.167
Validation loss decreased (inf --> -0.166638).  Saving model ...
Epoch: 2 cost time: 1.662217140197754
Epoch: 2, Steps: 7 | Train Loss: 2.220 Vali Loss: 1.403 Vali Acc: 0.514 Test Loss: 1.403 Test Acc: 0.514
Validation loss decreased (-0.166638 --> -0.513875).  Saving model ...
Epoch: 3 cost time: 1.5812430381774902
Epoch: 3, Steps: 7 | Train Loss: 0.972 Vali Loss: 0.817 Vali Acc: 0.764 Test Loss: 0.817 Test Acc: 0.764
Validation loss decreased (-0.513875 --> -0.763881).  Saving model ...
Epoch: 4 cost time: 1.8386871814727783
Epoch: 4, Steps: 7 | Train Loss: 0.246 Vali Loss: 1.295 Vali Acc: 0.569 Test Loss: 1.295 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.869354009628296
Epoch: 5, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
Validation loss decreased (-0.763881 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.6941428184509277
Epoch: 6, Steps: 7 | Train Loss: 0.162 Vali Loss: 1.766 Vali Acc: 0.750 Test Loss: 1.766 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5024802684783936
Epoch: 7, Steps: 7 | Train Loss: 0.307 Vali Loss: 1.520 Vali Acc: 0.681 Test Loss: 1.520 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5450913906097412
Epoch: 8, Steps: 7 | Train Loss: 0.154 Vali Loss: 2.195 Vali Acc: 0.708 Test Loss: 2.195 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7579727172851562
Epoch: 9, Steps: 7 | Train Loss: 0.274 Vali Loss: 1.398 Vali Acc: 0.875 Test Loss: 1.398 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874986).  Saving model ...
Epoch: 10 cost time: 1.2651922702789307
Epoch: 10, Steps: 7 | Train Loss: 0.231 Vali Loss: 1.808 Vali Acc: 0.861 Test Loss: 1.808 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3720407485961914
Epoch: 11, Steps: 7 | Train Loss: 0.228 Vali Loss: 3.446 Vali Acc: 0.833 Test Loss: 3.446 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.328141450881958
Epoch: 12, Steps: 7 | Train Loss: 0.583 Vali Loss: 1.151 Vali Acc: 0.847 Test Loss: 1.151 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3466358184814453
Epoch: 13, Steps: 7 | Train Loss: 0.200 Vali Loss: 1.663 Vali Acc: 0.847 Test Loss: 1.663 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2500286102294922
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.253 Vali Acc: 0.847 Test Loss: 1.253 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2567319869995117
Epoch: 15, Steps: 7 | Train Loss: 0.126 Vali Loss: 1.428 Vali Acc: 0.819 Test Loss: 1.428 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4481000900268555
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.861 Test Loss: 1.862 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6353015899658203
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.875 Test Loss: 1.584 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6516942977905273
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.847 Test Loss: 1.975 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.363610029220581
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.847 Test Loss: 2.265 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 5670692
model size : 26.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9460458755493164
Epoch: 1, Steps: 7 | Train Loss: 2.669 Vali Loss: 2.546 Vali Acc: 0.139 Test Loss: 2.546 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.483459234237671
Epoch: 2, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.415 Vali Acc: 0.528 Test Loss: 1.415 Test Acc: 0.528
Validation loss decreased (-0.138863 --> -0.527764).  Saving model ...
Epoch: 3 cost time: 1.4871525764465332
Epoch: 3, Steps: 7 | Train Loss: 0.868 Vali Loss: 0.782 Vali Acc: 0.764 Test Loss: 0.782 Test Acc: 0.764
Validation loss decreased (-0.527764 --> -0.763881).  Saving model ...
Epoch: 4 cost time: 1.5489931106567383
Epoch: 4, Steps: 7 | Train Loss: 0.242 Vali Loss: 0.853 Vali Acc: 0.764 Test Loss: 0.853 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4141943454742432
Epoch: 5, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.799 Vali Acc: 0.819 Test Loss: 0.799 Test Acc: 0.819
Validation loss decreased (-0.763881 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 1.2642371654510498
Epoch: 6, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.222 Vali Acc: 0.736 Test Loss: 1.222 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1769373416900635
Epoch: 7, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.229 Vali Acc: 0.778 Test Loss: 1.229 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4161674976348877
Epoch: 8, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847216).  Saving model ...
Epoch: 9 cost time: 1.4541125297546387
Epoch: 9, Steps: 7 | Train Loss: 0.158 Vali Loss: 1.210 Vali Acc: 0.806 Test Loss: 1.210 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3559253215789795
Epoch: 10, Steps: 7 | Train Loss: 0.185 Vali Loss: 2.985 Vali Acc: 0.681 Test Loss: 2.985 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2297735214233398
Epoch: 11, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.781 Vali Acc: 0.917 Test Loss: 0.781 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916659).  Saving model ...
Epoch: 12 cost time: 1.318835735321045
Epoch: 12, Steps: 7 | Train Loss: 0.140 Vali Loss: 4.174 Vali Acc: 0.736 Test Loss: 4.174 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5641992092132568
Epoch: 13, Steps: 7 | Train Loss: 0.237 Vali Loss: 1.107 Vali Acc: 0.819 Test Loss: 1.107 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.548774242401123
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 2.092 Vali Acc: 0.819 Test Loss: 2.092 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7663345336914062
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.669 Vali Acc: 0.819 Test Loss: 2.669 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.438291311264038
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.205 Vali Acc: 0.903 Test Loss: 2.205 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3551397323608398
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.224 Vali Acc: 0.889 Test Loss: 2.224 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4350190162658691
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.889 Test Loss: 2.165 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.383424997329712
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.105 Vali Acc: 0.889 Test Loss: 2.105 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4986567497253418
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.889 Test Loss: 2.098 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4586107730865479
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.889 Test Loss: 2.099 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 5645092
model size : 26.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9194209575653076
Epoch: 1, Steps: 7 | Train Loss: 2.688 Vali Loss: 2.551 Vali Acc: 0.181 Test Loss: 2.551 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 1.6159138679504395
Epoch: 2, Steps: 7 | Train Loss: 1.717 Vali Loss: 1.315 Vali Acc: 0.583 Test Loss: 1.315 Test Acc: 0.583
Validation loss decreased (-0.180530 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.349975824356079
Epoch: 3, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.583320 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.0683813095092773
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.819 Vali Acc: 0.819 Test Loss: 0.819 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6022751331329346
Epoch: 5, Steps: 7 | Train Loss: 0.187 Vali Loss: 2.559 Vali Acc: 0.639 Test Loss: 2.559 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.624342679977417
Epoch: 6, Steps: 7 | Train Loss: 0.238 Vali Loss: 1.247 Vali Acc: 0.708 Test Loss: 1.247 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3709526062011719
Epoch: 7, Steps: 7 | Train Loss: 0.238 Vali Loss: 1.651 Vali Acc: 0.792 Test Loss: 1.651 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4035379886627197
Epoch: 8, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.756 Vali Acc: 0.792 Test Loss: 0.756 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4329478740692139
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 1.108 Vali Acc: 0.847 Test Loss: 1.108 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847211).  Saving model ...
Epoch: 10 cost time: 1.2229630947113037
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 1.263 Vali Acc: 0.903 Test Loss: 1.263 Test Acc: 0.903
Validation loss decreased (-0.847211 --> -0.902765).  Saving model ...
Epoch: 11 cost time: 1.124851942062378
Epoch: 11, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2590656280517578
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.740 Vali Acc: 0.903 Test Loss: 0.740 Test Acc: 0.903
Validation loss decreased (-0.902765 --> -0.902770).  Saving model ...
Epoch: 13 cost time: 1.2462546825408936
Epoch: 13, Steps: 7 | Train Loss: 0.478 Vali Loss: 1.773 Vali Acc: 0.861 Test Loss: 1.773 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3287179470062256
Epoch: 14, Steps: 7 | Train Loss: 0.254 Vali Loss: 2.402 Vali Acc: 0.861 Test Loss: 2.402 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4834344387054443
Epoch: 15, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.428 Vali Acc: 0.944 Test Loss: 0.428 Test Acc: 0.944
Validation loss decreased (-0.902770 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 1.519164800643921
Epoch: 16, Steps: 7 | Train Loss: 0.348 Vali Loss: 2.151 Vali Acc: 0.847 Test Loss: 2.151 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5698857307434082
Epoch: 17, Steps: 7 | Train Loss: 0.112 Vali Loss: 3.543 Vali Acc: 0.722 Test Loss: 3.543 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8536558151245117
Epoch: 18, Steps: 7 | Train Loss: 0.063 Vali Loss: 1.835 Vali Acc: 0.819 Test Loss: 1.835 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.506068229675293
Epoch: 19, Steps: 7 | Train Loss: 0.099 Vali Loss: 2.026 Vali Acc: 0.806 Test Loss: 2.026 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.424767017364502
Epoch: 20, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.747 Vali Acc: 0.889 Test Loss: 0.747 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4597408771514893
Epoch: 21, Steps: 7 | Train Loss: 0.070 Vali Loss: 3.399 Vali Acc: 0.750 Test Loss: 3.399 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5765182971954346
Epoch: 22, Steps: 7 | Train Loss: 0.155 Vali Loss: 4.281 Vali Acc: 0.736 Test Loss: 4.281 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.770958423614502
Epoch: 23, Steps: 7 | Train Loss: 0.233 Vali Loss: 5.195 Vali Acc: 0.694 Test Loss: 5.195 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4700353145599365
Epoch: 24, Steps: 7 | Train Loss: 0.156 Vali Loss: 3.742 Vali Acc: 0.819 Test Loss: 3.742 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4316840171813965
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.131 Vali Acc: 0.792 Test Loss: 5.131 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5619492
model size : 26.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8142435550689697
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.939 Vali Acc: 0.139 Test Loss: 2.939 Test Acc: 0.139
Validation loss decreased (inf --> -0.138860).  Saving model ...
Epoch: 2 cost time: 1.5286707878112793
Epoch: 2, Steps: 7 | Train Loss: 2.260 Vali Loss: 1.884 Vali Acc: 0.333 Test Loss: 1.884 Test Acc: 0.333
Validation loss decreased (-0.138860 --> -0.333314).  Saving model ...
Epoch: 3 cost time: 1.3911378383636475
Epoch: 3, Steps: 7 | Train Loss: 0.852 Vali Loss: 1.156 Vali Acc: 0.639 Test Loss: 1.156 Test Acc: 0.639
Validation loss decreased (-0.333314 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 1.4831490516662598
Epoch: 4, Steps: 7 | Train Loss: 0.709 Vali Loss: 1.543 Vali Acc: 0.708 Test Loss: 1.543 Test Acc: 0.708
Validation loss decreased (-0.638877 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 1.6131043434143066
Epoch: 5, Steps: 7 | Train Loss: 0.547 Vali Loss: 1.941 Vali Acc: 0.611 Test Loss: 1.941 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.297550916671753
Epoch: 6, Steps: 7 | Train Loss: 0.210 Vali Loss: 2.353 Vali Acc: 0.611 Test Loss: 2.353 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6123881340026855
Epoch: 7, Steps: 7 | Train Loss: 0.403 Vali Loss: 1.795 Vali Acc: 0.819 Test Loss: 1.795 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819426).  Saving model ...
Epoch: 8 cost time: 1.725125789642334
Epoch: 8, Steps: 7 | Train Loss: 0.149 Vali Loss: 1.022 Vali Acc: 0.847 Test Loss: 1.022 Test Acc: 0.847
Validation loss decreased (-0.819426 --> -0.847212).  Saving model ...
Epoch: 9 cost time: 1.4654252529144287
Epoch: 9, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.188 Vali Acc: 0.833 Test Loss: 2.188 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3204345703125
Epoch: 10, Steps: 7 | Train Loss: 0.095 Vali Loss: 1.244 Vali Acc: 0.875 Test Loss: 1.244 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874988).  Saving model ...
Epoch: 11 cost time: 1.447659969329834
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.991 Vali Acc: 0.847 Test Loss: 0.991 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4542760848999023
Epoch: 12, Steps: 7 | Train Loss: 0.177 Vali Loss: 1.301 Vali Acc: 0.861 Test Loss: 1.301 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4046356678009033
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.806 Test Loss: 1.931 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5353586673736572
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.819 Test Loss: 1.626 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2556676864624023
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.806 Test Loss: 1.643 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5129258632659912
Epoch: 16, Steps: 7 | Train Loss: 0.025 Vali Loss: 1.196 Vali Acc: 0.861 Test Loss: 1.196 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.903886318206787
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.875 Test Loss: 1.150 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874989).  Saving model ...
Epoch: 18 cost time: 1.111745834350586
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.875 Test Loss: 1.152 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5663492679595947
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.875 Test Loss: 1.151 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.368361473083496
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.861 Test Loss: 1.147 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5971851348876953
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.861 Test Loss: 1.118 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5612034797668457
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.861 Test Loss: 1.100 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3970091342926025
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.861 Test Loss: 1.090 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4222042560577393
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.861 Test Loss: 1.085 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4601962566375732
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.875 Test Loss: 1.082 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 26 cost time: 1.7134370803833008
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.875 Test Loss: 1.079 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 27 cost time: 1.1975734233856201
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.875 Test Loss: 1.078 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 28 cost time: 1.4934120178222656
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.875 Test Loss: 1.076 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 29 cost time: 1.572030782699585
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.875 Test Loss: 1.075 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 30 cost time: 1.4202880859375
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.875 Test Loss: 1.074 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 31 cost time: 1.7552616596221924
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.875 Test Loss: 1.073 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 32 cost time: 1.2861664295196533
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.875 Test Loss: 1.072 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 33 cost time: 1.6177611351013184
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.875 Test Loss: 1.071 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 34 cost time: 1.5663890838623047
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.875 Test Loss: 1.070 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 35 cost time: 1.3898584842681885
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.875 Test Loss: 1.069 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 36 cost time: 1.5255684852600098
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.875 Test Loss: 1.069 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 37 cost time: 1.4658763408660889
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.875 Test Loss: 1.068 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 38 cost time: 1.4311707019805908
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.875 Test Loss: 1.068 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 39 cost time: 1.7094416618347168
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.875 Test Loss: 1.067 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 40 cost time: 1.5443305969238281
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.875 Test Loss: 1.066 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 41 cost time: 1.597017765045166
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.875 Test Loss: 1.065 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 42 cost time: 1.508080244064331
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.875 Test Loss: 1.065 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 43 cost time: 1.8033123016357422
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.875 Test Loss: 1.064 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 44 cost time: 1.2080471515655518
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.875 Test Loss: 1.063 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 45 cost time: 1.3326425552368164
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.875 Test Loss: 1.063 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 46 cost time: 1.1944875717163086
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.875 Test Loss: 1.062 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 47 cost time: 1.5705828666687012
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.875 Test Loss: 1.061 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 48 cost time: 1.6563184261322021
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.875 Test Loss: 1.061 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 49 cost time: 1.2759225368499756
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.875 Test Loss: 1.060 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 50 cost time: 1.307910442352295
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.875 Test Loss: 1.060 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 51 cost time: 1.4551937580108643
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.875 Test Loss: 1.059 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 52 cost time: 1.2549262046813965
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.875 Test Loss: 1.058 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 53 cost time: 1.2674570083618164
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.875 Test Loss: 1.058 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 54 cost time: 1.6605935096740723
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.875 Test Loss: 1.057 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 55 cost time: 1.694460391998291
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.875 Test Loss: 1.057 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 56 cost time: 1.369504451751709
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.875 Test Loss: 1.056 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 57 cost time: 1.8145205974578857
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.875 Test Loss: 1.056 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 58 cost time: 1.3408639430999756
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.875 Test Loss: 1.055 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 59 cost time: 1.263007402420044
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.875 Test Loss: 1.055 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874989).  Saving model ...
Epoch: 60 cost time: 1.674074649810791
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.889 Test Loss: 1.054 Test Acc: 0.889
Validation loss decreased (-0.874989 --> -0.888878).  Saving model ...
Epoch: 61 cost time: 1.3475911617279053
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.889 Test Loss: 1.053 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 62 cost time: 1.5669808387756348
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.889 Test Loss: 1.053 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 63 cost time: 1.8108758926391602
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.889 Test Loss: 1.052 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 64 cost time: 1.6366770267486572
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.889 Test Loss: 1.051 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 65 cost time: 1.5868208408355713
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.889 Test Loss: 1.051 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 66 cost time: 1.7384724617004395
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.889 Test Loss: 1.050 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 67 cost time: 1.7232296466827393
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.889 Test Loss: 1.050 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 68 cost time: 1.3601009845733643
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.889 Test Loss: 1.049 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 69 cost time: 1.5768890380859375
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.889 Test Loss: 1.049 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 70 cost time: 1.7546896934509277
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.889 Test Loss: 1.048 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 71 cost time: 1.7340822219848633
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.889 Test Loss: 1.048 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 72 cost time: 1.6629600524902344
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.889 Test Loss: 1.047 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 73 cost time: 1.4348323345184326
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.889 Test Loss: 1.047 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 74 cost time: 1.4883801937103271
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.889 Test Loss: 1.046 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 75 cost time: 1.6098973751068115
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.889 Test Loss: 1.046 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 76 cost time: 1.6759228706359863
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.889 Test Loss: 1.045 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 77 cost time: 1.4460697174072266
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.889 Test Loss: 1.045 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 78 cost time: 1.3977484703063965
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.889 Test Loss: 1.044 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 79 cost time: 1.4497416019439697
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.889 Test Loss: 1.044 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 80 cost time: 1.4562983512878418
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.889 Test Loss: 1.043 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 81 cost time: 1.5720560550689697
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.889 Test Loss: 1.043 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 82 cost time: 1.6500804424285889
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.889 Test Loss: 1.042 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 83 cost time: 1.5988450050354004
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.889 Test Loss: 1.042 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 84 cost time: 1.5848217010498047
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.889 Test Loss: 1.041 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 85 cost time: 1.740466833114624
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.889 Test Loss: 1.041 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 86 cost time: 1.723524570465088
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.889 Test Loss: 1.040 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 87 cost time: 1.599942684173584
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.889 Test Loss: 1.040 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 88 cost time: 1.6538429260253906
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.889 Test Loss: 1.039 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 89 cost time: 1.5577259063720703
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.889 Test Loss: 1.039 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888879).  Saving model ...
Epoch: 90 cost time: 1.4582030773162842
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.889 Test Loss: 1.038 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 91 cost time: 1.308098554611206
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.889 Test Loss: 1.038 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 92 cost time: 1.5380518436431885
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.889 Test Loss: 1.037 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 93 cost time: 1.425901174545288
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.889 Test Loss: 1.037 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 94 cost time: 1.4917347431182861
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.889 Test Loss: 1.036 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 95 cost time: 1.0922117233276367
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.889 Test Loss: 1.036 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 96 cost time: 1.1647872924804688
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.889 Test Loss: 1.035 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 97 cost time: 1.026353120803833
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.889 Test Loss: 1.035 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 98 cost time: 1.0162649154663086
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.889 Test Loss: 1.034 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 99 cost time: 1.3205041885375977
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.889 Test Loss: 1.034 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 100 cost time: 1.4508240222930908
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.889 Test Loss: 1.034 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 5593892
model size : 26.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9020824432373047
Epoch: 1, Steps: 7 | Train Loss: 2.648 Vali Loss: 2.221 Vali Acc: 0.208 Test Loss: 2.221 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 1.361325740814209
Epoch: 2, Steps: 7 | Train Loss: 1.466 Vali Loss: 1.066 Vali Acc: 0.639 Test Loss: 1.066 Test Acc: 0.639
Validation loss decreased (-0.208311 --> -0.638878).  Saving model ...
Epoch: 3 cost time: 1.650526523590088
Epoch: 3, Steps: 7 | Train Loss: 0.540 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.638878 --> -0.819438).  Saving model ...
Epoch: 4 cost time: 1.271498441696167
Epoch: 4, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.819438 --> -0.861107).  Saving model ...
Epoch: 5 cost time: 1.3886618614196777
Epoch: 5, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7022032737731934
Epoch: 6, Steps: 7 | Train Loss: 0.067 Vali Loss: 1.691 Vali Acc: 0.750 Test Loss: 1.691 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4315435886383057
Epoch: 7, Steps: 7 | Train Loss: 0.205 Vali Loss: 1.301 Vali Acc: 0.750 Test Loss: 1.301 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4202892780303955
Epoch: 8, Steps: 7 | Train Loss: 0.134 Vali Loss: 1.239 Vali Acc: 0.764 Test Loss: 1.239 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.385441780090332
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.633 Vali Acc: 0.931 Test Loss: 0.633 Test Acc: 0.931
Validation loss decreased (-0.861107 --> -0.930549).  Saving model ...
Epoch: 10 cost time: 1.6768836975097656
Epoch: 10, Steps: 7 | Train Loss: 0.194 Vali Loss: 1.130 Vali Acc: 0.861 Test Loss: 1.130 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3776562213897705
Epoch: 11, Steps: 7 | Train Loss: 0.115 Vali Loss: 1.431 Vali Acc: 0.819 Test Loss: 1.431 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4292385578155518
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5118868350982666
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.000 Vali Acc: 0.861 Test Loss: 1.000 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5131046772003174
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.823 Vali Acc: 0.819 Test Loss: 2.823 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5198369026184082
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.863 Vali Acc: 0.861 Test Loss: 0.863 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5120928287506104
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.670 Vali Acc: 0.875 Test Loss: 1.670 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3844830989837646
Epoch: 17, Steps: 7 | Train Loss: 0.190 Vali Loss: 2.127 Vali Acc: 0.806 Test Loss: 2.127 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2355997562408447
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.976 Vali Acc: 0.861 Test Loss: 1.976 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6307291984558105
Epoch: 19, Steps: 7 | Train Loss: 0.088 Vali Loss: 2.947 Vali Acc: 0.819 Test Loss: 2.947 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5473700
model size : 25.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.068554878234863
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.648 Vali Acc: 0.236 Test Loss: 2.648 Test Acc: 0.236
Validation loss decreased (inf --> -0.236085).  Saving model ...
Epoch: 2 cost time: 1.5079119205474854
Epoch: 2, Steps: 7 | Train Loss: 2.186 Vali Loss: 2.610 Vali Acc: 0.417 Test Loss: 2.610 Test Acc: 0.417
Validation loss decreased (-0.236085 --> -0.416641).  Saving model ...
Epoch: 3 cost time: 1.3689916133880615
Epoch: 3, Steps: 7 | Train Loss: 1.259 Vali Loss: 0.788 Vali Acc: 0.722 Test Loss: 0.788 Test Acc: 0.722
Validation loss decreased (-0.416641 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 1.483593463897705
Epoch: 4, Steps: 7 | Train Loss: 0.432 Vali Loss: 0.754 Vali Acc: 0.833 Test Loss: 0.754 Test Acc: 0.833
Validation loss decreased (-0.722214 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 1.4774997234344482
Epoch: 5, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.751 Vali Acc: 0.792 Test Loss: 0.751 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3114948272705078
Epoch: 6, Steps: 7 | Train Loss: 0.584 Vali Loss: 2.296 Vali Acc: 0.639 Test Loss: 2.296 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6459362506866455
Epoch: 7, Steps: 7 | Train Loss: 0.380 Vali Loss: 1.292 Vali Acc: 0.792 Test Loss: 1.292 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.820735216140747
Epoch: 8, Steps: 7 | Train Loss: 0.160 Vali Loss: 1.214 Vali Acc: 0.750 Test Loss: 1.214 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4177908897399902
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.931 Vali Acc: 0.833 Test Loss: 0.931 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6517245769500732
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.733 Vali Acc: 0.903 Test Loss: 0.733 Test Acc: 0.903
Validation loss decreased (-0.833326 --> -0.902770).  Saving model ...
Epoch: 11 cost time: 1.4988207817077637
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.905 Vali Acc: 0.806 Test Loss: 0.905 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5241520404815674
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.434938669204712
Epoch: 13, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.130 Vali Acc: 0.861 Test Loss: 1.130 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.355686902999878
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 1.380 Vali Acc: 0.847 Test Loss: 1.380 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6525602340698242
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.889 Test Loss: 0.798 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5355918407440186
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.917 Test Loss: 0.605 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916661).  Saving model ...
Epoch: 17 cost time: 1.4965920448303223
Epoch: 17, Steps: 7 | Train Loss: 0.049 Vali Loss: 1.168 Vali Acc: 0.861 Test Loss: 1.168 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.437779188156128
Epoch: 18, Steps: 7 | Train Loss: 0.160 Vali Loss: 3.084 Vali Acc: 0.833 Test Loss: 3.084 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3369691371917725
Epoch: 19, Steps: 7 | Train Loss: 0.356 Vali Loss: 6.186 Vali Acc: 0.708 Test Loss: 6.186 Test Acc: 0.708
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4901025295257568
Epoch: 20, Steps: 7 | Train Loss: 0.485 Vali Loss: 2.464 Vali Acc: 0.750 Test Loss: 2.464 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6286423206329346
Epoch: 21, Steps: 7 | Train Loss: 0.601 Vali Loss: 0.944 Vali Acc: 0.917 Test Loss: 0.944 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.337052345275879
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.917 Test Loss: 0.766 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.331214427947998
Epoch: 23, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.499 Vali Acc: 0.931 Test Loss: 0.499 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 24 cost time: 1.4715609550476074
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.917 Test Loss: 1.402 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5661163330078125
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.931 Test Loss: 0.687 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.288573980331421
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.875 Test Loss: 1.381 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3845462799072266
Epoch: 27, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.305 Vali Acc: 0.861 Test Loss: 1.305 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3877074718475342
Epoch: 28, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.896 Vali Acc: 0.917 Test Loss: 0.896 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3379395008087158
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.327 Vali Acc: 0.917 Test Loss: 1.327 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2914717197418213
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.889 Test Loss: 1.849 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.437065601348877
Epoch: 31, Steps: 7 | Train Loss: 0.048 Vali Loss: 2.173 Vali Acc: 0.875 Test Loss: 2.173 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6993045806884766
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.874 Vali Acc: 0.833 Test Loss: 2.874 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5972771644592285
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.751 Vali Acc: 0.861 Test Loss: 2.751 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5448100
model size : 25.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4191524982452393
Epoch: 1, Steps: 7 | Train Loss: 2.533 Vali Loss: 3.089 Vali Acc: 0.083 Test Loss: 3.089 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 1.6483838558197021
Epoch: 2, Steps: 7 | Train Loss: 2.376 Vali Loss: 1.738 Vali Acc: 0.375 Test Loss: 1.738 Test Acc: 0.375
Validation loss decreased (-0.083302 --> -0.374983).  Saving model ...
Epoch: 3 cost time: 1.7231249809265137
Epoch: 3, Steps: 7 | Train Loss: 0.754 Vali Loss: 1.645 Vali Acc: 0.597 Test Loss: 1.645 Test Acc: 0.597
Validation loss decreased (-0.374983 --> -0.597206).  Saving model ...
Epoch: 4 cost time: 1.2680344581604004
Epoch: 4, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.771 Vali Acc: 0.736 Test Loss: 0.771 Test Acc: 0.736
Validation loss decreased (-0.597206 --> -0.736103).  Saving model ...
Epoch: 5 cost time: 1.7030003070831299
Epoch: 5, Steps: 7 | Train Loss: 0.161 Vali Loss: 1.252 Vali Acc: 0.792 Test Loss: 1.252 Test Acc: 0.792
Validation loss decreased (-0.736103 --> -0.791654).  Saving model ...
Epoch: 6 cost time: 1.624983787536621
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.828 Vali Acc: 0.778 Test Loss: 0.828 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.649712085723877
Epoch: 7, Steps: 7 | Train Loss: 0.265 Vali Loss: 4.296 Vali Acc: 0.556 Test Loss: 4.296 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6812083721160889
Epoch: 8, Steps: 7 | Train Loss: 0.520 Vali Loss: 2.704 Vali Acc: 0.597 Test Loss: 2.704 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5806059837341309
Epoch: 9, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
Validation loss decreased (-0.791654 --> -0.819435).  Saving model ...
Epoch: 10 cost time: 1.7375421524047852
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.211 Vali Acc: 0.833 Test Loss: 2.211 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833311).  Saving model ...
Epoch: 11 cost time: 1.782073736190796
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.331 Vali Acc: 0.819 Test Loss: 1.331 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6562855243682861
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.090 Vali Acc: 0.847 Test Loss: 1.090 Test Acc: 0.847
Validation loss decreased (-0.833311 --> -0.847211).  Saving model ...
Epoch: 13 cost time: 1.5861055850982666
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.391 Vali Acc: 0.833 Test Loss: 1.391 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4895219802856445
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.250 Vali Acc: 0.819 Test Loss: 2.250 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.440345287322998
Epoch: 15, Steps: 7 | Train Loss: 0.083 Vali Loss: 1.585 Vali Acc: 0.861 Test Loss: 1.585 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861095).  Saving model ...
Epoch: 16 cost time: 1.248870611190796
Epoch: 16, Steps: 7 | Train Loss: 0.189 Vali Loss: 2.390 Vali Acc: 0.778 Test Loss: 2.390 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.68528151512146
Epoch: 17, Steps: 7 | Train Loss: 0.124 Vali Loss: 1.642 Vali Acc: 0.833 Test Loss: 1.642 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8867628574371338
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.819 Test Loss: 1.805 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5462679862976074
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.806 Test Loss: 2.249 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.883065938949585
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.832 Vali Acc: 0.861 Test Loss: 1.832 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5114684104919434
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.847 Test Loss: 2.354 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3816308975219727
Epoch: 22, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.445 Vali Acc: 0.833 Test Loss: 2.445 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2530059814453125
Epoch: 23, Steps: 7 | Train Loss: 0.063 Vali Loss: 3.840 Vali Acc: 0.806 Test Loss: 3.840 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2954349517822266
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.819 Test Loss: 2.893 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3997890949249268
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.755 Vali Acc: 0.861 Test Loss: 1.755 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 5422500
model size : 25.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3542284965515137
Epoch: 1, Steps: 7 | Train Loss: 2.681 Vali Loss: 2.615 Vali Acc: 0.167 Test Loss: 2.615 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.5275073051452637
Epoch: 2, Steps: 7 | Train Loss: 2.026 Vali Loss: 1.599 Vali Acc: 0.500 Test Loss: 1.599 Test Acc: 0.500
Validation loss decreased (-0.166641 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.6816985607147217
Epoch: 3, Steps: 7 | Train Loss: 0.730 Vali Loss: 0.725 Vali Acc: 0.736 Test Loss: 0.725 Test Acc: 0.736
Validation loss decreased (-0.499984 --> -0.736104).  Saving model ...
Epoch: 4 cost time: 1.4331748485565186
Epoch: 4, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.736104 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 1.186403751373291
Epoch: 5, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.815 Vali Acc: 0.778 Test Loss: 0.815 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 6 cost time: 1.4190516471862793
Epoch: 6, Steps: 7 | Train Loss: 0.741 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
Validation loss decreased (-0.777770 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 1.3294453620910645
Epoch: 7, Steps: 7 | Train Loss: 0.580 Vali Loss: 2.453 Vali Acc: 0.792 Test Loss: 2.453 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.357553482055664
Epoch: 8, Steps: 7 | Train Loss: 0.148 Vali Loss: 2.205 Vali Acc: 0.708 Test Loss: 2.205 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.406675100326538
Epoch: 9, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.949 Vali Acc: 0.819 Test Loss: 0.949 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3108351230621338
Epoch: 10, Steps: 7 | Train Loss: 0.116 Vali Loss: 2.674 Vali Acc: 0.806 Test Loss: 2.674 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0841515064239502
Epoch: 11, Steps: 7 | Train Loss: 0.348 Vali Loss: 2.369 Vali Acc: 0.792 Test Loss: 2.369 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.371631145477295
Epoch: 12, Steps: 7 | Train Loss: 0.434 Vali Loss: 1.196 Vali Acc: 0.861 Test Loss: 1.196 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861099).  Saving model ...
Epoch: 13 cost time: 1.0831222534179688
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.917 Test Loss: 0.846 Test Acc: 0.917
Validation loss decreased (-0.861099 --> -0.916658).  Saving model ...
Epoch: 14 cost time: 1.5049798488616943
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.786 Vali Acc: 0.792 Test Loss: 0.786 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7530360221862793
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.812 Vali Acc: 0.833 Test Loss: 1.812 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4040279388427734
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 2.727 Vali Acc: 0.806 Test Loss: 2.727 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6318762302398682
Epoch: 17, Steps: 7 | Train Loss: 0.177 Vali Loss: 4.706 Vali Acc: 0.736 Test Loss: 4.706 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3852880001068115
Epoch: 18, Steps: 7 | Train Loss: 0.061 Vali Loss: 1.603 Vali Acc: 0.833 Test Loss: 1.603 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3576619625091553
Epoch: 19, Steps: 7 | Train Loss: 0.233 Vali Loss: 1.860 Vali Acc: 0.833 Test Loss: 1.860 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4145336151123047
Epoch: 20, Steps: 7 | Train Loss: 0.113 Vali Loss: 3.659 Vali Acc: 0.736 Test Loss: 3.659 Test Acc: 0.736
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1574010848999023
Epoch: 21, Steps: 7 | Train Loss: 0.058 Vali Loss: 2.258 Vali Acc: 0.833 Test Loss: 2.258 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.502302885055542
Epoch: 22, Steps: 7 | Train Loss: 0.553 Vali Loss: 1.514 Vali Acc: 0.875 Test Loss: 1.514 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4830574989318848
Epoch: 23, Steps: 7 | Train Loss: 0.269 Vali Loss: 2.471 Vali Acc: 0.833 Test Loss: 2.471 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 5396900
model size : 25.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4761714935302734
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.577 Vali Acc: 0.139 Test Loss: 2.577 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.6262667179107666
Epoch: 2, Steps: 7 | Train Loss: 2.175 Vali Loss: 1.606 Vali Acc: 0.569 Test Loss: 1.606 Test Acc: 0.569
Validation loss decreased (-0.138863 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 1.7333807945251465
Epoch: 3, Steps: 7 | Train Loss: 1.228 Vali Loss: 1.184 Vali Acc: 0.639 Test Loss: 1.184 Test Acc: 0.639
Validation loss decreased (-0.569428 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 1.4999198913574219
Epoch: 4, Steps: 7 | Train Loss: 0.451 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.638877 --> -0.777771).  Saving model ...
Epoch: 5 cost time: 1.1579740047454834
Epoch: 5, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.712 Vali Acc: 0.764 Test Loss: 0.712 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.572021245956421
Epoch: 6, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.777771 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.5315625667572021
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3588292598724365
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3617746829986572
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3021907806396484
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5568196773529053
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 1.3886663913726807
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 1.623034954071045
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.931 Test Loss: 0.503 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.520029067993164
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.903 Test Loss: 0.624 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4415009021759033
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.889 Test Loss: 0.712 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4234979152679443
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.875 Test Loss: 0.581 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3417978286743164
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.205700397491455
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2860379219055176
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.265092372894287
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2589619159698486
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3092453479766846
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2641444
model size : 12.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1907544136047363
Epoch: 1, Steps: 7 | Train Loss: 2.629 Vali Loss: 2.440 Vali Acc: 0.139 Test Loss: 2.440 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.3024559020996094
Epoch: 2, Steps: 7 | Train Loss: 2.224 Vali Loss: 1.856 Vali Acc: 0.500 Test Loss: 1.856 Test Acc: 0.500
Validation loss decreased (-0.138864 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.3335392475128174
Epoch: 3, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
Validation loss decreased (-0.499981 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 1.2168474197387695
Epoch: 4, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.625 Vali Acc: 0.736 Test Loss: 0.625 Test Acc: 0.736
Validation loss decreased (-0.722212 --> -0.736105).  Saving model ...
Epoch: 5 cost time: 1.4054880142211914
Epoch: 5, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.823 Vali Acc: 0.681 Test Loss: 0.823 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.553804636001587
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 1.157 Vali Acc: 0.722 Test Loss: 1.157 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.604895830154419
Epoch: 7, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
Validation loss decreased (-0.736105 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 1.3411235809326172
Epoch: 8, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.805549 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.550353765487671
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.471 Vali Acc: 0.931 Test Loss: 0.471 Test Acc: 0.931
Validation loss decreased (-0.874995 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 1.4974360466003418
Epoch: 10, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3277888298034668
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.780 Vali Acc: 0.847 Test Loss: 0.780 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3491783142089844
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.520 Vali Acc: 0.903 Test Loss: 0.520 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6052742004394531
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.387333869934082
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.743 Vali Acc: 0.903 Test Loss: 0.743 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3162755966186523
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.136 Vali Acc: 0.819 Test Loss: 1.136 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4402103424072266
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.861 Test Loss: 0.938 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6560134887695312
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.889 Test Loss: 0.831 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2069954872131348
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.875 Test Loss: 0.818 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0075442790985107
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2628644
model size : 12.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.999361991882324
Epoch: 1, Steps: 7 | Train Loss: 2.618 Vali Loss: 2.517 Vali Acc: 0.083 Test Loss: 2.517 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.406564474105835
Epoch: 2, Steps: 7 | Train Loss: 2.222 Vali Loss: 1.861 Vali Acc: 0.514 Test Loss: 1.861 Test Acc: 0.514
Validation loss decreased (-0.083308 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 1.3158564567565918
Epoch: 3, Steps: 7 | Train Loss: 1.412 Vali Loss: 1.345 Vali Acc: 0.528 Test Loss: 1.345 Test Acc: 0.528
Validation loss decreased (-0.513870 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.2539739608764648
Epoch: 4, Steps: 7 | Train Loss: 0.671 Vali Loss: 1.402 Vali Acc: 0.722 Test Loss: 1.402 Test Acc: 0.722
Validation loss decreased (-0.527764 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 1.4603328704833984
Epoch: 5, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
Validation loss decreased (-0.722208 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.4191291332244873
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.792 Vali Acc: 0.806 Test Loss: 0.792 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2628986835479736
Epoch: 7, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.483 Vali Acc: 0.792 Test Loss: 0.483 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3800320625305176
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3249247074127197
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.924 Vali Acc: 0.833 Test Loss: 0.924 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3714964389801025
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.903 Test Loss: 0.538 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 1.3321888446807861
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.492 Vali Acc: 0.903 Test Loss: 0.492 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 0.9900484085083008
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1143970489501953
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.05448317527771
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1568419933319092
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.148099660873413
Epoch: 16, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.943 Vali Acc: 0.819 Test Loss: 0.943 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0979056358337402
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.903 Test Loss: 0.812 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1698286533355713
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.913 Vali Acc: 0.875 Test Loss: 0.913 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6157732009887695
Epoch: 19, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.957 Vali Acc: 0.861 Test Loss: 0.957 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.516953468322754
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.062 Vali Acc: 0.833 Test Loss: 1.062 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2583460807800293
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.271 Vali Acc: 0.861 Test Loss: 1.271 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1650843620300293
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.483 Vali Acc: 0.931 Test Loss: 0.483 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930551).  Saving model ...
Epoch: 23 cost time: 1.5230815410614014
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.861 Test Loss: 0.843 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4180352687835693
Epoch: 24, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.807 Vali Acc: 0.861 Test Loss: 0.807 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.348719835281372
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.880 Vali Acc: 0.875 Test Loss: 0.880 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.548553466796875
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.136 Vali Acc: 0.889 Test Loss: 1.136 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.408247709274292
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.784 Vali Acc: 0.833 Test Loss: 1.784 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2359328269958496
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.443 Vali Acc: 0.861 Test Loss: 1.443 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.236891269683838
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.889 Test Loss: 0.866 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1975915431976318
Epoch: 30, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.739 Vali Acc: 0.903 Test Loss: 0.739 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4321744441986084
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.875 Test Loss: 0.870 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.466958999633789
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.847 Test Loss: 1.579 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2615844
model size : 12.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3129544258117676
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.300 Vali Acc: 0.167 Test Loss: 2.300 Test Acc: 0.167
Validation loss decreased (inf --> -0.166644).  Saving model ...
Epoch: 2 cost time: 1.3749845027923584
Epoch: 2, Steps: 7 | Train Loss: 2.008 Vali Loss: 1.825 Vali Acc: 0.514 Test Loss: 1.825 Test Acc: 0.514
Validation loss decreased (-0.166644 --> -0.513871).  Saving model ...
Epoch: 3 cost time: 1.2668068408966064
Epoch: 3, Steps: 7 | Train Loss: 1.258 Vali Loss: 1.035 Vali Acc: 0.681 Test Loss: 1.035 Test Acc: 0.681
Validation loss decreased (-0.513871 --> -0.680545).  Saving model ...
Epoch: 4 cost time: 1.3833982944488525
Epoch: 4, Steps: 7 | Train Loss: 0.527 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.680545 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 1.2448923587799072
Epoch: 5, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.846 Vali Acc: 0.819 Test Loss: 0.846 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.296252965927124
Epoch: 6, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.644 Vali Acc: 0.764 Test Loss: 0.644 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3863036632537842
Epoch: 7, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 1.4428930282592773
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.987 Vali Acc: 0.819 Test Loss: 0.987 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2060823440551758
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.819 Test Loss: 0.776 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3558218479156494
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
Validation loss decreased (-0.847215 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 1.535463809967041
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5053861141204834
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.502307415008545
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6395046710968018
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3486285209655762
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9552099704742432
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7258939743041992
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.380610704421997
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.287792682647705
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4482121467590332
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4173758029937744
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.624129295349121
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6134605407714844
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4187290668487549
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5177862644195557
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5461270809173584
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6052212715148926
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2555663585662842
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2603044
model size : 12.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.766538619995117
Epoch: 1, Steps: 7 | Train Loss: 2.662 Vali Loss: 2.463 Vali Acc: 0.153 Test Loss: 2.463 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.2711851596832275
Epoch: 2, Steps: 7 | Train Loss: 2.182 Vali Loss: 1.539 Vali Acc: 0.556 Test Loss: 1.539 Test Acc: 0.556
Validation loss decreased (-0.152753 --> -0.555540).  Saving model ...
Epoch: 3 cost time: 1.148796558380127
Epoch: 3, Steps: 7 | Train Loss: 1.191 Vali Loss: 1.166 Vali Acc: 0.708 Test Loss: 1.166 Test Acc: 0.708
Validation loss decreased (-0.555540 --> -0.708322).  Saving model ...
Epoch: 4 cost time: 1.2877075672149658
Epoch: 4, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.748 Vali Acc: 0.708 Test Loss: 0.748 Test Acc: 0.708
Validation loss decreased (-0.708322 --> -0.708326).  Saving model ...
Epoch: 5 cost time: 1.249117136001587
Epoch: 5, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.562 Vali Acc: 0.806 Test Loss: 0.562 Test Acc: 0.806
Validation loss decreased (-0.708326 --> -0.805550).  Saving model ...
Epoch: 6 cost time: 1.2113418579101562
Epoch: 6, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.681 Vali Acc: 0.792 Test Loss: 0.681 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1274912357330322
Epoch: 7, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
Validation loss decreased (-0.805550 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 1.2590997219085693
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.0069360733032227
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 1.1993122100830078
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.284991979598999
Epoch: 11, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3112506866455078
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3963966369628906
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2164180278778076
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.524489164352417
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.917 Test Loss: 0.436 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3293826580047607
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.889 Test Loss: 0.498 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.207775592803955
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.198024034500122
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9962348937988281
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3946564197540283
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2246692
model size : 11.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2832798957824707
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.360 Vali Acc: 0.264 Test Loss: 2.360 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 1.1945362091064453
Epoch: 2, Steps: 7 | Train Loss: 2.194 Vali Loss: 1.678 Vali Acc: 0.556 Test Loss: 1.678 Test Acc: 0.556
Validation loss decreased (-0.263865 --> -0.555539).  Saving model ...
Epoch: 3 cost time: 1.3441128730773926
Epoch: 3, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.055 Vali Acc: 0.639 Test Loss: 1.055 Test Acc: 0.639
Validation loss decreased (-0.555539 --> -0.638878).  Saving model ...
Epoch: 4 cost time: 1.382845401763916
Epoch: 4, Steps: 7 | Train Loss: 0.503 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
Validation loss decreased (-0.638878 --> -0.805550).  Saving model ...
Epoch: 5 cost time: 1.3363850116729736
Epoch: 5, Steps: 7 | Train Loss: 0.311 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.2416033744812012
Epoch: 6, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 1.2454943656921387
Epoch: 7, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.3618600368499756
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.0839457511901855
Epoch: 9, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.1888549327850342
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.149 Vali Acc: 0.806 Test Loss: 1.149 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1707103252410889
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.257 Vali Acc: 0.778 Test Loss: 1.257 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1584913730621338
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.657 Vali Acc: 0.847 Test Loss: 0.657 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3475565910339355
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.847 Test Loss: 0.687 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1506505012512207
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.317354440689087
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.4227862358093262
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2685160636901855
Epoch: 17, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9501686096191406
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.341524600982666
Epoch: 19, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.981 Vali Acc: 0.861 Test Loss: 0.981 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4263761043548584
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.889 Test Loss: 0.993 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5599994659423828
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.738865613937378
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.861 Test Loss: 0.915 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2610948085784912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.819 Test Loss: 1.659 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.349428653717041
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.819 Test Loss: 1.799 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2285161018371582
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.861 Test Loss: 1.446 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2233892
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0834786891937256
Epoch: 1, Steps: 7 | Train Loss: 2.668 Vali Loss: 2.470 Vali Acc: 0.125 Test Loss: 2.470 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.566448450088501
Epoch: 2, Steps: 7 | Train Loss: 2.469 Vali Loss: 1.767 Vali Acc: 0.431 Test Loss: 1.767 Test Acc: 0.431
Validation loss decreased (-0.124975 --> -0.430538).  Saving model ...
Epoch: 3 cost time: 1.3506910800933838
Epoch: 3, Steps: 7 | Train Loss: 1.213 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.430538 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.1514537334442139
Epoch: 4, Steps: 7 | Train Loss: 0.474 Vali Loss: 0.730 Vali Acc: 0.764 Test Loss: 0.730 Test Acc: 0.764
Validation loss decreased (-0.749990 --> -0.763882).  Saving model ...
Epoch: 5 cost time: 1.141897201538086
Epoch: 5, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
Validation loss decreased (-0.763882 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 1.218350887298584
Epoch: 6, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.570 Vali Acc: 0.792 Test Loss: 0.570 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2123758792877197
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1043848991394043
Epoch: 8, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3730177879333496
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.240178108215332
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.852 Vali Acc: 0.806 Test Loss: 0.852 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3048279285430908
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.122 Vali Acc: 0.833 Test Loss: 1.122 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2140908241271973
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1999247074127197
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.917 Test Loss: 0.419 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 14 cost time: 1.0529732704162598
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.003 Vali Acc: 0.792 Test Loss: 1.003 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.40576171875
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4895620346069336
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1944224834442139
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.778 Vali Acc: 0.736 Test Loss: 1.778 Test Acc: 0.736
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5312614440917969
Epoch: 18, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.143862247467041
Epoch: 19, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.546 Vali Acc: 0.875 Test Loss: 1.546 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3650274276733398
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.294 Vali Acc: 0.819 Test Loss: 1.294 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3538353443145752
Epoch: 21, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2747724056243896
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0707154273986816
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.931 Test Loss: 0.585 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930550).  Saving model ...
Epoch: 24 cost time: 1.2996256351470947
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 1.463 Vali Acc: 0.847 Test Loss: 1.463 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3991780281066895
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.403 Vali Acc: 0.875 Test Loss: 1.403 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.243861436843872
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.617 Vali Acc: 0.833 Test Loss: 1.617 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4187488555908203
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.585 Vali Acc: 0.847 Test Loss: 2.585 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3066685199737549
Epoch: 28, Steps: 7 | Train Loss: 0.128 Vali Loss: 2.678 Vali Acc: 0.847 Test Loss: 2.678 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6725049018859863
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 3.498 Vali Acc: 0.750 Test Loss: 3.498 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.194880485534668
Epoch: 30, Steps: 7 | Train Loss: 0.276 Vali Loss: 3.842 Vali Acc: 0.764 Test Loss: 3.842 Test Acc: 0.764
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2903835773468018
Epoch: 31, Steps: 7 | Train Loss: 0.088 Vali Loss: 1.582 Vali Acc: 0.875 Test Loss: 1.582 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.465392827987671
Epoch: 32, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.256 Vali Acc: 0.861 Test Loss: 2.256 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2459182739257812
Epoch: 33, Steps: 7 | Train Loss: 0.090 Vali Loss: 2.678 Vali Acc: 0.861 Test Loss: 2.678 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2221092
model size : 10.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.837980031967163
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.339 Vali Acc: 0.194 Test Loss: 2.339 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.2521228790283203
Epoch: 2, Steps: 7 | Train Loss: 1.956 Vali Loss: 1.658 Vali Acc: 0.431 Test Loss: 1.658 Test Acc: 0.431
Validation loss decreased (-0.194421 --> -0.430539).  Saving model ...
Epoch: 3 cost time: 1.103442907333374
Epoch: 3, Steps: 7 | Train Loss: 1.224 Vali Loss: 0.940 Vali Acc: 0.764 Test Loss: 0.940 Test Acc: 0.764
Validation loss decreased (-0.430539 --> -0.763879).  Saving model ...
Epoch: 4 cost time: 1.2760570049285889
Epoch: 4, Steps: 7 | Train Loss: 0.544 Vali Loss: 0.609 Vali Acc: 0.847 Test Loss: 0.609 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 1.2625293731689453
Epoch: 5, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0411407947540283
Epoch: 6, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.122685194015503
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.608 Vali Acc: 0.847 Test Loss: 0.608 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 1.2709953784942627
Epoch: 8, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 9 cost time: 1.3841886520385742
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2724435329437256
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.587 Vali Acc: 0.847 Test Loss: 0.587 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.182652473449707
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.719 Vali Acc: 0.847 Test Loss: 0.719 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5109782218933105
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1126039028167725
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.958 Vali Acc: 0.833 Test Loss: 0.958 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2503652572631836
Epoch: 14, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 1.0483183860778809
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.228447437286377
Epoch: 16, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.897 Vali Acc: 0.875 Test Loss: 0.897 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2618756294250488
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.844 Vali Acc: 0.778 Test Loss: 1.844 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0608258247375488
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 1.326 Vali Acc: 0.833 Test Loss: 1.326 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2579069137573242
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.122 Vali Acc: 0.833 Test Loss: 1.122 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3549139499664307
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.575 Vali Acc: 0.875 Test Loss: 1.575 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4116201400756836
Epoch: 21, Steps: 7 | Train Loss: 0.476 Vali Loss: 1.330 Vali Acc: 0.833 Test Loss: 1.330 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.240687608718872
Epoch: 22, Steps: 7 | Train Loss: 0.123 Vali Loss: 1.176 Vali Acc: 0.847 Test Loss: 1.176 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4856958389282227
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 1.4833810329437256
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4158570766448975
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.903 Test Loss: 0.867 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.472867488861084
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.833 Test Loss: 1.561 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.199676513671875
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.847 Test Loss: 1.527 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2797539234161377
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.847 Test Loss: 1.449 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0953702926635742
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.833 Test Loss: 1.398 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3339133262634277
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.833 Test Loss: 1.359 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0659494400024414
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.833 Test Loss: 1.332 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5984866619110107
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.833 Test Loss: 1.312 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0556209087371826
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.833 Test Loss: 1.298 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2208292
model size : 10.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3760862350463867
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.508 Vali Acc: 0.139 Test Loss: 2.508 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.475630760192871
Epoch: 2, Steps: 7 | Train Loss: 2.207 Vali Loss: 1.863 Vali Acc: 0.347 Test Loss: 1.863 Test Acc: 0.347
Validation loss decreased (-0.138864 --> -0.347204).  Saving model ...
Epoch: 3 cost time: 1.182997465133667
Epoch: 3, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.248 Vali Acc: 0.639 Test Loss: 1.248 Test Acc: 0.639
Validation loss decreased (-0.347204 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 1.2524487972259521
Epoch: 4, Steps: 7 | Train Loss: 0.686 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
Validation loss decreased (-0.638876 --> -0.722212).  Saving model ...
Epoch: 5 cost time: 1.6490421295166016
Epoch: 5, Steps: 7 | Train Loss: 0.355 Vali Loss: 0.769 Vali Acc: 0.792 Test Loss: 0.769 Test Acc: 0.792
Validation loss decreased (-0.722212 --> -0.791659).  Saving model ...
Epoch: 6 cost time: 1.4482061862945557
Epoch: 6, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.833 Vali Acc: 0.722 Test Loss: 0.833 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.226943016052246
Epoch: 7, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.807 Vali Acc: 0.764 Test Loss: 0.807 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3206417560577393
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.791659 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.4686071872711182
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.376795768737793
Epoch: 10, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4188435077667236
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.828 Vali Acc: 0.833 Test Loss: 0.828 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4981639385223389
Epoch: 12, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1971807479858398
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 1.0403225421905518
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.847 Test Loss: 1.004 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4832782745361328
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3449082374572754
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.902773 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.3665566444396973
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.444586992263794
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3809254169464111
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0580782890319824
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1586174964904785
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.875 Test Loss: 0.707 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.383096694946289
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3043365478515625
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.875 Test Loss: 0.650 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3690812587738037
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.348188877105713
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.416616678237915
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2049316
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7461843490600586
Epoch: 1, Steps: 7 | Train Loss: 2.634 Vali Loss: 2.687 Vali Acc: 0.125 Test Loss: 2.687 Test Acc: 0.125
Validation loss decreased (inf --> -0.124973).  Saving model ...
Epoch: 2 cost time: 1.3971037864685059
Epoch: 2, Steps: 7 | Train Loss: 2.572 Vali Loss: 1.877 Vali Acc: 0.458 Test Loss: 1.877 Test Acc: 0.458
Validation loss decreased (-0.124973 --> -0.458315).  Saving model ...
Epoch: 3 cost time: 1.1935005187988281
Epoch: 3, Steps: 7 | Train Loss: 1.609 Vali Loss: 1.383 Vali Acc: 0.458 Test Loss: 1.383 Test Acc: 0.458
Validation loss decreased (-0.458315 --> -0.458320).  Saving model ...
Epoch: 4 cost time: 1.0696289539337158
Epoch: 4, Steps: 7 | Train Loss: 0.614 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
Validation loss decreased (-0.458320 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 1.2871763706207275
Epoch: 5, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
Validation loss decreased (-0.819438 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.064213752746582
Epoch: 6, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.783 Vali Acc: 0.792 Test Loss: 0.783 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0858032703399658
Epoch: 7, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.833328 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.1837260723114014
Epoch: 8, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.3210783004760742
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1703686714172363
Epoch: 10, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2161202430725098
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1942977905273438
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3345880508422852
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6326074600219727
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3882994651794434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1378779411315918
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1430494785308838
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.339048147201538
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2036516
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2104785442352295
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.268 Vali Acc: 0.278 Test Loss: 2.268 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 1.1708037853240967
Epoch: 2, Steps: 7 | Train Loss: 2.005 Vali Loss: 1.622 Vali Acc: 0.569 Test Loss: 1.622 Test Acc: 0.569
Validation loss decreased (-0.277755 --> -0.569428).  Saving model ...
Epoch: 3 cost time: 1.0604133605957031
Epoch: 3, Steps: 7 | Train Loss: 1.213 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
Validation loss decreased (-0.569428 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.1734158992767334
Epoch: 4, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.803 Vali Acc: 0.764 Test Loss: 0.803 Test Acc: 0.764
Validation loss decreased (-0.722213 --> -0.763881).  Saving model ...
Epoch: 5 cost time: 1.3710360527038574
Epoch: 5, Steps: 7 | Train Loss: 0.335 Vali Loss: 0.644 Vali Acc: 0.764 Test Loss: 0.644 Test Acc: 0.764
Validation loss decreased (-0.763881 --> -0.763882).  Saving model ...
Epoch: 6 cost time: 1.2982351779937744
Epoch: 6, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
Validation loss decreased (-0.763882 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.1031229496002197
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.337203025817871
Epoch: 8, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.766 Vali Acc: 0.861 Test Loss: 0.766 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.592405080795288
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.0967004299163818
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2858059406280518
Epoch: 11, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.106 Vali Acc: 0.819 Test Loss: 1.106 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3430492877960205
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4808850288391113
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.499131679534912
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.130652904510498
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0895259380340576
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.903 Test Loss: 0.422 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2297720909118652
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1681647300720215
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2564201354980469
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2023716
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.326997995376587
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.467 Vali Acc: 0.181 Test Loss: 2.467 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 1.0922067165374756
Epoch: 2, Steps: 7 | Train Loss: 2.021 Vali Loss: 1.860 Vali Acc: 0.347 Test Loss: 1.860 Test Acc: 0.347
Validation loss decreased (-0.180531 --> -0.347204).  Saving model ...
Epoch: 3 cost time: 1.232276439666748
Epoch: 3, Steps: 7 | Train Loss: 1.308 Vali Loss: 1.447 Vali Acc: 0.694 Test Loss: 1.447 Test Acc: 0.694
Validation loss decreased (-0.347204 --> -0.694430).  Saving model ...
Epoch: 4 cost time: 1.3461809158325195
Epoch: 4, Steps: 7 | Train Loss: 0.709 Vali Loss: 0.742 Vali Acc: 0.639 Test Loss: 0.742 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4211976528167725
Epoch: 5, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
Validation loss decreased (-0.694430 --> -0.805549).  Saving model ...
Epoch: 6 cost time: 1.372779369354248
Epoch: 6, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3926429748535156
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.888 Vali Acc: 0.792 Test Loss: 0.888 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.291597843170166
Epoch: 8, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.957 Vali Acc: 0.847 Test Loss: 0.957 Test Acc: 0.847
Validation loss decreased (-0.805549 --> -0.847213).  Saving model ...
Epoch: 9 cost time: 1.2116248607635498
Epoch: 9, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 1.092170238494873
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4551947116851807
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.039 Vali Acc: 0.778 Test Loss: 1.039 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0316493511199951
Epoch: 12, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.104579210281372
Epoch: 13, Steps: 7 | Train Loss: 0.289 Vali Loss: 1.440 Vali Acc: 0.792 Test Loss: 1.440 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.165926218032837
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.933 Vali Acc: 0.861 Test Loss: 0.933 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.279200553894043
Epoch: 15, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.412 Vali Acc: 0.917 Test Loss: 0.412 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 1.0095925331115723
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 1.1840345859527588
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9367637634277344
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.819 Test Loss: 1.151 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0745728015899658
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.833 Test Loss: 1.016 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2586970329284668
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.847 Test Loss: 0.932 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1748886108398438
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.833 Test Loss: 0.973 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4653337001800537
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.792 Test Loss: 0.976 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2154841423034668
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.792 Test Loss: 0.885 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5018529891967773
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2131130695343018
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2110981941223145
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2010916
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8847689628601074
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.524 Vali Acc: 0.139 Test Loss: 2.524 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.2140703201293945
Epoch: 2, Steps: 7 | Train Loss: 2.426 Vali Loss: 1.771 Vali Acc: 0.486 Test Loss: 1.771 Test Acc: 0.486
Validation loss decreased (-0.138864 --> -0.486093).  Saving model ...
Epoch: 3 cost time: 1.0822889804840088
Epoch: 3, Steps: 7 | Train Loss: 1.363 Vali Loss: 1.182 Vali Acc: 0.597 Test Loss: 1.182 Test Acc: 0.597
Validation loss decreased (-0.486093 --> -0.597210).  Saving model ...
Epoch: 4 cost time: 1.2357711791992188
Epoch: 4, Steps: 7 | Train Loss: 0.717 Vali Loss: 1.409 Vali Acc: 0.597 Test Loss: 1.409 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.170992374420166
Epoch: 5, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
Validation loss decreased (-0.597210 --> -0.777771).  Saving model ...
Epoch: 6 cost time: 1.2291648387908936
Epoch: 6, Steps: 7 | Train Loss: 0.209 Vali Loss: 1.081 Vali Acc: 0.667 Test Loss: 1.081 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1173720359802246
Epoch: 7, Steps: 7 | Train Loss: 0.341 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4344487190246582
Epoch: 8, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
Validation loss decreased (-0.777771 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.124094009399414
Epoch: 9, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.729 Vali Acc: 0.847 Test Loss: 0.729 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847215).  Saving model ...
Epoch: 10 cost time: 1.1905395984649658
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 1.0709490776062012
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 12 cost time: 1.009098768234253
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.907 Vali Acc: 0.833 Test Loss: 0.907 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2329778671264648
Epoch: 13, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.927 Vali Acc: 0.833 Test Loss: 0.927 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3569202423095703
Epoch: 14, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.563 Vali Acc: 0.903 Test Loss: 0.563 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 15 cost time: 1.197066307067871
Epoch: 15, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.402 Vali Acc: 0.944 Test Loss: 0.402 Test Acc: 0.944
Validation loss decreased (-0.902772 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 1.103266716003418
Epoch: 16, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.629 Vali Acc: 0.903 Test Loss: 0.629 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2462289333343506
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 1.544 Vali Acc: 0.750 Test Loss: 1.544 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2346792221069336
Epoch: 18, Steps: 7 | Train Loss: 0.045 Vali Loss: 1.882 Vali Acc: 0.792 Test Loss: 1.882 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2742054462432861
Epoch: 19, Steps: 7 | Train Loss: 0.096 Vali Loss: 2.683 Vali Acc: 0.764 Test Loss: 2.683 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1734204292297363
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.152 Vali Acc: 0.833 Test Loss: 1.152 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4978644847869873
Epoch: 21, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.355 Vali Acc: 0.806 Test Loss: 1.355 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.154905080795288
Epoch: 22, Steps: 7 | Train Loss: 0.093 Vali Loss: 1.795 Vali Acc: 0.819 Test Loss: 1.795 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8797726631164551
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.861 Vali Acc: 0.861 Test Loss: 0.861 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3317337036132812
Epoch: 24, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.469 Vali Acc: 0.806 Test Loss: 1.469 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.476938247680664
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.390 Vali Acc: 0.861 Test Loss: 1.390 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1950628
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.543368101119995
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.406 Vali Acc: 0.083 Test Loss: 2.406 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.141472578048706
Epoch: 2, Steps: 7 | Train Loss: 2.114 Vali Loss: 1.678 Vali Acc: 0.458 Test Loss: 1.678 Test Acc: 0.458
Validation loss decreased (-0.083309 --> -0.458317).  Saving model ...
Epoch: 3 cost time: 1.315394639968872
Epoch: 3, Steps: 7 | Train Loss: 1.163 Vali Loss: 1.155 Vali Acc: 0.556 Test Loss: 1.155 Test Acc: 0.556
Validation loss decreased (-0.458317 --> -0.555544).  Saving model ...
Epoch: 4 cost time: 1.2594568729400635
Epoch: 4, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.555544 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.1148626804351807
Epoch: 5, Steps: 7 | Train Loss: 0.273 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.833327 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 1.2624173164367676
Epoch: 6, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1658422946929932
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2107963562011719
Epoch: 8, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.407 Vali Acc: 0.847 Test Loss: 0.407 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2554872035980225
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.333766222000122
Epoch: 10, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.602 Vali Acc: 0.778 Test Loss: 0.602 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2662732601165771
Epoch: 11, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.931 Vali Acc: 0.722 Test Loss: 0.931 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2103538513183594
Epoch: 12, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.856 Vali Acc: 0.875 Test Loss: 0.856 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3696050643920898
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.287 Vali Acc: 0.792 Test Loss: 1.287 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.527050256729126
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.3267273902893066
Epoch: 15, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.5434365272521973
Epoch: 16, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8390178680419922
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4659509658813477
Epoch: 18, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.829 Vali Acc: 0.889 Test Loss: 0.829 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4383902549743652
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4019992351531982
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.847 Test Loss: 1.169 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2830705642700195
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.806 Test Loss: 1.529 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0021765232086182
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.819 Test Loss: 1.611 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3425583839416504
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.819 Test Loss: 1.556 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4703125953674316
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.833 Test Loss: 1.491 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.440906286239624
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.833 Test Loss: 1.455 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1937828
model size : 9.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6486995220184326
Epoch: 1, Steps: 7 | Train Loss: 2.692 Vali Loss: 2.513 Vali Acc: 0.111 Test Loss: 2.513 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.3036251068115234
Epoch: 2, Steps: 7 | Train Loss: 2.212 Vali Loss: 1.879 Vali Acc: 0.431 Test Loss: 1.879 Test Acc: 0.431
Validation loss decreased (-0.111086 --> -0.430537).  Saving model ...
Epoch: 3 cost time: 1.2289328575134277
Epoch: 3, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.336 Vali Acc: 0.611 Test Loss: 1.336 Test Acc: 0.611
Validation loss decreased (-0.430537 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.4665842056274414
Epoch: 4, Steps: 7 | Train Loss: 0.674 Vali Loss: 1.241 Vali Acc: 0.583 Test Loss: 1.241 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2524266242980957
Epoch: 5, Steps: 7 | Train Loss: 0.554 Vali Loss: 0.989 Vali Acc: 0.764 Test Loss: 0.989 Test Acc: 0.764
Validation loss decreased (-0.611098 --> -0.763879).  Saving model ...
Epoch: 6 cost time: 1.4021925926208496
Epoch: 6, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.751 Vali Acc: 0.764 Test Loss: 0.751 Test Acc: 0.764
Validation loss decreased (-0.763879 --> -0.763881).  Saving model ...
Epoch: 7 cost time: 1.332270860671997
Epoch: 7, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.747 Vali Acc: 0.806 Test Loss: 0.747 Test Acc: 0.806
Validation loss decreased (-0.763881 --> -0.805548).  Saving model ...
Epoch: 8 cost time: 1.297250509262085
Epoch: 8, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
Validation loss decreased (-0.805548 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.5632128715515137
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.341515064239502
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.752 Vali Acc: 0.819 Test Loss: 0.752 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2518630027770996
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2840685844421387
Epoch: 12, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 1.218080997467041
Epoch: 13, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5018281936645508
Epoch: 14, Steps: 7 | Train Loss: 0.032 Vali Loss: 1.311 Vali Acc: 0.833 Test Loss: 1.311 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2679507732391357
Epoch: 15, Steps: 7 | Train Loss: 0.132 Vali Loss: 1.527 Vali Acc: 0.833 Test Loss: 1.527 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4718234539031982
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2599270343780518
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5386581420898438
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2279481887817383
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.889 Test Loss: 0.730 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3232274055480957
Epoch: 20, Steps: 7 | Train Loss: 0.288 Vali Loss: 1.223 Vali Acc: 0.847 Test Loss: 1.223 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0681395530700684
Epoch: 21, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.900 Vali Acc: 0.889 Test Loss: 0.900 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.262162685394287
Epoch: 22, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.837 Vali Acc: 0.903 Test Loss: 0.837 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1925028
model size : 9.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.863978385925293
Epoch: 1, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.407 Vali Acc: 0.111 Test Loss: 2.407 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.1827476024627686
Epoch: 2, Steps: 7 | Train Loss: 2.166 Vali Loss: 1.737 Vali Acc: 0.542 Test Loss: 1.737 Test Acc: 0.542
Validation loss decreased (-0.111087 --> -0.541649).  Saving model ...
Epoch: 3 cost time: 1.2303249835968018
Epoch: 3, Steps: 7 | Train Loss: 1.325 Vali Loss: 1.290 Vali Acc: 0.611 Test Loss: 1.290 Test Acc: 0.611
Validation loss decreased (-0.541649 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.149125576019287
Epoch: 4, Steps: 7 | Train Loss: 0.738 Vali Loss: 0.875 Vali Acc: 0.639 Test Loss: 0.875 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638880).  Saving model ...
Epoch: 5 cost time: 1.3184566497802734
Epoch: 5, Steps: 7 | Train Loss: 0.435 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
Validation loss decreased (-0.638880 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.3595523834228516
Epoch: 6, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3093445301055908
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.270897626876831
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.757 Vali Acc: 0.792 Test Loss: 0.757 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3703718185424805
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847216).  Saving model ...
Epoch: 10 cost time: 1.2282297611236572
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 1.0907542705535889
Epoch: 11, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 1.149550437927246
Epoch: 12, Steps: 7 | Train Loss: 0.051 Vali Loss: 1.084 Vali Acc: 0.889 Test Loss: 1.084 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888878).  Saving model ...
Epoch: 13 cost time: 1.1058053970336914
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.647 Vali Acc: 0.889 Test Loss: 0.647 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 1.1211369037628174
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.722 Test Loss: 1.246 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1570863723754883
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 1.0724680423736572
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.802 Vali Acc: 0.861 Test Loss: 0.802 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3552711009979248
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4049715995788574
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4585371017456055
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.098 Vali Acc: 0.778 Test Loss: 1.098 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3620705604553223
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6528105735778809
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.875 Test Loss: 0.927 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2312395572662354
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.861 Test Loss: 1.144 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2444379329681396
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.847 Test Loss: 1.185 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3073253631591797
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.847 Test Loss: 1.130 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0601418018341064
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.875 Test Loss: 1.080 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1912228
model size : 9.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8373324871063232
Epoch: 1, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.458 Vali Acc: 0.153 Test Loss: 2.458 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.2197697162628174
Epoch: 2, Steps: 7 | Train Loss: 2.392 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
Validation loss decreased (-0.152753 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.1640956401824951
Epoch: 3, Steps: 7 | Train Loss: 1.575 Vali Loss: 1.359 Vali Acc: 0.722 Test Loss: 1.359 Test Acc: 0.722
Validation loss decreased (-0.499981 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 1.146611213684082
Epoch: 4, Steps: 7 | Train Loss: 0.840 Vali Loss: 0.846 Vali Acc: 0.764 Test Loss: 0.846 Test Acc: 0.764
Validation loss decreased (-0.722209 --> -0.763880).  Saving model ...
Epoch: 5 cost time: 1.353846788406372
Epoch: 5, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.618 Vali Acc: 0.806 Test Loss: 0.618 Test Acc: 0.806
Validation loss decreased (-0.763880 --> -0.805549).  Saving model ...
Epoch: 6 cost time: 1.2194769382476807
Epoch: 6, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.793 Vali Acc: 0.736 Test Loss: 0.793 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4375083446502686
Epoch: 7, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.805549 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.074202299118042
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1745083332061768
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.023880958557129
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.9905259609222412
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1241235733032227
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1595094203948975
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.094714641571045
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2561631202697754
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1468675136566162
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2206108570098877
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1030306816101074
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1448612213134766
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.360802173614502
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1125668
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9738717079162598
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.466 Vali Acc: 0.194 Test Loss: 2.466 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.274052381515503
Epoch: 2, Steps: 7 | Train Loss: 2.313 Vali Loss: 1.913 Vali Acc: 0.569 Test Loss: 1.913 Test Acc: 0.569
Validation loss decreased (-0.194420 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 1.2840723991394043
Epoch: 3, Steps: 7 | Train Loss: 1.762 Vali Loss: 1.281 Vali Acc: 0.681 Test Loss: 1.281 Test Acc: 0.681
Validation loss decreased (-0.569425 --> -0.680543).  Saving model ...
Epoch: 4 cost time: 1.1972670555114746
Epoch: 4, Steps: 7 | Train Loss: 0.867 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
Validation loss decreased (-0.680543 --> -0.777770).  Saving model ...
Epoch: 5 cost time: 1.3416287899017334
Epoch: 5, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.641 Vali Acc: 0.792 Test Loss: 0.641 Test Acc: 0.792
Validation loss decreased (-0.777770 --> -0.791660).  Saving model ...
Epoch: 6 cost time: 1.1748642921447754
Epoch: 6, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.791660 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 1.1943490505218506
Epoch: 7, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.1273174285888672
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1179819107055664
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.712 Vali Acc: 0.847 Test Loss: 0.712 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.245605230331421
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.3225762844085693
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0297293663024902
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.0751593112945557
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1135320663452148
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.121366024017334
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.1688458919525146
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.1707069873809814
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.4696195125579834
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4689044952392578
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1212003231048584
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2919180393218994
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2160563468933105
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.0792150497436523
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.1586058139801025
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.2891840934753418
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.4233722686767578
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.0613939762115479
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.167391061782837
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1582508087158203
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.4094133377075195
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.0629103183746338
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.037872552871704
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.0094830989837646
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.2909464836120605
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.138552188873291
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.0193676948547363
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.2916882038116455
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3121070861816406
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.4718127250671387
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.2559759616851807
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.276674747467041
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.3084988594055176
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.1188747882843018
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.3667371273040771
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.2557573318481445
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.0808374881744385
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.343677043914795
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.0532410144805908
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 1.1948609352111816
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.287865161895752
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 1.2816293239593506
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 1.193674087524414
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 1.0501708984375
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2067079544067383
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.159865140914917
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2053062915802002
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.192969560623169
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.0592796802520752
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 1.120042324066162
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 1.0361945629119873
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 1.2091178894042969
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 1.0558927059173584
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 1.1127853393554688
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.1476640701293945
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 1.2791438102722168
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.0493175983428955
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 1.1929593086242676
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 1.030078411102295
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.100968599319458
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 1.0814051628112793
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1847436428070068
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.2966198921203613
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 1.163794755935669
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.2423524856567383
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 1.0339245796203613
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 1.291551113128662
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.097825288772583
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.9876465797424316
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0969514846801758
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2255969047546387
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.1400253772735596
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9224812984466553
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 1.0884432792663574
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 0.9261775016784668
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 0.986750602722168
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 86 cost time: 1.0718767642974854
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.966956377029419
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.9939744472503662
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.1331815719604492
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.0127558708190918
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.1007566452026367
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 1.0893778800964355
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 1.2097132205963135
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1575491428375244
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 1.2180075645446777
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 1.033555030822754
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 1.314713954925537
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.2157793045043945
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.0966625213623047
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.2846760749816895
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1119268
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0248427391052246
Epoch: 1, Steps: 7 | Train Loss: 2.677 Vali Loss: 2.463 Vali Acc: 0.181 Test Loss: 2.463 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 1.3034765720367432
Epoch: 2, Steps: 7 | Train Loss: 2.333 Vali Loss: 1.910 Vali Acc: 0.417 Test Loss: 1.910 Test Acc: 0.417
Validation loss decreased (-0.180531 --> -0.416648).  Saving model ...
Epoch: 3 cost time: 1.2267987728118896
Epoch: 3, Steps: 7 | Train Loss: 1.566 Vali Loss: 1.260 Vali Acc: 0.778 Test Loss: 1.260 Test Acc: 0.778
Validation loss decreased (-0.416648 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 1.1377980709075928
Epoch: 4, Steps: 7 | Train Loss: 0.938 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0375914573669434
Epoch: 5, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.1325018405914307
Epoch: 6, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.419 Vali Acc: 0.847 Test Loss: 0.419 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0998854637145996
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1413331031799316
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0880239009857178
Epoch: 9, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 1.1448068618774414
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3250274658203125
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.902774 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 1.13051176071167
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0441317558288574
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1577823162078857
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1239910125732422
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.019014596939087
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8941011428833008
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1227612495422363
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0821521282196045
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1716549396514893
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1404571533203125
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1112868
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1611287593841553
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.366 Vali Acc: 0.181 Test Loss: 2.366 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.1750378608703613
Epoch: 2, Steps: 7 | Train Loss: 2.183 Vali Loss: 1.882 Vali Acc: 0.528 Test Loss: 1.882 Test Acc: 0.528
Validation loss decreased (-0.180532 --> -0.527759).  Saving model ...
Epoch: 3 cost time: 1.2007763385772705
Epoch: 3, Steps: 7 | Train Loss: 1.506 Vali Loss: 1.275 Vali Acc: 0.667 Test Loss: 1.275 Test Acc: 0.667
Validation loss decreased (-0.527759 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 0.9659531116485596
Epoch: 4, Steps: 7 | Train Loss: 0.952 Vali Loss: 0.901 Vali Acc: 0.750 Test Loss: 0.901 Test Acc: 0.750
Validation loss decreased (-0.666654 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.0834832191467285
Epoch: 5, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.749991 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 1.0392026901245117
Epoch: 6, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.121793508529663
Epoch: 7, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.847217 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.986748456954956
Epoch: 8, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.05143404006958
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1507821083068848
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2210891246795654
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.0779659748077393
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1963012218475342
Epoch: 13, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.06113862991333
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.994774341583252
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.236950159072876
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.931 Test Loss: 0.153 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 1.0525298118591309
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2450592517852783
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2743847370147705
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3113062381744385
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0474753379821777
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2879655361175537
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3113713264465332
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1914167404174805
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2710652351379395
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2271313667297363
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1106468
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.727874755859375
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.400 Vali Acc: 0.181 Test Loss: 2.400 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.0842881202697754
Epoch: 2, Steps: 7 | Train Loss: 2.135 Vali Loss: 1.807 Vali Acc: 0.472 Test Loss: 1.807 Test Acc: 0.472
Validation loss decreased (-0.180532 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 1.184234857559204
Epoch: 3, Steps: 7 | Train Loss: 1.464 Vali Loss: 1.301 Vali Acc: 0.639 Test Loss: 1.301 Test Acc: 0.639
Validation loss decreased (-0.472204 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 0.949225902557373
Epoch: 4, Steps: 7 | Train Loss: 0.877 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
Validation loss decreased (-0.638876 --> -0.777770).  Saving model ...
Epoch: 5 cost time: 1.1146745681762695
Epoch: 5, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
Validation loss decreased (-0.777770 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 1.5427765846252441
Epoch: 6, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.377647876739502
Epoch: 7, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.754119634628296
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3557543754577637
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.1196649074554443
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.9367475509643555
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0947110652923584
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1172301769256592
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1457829475402832
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0394794940948486
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.256934404373169
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1466052532196045
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2667298316955566
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1789798736572266
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3783955574035645
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 927524
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.707087993621826
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.418 Vali Acc: 0.250 Test Loss: 2.418 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 1.4373061656951904
Epoch: 2, Steps: 7 | Train Loss: 2.207 Vali Loss: 1.786 Vali Acc: 0.417 Test Loss: 1.786 Test Acc: 0.417
Validation loss decreased (-0.249976 --> -0.416649).  Saving model ...
Epoch: 3 cost time: 1.303879976272583
Epoch: 3, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.250 Vali Acc: 0.694 Test Loss: 1.250 Test Acc: 0.694
Validation loss decreased (-0.416649 --> -0.694432).  Saving model ...
Epoch: 4 cost time: 1.2094571590423584
Epoch: 4, Steps: 7 | Train Loss: 0.868 Vali Loss: 0.902 Vali Acc: 0.708 Test Loss: 0.902 Test Acc: 0.708
Validation loss decreased (-0.694432 --> -0.708324).  Saving model ...
Epoch: 5 cost time: 1.1990876197814941
Epoch: 5, Steps: 7 | Train Loss: 0.474 Vali Loss: 0.717 Vali Acc: 0.764 Test Loss: 0.717 Test Acc: 0.764
Validation loss decreased (-0.708324 --> -0.763882).  Saving model ...
Epoch: 6 cost time: 1.2224411964416504
Epoch: 6, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.763882 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0589001178741455
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4771864414215088
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4279141426086426
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.2109439373016357
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3865115642547607
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.2733712196350098
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2276310920715332
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.329061508178711
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.268059492111206
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0576295852661133
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.4110674858093262
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.3427257537841797
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.0800209045410156
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 0.8959715366363525
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 1.117666482925415
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 1.074481725692749
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 1.1281495094299316
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 1.097825050354004
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 1.102592945098877
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 1.1967504024505615
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 1.23710036277771
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 28 cost time: 1.099086046218872
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 1.1773653030395508
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 1.071565866470337
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6970818042755127
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3657360076904297
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.241919755935669
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0317096710205078
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2257297039031982
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3656890392303467
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 37 cost time: 1.3352079391479492
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 38 cost time: 1.1693224906921387
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 39 cost time: 1.0756006240844727
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2334256172180176
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 41 cost time: 1.1353895664215088
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2027952671051025
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.223766565322876
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3719303607940674
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3702702522277832
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1626112461090088
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3397600650787354
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1647334098815918
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.4774343967437744
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1465604305267334
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 921124
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8541183471679688
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.466 Vali Acc: 0.236 Test Loss: 2.466 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 1.1315457820892334
Epoch: 2, Steps: 7 | Train Loss: 2.271 Vali Loss: 1.810 Vali Acc: 0.653 Test Loss: 1.810 Test Acc: 0.653
Validation loss decreased (-0.236086 --> -0.652760).  Saving model ...
Epoch: 3 cost time: 1.234328031539917
Epoch: 3, Steps: 7 | Train Loss: 1.403 Vali Loss: 1.271 Vali Acc: 0.653 Test Loss: 1.271 Test Acc: 0.653
Validation loss decreased (-0.652760 --> -0.652765).  Saving model ...
Epoch: 4 cost time: 1.1275722980499268
Epoch: 4, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.787 Vali Acc: 0.833 Test Loss: 0.787 Test Acc: 0.833
Validation loss decreased (-0.652765 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 1.0752577781677246
Epoch: 5, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.130117654800415
Epoch: 6, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.644 Vali Acc: 0.806 Test Loss: 0.644 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3229851722717285
Epoch: 7, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.421 Vali Acc: 0.847 Test Loss: 0.421 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847218).  Saving model ...
Epoch: 8 cost time: 1.089280366897583
Epoch: 8, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.847218 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.1426851749420166
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.2326033115386963
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.903 Test Loss: 0.459 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2190215587615967
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2563776969909668
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1403751373291016
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1884682178497314
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4196932315826416
Epoch: 15, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0287184715270996
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3772940635681152
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1817474365234375
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0945415496826172
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.903 Test Loss: 0.433 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 914724
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.620145320892334
Epoch: 1, Steps: 7 | Train Loss: 2.655 Vali Loss: 2.407 Vali Acc: 0.153 Test Loss: 2.407 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.057342290878296
Epoch: 2, Steps: 7 | Train Loss: 2.280 Vali Loss: 1.876 Vali Acc: 0.569 Test Loss: 1.876 Test Acc: 0.569
Validation loss decreased (-0.152754 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 1.0064244270324707
Epoch: 3, Steps: 7 | Train Loss: 1.601 Vali Loss: 1.314 Vali Acc: 0.639 Test Loss: 1.314 Test Acc: 0.639
Validation loss decreased (-0.569426 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 1.0478129386901855
Epoch: 4, Steps: 7 | Train Loss: 1.012 Vali Loss: 1.036 Vali Acc: 0.597 Test Loss: 1.036 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1426105499267578
Epoch: 5, Steps: 7 | Train Loss: 0.654 Vali Loss: 0.750 Vali Acc: 0.750 Test Loss: 0.750 Test Acc: 0.750
Validation loss decreased (-0.638876 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 1.0995478630065918
Epoch: 6, Steps: 7 | Train Loss: 0.352 Vali Loss: 0.559 Vali Acc: 0.806 Test Loss: 0.559 Test Acc: 0.806
Validation loss decreased (-0.749992 --> -0.805550).  Saving model ...
Epoch: 7 cost time: 0.9598734378814697
Epoch: 7, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.0138227939605713
Epoch: 8, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.425 Vali Acc: 0.903 Test Loss: 0.425 Test Acc: 0.903
Validation loss decreased (-0.833329 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.9256744384765625
Epoch: 9, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0017576217651367
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8760790824890137
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9995639324188232
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.847 Test Loss: 0.641 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0294270515441895
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8948702812194824
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0847039222717285
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9398291110992432
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1287486553192139
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0628876686096191
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0382940769195557
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1206307411193848
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9374356269836426
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.9572763442993164
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.088127851486206
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0681803226470947
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0394601821899414
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9717023372650146
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0262489318847656
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9423894882202148
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9038882255554199
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9015414714813232
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2140507698059082
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 908324
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7678656578063965
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.331 Vali Acc: 0.264 Test Loss: 2.331 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 1.0543365478515625
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 1.799 Vali Acc: 0.694 Test Loss: 1.799 Test Acc: 0.694
Validation loss decreased (-0.263866 --> -0.694426).  Saving model ...
Epoch: 3 cost time: 0.8997387886047363
Epoch: 3, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.359 Vali Acc: 0.639 Test Loss: 1.359 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0861384868621826
Epoch: 4, Steps: 7 | Train Loss: 1.040 Vali Loss: 0.846 Vali Acc: 0.806 Test Loss: 0.846 Test Acc: 0.806
Validation loss decreased (-0.694426 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 1.1495721340179443
Epoch: 5, Steps: 7 | Train Loss: 0.488 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
Validation loss decreased (-0.805547 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.20365309715271
Epoch: 6, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2205679416656494
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.2731566429138184
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.512 Vali Acc: 0.806 Test Loss: 0.512 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1321096420288086
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2117269039154053
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.2628586292266846
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.2420496940612793
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0409739017486572
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.00929594039917
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8819580078125
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8651909828186035
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2617576122283936
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1070146560668945
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1011946201324463
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2786893844604492
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.041294813156128
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 828452
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8895750045776367
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.373 Vali Acc: 0.181 Test Loss: 2.373 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.0794436931610107
Epoch: 2, Steps: 7 | Train Loss: 2.221 Vali Loss: 1.813 Vali Acc: 0.389 Test Loss: 1.813 Test Acc: 0.389
Validation loss decreased (-0.180532 --> -0.388871).  Saving model ...
Epoch: 3 cost time: 1.0103635787963867
Epoch: 3, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.279 Vali Acc: 0.778 Test Loss: 1.279 Test Acc: 0.778
Validation loss decreased (-0.388871 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 0.8885412216186523
Epoch: 4, Steps: 7 | Train Loss: 1.002 Vali Loss: 0.897 Vali Acc: 0.792 Test Loss: 0.897 Test Acc: 0.792
Validation loss decreased (-0.777765 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.0229549407958984
Epoch: 5, Steps: 7 | Train Loss: 0.488 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.993009090423584
Epoch: 6, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.013930320739746
Epoch: 7, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2601654529571533
Epoch: 8, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.438 Vali Acc: 0.806 Test Loss: 0.438 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9901564121246338
Epoch: 9, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 1.111891746520996
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0043213367462158
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0447986125946045
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3618948459625244
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1279332637786865
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 1.0123660564422607
Epoch: 15, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.322317123413086
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.2108638286590576
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.806 Test Loss: 0.849 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2242755889892578
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.215287685394287
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.228980302810669
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9879655838012695
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.127814531326294
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2054831981658936
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2188236713409424
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1614243984222412
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4298937320709229
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.344123363494873
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3055062294006348
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0758929252624512
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 822052
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5351805686950684
Epoch: 1, Steps: 7 | Train Loss: 2.615 Vali Loss: 2.351 Vali Acc: 0.139 Test Loss: 2.351 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.0537571907043457
Epoch: 2, Steps: 7 | Train Loss: 2.241 Vali Loss: 1.949 Vali Acc: 0.458 Test Loss: 1.949 Test Acc: 0.458
Validation loss decreased (-0.138865 --> -0.458314).  Saving model ...
Epoch: 3 cost time: 0.8651173114776611
Epoch: 3, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.358 Vali Acc: 0.653 Test Loss: 1.358 Test Acc: 0.653
Validation loss decreased (-0.458314 --> -0.652764).  Saving model ...
Epoch: 4 cost time: 1.0412828922271729
Epoch: 4, Steps: 7 | Train Loss: 1.005 Vali Loss: 0.924 Vali Acc: 0.778 Test Loss: 0.924 Test Acc: 0.778
Validation loss decreased (-0.652764 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 1.0375258922576904
Epoch: 5, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.866 Vali Acc: 0.764 Test Loss: 0.866 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.979158878326416
Epoch: 6, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.777769 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.0670726299285889
Epoch: 7, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.607 Vali Acc: 0.792 Test Loss: 0.607 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1281933784484863
Epoch: 8, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0786259174346924
Epoch: 9, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.9522988796234131
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.270270586013794
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.0321762561798096
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.163806438446045
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1591808795928955
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0799787044525146
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.0665335655212402
Epoch: 16, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2419683933258057
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.043196678161621
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1664912700653076
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2294132709503174
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0311813354492188
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1156175136566162
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0547263622283936
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0700364112854004
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0357985496520996
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 815652
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.869417667388916
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.372 Vali Acc: 0.208 Test Loss: 2.372 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 1.271493911743164
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 1.808 Vali Acc: 0.542 Test Loss: 1.808 Test Acc: 0.542
Validation loss decreased (-0.208310 --> -0.541649).  Saving model ...
Epoch: 3 cost time: 0.9639089107513428
Epoch: 3, Steps: 7 | Train Loss: 1.470 Vali Loss: 1.267 Vali Acc: 0.736 Test Loss: 1.267 Test Acc: 0.736
Validation loss decreased (-0.541649 --> -0.736098).  Saving model ...
Epoch: 4 cost time: 0.9720478057861328
Epoch: 4, Steps: 7 | Train Loss: 0.784 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
Validation loss decreased (-0.736098 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 0.902998685836792
Epoch: 5, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.9855930805206299
Epoch: 6, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.677 Vali Acc: 0.750 Test Loss: 0.677 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9712164402008057
Epoch: 7, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 1.0037944316864014
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.9887111186981201
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
Validation loss decreased (-0.861107 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.9811007976531982
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0943503379821777
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.006941318511963
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8782892227172852
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0104355812072754
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1174042224884033
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0102026462554932
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1213996410369873
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0728213787078857
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9437747001647949
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 809252
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9753432273864746
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.367 Vali Acc: 0.139 Test Loss: 2.367 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.145115852355957
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 1.876 Vali Acc: 0.417 Test Loss: 1.876 Test Acc: 0.417
Validation loss decreased (-0.138865 --> -0.416648).  Saving model ...
Epoch: 3 cost time: 1.0947182178497314
Epoch: 3, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.403 Vali Acc: 0.736 Test Loss: 1.403 Test Acc: 0.736
Validation loss decreased (-0.416648 --> -0.736097).  Saving model ...
Epoch: 4 cost time: 0.9323053359985352
Epoch: 4, Steps: 7 | Train Loss: 0.878 Vali Loss: 1.006 Vali Acc: 0.722 Test Loss: 1.006 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.910266637802124
Epoch: 5, Steps: 7 | Train Loss: 0.469 Vali Loss: 0.658 Vali Acc: 0.819 Test Loss: 0.658 Test Acc: 0.819
Validation loss decreased (-0.736097 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 1.007918357849121
Epoch: 6, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.819438 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.9902257919311523
Epoch: 7, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.9167993068695068
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.8846664428710938
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.422 Vali Acc: 0.847 Test Loss: 0.422 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2674665451049805
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.047790765762329
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.1905643939971924
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.9919037818908691
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.033240795135498
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9943017959594727
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0160675048828125
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0601203441619873
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7647843360900879
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.295379877090454
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9456965923309326
Epoch: 20, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 1.0426051616668701
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.819 Test Loss: 0.731 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1892294883728027
Epoch: 22, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1210741996765137
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4522027969360352
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.020888328552246
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2124731540679932
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.179879903793335
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9929540157318115
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9673874378204346
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9729950428009033
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 778916
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.497826099395752
Epoch: 1, Steps: 7 | Train Loss: 2.618 Vali Loss: 2.393 Vali Acc: 0.139 Test Loss: 2.393 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.1627278327941895
Epoch: 2, Steps: 7 | Train Loss: 2.255 Vali Loss: 1.785 Vali Acc: 0.597 Test Loss: 1.785 Test Acc: 0.597
Validation loss decreased (-0.138865 --> -0.597204).  Saving model ...
Epoch: 3 cost time: 1.0942997932434082
Epoch: 3, Steps: 7 | Train Loss: 1.526 Vali Loss: 1.195 Vali Acc: 0.806 Test Loss: 1.195 Test Acc: 0.806
Validation loss decreased (-0.597204 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 1.3000519275665283
Epoch: 4, Steps: 7 | Train Loss: 0.878 Vali Loss: 1.018 Vali Acc: 0.681 Test Loss: 1.018 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2241368293762207
Epoch: 5, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
Validation loss decreased (-0.805544 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.155550241470337
Epoch: 6, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.0160243511199951
Epoch: 7, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0185768604278564
Epoch: 8, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.3230297565460205
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.011678695678711
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.080552101135254
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.188807487487793
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0440375804901123
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1906132698059082
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2911489009857178
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2905285358428955
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2817411422729492
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2409958839416504
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.141038179397583
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1940617561340332
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1201419830322266
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 772516
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7947142124176025
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.399 Vali Acc: 0.208 Test Loss: 2.399 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.9401307106018066
Epoch: 2, Steps: 7 | Train Loss: 2.258 Vali Loss: 1.930 Vali Acc: 0.514 Test Loss: 1.930 Test Acc: 0.514
Validation loss decreased (-0.208309 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 1.2570557594299316
Epoch: 3, Steps: 7 | Train Loss: 1.524 Vali Loss: 1.229 Vali Acc: 0.639 Test Loss: 1.229 Test Acc: 0.639
Validation loss decreased (-0.513870 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 1.0177559852600098
Epoch: 4, Steps: 7 | Train Loss: 0.860 Vali Loss: 0.992 Vali Acc: 0.653 Test Loss: 0.992 Test Acc: 0.653
Validation loss decreased (-0.638877 --> -0.652768).  Saving model ...
Epoch: 5 cost time: 0.8382706642150879
Epoch: 5, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.718 Vali Acc: 0.764 Test Loss: 0.718 Test Acc: 0.764
Validation loss decreased (-0.652768 --> -0.763882).  Saving model ...
Epoch: 6 cost time: 1.1592450141906738
Epoch: 6, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.763882 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.1574139595031738
Epoch: 7, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1192808151245117
Epoch: 8, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.833328 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.0737645626068115
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0803532600402832
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1932790279388428
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2022502422332764
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8957760334014893
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9824440479278564
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0339272022247314
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1241381168365479
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0762357711791992
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2602617740631104
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.917 Test Loss: 0.529 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2382166385650635
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.944 Test Loss: 0.421 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944440).  Saving model ...
Epoch: 20 cost time: 1.0451407432556152
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9804036617279053
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1135153770446777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1348693370819092
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.958897590637207
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1941697597503662
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0894184112548828
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1779286861419678
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.077925443649292
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.160454273223877
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 766116
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.873281478881836
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.351 Vali Acc: 0.139 Test Loss: 2.351 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8592591285705566
Epoch: 2, Steps: 7 | Train Loss: 2.297 Vali Loss: 1.778 Vali Acc: 0.625 Test Loss: 1.778 Test Acc: 0.625
Validation loss decreased (-0.138865 --> -0.624982).  Saving model ...
Epoch: 3 cost time: 0.9863755702972412
Epoch: 3, Steps: 7 | Train Loss: 1.581 Vali Loss: 1.235 Vali Acc: 0.750 Test Loss: 1.235 Test Acc: 0.750
Validation loss decreased (-0.624982 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.7817890644073486
Epoch: 4, Steps: 7 | Train Loss: 0.984 Vali Loss: 0.864 Vali Acc: 0.792 Test Loss: 0.864 Test Acc: 0.792
Validation loss decreased (-0.749988 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 0.9579696655273438
Epoch: 5, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7958452701568604
Epoch: 6, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.589 Vali Acc: 0.764 Test Loss: 0.589 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0920357704162598
Epoch: 7, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.610 Vali Acc: 0.778 Test Loss: 0.610 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9468538761138916
Epoch: 8, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.391 Vali Acc: 0.847 Test Loss: 0.391 Test Acc: 0.847
Validation loss decreased (-0.791658 --> -0.847218).  Saving model ...
Epoch: 9 cost time: 1.0993943214416504
Epoch: 9, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.617 Vali Acc: 0.819 Test Loss: 0.617 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9415168762207031
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.679 Vali Acc: 0.806 Test Loss: 0.679 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9983804225921631
Epoch: 11, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.847218 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9253675937652588
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9631218910217285
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0259780883789062
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8889484405517578
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.887408971786499
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9395287036895752
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.0306980609893799
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0036065578460693
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8737893104553223
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.900658369064331
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.2571077346801758
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8829717636108398
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2133634090423584
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8368003368377686
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9799425601959229
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9033536911010742
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.005685806274414
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0547444820404053
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0081112384796143
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1867339611053467
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 759716
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5550317764282227
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.380 Vali Acc: 0.236 Test Loss: 2.380 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 1.0641779899597168
Epoch: 2, Steps: 7 | Train Loss: 2.377 Vali Loss: 2.145 Vali Acc: 0.194 Test Loss: 2.145 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9790065288543701
Epoch: 3, Steps: 7 | Train Loss: 1.926 Vali Loss: 1.742 Vali Acc: 0.611 Test Loss: 1.742 Test Acc: 0.611
Validation loss decreased (-0.236087 --> -0.611094).  Saving model ...
Epoch: 4 cost time: 1.1126353740692139
Epoch: 4, Steps: 7 | Train Loss: 1.398 Vali Loss: 1.220 Vali Acc: 0.722 Test Loss: 1.220 Test Acc: 0.722
Validation loss decreased (-0.611094 --> -0.722210).  Saving model ...
Epoch: 5 cost time: 1.0886926651000977
Epoch: 5, Steps: 7 | Train Loss: 0.939 Vali Loss: 0.983 Vali Acc: 0.819 Test Loss: 0.983 Test Acc: 0.819
Validation loss decreased (-0.722210 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.9207625389099121
Epoch: 6, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 0.942112922668457
Epoch: 7, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.9374027252197266
Epoch: 8, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.0727453231811523
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.9991936683654785
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0431010723114014
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0423352718353271
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0013437271118164
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1429893970489502
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.0418367385864258
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0499603748321533
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9825525283813477
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.0105726718902588
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0140633583068848
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0099074840545654
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.145108938217163
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.1266822814941406
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.146601915359497
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0086965560913086
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1912586688995361
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8122668266296387
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.0265460014343262
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.9461736679077148
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1371214389801025
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9858238697052002
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0045154094696045
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0286638736724854
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0584261417388916
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.361435890197754
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.1851370334625244
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9742283821105957
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8615882396697998
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9282190799713135
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8720741271972656
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9941239356994629
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9513070583343506
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8835558891296387
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0034630298614502
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9538922309875488
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 515236
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9946088790893555
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.419 Vali Acc: 0.208 Test Loss: 2.419 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.033679723739624
Epoch: 2, Steps: 7 | Train Loss: 2.369 Vali Loss: 2.179 Vali Acc: 0.319 Test Loss: 2.179 Test Acc: 0.319
Validation loss decreased (-0.208309 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 0.9335048198699951
Epoch: 3, Steps: 7 | Train Loss: 1.896 Vali Loss: 1.695 Vali Acc: 0.569 Test Loss: 1.695 Test Acc: 0.569
Validation loss decreased (-0.319423 --> -0.569427).  Saving model ...
Epoch: 4 cost time: 0.9273133277893066
Epoch: 4, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.176 Vali Acc: 0.778 Test Loss: 1.176 Test Acc: 0.778
Validation loss decreased (-0.569427 --> -0.777766).  Saving model ...
Epoch: 5 cost time: 0.967674970626831
Epoch: 5, Steps: 7 | Train Loss: 0.954 Vali Loss: 0.851 Vali Acc: 0.819 Test Loss: 0.851 Test Acc: 0.819
Validation loss decreased (-0.777766 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 0.9075884819030762
Epoch: 6, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 1.0131096839904785
Epoch: 7, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.0147922039031982
Epoch: 8, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.137972116470337
Epoch: 9, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9099750518798828
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.12485671043396
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.085125207901001
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.1016526222229004
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0432791709899902
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1025331020355225
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1674489974975586
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8676202297210693
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9862692356109619
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0676732063293457
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0746965408325195
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1682770252227783
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0107619762420654
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 512036
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6551058292388916
Epoch: 1, Steps: 7 | Train Loss: 2.523 Vali Loss: 2.406 Vali Acc: 0.167 Test Loss: 2.406 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.0568065643310547
Epoch: 2, Steps: 7 | Train Loss: 2.363 Vali Loss: 2.126 Vali Acc: 0.403 Test Loss: 2.126 Test Acc: 0.403
Validation loss decreased (-0.166643 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.9261322021484375
Epoch: 3, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.755 Vali Acc: 0.583 Test Loss: 1.755 Test Acc: 0.583
Validation loss decreased (-0.402757 --> -0.583316).  Saving model ...
Epoch: 4 cost time: 0.9359357357025146
Epoch: 4, Steps: 7 | Train Loss: 1.384 Vali Loss: 1.220 Vali Acc: 0.833 Test Loss: 1.220 Test Acc: 0.833
Validation loss decreased (-0.583316 --> -0.833321).  Saving model ...
Epoch: 5 cost time: 0.924163818359375
Epoch: 5, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.818 Vali Acc: 0.889 Test Loss: 0.818 Test Acc: 0.889
Validation loss decreased (-0.833321 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 0.9794571399688721
Epoch: 6, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.583 Vali Acc: 0.806 Test Loss: 0.583 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.019172191619873
Epoch: 7, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9183568954467773
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8903243541717529
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.1782867908477783
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.003302812576294
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9179370403289795
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1323232650756836
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9870994091033936
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8670649528503418
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.8846955299377441
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8579084873199463
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9039063453674316
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9437899589538574
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8633253574371338
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9679477214813232
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0452604293823242
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2450788021087646
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9082882404327393
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8295960426330566
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9283149242401123
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 508836
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.393876791000366
Epoch: 1, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.445 Vali Acc: 0.097 Test Loss: 2.445 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.0459744930267334
Epoch: 2, Steps: 7 | Train Loss: 2.414 Vali Loss: 2.200 Vali Acc: 0.278 Test Loss: 2.200 Test Acc: 0.278
Validation loss decreased (-0.097198 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 0.9215154647827148
Epoch: 3, Steps: 7 | Train Loss: 1.989 Vali Loss: 1.771 Vali Acc: 0.431 Test Loss: 1.771 Test Acc: 0.431
Validation loss decreased (-0.277756 --> -0.430538).  Saving model ...
Epoch: 4 cost time: 1.0203089714050293
Epoch: 4, Steps: 7 | Train Loss: 1.511 Vali Loss: 1.373 Vali Acc: 0.750 Test Loss: 1.373 Test Acc: 0.750
Validation loss decreased (-0.430538 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 1.0708627700805664
Epoch: 5, Steps: 7 | Train Loss: 0.920 Vali Loss: 0.899 Vali Acc: 0.792 Test Loss: 0.899 Test Acc: 0.792
Validation loss decreased (-0.749986 --> -0.791658).  Saving model ...
Epoch: 6 cost time: 0.9243743419647217
Epoch: 6, Steps: 7 | Train Loss: 0.493 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819437).  Saving model ...
Epoch: 7 cost time: 1.0232195854187012
Epoch: 7, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.819437 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.7980494499206543
Epoch: 8, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.863544225692749
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.8228268623352051
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9841885566711426
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.9848997592926025
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.0607573986053467
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7589781284332275
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.954028844833374
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9627807140350342
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9210069179534912
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8701188564300537
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9793376922607422
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9571666717529297
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.108837604522705
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.099790096282959
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0363810062408447
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 505636
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0727121829986572
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.385 Vali Acc: 0.222 Test Loss: 2.385 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.274339199066162
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 2.107 Vali Acc: 0.417 Test Loss: 2.107 Test Acc: 0.417
Validation loss decreased (-0.222198 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.9672942161560059
Epoch: 3, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.662 Vali Acc: 0.694 Test Loss: 1.662 Test Acc: 0.694
Validation loss decreased (-0.416646 --> -0.694428).  Saving model ...
Epoch: 4 cost time: 1.1527299880981445
Epoch: 4, Steps: 7 | Train Loss: 1.436 Vali Loss: 1.255 Vali Acc: 0.639 Test Loss: 1.255 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4244966506958008
Epoch: 5, Steps: 7 | Train Loss: 0.944 Vali Loss: 0.924 Vali Acc: 0.806 Test Loss: 0.924 Test Acc: 0.806
Validation loss decreased (-0.694428 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 0.896956205368042
Epoch: 6, Steps: 7 | Train Loss: 0.555 Vali Loss: 0.638 Vali Acc: 0.889 Test Loss: 0.638 Test Acc: 0.889
Validation loss decreased (-0.805546 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 0.9090633392333984
Epoch: 7, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9689390659332275
Epoch: 8, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.0726325511932373
Epoch: 9, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.058631420135498
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.142308235168457
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9786980152130127
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.16554856300354
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0139338970184326
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0216796398162842
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.960533857345581
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9666333198547363
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.1168649196624756
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.098891258239746
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.9621326923370361
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2709496021270752
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1866836547851562
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.248175859451294
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9821274280548096
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.300520896911621
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.087007999420166
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0163235664367676
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1069121360778809
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0725862979888916
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 415396
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.618917226791382
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.427 Vali Acc: 0.097 Test Loss: 2.427 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.9879403114318848
Epoch: 2, Steps: 7 | Train Loss: 2.405 Vali Loss: 2.150 Vali Acc: 0.375 Test Loss: 2.150 Test Acc: 0.375
Validation loss decreased (-0.097198 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 1.068129062652588
Epoch: 3, Steps: 7 | Train Loss: 1.933 Vali Loss: 1.766 Vali Acc: 0.500 Test Loss: 1.766 Test Acc: 0.500
Validation loss decreased (-0.374978 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.1082525253295898
Epoch: 4, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.314 Vali Acc: 0.681 Test Loss: 1.314 Test Acc: 0.681
Validation loss decreased (-0.499982 --> -0.680542).  Saving model ...
Epoch: 5 cost time: 1.059920072555542
Epoch: 5, Steps: 7 | Train Loss: 0.927 Vali Loss: 0.942 Vali Acc: 0.833 Test Loss: 0.942 Test Acc: 0.833
Validation loss decreased (-0.680542 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 0.8092594146728516
Epoch: 6, Steps: 7 | Train Loss: 0.553 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 1.0585803985595703
Epoch: 7, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 1.007282018661499
Epoch: 8, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.0944335460662842
Epoch: 9, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0150704383850098
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.0595669746398926
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.902775 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 1.0603270530700684
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8664090633392334
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.038954257965088
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9789156913757324
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.006958246231079
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1431665420532227
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0119481086730957
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.140897512435913
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.069258689880371
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.00905179977417
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 412196
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6509106159210205
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.388 Vali Acc: 0.181 Test Loss: 2.388 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.05218505859375
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.119 Vali Acc: 0.500 Test Loss: 2.119 Test Acc: 0.500
Validation loss decreased (-0.180532 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 1.01820969581604
Epoch: 3, Steps: 7 | Train Loss: 1.948 Vali Loss: 1.775 Vali Acc: 0.569 Test Loss: 1.775 Test Acc: 0.569
Validation loss decreased (-0.499979 --> -0.569427).  Saving model ...
Epoch: 4 cost time: 1.1147403717041016
Epoch: 4, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.316 Vali Acc: 0.736 Test Loss: 1.316 Test Acc: 0.736
Validation loss decreased (-0.569427 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 1.0623869895935059
Epoch: 5, Steps: 7 | Train Loss: 0.972 Vali Loss: 0.893 Vali Acc: 0.889 Test Loss: 0.893 Test Acc: 0.889
Validation loss decreased (-0.736098 --> -0.888880).  Saving model ...
Epoch: 6 cost time: 0.8906545639038086
Epoch: 6, Steps: 7 | Train Loss: 0.565 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0088655948638916
Epoch: 7, Steps: 7 | Train Loss: 0.298 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2419226169586182
Epoch: 8, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.1338284015655518
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1450395584106445
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1461029052734375
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0835497379302979
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.9912288188934326
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1149678230285645
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9712433815002441
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0309650897979736
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1964828968048096
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.226708173751831
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9852519035339355
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.2155897617340088
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.9623305797576904
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.2761738300323486
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.0752742290496826
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.9814362525939941
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1559624671936035
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0588233470916748
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.0280427932739258
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9511275291442871
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.964240312576294
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.0273005962371826
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.1488234996795654
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2222297191619873
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8682219982147217
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0665686130523682
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1360409259796143
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.057574987411499
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.0016443729400635
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1363039016723633
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.123363971710205
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1297485828399658
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0780830383300781
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.0903456211090088
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.2127881050109863
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.0853831768035889
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.1085968017578125
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.0604522228240967
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0059163570404053
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.146709680557251
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1295661926269531
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.1768500804901123
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2744948863983154
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1425471305847168
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.176398754119873
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8953578472137451
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.0805461406707764
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0847389698028564
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0284755229949951
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.970940351486206
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.001462459564209
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.9518496990203857
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 1.2797648906707764
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 1.0764200687408447
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1087102890014648
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2277793884277344
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.0580894947052002
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9129977226257324
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.1048657894134521
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0543122291564941
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.08738112449646
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.001892328262329
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.1323225498199463
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.1431021690368652
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9845840930938721
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.0889410972595215
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 1.1719186305999756
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 1.0228612422943115
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.9329538345336914
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 1.044727087020874
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.9142444133758545
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0714044570922852
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.1744720935821533
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9600722789764404
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.9385592937469482
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.9681203365325928
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 1.1548683643341064
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.0429463386535645
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.0230765342712402
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.9816994667053223
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.1797499656677246
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.9893250465393066
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.238365888595581
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 0.8678524494171143
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.1195755004882812
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 1.0263841152191162
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1258292198181152
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.04779052734375
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 0.9767334461212158
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 98 cost time: 1.1370584964752197
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.1441631317138672
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 100 cost time: 0.8698432445526123
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 408996
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.831940174102783
Epoch: 1, Steps: 7 | Train Loss: 2.652 Vali Loss: 2.379 Vali Acc: 0.139 Test Loss: 2.379 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8613033294677734
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.153 Vali Acc: 0.319 Test Loss: 2.153 Test Acc: 0.319
Validation loss decreased (-0.138865 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 1.0304181575775146
Epoch: 3, Steps: 7 | Train Loss: 1.979 Vali Loss: 1.722 Vali Acc: 0.542 Test Loss: 1.722 Test Acc: 0.542
Validation loss decreased (-0.319423 --> -0.541649).  Saving model ...
Epoch: 4 cost time: 0.9745557308197021
Epoch: 4, Steps: 7 | Train Loss: 1.388 Vali Loss: 1.385 Vali Acc: 0.597 Test Loss: 1.385 Test Acc: 0.597
Validation loss decreased (-0.541649 --> -0.597208).  Saving model ...
Epoch: 5 cost time: 0.8707787990570068
Epoch: 5, Steps: 7 | Train Loss: 0.947 Vali Loss: 0.890 Vali Acc: 0.792 Test Loss: 0.890 Test Acc: 0.792
Validation loss decreased (-0.597208 --> -0.791658).  Saving model ...
Epoch: 6 cost time: 0.9302122592926025
Epoch: 6, Steps: 7 | Train Loss: 0.496 Vali Loss: 0.596 Vali Acc: 0.917 Test Loss: 0.596 Test Acc: 0.917
Validation loss decreased (-0.791658 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.9354197978973389
Epoch: 7, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9875352382659912
Epoch: 8, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8845398426055908
Epoch: 9, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8417816162109375
Epoch: 10, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9021725654602051
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8384132385253906
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8917512893676758
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9851677417755127
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0294442176818848
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0381536483764648
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.9182469844818115
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.0436289310455322
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0668275356292725
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.912318229675293
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9554274082183838
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9691503047943115
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.905148983001709
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8207957744598389
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9681062698364258
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9008228778839111
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9513757228851318
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 405796
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8151543140411377
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.382 Vali Acc: 0.208 Test Loss: 2.382 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 1.0500905513763428
Epoch: 2, Steps: 7 | Train Loss: 2.353 Vali Loss: 2.210 Vali Acc: 0.361 Test Loss: 2.210 Test Acc: 0.361
Validation loss decreased (-0.208310 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.8927528858184814
Epoch: 3, Steps: 7 | Train Loss: 1.970 Vali Loss: 1.717 Vali Acc: 0.569 Test Loss: 1.717 Test Acc: 0.569
Validation loss decreased (-0.361089 --> -0.569427).  Saving model ...
Epoch: 4 cost time: 1.113107681274414
Epoch: 4, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.402 Vali Acc: 0.708 Test Loss: 1.402 Test Acc: 0.708
Validation loss decreased (-0.569427 --> -0.708319).  Saving model ...
Epoch: 5 cost time: 0.8869941234588623
Epoch: 5, Steps: 7 | Train Loss: 1.017 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
Validation loss decreased (-0.708319 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 1.0175068378448486
Epoch: 6, Steps: 7 | Train Loss: 0.641 Vali Loss: 0.767 Vali Acc: 0.847 Test Loss: 0.767 Test Acc: 0.847
Validation loss decreased (-0.722212 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 0.8870182037353516
Epoch: 7, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.583 Vali Acc: 0.847 Test Loss: 0.583 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 0.9110758304595947
Epoch: 8, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.8988523483276367
Epoch: 9, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0434088706970215
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0705041885375977
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9246370792388916
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.0019280910491943
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.052931547164917
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0061430931091309
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.0907402038574219
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8817243576049805
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8881850242614746
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.976783037185669
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.048795461654663
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2759571075439453
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8618202209472656
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.815488338470459
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.969928503036499
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8713076114654541
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7916109561920166
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8719339370727539
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.088925838470459
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.038053274154663
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.97495436668396
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9841406345367432
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.9499344825744629
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0057647228240967
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8187661170959473
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0625848770141602
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.9045977592468262
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.932239294052124
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.1003766059875488
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2045364379882812
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.8130123615264893
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.862607479095459
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.0035433769226074
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9510221481323242
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.9512004852294922
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1228013038635254
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0074431896209717
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8533880710601807
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0443494319915771
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0286402702331543
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0223205089569092
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8998115062713623
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.0053911209106445
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0573005676269531
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.964576005935669
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.082456111907959
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.0775983333587646
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.9210922718048096
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0594866275787354
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1174359321594238
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2046749591827393
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8440682888031006
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9871747493743896
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0058197975158691
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9535820484161377
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.9364569187164307
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0259053707122803
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 365476
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1788039207458496
Epoch: 1, Steps: 7 | Train Loss: 2.661 Vali Loss: 2.453 Vali Acc: 0.125 Test Loss: 2.453 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.9520645141601562
Epoch: 2, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.191 Vali Acc: 0.222 Test Loss: 2.191 Test Acc: 0.222
Validation loss decreased (-0.124975 --> -0.222200).  Saving model ...
Epoch: 3 cost time: 0.9000649452209473
Epoch: 3, Steps: 7 | Train Loss: 1.946 Vali Loss: 1.731 Vali Acc: 0.556 Test Loss: 1.731 Test Acc: 0.556
Validation loss decreased (-0.222200 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 0.8135542869567871
Epoch: 4, Steps: 7 | Train Loss: 1.531 Vali Loss: 1.397 Vali Acc: 0.681 Test Loss: 1.397 Test Acc: 0.681
Validation loss decreased (-0.555538 --> -0.680542).  Saving model ...
Epoch: 5 cost time: 0.8468606472015381
Epoch: 5, Steps: 7 | Train Loss: 0.974 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
Validation loss decreased (-0.680542 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.8555467128753662
Epoch: 6, Steps: 7 | Train Loss: 0.541 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
Validation loss decreased (-0.819435 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 0.9782931804656982
Epoch: 7, Steps: 7 | Train Loss: 0.275 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 1.0198161602020264
Epoch: 8, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0227148532867432
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9487869739532471
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8859331607818604
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8880393505096436
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8407342433929443
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.036348581314087
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.9433927536010742
Epoch: 15, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.389 Vali Acc: 0.847 Test Loss: 0.389 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0336384773254395
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0577900409698486
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.907602071762085
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9917500019073486
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9762749671936035
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0283806324005127
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9686174392700195
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1548843383789062
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9703519344329834
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0341217517852783
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9574868679046631
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.957521915435791
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 362276
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8997724056243896
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.416 Vali Acc: 0.153 Test Loss: 2.416 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.9619650840759277
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.253 Vali Acc: 0.181 Test Loss: 2.253 Test Acc: 0.181
Validation loss decreased (-0.152754 --> -0.180533).  Saving model ...
Epoch: 3 cost time: 1.0100135803222656
Epoch: 3, Steps: 7 | Train Loss: 2.038 Vali Loss: 1.829 Vali Acc: 0.514 Test Loss: 1.829 Test Acc: 0.514
Validation loss decreased (-0.180533 --> -0.513871).  Saving model ...
Epoch: 4 cost time: 1.0909574031829834
Epoch: 4, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.423 Vali Acc: 0.750 Test Loss: 1.423 Test Acc: 0.750
Validation loss decreased (-0.513871 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 0.9609644412994385
Epoch: 5, Steps: 7 | Train Loss: 1.076 Vali Loss: 1.116 Vali Acc: 0.708 Test Loss: 1.116 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1840529441833496
Epoch: 6, Steps: 7 | Train Loss: 0.592 Vali Loss: 0.795 Vali Acc: 0.792 Test Loss: 0.795 Test Acc: 0.792
Validation loss decreased (-0.749986 --> -0.791659).  Saving model ...
Epoch: 7 cost time: 0.9117984771728516
Epoch: 7, Steps: 7 | Train Loss: 0.393 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.791659 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.1353492736816406
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.833328 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.1378588676452637
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.9177544116973877
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2740578651428223
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2024683952331543
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0675745010375977
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.0167360305786133
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1868455410003662
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0666422843933105
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.030454158782959
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0107486248016357
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9534447193145752
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2342774868011475
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3804974555969238
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0327186584472656
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0861663818359375
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 359076
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4705967903137207
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.464 Vali Acc: 0.056 Test Loss: 2.464 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 1.033536434173584
Epoch: 2, Steps: 7 | Train Loss: 2.366 Vali Loss: 2.196 Vali Acc: 0.292 Test Loss: 2.196 Test Acc: 0.292
Validation loss decreased (-0.055531 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 1.0155181884765625
Epoch: 3, Steps: 7 | Train Loss: 1.938 Vali Loss: 1.794 Vali Acc: 0.486 Test Loss: 1.794 Test Acc: 0.486
Validation loss decreased (-0.291645 --> -0.486093).  Saving model ...
Epoch: 4 cost time: 0.9604449272155762
Epoch: 4, Steps: 7 | Train Loss: 1.453 Vali Loss: 1.315 Vali Acc: 0.764 Test Loss: 1.315 Test Acc: 0.764
Validation loss decreased (-0.486093 --> -0.763876).  Saving model ...
Epoch: 5 cost time: 1.093501329421997
Epoch: 5, Steps: 7 | Train Loss: 1.035 Vali Loss: 0.977 Vali Acc: 0.875 Test Loss: 0.977 Test Acc: 0.875
Validation loss decreased (-0.763876 --> -0.874990).  Saving model ...
Epoch: 6 cost time: 0.8482418060302734
Epoch: 6, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.891 Vali Acc: 0.764 Test Loss: 0.891 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.197296142578125
Epoch: 7, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0590124130249023
Epoch: 8, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.0928618907928467
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0891072750091553
Epoch: 10, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.8318402767181396
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.1002168655395508
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0402772426605225
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.0999319553375244
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1165850162506104
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.0114710330963135
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8206098079681396
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9541416168212891
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0537359714508057
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0663819313049316
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9331064224243164
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0105674266815186
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0019195079803467
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8850400447845459
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.1599681377410889
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.0842454433441162
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.2352590560913086
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0996971130371094
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0439624786376953
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9558987617492676
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.040609359741211
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2325713634490967
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.0449285507202148
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0286624431610107
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1761746406555176
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1864933967590332
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9849584102630615
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0826208591461182
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.237868070602417
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.1368303298950195
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.229079246520996
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.092592716217041
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2996113300323486
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0658059120178223
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0362040996551514
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1597955226898193
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.9824674129486084
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.159487009048462
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.098675012588501
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.1970062255859375
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.259429931640625
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9550268650054932
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1510727405548096
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1053099632263184
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 1.1014409065246582
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.086064100265503
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1458368301391602
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.3460595607757568
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.107076644897461
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1408679485321045
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1216228008270264
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.8851809501647949
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1472423076629639
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.036336898803711
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.140876293182373
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8348269462585449
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.3122634887695312
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.0358381271362305
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2597124576568604
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2107272148132324
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1496331691741943
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.3004679679870605
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 1.0251858234405518
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 1.0577490329742432
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.9882946014404297
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.140895128250122
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.1625728607177734
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.163895606994629
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.0620746612548828
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.139265537261963
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.1688661575317383
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8900241851806641
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.1058614253997803
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 84 cost time: 0.7943711280822754
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.1958720684051514
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 1.183858871459961
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.188183307647705
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 1.0648612976074219
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 1.0776987075805664
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0849649906158447
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.0118367671966553
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.1312925815582275
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.085357666015625
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0956907272338867
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0365874767303467
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.219334602355957
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.2841033935546875
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 1.1609163284301758
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 355876
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8580594062805176
Epoch: 1, Steps: 7 | Train Loss: 2.660 Vali Loss: 2.427 Vali Acc: 0.111 Test Loss: 2.427 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.110837459564209
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.152 Vali Acc: 0.319 Test Loss: 2.152 Test Acc: 0.319
Validation loss decreased (-0.111087 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 1.0501184463500977
Epoch: 3, Steps: 7 | Train Loss: 1.988 Vali Loss: 1.780 Vali Acc: 0.681 Test Loss: 1.780 Test Acc: 0.681
Validation loss decreased (-0.319423 --> -0.680538).  Saving model ...
Epoch: 4 cost time: 0.944366455078125
Epoch: 4, Steps: 7 | Train Loss: 1.601 Vali Loss: 1.338 Vali Acc: 0.736 Test Loss: 1.338 Test Acc: 0.736
Validation loss decreased (-0.680538 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 1.339616298675537
Epoch: 5, Steps: 7 | Train Loss: 1.054 Vali Loss: 1.079 Vali Acc: 0.889 Test Loss: 1.079 Test Acc: 0.889
Validation loss decreased (-0.736098 --> -0.888878).  Saving model ...
Epoch: 6 cost time: 1.2638130187988281
Epoch: 6, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8711221218109131
Epoch: 7, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9051527976989746
Epoch: 8, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8676669597625732
Epoch: 9, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
Validation loss decreased (-0.888878 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.9247896671295166
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9637365341186523
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.8209619522094727
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8206002712249756
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8079955577850342
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.135561227798462
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0585734844207764
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.932368278503418
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9149186611175537
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9656360149383545
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0036118030548096
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0438098907470703
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9080178737640381
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.147578477859497
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 340516
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.212172269821167
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.469 Vali Acc: 0.125 Test Loss: 2.469 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.0192062854766846
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.219 Vali Acc: 0.375 Test Loss: 2.219 Test Acc: 0.375
Validation loss decreased (-0.124975 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 1.0825772285461426
Epoch: 3, Steps: 7 | Train Loss: 2.013 Vali Loss: 1.776 Vali Acc: 0.542 Test Loss: 1.776 Test Acc: 0.542
Validation loss decreased (-0.374978 --> -0.541649).  Saving model ...
Epoch: 4 cost time: 1.0015642642974854
Epoch: 4, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.488 Vali Acc: 0.528 Test Loss: 1.488 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2650458812713623
Epoch: 5, Steps: 7 | Train Loss: 1.104 Vali Loss: 1.179 Vali Acc: 0.667 Test Loss: 1.179 Test Acc: 0.667
Validation loss decreased (-0.541649 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 0.9819865226745605
Epoch: 6, Steps: 7 | Train Loss: 0.680 Vali Loss: 0.840 Vali Acc: 0.833 Test Loss: 0.840 Test Acc: 0.833
Validation loss decreased (-0.666655 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.9505620002746582
Epoch: 7, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.623 Vali Acc: 0.806 Test Loss: 0.623 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0637750625610352
Epoch: 8, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847217).  Saving model ...
Epoch: 9 cost time: 1.0099084377288818
Epoch: 9, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.421 Vali Acc: 0.847 Test Loss: 0.421 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 10 cost time: 0.978499174118042
Epoch: 10, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.9850549697875977
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.2781932353973389
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.8969020843505859
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 1.1832525730133057
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0891072750091553
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.9132418632507324
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2894492149353027
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8240256309509277
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1723296642303467
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.9266214370727539
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.9459211826324463
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.9812817573547363
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.9957578182220459
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.014850378036499
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.9155483245849609
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9705643653869629
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.928743839263916
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.1599974632263184
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.0422587394714355
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.0299854278564453
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.0087871551513672
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7444653511047363
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0796031951904297
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0081634521484375
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1621391773223877
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.0691184997558594
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.2163805961608887
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1797120571136475
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9822196960449219
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.0618340969085693
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0402717590332031
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0748841762542725
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0241775512695312
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1443688869476318
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0281927585601807
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.105302333831787
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.056455135345459
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.8933472633361816
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0893962383270264
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2708120346069336
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0383224487304688
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0909926891326904
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0090816020965576
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.977076530456543
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9090254306793213
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0933928489685059
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.033111810684204
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 337316
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6260883808135986
Epoch: 1, Steps: 7 | Train Loss: 2.680 Vali Loss: 2.500 Vali Acc: 0.111 Test Loss: 2.500 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.7914865016937256
Epoch: 2, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.320 Vali Acc: 0.181 Test Loss: 2.320 Test Acc: 0.181
Validation loss decreased (-0.111086 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 0.8181800842285156
Epoch: 3, Steps: 7 | Train Loss: 2.038 Vali Loss: 1.861 Vali Acc: 0.528 Test Loss: 1.861 Test Acc: 0.528
Validation loss decreased (-0.180532 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 0.9610447883605957
Epoch: 4, Steps: 7 | Train Loss: 1.557 Vali Loss: 1.458 Vali Acc: 0.792 Test Loss: 1.458 Test Acc: 0.792
Validation loss decreased (-0.527759 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.9568560123443604
Epoch: 5, Steps: 7 | Train Loss: 1.097 Vali Loss: 1.070 Vali Acc: 0.861 Test Loss: 1.070 Test Acc: 0.861
Validation loss decreased (-0.791652 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 0.8601078987121582
Epoch: 6, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.789 Vali Acc: 0.847 Test Loss: 0.789 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0905230045318604
Epoch: 7, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.9491868019104004
Epoch: 8, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.8800292015075684
Epoch: 9, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.0239510536193848
Epoch: 10, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.8815596103668213
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0088651180267334
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8346529006958008
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9527356624603271
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8809690475463867
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9278931617736816
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9568061828613281
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8710975646972656
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8166759014129639
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0047905445098877
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9614353179931641
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8659927845001221
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.868840217590332
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.0680773258209229
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9730770587921143
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9555375576019287
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9561331272125244
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.013716220855713
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9501800537109375
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1176643371582031
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1865274906158447
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9633824825286865
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0620548725128174
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0883290767669678
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8952555656433105
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.866642951965332
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 334116
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.126265525817871
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.480 Vali Acc: 0.139 Test Loss: 2.480 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.0156917572021484
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.210 Vali Acc: 0.389 Test Loss: 2.210 Test Acc: 0.389
Validation loss decreased (-0.138864 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 0.9066729545593262
Epoch: 3, Steps: 7 | Train Loss: 1.993 Vali Loss: 1.775 Vali Acc: 0.444 Test Loss: 1.775 Test Acc: 0.444
Validation loss decreased (-0.388867 --> -0.444427).  Saving model ...
Epoch: 4 cost time: 0.9268209934234619
Epoch: 4, Steps: 7 | Train Loss: 1.482 Vali Loss: 1.343 Vali Acc: 0.750 Test Loss: 1.343 Test Acc: 0.750
Validation loss decreased (-0.444427 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.8668608665466309
Epoch: 5, Steps: 7 | Train Loss: 0.984 Vali Loss: 1.028 Vali Acc: 0.847 Test Loss: 1.028 Test Acc: 0.847
Validation loss decreased (-0.749987 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 1.0838687419891357
Epoch: 6, Steps: 7 | Train Loss: 0.643 Vali Loss: 0.737 Vali Acc: 0.847 Test Loss: 0.737 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 0.9552419185638428
Epoch: 7, Steps: 7 | Train Loss: 0.363 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.0716078281402588
Epoch: 8, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.2867093086242676
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9494028091430664
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.0534398555755615
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.936016321182251
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.0173494815826416
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3444364070892334
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.1929254531860352
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1336259841918945
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.159717082977295
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1361191272735596
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1623492240905762
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.084472894668579
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0109302997589111
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1436023712158203
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1685445308685303
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0411548614501953
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_Crossformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 330916
model size : 1.94MB
