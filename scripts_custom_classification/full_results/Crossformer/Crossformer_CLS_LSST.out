Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0348427
	speed: 0.1748s/iter; left time: 2675.0763s
Epoch: 1 cost time: 24.582926273345947
Epoch: 1, Steps: 154 | Train Loss: 2.252 Vali Loss: 2.274 Vali Acc: 0.318 Test Loss: 2.274 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0361190
	speed: 0.4692s/iter; left time: 7107.5529s
Epoch: 2 cost time: 20.57940173149109
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.205 Vali Acc: 0.336 Test Loss: 2.205 Test Acc: 0.336
Validation loss decreased (-0.317496 --> -0.336150).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7522866
	speed: 0.4539s/iter; left time: 6804.8049s
Epoch: 3 cost time: 19.88311505317688
Epoch: 3, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.230 Vali Acc: 0.317 Test Loss: 2.230 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9488723
	speed: 0.4648s/iter; left time: 6897.3365s
Epoch: 4 cost time: 20.549864053726196
Epoch: 4, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.209 Vali Acc: 0.319 Test Loss: 2.209 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8181331
	speed: 0.4472s/iter; left time: 6566.5826s
Epoch: 5 cost time: 20.34297466278076
Epoch: 5, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.236 Vali Acc: 0.319 Test Loss: 2.236 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3681736
	speed: 0.4526s/iter; left time: 6576.7166s
Epoch: 6 cost time: 20.325459718704224
Epoch: 6, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.177 Vali Acc: 0.320 Test Loss: 2.177 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.4798069
	speed: 0.4329s/iter; left time: 6224.0838s
Epoch: 7 cost time: 19.51002812385559
Epoch: 7, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.196 Vali Acc: 0.315 Test Loss: 2.196 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.0482149
	speed: 0.4309s/iter; left time: 6129.0376s
Epoch: 8 cost time: 19.45614004135132
Epoch: 8, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.136 Vali Acc: 0.318 Test Loss: 2.136 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.0371807
	speed: 0.4415s/iter; left time: 6212.1458s
Epoch: 9 cost time: 20.135077953338623
Epoch: 9, Steps: 154 | Train Loss: 2.120 Vali Loss: 2.153 Vali Acc: 0.319 Test Loss: 2.153 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.7443049
	speed: 0.4404s/iter; left time: 6128.5971s
Epoch: 10 cost time: 20.328616619110107
Epoch: 10, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.208 Vali Acc: 0.158 Test Loss: 2.208 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2607465
	speed: 0.4662s/iter; left time: 6416.0221s
Epoch: 11 cost time: 19.09460210800171
Epoch: 11, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.152 Vali Acc: 0.320 Test Loss: 2.152 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.5150173
	speed: 0.4296s/iter; left time: 5845.8507s
Epoch: 12 cost time: 19.489325284957886
Epoch: 12, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.155 Vali Acc: 0.322 Test Loss: 2.155 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3361719383617194
model parameter : 14284618
model size : 59.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9316791
	speed: 0.1554s/iter; left time: 2377.0375s
Epoch: 1 cost time: 22.483125925064087
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.242 Vali Acc: 0.318 Test Loss: 2.242 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5159519
	speed: 0.4573s/iter; left time: 6926.4406s
Epoch: 2 cost time: 19.715240240097046
Epoch: 2, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.197 Vali Acc: 0.317 Test Loss: 2.197 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9009404
	speed: 0.4516s/iter; left time: 6770.4224s
Epoch: 3 cost time: 21.145078659057617
Epoch: 3, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.244 Vali Acc: 0.316 Test Loss: 2.244 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0148234
	speed: 0.4383s/iter; left time: 6504.2177s
Epoch: 4 cost time: 19.139119386672974
Epoch: 4, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.169 Vali Acc: 0.316 Test Loss: 2.169 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.1783769
	speed: 0.4491s/iter; left time: 6595.2783s
Epoch: 5 cost time: 20.922728538513184
Epoch: 5, Steps: 154 | Train Loss: 2.347 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.1865566
	speed: 0.4814s/iter; left time: 6995.8074s
Epoch: 6 cost time: 22.33363175392151
Epoch: 6, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.198 Vali Acc: 0.315 Test Loss: 2.198 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3540714
	speed: 0.5200s/iter; left time: 7475.6640s
Epoch: 7 cost time: 26.921749114990234
Epoch: 7, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.0159171
	speed: 0.4933s/iter; left time: 7016.7820s
Epoch: 8 cost time: 22.421886444091797
Epoch: 8, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.8791533
	speed: 0.5252s/iter; left time: 7388.9635s
Epoch: 9 cost time: 24.551377773284912
Epoch: 9, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.192 Vali Acc: 0.315 Test Loss: 2.192 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9850945
	speed: 0.5141s/iter; left time: 7153.2075s
Epoch: 10 cost time: 22.548611879348755
Epoch: 10, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.225 Vali Acc: 0.315 Test Loss: 2.225 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.3105934
	speed: 0.4918s/iter; left time: 6768.0949s
Epoch: 11 cost time: 21.58629608154297
Epoch: 11, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3175182481751825
model parameter : 14282826
model size : 59.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6837459
	speed: 0.1570s/iter; left time: 2401.9673s
Epoch: 1 cost time: 23.058517694473267
Epoch: 1, Steps: 154 | Train Loss: 2.261 Vali Loss: 2.168 Vali Acc: 0.319 Test Loss: 2.168 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4442472
	speed: 0.4845s/iter; left time: 7338.7644s
Epoch: 2 cost time: 20.27052879333496
Epoch: 2, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.190 Vali Acc: 0.178 Test Loss: 2.190 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3990140
	speed: 0.4267s/iter; left time: 6398.2127s
Epoch: 3 cost time: 20.163710355758667
Epoch: 3, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.157 Vali Acc: 0.326 Test Loss: 2.157 Test Acc: 0.326
Validation loss decreased (-0.318713 --> -0.326012).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9405457
	speed: 0.4638s/iter; left time: 6881.6265s
Epoch: 4 cost time: 20.82872748374939
Epoch: 4, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.173 Vali Acc: 0.320 Test Loss: 2.173 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0504172
	speed: 0.4349s/iter; left time: 6386.9277s
Epoch: 5 cost time: 19.88793396949768
Epoch: 5, Steps: 154 | Train Loss: 2.272 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8359027
	speed: 0.4747s/iter; left time: 6898.4670s
Epoch: 6 cost time: 22.073017120361328
Epoch: 6, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.8001338
	speed: 0.4587s/iter; left time: 6595.0907s
Epoch: 7 cost time: 19.978319883346558
Epoch: 7, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.210 Vali Acc: 0.315 Test Loss: 2.210 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.1166809
	speed: 0.4602s/iter; left time: 6545.2378s
Epoch: 8 cost time: 20.93282198905945
Epoch: 8, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.5861983
	speed: 0.4489s/iter; left time: 6315.5768s
Epoch: 9 cost time: 19.47179865837097
Epoch: 9, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.7794456
	speed: 0.4435s/iter; left time: 6170.6878s
Epoch: 10 cost time: 20.857662677764893
Epoch: 10, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.6900930
	speed: 0.4498s/iter; left time: 6189.5004s
Epoch: 11 cost time: 19.236583709716797
Epoch: 11, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.1102576
	speed: 0.4241s/iter; left time: 5770.1274s
Epoch: 12 cost time: 19.28184723854065
Epoch: 12, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.0613129
	speed: 0.4272s/iter; left time: 5747.1817s
Epoch: 13 cost time: 19.78045392036438
Epoch: 13, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3260340632603406
model parameter : 14281034
model size : 59.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3529153
	speed: 0.1472s/iter; left time: 2252.5383s
Epoch: 1 cost time: 21.002992868423462
Epoch: 1, Steps: 154 | Train Loss: 2.279 Vali Loss: 2.248 Vali Acc: 0.110 Test Loss: 2.248 Test Acc: 0.110
Validation loss decreased (inf --> -0.109872).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7527528
	speed: 0.4494s/iter; left time: 6806.7556s
Epoch: 2 cost time: 20.173121452331543
Epoch: 2, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.313 Vali Acc: 0.315 Test Loss: 2.313 Test Acc: 0.315
Validation loss decreased (-0.109872 --> -0.315468).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8143067
	speed: 0.4246s/iter; left time: 6366.7524s
Epoch: 3 cost time: 18.556054830551147
Epoch: 3, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.244 Vali Acc: 0.315 Test Loss: 2.244 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9856746
	speed: 0.4245s/iter; left time: 6299.2229s
Epoch: 4 cost time: 20.09305167198181
Epoch: 4, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.191 Vali Acc: 0.315 Test Loss: 2.191 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6578259
	speed: 0.4440s/iter; left time: 6519.6627s
Epoch: 5 cost time: 19.501193284988403
Epoch: 5, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.188 Vali Acc: 0.315 Test Loss: 2.188 Test Acc: 0.315
Validation loss decreased (-0.315468 --> -0.315469).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4297509
	speed: 0.4519s/iter; left time: 6567.2027s
Epoch: 6 cost time: 20.308736562728882
Epoch: 6, Steps: 154 | Train Loss: 2.260 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5219467
	speed: 0.4366s/iter; left time: 6276.7984s
Epoch: 7 cost time: 19.90880846977234
Epoch: 7, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.196 Vali Acc: 0.315 Test Loss: 2.196 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8618846
	speed: 0.3999s/iter; left time: 5688.2674s
Epoch: 8 cost time: 17.718074798583984
Epoch: 8, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.1449611
	speed: 0.4574s/iter; left time: 6434.4977s
Epoch: 9 cost time: 20.92992925643921
Epoch: 9, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.162 Vali Acc: 0.315 Test Loss: 2.162 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.0263665
	speed: 0.4365s/iter; left time: 6073.9141s
Epoch: 10 cost time: 18.034565687179565
Epoch: 10, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.189 Vali Acc: 0.315 Test Loss: 2.189 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.4869256
	speed: 0.4439s/iter; left time: 6109.0291s
Epoch: 11 cost time: 19.978759765625
Epoch: 11, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.1665685
	speed: 0.4517s/iter; left time: 6145.6181s
Epoch: 12 cost time: 20.617082595825195
Epoch: 12, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.3991370
	speed: 0.4671s/iter; left time: 6284.4346s
Epoch: 13 cost time: 21.985496520996094
Epoch: 13, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.203 Vali Acc: 0.315 Test Loss: 2.203 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.1331751
	speed: 0.4712s/iter; left time: 6266.7464s
Epoch: 14 cost time: 20.730278491973877
Epoch: 14, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.8090271
	speed: 0.4198s/iter; left time: 5518.0325s
Epoch: 15 cost time: 19.711107969284058
Epoch: 15, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.31549067315490675
model parameter : 14279242
model size : 59.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9785360
	speed: 0.1917s/iter; left time: 2932.4755s
Epoch: 1 cost time: 26.060612678527832
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.285 Vali Acc: 0.157 Test Loss: 2.285 Test Acc: 0.157
Validation loss decreased (inf --> -0.156506).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9384108
	speed: 0.4862s/iter; left time: 7365.0576s
Epoch: 2 cost time: 21.68383526802063
Epoch: 2, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.235 Vali Acc: 0.322 Test Loss: 2.235 Test Acc: 0.322
Validation loss decreased (-0.156506 --> -0.321551).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5657585
	speed: 0.4878s/iter; left time: 7314.1057s
Epoch: 3 cost time: 22.29419231414795
Epoch: 3, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.158 Vali Acc: 0.323 Test Loss: 2.158 Test Acc: 0.323
Validation loss decreased (-0.321551 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0840058
	speed: 0.4859s/iter; left time: 7210.7406s
Epoch: 4 cost time: 22.00775122642517
Epoch: 4, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.213 Vali Acc: 0.316 Test Loss: 2.213 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1133978
	speed: 0.4826s/iter; left time: 7086.5723s
Epoch: 5 cost time: 22.199288606643677
Epoch: 5, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.264 Vali Acc: 0.315 Test Loss: 2.264 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4560583
	speed: 0.4929s/iter; left time: 7162.9942s
Epoch: 6 cost time: 22.262747287750244
Epoch: 6, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.199 Vali Acc: 0.315 Test Loss: 2.199 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.9091128
	speed: 0.4763s/iter; left time: 6847.8708s
Epoch: 7 cost time: 21.511342525482178
Epoch: 7, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.4126849
	speed: 0.4817s/iter; left time: 6850.5373s
Epoch: 8 cost time: 23.46889877319336
Epoch: 8, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.7406952
	speed: 0.5028s/iter; left time: 7073.8722s
Epoch: 9 cost time: 21.88545536994934
Epoch: 9, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.217 Vali Acc: 0.315 Test Loss: 2.217 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.1695931
	speed: 0.4770s/iter; left time: 6637.4500s
Epoch: 10 cost time: 21.55649757385254
Epoch: 10, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.1428876
	speed: 0.4656s/iter; left time: 6407.7675s
Epoch: 11 cost time: 21.67979121208191
Epoch: 11, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.7943547
	speed: 0.4723s/iter; left time: 6427.1929s
Epoch: 12 cost time: 21.57106924057007
Epoch: 12, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.9143978
	speed: 0.4878s/iter; left time: 6562.2919s
Epoch: 13 cost time: 22.764652252197266
Epoch: 13, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.32278994322789945
model parameter : 11920714
model size : 50.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2541122
	speed: 0.1637s/iter; left time: 2504.5856s
Epoch: 1 cost time: 23.936439275741577
Epoch: 1, Steps: 154 | Train Loss: 2.252 Vali Loss: 2.272 Vali Acc: 0.316 Test Loss: 2.272 Test Acc: 0.316
Validation loss decreased (inf --> -0.316279).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4377651
	speed: 0.4454s/iter; left time: 6746.8405s
Epoch: 2 cost time: 19.712514400482178
Epoch: 2, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.225 Vali Acc: 0.315 Test Loss: 2.225 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3683143
	speed: 0.4504s/iter; left time: 6752.2867s
Epoch: 3 cost time: 21.153953790664673
Epoch: 3, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.375 Vali Acc: 0.316 Test Loss: 2.375 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.4381218
	speed: 0.4344s/iter; left time: 6446.4396s
Epoch: 4 cost time: 19.185544967651367
Epoch: 4, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.244 Vali Acc: 0.155 Test Loss: 2.244 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7807446
	speed: 0.4262s/iter; left time: 6258.3800s
Epoch: 5 cost time: 20.66107201576233
Epoch: 5, Steps: 154 | Train Loss: 2.207 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9008586
	speed: 0.4528s/iter; left time: 6579.5292s
Epoch: 6 cost time: 19.69489312171936
Epoch: 6, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.194 Vali Acc: 0.315 Test Loss: 2.194 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.9429470
	speed: 0.4106s/iter; left time: 5902.9450s
Epoch: 7 cost time: 19.63214921951294
Epoch: 7, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.0788207
	speed: 0.4519s/iter; left time: 6426.7093s
Epoch: 8 cost time: 20.848567247390747
Epoch: 8, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.4893622
	speed: 0.4722s/iter; left time: 6643.5260s
Epoch: 9 cost time: 21.72685742378235
Epoch: 9, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.0286140
	speed: 0.4821s/iter; left time: 6708.1170s
Epoch: 10 cost time: 22.868765592575073
Epoch: 10, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.191 Vali Acc: 0.315 Test Loss: 2.191 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.5459051
	speed: 0.4319s/iter; left time: 5943.4150s
Epoch: 11 cost time: 19.64427351951599
Epoch: 11, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.31630170316301703
model parameter : 11918922
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9382063
	speed: 0.1705s/iter; left time: 2609.1441s
Epoch: 1 cost time: 24.772236585617065
Epoch: 1, Steps: 154 | Train Loss: 2.302 Vali Loss: 2.201 Vali Acc: 0.315 Test Loss: 2.201 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0940087
	speed: 0.4713s/iter; left time: 7138.0554s
Epoch: 2 cost time: 21.941538333892822
Epoch: 2, Steps: 154 | Train Loss: 2.197 Vali Loss: 2.156 Vali Acc: 0.317 Test Loss: 2.156 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7723817
	speed: 0.4852s/iter; left time: 7274.7378s
Epoch: 3 cost time: 22.44071626663208
Epoch: 3, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.175 Vali Acc: 0.319 Test Loss: 2.175 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1413970
	speed: 0.5012s/iter; left time: 7436.9549s
Epoch: 4 cost time: 23.184391021728516
Epoch: 4, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.210 Vali Acc: 0.317 Test Loss: 2.210 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8691136
	speed: 0.5100s/iter; left time: 7490.0500s
Epoch: 5 cost time: 24.295992612838745
Epoch: 5, Steps: 154 | Train Loss: 2.240 Vali Loss: 2.248 Vali Acc: 0.315 Test Loss: 2.248 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0534220
	speed: 0.4979s/iter; left time: 7234.9050s
Epoch: 6 cost time: 23.486833572387695
Epoch: 6, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.0968726
	speed: 0.4748s/iter; left time: 6825.7579s
Epoch: 7 cost time: 20.89935302734375
Epoch: 7, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.260 Vali Acc: 0.315 Test Loss: 2.260 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.9380828
	speed: 0.4800s/iter; left time: 6826.6421s
Epoch: 8 cost time: 22.037834405899048
Epoch: 8, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.1315517
	speed: 0.4905s/iter; left time: 6901.3608s
Epoch: 9 cost time: 22.6324679851532
Epoch: 9, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.194 Vali Acc: 0.315 Test Loss: 2.194 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.9412484
	speed: 0.4965s/iter; left time: 6909.0619s
Epoch: 10 cost time: 20.47394037246704
Epoch: 10, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.2048206
	speed: 0.4315s/iter; left time: 5937.3108s
Epoch: 11 cost time: 19.986228942871094
Epoch: 11, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.0816071
	speed: 0.4543s/iter; left time: 6181.9614s
Epoch: 12 cost time: 20.150859117507935
Epoch: 12, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.7757219
	speed: 0.4654s/iter; left time: 6261.5062s
Epoch: 13 cost time: 20.76264715194702
Epoch: 13, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.192 Vali Acc: 0.315 Test Loss: 2.192 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3191403081914031
model parameter : 11917130
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9440804
	speed: 0.1699s/iter; left time: 2599.5146s
Epoch: 1 cost time: 25.507116079330444
Epoch: 1, Steps: 154 | Train Loss: 2.292 Vali Loss: 2.230 Vali Acc: 0.315 Test Loss: 2.230 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5390785
	speed: 0.6034s/iter; left time: 9139.3659s
Epoch: 2 cost time: 20.712620496749878
Epoch: 2, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.336 Vali Acc: 0.069 Test Loss: 2.336 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.7051649
	speed: 0.4603s/iter; left time: 6901.1610s
Epoch: 3 cost time: 19.840080976486206
Epoch: 3, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.335 Vali Acc: 0.162 Test Loss: 2.335 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.5498264
	speed: 0.4519s/iter; left time: 6706.4737s
Epoch: 4 cost time: 19.34400773048401
Epoch: 4, Steps: 154 | Train Loss: 2.254 Vali Loss: 2.203 Vali Acc: 0.315 Test Loss: 2.203 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1770639
	speed: 0.4360s/iter; left time: 6403.0222s
Epoch: 5 cost time: 20.200572729110718
Epoch: 5, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0030322
	speed: 0.4623s/iter; left time: 6717.9452s
Epoch: 6 cost time: 20.528145790100098
Epoch: 6, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.232 Vali Acc: 0.315 Test Loss: 2.232 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2502012
	speed: 0.4646s/iter; left time: 6679.6534s
Epoch: 7 cost time: 20.951643466949463
Epoch: 7, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9245819
	speed: 0.4635s/iter; left time: 6592.3982s
Epoch: 8 cost time: 20.098900318145752
Epoch: 8, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
Validation loss decreased (-0.315469 --> -0.315469).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9967911
	speed: 0.4876s/iter; left time: 6860.4599s
Epoch: 9 cost time: 22.475199937820435
Epoch: 9, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.205 Vali Acc: 0.315 Test Loss: 2.205 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0473981
	speed: 0.4497s/iter; left time: 6257.7061s
Epoch: 10 cost time: 21.042912006378174
Epoch: 10, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.5099902
	speed: 0.4316s/iter; left time: 5939.3251s
Epoch: 11 cost time: 20.73474645614624
Epoch: 11, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.162 Vali Acc: 0.315 Test Loss: 2.162 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.3918576
	speed: 0.4714s/iter; left time: 6413.7304s
Epoch: 12 cost time: 21.627997636795044
Epoch: 12, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.3082490
	speed: 0.4465s/iter; left time: 6006.4791s
Epoch: 13 cost time: 19.718333959579468
Epoch: 13, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
Validation loss decreased (-0.315469 --> -0.315469).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2349670
	speed: 0.4689s/iter; left time: 6236.0654s
Epoch: 14 cost time: 21.26953148841858
Epoch: 14, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2875688
	speed: 0.4531s/iter; left time: 5956.1165s
Epoch: 15 cost time: 20.39943528175354
Epoch: 15, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.4278409
	speed: 0.4732s/iter; left time: 6147.1681s
Epoch: 16 cost time: 20.83919334411621
Epoch: 16, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.184 Vali Acc: 0.315 Test Loss: 2.184 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.9403859
	speed: 0.4666s/iter; left time: 5990.1416s
Epoch: 17 cost time: 23.129327535629272
Epoch: 17, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.9702765
	speed: 0.4812s/iter; left time: 6103.4503s
Epoch: 18 cost time: 21.722800731658936
Epoch: 18, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
Validation loss decreased (-0.315469 --> -0.315469).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.2556031
	speed: 0.4765s/iter; left time: 5970.5090s
Epoch: 19 cost time: 22.45598554611206
Epoch: 19, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.2315583
	speed: 0.4758s/iter; left time: 5887.5048s
Epoch: 20 cost time: 22.2679660320282
Epoch: 20, Steps: 154 | Train Loss: 2.150 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3252285
	speed: 0.4432s/iter; left time: 5416.5989s
Epoch: 21 cost time: 20.055900812149048
Epoch: 21, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.199 Vali Acc: 0.315 Test Loss: 2.199 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.6742041
	speed: 0.4671s/iter; left time: 5635.9497s
Epoch: 22 cost time: 21.673059701919556
Epoch: 22, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.218 Vali Acc: 0.315 Test Loss: 2.218 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.1875486
	speed: 0.4702s/iter; left time: 5601.4051s
Epoch: 23 cost time: 22.574671983718872
Epoch: 23, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.4257689
	speed: 0.4589s/iter; left time: 5396.2079s
Epoch: 24 cost time: 20.33737850189209
Epoch: 24, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.236 Vali Acc: 0.315 Test Loss: 2.236 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.2707431
	speed: 0.4727s/iter; left time: 5485.6260s
Epoch: 25 cost time: 22.011247634887695
Epoch: 25, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.9053349
	speed: 0.4487s/iter; left time: 5137.7647s
Epoch: 26 cost time: 21.156923532485962
Epoch: 26, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.9812883
	speed: 0.4472s/iter; left time: 5051.4551s
Epoch: 27 cost time: 20.84805965423584
Epoch: 27, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.0211296
	speed: 0.4856s/iter; left time: 5410.9205s
Epoch: 28 cost time: 22.895512104034424
Epoch: 28, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.31549067315490675
model parameter : 11915338
model size : 50.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9334357
	speed: 0.1749s/iter; left time: 2675.4833s
Epoch: 1 cost time: 24.116356134414673
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.214 Vali Acc: 0.316 Test Loss: 2.214 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2903390
	speed: 0.4498s/iter; left time: 6813.0846s
Epoch: 2 cost time: 22.713538646697998
Epoch: 2, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.179 Vali Acc: 0.171 Test Loss: 2.179 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4684846
	speed: 0.4623s/iter; left time: 6931.1665s
Epoch: 3 cost time: 22.302443981170654
Epoch: 3, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.201 Vali Acc: 0.322 Test Loss: 2.201 Test Acc: 0.322
Validation loss decreased (-0.315874 --> -0.321551).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4053538
	speed: 0.4795s/iter; left time: 7114.6050s
Epoch: 4 cost time: 21.685866594314575
Epoch: 4, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.252 Vali Acc: 0.110 Test Loss: 2.252 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8567034
	speed: 0.4907s/iter; left time: 7205.5515s
Epoch: 5 cost time: 22.741212129592896
Epoch: 5, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3212914
	speed: 0.4597s/iter; left time: 6679.8619s
Epoch: 6 cost time: 20.859362840652466
Epoch: 6, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.190 Vali Acc: 0.315 Test Loss: 2.190 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.9076757
	speed: 0.4760s/iter; left time: 6843.5796s
Epoch: 7 cost time: 22.111201763153076
Epoch: 7, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.222 Vali Acc: 0.315 Test Loss: 2.222 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.6504269
	speed: 0.4659s/iter; left time: 6626.3390s
Epoch: 8 cost time: 20.572000741958618
Epoch: 8, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.0117481
	speed: 0.4843s/iter; left time: 6813.2047s
Epoch: 9 cost time: 22.079662561416626
Epoch: 9, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.1321995
	speed: 0.4659s/iter; left time: 6483.3214s
Epoch: 10 cost time: 20.490070581436157
Epoch: 10, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.162 Vali Acc: 0.315 Test Loss: 2.162 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.4290154
	speed: 0.4888s/iter; left time: 6726.1585s
Epoch: 11 cost time: 22.677842617034912
Epoch: 11, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.5590408
	speed: 0.4633s/iter; left time: 6303.8537s
Epoch: 12 cost time: 21.161386013031006
Epoch: 12, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.2701852
	speed: 0.4820s/iter; left time: 6484.6669s
Epoch: 13 cost time: 21.245600700378418
Epoch: 13, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.321573398215734
model parameter : 10738762
model size : 46.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3136258
	speed: 0.1615s/iter; left time: 2471.3312s
Epoch: 1 cost time: 24.0225191116333
Epoch: 1, Steps: 154 | Train Loss: 2.250 Vali Loss: 2.245 Vali Acc: 0.315 Test Loss: 2.245 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8786553
	speed: 0.4794s/iter; left time: 7261.5073s
Epoch: 2 cost time: 20.329345703125
Epoch: 2, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.213 Vali Acc: 0.319 Test Loss: 2.213 Test Acc: 0.319
Validation loss decreased (-0.315468 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8254553
	speed: 0.4708s/iter; left time: 7058.6110s
Epoch: 3 cost time: 19.88948917388916
Epoch: 3, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.165 Vali Acc: 0.318 Test Loss: 2.165 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6660337
	speed: 0.4403s/iter; left time: 6533.9937s
Epoch: 4 cost time: 21.221368551254272
Epoch: 4, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.172 Vali Acc: 0.325 Test Loss: 2.172 Test Acc: 0.325
Validation loss decreased (-0.318713 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9479445
	speed: 0.4919s/iter; left time: 7223.6315s
Epoch: 5 cost time: 22.795024156570435
Epoch: 5, Steps: 154 | Train Loss: 2.265 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2981489
	speed: 0.4808s/iter; left time: 6985.9504s
Epoch: 6 cost time: 22.108373165130615
Epoch: 6, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.5104160
	speed: 0.4731s/iter; left time: 6801.9376s
Epoch: 7 cost time: 21.647665977478027
Epoch: 7, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.6582582
	speed: 0.4647s/iter; left time: 6609.6102s
Epoch: 8 cost time: 21.140977382659912
Epoch: 8, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.2302198
	speed: 0.4575s/iter; left time: 6437.1949s
Epoch: 9 cost time: 20.465654850006104
Epoch: 9, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.2690656
	speed: 0.4433s/iter; left time: 6169.1067s
Epoch: 10 cost time: 21.232179403305054
Epoch: 10, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.1569078
	speed: 0.4750s/iter; left time: 6536.2090s
Epoch: 11 cost time: 21.829134941101074
Epoch: 11, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.6575036
	speed: 0.4655s/iter; left time: 6334.6098s
Epoch: 12 cost time: 23.719788789749146
Epoch: 12, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.2779891
	speed: 0.4691s/iter; left time: 6311.4103s
Epoch: 13 cost time: 21.05682945251465
Epoch: 13, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.4676704
	speed: 0.4851s/iter; left time: 6451.8362s
Epoch: 14 cost time: 21.943917512893677
Epoch: 14, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.254 Vali Acc: 0.315 Test Loss: 2.254 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3248175182481752
model parameter : 10736970
model size : 46.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7970603
	speed: 0.1620s/iter; left time: 2478.2728s
Epoch: 1 cost time: 22.729609966278076
Epoch: 1, Steps: 154 | Train Loss: 2.284 Vali Loss: 2.216 Vali Acc: 0.316 Test Loss: 2.216 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3216040
	speed: 0.4469s/iter; left time: 6769.7234s
Epoch: 2 cost time: 20.892289876937866
Epoch: 2, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.193 Vali Acc: 0.318 Test Loss: 2.193 Test Acc: 0.318
Validation loss decreased (-0.315874 --> -0.317902).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9828752
	speed: 0.4513s/iter; left time: 6765.6310s
Epoch: 3 cost time: 18.96766209602356
Epoch: 3, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.157 Vali Acc: 0.319 Test Loss: 2.157 Test Acc: 0.319
Validation loss decreased (-0.317902 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6884828
	speed: 0.4248s/iter; left time: 6303.6198s
Epoch: 4 cost time: 18.964620113372803
Epoch: 4, Steps: 154 | Train Loss: 2.264 Vali Loss: 2.207 Vali Acc: 0.316 Test Loss: 2.207 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7083316
	speed: 0.4258s/iter; left time: 6252.7165s
Epoch: 5 cost time: 19.792649269104004
Epoch: 5, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9505595
	speed: 0.4257s/iter; left time: 6185.6243s
Epoch: 6 cost time: 19.085819005966187
Epoch: 6, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1013126
	speed: 0.4400s/iter; left time: 6325.6560s
Epoch: 7 cost time: 20.20421862602234
Epoch: 7, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.8713961
	speed: 0.4203s/iter; left time: 5978.0256s
Epoch: 8 cost time: 18.886422395706177
Epoch: 8, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3588018
	speed: 0.4404s/iter; left time: 6195.4247s
Epoch: 9 cost time: 21.047594785690308
Epoch: 9, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.0928218
	speed: 0.4601s/iter; left time: 6401.9108s
Epoch: 10 cost time: 20.759880542755127
Epoch: 10, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.9149663
	speed: 0.4309s/iter; left time: 5930.1774s
Epoch: 11 cost time: 19.661221504211426
Epoch: 11, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.1190889
	speed: 0.4148s/iter; left time: 5644.0418s
Epoch: 12 cost time: 19.827394008636475
Epoch: 12, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.9613575
	speed: 0.4195s/iter; left time: 5642.9993s
Epoch: 13 cost time: 20.425484657287598
Epoch: 13, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.31873479318734793
model parameter : 10735178
model size : 46.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7277944
	speed: 0.1871s/iter; left time: 2863.0985s
Epoch: 1 cost time: 27.09823513031006
Epoch: 1, Steps: 154 | Train Loss: 2.288 Vali Loss: 2.226 Vali Acc: 0.155 Test Loss: 2.226 Test Acc: 0.155
Validation loss decreased (inf --> -0.154884).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9007542
	speed: 0.4971s/iter; left time: 7529.1678s
Epoch: 2 cost time: 22.47860360145569
Epoch: 2, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.213 Vali Acc: 0.318 Test Loss: 2.213 Test Acc: 0.318
Validation loss decreased (-0.154884 --> -0.317902).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7973491
	speed: 0.4493s/iter; left time: 6736.7160s
Epoch: 3 cost time: 18.20480704307556
Epoch: 3, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.189 Vali Acc: 0.326 Test Loss: 2.189 Test Acc: 0.326
Validation loss decreased (-0.317902 --> -0.326418).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2487962
	speed: 0.4694s/iter; left time: 6964.9014s
Epoch: 4 cost time: 21.157188177108765
Epoch: 4, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.204 Vali Acc: 0.315 Test Loss: 2.204 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8121612
	speed: 0.4325s/iter; left time: 6351.3378s
Epoch: 5 cost time: 20.488905906677246
Epoch: 5, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.6123753
	speed: 0.4368s/iter; left time: 6347.5682s
Epoch: 6 cost time: 21.05012083053589
Epoch: 6, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3188744
	speed: 0.4511s/iter; left time: 6485.6130s
Epoch: 7 cost time: 21.09904170036316
Epoch: 7, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.2307937
	speed: 0.4559s/iter; left time: 6484.3724s
Epoch: 8 cost time: 21.993339776992798
Epoch: 8, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8882786
	speed: 0.4811s/iter; left time: 6768.0374s
Epoch: 9 cost time: 22.232770919799805
Epoch: 9, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.1610126
	speed: 0.4515s/iter; left time: 6283.1434s
Epoch: 10 cost time: 21.582011222839355
Epoch: 10, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.0966780
	speed: 0.4563s/iter; left time: 6279.5660s
Epoch: 11 cost time: 21.41416573524475
Epoch: 11, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.184 Vali Acc: 0.315 Test Loss: 2.184 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.9914569
	speed: 0.4700s/iter; left time: 6395.6309s
Epoch: 12 cost time: 22.806965112686157
Epoch: 12, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.3024302
	speed: 0.4569s/iter; left time: 6147.0778s
Epoch: 13 cost time: 21.24973773956299
Epoch: 13, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3264395782643958
model parameter : 10733386
model size : 46.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0095763
	speed: 0.1682s/iter; left time: 2574.1459s
Epoch: 1 cost time: 23.943581104278564
Epoch: 1, Steps: 154 | Train Loss: 2.280 Vali Loss: 2.246 Vali Acc: 0.316 Test Loss: 2.246 Test Acc: 0.316
Validation loss decreased (inf --> -0.316279).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5528926
	speed: 0.4801s/iter; left time: 7272.5402s
Epoch: 2 cost time: 22.013286113739014
Epoch: 2, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.210 Vali Acc: 0.331 Test Loss: 2.210 Test Acc: 0.331
Validation loss decreased (-0.316279 --> -0.331284).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7890112
	speed: 0.4743s/iter; left time: 7110.8408s
Epoch: 3 cost time: 20.73720622062683
Epoch: 3, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.197 Vali Acc: 0.323 Test Loss: 2.197 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6136537
	speed: 0.4599s/iter; left time: 6823.8565s
Epoch: 4 cost time: 21.165382385253906
Epoch: 4, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.199 Vali Acc: 0.320 Test Loss: 2.199 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.9438061
	speed: 0.4551s/iter; left time: 6683.6666s
Epoch: 5 cost time: 19.965779542922974
Epoch: 5, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.199 Vali Acc: 0.169 Test Loss: 2.199 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.4958394
	speed: 0.4242s/iter; left time: 6164.7683s
Epoch: 6 cost time: 17.702369451522827
Epoch: 6, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.145 Vali Acc: 0.321 Test Loss: 2.145 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.9264987
	speed: 0.4077s/iter; left time: 5860.8535s
Epoch: 7 cost time: 20.613897800445557
Epoch: 7, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.193 Vali Acc: 0.316 Test Loss: 2.193 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.4717164
	speed: 0.4577s/iter; left time: 6509.4266s
Epoch: 8 cost time: 20.215455770492554
Epoch: 8, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.225 Vali Acc: 0.315 Test Loss: 2.225 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.9824409
	speed: 0.4495s/iter; left time: 6323.4172s
Epoch: 9 cost time: 20.49413251876831
Epoch: 9, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.191 Vali Acc: 0.315 Test Loss: 2.191 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.5092838
	speed: 0.4424s/iter; left time: 6155.9251s
Epoch: 10 cost time: 20.840460300445557
Epoch: 10, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.7467782
	speed: 0.4604s/iter; left time: 6335.5858s
Epoch: 11 cost time: 20.728952407836914
Epoch: 11, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.8747522
	speed: 0.4378s/iter; left time: 5957.6893s
Epoch: 12 cost time: 19.888627529144287
Epoch: 12, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3313057583130576
model parameter : 10147786
model size : 43.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2864904
	speed: 0.1474s/iter; left time: 2254.8412s
Epoch: 1 cost time: 21.44053077697754
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.268 Vali Acc: 0.315 Test Loss: 2.268 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8417448
	speed: 0.4247s/iter; left time: 6432.5466s
Epoch: 2 cost time: 19.673588514328003
Epoch: 2, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.215 Vali Acc: 0.324 Test Loss: 2.215 Test Acc: 0.324
Validation loss decreased (-0.315062 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8684425
	speed: 0.4318s/iter; left time: 6474.2139s
Epoch: 3 cost time: 18.94824504852295
Epoch: 3, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.197 Vali Acc: 0.328 Test Loss: 2.197 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4128141
	speed: 0.4548s/iter; left time: 6748.1423s
Epoch: 4 cost time: 22.051188230514526
Epoch: 4, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.153 Vali Acc: 0.322 Test Loss: 2.153 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.8926492
	speed: 0.4491s/iter; left time: 6595.4274s
Epoch: 5 cost time: 20.625402212142944
Epoch: 5, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.329 Vali Acc: 0.315 Test Loss: 2.329 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0990820
	speed: 0.4431s/iter; left time: 6439.1366s
Epoch: 6 cost time: 20.25491738319397
Epoch: 6, Steps: 154 | Train Loss: 2.197 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2850590
	speed: 0.4195s/iter; left time: 6030.9633s
Epoch: 7 cost time: 19.24674129486084
Epoch: 7, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.8716041
	speed: 0.4323s/iter; left time: 6148.5735s
Epoch: 8 cost time: 19.633902072906494
Epoch: 8, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.1590974
	speed: 0.4238s/iter; left time: 5961.8750s
Epoch: 9 cost time: 17.853654384613037
Epoch: 9, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.243 Vali Acc: 0.315 Test Loss: 2.243 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.9761525
	speed: 0.3764s/iter; left time: 5238.1020s
Epoch: 10 cost time: 19.074795722961426
Epoch: 10, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.191 Vali Acc: 0.315 Test Loss: 2.191 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.2225242
	speed: 0.4102s/iter; left time: 5644.3864s
Epoch: 11 cost time: 17.39615511894226
Epoch: 11, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.0128233
	speed: 0.4002s/iter; left time: 5445.8276s
Epoch: 12 cost time: 19.519815921783447
Epoch: 12, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.9841992
	speed: 0.4286s/iter; left time: 5766.1529s
Epoch: 13 cost time: 20.133342742919922
Epoch: 13, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3284671532846715
model parameter : 10145994
model size : 43.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2749934
	speed: 0.1631s/iter; left time: 2495.4297s
Epoch: 1 cost time: 23.89266586303711
Epoch: 1, Steps: 154 | Train Loss: 2.295 Vali Loss: 2.239 Vali Acc: 0.315 Test Loss: 2.239 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6504176
	speed: 0.4580s/iter; left time: 6936.6213s
Epoch: 2 cost time: 20.402843952178955
Epoch: 2, Steps: 154 | Train Loss: 2.212 Vali Loss: 2.508 Vali Acc: 0.155 Test Loss: 2.508 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8471217
	speed: 0.4641s/iter; left time: 6958.9007s
Epoch: 3 cost time: 21.515022039413452
Epoch: 3, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.199 Vali Acc: 0.323 Test Loss: 2.199 Test Acc: 0.323
Validation loss decreased (-0.315063 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2197087
	speed: 0.4731s/iter; left time: 7021.0701s
Epoch: 4 cost time: 22.09327745437622
Epoch: 4, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.171 Vali Acc: 0.326 Test Loss: 2.171 Test Acc: 0.326
Validation loss decreased (-0.322768 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2800634
	speed: 0.4992s/iter; left time: 7330.8305s
Epoch: 5 cost time: 23.49820613861084
Epoch: 5, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.275 Vali Acc: 0.315 Test Loss: 2.275 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7988489
	speed: 0.4927s/iter; left time: 7158.9685s
Epoch: 6 cost time: 24.19032311439514
Epoch: 6, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.209 Vali Acc: 0.315 Test Loss: 2.209 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.6377008
	speed: 0.4944s/iter; left time: 7108.0164s
Epoch: 7 cost time: 23.403993368148804
Epoch: 7, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.272 Vali Acc: 0.315 Test Loss: 2.272 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.0886266
	speed: 0.4884s/iter; left time: 6946.2953s
Epoch: 8 cost time: 23.213727474212646
Epoch: 8, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.208 Vali Acc: 0.315 Test Loss: 2.208 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0827057
	speed: 0.4911s/iter; left time: 6909.9060s
Epoch: 9 cost time: 22.076944828033447
Epoch: 9, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.214 Vali Acc: 0.155 Test Loss: 2.214 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3888886
	speed: 0.4644s/iter; left time: 6462.5725s
Epoch: 10 cost time: 22.346601486206055
Epoch: 10, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.6344051
	speed: 0.4835s/iter; left time: 6652.9530s
Epoch: 11 cost time: 23.060271739959717
Epoch: 11, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.0106339
	speed: 0.4708s/iter; left time: 6406.5738s
Epoch: 12 cost time: 22.594504356384277
Epoch: 12, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.200 Vali Acc: 0.315 Test Loss: 2.200 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.1994026
	speed: 0.4548s/iter; left time: 6118.1300s
Epoch: 13 cost time: 20.972915649414062
Epoch: 13, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.4268377
	speed: 0.4868s/iter; left time: 6473.7571s
Epoch: 14 cost time: 22.511260271072388
Epoch: 14, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.32562854825628545
model parameter : 10144202
model size : 43.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0288763
	speed: 0.1495s/iter; left time: 2286.7644s
Epoch: 1 cost time: 23.224872827529907
Epoch: 1, Steps: 154 | Train Loss: 2.238 Vali Loss: 2.244 Vali Acc: 0.155 Test Loss: 2.244 Test Acc: 0.155
Validation loss decreased (inf --> -0.155290).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9936602
	speed: 0.4967s/iter; left time: 7523.7330s
Epoch: 2 cost time: 22.639317750930786
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.275 Vali Acc: 0.323 Test Loss: 2.275 Test Acc: 0.323
Validation loss decreased (-0.155290 --> -0.323173).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8450000
	speed: 0.4702s/iter; left time: 7049.3854s
Epoch: 3 cost time: 21.002182722091675
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.100 Vali Acc: 0.348 Test Loss: 2.100 Test Acc: 0.348
Validation loss decreased (-0.323173 --> -0.348316).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9625454
	speed: 0.4879s/iter; left time: 7240.5057s
Epoch: 4 cost time: 23.34611177444458
Epoch: 4, Steps: 154 | Train Loss: 1.929 Vali Loss: 1.994 Vali Acc: 0.368 Test Loss: 1.994 Test Acc: 0.368
Validation loss decreased (-0.348316 --> -0.367782).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7515433
	speed: 0.5112s/iter; left time: 7506.6748s
Epoch: 5 cost time: 23.437242031097412
Epoch: 5, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.108 Vali Acc: 0.357 Test Loss: 2.108 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7922611
	speed: 0.4745s/iter; left time: 6894.9694s
Epoch: 6 cost time: 21.953481435775757
Epoch: 6, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.125 Vali Acc: 0.352 Test Loss: 2.125 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0473647
	speed: 0.4749s/iter; left time: 6827.2750s
Epoch: 7 cost time: 21.856240034103394
Epoch: 7, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.005 Vali Acc: 0.363 Test Loss: 2.005 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7777158
	speed: 0.4415s/iter; left time: 6280.1407s
Epoch: 8 cost time: 20.59700894355774
Epoch: 8, Steps: 154 | Train Loss: 2.101 Vali Loss: 2.303 Vali Acc: 0.126 Test Loss: 2.303 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3604021
	speed: 0.4488s/iter; left time: 6314.6296s
Epoch: 9 cost time: 20.98332953453064
Epoch: 9, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3399630
	speed: 0.4838s/iter; left time: 6731.7898s
Epoch: 10 cost time: 23.206750869750977
Epoch: 10, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.184 Vali Acc: 0.315 Test Loss: 2.184 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.5450587
	speed: 0.4676s/iter; left time: 6434.6429s
Epoch: 11 cost time: 22.030006170272827
Epoch: 11, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.7965220
	speed: 0.4977s/iter; left time: 6772.1583s
Epoch: 12 cost time: 22.117703914642334
Epoch: 12, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.1089714
	speed: 0.4779s/iter; left time: 6429.6401s
Epoch: 13 cost time: 21.31241226196289
Epoch: 13, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.3399646
	speed: 0.4873s/iter; left time: 6480.2579s
Epoch: 14 cost time: 22.0193088054657
Epoch: 14, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 10142410
model size : 43.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0246959
	speed: 0.1556s/iter; left time: 2380.4576s
Epoch: 1 cost time: 22.913390398025513
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.187 Vali Acc: 0.316 Test Loss: 2.187 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8842155
	speed: 0.4442s/iter; left time: 6728.8198s
Epoch: 2 cost time: 20.73785662651062
Epoch: 2, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.190 Vali Acc: 0.320 Test Loss: 2.190 Test Acc: 0.320
Validation loss decreased (-0.316280 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8035173
	speed: 0.4645s/iter; left time: 6964.3999s
Epoch: 3 cost time: 20.764068603515625
Epoch: 3, Steps: 154 | Train Loss: 2.074 Vali Loss: 2.077 Vali Acc: 0.327 Test Loss: 2.077 Test Acc: 0.327
Validation loss decreased (-0.320335 --> -0.327230).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7909288
	speed: 0.4537s/iter; left time: 6732.8160s
Epoch: 4 cost time: 21.44786047935486
Epoch: 4, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.154 Vali Acc: 0.319 Test Loss: 2.154 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7576582
	speed: 0.4555s/iter; left time: 6689.1987s
Epoch: 5 cost time: 19.671621561050415
Epoch: 5, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.100 Vali Acc: 0.331 Test Loss: 2.100 Test Acc: 0.331
Validation loss decreased (-0.327230 --> -0.330879).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0889473
	speed: 0.4382s/iter; left time: 6366.8818s
Epoch: 6 cost time: 20.002564191818237
Epoch: 6, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.119 Vali Acc: 0.328 Test Loss: 2.119 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6487560
	speed: 0.4366s/iter; left time: 6276.8019s
Epoch: 7 cost time: 19.397149324417114
Epoch: 7, Steps: 154 | Train Loss: 2.035 Vali Loss: 2.111 Vali Acc: 0.328 Test Loss: 2.111 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1762052
	speed: 0.4320s/iter; left time: 6144.6526s
Epoch: 8 cost time: 20.228243350982666
Epoch: 8, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.099 Vali Acc: 0.330 Test Loss: 2.099 Test Acc: 0.330
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.2824917
	speed: 0.4446s/iter; left time: 6254.6556s
Epoch: 9 cost time: 19.38193988800049
Epoch: 9, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.145 Vali Acc: 0.320 Test Loss: 2.145 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.0289533
	speed: 0.4379s/iter; left time: 6093.8607s
Epoch: 10 cost time: 20.81412434577942
Epoch: 10, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.168 Vali Acc: 0.321 Test Loss: 2.168 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.7879663
	speed: 0.4118s/iter; left time: 5666.1071s
Epoch: 11 cost time: 19.18275237083435
Epoch: 11, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.139 Vali Acc: 0.170 Test Loss: 2.139 Test Acc: 0.170
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.4248590
	speed: 0.4180s/iter; left time: 5688.0141s
Epoch: 12 cost time: 18.769389629364014
Epoch: 12, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.168 Vali Acc: 0.321 Test Loss: 2.168 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.0808733
	speed: 0.4398s/iter; left time: 5916.4882s
Epoch: 13 cost time: 19.817574739456177
Epoch: 13, Steps: 154 | Train Loss: 2.074 Vali Loss: 2.126 Vali Acc: 0.324 Test Loss: 2.126 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.0705249
	speed: 0.4237s/iter; left time: 5634.7286s
Epoch: 14 cost time: 20.155526638031006
Epoch: 14, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.189 Vali Acc: 0.167 Test Loss: 2.189 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.0461650
	speed: 0.4583s/iter; left time: 6024.3844s
Epoch: 15 cost time: 21.84165358543396
Epoch: 15, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.252 Vali Acc: 0.318 Test Loss: 2.252 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3309002433090024
model parameter : 4787658
model size : 20.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1758854
	speed: 0.1475s/iter; left time: 2257.0679s
Epoch: 1 cost time: 21.9733829498291
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.180 Vali Acc: 0.320 Test Loss: 2.180 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5582666
	speed: 0.4372s/iter; left time: 6622.9225s
Epoch: 2 cost time: 20.97149968147278
Epoch: 2, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.136 Vali Acc: 0.324 Test Loss: 2.136 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6644349
	speed: 0.4427s/iter; left time: 6636.8359s
Epoch: 3 cost time: 20.6525936126709
Epoch: 3, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.162 Vali Acc: 0.321 Test Loss: 2.162 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6494613
	speed: 0.4414s/iter; left time: 6549.5136s
Epoch: 4 cost time: 19.0130558013916
Epoch: 4, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.200 Vali Acc: 0.317 Test Loss: 2.200 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.2666354
	speed: 0.4138s/iter; left time: 6076.2210s
Epoch: 5 cost time: 17.9878032207489
Epoch: 5, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.153 Vali Acc: 0.322 Test Loss: 2.153 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.4557569
	speed: 0.4291s/iter; left time: 6235.5467s
Epoch: 6 cost time: 20.81011939048767
Epoch: 6, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.178 Vali Acc: 0.322 Test Loss: 2.178 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.9979285
	speed: 0.4504s/iter; left time: 6475.0311s
Epoch: 7 cost time: 19.457235097885132
Epoch: 7, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.0392141
	speed: 0.4354s/iter; left time: 6192.9161s
Epoch: 8 cost time: 19.40398359298706
Epoch: 8, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.6985836
	speed: 0.3979s/iter; left time: 5598.0324s
Epoch: 9 cost time: 18.86649990081787
Epoch: 9, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.190 Vali Acc: 0.315 Test Loss: 2.190 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.7814373
	speed: 0.4107s/iter; left time: 5714.3824s
Epoch: 10 cost time: 20.51315188407898
Epoch: 10, Steps: 154 | Train Loss: 2.177 Vali Loss: 2.147 Vali Acc: 0.315 Test Loss: 2.147 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.4741082
	speed: 0.4397s/iter; left time: 6050.0769s
Epoch: 11 cost time: 19.846334218978882
Epoch: 11, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.6193907
	speed: 0.4251s/iter; left time: 5784.4319s
Epoch: 12 cost time: 19.820388793945312
Epoch: 12, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3236009732360097
model parameter : 4786762
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9290662
	speed: 0.1480s/iter; left time: 2264.0046s
Epoch: 1 cost time: 21.628609657287598
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.241 Vali Acc: 0.315 Test Loss: 2.241 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4715967
	speed: 0.4544s/iter; left time: 6883.3651s
Epoch: 2 cost time: 21.750297784805298
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.176 Vali Acc: 0.325 Test Loss: 2.176 Test Acc: 0.325
Validation loss decreased (-0.315063 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7743309
	speed: 0.4823s/iter; left time: 7231.8453s
Epoch: 3 cost time: 22.15776038169861
Epoch: 3, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.184 Vali Acc: 0.329 Test Loss: 2.184 Test Acc: 0.329
Validation loss decreased (-0.324796 --> -0.328851).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7099452
	speed: 0.4494s/iter; left time: 6668.2062s
Epoch: 4 cost time: 20.576469659805298
Epoch: 4, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.373 Vali Acc: 0.169 Test Loss: 2.373 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9982517
	speed: 0.4574s/iter; left time: 6717.0463s
Epoch: 5 cost time: 19.997605800628662
Epoch: 5, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.184 Vali Acc: 0.334 Test Loss: 2.184 Test Acc: 0.334
Validation loss decreased (-0.328851 --> -0.334123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9136677
	speed: 0.4891s/iter; left time: 7107.3790s
Epoch: 6 cost time: 23.150688409805298
Epoch: 6, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.151 Vali Acc: 0.359 Test Loss: 2.151 Test Acc: 0.359
Validation loss decreased (-0.334123 --> -0.359265).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6406757
	speed: 0.4683s/iter; left time: 6733.4588s
Epoch: 7 cost time: 21.077374696731567
Epoch: 7, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.304 Vali Acc: 0.307 Test Loss: 2.304 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4766158
	speed: 0.4947s/iter; left time: 7036.8186s
Epoch: 8 cost time: 22.99771237373352
Epoch: 8, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.211 Vali Acc: 0.359 Test Loss: 2.211 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1867042
	speed: 0.4919s/iter; left time: 6921.0458s
Epoch: 9 cost time: 22.172197103500366
Epoch: 9, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.396 Vali Acc: 0.203 Test Loss: 2.396 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4811774
	speed: 0.4612s/iter; left time: 6417.3730s
Epoch: 10 cost time: 20.957326412200928
Epoch: 10, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.101 Vali Acc: 0.372 Test Loss: 2.101 Test Acc: 0.372
Validation loss decreased (-0.359265 --> -0.372242).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8632207
	speed: 0.4570s/iter; left time: 6289.4514s
Epoch: 11 cost time: 22.356560707092285
Epoch: 11, Steps: 154 | Train Loss: 1.708 Vali Loss: 3.134 Vali Acc: 0.118 Test Loss: 3.134 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6087421
	speed: 0.4746s/iter; left time: 6458.2387s
Epoch: 12 cost time: 20.680872201919556
Epoch: 12, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.189 Vali Acc: 0.383 Test Loss: 2.189 Test Acc: 0.383
Validation loss decreased (-0.372242 --> -0.383190).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5224185
	speed: 0.4734s/iter; left time: 6369.0463s
Epoch: 13 cost time: 21.203431606292725
Epoch: 13, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.250 Vali Acc: 0.353 Test Loss: 2.250 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4209467
	speed: 0.4606s/iter; left time: 6125.6857s
Epoch: 14 cost time: 22.3497896194458
Epoch: 14, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.406 Vali Acc: 0.368 Test Loss: 2.406 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7181425
	speed: 0.4696s/iter; left time: 6172.3873s
Epoch: 15 cost time: 22.752557039260864
Epoch: 15, Steps: 154 | Train Loss: 1.669 Vali Loss: 3.207 Vali Acc: 0.099 Test Loss: 3.207 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.9724753
	speed: 0.4899s/iter; left time: 6364.8574s
Epoch: 16 cost time: 22.691251277923584
Epoch: 16, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.064 Vali Acc: 0.368 Test Loss: 2.064 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.5533705
	speed: 0.4562s/iter; left time: 5855.9526s
Epoch: 17 cost time: 20.765482664108276
Epoch: 17, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.0377982
	speed: 0.4679s/iter; left time: 5934.8618s
Epoch: 18 cost time: 20.805145502090454
Epoch: 18, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.147 Vali Acc: 0.315 Test Loss: 2.147 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.6788142
	speed: 0.4623s/iter; left time: 5791.9096s
Epoch: 19 cost time: 22.451754808425903
Epoch: 19, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3570514
	speed: 0.4515s/iter; left time: 5587.8607s
Epoch: 20 cost time: 22.193177223205566
Epoch: 20, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.4377625
	speed: 0.4687s/iter; left time: 5728.4752s
Epoch: 21 cost time: 20.545713663101196
Epoch: 21, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.2292936
	speed: 0.5021s/iter; left time: 6059.2459s
Epoch: 22 cost time: 22.54666018486023
Epoch: 22, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 4785866
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8710444
	speed: 0.1484s/iter; left time: 2270.2994s
Epoch: 1 cost time: 21.37807869911194
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.124 Vali Acc: 0.326 Test Loss: 2.124 Test Acc: 0.326
Validation loss decreased (inf --> -0.325607).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3016734
	speed: 0.4449s/iter; left time: 6738.8496s
Epoch: 2 cost time: 20.401507139205933
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.134 Vali Acc: 0.338 Test Loss: 2.134 Test Acc: 0.338
Validation loss decreased (-0.325607 --> -0.338178).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7883992
	speed: 0.4639s/iter; left time: 6955.1014s
Epoch: 3 cost time: 21.608956575393677
Epoch: 3, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.079 Vali Acc: 0.356 Test Loss: 2.079 Test Acc: 0.356
Validation loss decreased (-0.338178 --> -0.356021).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0890536
	speed: 0.4717s/iter; left time: 6999.0428s
Epoch: 4 cost time: 21.118039846420288
Epoch: 4, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.108 Vali Acc: 0.343 Test Loss: 2.108 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2924404
	speed: 0.4397s/iter; left time: 6457.4220s
Epoch: 5 cost time: 19.7287335395813
Epoch: 5, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.278 Vali Acc: 0.164 Test Loss: 2.278 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1245782
	speed: 0.4370s/iter; left time: 6349.4746s
Epoch: 6 cost time: 20.076253652572632
Epoch: 6, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.071 Vali Acc: 0.343 Test Loss: 2.071 Test Acc: 0.343
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1640208
	speed: 0.4385s/iter; left time: 6304.8885s
Epoch: 7 cost time: 20.13983726501465
Epoch: 7, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.211 Vali Acc: 0.355 Test Loss: 2.211 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.7067201
	speed: 0.4478s/iter; left time: 6369.6075s
Epoch: 8 cost time: 20.660248279571533
Epoch: 8, Steps: 154 | Train Loss: 1.916 Vali Loss: 1.986 Vali Acc: 0.355 Test Loss: 1.986 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.4944322
	speed: 0.4282s/iter; left time: 6024.5986s
Epoch: 9 cost time: 18.36484122276306
Epoch: 9, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.453 Vali Acc: 0.335 Test Loss: 2.453 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.0085790
	speed: 0.4220s/iter; left time: 5872.2821s
Epoch: 10 cost time: 19.065728664398193
Epoch: 10, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.029 Vali Acc: 0.365 Test Loss: 2.029 Test Acc: 0.365
Validation loss decreased (-0.356021 --> -0.364943).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7522278
	speed: 0.4492s/iter; left time: 6181.0890s
Epoch: 11 cost time: 21.68901228904724
Epoch: 11, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.122 Vali Acc: 0.355 Test Loss: 2.122 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4894216
	speed: 0.4621s/iter; left time: 6287.4376s
Epoch: 12 cost time: 19.986938953399658
Epoch: 12, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.055 Vali Acc: 0.362 Test Loss: 2.055 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7767699
	speed: 0.4498s/iter; left time: 6050.8977s
Epoch: 13 cost time: 19.88846206665039
Epoch: 13, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.028 Vali Acc: 0.355 Test Loss: 2.028 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0427985
	speed: 0.4484s/iter; left time: 5963.5122s
Epoch: 14 cost time: 19.28155517578125
Epoch: 14, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.206 Vali Acc: 0.331 Test Loss: 2.206 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.2386000
	speed: 0.4303s/iter; left time: 5656.5502s
Epoch: 15 cost time: 19.90949249267578
Epoch: 15, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.167 Vali Acc: 0.319 Test Loss: 2.167 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.0007045
	speed: 0.4584s/iter; left time: 5955.5186s
Epoch: 16 cost time: 21.994317293167114
Epoch: 16, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.153 Vali Acc: 0.318 Test Loss: 2.153 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.4083230
	speed: 0.4657s/iter; left time: 5977.6349s
Epoch: 17 cost time: 20.794639587402344
Epoch: 17, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 2.4097540
	speed: 0.4466s/iter; left time: 5663.7594s
Epoch: 18 cost time: 20.411877632141113
Epoch: 18, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.164 Vali Acc: 0.318 Test Loss: 2.164 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.1224959
	speed: 0.4574s/iter; left time: 5730.8605s
Epoch: 19 cost time: 21.14983081817627
Epoch: 19, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.160 Vali Acc: 0.318 Test Loss: 2.160 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 2.1956959
	speed: 0.4581s/iter; left time: 5669.1193s
Epoch: 20 cost time: 20.55240249633789
Epoch: 20, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.146 Vali Acc: 0.318 Test Loss: 2.146 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36496350364963503
model parameter : 4784970
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2865138
	speed: 0.1376s/iter; left time: 2105.7729s
Epoch: 1 cost time: 20.2324321269989
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.181 Vali Acc: 0.318 Test Loss: 2.181 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4846034
	speed: 0.4443s/iter; left time: 6729.4074s
Epoch: 2 cost time: 20.981199741363525
Epoch: 2, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.180 Vali Acc: 0.320 Test Loss: 2.180 Test Acc: 0.320
Validation loss decreased (-0.317496 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8815640
	speed: 0.4064s/iter; left time: 6092.5659s
Epoch: 3 cost time: 18.40831446647644
Epoch: 3, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.136 Vali Acc: 0.321 Test Loss: 2.136 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.321147).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9526820
	speed: 0.4210s/iter; left time: 6247.6000s
Epoch: 4 cost time: 20.076159954071045
Epoch: 4, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.136 Vali Acc: 0.324 Test Loss: 2.136 Test Acc: 0.324
Validation loss decreased (-0.321147 --> -0.323985).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9834161
	speed: 0.4536s/iter; left time: 6660.9621s
Epoch: 5 cost time: 21.13116478919983
Epoch: 5, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.167 Vali Acc: 0.329 Test Loss: 2.167 Test Acc: 0.329
Validation loss decreased (-0.323985 --> -0.329257).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8928556
	speed: 0.4567s/iter; left time: 6636.2754s
Epoch: 6 cost time: 19.954209804534912
Epoch: 6, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.114 Vali Acc: 0.327 Test Loss: 2.114 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9691750
	speed: 0.4468s/iter; left time: 6423.5493s
Epoch: 7 cost time: 20.272449016571045
Epoch: 7, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.133 Vali Acc: 0.345 Test Loss: 2.133 Test Acc: 0.345
Validation loss decreased (-0.329257 --> -0.344666).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9365180
	speed: 0.4226s/iter; left time: 6010.1163s
Epoch: 8 cost time: 18.89664936065674
Epoch: 8, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.039 Vali Acc: 0.362 Test Loss: 2.039 Test Acc: 0.362
Validation loss decreased (-0.344666 --> -0.361699).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6686240
	speed: 0.4410s/iter; left time: 6205.1303s
Epoch: 9 cost time: 21.290769338607788
Epoch: 9, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.103 Vali Acc: 0.341 Test Loss: 2.103 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3602163
	speed: 0.4437s/iter; left time: 6173.7969s
Epoch: 10 cost time: 19.39125680923462
Epoch: 10, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9125438
	speed: 0.3937s/iter; left time: 5417.4567s
Epoch: 11 cost time: 18.740903854370117
Epoch: 11, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.159 Vali Acc: 0.365 Test Loss: 2.159 Test Acc: 0.365
Validation loss decreased (-0.361699 --> -0.364942).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0051396
	speed: 0.3918s/iter; left time: 5330.7921s
Epoch: 12 cost time: 17.958186149597168
Epoch: 12, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.111 Vali Acc: 0.364 Test Loss: 2.111 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6251189
	speed: 0.4202s/iter; left time: 5652.6432s
Epoch: 13 cost time: 19.427469491958618
Epoch: 13, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.232 Vali Acc: 0.370 Test Loss: 2.232 Test Acc: 0.370
Validation loss decreased (-0.364942 --> -0.370213).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3479898
	speed: 0.4434s/iter; left time: 5896.8899s
Epoch: 14 cost time: 20.504369974136353
Epoch: 14, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.178 Vali Acc: 0.329 Test Loss: 2.178 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4286940
	speed: 0.4489s/iter; left time: 5900.5428s
Epoch: 15 cost time: 20.74772047996521
Epoch: 15, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.040 Vali Acc: 0.363 Test Loss: 2.040 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6683404
	speed: 0.4300s/iter; left time: 5585.8578s
Epoch: 16 cost time: 19.074610710144043
Epoch: 16, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.274 Vali Acc: 0.362 Test Loss: 2.274 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.1535692
	speed: 0.4144s/iter; left time: 5319.7244s
Epoch: 17 cost time: 18.16863179206848
Epoch: 17, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.246 Vali Acc: 0.354 Test Loss: 2.246 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7779119
	speed: 0.4328s/iter; left time: 5489.6344s
Epoch: 18 cost time: 20.932302951812744
Epoch: 18, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.336 Vali Acc: 0.365 Test Loss: 2.336 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.6752378
	speed: 0.4316s/iter; left time: 5407.7344s
Epoch: 19 cost time: 19.674285888671875
Epoch: 19, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.527 Vali Acc: 0.347 Test Loss: 2.527 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.6261485
	speed: 0.4221s/iter; left time: 5223.4724s
Epoch: 20 cost time: 18.79265260696411
Epoch: 20, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.362 Vali Acc: 0.343 Test Loss: 2.362 Test Acc: 0.343
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.6463995
	speed: 0.4078s/iter; left time: 4983.2239s
Epoch: 21 cost time: 17.960111618041992
Epoch: 21, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.072 Vali Acc: 0.354 Test Loss: 2.072 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.3764522
	speed: 0.4145s/iter; left time: 5001.8225s
Epoch: 22 cost time: 19.530020236968994
Epoch: 22, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.075 Vali Acc: 0.343 Test Loss: 2.075 Test Acc: 0.343
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.8421737
	speed: 0.4164s/iter; left time: 4960.9793s
Epoch: 23 cost time: 18.510977029800415
Epoch: 23, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.173 Vali Acc: 0.325 Test Loss: 2.173 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 3603402
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2004580
	speed: 0.1465s/iter; left time: 2241.3614s
Epoch: 1 cost time: 21.676283597946167
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8813936
	speed: 0.4413s/iter; left time: 6683.7515s
Epoch: 2 cost time: 22.071070194244385
Epoch: 2, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.138 Vali Acc: 0.348 Test Loss: 2.138 Test Acc: 0.348
Validation loss decreased (-0.315469 --> -0.347910).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6516466
	speed: 0.4632s/iter; left time: 6944.7261s
Epoch: 3 cost time: 20.840590953826904
Epoch: 3, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.161 Vali Acc: 0.336 Test Loss: 2.161 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0497563
	speed: 0.4348s/iter; left time: 6452.5567s
Epoch: 4 cost time: 19.902856588363647
Epoch: 4, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.233 Vali Acc: 0.191 Test Loss: 2.233 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2467080
	speed: 0.4865s/iter; left time: 7144.0363s
Epoch: 5 cost time: 21.21568274497986
Epoch: 5, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.113 Vali Acc: 0.356 Test Loss: 2.113 Test Acc: 0.356
Validation loss decreased (-0.347910 --> -0.356427).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4335985
	speed: 0.4763s/iter; left time: 6920.8691s
Epoch: 6 cost time: 21.958799600601196
Epoch: 6, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.441 Vali Acc: 0.187 Test Loss: 2.441 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0491509
	speed: 0.4657s/iter; left time: 6695.4194s
Epoch: 7 cost time: 21.567956924438477
Epoch: 7, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.441 Vali Acc: 0.352 Test Loss: 2.441 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8705690
	speed: 0.4388s/iter; left time: 6240.3514s
Epoch: 8 cost time: 20.776265859603882
Epoch: 8, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.758 Vali Acc: 0.183 Test Loss: 2.758 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6198305
	speed: 0.4605s/iter; left time: 6479.3549s
Epoch: 9 cost time: 20.64516019821167
Epoch: 9, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.302 Vali Acc: 0.216 Test Loss: 2.302 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5976535
	speed: 0.4721s/iter; left time: 6569.1937s
Epoch: 10 cost time: 20.071915864944458
Epoch: 10, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.489 Vali Acc: 0.143 Test Loss: 2.489 Test Acc: 0.143
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2265654
	speed: 0.4283s/iter; left time: 5894.3200s
Epoch: 11 cost time: 20.397066831588745
Epoch: 11, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.704 Vali Acc: 0.163 Test Loss: 2.704 Test Acc: 0.163
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.7781899
	speed: 0.4612s/iter; left time: 6275.1355s
Epoch: 12 cost time: 21.523909330368042
Epoch: 12, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.157 Vali Acc: 0.350 Test Loss: 2.157 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.8353369
	speed: 0.4685s/iter; left time: 6302.9870s
Epoch: 13 cost time: 21.54670739173889
Epoch: 13, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.078 Vali Acc: 0.371 Test Loss: 2.078 Test Acc: 0.371
Validation loss decreased (-0.356427 --> -0.370620).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4945616
	speed: 0.4426s/iter; left time: 5886.5420s
Epoch: 14 cost time: 20.248568058013916
Epoch: 14, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.341 Vali Acc: 0.358 Test Loss: 2.341 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3838598
	speed: 0.4190s/iter; left time: 5508.2635s
Epoch: 15 cost time: 19.063568592071533
Epoch: 15, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.158 Vali Acc: 0.361 Test Loss: 2.158 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.9501936
	speed: 0.4602s/iter; left time: 5977.8560s
Epoch: 16 cost time: 20.750168323516846
Epoch: 16, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.293 Vali Acc: 0.339 Test Loss: 2.293 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.8495710
	speed: 0.4376s/iter; left time: 5617.2692s
Epoch: 17 cost time: 19.89936089515686
Epoch: 17, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.560 Vali Acc: 0.092 Test Loss: 2.560 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4246019
	speed: 0.4268s/iter; left time: 5413.0898s
Epoch: 18 cost time: 18.9608371257782
Epoch: 18, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.224 Vali Acc: 0.351 Test Loss: 2.224 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3058994
	speed: 0.4555s/iter; left time: 5707.3769s
Epoch: 19 cost time: 21.224502086639404
Epoch: 19, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.167 Vali Acc: 0.363 Test Loss: 2.167 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.8993275
	speed: 0.4709s/iter; left time: 5827.4303s
Epoch: 20 cost time: 20.5867600440979
Epoch: 20, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.188 Vali Acc: 0.319 Test Loss: 2.188 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.2947495
	speed: 0.4384s/iter; left time: 5357.5496s
Epoch: 21 cost time: 19.640179872512817
Epoch: 21, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.6221745
	speed: 0.4688s/iter; left time: 5657.4646s
Epoch: 22 cost time: 19.114548921585083
Epoch: 22, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.077 Vali Acc: 0.339 Test Loss: 2.077 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.8512861
	speed: 0.4273s/iter; left time: 5090.3954s
Epoch: 23 cost time: 20.483471155166626
Epoch: 23, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.110 Vali Acc: 0.270 Test Loss: 2.110 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 3602506
model size : 16.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3588812
	speed: 0.1634s/iter; left time: 2500.4574s
Epoch: 1 cost time: 22.96610713005066
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.220 Vali Acc: 0.315 Test Loss: 2.220 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2755027
	speed: 0.4524s/iter; left time: 6852.2061s
Epoch: 2 cost time: 20.650633573532104
Epoch: 2, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.204 Vali Acc: 0.317 Test Loss: 2.204 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316685).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2542851
	speed: 0.4486s/iter; left time: 6725.9866s
Epoch: 3 cost time: 18.75578260421753
Epoch: 3, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.201 Vali Acc: 0.321 Test Loss: 2.201 Test Acc: 0.321
Validation loss decreased (-0.316685 --> -0.321146).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5367029
	speed: 0.4438s/iter; left time: 6585.7751s
Epoch: 4 cost time: 19.894907236099243
Epoch: 4, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.157 Vali Acc: 0.327 Test Loss: 2.157 Test Acc: 0.327
Validation loss decreased (-0.321146 --> -0.326824).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0699329
	speed: 0.4272s/iter; left time: 6273.0784s
Epoch: 5 cost time: 18.543638706207275
Epoch: 5, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.177 Vali Acc: 0.320 Test Loss: 2.177 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1292765
	speed: 0.4098s/iter; left time: 5954.8528s
Epoch: 6 cost time: 18.380608320236206
Epoch: 6, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.120 Vali Acc: 0.332 Test Loss: 2.120 Test Acc: 0.332
Validation loss decreased (-0.326824 --> -0.331690).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2971215
	speed: 0.4457s/iter; left time: 6408.4005s
Epoch: 7 cost time: 20.232394218444824
Epoch: 7, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.223 Vali Acc: 0.316 Test Loss: 2.223 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7025604
	speed: 0.4387s/iter; left time: 6239.3139s
Epoch: 8 cost time: 19.55255913734436
Epoch: 8, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.135 Vali Acc: 0.327 Test Loss: 2.135 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2812700
	speed: 0.4344s/iter; left time: 6110.9995s
Epoch: 9 cost time: 18.455191135406494
Epoch: 9, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.146 Vali Acc: 0.326 Test Loss: 2.146 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2740281
	speed: 0.4497s/iter; left time: 6257.7067s
Epoch: 10 cost time: 20.68428897857666
Epoch: 10, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.132 Vali Acc: 0.321 Test Loss: 2.132 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.9778315
	speed: 0.4319s/iter; left time: 5943.6748s
Epoch: 11 cost time: 19.25017762184143
Epoch: 11, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.165 Vali Acc: 0.317 Test Loss: 2.165 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.9052550
	speed: 0.4444s/iter; left time: 6046.4561s
Epoch: 12 cost time: 20.54929542541504
Epoch: 12, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.158 Vali Acc: 0.318 Test Loss: 2.158 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.1351807
	speed: 0.4478s/iter; left time: 6024.7456s
Epoch: 13 cost time: 19.280646085739136
Epoch: 13, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.173 Vali Acc: 0.318 Test Loss: 2.173 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.4149051
	speed: 0.4587s/iter; left time: 6100.0976s
Epoch: 14 cost time: 21.618982553482056
Epoch: 14, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.163 Vali Acc: 0.318 Test Loss: 2.163 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.1178877
	speed: 0.4488s/iter; left time: 5899.8712s
Epoch: 15 cost time: 19.546246767044067
Epoch: 15, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.143 Vali Acc: 0.318 Test Loss: 2.143 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.1791286
	speed: 0.4562s/iter; left time: 5927.0961s
Epoch: 16 cost time: 21.02597689628601
Epoch: 16, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.115 Vali Acc: 0.322 Test Loss: 2.115 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33171127331711275
model parameter : 3601610
model size : 16.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1704383
	speed: 0.1504s/iter; left time: 2301.4189s
Epoch: 1 cost time: 21.472485303878784
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3390865
	speed: 0.4805s/iter; left time: 7277.5360s
Epoch: 2 cost time: 20.925657510757446
Epoch: 2, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.189 Vali Acc: 0.322 Test Loss: 2.189 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8585956
	speed: 0.4288s/iter; left time: 6428.7991s
Epoch: 3 cost time: 18.375725507736206
Epoch: 3, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.094 Vali Acc: 0.338 Test Loss: 2.094 Test Acc: 0.338
Validation loss decreased (-0.321552 --> -0.338179).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5294087
	speed: 0.4084s/iter; left time: 6060.2459s
Epoch: 4 cost time: 18.121832609176636
Epoch: 4, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.174 Vali Acc: 0.174 Test Loss: 2.174 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8949933
	speed: 0.4270s/iter; left time: 6270.7724s
Epoch: 5 cost time: 19.77044153213501
Epoch: 5, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.086 Vali Acc: 0.186 Test Loss: 2.086 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7875308
	speed: 0.4398s/iter; left time: 6390.3857s
Epoch: 6 cost time: 20.222368717193604
Epoch: 6, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.025 Vali Acc: 0.362 Test Loss: 2.025 Test Acc: 0.362
Validation loss decreased (-0.338179 --> -0.361699).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8496960
	speed: 0.4568s/iter; left time: 6567.4055s
Epoch: 7 cost time: 20.266889095306396
Epoch: 7, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.079 Vali Acc: 0.205 Test Loss: 2.079 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5401951
	speed: 0.4252s/iter; left time: 6047.7045s
Epoch: 8 cost time: 19.797033071517944
Epoch: 8, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.419 Vali Acc: 0.186 Test Loss: 2.419 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6269482
	speed: 0.4261s/iter; left time: 5995.0205s
Epoch: 9 cost time: 18.558387279510498
Epoch: 9, Steps: 154 | Train Loss: 1.722 Vali Loss: 1.996 Vali Acc: 0.378 Test Loss: 1.996 Test Acc: 0.378
Validation loss decreased (-0.361699 --> -0.378326).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3765788
	speed: 0.4193s/iter; left time: 5834.5972s
Epoch: 10 cost time: 18.452420473098755
Epoch: 10, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.210 Vali Acc: 0.362 Test Loss: 2.210 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3196999
	speed: 0.4346s/iter; left time: 5980.4297s
Epoch: 11 cost time: 20.170289278030396
Epoch: 11, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.241 Vali Acc: 0.366 Test Loss: 2.241 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5035515
	speed: 0.4262s/iter; left time: 5799.3540s
Epoch: 12 cost time: 19.46872353553772
Epoch: 12, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.400 Vali Acc: 0.144 Test Loss: 2.400 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.1951101
	speed: 0.4482s/iter; left time: 6028.9938s
Epoch: 13 cost time: 20.12828779220581
Epoch: 13, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.310 Vali Acc: 0.363 Test Loss: 2.310 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.7330916
	speed: 0.4595s/iter; left time: 6110.3902s
Epoch: 14 cost time: 20.932396411895752
Epoch: 14, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.513 Vali Acc: 0.358 Test Loss: 2.513 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4620593
	speed: 0.4683s/iter; left time: 6156.3962s
Epoch: 15 cost time: 21.903160572052002
Epoch: 15, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.202 Vali Acc: 0.309 Test Loss: 2.202 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.8409510
	speed: 0.4614s/iter; left time: 5994.0421s
Epoch: 16 cost time: 19.815815687179565
Epoch: 16, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.326 Vali Acc: 0.355 Test Loss: 2.326 Test Acc: 0.355
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.9926374
	speed: 0.4294s/iter; left time: 5512.0588s
Epoch: 17 cost time: 19.174834966659546
Epoch: 17, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.180 Vali Acc: 0.358 Test Loss: 2.180 Test Acc: 0.358
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.4190445
	speed: 0.4518s/iter; left time: 5730.3469s
Epoch: 18 cost time: 19.91883611679077
Epoch: 18, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.648 Vali Acc: 0.120 Test Loss: 2.648 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.3664300
	speed: 0.4838s/iter; left time: 6061.6254s
Epoch: 19 cost time: 21.80106830596924
Epoch: 19, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.215 Vali Acc: 0.262 Test Loss: 2.215 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 3600714
model size : 16.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3446543
	speed: 0.1516s/iter; left time: 2320.0179s
Epoch: 1 cost time: 21.03495168685913
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.267 Vali Acc: 0.315 Test Loss: 2.267 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3122988
	speed: 0.4074s/iter; left time: 6170.1382s
Epoch: 2 cost time: 19.112396001815796
Epoch: 2, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.175 Vali Acc: 0.321 Test Loss: 2.175 Test Acc: 0.321
Validation loss decreased (-0.315468 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1626399
	speed: 0.4240s/iter; left time: 6357.6367s
Epoch: 3 cost time: 19.60960030555725
Epoch: 3, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7874064
	speed: 0.4255s/iter; left time: 6314.3041s
Epoch: 4 cost time: 19.4242901802063
Epoch: 4, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.066 Vali Acc: 0.344 Test Loss: 2.066 Test Acc: 0.344
Validation loss decreased (-0.320741 --> -0.344262).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8689227
	speed: 0.4123s/iter; left time: 6054.6214s
Epoch: 5 cost time: 18.567312717437744
Epoch: 5, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.250 Vali Acc: 0.333 Test Loss: 2.250 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5070854
	speed: 0.4208s/iter; left time: 6113.9759s
Epoch: 6 cost time: 19.61004638671875
Epoch: 6, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.142 Vali Acc: 0.187 Test Loss: 2.142 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5856247
	speed: 0.4014s/iter; left time: 5770.6327s
Epoch: 7 cost time: 18.34768557548523
Epoch: 7, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.184 Vali Acc: 0.352 Test Loss: 2.184 Test Acc: 0.352
Validation loss decreased (-0.344262 --> -0.351560).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8909674
	speed: 0.4101s/iter; left time: 5832.5543s
Epoch: 8 cost time: 19.479188919067383
Epoch: 8, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.289 Vali Acc: 0.358 Test Loss: 2.289 Test Acc: 0.358
Validation loss decreased (-0.351560 --> -0.358452).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8807701
	speed: 0.4093s/iter; left time: 5758.2199s
Epoch: 9 cost time: 18.029535055160522
Epoch: 9, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.141 Vali Acc: 0.372 Test Loss: 2.141 Test Acc: 0.372
Validation loss decreased (-0.358452 --> -0.372241).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2874100
	speed: 0.4011s/iter; left time: 5581.1997s
Epoch: 10 cost time: 18.849307537078857
Epoch: 10, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.237 Vali Acc: 0.362 Test Loss: 2.237 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6644750
	speed: 0.4248s/iter; left time: 5845.3426s
Epoch: 11 cost time: 19.61347770690918
Epoch: 11, Steps: 154 | Train Loss: 1.614 Vali Loss: 3.041 Vali Acc: 0.172 Test Loss: 3.041 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5593528
	speed: 0.4284s/iter; left time: 5828.8419s
Epoch: 12 cost time: 18.320900201797485
Epoch: 12, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.452 Vali Acc: 0.369 Test Loss: 2.452 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.8797078
	speed: 0.4119s/iter; left time: 5541.2324s
Epoch: 13 cost time: 18.912419080734253
Epoch: 13, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.455 Vali Acc: 0.355 Test Loss: 2.455 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.6955862
	speed: 0.3882s/iter; left time: 5162.0675s
Epoch: 14 cost time: 17.57538890838623
Epoch: 14, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.420 Vali Acc: 0.366 Test Loss: 2.420 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.9174346
	speed: 0.4215s/iter; left time: 5540.4283s
Epoch: 15 cost time: 19.869542598724365
Epoch: 15, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.760 Vali Acc: 0.161 Test Loss: 2.760 Test Acc: 0.161
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3408079
	speed: 0.4184s/iter; left time: 5435.3772s
Epoch: 16 cost time: 18.613161325454712
Epoch: 16, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.744 Vali Acc: 0.148 Test Loss: 2.744 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.7298360
	speed: 0.4281s/iter; left time: 5495.8641s
Epoch: 17 cost time: 19.961138248443604
Epoch: 17, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.397 Vali Acc: 0.335 Test Loss: 2.397 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.5721905
	speed: 0.3874s/iter; left time: 4913.0736s
Epoch: 18 cost time: 17.053679943084717
Epoch: 18, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.743 Vali Acc: 0.196 Test Loss: 2.743 Test Acc: 0.196
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2387875
	speed: 0.3988s/iter; left time: 4996.8957s
Epoch: 19 cost time: 18.398592710494995
Epoch: 19, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.118 Vali Acc: 0.357 Test Loss: 2.118 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 3011274
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8559816
	speed: 0.1435s/iter; left time: 2195.5596s
Epoch: 1 cost time: 21.013914346694946
Epoch: 1, Steps: 154 | Train Loss: 2.238 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8706009
	speed: 0.4264s/iter; left time: 6458.2881s
Epoch: 2 cost time: 18.732251405715942
Epoch: 2, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.189 Vali Acc: 0.327 Test Loss: 2.189 Test Acc: 0.327
Validation loss decreased (-0.315063 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4645562
	speed: 0.4003s/iter; left time: 6000.9579s
Epoch: 3 cost time: 18.18387007713318
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.118 Vali Acc: 0.331 Test Loss: 2.118 Test Acc: 0.331
Validation loss decreased (-0.327229 --> -0.331285).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4081037
	speed: 0.4130s/iter; left time: 6128.2733s
Epoch: 4 cost time: 19.149561405181885
Epoch: 4, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.132 Vali Acc: 0.339 Test Loss: 2.132 Test Acc: 0.339
Validation loss decreased (-0.331285 --> -0.339395).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6930238
	speed: 0.4101s/iter; left time: 6023.0441s
Epoch: 5 cost time: 17.958389043807983
Epoch: 5, Steps: 154 | Train Loss: 2.053 Vali Loss: 2.058 Vali Acc: 0.354 Test Loss: 2.058 Test Acc: 0.354
Validation loss decreased (-0.339395 --> -0.354400).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4643826
	speed: 0.4256s/iter; left time: 6184.9481s
Epoch: 6 cost time: 19.46856379508972
Epoch: 6, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.118 Vali Acc: 0.345 Test Loss: 2.118 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7770690
	speed: 0.4390s/iter; left time: 6311.2759s
Epoch: 7 cost time: 20.434884548187256
Epoch: 7, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.133 Vali Acc: 0.352 Test Loss: 2.133 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7883641
	speed: 0.4362s/iter; left time: 6204.0984s
Epoch: 8 cost time: 19.79314875602722
Epoch: 8, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.226 Vali Acc: 0.365 Test Loss: 2.226 Test Acc: 0.365
Validation loss decreased (-0.354400 --> -0.364941).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7642069
	speed: 0.4253s/iter; left time: 5984.1147s
Epoch: 9 cost time: 18.4377863407135
Epoch: 9, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.179 Vali Acc: 0.371 Test Loss: 2.179 Test Acc: 0.371
Validation loss decreased (-0.364941 --> -0.370619).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6058697
	speed: 0.4185s/iter; left time: 5823.9217s
Epoch: 10 cost time: 20.234814167022705
Epoch: 10, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.042 Vali Acc: 0.239 Test Loss: 2.042 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9258722
	speed: 0.4270s/iter; left time: 5876.1081s
Epoch: 11 cost time: 19.46727967262268
Epoch: 11, Steps: 154 | Train Loss: 1.744 Vali Loss: 1.926 Vali Acc: 0.383 Test Loss: 1.926 Test Acc: 0.383
Validation loss decreased (-0.370619 --> -0.382787).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5799761
	speed: 0.4446s/iter; left time: 6049.7749s
Epoch: 12 cost time: 19.51872968673706
Epoch: 12, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.748 Vali Acc: 0.183 Test Loss: 2.748 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4668629
	speed: 0.4194s/iter; left time: 5641.5804s
Epoch: 13 cost time: 18.237987756729126
Epoch: 13, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.319 Vali Acc: 0.188 Test Loss: 2.319 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6520565
	speed: 0.4027s/iter; left time: 5354.9803s
Epoch: 14 cost time: 18.480438709259033
Epoch: 14, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.112 Vali Acc: 0.364 Test Loss: 2.112 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4316627
	speed: 0.4143s/iter; left time: 5445.5847s
Epoch: 15 cost time: 19.769741535186768
Epoch: 15, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.291 Vali Acc: 0.351 Test Loss: 2.291 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.2764139
	speed: 0.4266s/iter; left time: 5542.3684s
Epoch: 16 cost time: 19.08439564704895
Epoch: 16, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.182 Vali Acc: 0.200 Test Loss: 2.182 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.4822018
	speed: 0.4114s/iter; left time: 5281.0007s
Epoch: 17 cost time: 19.18146848678589
Epoch: 17, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.279 Vali Acc: 0.362 Test Loss: 2.279 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.5178533
	speed: 0.4039s/iter; left time: 5123.0926s
Epoch: 18 cost time: 17.340465784072876
Epoch: 18, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.400 Vali Acc: 0.367 Test Loss: 2.400 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5116411
	speed: 0.4159s/iter; left time: 5210.7670s
Epoch: 19 cost time: 19.42315936088562
Epoch: 19, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.230 Vali Acc: 0.187 Test Loss: 2.230 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.9318743
	speed: 0.4137s/iter; left time: 5119.6146s
Epoch: 20 cost time: 18.983927011489868
Epoch: 20, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.100 Vali Acc: 0.352 Test Loss: 2.100 Test Acc: 0.352
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.9302186
	speed: 0.4071s/iter; left time: 4975.3380s
Epoch: 21 cost time: 18.105900287628174
Epoch: 21, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.192 Vali Acc: 0.337 Test Loss: 2.192 Test Acc: 0.337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 3010378
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4975092
	speed: 0.1431s/iter; left time: 2189.4455s
Epoch: 1 cost time: 21.885062217712402
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.332 Vali Acc: 0.315 Test Loss: 2.332 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8125727
	speed: 0.4409s/iter; left time: 6678.7121s
Epoch: 2 cost time: 19.23838996887207
Epoch: 2, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.139 Vali Acc: 0.326 Test Loss: 2.139 Test Acc: 0.326
Validation loss decreased (-0.315062 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9010093
	speed: 0.4295s/iter; left time: 6440.1633s
Epoch: 3 cost time: 19.657745599746704
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.226 Vali Acc: 0.167 Test Loss: 2.226 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8699193
	speed: 0.4405s/iter; left time: 6536.5547s
Epoch: 4 cost time: 20.269673824310303
Epoch: 4, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.154 Vali Acc: 0.338 Test Loss: 2.154 Test Acc: 0.338
Validation loss decreased (-0.326418 --> -0.338178).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9236143
	speed: 0.4616s/iter; left time: 6778.1333s
Epoch: 5 cost time: 20.59527349472046
Epoch: 5, Steps: 154 | Train Loss: 1.916 Vali Loss: 2.050 Vali Acc: 0.350 Test Loss: 2.050 Test Acc: 0.350
Validation loss decreased (-0.338178 --> -0.349533).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3347437
	speed: 0.4423s/iter; left time: 6426.3652s
Epoch: 6 cost time: 20.80815362930298
Epoch: 6, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.119 Vali Acc: 0.347 Test Loss: 2.119 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3172734
	speed: 0.4662s/iter; left time: 6701.9659s
Epoch: 7 cost time: 21.189401626586914
Epoch: 7, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.181 Vali Acc: 0.413 Test Loss: 2.181 Test Acc: 0.413
Validation loss decreased (-0.349533 --> -0.412792).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5014360
	speed: 0.4575s/iter; left time: 6506.9326s
Epoch: 8 cost time: 22.2251877784729
Epoch: 8, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.511 Vali Acc: 0.187 Test Loss: 2.511 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5068486
	speed: 0.4498s/iter; left time: 6328.8434s
Epoch: 9 cost time: 18.21203875541687
Epoch: 9, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.282 Vali Acc: 0.348 Test Loss: 2.282 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5748940
	speed: 0.4194s/iter; left time: 5836.2928s
Epoch: 10 cost time: 19.565157651901245
Epoch: 10, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.192 Vali Acc: 0.366 Test Loss: 2.192 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8718435
	speed: 0.4201s/iter; left time: 5781.5068s
Epoch: 11 cost time: 18.43149495124817
Epoch: 11, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.271 Vali Acc: 0.349 Test Loss: 2.271 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8696810
	speed: 0.4251s/iter; left time: 5784.6856s
Epoch: 12 cost time: 21.121116399765015
Epoch: 12, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.369 Vali Acc: 0.355 Test Loss: 2.369 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1122752
	speed: 0.4531s/iter; left time: 6095.8919s
Epoch: 13 cost time: 20.536672830581665
Epoch: 13, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.113 Vali Acc: 0.363 Test Loss: 2.113 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4114788
	speed: 0.4200s/iter; left time: 5586.0690s
Epoch: 14 cost time: 19.857155084609985
Epoch: 14, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.077 Vali Acc: 0.392 Test Loss: 2.077 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0387540
	speed: 0.4376s/iter; left time: 5752.0709s
Epoch: 15 cost time: 20.245859384536743
Epoch: 15, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.198 Vali Acc: 0.368 Test Loss: 2.198 Test Acc: 0.368
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.8107874
	speed: 0.4644s/iter; left time: 6033.2411s
Epoch: 16 cost time: 20.67318034172058
Epoch: 16, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.343 Vali Acc: 0.344 Test Loss: 2.343 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.6985035
	speed: 0.4413s/iter; left time: 5664.9102s
Epoch: 17 cost time: 19.759854555130005
Epoch: 17, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.133 Vali Acc: 0.361 Test Loss: 2.133 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41281427412814276
model parameter : 3009482
model size : 14.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3209090
	speed: 0.1466s/iter; left time: 2243.2490s
Epoch: 1 cost time: 21.836625814437866
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.197 Vali Acc: 0.317 Test Loss: 2.197 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0502586
	speed: 0.4399s/iter; left time: 6663.8097s
Epoch: 2 cost time: 19.46704125404358
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.185 Vali Acc: 0.318 Test Loss: 2.185 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.318307).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0676358
	speed: 0.3962s/iter; left time: 5939.6906s
Epoch: 3 cost time: 18.020519256591797
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.136 Vali Acc: 0.336 Test Loss: 2.136 Test Acc: 0.336
Validation loss decreased (-0.318307 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7868474
	speed: 0.4243s/iter; left time: 6295.4572s
Epoch: 4 cost time: 19.52936029434204
Epoch: 4, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.156 Vali Acc: 0.348 Test Loss: 2.156 Test Acc: 0.348
Validation loss decreased (-0.336151 --> -0.347910).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0832886
	speed: 0.4125s/iter; left time: 6058.0097s
Epoch: 5 cost time: 18.488690614700317
Epoch: 5, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.465 Vali Acc: 0.172 Test Loss: 2.465 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6250393
	speed: 0.4257s/iter; left time: 6185.1667s
Epoch: 6 cost time: 20.752561569213867
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.324 Vali Acc: 0.328 Test Loss: 2.324 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4598879
	speed: 0.4354s/iter; left time: 6259.5228s
Epoch: 7 cost time: 19.003411531448364
Epoch: 7, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.600 Vali Acc: 0.348 Test Loss: 2.600 Test Acc: 0.348
Validation loss decreased (-0.347910 --> -0.348311).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3080037
	speed: 0.4294s/iter; left time: 6107.1529s
Epoch: 8 cost time: 18.95996332168579
Epoch: 8, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.664 Vali Acc: 0.162 Test Loss: 2.664 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6574788
	speed: 0.4091s/iter; left time: 5755.1130s
Epoch: 9 cost time: 19.345661163330078
Epoch: 9, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.332 Vali Acc: 0.387 Test Loss: 2.332 Test Acc: 0.387
Validation loss decreased (-0.348311 --> -0.387244).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9027225
	speed: 0.4284s/iter; left time: 5960.7093s
Epoch: 10 cost time: 19.364869356155396
Epoch: 10, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.321 Vali Acc: 0.366 Test Loss: 2.321 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0921659
	speed: 0.3932s/iter; left time: 5411.0705s
Epoch: 11 cost time: 17.988312482833862
Epoch: 11, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.204 Vali Acc: 0.355 Test Loss: 2.204 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3533247
	speed: 0.3982s/iter; left time: 5417.6561s
Epoch: 12 cost time: 17.887178897857666
Epoch: 12, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.208 Vali Acc: 0.357 Test Loss: 2.208 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5830879
	speed: 0.3810s/iter; left time: 5125.2286s
Epoch: 13 cost time: 18.182889223098755
Epoch: 13, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.442 Vali Acc: 0.353 Test Loss: 2.442 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3597529
	speed: 0.4302s/iter; left time: 5720.8425s
Epoch: 14 cost time: 19.45164179801941
Epoch: 14, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.382 Vali Acc: 0.367 Test Loss: 2.382 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8997767
	speed: 0.4283s/iter; left time: 5630.2612s
Epoch: 15 cost time: 19.45600461959839
Epoch: 15, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.396 Vali Acc: 0.197 Test Loss: 2.396 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4758295
	speed: 0.4083s/iter; left time: 5303.7089s
Epoch: 16 cost time: 18.633057594299316
Epoch: 16, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.690 Vali Acc: 0.204 Test Loss: 2.690 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.2376792
	speed: 0.3971s/iter; left time: 5097.5313s
Epoch: 17 cost time: 17.5426242351532
Epoch: 17, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.313 Vali Acc: 0.345 Test Loss: 2.313 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6907243
	speed: 0.3833s/iter; left time: 4861.1829s
Epoch: 18 cost time: 17.943813800811768
Epoch: 18, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.333 Vali Acc: 0.359 Test Loss: 2.333 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.4761873
	speed: 0.4028s/iter; left time: 5046.2084s
Epoch: 19 cost time: 18.863044023513794
Epoch: 19, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.479 Vali Acc: 0.282 Test Loss: 2.479 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 3008586
model size : 14.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2546270
	speed: 0.1443s/iter; left time: 2207.6150s
Epoch: 1 cost time: 21.405292987823486
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.239 Vali Acc: 0.315 Test Loss: 2.239 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1495886
	speed: 0.4463s/iter; left time: 6759.7694s
Epoch: 2 cost time: 20.344442129135132
Epoch: 2, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.120 Vali Acc: 0.324 Test Loss: 2.120 Test Acc: 0.324
Validation loss decreased (-0.315063 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0037289
	speed: 0.4278s/iter; left time: 6413.6931s
Epoch: 3 cost time: 19.359620809555054
Epoch: 3, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.199 Vali Acc: 0.338 Test Loss: 2.199 Test Acc: 0.338
Validation loss decreased (-0.323580 --> -0.337772).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0994606
	speed: 0.4356s/iter; left time: 6463.5775s
Epoch: 4 cost time: 19.90879797935486
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.093 Vali Acc: 0.340 Test Loss: 2.093 Test Acc: 0.340
Validation loss decreased (-0.337772 --> -0.339801).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5585974
	speed: 0.4440s/iter; left time: 6519.4723s
Epoch: 5 cost time: 19.59768009185791
Epoch: 5, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.098 Vali Acc: 0.350 Test Loss: 2.098 Test Acc: 0.350
Validation loss decreased (-0.339801 --> -0.349533).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0015135
	speed: 0.4090s/iter; left time: 5943.2984s
Epoch: 6 cost time: 18.261038780212402
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.376 Vali Acc: 0.197 Test Loss: 2.376 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2628233
	speed: 0.4115s/iter; left time: 5916.8357s
Epoch: 7 cost time: 18.464016437530518
Epoch: 7, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.323 Vali Acc: 0.376 Test Loss: 2.323 Test Acc: 0.376
Validation loss decreased (-0.349533 --> -0.375484).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9516939
	speed: 0.4181s/iter; left time: 5946.9774s
Epoch: 8 cost time: 20.02967596054077
Epoch: 8, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.649 Vali Acc: 0.310 Test Loss: 2.649 Test Acc: 0.310
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5620086
	speed: 0.4085s/iter; left time: 5747.3333s
Epoch: 9 cost time: 17.74069046974182
Epoch: 9, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.582 Vali Acc: 0.119 Test Loss: 2.582 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1852987
	speed: 0.3745s/iter; left time: 5211.5957s
Epoch: 10 cost time: 16.28583812713623
Epoch: 10, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.822 Vali Acc: 0.120 Test Loss: 2.822 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5425682
	speed: 0.3750s/iter; left time: 5160.8118s
Epoch: 11 cost time: 17.74576711654663
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.341 Vali Acc: 0.383 Test Loss: 2.341 Test Acc: 0.383
Validation loss decreased (-0.375484 --> -0.382783).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3008275
	speed: 0.3925s/iter; left time: 5340.1711s
Epoch: 12 cost time: 18.234140634536743
Epoch: 12, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.523 Vali Acc: 0.178 Test Loss: 2.523 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4861602
	speed: 0.3976s/iter; left time: 5348.4117s
Epoch: 13 cost time: 18.018163442611694
Epoch: 13, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.544 Vali Acc: 0.365 Test Loss: 2.544 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4460075
	speed: 0.3886s/iter; left time: 5168.0218s
Epoch: 14 cost time: 16.96735167503357
Epoch: 14, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.654 Vali Acc: 0.139 Test Loss: 2.654 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7980053
	speed: 0.3936s/iter; left time: 5173.4209s
Epoch: 15 cost time: 18.085801362991333
Epoch: 15, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.407 Vali Acc: 0.208 Test Loss: 2.407 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.5890886
	speed: 0.4005s/iter; left time: 5202.5577s
Epoch: 16 cost time: 17.708383560180664
Epoch: 16, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.544 Vali Acc: 0.188 Test Loss: 2.544 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0863552
	speed: 0.4010s/iter; left time: 5147.1739s
Epoch: 17 cost time: 17.954437494277954
Epoch: 17, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.516 Vali Acc: 0.371 Test Loss: 2.516 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.9439826
	speed: 0.4152s/iter; left time: 5265.4141s
Epoch: 18 cost time: 20.821385383605957
Epoch: 18, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.285 Vali Acc: 0.383 Test Loss: 2.285 Test Acc: 0.383
Validation loss decreased (-0.382783 --> -0.382783).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9885885
	speed: 0.4110s/iter; left time: 5149.6799s
Epoch: 19 cost time: 17.985159397125244
Epoch: 19, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.246 Vali Acc: 0.379 Test Loss: 2.246 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9440464
	speed: 0.4100s/iter; left time: 5073.3919s
Epoch: 20 cost time: 19.56661057472229
Epoch: 20, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.779 Vali Acc: 0.119 Test Loss: 2.779 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1860104
	speed: 0.4201s/iter; left time: 5133.7297s
Epoch: 21 cost time: 18.648290157318115
Epoch: 21, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.539 Vali Acc: 0.193 Test Loss: 2.539 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.9325131
	speed: 0.4271s/iter; left time: 5153.9698s
Epoch: 22 cost time: 20.305773973464966
Epoch: 22, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.535 Vali Acc: 0.341 Test Loss: 2.535 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.4952729
	speed: 0.4173s/iter; left time: 4971.0590s
Epoch: 23 cost time: 18.610431909561157
Epoch: 23, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.163 Vali Acc: 0.318 Test Loss: 2.163 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3872225
	speed: 0.3765s/iter; left time: 4427.4484s
Epoch: 24 cost time: 18.40490484237671
Epoch: 24, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.129 Vali Acc: 0.319 Test Loss: 2.129 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.9967744
	speed: 0.4059s/iter; left time: 4710.1755s
Epoch: 25 cost time: 18.26949143409729
Epoch: 25, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.4590027
	speed: 0.4024s/iter; left time: 4608.0938s
Epoch: 26 cost time: 20.353006601333618
Epoch: 26, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.149 Vali Acc: 0.315 Test Loss: 2.149 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.1190846
	speed: 0.4243s/iter; left time: 4793.0002s
Epoch: 27 cost time: 17.677623987197876
Epoch: 27, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.146 Vali Acc: 0.317 Test Loss: 2.146 Test Acc: 0.317
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.0773351
	speed: 0.3726s/iter; left time: 4151.7179s
Epoch: 28 cost time: 16.774696111679077
Epoch: 28, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.158 Vali Acc: 0.317 Test Loss: 2.158 Test Acc: 0.317
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 2715210
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4068265
	speed: 0.1606s/iter; left time: 2456.8036s
Epoch: 1 cost time: 23.128973245620728
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.225 Vali Acc: 0.315 Test Loss: 2.225 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7768395
	speed: 0.4430s/iter; left time: 6710.4079s
Epoch: 2 cost time: 19.679540157318115
Epoch: 2, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.248 Vali Acc: 0.320 Test Loss: 2.248 Test Acc: 0.320
Validation loss decreased (-0.315468 --> -0.319929).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7467813
	speed: 0.4505s/iter; left time: 6753.6072s
Epoch: 3 cost time: 19.85385489463806
Epoch: 3, Steps: 154 | Train Loss: 2.035 Vali Loss: 2.244 Vali Acc: 0.337 Test Loss: 2.244 Test Acc: 0.337
Validation loss decreased (-0.319929 --> -0.336555).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7369543
	speed: 0.4338s/iter; left time: 6437.1160s
Epoch: 4 cost time: 20.281992435455322
Epoch: 4, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.231 Vali Acc: 0.344 Test Loss: 2.231 Test Acc: 0.344
Validation loss decreased (-0.336555 --> -0.343854).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6855717
	speed: 0.4355s/iter; left time: 6395.7124s
Epoch: 5 cost time: 19.4633891582489
Epoch: 5, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.348 Vali Acc: 0.373 Test Loss: 2.348 Test Acc: 0.373
Validation loss decreased (-0.343854 --> -0.373456).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6240751
	speed: 0.4149s/iter; left time: 6028.1889s
Epoch: 6 cost time: 18.00202512741089
Epoch: 6, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.295 Vali Acc: 0.197 Test Loss: 2.295 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4217193
	speed: 0.4000s/iter; left time: 5751.4238s
Epoch: 7 cost time: 18.375642776489258
Epoch: 7, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.215 Vali Acc: 0.369 Test Loss: 2.215 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4171264
	speed: 0.3963s/iter; left time: 5637.1541s
Epoch: 8 cost time: 18.01939082145691
Epoch: 8, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.399 Vali Acc: 0.348 Test Loss: 2.399 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0903516
	speed: 0.3960s/iter; left time: 5572.0160s
Epoch: 9 cost time: 18.20307731628418
Epoch: 9, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.257 Vali Acc: 0.365 Test Loss: 2.257 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5190986
	speed: 0.4066s/iter; left time: 5657.9287s
Epoch: 10 cost time: 19.193597316741943
Epoch: 10, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.376 Vali Acc: 0.221 Test Loss: 2.376 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5646832
	speed: 0.4226s/iter; left time: 5815.5494s
Epoch: 11 cost time: 21.122308015823364
Epoch: 11, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.279 Vali Acc: 0.357 Test Loss: 2.279 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.6038380
	speed: 0.4524s/iter; left time: 6155.6787s
Epoch: 12 cost time: 19.73446226119995
Epoch: 12, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.244 Vali Acc: 0.354 Test Loss: 2.244 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5442291
	speed: 0.4324s/iter; left time: 5816.5893s
Epoch: 13 cost time: 19.825023889541626
Epoch: 13, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.132 Vali Acc: 0.373 Test Loss: 2.132 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.2565277
	speed: 0.4260s/iter; left time: 5665.1409s
Epoch: 14 cost time: 19.515562772750854
Epoch: 14, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.132 Vali Acc: 0.369 Test Loss: 2.132 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3921775
	speed: 0.4041s/iter; left time: 5312.4735s
Epoch: 15 cost time: 18.69444966316223
Epoch: 15, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.235 Vali Acc: 0.198 Test Loss: 2.235 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 2714314
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1432345
	speed: 0.1375s/iter; left time: 2104.0013s
Epoch: 1 cost time: 20.30674147605896
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7572441
	speed: 0.3957s/iter; left time: 5994.1305s
Epoch: 2 cost time: 20.226809978485107
Epoch: 2, Steps: 154 | Train Loss: 2.108 Vali Loss: 2.172 Vali Acc: 0.326 Test Loss: 2.172 Test Acc: 0.326
Validation loss decreased (-0.315063 --> -0.326012).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0353823
	speed: 0.4275s/iter; left time: 6409.0939s
Epoch: 3 cost time: 20.062161445617676
Epoch: 3, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.133 Vali Acc: 0.336 Test Loss: 2.133 Test Acc: 0.336
Validation loss decreased (-0.326012 --> -0.335745).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8993566
	speed: 0.4117s/iter; left time: 6109.0120s
Epoch: 4 cost time: 19.01873254776001
Epoch: 4, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.070 Vali Acc: 0.331 Test Loss: 2.070 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6953539
	speed: 0.4171s/iter; left time: 6125.8396s
Epoch: 5 cost time: 20.28025221824646
Epoch: 5, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.091 Vali Acc: 0.356 Test Loss: 2.091 Test Acc: 0.356
Validation loss decreased (-0.335745 --> -0.355616).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2571622
	speed: 0.4021s/iter; left time: 5842.8639s
Epoch: 6 cost time: 18.12042737007141
Epoch: 6, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.076 Vali Acc: 0.353 Test Loss: 2.076 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5311711
	speed: 0.4150s/iter; left time: 5966.4087s
Epoch: 7 cost time: 19.20243740081787
Epoch: 7, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.444 Vali Acc: 0.152 Test Loss: 2.444 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0311675
	speed: 0.3854s/iter; left time: 5481.6436s
Epoch: 8 cost time: 17.179994106292725
Epoch: 8, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.658 Vali Acc: 0.195 Test Loss: 2.658 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3989238
	speed: 0.3817s/iter; left time: 5369.6265s
Epoch: 9 cost time: 18.315616130828857
Epoch: 9, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.669 Vali Acc: 0.357 Test Loss: 2.669 Test Acc: 0.357
Validation loss decreased (-0.355616 --> -0.356827).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1344395
	speed: 0.4016s/iter; left time: 5588.4453s
Epoch: 10 cost time: 18.93229055404663
Epoch: 10, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.580 Vali Acc: 0.110 Test Loss: 2.580 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9287481
	speed: 0.4163s/iter; left time: 5729.3692s
Epoch: 11 cost time: 20.02776336669922
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.651 Vali Acc: 0.387 Test Loss: 2.651 Test Acc: 0.387
Validation loss decreased (-0.356827 --> -0.386835).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5031757
	speed: 0.4023s/iter; left time: 5474.5937s
Epoch: 12 cost time: 18.50585436820984
Epoch: 12, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.936 Vali Acc: 0.192 Test Loss: 2.936 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3207130
	speed: 0.3811s/iter; left time: 5127.5013s
Epoch: 13 cost time: 17.675881147384644
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.492 Vali Acc: 0.362 Test Loss: 2.492 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6591591
	speed: 0.3949s/iter; left time: 5252.0956s
Epoch: 14 cost time: 18.155438899993896
Epoch: 14, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.293 Vali Acc: 0.376 Test Loss: 2.293 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3941659
	speed: 0.4041s/iter; left time: 5311.6523s
Epoch: 15 cost time: 19.538131952285767
Epoch: 15, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.280 Vali Acc: 0.368 Test Loss: 2.280 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.5628252
	speed: 0.3940s/iter; left time: 5118.8358s
Epoch: 16 cost time: 19.210758209228516
Epoch: 16, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.622 Vali Acc: 0.363 Test Loss: 2.622 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.7514583
	speed: 0.4266s/iter; left time: 5475.7737s
Epoch: 17 cost time: 20.03339171409607
Epoch: 17, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.415 Vali Acc: 0.361 Test Loss: 2.415 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.5131321
	speed: 0.4105s/iter; left time: 5206.7943s
Epoch: 18 cost time: 19.138548612594604
Epoch: 18, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.248 Vali Acc: 0.375 Test Loss: 2.248 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1002136
	speed: 0.4107s/iter; left time: 5145.8888s
Epoch: 19 cost time: 19.57007598876953
Epoch: 19, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.497 Vali Acc: 0.367 Test Loss: 2.497 Test Acc: 0.367
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0813403
	speed: 0.4110s/iter; left time: 5085.5194s
Epoch: 20 cost time: 20.137773513793945
Epoch: 20, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.306 Vali Acc: 0.377 Test Loss: 2.306 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.3975667
	speed: 0.4061s/iter; left time: 4963.3579s
Epoch: 21 cost time: 18.72438955307007
Epoch: 21, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.170 Vali Acc: 0.365 Test Loss: 2.170 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 2713418
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2888393
	speed: 0.1343s/iter; left time: 2055.6642s
Epoch: 1 cost time: 19.11411762237549
Epoch: 1, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1468453
	speed: 0.3801s/iter; left time: 5757.2458s
Epoch: 2 cost time: 17.79961633682251
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.240 Vali Acc: 0.318 Test Loss: 2.240 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.317901).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8719399
	speed: 0.3728s/iter; left time: 5589.1521s
Epoch: 3 cost time: 17.841315507888794
Epoch: 3, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.145 Vali Acc: 0.321 Test Loss: 2.145 Test Acc: 0.321
Validation loss decreased (-0.317901 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8177711
	speed: 0.3792s/iter; left time: 5627.3935s
Epoch: 4 cost time: 16.97958469390869
Epoch: 4, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.237 Vali Acc: 0.335 Test Loss: 2.237 Test Acc: 0.335
Validation loss decreased (-0.320741 --> -0.334933).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1251333
	speed: 0.3774s/iter; left time: 5542.3132s
Epoch: 5 cost time: 16.734790325164795
Epoch: 5, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.153 Vali Acc: 0.352 Test Loss: 2.153 Test Acc: 0.352
Validation loss decreased (-0.334933 --> -0.351965).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9173501
	speed: 0.3831s/iter; left time: 5566.6171s
Epoch: 6 cost time: 17.460453271865845
Epoch: 6, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.192 Vali Acc: 0.354 Test Loss: 2.192 Test Acc: 0.354
Validation loss decreased (-0.351965 --> -0.353993).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6095756
	speed: 0.3923s/iter; left time: 5640.6863s
Epoch: 7 cost time: 16.948188304901123
Epoch: 7, Steps: 154 | Train Loss: 1.844 Vali Loss: 1.937 Vali Acc: 0.377 Test Loss: 1.937 Test Acc: 0.377
Validation loss decreased (-0.353993 --> -0.376704).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4954948
	speed: 0.3749s/iter; left time: 5331.8443s
Epoch: 8 cost time: 17.960986137390137
Epoch: 8, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.134 Vali Acc: 0.360 Test Loss: 2.134 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1064742
	speed: 0.3885s/iter; left time: 5466.4378s
Epoch: 9 cost time: 17.72515082359314
Epoch: 9, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.068 Vali Acc: 0.364 Test Loss: 2.068 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2910088
	speed: 0.4028s/iter; left time: 5604.8111s
Epoch: 10 cost time: 18.562374591827393
Epoch: 10, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.249 Vali Acc: 0.356 Test Loss: 2.249 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9443181
	speed: 0.3865s/iter; left time: 5318.2058s
Epoch: 11 cost time: 17.770524501800537
Epoch: 11, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.109 Vali Acc: 0.378 Test Loss: 2.109 Test Acc: 0.378
Validation loss decreased (-0.376704 --> -0.378324).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7628514
	speed: 0.4005s/iter; left time: 5449.2731s
Epoch: 12 cost time: 18.115336179733276
Epoch: 12, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.213 Vali Acc: 0.210 Test Loss: 2.213 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7082816
	speed: 0.3990s/iter; left time: 5368.1189s
Epoch: 13 cost time: 18.732237339019775
Epoch: 13, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.081 Vali Acc: 0.227 Test Loss: 2.081 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4624846
	speed: 0.4074s/iter; left time: 5417.9927s
Epoch: 14 cost time: 17.322558403015137
Epoch: 14, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.438 Vali Acc: 0.195 Test Loss: 2.438 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5492885
	speed: 0.3779s/iter; left time: 4966.9253s
Epoch: 15 cost time: 17.536211729049683
Epoch: 15, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.483 Vali Acc: 0.356 Test Loss: 2.483 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1209462
	speed: 0.3689s/iter; left time: 4792.3510s
Epoch: 16 cost time: 17.798882484436035
Epoch: 16, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.277 Vali Acc: 0.204 Test Loss: 2.277 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.7365142
	speed: 0.3868s/iter; left time: 4965.0850s
Epoch: 17 cost time: 17.613112211227417
Epoch: 17, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.288 Vali Acc: 0.343 Test Loss: 2.288 Test Acc: 0.343
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3556215
	speed: 0.3914s/iter; left time: 4964.2875s
Epoch: 18 cost time: 19.129818439483643
Epoch: 18, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.255 Vali Acc: 0.374 Test Loss: 2.255 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.6273705
	speed: 0.4052s/iter; left time: 5076.2043s
Epoch: 19 cost time: 18.377610445022583
Epoch: 19, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.159 Vali Acc: 0.345 Test Loss: 2.159 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2754024
	speed: 0.4005s/iter; left time: 4955.9267s
Epoch: 20 cost time: 18.02949023246765
Epoch: 20, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.368 Vali Acc: 0.365 Test Loss: 2.368 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.6881163
	speed: 0.3939s/iter; left time: 4813.9723s
Epoch: 21 cost time: 18.357422590255737
Epoch: 21, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.584 Vali Acc: 0.365 Test Loss: 2.584 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 2712522
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.8057494
	speed: 0.1626s/iter; left time: 2487.3923s
Epoch: 1 cost time: 22.79926896095276
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0187891
	speed: 0.4359s/iter; left time: 6601.8891s
Epoch: 2 cost time: 20.99978017807007
Epoch: 2, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.227 Vali Acc: 0.156 Test Loss: 2.227 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3512068
	speed: 0.4561s/iter; left time: 6838.5326s
Epoch: 3 cost time: 21.59880805015564
Epoch: 3, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.081 Vali Acc: 0.338 Test Loss: 2.081 Test Acc: 0.338
Validation loss decreased (-0.315063 --> -0.337773).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4565039
	speed: 0.4788s/iter; left time: 7104.7359s
Epoch: 4 cost time: 22.35494899749756
Epoch: 4, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.118 Vali Acc: 0.346 Test Loss: 2.118 Test Acc: 0.346
Validation loss decreased (-0.337773 --> -0.346289).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5537081
	speed: 0.4368s/iter; left time: 6414.5845s
Epoch: 5 cost time: 20.951672077178955
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.156 Vali Acc: 0.351 Test Loss: 2.156 Test Acc: 0.351
Validation loss decreased (-0.346289 --> -0.350749).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8804412
	speed: 0.4481s/iter; left time: 6510.7412s
Epoch: 6 cost time: 21.34726095199585
Epoch: 6, Steps: 154 | Train Loss: 1.807 Vali Loss: 1.940 Vali Acc: 0.374 Test Loss: 1.940 Test Acc: 0.374
Validation loss decreased (-0.350749 --> -0.373865).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7367502
	speed: 0.4393s/iter; left time: 6315.9676s
Epoch: 7 cost time: 19.639159440994263
Epoch: 7, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.120 Vali Acc: 0.364 Test Loss: 2.120 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3080581
	speed: 0.4219s/iter; left time: 6000.1677s
Epoch: 8 cost time: 20.737689971923828
Epoch: 8, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.127 Vali Acc: 0.375 Test Loss: 2.127 Test Acc: 0.375
Validation loss decreased (-0.373865 --> -0.375080).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1918783
	speed: 0.4677s/iter; left time: 6579.6963s
Epoch: 9 cost time: 23.313509702682495
Epoch: 9, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.354 Vali Acc: 0.211 Test Loss: 2.354 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2400570
	speed: 0.4760s/iter; left time: 6624.0290s
Epoch: 10 cost time: 21.64678692817688
Epoch: 10, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.820 Vali Acc: 0.179 Test Loss: 2.820 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7150636
	speed: 0.4038s/iter; left time: 5557.3127s
Epoch: 11 cost time: 19.196034908294678
Epoch: 11, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.793 Vali Acc: 0.142 Test Loss: 2.793 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4359434
	speed: 0.4460s/iter; left time: 6068.7624s
Epoch: 12 cost time: 20.619535207748413
Epoch: 12, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.368 Vali Acc: 0.356 Test Loss: 2.368 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.7903795
	speed: 0.4453s/iter; left time: 5990.7699s
Epoch: 13 cost time: 20.427706718444824
Epoch: 13, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.673 Vali Acc: 0.348 Test Loss: 2.673 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6792531
	speed: 0.4575s/iter; left time: 6084.4856s
Epoch: 14 cost time: 20.71429419517517
Epoch: 14, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.828 Vali Acc: 0.103 Test Loss: 2.828 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2829852
	speed: 0.4237s/iter; left time: 5569.7221s
Epoch: 15 cost time: 19.944987535476685
Epoch: 15, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.899 Vali Acc: 0.097 Test Loss: 2.899 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.6000708
	speed: 0.4427s/iter; left time: 5751.6392s
Epoch: 16 cost time: 20.577621936798096
Epoch: 16, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.858 Vali Acc: 0.123 Test Loss: 2.858 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3295357
	speed: 0.4654s/iter; left time: 5974.2629s
Epoch: 17 cost time: 21.407855987548828
Epoch: 17, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.431 Vali Acc: 0.380 Test Loss: 2.431 Test Acc: 0.380
Validation loss decreased (-0.375080 --> -0.380349).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5658672
	speed: 0.4407s/iter; left time: 5589.2898s
Epoch: 18 cost time: 21.227020740509033
Epoch: 18, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.889 Vali Acc: 0.127 Test Loss: 2.889 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2574450
	speed: 0.4816s/iter; left time: 6033.3632s
Epoch: 19 cost time: 21.298332452774048
Epoch: 19, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.299 Vali Acc: 0.210 Test Loss: 2.299 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.2218946
	speed: 0.4488s/iter; left time: 5553.3155s
Epoch: 20 cost time: 20.44496488571167
Epoch: 20, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.377 Vali Acc: 0.119 Test Loss: 2.377 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.1616895
	speed: 0.4547s/iter; left time: 5556.6657s
Epoch: 21 cost time: 21.250146627426147
Epoch: 21, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.533 Vali Acc: 0.195 Test Loss: 2.533 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3954487
	speed: 0.4666s/iter; left time: 5630.3638s
Epoch: 22 cost time: 20.494391918182373
Epoch: 22, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.876 Vali Acc: 0.164 Test Loss: 2.876 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.9477289
	speed: 0.4393s/iter; left time: 5233.5548s
Epoch: 23 cost time: 22.35953974723816
Epoch: 23, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.556 Vali Acc: 0.159 Test Loss: 2.556 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 2.0833850
	speed: 0.4394s/iter; left time: 5167.3832s
Epoch: 24 cost time: 20.820857048034668
Epoch: 24, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.423 Vali Acc: 0.144 Test Loss: 2.423 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.9272921
	speed: 0.4487s/iter; left time: 5207.1435s
Epoch: 25 cost time: 21.50019598007202
Epoch: 25, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.117 Vali Acc: 0.273 Test Loss: 2.117 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8497155
	speed: 0.4488s/iter; left time: 5139.1644s
Epoch: 26 cost time: 20.345191955566406
Epoch: 26, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.407 Vali Acc: 0.210 Test Loss: 2.407 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.8661240
	speed: 0.4365s/iter; left time: 4931.4713s
Epoch: 27 cost time: 19.61444878578186
Epoch: 27, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.202 Vali Acc: 0.376 Test Loss: 2.202 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38037307380373075
model parameter : 1808650
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3814387
	speed: 0.1522s/iter; left time: 2328.4682s
Epoch: 1 cost time: 21.723196983337402
Epoch: 1, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.161 Vali Acc: 0.321 Test Loss: 2.161 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7771783
	speed: 0.4318s/iter; left time: 6540.2140s
Epoch: 2 cost time: 22.474414587020874
Epoch: 2, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.203 Vali Acc: 0.318 Test Loss: 2.203 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6821764
	speed: 0.4646s/iter; left time: 6965.9707s
Epoch: 3 cost time: 21.51150870323181
Epoch: 3, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.115 Vali Acc: 0.331 Test Loss: 2.115 Test Acc: 0.331
Validation loss decreased (-0.320741 --> -0.331285).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8962082
	speed: 0.4808s/iter; left time: 7133.9869s
Epoch: 4 cost time: 22.33531165122986
Epoch: 4, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.079 Vali Acc: 0.334 Test Loss: 2.079 Test Acc: 0.334
Validation loss decreased (-0.331285 --> -0.334124).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4497223
	speed: 0.4451s/iter; left time: 6536.3570s
Epoch: 5 cost time: 19.90416979789734
Epoch: 5, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.008 Vali Acc: 0.383 Test Loss: 2.008 Test Acc: 0.383
Validation loss decreased (-0.334124 --> -0.383192).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9871860
	speed: 0.4724s/iter; left time: 6865.0189s
Epoch: 6 cost time: 23.053730010986328
Epoch: 6, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.023 Vali Acc: 0.356 Test Loss: 2.023 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6024847
	speed: 0.4721s/iter; left time: 6787.6354s
Epoch: 7 cost time: 22.13684320449829
Epoch: 7, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.162 Vali Acc: 0.355 Test Loss: 2.162 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3769252
	speed: 0.4696s/iter; left time: 6678.6261s
Epoch: 8 cost time: 20.677273273468018
Epoch: 8, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.941 Vali Acc: 0.120 Test Loss: 2.941 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.8808454
	speed: 0.4541s/iter; left time: 6388.9055s
Epoch: 9 cost time: 19.34677743911743
Epoch: 9, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.425 Vali Acc: 0.198 Test Loss: 2.425 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7211425
	speed: 0.4318s/iter; left time: 6008.9340s
Epoch: 10 cost time: 22.03018617630005
Epoch: 10, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.471 Vali Acc: 0.286 Test Loss: 2.471 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3504519
	speed: 0.4719s/iter; left time: 6494.3923s
Epoch: 11 cost time: 21.243613481521606
Epoch: 11, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.667 Vali Acc: 0.183 Test Loss: 2.667 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5663052
	speed: 0.4265s/iter; left time: 5804.0097s
Epoch: 12 cost time: 20.82491970062256
Epoch: 12, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.734 Vali Acc: 0.190 Test Loss: 2.734 Test Acc: 0.190
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4455568
	speed: 0.4671s/iter; left time: 6284.5248s
Epoch: 13 cost time: 21.45318627357483
Epoch: 13, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.896 Vali Acc: 0.187 Test Loss: 2.896 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2570887
	speed: 0.4377s/iter; left time: 5820.9523s
Epoch: 14 cost time: 19.534708738327026
Epoch: 14, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.360 Vali Acc: 0.373 Test Loss: 2.360 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6060406
	speed: 0.4378s/iter; left time: 5754.7390s
Epoch: 15 cost time: 20.944136381149292
Epoch: 15, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.725 Vali Acc: 0.190 Test Loss: 2.725 Test Acc: 0.190
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 1808202
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9736595
	speed: 0.1429s/iter; left time: 2185.8236s
Epoch: 1 cost time: 20.667010068893433
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1119246
	speed: 0.3949s/iter; left time: 5982.1725s
Epoch: 2 cost time: 18.860479831695557
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.127 Vali Acc: 0.322 Test Loss: 2.127 Test Acc: 0.322
Validation loss decreased (-0.315064 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6077485
	speed: 0.4177s/iter; left time: 6262.8338s
Epoch: 3 cost time: 18.57028555870056
Epoch: 3, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.089 Vali Acc: 0.347 Test Loss: 2.089 Test Acc: 0.347
Validation loss decreased (-0.322363 --> -0.346694).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6717057
	speed: 0.4122s/iter; left time: 6116.3724s
Epoch: 4 cost time: 18.771493911743164
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.191 Vali Acc: 0.342 Test Loss: 2.191 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8167695
	speed: 0.4170s/iter; left time: 6123.9449s
Epoch: 5 cost time: 19.115025520324707
Epoch: 5, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.200 Vali Acc: 0.337 Test Loss: 2.200 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1341324
	speed: 0.4171s/iter; left time: 6060.9429s
Epoch: 6 cost time: 19.773317575454712
Epoch: 6, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.360 Vali Acc: 0.178 Test Loss: 2.360 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6435745
	speed: 0.4061s/iter; left time: 5838.2339s
Epoch: 7 cost time: 18.994906425476074
Epoch: 7, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.348 Vali Acc: 0.181 Test Loss: 2.348 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5365875
	speed: 0.3968s/iter; left time: 5643.7100s
Epoch: 8 cost time: 17.780636310577393
Epoch: 8, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.704 Vali Acc: 0.097 Test Loss: 2.704 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8486760
	speed: 0.3522s/iter; left time: 4955.1705s
Epoch: 9 cost time: 17.66325044631958
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.952 Vali Acc: 0.096 Test Loss: 2.952 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.1091878
	speed: 0.3901s/iter; left time: 5428.5606s
Epoch: 10 cost time: 17.972352743148804
Epoch: 10, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.412 Vali Acc: 0.365 Test Loss: 2.412 Test Acc: 0.365
Validation loss decreased (-0.346694 --> -0.365345).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5660723
	speed: 0.3954s/iter; left time: 5441.6301s
Epoch: 11 cost time: 18.76738977432251
Epoch: 11, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.611 Vali Acc: 0.250 Test Loss: 2.611 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5861416
	speed: 0.4146s/iter; left time: 5641.5242s
Epoch: 12 cost time: 17.865704774856567
Epoch: 12, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.841 Vali Acc: 0.106 Test Loss: 2.841 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4203640
	speed: 0.3767s/iter; left time: 5067.2970s
Epoch: 13 cost time: 17.58425498008728
Epoch: 13, Steps: 154 | Train Loss: 1.592 Vali Loss: 3.221 Vali Acc: 0.101 Test Loss: 3.221 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.9360569
	speed: 0.4030s/iter; left time: 5359.9149s
Epoch: 14 cost time: 18.977241039276123
Epoch: 14, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.766 Vali Acc: 0.199 Test Loss: 2.766 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.7734666
	speed: 0.4404s/iter; left time: 5788.8110s
Epoch: 15 cost time: 18.334144592285156
Epoch: 15, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.375 Vali Acc: 0.068 Test Loss: 3.375 Test Acc: 0.068
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.7338377
	speed: 0.3968s/iter; left time: 5154.2247s
Epoch: 16 cost time: 18.253598928451538
Epoch: 16, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.221 Vali Acc: 0.378 Test Loss: 2.221 Test Acc: 0.378
Validation loss decreased (-0.365345 --> -0.377512).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.2149050
	speed: 0.4325s/iter; left time: 5551.9675s
Epoch: 17 cost time: 22.80017399787903
Epoch: 17, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.430 Vali Acc: 0.361 Test Loss: 2.430 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2868774
	speed: 0.4878s/iter; left time: 6187.2295s
Epoch: 18 cost time: 22.930182695388794
Epoch: 18, Steps: 154 | Train Loss: 1.491 Vali Loss: 4.875 Vali Acc: 0.042 Test Loss: 4.875 Test Acc: 0.042
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1724814
	speed: 0.4748s/iter; left time: 5949.2273s
Epoch: 19 cost time: 22.66073489189148
Epoch: 19, Steps: 154 | Train Loss: 1.465 Vali Loss: 3.024 Vali Acc: 0.114 Test Loss: 3.024 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.0310631
	speed: 0.4443s/iter; left time: 5498.7193s
Epoch: 20 cost time: 20.880030632019043
Epoch: 20, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.755 Vali Acc: 0.197 Test Loss: 2.755 Test Acc: 0.197
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.0841291
	speed: 0.4287s/iter; left time: 5239.4415s
Epoch: 21 cost time: 20.025577068328857
Epoch: 21, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.365 Vali Acc: 0.089 Test Loss: 3.365 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.2495304
	speed: 0.4474s/iter; left time: 5399.0531s
Epoch: 22 cost time: 20.638890743255615
Epoch: 22, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.909 Vali Acc: 0.341 Test Loss: 2.909 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.4472020
	speed: 0.4456s/iter; left time: 5309.0122s
Epoch: 23 cost time: 20.41086435317993
Epoch: 23, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.536 Vali Acc: 0.354 Test Loss: 2.536 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.2315531
	speed: 0.4636s/iter; left time: 5451.5506s
Epoch: 24 cost time: 22.947339296340942
Epoch: 24, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.089 Vali Acc: 0.121 Test Loss: 3.089 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.1838474
	speed: 0.4560s/iter; left time: 5292.0864s
Epoch: 25 cost time: 20.7383131980896
Epoch: 25, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.793 Vali Acc: 0.129 Test Loss: 2.793 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.1766599
	speed: 0.4531s/iter; left time: 5188.9166s
Epoch: 26 cost time: 22.57530450820923
Epoch: 26, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.873 Vali Acc: 0.068 Test Loss: 3.873 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 1807754
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0379357
	speed: 0.1421s/iter; left time: 2174.6443s
Epoch: 1 cost time: 20.44586682319641
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1365364
	speed: 0.4137s/iter; left time: 6266.1959s
Epoch: 2 cost time: 18.161507606506348
Epoch: 2, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.100 Vali Acc: 0.330 Test Loss: 2.100 Test Acc: 0.330
Validation loss decreased (-0.315063 --> -0.329663).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7405580
	speed: 0.3841s/iter; left time: 5758.1199s
Epoch: 3 cost time: 18.90465474128723
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.065 Vali Acc: 0.342 Test Loss: 2.065 Test Acc: 0.342
Validation loss decreased (-0.329663 --> -0.342234).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9510968
	speed: 0.4043s/iter; left time: 5998.9022s
Epoch: 4 cost time: 17.953080415725708
Epoch: 4, Steps: 154 | Train Loss: 1.886 Vali Loss: 2.066 Vali Acc: 0.348 Test Loss: 2.066 Test Acc: 0.348
Validation loss decreased (-0.342234 --> -0.347506).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3037181
	speed: 0.3975s/iter; left time: 5836.6266s
Epoch: 5 cost time: 18.07772660255432
Epoch: 5, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.154 Vali Acc: 0.194 Test Loss: 2.154 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3578819
	speed: 0.3950s/iter; left time: 5739.5051s
Epoch: 6 cost time: 18.051273345947266
Epoch: 6, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.124 Vali Acc: 0.267 Test Loss: 2.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0624723
	speed: 0.4032s/iter; left time: 5796.3344s
Epoch: 7 cost time: 19.984447956085205
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.728 Vali Acc: 0.192 Test Loss: 2.728 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0965914
	speed: 0.4333s/iter; left time: 6162.8613s
Epoch: 8 cost time: 19.82260751724243
Epoch: 8, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.289 Vali Acc: 0.389 Test Loss: 2.289 Test Acc: 0.389
Validation loss decreased (-0.347506 --> -0.388866).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9584950
	speed: 0.4210s/iter; left time: 5923.1345s
Epoch: 9 cost time: 19.556694746017456
Epoch: 9, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.461 Vali Acc: 0.351 Test Loss: 2.461 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7233596
	speed: 0.4114s/iter; left time: 5723.9805s
Epoch: 10 cost time: 19.56502938270569
Epoch: 10, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.498 Vali Acc: 0.372 Test Loss: 2.498 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5511755
	speed: 0.4340s/iter; left time: 5971.6337s
Epoch: 11 cost time: 19.534335374832153
Epoch: 11, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.916 Vali Acc: 0.176 Test Loss: 2.916 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.6134547
	speed: 0.4065s/iter; left time: 5531.6828s
Epoch: 12 cost time: 18.518885135650635
Epoch: 12, Steps: 154 | Train Loss: 1.598 Vali Loss: 3.226 Vali Acc: 0.099 Test Loss: 3.226 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3072810
	speed: 0.4210s/iter; left time: 5663.4053s
Epoch: 13 cost time: 19.117171049118042
Epoch: 13, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.635 Vali Acc: 0.390 Test Loss: 2.635 Test Acc: 0.390
Validation loss decreased (-0.388866 --> -0.390079).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5442724
	speed: 0.4323s/iter; left time: 5748.7869s
Epoch: 14 cost time: 20.028660774230957
Epoch: 14, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.810 Vali Acc: 0.181 Test Loss: 2.810 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4601475
	speed: 0.3952s/iter; left time: 5194.9316s
Epoch: 15 cost time: 18.529457569122314
Epoch: 15, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.841 Vali Acc: 0.180 Test Loss: 2.841 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1101111
	speed: 0.3958s/iter; left time: 5141.6037s
Epoch: 16 cost time: 18.56556248664856
Epoch: 16, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.750 Vali Acc: 0.197 Test Loss: 2.750 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2829051
	speed: 0.3818s/iter; left time: 4901.4240s
Epoch: 17 cost time: 18.957088947296143
Epoch: 17, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.907 Vali Acc: 0.151 Test Loss: 2.907 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3100330
	speed: 0.4079s/iter; left time: 5172.8171s
Epoch: 18 cost time: 18.498454570770264
Epoch: 18, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.641 Vali Acc: 0.382 Test Loss: 2.641 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3685632
	speed: 0.3729s/iter; left time: 4672.0233s
Epoch: 19 cost time: 17.134926557540894
Epoch: 19, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.991 Vali Acc: 0.135 Test Loss: 2.991 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.3462322
	speed: 0.3653s/iter; left time: 4520.1467s
Epoch: 20 cost time: 17.34045433998108
Epoch: 20, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.430 Vali Acc: 0.230 Test Loss: 2.430 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.3561789
	speed: 0.3635s/iter; left time: 4442.0316s
Epoch: 21 cost time: 17.320427417755127
Epoch: 21, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.397 Vali Acc: 0.389 Test Loss: 2.397 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.2153295
	speed: 0.3840s/iter; left time: 4633.4977s
Epoch: 22 cost time: 18.885544300079346
Epoch: 22, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.831 Vali Acc: 0.139 Test Loss: 2.831 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.2077751
	speed: 0.3880s/iter; left time: 4622.3975s
Epoch: 23 cost time: 18.285462617874146
Epoch: 23, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.858 Vali Acc: 0.262 Test Loss: 2.858 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 1807306
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1175110
	speed: 0.1506s/iter; left time: 2303.8631s
Epoch: 1 cost time: 22.47518563270569
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.231 Vali Acc: 0.155 Test Loss: 2.231 Test Acc: 0.155
Validation loss decreased (inf --> -0.154884).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2256174
	speed: 0.4130s/iter; left time: 6255.2989s
Epoch: 2 cost time: 18.442439556121826
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.159 Vali Acc: 0.319 Test Loss: 2.159 Test Acc: 0.319
Validation loss decreased (-0.154884 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5263824
	speed: 0.4101s/iter; left time: 6147.9307s
Epoch: 3 cost time: 19.63707184791565
Epoch: 3, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.001 Vali Acc: 0.354 Test Loss: 2.001 Test Acc: 0.354
Validation loss decreased (-0.319119 --> -0.353589).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0503724
	speed: 0.4189s/iter; left time: 6216.6780s
Epoch: 4 cost time: 19.076244831085205
Epoch: 4, Steps: 154 | Train Loss: 1.886 Vali Loss: 2.137 Vali Acc: 0.243 Test Loss: 2.137 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9874126
	speed: 0.4093s/iter; left time: 6010.1885s
Epoch: 5 cost time: 17.908254384994507
Epoch: 5, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.031 Vali Acc: 0.353 Test Loss: 2.031 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6859725
	speed: 0.4007s/iter; left time: 5821.9086s
Epoch: 6 cost time: 17.95493245124817
Epoch: 6, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.519 Vali Acc: 0.181 Test Loss: 2.519 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.8167026
	speed: 0.4076s/iter; left time: 5860.5392s
Epoch: 7 cost time: 19.85829496383667
Epoch: 7, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.647 Vali Acc: 0.185 Test Loss: 2.647 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.6227913
	speed: 0.4040s/iter; left time: 5746.3581s
Epoch: 8 cost time: 18.80319833755493
Epoch: 8, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.342 Vali Acc: 0.374 Test Loss: 2.342 Test Acc: 0.374
Validation loss decreased (-0.353589 --> -0.374267).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8218906
	speed: 0.4019s/iter; left time: 5653.7688s
Epoch: 9 cost time: 17.856853485107422
Epoch: 9, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.330 Vali Acc: 0.345 Test Loss: 2.330 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3900764
	speed: 0.3838s/iter; left time: 5341.1752s
Epoch: 10 cost time: 18.737936973571777
Epoch: 10, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.749 Vali Acc: 0.127 Test Loss: 2.749 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9692513
	speed: 0.3981s/iter; left time: 5478.1588s
Epoch: 11 cost time: 18.55738353729248
Epoch: 11, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.178 Vali Acc: 0.360 Test Loss: 2.178 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5673225
	speed: 0.3923s/iter; left time: 5338.2881s
Epoch: 12 cost time: 18.3337721824646
Epoch: 12, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.195 Vali Acc: 0.389 Test Loss: 2.195 Test Acc: 0.389
Validation loss decreased (-0.374267 --> -0.389272).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1965228
	speed: 0.3855s/iter; left time: 5186.2033s
Epoch: 13 cost time: 19.603643894195557
Epoch: 13, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.659 Vali Acc: 0.194 Test Loss: 2.659 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3854561
	speed: 0.4017s/iter; left time: 5342.2841s
Epoch: 14 cost time: 18.583550930023193
Epoch: 14, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.572 Vali Acc: 0.127 Test Loss: 2.572 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3629019
	speed: 0.3874s/iter; left time: 5092.3796s
Epoch: 15 cost time: 18.354048013687134
Epoch: 15, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.664 Vali Acc: 0.125 Test Loss: 2.664 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5769911
	speed: 0.3963s/iter; left time: 5147.7500s
Epoch: 16 cost time: 18.07166337966919
Epoch: 16, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.792 Vali Acc: 0.361 Test Loss: 2.792 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0682149
	speed: 0.3772s/iter; left time: 4841.8128s
Epoch: 17 cost time: 18.65416193008423
Epoch: 17, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.713 Vali Acc: 0.202 Test Loss: 2.713 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2985027
	speed: 0.3881s/iter; left time: 4922.3868s
Epoch: 18 cost time: 18.275294542312622
Epoch: 18, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.663 Vali Acc: 0.133 Test Loss: 2.663 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.2508101
	speed: 0.3927s/iter; left time: 4919.8553s
Epoch: 19 cost time: 18.826133489608765
Epoch: 19, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.814 Vali Acc: 0.133 Test Loss: 2.814 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.4889977
	speed: 0.4262s/iter; left time: 5273.9390s
Epoch: 20 cost time: 20.287368774414062
Epoch: 20, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.983 Vali Acc: 0.157 Test Loss: 2.983 Test Acc: 0.157
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.4522750
	speed: 0.3878s/iter; left time: 4739.0388s
Epoch: 21 cost time: 17.730664491653442
Epoch: 21, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.708 Vali Acc: 0.135 Test Loss: 2.708 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.4620572
	speed: 0.3907s/iter; left time: 4714.5374s
Epoch: 22 cost time: 18.350219011306763
Epoch: 22, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.681 Vali Acc: 0.161 Test Loss: 2.681 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 1214218
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2146006
	speed: 0.1420s/iter; left time: 2173.0626s
Epoch: 1 cost time: 20.3878116607666
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7888095
	speed: 0.3999s/iter; left time: 6056.7263s
Epoch: 2 cost time: 18.7337543964386
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.134 Vali Acc: 0.317 Test Loss: 2.134 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6936781
	speed: 0.3891s/iter; left time: 5833.6809s
Epoch: 3 cost time: 18.917840480804443
Epoch: 3, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.066 Vali Acc: 0.337 Test Loss: 2.066 Test Acc: 0.337
Validation loss decreased (-0.316686 --> -0.336962).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4979837
	speed: 0.3570s/iter; left time: 5297.0024s
Epoch: 4 cost time: 18.132378101348877
Epoch: 4, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.156 Vali Acc: 0.347 Test Loss: 2.156 Test Acc: 0.347
Validation loss decreased (-0.336962 --> -0.346694).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0880620
	speed: 0.3959s/iter; left time: 5813.2712s
Epoch: 5 cost time: 17.689684629440308
Epoch: 5, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.350 Vali Acc: 0.185 Test Loss: 2.350 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2983391
	speed: 0.3871s/iter; left time: 5624.6893s
Epoch: 6 cost time: 17.522995471954346
Epoch: 6, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.666 Vali Acc: 0.184 Test Loss: 2.666 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5647223
	speed: 0.3784s/iter; left time: 5440.6381s
Epoch: 7 cost time: 17.72345733642578
Epoch: 7, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.368 Vali Acc: 0.229 Test Loss: 2.368 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4289113
	speed: 0.3817s/iter; left time: 5428.3723s
Epoch: 8 cost time: 18.271210193634033
Epoch: 8, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.921 Vali Acc: 0.194 Test Loss: 2.921 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8093944
	speed: 0.3790s/iter; left time: 5331.8965s
Epoch: 9 cost time: 18.38279938697815
Epoch: 9, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.603 Vali Acc: 0.189 Test Loss: 2.603 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.7114512
	speed: 0.4053s/iter; left time: 5639.3730s
Epoch: 10 cost time: 18.977867126464844
Epoch: 10, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.193 Vali Acc: 0.105 Test Loss: 3.193 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6758176
	speed: 0.3974s/iter; left time: 5468.2915s
Epoch: 11 cost time: 17.944597721099854
Epoch: 11, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.692 Vali Acc: 0.193 Test Loss: 2.692 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.1742250
	speed: 0.3954s/iter; left time: 5380.8825s
Epoch: 12 cost time: 17.44503426551819
Epoch: 12, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.738 Vali Acc: 0.211 Test Loss: 2.738 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.4489545
	speed: 0.3756s/iter; left time: 5052.7475s
Epoch: 13 cost time: 18.404367446899414
Epoch: 13, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.468 Vali Acc: 0.365 Test Loss: 2.468 Test Acc: 0.365
Validation loss decreased (-0.346694 --> -0.364533).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3294092
	speed: 0.4286s/iter; left time: 5699.4932s
Epoch: 14 cost time: 19.6136634349823
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.373 Vali Acc: 0.058 Test Loss: 3.373 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2390227
	speed: 0.4090s/iter; left time: 5376.5885s
Epoch: 15 cost time: 18.634384155273438
Epoch: 15, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.381 Vali Acc: 0.369 Test Loss: 2.381 Test Acc: 0.369
Validation loss decreased (-0.364533 --> -0.369400).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8236398
	speed: 0.4274s/iter; left time: 5551.8407s
Epoch: 16 cost time: 20.72491693496704
Epoch: 16, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.460 Vali Acc: 0.369 Test Loss: 2.460 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.7511612
	speed: 0.4341s/iter; left time: 5572.8386s
Epoch: 17 cost time: 20.186333417892456
Epoch: 17, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.327 Vali Acc: 0.221 Test Loss: 2.327 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1345474
	speed: 0.4353s/iter; left time: 5521.4182s
Epoch: 18 cost time: 21.186052322387695
Epoch: 18, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.285 Vali Acc: 0.356 Test Loss: 2.285 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1245639
	speed: 0.4570s/iter; left time: 5725.2326s
Epoch: 19 cost time: 20.52876329421997
Epoch: 19, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.625 Vali Acc: 0.210 Test Loss: 2.625 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.6061560
	speed: 0.4440s/iter; left time: 5493.9105s
Epoch: 20 cost time: 22.079582452774048
Epoch: 20, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.201 Vali Acc: 0.380 Test Loss: 2.201 Test Acc: 0.380
Validation loss decreased (-0.369400 --> -0.380351).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7533180
	speed: 0.4951s/iter; left time: 6051.2109s
Epoch: 21 cost time: 21.773207426071167
Epoch: 21, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.642 Vali Acc: 0.403 Test Loss: 2.642 Test Acc: 0.403
Validation loss decreased (-0.380351 --> -0.402650).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.3803583
	speed: 0.4581s/iter; left time: 5527.4134s
Epoch: 22 cost time: 22.082678079605103
Epoch: 22, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.081 Vali Acc: 0.114 Test Loss: 3.081 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2694633
	speed: 0.4590s/iter; left time: 5467.7701s
Epoch: 23 cost time: 22.417733192443848
Epoch: 23, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.884 Vali Acc: 0.150 Test Loss: 2.884 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9008098
	speed: 0.4331s/iter; left time: 5093.3986s
Epoch: 24 cost time: 20.428484439849854
Epoch: 24, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.290 Vali Acc: 0.118 Test Loss: 3.290 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8282083
	speed: 0.4677s/iter; left time: 5427.8032s
Epoch: 25 cost time: 21.65320372581482
Epoch: 25, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.032 Vali Acc: 0.118 Test Loss: 3.032 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2494572
	speed: 0.5065s/iter; left time: 5799.4381s
Epoch: 26 cost time: 24.66080594062805
Epoch: 26, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.664 Vali Acc: 0.348 Test Loss: 2.664 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.6573837
	speed: 0.4705s/iter; left time: 5315.5991s
Epoch: 27 cost time: 21.861150979995728
Epoch: 27, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.771 Vali Acc: 0.307 Test Loss: 2.771 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.3242199
	speed: 0.4311s/iter; left time: 4804.1665s
Epoch: 28 cost time: 18.971848011016846
Epoch: 28, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.048 Vali Acc: 0.090 Test Loss: 3.048 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.3549795
	speed: 0.4484s/iter; left time: 4927.0372s
Epoch: 29 cost time: 21.45994472503662
Epoch: 29, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.992 Vali Acc: 0.127 Test Loss: 2.992 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.4148858
	speed: 0.4258s/iter; left time: 4613.0375s
Epoch: 30 cost time: 20.086188554763794
Epoch: 30, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.757 Vali Acc: 0.124 Test Loss: 2.757 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.3338645
	speed: 0.4480s/iter; left time: 4785.2024s
Epoch: 31 cost time: 21.948533058166504
Epoch: 31, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.569 Vali Acc: 0.220 Test Loss: 2.569 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.402676399026764
model parameter : 1213770
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1451778
	speed: 0.1343s/iter; left time: 2055.1646s
Epoch: 1 cost time: 18.971633911132812
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1636143
	speed: 0.3789s/iter; left time: 5739.7866s
Epoch: 2 cost time: 18.15630531311035
Epoch: 2, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.087 Vali Acc: 0.333 Test Loss: 2.087 Test Acc: 0.333
Validation loss decreased (-0.315469 --> -0.332907).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6224518
	speed: 0.3885s/iter; left time: 5825.2931s
Epoch: 3 cost time: 17.817754983901978
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.084 Vali Acc: 0.340 Test Loss: 2.084 Test Acc: 0.340
Validation loss decreased (-0.332907 --> -0.339801).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1929276
	speed: 0.3672s/iter; left time: 5449.3190s
Epoch: 4 cost time: 18.084125518798828
Epoch: 4, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.100 Vali Acc: 0.340 Test Loss: 2.100 Test Acc: 0.340
Validation loss decreased (-0.339801 --> -0.340206).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0616996
	speed: 0.3937s/iter; left time: 5781.1426s
Epoch: 5 cost time: 18.389578342437744
Epoch: 5, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.110 Vali Acc: 0.342 Test Loss: 2.110 Test Acc: 0.342
Validation loss decreased (-0.340206 --> -0.342234).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6973219
	speed: 0.4009s/iter; left time: 5825.4847s
Epoch: 6 cost time: 18.850849628448486
Epoch: 6, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.435 Vali Acc: 0.177 Test Loss: 2.435 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8746934
	speed: 0.3977s/iter; left time: 5717.9189s
Epoch: 7 cost time: 19.35460615158081
Epoch: 7, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.330 Vali Acc: 0.370 Test Loss: 2.330 Test Acc: 0.370
Validation loss decreased (-0.342234 --> -0.370212).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9363106
	speed: 0.3792s/iter; left time: 5393.6734s
Epoch: 8 cost time: 18.020724534988403
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.795 Vali Acc: 0.112 Test Loss: 2.795 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3759302
	speed: 0.3699s/iter; left time: 5203.7392s
Epoch: 9 cost time: 17.611149311065674
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.283 Vali Acc: 0.260 Test Loss: 2.283 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0173609
	speed: 0.3923s/iter; left time: 5458.7968s
Epoch: 10 cost time: 18.834906578063965
Epoch: 10, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.554 Vali Acc: 0.197 Test Loss: 2.554 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7404833
	speed: 0.3722s/iter; left time: 5121.5300s
Epoch: 11 cost time: 18.351503372192383
Epoch: 11, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.869 Vali Acc: 0.191 Test Loss: 2.869 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6780478
	speed: 0.4110s/iter; left time: 5592.9397s
Epoch: 12 cost time: 18.911340713500977
Epoch: 12, Steps: 154 | Train Loss: 1.511 Vali Loss: 3.007 Vali Acc: 0.116 Test Loss: 3.007 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.8434501
	speed: 0.3713s/iter; left time: 4994.8673s
Epoch: 13 cost time: 17.778254985809326
Epoch: 13, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.256 Vali Acc: 0.358 Test Loss: 2.256 Test Acc: 0.358
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2707074
	speed: 0.3736s/iter; left time: 4968.6312s
Epoch: 14 cost time: 17.625666618347168
Epoch: 14, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.627 Vali Acc: 0.159 Test Loss: 2.627 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.7299278
	speed: 0.3581s/iter; left time: 4707.5556s
Epoch: 15 cost time: 17.86226725578308
Epoch: 15, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.842 Vali Acc: 0.107 Test Loss: 2.842 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6405563
	speed: 0.3954s/iter; left time: 5136.0604s
Epoch: 16 cost time: 18.60680103302002
Epoch: 16, Steps: 154 | Train Loss: 1.446 Vali Loss: 3.027 Vali Acc: 0.092 Test Loss: 3.027 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.7040445
	speed: 0.3947s/iter; left time: 5066.3796s
Epoch: 17 cost time: 18.591310501098633
Epoch: 17, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.962 Vali Acc: 0.130 Test Loss: 2.962 Test Acc: 0.130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 1213322
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3482084
	speed: 0.1479s/iter; left time: 2263.2351s
Epoch: 1 cost time: 21.305787563323975
Epoch: 1, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1762826
	speed: 0.4343s/iter; left time: 6578.0182s
Epoch: 2 cost time: 21.66708731651306
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.172 Vali Acc: 0.324 Test Loss: 2.172 Test Acc: 0.324
Validation loss decreased (-0.315064 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9541919
	speed: 0.4426s/iter; left time: 6635.4199s
Epoch: 3 cost time: 21.50182604789734
Epoch: 3, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.112 Vali Acc: 0.330 Test Loss: 2.112 Test Acc: 0.330
Validation loss decreased (-0.323579 --> -0.330068).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7397406
	speed: 0.4374s/iter; left time: 6490.3531s
Epoch: 4 cost time: 20.77898335456848
Epoch: 4, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.063 Vali Acc: 0.353 Test Loss: 2.063 Test Acc: 0.353
Validation loss decreased (-0.330068 --> -0.352777).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6700033
	speed: 0.4033s/iter; left time: 5922.7941s
Epoch: 5 cost time: 18.208094835281372
Epoch: 5, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.157 Vali Acc: 0.351 Test Loss: 2.157 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7884200
	speed: 0.4168s/iter; left time: 6057.0245s
Epoch: 6 cost time: 21.06904125213623
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.161 Vali Acc: 0.364 Test Loss: 2.161 Test Acc: 0.364
Validation loss decreased (-0.352777 --> -0.364131).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5002499
	speed: 0.4221s/iter; left time: 6068.0396s
Epoch: 7 cost time: 19.564711809158325
Epoch: 7, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.326 Vali Acc: 0.204 Test Loss: 2.326 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5486156
	speed: 0.4023s/iter; left time: 5721.5269s
Epoch: 8 cost time: 17.512776851654053
Epoch: 8, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.569 Vali Acc: 0.107 Test Loss: 2.569 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6023252
	speed: 0.3939s/iter; left time: 5541.7790s
Epoch: 9 cost time: 17.643873929977417
Epoch: 9, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.201 Vali Acc: 0.369 Test Loss: 2.201 Test Acc: 0.369
Validation loss decreased (-0.364131 --> -0.368997).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4177114
	speed: 0.3875s/iter; left time: 5391.9806s
Epoch: 10 cost time: 18.86464023590088
Epoch: 10, Steps: 154 | Train Loss: 1.578 Vali Loss: 1.985 Vali Acc: 0.389 Test Loss: 1.985 Test Acc: 0.389
Validation loss decreased (-0.368997 --> -0.389275).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8177280
	speed: 0.4077s/iter; left time: 5609.7443s
Epoch: 11 cost time: 19.175615787506104
Epoch: 11, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.536 Vali Acc: 0.372 Test Loss: 2.536 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6916827
	speed: 0.4215s/iter; left time: 5734.8786s
Epoch: 12 cost time: 21.787100076675415
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.592 Vali Acc: 0.371 Test Loss: 2.592 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4017484
	speed: 0.4407s/iter; left time: 5929.0636s
Epoch: 13 cost time: 19.81277346611023
Epoch: 13, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.877 Vali Acc: 0.128 Test Loss: 2.877 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3992472
	speed: 0.4326s/iter; left time: 5752.9280s
Epoch: 14 cost time: 20.000782251358032
Epoch: 14, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.115 Vali Acc: 0.190 Test Loss: 3.115 Test Acc: 0.190
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.9781969
	speed: 0.4308s/iter; left time: 5662.8252s
Epoch: 15 cost time: 21.841744422912598
Epoch: 15, Steps: 154 | Train Loss: 1.473 Vali Loss: 3.164 Vali Acc: 0.119 Test Loss: 3.164 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2887545
	speed: 0.4360s/iter; left time: 5663.8472s
Epoch: 16 cost time: 20.462138891220093
Epoch: 16, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.122 Vali Acc: 0.120 Test Loss: 3.122 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5195923
	speed: 0.4234s/iter; left time: 5434.7696s
Epoch: 17 cost time: 18.90540385246277
Epoch: 17, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.045 Vali Acc: 0.120 Test Loss: 3.045 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.5440567
	speed: 0.4012s/iter; left time: 5088.1019s
Epoch: 18 cost time: 18.742281913757324
Epoch: 18, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.835 Vali Acc: 0.276 Test Loss: 2.835 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.2830796
	speed: 0.3956s/iter; left time: 4956.7066s
Epoch: 19 cost time: 20.48568844795227
Epoch: 19, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.954 Vali Acc: 0.185 Test Loss: 2.954 Test Acc: 0.185
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.4362814
	speed: 0.3974s/iter; left time: 4917.3988s
Epoch: 20 cost time: 19.25571060180664
Epoch: 20, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.897 Vali Acc: 0.119 Test Loss: 2.897 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 1212874
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5879951
	speed: 0.1308s/iter; left time: 2001.5950s
Epoch: 1 cost time: 18.672298908233643
Epoch: 1, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4280910
	speed: 0.3920s/iter; left time: 5938.0949s
Epoch: 2 cost time: 20.333845615386963
Epoch: 2, Steps: 154 | Train Loss: 2.177 Vali Loss: 2.186 Vali Acc: 0.316 Test Loss: 2.186 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2180862
	speed: 0.4042s/iter; left time: 6060.7428s
Epoch: 3 cost time: 18.00241470336914
Epoch: 3, Steps: 154 | Train Loss: 2.039 Vali Loss: 2.198 Vali Acc: 0.329 Test Loss: 2.198 Test Acc: 0.329
Validation loss decreased (-0.316280 --> -0.329256).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5745435
	speed: 0.3922s/iter; left time: 5820.1754s
Epoch: 4 cost time: 19.726226806640625
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.110 Vali Acc: 0.356 Test Loss: 2.110 Test Acc: 0.356
Validation loss decreased (-0.329256 --> -0.355616).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3958483
	speed: 0.4171s/iter; left time: 6124.5027s
Epoch: 5 cost time: 20.160699129104614
Epoch: 5, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.292 Vali Acc: 0.352 Test Loss: 2.292 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8132973
	speed: 0.4364s/iter; left time: 6341.8614s
Epoch: 6 cost time: 19.76094126701355
Epoch: 6, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.448 Vali Acc: 0.342 Test Loss: 2.448 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7344861
	speed: 0.4122s/iter; left time: 5926.0683s
Epoch: 7 cost time: 20.016991138458252
Epoch: 7, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.718 Vali Acc: 0.354 Test Loss: 2.718 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5223218
	speed: 0.4186s/iter; left time: 5953.4545s
Epoch: 8 cost time: 21.169419527053833
Epoch: 8, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.623 Vali Acc: 0.193 Test Loss: 2.623 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8929365
	speed: 0.4275s/iter; left time: 6015.1545s
Epoch: 9 cost time: 18.832510709762573
Epoch: 9, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.100 Vali Acc: 0.113 Test Loss: 3.100 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.2560707
	speed: 0.3871s/iter; left time: 5385.8388s
Epoch: 10 cost time: 18.780266046524048
Epoch: 10, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.910 Vali Acc: 0.167 Test Loss: 2.910 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1675965
	speed: 0.4432s/iter; left time: 6098.8229s
Epoch: 11 cost time: 21.598340272903442
Epoch: 11, Steps: 154 | Train Loss: 1.510 Vali Loss: 3.150 Vali Acc: 0.180 Test Loss: 3.150 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2585347
	speed: 0.4197s/iter; left time: 5710.2408s
Epoch: 12 cost time: 19.924238204956055
Epoch: 12, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.333 Vali Acc: 0.116 Test Loss: 3.333 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6518623
	speed: 0.4331s/iter; left time: 5826.1990s
Epoch: 13 cost time: 20.532580375671387
Epoch: 13, Steps: 154 | Train Loss: 1.465 Vali Loss: 3.056 Vali Acc: 0.092 Test Loss: 3.056 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0662836
	speed: 0.4203s/iter; left time: 5589.4571s
Epoch: 14 cost time: 18.634055137634277
Epoch: 14, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.370 Vali Acc: 0.175 Test Loss: 3.370 Test Acc: 0.175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35563665855636656
model parameter : 917002
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2600098
	speed: 0.1420s/iter; left time: 2172.6124s
Epoch: 1 cost time: 20.03218913078308
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1996198
	speed: 0.3732s/iter; left time: 5653.0911s
Epoch: 2 cost time: 18.59263038635254
Epoch: 2, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.105 Vali Acc: 0.330 Test Loss: 2.105 Test Acc: 0.330
Validation loss decreased (-0.315064 --> -0.330068).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6313683
	speed: 0.3886s/iter; left time: 5826.3648s
Epoch: 3 cost time: 18.269404888153076
Epoch: 3, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.152 Vali Acc: 0.330 Test Loss: 2.152 Test Acc: 0.330
Validation loss decreased (-0.330068 --> -0.330473).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8491911
	speed: 0.3866s/iter; left time: 5736.9456s
Epoch: 4 cost time: 17.858108282089233
Epoch: 4, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.255 Vali Acc: 0.343 Test Loss: 2.255 Test Acc: 0.343
Validation loss decreased (-0.330473 --> -0.343043).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5645298
	speed: 0.3661s/iter; left time: 5376.3225s
Epoch: 5 cost time: 16.803072452545166
Epoch: 5, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.152 Vali Acc: 0.341 Test Loss: 2.152 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8028951
	speed: 0.3874s/iter; left time: 5628.8251s
Epoch: 6 cost time: 18.894506454467773
Epoch: 6, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.464 Vali Acc: 0.176 Test Loss: 2.464 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8375075
	speed: 0.4086s/iter; left time: 5874.8059s
Epoch: 7 cost time: 17.713507890701294
Epoch: 7, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.213 Vali Acc: 0.369 Test Loss: 2.213 Test Acc: 0.369
Validation loss decreased (-0.343043 --> -0.368997).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8860904
	speed: 0.3783s/iter; left time: 5380.7419s
Epoch: 8 cost time: 17.58817958831787
Epoch: 8, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.686 Vali Acc: 0.229 Test Loss: 2.686 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5562094
	speed: 0.3515s/iter; left time: 4945.7037s
Epoch: 9 cost time: 16.200814962387085
Epoch: 9, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.486 Vali Acc: 0.147 Test Loss: 2.486 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5403317
	speed: 0.3604s/iter; left time: 5014.3693s
Epoch: 10 cost time: 16.82269263267517
Epoch: 10, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.593 Vali Acc: 0.371 Test Loss: 2.593 Test Acc: 0.371
Validation loss decreased (-0.368997 --> -0.371020).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0683247
	speed: 0.3684s/iter; left time: 5069.1937s
Epoch: 11 cost time: 17.64569067955017
Epoch: 11, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.858 Vali Acc: 0.178 Test Loss: 2.858 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6999925
	speed: 0.3592s/iter; left time: 4887.8108s
Epoch: 12 cost time: 16.627938985824585
Epoch: 12, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.812 Vali Acc: 0.191 Test Loss: 2.812 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5161874
	speed: 0.3617s/iter; left time: 4865.3508s
Epoch: 13 cost time: 16.52799892425537
Epoch: 13, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.563 Vali Acc: 0.379 Test Loss: 2.563 Test Acc: 0.379
Validation loss decreased (-0.371020 --> -0.378725).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2114170
	speed: 0.3612s/iter; left time: 4803.3881s
Epoch: 14 cost time: 17.66997265815735
Epoch: 14, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.121 Vali Acc: 0.187 Test Loss: 3.121 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4844429
	speed: 0.3653s/iter; left time: 4801.6824s
Epoch: 15 cost time: 17.678793907165527
Epoch: 15, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.733 Vali Acc: 0.125 Test Loss: 2.733 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5936166
	speed: 0.4059s/iter; left time: 5272.5145s
Epoch: 16 cost time: 17.923186779022217
Epoch: 16, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.855 Vali Acc: 0.116 Test Loss: 2.855 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5187262
	speed: 0.3825s/iter; left time: 4910.7562s
Epoch: 17 cost time: 17.462202310562134
Epoch: 17, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.767 Vali Acc: 0.159 Test Loss: 2.767 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3471444
	speed: 0.3919s/iter; left time: 4969.8721s
Epoch: 18 cost time: 18.19809126853943
Epoch: 18, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.491 Vali Acc: 0.377 Test Loss: 2.491 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4911622
	speed: 0.3914s/iter; left time: 4904.4318s
Epoch: 19 cost time: 17.258219957351685
Epoch: 19, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.590 Vali Acc: 0.208 Test Loss: 2.590 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0204782
	speed: 0.3807s/iter; left time: 4710.9798s
Epoch: 20 cost time: 18.59152579307556
Epoch: 20, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.556 Vali Acc: 0.233 Test Loss: 2.556 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.9984321
	speed: 0.3933s/iter; left time: 4806.6766s
Epoch: 21 cost time: 17.800994396209717
Epoch: 21, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.524 Vali Acc: 0.154 Test Loss: 2.524 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.1189127
	speed: 0.3765s/iter; left time: 4543.1379s
Epoch: 22 cost time: 17.632492780685425
Epoch: 22, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.635 Vali Acc: 0.097 Test Loss: 3.635 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1175321
	speed: 0.3746s/iter; left time: 4462.3268s
Epoch: 23 cost time: 17.51351833343506
Epoch: 23, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.927 Vali Acc: 0.121 Test Loss: 2.927 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 916554
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3078785
	speed: 0.1606s/iter; left time: 2457.2160s
Epoch: 1 cost time: 23.807759523391724
Epoch: 1, Steps: 154 | Train Loss: 2.212 Vali Loss: 2.139 Vali Acc: 0.315 Test Loss: 2.139 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0314937
	speed: 0.4279s/iter; left time: 6482.1062s
Epoch: 2 cost time: 19.38628625869751
Epoch: 2, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.088 Vali Acc: 0.324 Test Loss: 2.088 Test Acc: 0.324
Validation loss decreased (-0.315064 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2080104
	speed: 0.4225s/iter; left time: 6335.1955s
Epoch: 3 cost time: 19.458744764328003
Epoch: 3, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.226 Vali Acc: 0.333 Test Loss: 2.226 Test Acc: 0.333
Validation loss decreased (-0.324391 --> -0.332906).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5893301
	speed: 0.3927s/iter; left time: 5826.9790s
Epoch: 4 cost time: 18.050690174102783
Epoch: 4, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.060 Vali Acc: 0.350 Test Loss: 2.060 Test Acc: 0.350
Validation loss decreased (-0.332906 --> -0.350344).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6948323
	speed: 0.4023s/iter; left time: 5907.5411s
Epoch: 5 cost time: 20.445655822753906
Epoch: 5, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.243 Vali Acc: 0.342 Test Loss: 2.243 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6261424
	speed: 0.4297s/iter; left time: 6243.3904s
Epoch: 6 cost time: 19.85605788230896
Epoch: 6, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.277 Vali Acc: 0.352 Test Loss: 2.277 Test Acc: 0.352
Validation loss decreased (-0.350344 --> -0.351559).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1566638
	speed: 0.4270s/iter; left time: 6139.5874s
Epoch: 7 cost time: 19.594292163848877
Epoch: 7, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.341 Vali Acc: 0.365 Test Loss: 2.341 Test Acc: 0.365
Validation loss decreased (-0.351559 --> -0.365346).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8100085
	speed: 0.4343s/iter; left time: 6177.5855s
Epoch: 8 cost time: 21.095877647399902
Epoch: 8, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.207 Vali Acc: 0.199 Test Loss: 2.207 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2593846
	speed: 0.4383s/iter; left time: 6166.9369s
Epoch: 9 cost time: 19.81638789176941
Epoch: 9, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.851 Vali Acc: 0.191 Test Loss: 2.851 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8701122
	speed: 0.4287s/iter; left time: 5964.8593s
Epoch: 10 cost time: 19.271137475967407
Epoch: 10, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.290 Vali Acc: 0.353 Test Loss: 2.290 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6865808
	speed: 0.4478s/iter; left time: 6162.4406s
Epoch: 11 cost time: 19.890625715255737
Epoch: 11, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.592 Vali Acc: 0.363 Test Loss: 2.592 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5686551
	speed: 0.3928s/iter; left time: 5344.2358s
Epoch: 12 cost time: 17.450356483459473
Epoch: 12, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.367 Vali Acc: 0.372 Test Loss: 2.367 Test Acc: 0.372
Validation loss decreased (-0.365346 --> -0.372239).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8787125
	speed: 0.4048s/iter; left time: 5445.2326s
Epoch: 13 cost time: 20.08233618736267
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.495 Vali Acc: 0.358 Test Loss: 2.495 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7032844
	speed: 0.4331s/iter; left time: 5759.5973s
Epoch: 14 cost time: 19.843417167663574
Epoch: 14, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.451 Vali Acc: 0.357 Test Loss: 2.451 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6874096
	speed: 0.4056s/iter; left time: 5331.8965s
Epoch: 15 cost time: 20.08628559112549
Epoch: 15, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.490 Vali Acc: 0.129 Test Loss: 2.490 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1489253
	speed: 0.4200s/iter; left time: 5456.6383s
Epoch: 16 cost time: 19.02464747428894
Epoch: 16, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.490 Vali Acc: 0.361 Test Loss: 2.490 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0130143
	speed: 0.3824s/iter; left time: 4908.4291s
Epoch: 17 cost time: 18.508421897888184
Epoch: 17, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.711 Vali Acc: 0.208 Test Loss: 2.711 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1354681
	speed: 0.4091s/iter; left time: 5189.2439s
Epoch: 18 cost time: 19.009968996047974
Epoch: 18, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.565 Vali Acc: 0.379 Test Loss: 2.565 Test Acc: 0.379
Validation loss decreased (-0.372239 --> -0.379131).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4276301
	speed: 0.4140s/iter; left time: 5186.6307s
Epoch: 19 cost time: 19.80702567100525
Epoch: 19, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.268 Vali Acc: 0.369 Test Loss: 2.268 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.6208795
	speed: 0.4488s/iter; left time: 5553.3207s
Epoch: 20 cost time: 20.071212768554688
Epoch: 20, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.037 Vali Acc: 0.104 Test Loss: 3.037 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.5532135
	speed: 0.4025s/iter; left time: 4918.8193s
Epoch: 21 cost time: 19.1817626953125
Epoch: 21, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.633 Vali Acc: 0.225 Test Loss: 2.633 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2213629
	speed: 0.4080s/iter; left time: 4923.0604s
Epoch: 22 cost time: 20.628908395767212
Epoch: 22, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.476 Vali Acc: 0.365 Test Loss: 2.476 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2761407
	speed: 0.4410s/iter; left time: 5253.4701s
Epoch: 23 cost time: 21.697631120681763
Epoch: 23, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.429 Vali Acc: 0.372 Test Loss: 2.429 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3755240
	speed: 0.4251s/iter; left time: 4998.6702s
Epoch: 24 cost time: 19.342090606689453
Epoch: 24, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.903 Vali Acc: 0.110 Test Loss: 2.903 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.6505202
	speed: 0.4033s/iter; left time: 4680.2395s
Epoch: 25 cost time: 19.16939878463745
Epoch: 25, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.369 Vali Acc: 0.315 Test Loss: 2.369 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.7962981
	speed: 0.4348s/iter; left time: 4978.7944s
Epoch: 26 cost time: 20.886844635009766
Epoch: 26, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.867 Vali Acc: 0.136 Test Loss: 2.867 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.4372096
	speed: 0.4091s/iter; left time: 4621.0638s
Epoch: 27 cost time: 18.43851661682129
Epoch: 27, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.065 Vali Acc: 0.061 Test Loss: 3.065 Test Acc: 0.061
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1405212
	speed: 0.4411s/iter; left time: 4915.0155s
Epoch: 28 cost time: 21.50279951095581
Epoch: 28, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.892 Vali Acc: 0.228 Test Loss: 2.892 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 916106
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1701181
	speed: 0.1443s/iter; left time: 2208.2854s
Epoch: 1 cost time: 20.52641987800598
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9593097
	speed: 0.4303s/iter; left time: 6517.8476s
Epoch: 2 cost time: 20.63736319541931
Epoch: 2, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9042677
	speed: 0.4555s/iter; left time: 6828.8384s
Epoch: 3 cost time: 22.679792165756226
Epoch: 3, Steps: 154 | Train Loss: 2.019 Vali Loss: 2.089 Vali Acc: 0.345 Test Loss: 2.089 Test Acc: 0.345
Validation loss decreased (-0.318308 --> -0.344667).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0397625
	speed: 0.4463s/iter; left time: 6623.1979s
Epoch: 4 cost time: 21.26552391052246
Epoch: 4, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.003 Vali Acc: 0.217 Test Loss: 2.003 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2303848
	speed: 0.4367s/iter; left time: 6413.2691s
Epoch: 5 cost time: 19.860817670822144
Epoch: 5, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.184 Vali Acc: 0.223 Test Loss: 2.184 Test Acc: 0.223
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4040943
	speed: 0.4304s/iter; left time: 6253.7963s
Epoch: 6 cost time: 21.835386276245117
Epoch: 6, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.439 Vali Acc: 0.355 Test Loss: 2.439 Test Acc: 0.355
Validation loss decreased (-0.344667 --> -0.355207).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6662629
	speed: 0.4453s/iter; left time: 6401.6450s
Epoch: 7 cost time: 20.386892318725586
Epoch: 7, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.566 Vali Acc: 0.198 Test Loss: 2.566 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7726260
	speed: 0.4147s/iter; left time: 5898.8654s
Epoch: 8 cost time: 18.391348361968994
Epoch: 8, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.682 Vali Acc: 0.177 Test Loss: 2.682 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7475805
	speed: 0.4096s/iter; left time: 5762.7687s
Epoch: 9 cost time: 19.335958242416382
Epoch: 9, Steps: 154 | Train Loss: 1.562 Vali Loss: 3.063 Vali Acc: 0.103 Test Loss: 3.063 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8149002
	speed: 0.4257s/iter; left time: 5923.1493s
Epoch: 10 cost time: 22.08979845046997
Epoch: 10, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.832 Vali Acc: 0.195 Test Loss: 2.832 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.9484992
	speed: 0.4185s/iter; left time: 5759.5164s
Epoch: 11 cost time: 19.34756565093994
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.957 Vali Acc: 0.167 Test Loss: 2.957 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8002306
	speed: 0.4275s/iter; left time: 5816.8603s
Epoch: 12 cost time: 20.635589361190796
Epoch: 12, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.581 Vali Acc: 0.205 Test Loss: 2.581 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8322010
	speed: 0.4042s/iter; left time: 5437.5043s
Epoch: 13 cost time: 18.280259370803833
Epoch: 13, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.820 Vali Acc: 0.142 Test Loss: 2.820 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.9638408
	speed: 0.4064s/iter; left time: 5404.0695s
Epoch: 14 cost time: 19.49699091911316
Epoch: 14, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.068 Vali Acc: 0.125 Test Loss: 3.068 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.7250123
	speed: 0.4212s/iter; left time: 5536.9931s
Epoch: 15 cost time: 18.664238452911377
Epoch: 15, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.518 Vali Acc: 0.375 Test Loss: 2.518 Test Acc: 0.375
Validation loss decreased (-0.355207 --> -0.375076).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6063018
	speed: 0.3946s/iter; left time: 5126.0442s
Epoch: 16 cost time: 19.712095260620117
Epoch: 16, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.455 Vali Acc: 0.212 Test Loss: 2.455 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0888094
	speed: 0.4068s/iter; left time: 5221.5407s
Epoch: 17 cost time: 18.00839638710022
Epoch: 17, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.055 Vali Acc: 0.076 Test Loss: 3.055 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6637807
	speed: 0.4198s/iter; left time: 5324.6208s
Epoch: 18 cost time: 19.524976015090942
Epoch: 18, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.905 Vali Acc: 0.198 Test Loss: 2.905 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4746097
	speed: 0.4204s/iter; left time: 5267.5646s
Epoch: 19 cost time: 20.93277883529663
Epoch: 19, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.564 Vali Acc: 0.387 Test Loss: 2.564 Test Acc: 0.387
Validation loss decreased (-0.375076 --> -0.386836).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1551760
	speed: 0.4226s/iter; left time: 5229.8148s
Epoch: 20 cost time: 19.172439575195312
Epoch: 20, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.967 Vali Acc: 0.156 Test Loss: 2.967 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1081041
	speed: 0.4336s/iter; left time: 5299.4555s
Epoch: 21 cost time: 18.946508169174194
Epoch: 21, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.130 Vali Acc: 0.125 Test Loss: 3.130 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1907272
	speed: 0.4001s/iter; left time: 4827.7940s
Epoch: 22 cost time: 18.926623106002808
Epoch: 22, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.893 Vali Acc: 0.133 Test Loss: 2.893 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.1105940
	speed: 0.4191s/iter; left time: 4993.0880s
Epoch: 23 cost time: 19.17139506340027
Epoch: 23, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.986 Vali Acc: 0.150 Test Loss: 2.986 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2999960
	speed: 0.4282s/iter; left time: 5035.0543s
Epoch: 24 cost time: 20.84055995941162
Epoch: 24, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.260 Vali Acc: 0.122 Test Loss: 3.260 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.4963437
	speed: 0.4188s/iter; left time: 4860.6011s
Epoch: 25 cost time: 19.25224208831787
Epoch: 25, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.915 Vali Acc: 0.153 Test Loss: 2.915 Test Acc: 0.153
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.8321667
	speed: 0.3962s/iter; left time: 4536.4034s
Epoch: 26 cost time: 18.056053400039673
Epoch: 26, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.956 Vali Acc: 0.212 Test Loss: 2.956 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8340328
	speed: 0.4191s/iter; left time: 4734.8556s
Epoch: 27 cost time: 21.99998712539673
Epoch: 27, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.103 Vali Acc: 0.200 Test Loss: 3.103 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.6390717
	speed: 0.4604s/iter; left time: 5130.7845s
Epoch: 28 cost time: 22.037656784057617
Epoch: 28, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.893 Vali Acc: 0.212 Test Loss: 2.893 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.3556157
	speed: 0.4113s/iter; left time: 4519.2468s
Epoch: 29 cost time: 18.47502040863037
Epoch: 29, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.813 Vali Acc: 0.205 Test Loss: 2.813 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 915658
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7934020
	speed: 0.1525s/iter; left time: 2332.6684s
Epoch: 1 cost time: 22.093044996261597
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9142166
	speed: 0.4079s/iter; left time: 6179.0805s
Epoch: 2 cost time: 17.538953065872192
Epoch: 2, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.130 Vali Acc: 0.323 Test Loss: 2.130 Test Acc: 0.323
Validation loss decreased (-0.315063 --> -0.322769).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1744952
	speed: 0.3863s/iter; left time: 5792.0017s
Epoch: 3 cost time: 19.377398252487183
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.075 Vali Acc: 0.326 Test Loss: 2.075 Test Acc: 0.326
Validation loss decreased (-0.322769 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3489108
	speed: 0.3939s/iter; left time: 5845.4877s
Epoch: 4 cost time: 18.760851860046387
Epoch: 4, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.176 Vali Acc: 0.348 Test Loss: 2.176 Test Acc: 0.348
Validation loss decreased (-0.326013 --> -0.348316).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2005725
	speed: 0.4071s/iter; left time: 5978.1318s
Epoch: 5 cost time: 19.449586868286133
Epoch: 5, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.422 Vali Acc: 0.174 Test Loss: 2.422 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3919629
	speed: 0.4031s/iter; left time: 5857.3954s
Epoch: 6 cost time: 18.566134452819824
Epoch: 6, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.199 Vali Acc: 0.367 Test Loss: 2.199 Test Acc: 0.367
Validation loss decreased (-0.348316 --> -0.366564).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6599172
	speed: 0.4035s/iter; left time: 5801.2928s
Epoch: 7 cost time: 18.548895597457886
Epoch: 7, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.485 Vali Acc: 0.334 Test Loss: 2.485 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7806275
	speed: 0.4046s/iter; left time: 5753.9514s
Epoch: 8 cost time: 20.545551300048828
Epoch: 8, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.678 Vali Acc: 0.376 Test Loss: 2.678 Test Acc: 0.376
Validation loss decreased (-0.366564 --> -0.376291).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8482409
	speed: 0.4305s/iter; left time: 6056.8796s
Epoch: 9 cost time: 20.366084814071655
Epoch: 9, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.503 Vali Acc: 0.360 Test Loss: 2.503 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0201133
	speed: 0.4045s/iter; left time: 5628.7625s
Epoch: 10 cost time: 18.591567754745483
Epoch: 10, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.707 Vali Acc: 0.348 Test Loss: 2.707 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5941801
	speed: 0.3876s/iter; left time: 5333.4225s
Epoch: 11 cost time: 18.183836221694946
Epoch: 11, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.972 Vali Acc: 0.168 Test Loss: 2.972 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3702710
	speed: 0.3853s/iter; left time: 5242.7748s
Epoch: 12 cost time: 18.41688323020935
Epoch: 12, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.565 Vali Acc: 0.159 Test Loss: 2.565 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2387755
	speed: 0.3758s/iter; left time: 5055.1018s
Epoch: 13 cost time: 18.300422430038452
Epoch: 13, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.544 Vali Acc: 0.249 Test Loss: 2.544 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5239385
	speed: 0.3942s/iter; left time: 5242.2093s
Epoch: 14 cost time: 17.78972315788269
Epoch: 14, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.993 Vali Acc: 0.132 Test Loss: 2.993 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4350545
	speed: 0.3926s/iter; left time: 5160.1618s
Epoch: 15 cost time: 19.06594228744507
Epoch: 15, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.400 Vali Acc: 0.379 Test Loss: 2.400 Test Acc: 0.379
Validation loss decreased (-0.376291 --> -0.379133).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0602064
	speed: 0.4204s/iter; left time: 5461.2177s
Epoch: 16 cost time: 20.05815362930298
Epoch: 16, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.129 Vali Acc: 0.122 Test Loss: 3.129 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1645749
	speed: 0.3911s/iter; left time: 5020.5040s
Epoch: 17 cost time: 17.860184907913208
Epoch: 17, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.298 Vali Acc: 0.118 Test Loss: 3.298 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7089860
	speed: 0.3818s/iter; left time: 4842.0898s
Epoch: 18 cost time: 18.50091242790222
Epoch: 18, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.398 Vali Acc: 0.141 Test Loss: 2.398 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.2629429
	speed: 0.3893s/iter; left time: 4878.0807s
Epoch: 19 cost time: 18.65552544593811
Epoch: 19, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.723 Vali Acc: 0.093 Test Loss: 2.723 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2003694
	speed: 0.4023s/iter; left time: 4977.9835s
Epoch: 20 cost time: 18.904823541641235
Epoch: 20, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.810 Vali Acc: 0.129 Test Loss: 2.810 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.7079381
	speed: 0.4128s/iter; left time: 5045.0490s
Epoch: 21 cost time: 19.39531397819519
Epoch: 21, Steps: 154 | Train Loss: 1.342 Vali Loss: 3.136 Vali Acc: 0.135 Test Loss: 3.136 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2249525
	speed: 0.4122s/iter; left time: 4974.5032s
Epoch: 22 cost time: 18.427050352096558
Epoch: 22, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.700 Vali Acc: 0.144 Test Loss: 2.700 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3384796
	speed: 0.4027s/iter; left time: 4797.0493s
Epoch: 23 cost time: 18.871651887893677
Epoch: 23, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.892 Vali Acc: 0.169 Test Loss: 2.892 Test Acc: 0.169
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.7896553
	speed: 0.3999s/iter; left time: 4702.7659s
Epoch: 24 cost time: 18.5295352935791
Epoch: 24, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.409 Vali Acc: 0.075 Test Loss: 3.409 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.2158552
	speed: 0.3903s/iter; left time: 4529.8741s
Epoch: 25 cost time: 18.607274293899536
Epoch: 25, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.473 Vali Acc: 0.133 Test Loss: 3.473 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 768394
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6045246
	speed: 0.1533s/iter; left time: 2345.9026s
Epoch: 1 cost time: 22.35058617591858
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5680156
	speed: 0.4316s/iter; left time: 6537.2095s
Epoch: 2 cost time: 18.812291383743286
Epoch: 2, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.136 Vali Acc: 0.323 Test Loss: 2.136 Test Acc: 0.323
Validation loss decreased (-0.315063 --> -0.322769).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8398700
	speed: 0.4086s/iter; left time: 6125.6371s
Epoch: 3 cost time: 18.872573375701904
Epoch: 3, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.038 Vali Acc: 0.340 Test Loss: 2.038 Test Acc: 0.340
Validation loss decreased (-0.322769 --> -0.340207).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5725259
	speed: 0.4257s/iter; left time: 6317.0981s
Epoch: 4 cost time: 20.790969371795654
Epoch: 4, Steps: 154 | Train Loss: 1.892 Vali Loss: 2.044 Vali Acc: 0.353 Test Loss: 2.044 Test Acc: 0.353
Validation loss decreased (-0.340207 --> -0.353183).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7046373
	speed: 0.4249s/iter; left time: 6239.9827s
Epoch: 5 cost time: 21.265679597854614
Epoch: 5, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.168 Vali Acc: 0.184 Test Loss: 2.168 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5348964
	speed: 0.4528s/iter; left time: 6579.4347s
Epoch: 6 cost time: 21.73594856262207
Epoch: 6, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.183 Vali Acc: 0.357 Test Loss: 2.183 Test Acc: 0.357
Validation loss decreased (-0.353183 --> -0.357237).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8592348
	speed: 0.4175s/iter; left time: 6002.8112s
Epoch: 7 cost time: 17.63832402229309
Epoch: 7, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.149 Vali Acc: 0.208 Test Loss: 2.149 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4194270
	speed: 0.4330s/iter; left time: 6158.6390s
Epoch: 8 cost time: 21.056455373764038
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.781 Vali Acc: 0.121 Test Loss: 2.781 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6607066
	speed: 0.4428s/iter; left time: 6229.3105s
Epoch: 9 cost time: 19.99582052230835
Epoch: 9, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.639 Vali Acc: 0.201 Test Loss: 2.639 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7017843
	speed: 0.4322s/iter; left time: 6013.7776s
Epoch: 10 cost time: 21.574763298034668
Epoch: 10, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.779 Vali Acc: 0.195 Test Loss: 2.779 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4217329
	speed: 0.4101s/iter; left time: 5643.9432s
Epoch: 11 cost time: 17.458970069885254
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.571 Vali Acc: 0.137 Test Loss: 2.571 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7612801
	speed: 0.3939s/iter; left time: 5359.3273s
Epoch: 12 cost time: 20.744713068008423
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.725 Vali Acc: 0.119 Test Loss: 2.725 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2743646
	speed: 0.4185s/iter; left time: 5630.6208s
Epoch: 13 cost time: 19.723087787628174
Epoch: 13, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.915 Vali Acc: 0.311 Test Loss: 2.915 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9173159
	speed: 0.4197s/iter; left time: 5582.2482s
Epoch: 14 cost time: 19.041442155838013
Epoch: 14, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.232 Vali Acc: 0.111 Test Loss: 3.232 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.9304738
	speed: 0.4063s/iter; left time: 5340.8070s
Epoch: 15 cost time: 18.260307788848877
Epoch: 15, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.816 Vali Acc: 0.184 Test Loss: 2.816 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0144144
	speed: 0.3855s/iter; left time: 5007.4909s
Epoch: 16 cost time: 18.803654432296753
Epoch: 16, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.499 Vali Acc: 0.223 Test Loss: 2.499 Test Acc: 0.223
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3572587185725872
model parameter : 767946
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2632082
	speed: 0.1324s/iter; left time: 2026.1858s
Epoch: 1 cost time: 19.639231204986572
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9991865
	speed: 0.3937s/iter; left time: 5964.0163s
Epoch: 2 cost time: 17.283752918243408
Epoch: 2, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.146 Vali Acc: 0.324 Test Loss: 2.146 Test Acc: 0.324
Validation loss decreased (-0.315064 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2520773
	speed: 0.3759s/iter; left time: 5636.0107s
Epoch: 3 cost time: 18.363765239715576
Epoch: 3, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.099 Vali Acc: 0.335 Test Loss: 2.099 Test Acc: 0.335
Validation loss decreased (-0.323580 --> -0.334934).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8435953
	speed: 0.3988s/iter; left time: 5917.1077s
Epoch: 4 cost time: 18.285085439682007
Epoch: 4, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.060 Vali Acc: 0.210 Test Loss: 2.060 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7588502
	speed: 0.3902s/iter; left time: 5730.4277s
Epoch: 5 cost time: 18.12519598007202
Epoch: 5, Steps: 154 | Train Loss: 1.832 Vali Loss: 2.441 Vali Acc: 0.177 Test Loss: 2.441 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0094047
	speed: 0.3971s/iter; left time: 5769.7027s
Epoch: 6 cost time: 20.335400104522705
Epoch: 6, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.450 Vali Acc: 0.137 Test Loss: 2.450 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4042403
	speed: 0.3998s/iter; left time: 5747.7115s
Epoch: 7 cost time: 17.527389526367188
Epoch: 7, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.301 Vali Acc: 0.152 Test Loss: 2.301 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.8573692
	speed: 0.3523s/iter; left time: 5011.1447s
Epoch: 8 cost time: 16.346887588500977
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.438 Vali Acc: 0.217 Test Loss: 2.438 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2627125
	speed: 0.3856s/iter; left time: 5424.4254s
Epoch: 9 cost time: 18.19939088821411
Epoch: 9, Steps: 154 | Train Loss: 1.609 Vali Loss: 3.040 Vali Acc: 0.108 Test Loss: 3.040 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.4692566
	speed: 0.3866s/iter; left time: 5379.0369s
Epoch: 10 cost time: 17.51556921005249
Epoch: 10, Steps: 154 | Train Loss: 1.586 Vali Loss: 3.042 Vali Acc: 0.128 Test Loss: 3.042 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.3309443
	speed: 0.3765s/iter; left time: 5181.1238s
Epoch: 11 cost time: 17.72674322128296
Epoch: 11, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.887 Vali Acc: 0.135 Test Loss: 2.887 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3886834
	speed: 0.3869s/iter; left time: 5265.0984s
Epoch: 12 cost time: 17.814400672912598
Epoch: 12, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.473 Vali Acc: 0.371 Test Loss: 2.473 Test Acc: 0.371
Validation loss decreased (-0.334934 --> -0.371427).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5447978
	speed: 0.3730s/iter; left time: 5017.8010s
Epoch: 13 cost time: 17.41244888305664
Epoch: 13, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.132 Vali Acc: 0.103 Test Loss: 3.132 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2643684
	speed: 0.3811s/iter; left time: 5068.1365s
Epoch: 14 cost time: 16.910259008407593
Epoch: 14, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.143 Vali Acc: 0.167 Test Loss: 3.143 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5052975
	speed: 0.3669s/iter; left time: 4823.3380s
Epoch: 15 cost time: 17.84907627105713
Epoch: 15, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.946 Vali Acc: 0.114 Test Loss: 2.946 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2384634
	speed: 0.3714s/iter; left time: 4824.4376s
Epoch: 16 cost time: 17.269472360610962
Epoch: 16, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.894 Vali Acc: 0.146 Test Loss: 2.894 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5116068
	speed: 0.3820s/iter; left time: 4903.8619s
Epoch: 17 cost time: 18.30769968032837
Epoch: 17, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.044 Vali Acc: 0.191 Test Loss: 3.044 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1375196
	speed: 0.3920s/iter; left time: 4971.3196s
Epoch: 18 cost time: 18.50766921043396
Epoch: 18, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.735 Vali Acc: 0.196 Test Loss: 2.735 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.1261262
	speed: 0.4077s/iter; left time: 5107.9126s
Epoch: 19 cost time: 18.091984510421753
Epoch: 19, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.884 Vali Acc: 0.185 Test Loss: 2.884 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.4227551
	speed: 0.3950s/iter; left time: 4887.6560s
Epoch: 20 cost time: 18.22554850578308
Epoch: 20, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.159 Vali Acc: 0.137 Test Loss: 3.159 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.5195425
	speed: 0.3778s/iter; left time: 4616.5473s
Epoch: 21 cost time: 17.729723930358887
Epoch: 21, Steps: 154 | Train Loss: 1.359 Vali Loss: 3.062 Vali Acc: 0.154 Test Loss: 3.062 Test Acc: 0.154
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3892348
	speed: 0.3755s/iter; left time: 4531.1010s
Epoch: 22 cost time: 18.17469882965088
Epoch: 22, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.039 Vali Acc: 0.204 Test Loss: 3.039 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 767498
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2978683
	speed: 0.1292s/iter; left time: 1977.3011s
Epoch: 1 cost time: 18.740984678268433
Epoch: 1, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.153 Vali Acc: 0.316 Test Loss: 2.153 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9527574
	speed: 0.3794s/iter; left time: 5747.4262s
Epoch: 2 cost time: 17.253553867340088
Epoch: 2, Steps: 154 | Train Loss: 2.101 Vali Loss: 2.127 Vali Acc: 0.320 Test Loss: 2.127 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.320336).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7864814
	speed: 0.3651s/iter; left time: 5473.7471s
Epoch: 3 cost time: 16.92384934425354
Epoch: 3, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.221 Vali Acc: 0.329 Test Loss: 2.221 Test Acc: 0.329
Validation loss decreased (-0.320336 --> -0.328850).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3985080
	speed: 0.3672s/iter; left time: 5449.3008s
Epoch: 4 cost time: 18.304582357406616
Epoch: 4, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.128 Vali Acc: 0.351 Test Loss: 2.128 Test Acc: 0.351
Validation loss decreased (-0.328850 --> -0.350749).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5973252
	speed: 0.3658s/iter; left time: 5372.0087s
Epoch: 5 cost time: 16.67157554626465
Epoch: 5, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.113 Vali Acc: 0.346 Test Loss: 2.113 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0561421
	speed: 0.3424s/iter; left time: 4974.8503s
Epoch: 6 cost time: 16.040164947509766
Epoch: 6, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.485 Vali Acc: 0.383 Test Loss: 2.485 Test Acc: 0.383
Validation loss decreased (-0.350749 --> -0.382781).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8894894
	speed: 0.3598s/iter; left time: 5173.4221s
Epoch: 7 cost time: 16.246723175048828
Epoch: 7, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.066 Vali Acc: 0.381 Test Loss: 2.066 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1281868
	speed: 0.3610s/iter; left time: 5134.7268s
Epoch: 8 cost time: 17.494513273239136
Epoch: 8, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.867 Vali Acc: 0.111 Test Loss: 2.867 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4907069
	speed: 0.3987s/iter; left time: 5609.6396s
Epoch: 9 cost time: 18.116784811019897
Epoch: 9, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.368 Vali Acc: 0.376 Test Loss: 2.368 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5651404
	speed: 0.3782s/iter; left time: 5262.8318s
Epoch: 10 cost time: 17.02087664604187
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.806 Vali Acc: 0.196 Test Loss: 2.806 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3419648
	speed: 0.3887s/iter; left time: 5348.5344s
Epoch: 11 cost time: 18.50475025177002
Epoch: 11, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.661 Vali Acc: 0.171 Test Loss: 2.661 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3565127
	speed: 0.3757s/iter; left time: 5111.7579s
Epoch: 12 cost time: 17.364705562591553
Epoch: 12, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.872 Vali Acc: 0.083 Test Loss: 2.872 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2300888
	speed: 0.3654s/iter; left time: 4915.7073s
Epoch: 13 cost time: 17.4692862033844
Epoch: 13, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.691 Vali Acc: 0.197 Test Loss: 2.691 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.6991497
	speed: 0.3778s/iter; left time: 5024.9386s
Epoch: 14 cost time: 17.8064866065979
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.708 Vali Acc: 0.129 Test Loss: 2.708 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1476526
	speed: 0.3948s/iter; left time: 5189.3937s
Epoch: 15 cost time: 16.679161548614502
Epoch: 15, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.110 Vali Acc: 0.065 Test Loss: 3.110 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2518852
	speed: 0.3572s/iter; left time: 4640.7918s
Epoch: 16 cost time: 17.08195662498474
Epoch: 16, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.830 Vali Acc: 0.197 Test Loss: 2.830 Test Acc: 0.197
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 767050
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5547998
	speed: 0.1338s/iter; left time: 2047.2403s
Epoch: 1 cost time: 19.47313404083252
Epoch: 1, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.178 Vali Acc: 0.316 Test Loss: 2.178 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3713279
	speed: 0.3801s/iter; left time: 5756.7718s
Epoch: 2 cost time: 17.91076397895813
Epoch: 2, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.105 Vali Acc: 0.324 Test Loss: 2.105 Test Acc: 0.324
Validation loss decreased (-0.315874 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0079875
	speed: 0.3745s/iter; left time: 5615.4796s
Epoch: 3 cost time: 17.731038331985474
Epoch: 3, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.179 Vali Acc: 0.322 Test Loss: 2.179 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1930656
	speed: 0.3683s/iter; left time: 5465.6360s
Epoch: 4 cost time: 17.626622915267944
Epoch: 4, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.037 Vali Acc: 0.337 Test Loss: 2.037 Test Acc: 0.337
Validation loss decreased (-0.324391 --> -0.336557).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9629455
	speed: 0.3824s/iter; left time: 5615.9976s
Epoch: 5 cost time: 17.984017372131348
Epoch: 5, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.207 Vali Acc: 0.339 Test Loss: 2.207 Test Acc: 0.339
Validation loss decreased (-0.336557 --> -0.339394).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3301165
	speed: 0.3633s/iter; left time: 5278.7318s
Epoch: 6 cost time: 16.37329864501953
Epoch: 6, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.164 Vali Acc: 0.342 Test Loss: 2.164 Test Acc: 0.342
Validation loss decreased (-0.339394 --> -0.342233).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6603414
	speed: 0.3647s/iter; left time: 5243.1669s
Epoch: 7 cost time: 18.366636991500854
Epoch: 7, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.078 Vali Acc: 0.363 Test Loss: 2.078 Test Acc: 0.363
Validation loss decreased (-0.342233 --> -0.362510).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1223149
	speed: 0.3879s/iter; left time: 5517.3797s
Epoch: 8 cost time: 18.762849807739258
Epoch: 8, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.204 Vali Acc: 0.346 Test Loss: 2.204 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8754117
	speed: 0.4057s/iter; left time: 5708.2221s
Epoch: 9 cost time: 18.41317391395569
Epoch: 9, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.439 Vali Acc: 0.345 Test Loss: 2.439 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3547825
	speed: 0.3837s/iter; left time: 5339.5485s
Epoch: 10 cost time: 17.70096707344055
Epoch: 10, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.188 Vali Acc: 0.376 Test Loss: 2.188 Test Acc: 0.376
Validation loss decreased (-0.362510 --> -0.376296).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2503778
	speed: 0.3941s/iter; left time: 5423.0404s
Epoch: 11 cost time: 19.60369348526001
Epoch: 11, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.668 Vali Acc: 0.208 Test Loss: 2.668 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6198899
	speed: 0.3970s/iter; left time: 5402.1989s
Epoch: 12 cost time: 17.764633655548096
Epoch: 12, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.617 Vali Acc: 0.190 Test Loss: 2.617 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6863804
	speed: 0.4032s/iter; left time: 5424.3342s
Epoch: 13 cost time: 18.743563175201416
Epoch: 13, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.309 Vali Acc: 0.227 Test Loss: 2.309 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2511723
	speed: 0.3730s/iter; left time: 4960.0627s
Epoch: 14 cost time: 17.30485963821411
Epoch: 14, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.647 Vali Acc: 0.283 Test Loss: 2.647 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5383011
	speed: 0.3723s/iter; left time: 4893.3064s
Epoch: 15 cost time: 17.588975191116333
Epoch: 15, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.636 Vali Acc: 0.223 Test Loss: 2.636 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1963664
	speed: 0.3789s/iter; left time: 4922.3937s
Epoch: 16 cost time: 17.549589157104492
Epoch: 16, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.455 Vali Acc: 0.373 Test Loss: 2.455 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3874298
	speed: 0.3463s/iter; left time: 4445.9821s
Epoch: 17 cost time: 15.876543760299683
Epoch: 17, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.791 Vali Acc: 0.158 Test Loss: 2.791 Test Acc: 0.158
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.5894606
	speed: 0.3619s/iter; left time: 4590.4244s
Epoch: 18 cost time: 17.435108184814453
Epoch: 18, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.414 Vali Acc: 0.388 Test Loss: 2.414 Test Acc: 0.388
Validation loss decreased (-0.376296 --> -0.388459).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1636578
	speed: 0.3687s/iter; left time: 4619.5817s
Epoch: 19 cost time: 17.022861003875732
Epoch: 19, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.708 Vali Acc: 0.128 Test Loss: 2.708 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2504127
	speed: 0.3799s/iter; left time: 4700.7432s
Epoch: 20 cost time: 17.26252245903015
Epoch: 20, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.665 Vali Acc: 0.349 Test Loss: 2.665 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4510956
	speed: 0.3755s/iter; left time: 4588.5152s
Epoch: 21 cost time: 17.690224647521973
Epoch: 21, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.675 Vali Acc: 0.125 Test Loss: 2.675 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.6456342
	speed: 0.3750s/iter; left time: 4525.3859s
Epoch: 22 cost time: 18.505971908569336
Epoch: 22, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.958 Vali Acc: 0.159 Test Loss: 2.958 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.4206864
	speed: 0.4039s/iter; left time: 4811.8072s
Epoch: 23 cost time: 18.925584316253662
Epoch: 23, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.127 Vali Acc: 0.118 Test Loss: 3.127 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3499011
	speed: 0.3854s/iter; left time: 4532.0244s
Epoch: 24 cost time: 17.62726902961731
Epoch: 24, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.893 Vali Acc: 0.204 Test Loss: 2.893 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.5875795
	speed: 0.3858s/iter; left time: 4477.4337s
Epoch: 25 cost time: 17.546922206878662
Epoch: 25, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.649 Vali Acc: 0.369 Test Loss: 2.649 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.1958594
	speed: 0.3768s/iter; left time: 4314.4247s
Epoch: 26 cost time: 17.487390995025635
Epoch: 26, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.564 Vali Acc: 0.365 Test Loss: 2.564 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.3616123
	speed: 0.3730s/iter; left time: 4213.3270s
Epoch: 27 cost time: 17.944985151290894
Epoch: 27, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.856 Vali Acc: 0.356 Test Loss: 2.856 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1964742
	speed: 0.3914s/iter; left time: 4361.7139s
Epoch: 28 cost time: 18.098217248916626
Epoch: 28, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.154 Vali Acc: 0.100 Test Loss: 3.154 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 761514
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2743759
	speed: 0.1301s/iter; left time: 1991.4028s
Epoch: 1 cost time: 19.555659770965576
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7633038
	speed: 0.3752s/iter; left time: 5683.3972s
Epoch: 2 cost time: 17.14449644088745
Epoch: 2, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.170 Vali Acc: 0.317 Test Loss: 2.170 Test Acc: 0.317
Validation loss decreased (-0.315064 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5366904
	speed: 0.3717s/iter; left time: 5573.0560s
Epoch: 3 cost time: 17.596185445785522
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.116 Vali Acc: 0.324 Test Loss: 2.116 Test Acc: 0.324
Validation loss decreased (-0.317091 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0605085
	speed: 0.3845s/iter; left time: 5705.7339s
Epoch: 4 cost time: 17.9193913936615
Epoch: 4, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.050 Vali Acc: 0.345 Test Loss: 2.050 Test Acc: 0.345
Validation loss decreased (-0.324391 --> -0.344667).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8150717
	speed: 0.3794s/iter; left time: 5571.9717s
Epoch: 5 cost time: 18.1628999710083
Epoch: 5, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.028 Vali Acc: 0.357 Test Loss: 2.028 Test Acc: 0.357
Validation loss decreased (-0.344667 --> -0.357238).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7918334
	speed: 0.3657s/iter; left time: 5314.3469s
Epoch: 6 cost time: 17.191519260406494
Epoch: 6, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.122 Vali Acc: 0.355 Test Loss: 2.122 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6859524
	speed: 0.3616s/iter; left time: 5198.5702s
Epoch: 7 cost time: 18.16463804244995
Epoch: 7, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.407 Vali Acc: 0.180 Test Loss: 2.407 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8069040
	speed: 0.3830s/iter; left time: 5446.8371s
Epoch: 8 cost time: 18.57538151741028
Epoch: 8, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.278 Vali Acc: 0.341 Test Loss: 2.278 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0591280
	speed: 0.3848s/iter; left time: 5413.6117s
Epoch: 9 cost time: 18.16531014442444
Epoch: 9, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.583 Vali Acc: 0.354 Test Loss: 2.583 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.8337212
	speed: 0.4087s/iter; left time: 5687.3977s
Epoch: 10 cost time: 20.22668218612671
Epoch: 10, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.614 Vali Acc: 0.331 Test Loss: 2.614 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5605878
	speed: 0.4144s/iter; left time: 5702.5272s
Epoch: 11 cost time: 19.394835710525513
Epoch: 11, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.421 Vali Acc: 0.196 Test Loss: 2.421 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4836514
	speed: 0.3957s/iter; left time: 5383.9330s
Epoch: 12 cost time: 18.44302272796631
Epoch: 12, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.397 Vali Acc: 0.374 Test Loss: 2.397 Test Acc: 0.374
Validation loss decreased (-0.357238 --> -0.374266).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9191757
	speed: 0.3915s/iter; left time: 5267.3714s
Epoch: 13 cost time: 18.06152367591858
Epoch: 13, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.254 Vali Acc: 0.360 Test Loss: 2.254 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5731827
	speed: 0.3721s/iter; left time: 4948.3564s
Epoch: 14 cost time: 17.73421621322632
Epoch: 14, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.383 Vali Acc: 0.354 Test Loss: 2.383 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5344818
	speed: 0.3692s/iter; left time: 4853.4162s
Epoch: 15 cost time: 17.79564642906189
Epoch: 15, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.607 Vali Acc: 0.180 Test Loss: 2.607 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1466888
	speed: 0.3533s/iter; left time: 4589.2197s
Epoch: 16 cost time: 17.12553596496582
Epoch: 16, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.381 Vali Acc: 0.378 Test Loss: 2.381 Test Acc: 0.378
Validation loss decreased (-0.374266 --> -0.377511).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8026657
	speed: 0.3842s/iter; left time: 4931.9410s
Epoch: 17 cost time: 18.428079843521118
Epoch: 17, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.701 Vali Acc: 0.358 Test Loss: 2.701 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1380122
	speed: 0.3792s/iter; left time: 4808.9268s
Epoch: 18 cost time: 18.092425107955933
Epoch: 18, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.664 Vali Acc: 0.130 Test Loss: 2.664 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1493104
	speed: 0.3973s/iter; left time: 4977.5049s
Epoch: 19 cost time: 19.713093042373657
Epoch: 19, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.475 Vali Acc: 0.353 Test Loss: 2.475 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.8148749
	speed: 0.3979s/iter; left time: 4923.4354s
Epoch: 20 cost time: 18.003262758255005
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.734 Vali Acc: 0.188 Test Loss: 2.734 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.7858200
	speed: 0.3904s/iter; left time: 4771.1370s
Epoch: 21 cost time: 17.809542894363403
Epoch: 21, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.653 Vali Acc: 0.347 Test Loss: 2.653 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.3738347
	speed: 0.3705s/iter; left time: 4470.7206s
Epoch: 22 cost time: 18.89583969116211
Epoch: 22, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.150 Vali Acc: 0.055 Test Loss: 3.150 Test Acc: 0.055
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.3365517
	speed: 0.4028s/iter; left time: 4798.1350s
Epoch: 23 cost time: 18.393195867538452
Epoch: 23, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.669 Vali Acc: 0.229 Test Loss: 2.669 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.1677089
	speed: 0.3794s/iter; left time: 4461.0497s
Epoch: 24 cost time: 17.699227809906006
Epoch: 24, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.403 Vali Acc: 0.382 Test Loss: 2.403 Test Acc: 0.382
Validation loss decreased (-0.377511 --> -0.381566).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.0932866
	speed: 0.3958s/iter; left time: 4593.1091s
Epoch: 25 cost time: 19.727872610092163
Epoch: 25, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.792 Vali Acc: 0.109 Test Loss: 2.792 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.0665872
	speed: 0.4032s/iter; left time: 4617.0764s
Epoch: 26 cost time: 18.471426725387573
Epoch: 26, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.172 Vali Acc: 0.073 Test Loss: 3.172 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.1325341
	speed: 0.3885s/iter; left time: 4388.5239s
Epoch: 27 cost time: 19.244536638259888
Epoch: 27, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.971 Vali Acc: 0.115 Test Loss: 2.971 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.9068228
	speed: 0.3865s/iter; left time: 4306.7539s
Epoch: 28 cost time: 19.306128978729248
Epoch: 28, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.675 Vali Acc: 0.276 Test Loss: 2.675 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.3606330
	speed: 0.3971s/iter; left time: 4363.1855s
Epoch: 29 cost time: 18.834309101104736
Epoch: 29, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.662 Vali Acc: 0.136 Test Loss: 2.662 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.2277544
	speed: 0.4062s/iter; left time: 4400.7287s
Epoch: 30 cost time: 17.334256649017334
Epoch: 30, Steps: 154 | Train Loss: 1.382 Vali Loss: 4.060 Vali Acc: 0.035 Test Loss: 4.060 Test Acc: 0.035
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.3537942
	speed: 0.3614s/iter; left time: 3859.8799s
Epoch: 31 cost time: 18.350585460662842
Epoch: 31, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.772 Vali Acc: 0.352 Test Loss: 2.772 Test Acc: 0.352
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.5804592
	speed: 0.3890s/iter; left time: 4095.2447s
Epoch: 32 cost time: 18.33231258392334
Epoch: 32, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.791 Vali Acc: 0.141 Test Loss: 2.791 Test Acc: 0.141
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.2060643
	speed: 0.3727s/iter; left time: 3866.2512s
Epoch: 33 cost time: 18.131778955459595
Epoch: 33, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.494 Vali Acc: 0.208 Test Loss: 2.494 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.7052171
	speed: 0.3691s/iter; left time: 3771.8506s
Epoch: 34 cost time: 16.885262489318848
Epoch: 34, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.911 Vali Acc: 0.336 Test Loss: 2.911 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3815896188158962
model parameter : 761290
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7626331
	speed: 0.1433s/iter; left time: 2192.3343s
Epoch: 1 cost time: 21.258557558059692
Epoch: 1, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3186936
	speed: 0.4429s/iter; left time: 6709.3496s
Epoch: 2 cost time: 22.14538836479187
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.120 Vali Acc: 0.330 Test Loss: 2.120 Test Acc: 0.330
Validation loss decreased (-0.315064 --> -0.330474).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9085184
	speed: 0.4158s/iter; left time: 6233.6852s
Epoch: 3 cost time: 19.675453901290894
Epoch: 3, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.126 Vali Acc: 0.323 Test Loss: 2.126 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9687704
	speed: 0.4189s/iter; left time: 6216.5670s
Epoch: 4 cost time: 19.687543630599976
Epoch: 4, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.108 Vali Acc: 0.330 Test Loss: 2.108 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.6323640
	speed: 0.4131s/iter; left time: 6066.6311s
Epoch: 5 cost time: 20.97359800338745
Epoch: 5, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.119 Vali Acc: 0.335 Test Loss: 2.119 Test Acc: 0.335
Validation loss decreased (-0.330474 --> -0.334934).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3745921
	speed: 0.4569s/iter; left time: 6638.7460s
Epoch: 6 cost time: 21.55672025680542
Epoch: 6, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.186 Vali Acc: 0.329 Test Loss: 2.186 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1629264
	speed: 0.4236s/iter; left time: 6089.5023s
Epoch: 7 cost time: 20.252938985824585
Epoch: 7, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.224 Vali Acc: 0.342 Test Loss: 2.224 Test Acc: 0.342
Validation loss decreased (-0.334934 --> -0.341827).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4293905
	speed: 0.4284s/iter; left time: 6092.8173s
Epoch: 8 cost time: 18.516074895858765
Epoch: 8, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.153 Vali Acc: 0.354 Test Loss: 2.153 Test Acc: 0.354
Validation loss decreased (-0.341827 --> -0.353993).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9173101
	speed: 0.4285s/iter; left time: 6028.1772s
Epoch: 9 cost time: 19.197255611419678
Epoch: 9, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.451 Vali Acc: 0.185 Test Loss: 2.451 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1232812
	speed: 0.4380s/iter; left time: 6094.1733s
Epoch: 10 cost time: 20.8548800945282
Epoch: 10, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.449 Vali Acc: 0.264 Test Loss: 2.449 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0612993
	speed: 0.4062s/iter; left time: 5589.6153s
Epoch: 11 cost time: 20.090564250946045
Epoch: 11, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.484 Vali Acc: 0.364 Test Loss: 2.484 Test Acc: 0.364
Validation loss decreased (-0.353993 --> -0.363722).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8080726
	speed: 0.3984s/iter; left time: 5420.7052s
Epoch: 12 cost time: 19.61101007461548
Epoch: 12, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.297 Vali Acc: 0.201 Test Loss: 2.297 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0728593
	speed: 0.4304s/iter; left time: 5790.2588s
Epoch: 13 cost time: 19.900400161743164
Epoch: 13, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.820 Vali Acc: 0.154 Test Loss: 2.820 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2253138
	speed: 0.4006s/iter; left time: 5327.2458s
Epoch: 14 cost time: 20.648969411849976
Epoch: 14, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.470 Vali Acc: 0.349 Test Loss: 2.470 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1671511
	speed: 0.4304s/iter; left time: 5657.3296s
Epoch: 15 cost time: 19.630770444869995
Epoch: 15, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.829 Vali Acc: 0.184 Test Loss: 2.829 Test Acc: 0.184
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2103623
	speed: 0.4086s/iter; left time: 5308.7395s
Epoch: 16 cost time: 18.501483917236328
Epoch: 16, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.708 Vali Acc: 0.338 Test Loss: 2.708 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.6522949
	speed: 0.4150s/iter; left time: 5327.4327s
Epoch: 17 cost time: 20.62212347984314
Epoch: 17, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.883 Vali Acc: 0.155 Test Loss: 2.883 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.5946616
	speed: 0.4216s/iter; left time: 5347.1387s
Epoch: 18 cost time: 20.479246139526367
Epoch: 18, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.351 Vali Acc: 0.359 Test Loss: 2.351 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3887509
	speed: 0.4317s/iter; left time: 5408.6385s
Epoch: 19 cost time: 20.778159856796265
Epoch: 19, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.502 Vali Acc: 0.353 Test Loss: 2.502 Test Acc: 0.353
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2937115
	speed: 0.4316s/iter; left time: 5340.9323s
Epoch: 20 cost time: 21.451822757720947
Epoch: 20, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.424 Vali Acc: 0.364 Test Loss: 2.424 Test Acc: 0.364
Validation loss decreased (-0.363722 --> -0.363723).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3072035
	speed: 0.4520s/iter; left time: 5524.1708s
Epoch: 21 cost time: 21.891674995422363
Epoch: 21, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.417 Vali Acc: 0.367 Test Loss: 2.417 Test Acc: 0.367
Validation loss decreased (-0.363723 --> -0.367372).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6535752
	speed: 0.4343s/iter; left time: 5241.0518s
Epoch: 22 cost time: 19.10736083984375
Epoch: 22, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.218 Vali Acc: 0.373 Test Loss: 2.218 Test Acc: 0.373
Validation loss decreased (-0.367372 --> -0.372646).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6563631
	speed: 0.3959s/iter; left time: 4715.8279s
Epoch: 23 cost time: 18.89582109451294
Epoch: 23, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.735 Vali Acc: 0.123 Test Loss: 2.735 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.8109604
	speed: 0.4260s/iter; left time: 5009.7424s
Epoch: 24 cost time: 20.344439268112183
Epoch: 24, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.514 Vali Acc: 0.370 Test Loss: 2.514 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.5084164
	speed: 0.3817s/iter; left time: 4429.9854s
Epoch: 25 cost time: 19.293540239334106
Epoch: 25, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.798 Vali Acc: 0.136 Test Loss: 2.798 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.1453483
	speed: 0.4005s/iter; left time: 4585.8528s
Epoch: 26 cost time: 18.031157970428467
Epoch: 26, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.524 Vali Acc: 0.143 Test Loss: 2.524 Test Acc: 0.143
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 2.1725404
	speed: 0.4125s/iter; left time: 4659.8233s
Epoch: 27 cost time: 19.008771181106567
Epoch: 27, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.413 Vali Acc: 0.137 Test Loss: 2.413 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.3663026
	speed: 0.4039s/iter; left time: 4500.9163s
Epoch: 28 cost time: 18.532951831817627
Epoch: 28, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.297 Vali Acc: 0.371 Test Loss: 2.297 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.9886066
	speed: 0.3890s/iter; left time: 4274.2712s
Epoch: 29 cost time: 19.79932975769043
Epoch: 29, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.629 Vali Acc: 0.135 Test Loss: 2.629 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.3696551
	speed: 0.3977s/iter; left time: 4308.9372s
Epoch: 30 cost time: 18.517306327819824
Epoch: 30, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.597 Vali Acc: 0.361 Test Loss: 2.597 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.9989198
	speed: 0.4141s/iter; left time: 4422.9409s
Epoch: 31 cost time: 20.312307596206665
Epoch: 31, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.363 Vali Acc: 0.378 Test Loss: 2.363 Test Acc: 0.378
Validation loss decreased (-0.372646 --> -0.377511).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.7870201
	speed: 0.4276s/iter; left time: 4501.0253s
Epoch: 32 cost time: 20.869646310806274
Epoch: 32, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.887 Vali Acc: 0.109 Test Loss: 2.887 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.6691691
	speed: 0.4411s/iter; left time: 4576.0101s
Epoch: 33 cost time: 19.82530379295349
Epoch: 33, Steps: 154 | Train Loss: 1.336 Vali Loss: 3.082 Vali Acc: 0.101 Test Loss: 3.082 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.3735417
	speed: 0.3927s/iter; left time: 4012.5952s
Epoch: 34 cost time: 18.873677730560303
Epoch: 34, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.357 Vali Acc: 0.363 Test Loss: 2.357 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.1846293
	speed: 0.3923s/iter; left time: 3948.7528s
Epoch: 35 cost time: 17.866538286209106
Epoch: 35, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.675 Vali Acc: 0.183 Test Loss: 2.675 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 1.1799755
	speed: 0.3918s/iter; left time: 3883.3016s
Epoch: 36 cost time: 18.870955228805542
Epoch: 36, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.993 Vali Acc: 0.060 Test Loss: 3.993 Test Acc: 0.060
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 1.7217155
	speed: 0.3761s/iter; left time: 3669.9583s
Epoch: 37 cost time: 18.966991662979126
Epoch: 37, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.215 Vali Acc: 0.071 Test Loss: 3.215 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.2792137
	speed: 0.3927s/iter; left time: 3771.4729s
Epoch: 38 cost time: 18.44671893119812
Epoch: 38, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.669 Vali Acc: 0.205 Test Loss: 2.669 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.0829989
	speed: 0.3964s/iter; left time: 3745.2880s
Epoch: 39 cost time: 20.697875499725342
Epoch: 39, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.057 Vali Acc: 0.101 Test Loss: 3.057 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 1.2017630
	speed: 0.4100s/iter; left time: 3811.2434s
Epoch: 40 cost time: 18.976654529571533
Epoch: 40, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.356 Vali Acc: 0.348 Test Loss: 2.356 Test Acc: 0.348
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.9234890
	speed: 0.4040s/iter; left time: 3692.9229s
Epoch: 41 cost time: 19.52347445487976
Epoch: 41, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.325 Vali Acc: 0.380 Test Loss: 2.325 Test Acc: 0.380
Validation loss decreased (-0.377511 --> -0.379944).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.2995520
	speed: 0.3936s/iter; left time: 3537.1687s
Epoch: 42 cost time: 17.343196392059326
Epoch: 42, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.249 Vali Acc: 0.109 Test Loss: 3.249 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.3704706
	speed: 0.4009s/iter; left time: 3540.7403s
Epoch: 43 cost time: 19.429880619049072
Epoch: 43, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.472 Vali Acc: 0.091 Test Loss: 3.472 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.2897509
	speed: 0.4345s/iter; left time: 3771.3294s
Epoch: 44 cost time: 19.994709253311157
Epoch: 44, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.649 Vali Acc: 0.129 Test Loss: 2.649 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 1.4467096
	speed: 0.4105s/iter; left time: 3499.6310s
Epoch: 45 cost time: 19.346829652786255
Epoch: 45, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.558 Vali Acc: 0.084 Test Loss: 2.558 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.1555346
	speed: 0.4087s/iter; left time: 3421.4849s
Epoch: 46 cost time: 18.588316917419434
Epoch: 46, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.977 Vali Acc: 0.073 Test Loss: 2.977 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 1.1046993
	speed: 0.4090s/iter; left time: 3361.0463s
Epoch: 47 cost time: 18.908196449279785
Epoch: 47, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.950 Vali Acc: 0.125 Test Loss: 2.950 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.5903338
	speed: 0.3669s/iter; left time: 2958.2957s
Epoch: 48 cost time: 18.5133273601532
Epoch: 48, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.614 Vali Acc: 0.150 Test Loss: 2.614 Test Acc: 0.150
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 1.4960145
	speed: 0.3990s/iter; left time: 3155.4121s
Epoch: 49 cost time: 19.89430594444275
Epoch: 49, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.384 Vali Acc: 0.379 Test Loss: 2.384 Test Acc: 0.379
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 1.1795208
	speed: 0.3966s/iter; left time: 3075.3226s
Epoch: 50 cost time: 18.348474264144897
Epoch: 50, Steps: 154 | Train Loss: 1.251 Vali Loss: 4.789 Vali Acc: 0.063 Test Loss: 4.789 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.9232268
	speed: 0.3667s/iter; left time: 2787.3218s
Epoch: 51 cost time: 19.611563444137573
Epoch: 51, Steps: 154 | Train Loss: 1.235 Vali Loss: 3.673 Vali Acc: 0.057 Test Loss: 3.673 Test Acc: 0.057
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 761066
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1261001
	speed: 0.1241s/iter; left time: 1899.5492s
Epoch: 1 cost time: 18.02128767967224
Epoch: 1, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.266 Vali Acc: 0.315 Test Loss: 2.266 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9108791
	speed: 0.3488s/iter; left time: 5284.0276s
Epoch: 2 cost time: 15.483731031417847
Epoch: 2, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.190 Vali Acc: 0.326 Test Loss: 2.190 Test Acc: 0.326
Validation loss decreased (-0.315062 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1049232
	speed: 0.3508s/iter; left time: 5259.7245s
Epoch: 3 cost time: 17.437549352645874
Epoch: 3, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.124 Vali Acc: 0.319 Test Loss: 2.124 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2675996
	speed: 0.3790s/iter; left time: 5624.4547s
Epoch: 4 cost time: 17.817961931228638
Epoch: 4, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.087 Vali Acc: 0.325 Test Loss: 2.087 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.2750940
	speed: 0.3735s/iter; left time: 5485.4799s
Epoch: 5 cost time: 17.136840343475342
Epoch: 5, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.050 Vali Acc: 0.350 Test Loss: 2.050 Test Acc: 0.350
Validation loss decreased (-0.326418 --> -0.349939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5478532
	speed: 0.3640s/iter; left time: 5289.1765s
Epoch: 6 cost time: 16.601083040237427
Epoch: 6, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.022 Vali Acc: 0.356 Test Loss: 2.022 Test Acc: 0.356
Validation loss decreased (-0.349939 --> -0.356022).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0152450
	speed: 0.3671s/iter; left time: 5278.3940s
Epoch: 7 cost time: 17.763332843780518
Epoch: 7, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.186 Vali Acc: 0.349 Test Loss: 2.186 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7612237
	speed: 0.3860s/iter; left time: 5489.6103s
Epoch: 8 cost time: 18.627445220947266
Epoch: 8, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.257 Vali Acc: 0.330 Test Loss: 2.257 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9996271
	speed: 0.3728s/iter; left time: 5244.7770s
Epoch: 9 cost time: 16.945068836212158
Epoch: 9, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.423 Vali Acc: 0.346 Test Loss: 2.423 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6072634
	speed: 0.3505s/iter; left time: 4877.4793s
Epoch: 10 cost time: 16.60830330848694
Epoch: 10, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.272 Vali Acc: 0.379 Test Loss: 2.272 Test Acc: 0.379
Validation loss decreased (-0.356022 --> -0.379134).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3943421
	speed: 0.3351s/iter; left time: 4611.1289s
Epoch: 11 cost time: 15.161448240280151
Epoch: 11, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.470 Vali Acc: 0.360 Test Loss: 2.470 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0082219
	speed: 0.3274s/iter; left time: 4454.6415s
Epoch: 12 cost time: 16.153955459594727
Epoch: 12, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.688 Vali Acc: 0.180 Test Loss: 2.688 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4892504
	speed: 0.3416s/iter; left time: 4594.8940s
Epoch: 13 cost time: 16.268451690673828
Epoch: 13, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.715 Vali Acc: 0.188 Test Loss: 2.715 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0933871
	speed: 0.3467s/iter; left time: 4611.1034s
Epoch: 14 cost time: 17.459052085876465
Epoch: 14, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.679 Vali Acc: 0.181 Test Loss: 2.679 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6315346
	speed: 0.3505s/iter; left time: 4607.6392s
Epoch: 15 cost time: 15.79875659942627
Epoch: 15, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.696 Vali Acc: 0.168 Test Loss: 2.696 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1675875
	speed: 0.3554s/iter; left time: 4616.7109s
Epoch: 16 cost time: 16.46836757659912
Epoch: 16, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.099 Vali Acc: 0.368 Test Loss: 2.099 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.0869367
	speed: 0.3730s/iter; left time: 4787.8500s
Epoch: 17 cost time: 17.302475452423096
Epoch: 17, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.357 Vali Acc: 0.152 Test Loss: 2.357 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.7796862
	speed: 0.3869s/iter; left time: 4907.4099s
Epoch: 18 cost time: 18.344587087631226
Epoch: 18, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.968 Vali Acc: 0.096 Test Loss: 2.968 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.7384756
	speed: 0.3796s/iter; left time: 4755.4990s
Epoch: 19 cost time: 16.149413585662842
Epoch: 19, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.488 Vali Acc: 0.114 Test Loss: 2.488 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2605724
	speed: 0.3397s/iter; left time: 4203.2292s
Epoch: 20 cost time: 15.379146337509155
Epoch: 20, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.300 Vali Acc: 0.100 Test Loss: 3.300 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 760842
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3066418
	speed: 0.1202s/iter; left time: 1838.7265s
Epoch: 1 cost time: 17.815573930740356
Epoch: 1, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7611262
	speed: 0.3208s/iter; left time: 4858.5151s
Epoch: 2 cost time: 16.291080951690674
Epoch: 2, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3067653
	speed: 0.3386s/iter; left time: 5076.5166s
Epoch: 3 cost time: 15.860282182693481
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.070 Vali Acc: 0.336 Test Loss: 2.070 Test Acc: 0.336
Validation loss decreased (-0.317497 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9221866
	speed: 0.3498s/iter; left time: 5190.8735s
Epoch: 4 cost time: 17.159282684326172
Epoch: 4, Steps: 154 | Train Loss: 1.969 Vali Loss: 2.088 Vali Acc: 0.342 Test Loss: 2.088 Test Acc: 0.342
Validation loss decreased (-0.336151 --> -0.341828).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7818233
	speed: 0.3676s/iter; left time: 5397.9747s
Epoch: 5 cost time: 17.82260489463806
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.168 Vali Acc: 0.335 Test Loss: 2.168 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6314671
	speed: 0.3842s/iter; left time: 5582.2724s
Epoch: 6 cost time: 17.529491901397705
Epoch: 6, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.202 Vali Acc: 0.331 Test Loss: 2.202 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8262626
	speed: 0.3546s/iter; left time: 5098.3223s
Epoch: 7 cost time: 16.821171760559082
Epoch: 7, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.363 Vali Acc: 0.337 Test Loss: 2.363 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5087720
	speed: 0.3552s/iter; left time: 5051.5345s
Epoch: 8 cost time: 17.12296724319458
Epoch: 8, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.222 Vali Acc: 0.348 Test Loss: 2.222 Test Acc: 0.348
Validation loss decreased (-0.341828 --> -0.347910).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8893534
	speed: 0.3498s/iter; left time: 4921.9875s
Epoch: 9 cost time: 16.923607110977173
Epoch: 9, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.520 Vali Acc: 0.362 Test Loss: 2.520 Test Acc: 0.362
Validation loss decreased (-0.347910 --> -0.361694).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7011988
	speed: 0.3339s/iter; left time: 4646.7942s
Epoch: 10 cost time: 16.87912106513977
Epoch: 10, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.268 Vali Acc: 0.336 Test Loss: 2.268 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5255288
	speed: 0.3439s/iter; left time: 4732.4793s
Epoch: 11 cost time: 16.647525548934937
Epoch: 11, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.633 Vali Acc: 0.208 Test Loss: 2.633 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5560501
	speed: 0.3479s/iter; left time: 4733.4726s
Epoch: 12 cost time: 17.222972869873047
Epoch: 12, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.513 Vali Acc: 0.350 Test Loss: 2.513 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5948944
	speed: 0.3642s/iter; left time: 4899.6577s
Epoch: 13 cost time: 17.485457181930542
Epoch: 13, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.576 Vali Acc: 0.378 Test Loss: 2.576 Test Acc: 0.378
Validation loss decreased (-0.361694 --> -0.377509).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4178910
	speed: 0.3741s/iter; left time: 4974.6338s
Epoch: 14 cost time: 17.897775411605835
Epoch: 14, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.533 Vali Acc: 0.371 Test Loss: 2.533 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4411236
	speed: 0.3635s/iter; left time: 4778.6610s
Epoch: 15 cost time: 17.50524091720581
Epoch: 15, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.148 Vali Acc: 0.103 Test Loss: 3.148 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4436686
	speed: 0.3638s/iter; left time: 4725.5773s
Epoch: 16 cost time: 16.219162702560425
Epoch: 16, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.260 Vali Acc: 0.112 Test Loss: 3.260 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.6266843
	speed: 0.3405s/iter; left time: 4371.4957s
Epoch: 17 cost time: 16.044219970703125
Epoch: 17, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.441 Vali Acc: 0.388 Test Loss: 2.441 Test Acc: 0.388
Validation loss decreased (-0.377509 --> -0.388053).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7578503
	speed: 0.3278s/iter; left time: 4158.1196s
Epoch: 18 cost time: 16.547886848449707
Epoch: 18, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.644 Vali Acc: 0.377 Test Loss: 2.644 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3568504
	speed: 0.3638s/iter; left time: 4558.6384s
Epoch: 19 cost time: 17.547979831695557
Epoch: 19, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.084 Vali Acc: 0.130 Test Loss: 3.084 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6933202
	speed: 0.3662s/iter; left time: 4531.8698s
Epoch: 20 cost time: 17.28279137611389
Epoch: 20, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.651 Vali Acc: 0.368 Test Loss: 2.651 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.5260619
	speed: 0.3293s/iter; left time: 4024.8904s
Epoch: 21 cost time: 17.114614963531494
Epoch: 21, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.488 Vali Acc: 0.357 Test Loss: 2.488 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.4188484
	speed: 0.3523s/iter; left time: 4251.6383s
Epoch: 22 cost time: 16.81986403465271
Epoch: 22, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.582 Vali Acc: 0.170 Test Loss: 2.582 Test Acc: 0.170
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1200918
	speed: 0.3432s/iter; left time: 4088.2623s
Epoch: 23 cost time: 16.7805757522583
Epoch: 23, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.635 Vali Acc: 0.376 Test Loss: 2.635 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.5680336
	speed: 0.3444s/iter; left time: 4049.3298s
Epoch: 24 cost time: 17.11705493927002
Epoch: 24, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.690 Vali Acc: 0.118 Test Loss: 2.690 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.3115064
	speed: 0.3493s/iter; left time: 4053.4270s
Epoch: 25 cost time: 16.44910192489624
Epoch: 25, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.962 Vali Acc: 0.087 Test Loss: 2.962 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.4521923
	speed: 0.3570s/iter; left time: 4087.4767s
Epoch: 26 cost time: 16.550835371017456
Epoch: 26, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.767 Vali Acc: 0.141 Test Loss: 2.767 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.8417130
	speed: 0.3322s/iter; left time: 3752.5439s
Epoch: 27 cost time: 17.265345811843872
Epoch: 27, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.693 Vali Acc: 0.378 Test Loss: 2.693 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 461994
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2704399
	speed: 0.1479s/iter; left time: 2263.0544s
Epoch: 1 cost time: 22.098066568374634
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0928943
	speed: 0.3899s/iter; left time: 5906.3166s
Epoch: 2 cost time: 18.177661657333374
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.170 Vali Acc: 0.316 Test Loss: 2.170 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0342185
	speed: 0.3803s/iter; left time: 5701.2978s
Epoch: 3 cost time: 18.56564688682556
Epoch: 3, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.162 Vali Acc: 0.326 Test Loss: 2.162 Test Acc: 0.326
Validation loss decreased (-0.315874 --> -0.326012).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1233895
	speed: 0.3951s/iter; left time: 5863.0943s
Epoch: 4 cost time: 18.54702854156494
Epoch: 4, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.142 Vali Acc: 0.324 Test Loss: 2.142 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0795591
	speed: 0.3881s/iter; left time: 5699.4563s
Epoch: 5 cost time: 18.51323127746582
Epoch: 5, Steps: 154 | Train Loss: 1.942 Vali Loss: 2.061 Vali Acc: 0.350 Test Loss: 2.061 Test Acc: 0.350
Validation loss decreased (-0.326012 --> -0.349939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4870369
	speed: 0.3641s/iter; left time: 5291.3261s
Epoch: 6 cost time: 18.20640540122986
Epoch: 6, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.093 Vali Acc: 0.341 Test Loss: 2.093 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7052720
	speed: 0.3824s/iter; left time: 5497.5978s
Epoch: 7 cost time: 19.059350728988647
Epoch: 7, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.132 Vali Acc: 0.360 Test Loss: 2.132 Test Acc: 0.360
Validation loss decreased (-0.349939 --> -0.359670).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6383786
	speed: 0.3994s/iter; left time: 5680.0801s
Epoch: 8 cost time: 20.36257314682007
Epoch: 8, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.181 Vali Acc: 0.226 Test Loss: 2.181 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4708086
	speed: 0.4133s/iter; left time: 5814.0418s
Epoch: 9 cost time: 18.649016857147217
Epoch: 9, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.405 Vali Acc: 0.373 Test Loss: 2.405 Test Acc: 0.373
Validation loss decreased (-0.359670 --> -0.372644).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0091021
	speed: 0.3774s/iter; left time: 5251.7185s
Epoch: 10 cost time: 18.824605226516724
Epoch: 10, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.327 Vali Acc: 0.197 Test Loss: 2.327 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2941999
	speed: 0.4077s/iter; left time: 5610.5710s
Epoch: 11 cost time: 20.774498462677002
Epoch: 11, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.617 Vali Acc: 0.360 Test Loss: 2.617 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3881296
	speed: 0.3737s/iter; left time: 5084.3433s
Epoch: 12 cost time: 18.80161428451538
Epoch: 12, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.473 Vali Acc: 0.358 Test Loss: 2.473 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.0228691
	speed: 0.3776s/iter; left time: 5080.3835s
Epoch: 13 cost time: 17.724244594573975
Epoch: 13, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.580 Vali Acc: 0.366 Test Loss: 2.580 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2348779
	speed: 0.3511s/iter; left time: 4669.1931s
Epoch: 14 cost time: 17.61124849319458
Epoch: 14, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.933 Vali Acc: 0.153 Test Loss: 2.933 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3722544
	speed: 0.3907s/iter; left time: 5136.3123s
Epoch: 15 cost time: 19.86621356010437
Epoch: 15, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.803 Vali Acc: 0.343 Test Loss: 2.803 Test Acc: 0.343
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2421734
	speed: 0.3774s/iter; left time: 4903.0288s
Epoch: 16 cost time: 18.5494544506073
Epoch: 16, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.790 Vali Acc: 0.182 Test Loss: 2.790 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3353256
	speed: 0.3612s/iter; left time: 4636.5612s
Epoch: 17 cost time: 17.132161855697632
Epoch: 17, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.948 Vali Acc: 0.150 Test Loss: 2.948 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.4216038
	speed: 0.3602s/iter; left time: 4567.9783s
Epoch: 18 cost time: 18.549591541290283
Epoch: 18, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.657 Vali Acc: 0.106 Test Loss: 2.657 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.0275638
	speed: 0.3958s/iter; left time: 4959.1651s
Epoch: 19 cost time: 18.57419514656067
Epoch: 19, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.372 Vali Acc: 0.093 Test Loss: 3.372 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 461770
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5072157
	speed: 0.1349s/iter; left time: 2064.1365s
Epoch: 1 cost time: 18.82185697555542
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1627393
	speed: 0.3456s/iter; left time: 5234.8543s
Epoch: 2 cost time: 17.264835357666016
Epoch: 2, Steps: 154 | Train Loss: 2.112 Vali Loss: 2.159 Vali Acc: 0.317 Test Loss: 2.159 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3225052
	speed: 0.3232s/iter; left time: 4845.2508s
Epoch: 3 cost time: 15.985684633255005
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.123 Vali Acc: 0.322 Test Loss: 2.123 Test Acc: 0.322
Validation loss decreased (-0.316686 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4908092
	speed: 0.3328s/iter; left time: 4938.2555s
Epoch: 4 cost time: 16.543314933776855
Epoch: 4, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.136 Vali Acc: 0.166 Test Loss: 2.136 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6001252
	speed: 0.3524s/iter; left time: 5175.7280s
Epoch: 5 cost time: 17.361901998519897
Epoch: 5, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.067 Vali Acc: 0.343 Test Loss: 2.067 Test Acc: 0.343
Validation loss decreased (-0.321552 --> -0.343451).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5289482
	speed: 0.3578s/iter; left time: 5198.8241s
Epoch: 6 cost time: 17.542430639266968
Epoch: 6, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.107 Vali Acc: 0.341 Test Loss: 2.107 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9631988
	speed: 0.3376s/iter; left time: 4853.1272s
Epoch: 7 cost time: 15.584806203842163
Epoch: 7, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.112 Vali Acc: 0.356 Test Loss: 2.112 Test Acc: 0.356
Validation loss decreased (-0.343451 --> -0.356021).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8129840
	speed: 0.3241s/iter; left time: 4609.2194s
Epoch: 8 cost time: 16.076641082763672
Epoch: 8, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.231 Vali Acc: 0.356 Test Loss: 2.231 Test Acc: 0.356
Validation loss decreased (-0.356021 --> -0.356425).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5814273
	speed: 0.3441s/iter; left time: 4841.7903s
Epoch: 9 cost time: 16.732988119125366
Epoch: 9, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.622 Vali Acc: 0.122 Test Loss: 2.622 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9675553
	speed: 0.3592s/iter; left time: 4997.6766s
Epoch: 10 cost time: 17.393937587738037
Epoch: 10, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.138 Vali Acc: 0.365 Test Loss: 2.138 Test Acc: 0.365
Validation loss decreased (-0.356425 --> -0.364537).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0745506
	speed: 0.3410s/iter; left time: 4693.0076s
Epoch: 11 cost time: 17.374022960662842
Epoch: 11, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.662 Vali Acc: 0.184 Test Loss: 2.662 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7168977
	speed: 0.3524s/iter; left time: 4795.1726s
Epoch: 12 cost time: 17.06264853477478
Epoch: 12, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.340 Vali Acc: 0.349 Test Loss: 2.340 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3926433
	speed: 0.3508s/iter; left time: 4718.9038s
Epoch: 13 cost time: 17.597659587860107
Epoch: 13, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.570 Vali Acc: 0.193 Test Loss: 2.570 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6674308
	speed: 0.3624s/iter; left time: 4819.3176s
Epoch: 14 cost time: 17.80019211769104
Epoch: 14, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.545 Vali Acc: 0.356 Test Loss: 2.545 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2376497
	speed: 0.3236s/iter; left time: 4254.2441s
Epoch: 15 cost time: 15.815114259719849
Epoch: 15, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.590 Vali Acc: 0.360 Test Loss: 2.590 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1879747
	speed: 0.3191s/iter; left time: 4145.1833s
Epoch: 16 cost time: 15.888761758804321
Epoch: 16, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.569 Vali Acc: 0.374 Test Loss: 2.569 Test Acc: 0.374
Validation loss decreased (-0.364537 --> -0.373859).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3328457
	speed: 0.3230s/iter; left time: 4145.7702s
Epoch: 17 cost time: 15.413892030715942
Epoch: 17, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.496 Vali Acc: 0.372 Test Loss: 2.496 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0499523
	speed: 0.3281s/iter; left time: 4161.3352s
Epoch: 18 cost time: 16.806891918182373
Epoch: 18, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.623 Vali Acc: 0.356 Test Loss: 2.623 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.6167334
	speed: 0.3544s/iter; left time: 4439.9064s
Epoch: 19 cost time: 17.9361252784729
Epoch: 19, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.610 Vali Acc: 0.363 Test Loss: 2.610 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2925910
	speed: 0.3431s/iter; left time: 4246.4315s
Epoch: 20 cost time: 16.09265422821045
Epoch: 20, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.634 Vali Acc: 0.267 Test Loss: 2.634 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.8939683
	speed: 0.3297s/iter; left time: 4028.9151s
Epoch: 21 cost time: 16.122877836227417
Epoch: 21, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.168 Vali Acc: 0.113 Test Loss: 3.168 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0922111
	speed: 0.3478s/iter; left time: 4196.6540s
Epoch: 22 cost time: 18.20375657081604
Epoch: 22, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.414 Vali Acc: 0.345 Test Loss: 2.414 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.4807611
	speed: 0.3433s/iter; left time: 4089.6834s
Epoch: 23 cost time: 17.16815948486328
Epoch: 23, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.493 Vali Acc: 0.357 Test Loss: 2.493 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.9650809
	speed: 0.3489s/iter; left time: 4103.0421s
Epoch: 24 cost time: 17.28663444519043
Epoch: 24, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.616 Vali Acc: 0.148 Test Loss: 2.616 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.8981655
	speed: 0.3382s/iter; left time: 3924.6000s
Epoch: 25 cost time: 16.44198441505432
Epoch: 25, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.522 Vali Acc: 0.201 Test Loss: 2.522 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.8767557
	speed: 0.3350s/iter; left time: 3836.5248s
Epoch: 26 cost time: 16.323650360107422
Epoch: 26, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.610 Vali Acc: 0.201 Test Loss: 2.610 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 461546
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1624711
	speed: 0.1242s/iter; left time: 1900.2715s
Epoch: 1 cost time: 18.410194635391235
Epoch: 1, Steps: 154 | Train Loss: 2.197 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1907520
	speed: 0.3337s/iter; left time: 5055.1954s
Epoch: 2 cost time: 16.371442556381226
Epoch: 2, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.138 Vali Acc: 0.318 Test Loss: 2.138 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.317902).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7978749
	speed: 0.3226s/iter; left time: 4836.4725s
Epoch: 3 cost time: 15.72965121269226
Epoch: 3, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.125 Vali Acc: 0.320 Test Loss: 2.125 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319930).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1477807
	speed: 0.3483s/iter; left time: 5168.2674s
Epoch: 4 cost time: 16.67899465560913
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.153 Vali Acc: 0.321 Test Loss: 2.153 Test Acc: 0.321
Validation loss decreased (-0.319930 --> -0.321146).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2815869
	speed: 0.3220s/iter; left time: 4728.5020s
Epoch: 5 cost time: 16.242136478424072
Epoch: 5, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.076 Vali Acc: 0.343 Test Loss: 2.076 Test Acc: 0.343
Validation loss decreased (-0.321146 --> -0.343450).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3106532
	speed: 0.3534s/iter; left time: 5135.1935s
Epoch: 6 cost time: 17.21725630760193
Epoch: 6, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.081 Vali Acc: 0.353 Test Loss: 2.081 Test Acc: 0.353
Validation loss decreased (-0.343450 --> -0.352777).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2814882
	speed: 0.3409s/iter; left time: 4901.5970s
Epoch: 7 cost time: 15.5932137966156
Epoch: 7, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.089 Vali Acc: 0.354 Test Loss: 2.089 Test Acc: 0.354
Validation loss decreased (-0.352777 --> -0.353588).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7198223
	speed: 0.3293s/iter; left time: 4684.2447s
Epoch: 8 cost time: 15.348281383514404
Epoch: 8, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.327 Vali Acc: 0.355 Test Loss: 2.327 Test Acc: 0.355
Validation loss decreased (-0.353588 --> -0.354802).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8921430
	speed: 0.3388s/iter; left time: 4766.4759s
Epoch: 9 cost time: 16.89896297454834
Epoch: 9, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.593 Vali Acc: 0.134 Test Loss: 2.593 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7903829
	speed: 0.3429s/iter; left time: 4771.3116s
Epoch: 10 cost time: 16.30958652496338
Epoch: 10, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.710 Vali Acc: 0.176 Test Loss: 2.710 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8945463
	speed: 0.3354s/iter; left time: 4614.8817s
Epoch: 11 cost time: 16.058528184890747
Epoch: 11, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.312 Vali Acc: 0.363 Test Loss: 2.312 Test Acc: 0.363
Validation loss decreased (-0.354802 --> -0.362507).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3886385
	speed: 0.3425s/iter; left time: 4659.8119s
Epoch: 12 cost time: 16.578084468841553
Epoch: 12, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.539 Vali Acc: 0.345 Test Loss: 2.539 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5043225
	speed: 0.3561s/iter; left time: 4790.4612s
Epoch: 13 cost time: 17.05298686027527
Epoch: 13, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.634 Vali Acc: 0.376 Test Loss: 2.634 Test Acc: 0.376
Validation loss decreased (-0.362507 --> -0.375886).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7626631
	speed: 0.3416s/iter; left time: 4543.1923s
Epoch: 14 cost time: 16.265695333480835
Epoch: 14, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.294 Vali Acc: 0.397 Test Loss: 2.294 Test Acc: 0.397
Validation loss decreased (-0.375886 --> -0.396571).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3289196
	speed: 0.3445s/iter; left time: 4528.2579s
Epoch: 15 cost time: 16.267881631851196
Epoch: 15, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.478 Vali Acc: 0.365 Test Loss: 2.478 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3182538
	speed: 0.3202s/iter; left time: 4160.2488s
Epoch: 16 cost time: 16.046111822128296
Epoch: 16, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.620 Vali Acc: 0.113 Test Loss: 2.620 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.6637430
	speed: 0.3369s/iter; left time: 4324.6939s
Epoch: 17 cost time: 15.876253604888916
Epoch: 17, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.467 Vali Acc: 0.362 Test Loss: 2.467 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.8361393
	speed: 0.3384s/iter; left time: 4292.2122s
Epoch: 18 cost time: 16.44373893737793
Epoch: 18, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.835 Vali Acc: 0.152 Test Loss: 2.835 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2638065
	speed: 0.3344s/iter; left time: 4190.1839s
Epoch: 19 cost time: 15.565623760223389
Epoch: 19, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.765 Vali Acc: 0.387 Test Loss: 2.765 Test Acc: 0.387
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.8414721
	speed: 0.3227s/iter; left time: 3992.9710s
Epoch: 20 cost time: 15.783110618591309
Epoch: 20, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.718 Vali Acc: 0.362 Test Loss: 2.718 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3147310
	speed: 0.3360s/iter; left time: 4106.2192s
Epoch: 21 cost time: 16.170119047164917
Epoch: 21, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.000 Vali Acc: 0.205 Test Loss: 3.000 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.9360684
	speed: 0.3168s/iter; left time: 3822.6699s
Epoch: 22 cost time: 16.34154176712036
Epoch: 22, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.788 Vali Acc: 0.145 Test Loss: 2.788 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.3190492
	speed: 0.3309s/iter; left time: 3942.4300s
Epoch: 23 cost time: 16.031943559646606
Epoch: 23, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.714 Vali Acc: 0.374 Test Loss: 2.714 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.5744301
	speed: 0.3352s/iter; left time: 3941.8380s
Epoch: 24 cost time: 17.00620722770691
Epoch: 24, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.692 Vali Acc: 0.380 Test Loss: 2.692 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39659367396593675
model parameter : 461322
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8369997
	speed: 0.1464s/iter; left time: 2239.8415s
Epoch: 1 cost time: 21.58231806755066
Epoch: 1, Steps: 154 | Train Loss: 2.275 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0528924
	speed: 0.4207s/iter; left time: 6372.6273s
Epoch: 2 cost time: 20.450021982192993
Epoch: 2, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.140 Vali Acc: 0.316 Test Loss: 2.140 Test Acc: 0.316
Validation loss decreased (-0.314658 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0103083
	speed: 0.3964s/iter; left time: 5943.6831s
Epoch: 3 cost time: 19.3328115940094
Epoch: 3, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.137 Vali Acc: 0.319 Test Loss: 2.137 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8006195
	speed: 0.3749s/iter; left time: 5563.6192s
Epoch: 4 cost time: 18.07746171951294
Epoch: 4, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.085 Vali Acc: 0.334 Test Loss: 2.085 Test Acc: 0.334
Validation loss decreased (-0.318713 --> -0.333718).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1521099
	speed: 0.3513s/iter; left time: 5159.0538s
Epoch: 5 cost time: 16.539764165878296
Epoch: 5, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.383 Vali Acc: 0.170 Test Loss: 2.383 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8364234
	speed: 0.3553s/iter; left time: 5162.3512s
Epoch: 6 cost time: 17.250607013702393
Epoch: 6, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.223 Vali Acc: 0.331 Test Loss: 2.223 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3557825
	speed: 0.3819s/iter; left time: 5489.8956s
Epoch: 7 cost time: 19.46562361717224
Epoch: 7, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.432 Vali Acc: 0.189 Test Loss: 2.432 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5860875
	speed: 0.3520s/iter; left time: 5006.3231s
Epoch: 8 cost time: 15.699149370193481
Epoch: 8, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.650 Vali Acc: 0.176 Test Loss: 2.650 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2713578
	speed: 0.3338s/iter; left time: 4696.1057s
Epoch: 9 cost time: 17.45369601249695
Epoch: 9, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.496 Vali Acc: 0.179 Test Loss: 2.496 Test Acc: 0.179
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3224487
	speed: 0.3626s/iter; left time: 5045.5070s
Epoch: 10 cost time: 19.09665822982788
Epoch: 10, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.893 Vali Acc: 0.164 Test Loss: 2.893 Test Acc: 0.164
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3257393
	speed: 0.3839s/iter; left time: 5282.9120s
Epoch: 11 cost time: 19.029099941253662
Epoch: 11, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.882 Vali Acc: 0.188 Test Loss: 2.882 Test Acc: 0.188
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.8027766
	speed: 0.3718s/iter; left time: 5059.3686s
Epoch: 12 cost time: 17.012503147125244
Epoch: 12, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.706 Vali Acc: 0.236 Test Loss: 2.706 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.5101657
	speed: 0.3557s/iter; left time: 4785.0482s
Epoch: 13 cost time: 18.263554334640503
Epoch: 13, Steps: 154 | Train Loss: 1.519 Vali Loss: 3.093 Vali Acc: 0.112 Test Loss: 3.093 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.5307827
	speed: 0.3700s/iter; left time: 4920.0752s
Epoch: 14 cost time: 18.371387004852295
Epoch: 14, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.994 Vali Acc: 0.185 Test Loss: 2.994 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3337388483373885
model parameter : 312234
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6938239
	speed: 0.1229s/iter; left time: 1879.8737s
Epoch: 1 cost time: 17.91368556022644
Epoch: 1, Steps: 154 | Train Loss: 2.201 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7539824
	speed: 0.3467s/iter; left time: 5251.2238s
Epoch: 2 cost time: 16.28241539001465
Epoch: 2, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.148 Vali Acc: 0.316 Test Loss: 2.148 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0856037
	speed: 0.3514s/iter; left time: 5268.3502s
Epoch: 3 cost time: 16.79947328567505
Epoch: 3, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.146 Vali Acc: 0.325 Test Loss: 2.146 Test Acc: 0.325
Validation loss decreased (-0.316280 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0785372
	speed: 0.3321s/iter; left time: 4928.5607s
Epoch: 4 cost time: 15.672528266906738
Epoch: 4, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.078 Vali Acc: 0.338 Test Loss: 2.078 Test Acc: 0.338
Validation loss decreased (-0.324796 --> -0.338179).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9414535
	speed: 0.3271s/iter; left time: 4803.5362s
Epoch: 5 cost time: 16.57608675956726
Epoch: 5, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.137 Vali Acc: 0.339 Test Loss: 2.137 Test Acc: 0.339
Validation loss decreased (-0.338179 --> -0.338989).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1188505
	speed: 0.3250s/iter; left time: 4722.5277s
Epoch: 6 cost time: 14.785436391830444
Epoch: 6, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.152 Vali Acc: 0.347 Test Loss: 2.152 Test Acc: 0.347
Validation loss decreased (-0.338989 --> -0.346694).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1797934
	speed: 0.3321s/iter; left time: 4774.4898s
Epoch: 7 cost time: 15.959017038345337
Epoch: 7, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.200 Vali Acc: 0.298 Test Loss: 2.200 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3488134
	speed: 0.3449s/iter; left time: 4906.1166s
Epoch: 8 cost time: 16.606207132339478
Epoch: 8, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.347 Vali Acc: 0.186 Test Loss: 2.347 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5942637
	speed: 0.3251s/iter; left time: 4573.8334s
Epoch: 9 cost time: 15.448365926742554
Epoch: 9, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.162 Vali Acc: 0.380 Test Loss: 2.162 Test Acc: 0.380
Validation loss decreased (-0.346694 --> -0.379946).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9448175
	speed: 0.3531s/iter; left time: 4914.0552s
Epoch: 10 cost time: 16.308943033218384
Epoch: 10, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.412 Vali Acc: 0.130 Test Loss: 2.412 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0756351
	speed: 0.3314s/iter; left time: 4559.9126s
Epoch: 11 cost time: 15.86994743347168
Epoch: 11, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.519 Vali Acc: 0.251 Test Loss: 2.519 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.0431557
	speed: 0.3184s/iter; left time: 4332.6339s
Epoch: 12 cost time: 15.737203598022461
Epoch: 12, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.811 Vali Acc: 0.096 Test Loss: 2.811 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7264698
	speed: 0.3265s/iter; left time: 4392.9882s
Epoch: 13 cost time: 15.991769552230835
Epoch: 13, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.651 Vali Acc: 0.185 Test Loss: 2.651 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.8509346
	speed: 0.3207s/iter; left time: 4264.3506s
Epoch: 14 cost time: 15.752618312835693
Epoch: 14, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.164 Vali Acc: 0.175 Test Loss: 3.164 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8606550
	speed: 0.3229s/iter; left time: 4244.3351s
Epoch: 15 cost time: 16.060078620910645
Epoch: 15, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.255 Vali Acc: 0.109 Test Loss: 3.255 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.6636240
	speed: 0.3421s/iter; left time: 4444.8060s
Epoch: 16 cost time: 16.602092266082764
Epoch: 16, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.058 Vali Acc: 0.170 Test Loss: 3.058 Test Acc: 0.170
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4367012
	speed: 0.3273s/iter; left time: 4201.4730s
Epoch: 17 cost time: 15.789639711380005
Epoch: 17, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.842 Vali Acc: 0.243 Test Loss: 2.842 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6332023
	speed: 0.3305s/iter; left time: 4191.4164s
Epoch: 18 cost time: 16.37523365020752
Epoch: 18, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.032 Vali Acc: 0.189 Test Loss: 3.032 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.6006527
	speed: 0.3227s/iter; left time: 4043.1135s
Epoch: 19 cost time: 15.382487535476685
Epoch: 19, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.271 Vali Acc: 0.122 Test Loss: 3.271 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 312010
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0001245
	speed: 0.1202s/iter; left time: 1839.0838s
Epoch: 1 cost time: 18.082677364349365
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9800246
	speed: 0.3315s/iter; left time: 5021.1544s
Epoch: 2 cost time: 16.24201512336731
Epoch: 2, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.151 Vali Acc: 0.320 Test Loss: 2.151 Test Acc: 0.320
Validation loss decreased (-0.315063 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9396459
	speed: 0.3252s/iter; left time: 4875.9167s
Epoch: 3 cost time: 15.32735800743103
Epoch: 3, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.117 Vali Acc: 0.327 Test Loss: 2.117 Test Acc: 0.327
Validation loss decreased (-0.319524 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8530041
	speed: 0.3316s/iter; left time: 4920.0052s
Epoch: 4 cost time: 15.901644706726074
Epoch: 4, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.161 Vali Acc: 0.337 Test Loss: 2.161 Test Acc: 0.337
Validation loss decreased (-0.326824 --> -0.336961).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2110341
	speed: 0.3492s/iter; left time: 5128.3147s
Epoch: 5 cost time: 16.55334782600403
Epoch: 5, Steps: 154 | Train Loss: 1.879 Vali Loss: 1.969 Vali Acc: 0.366 Test Loss: 1.969 Test Acc: 0.366
Validation loss decreased (-0.336961 --> -0.365755).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4163318
	speed: 0.3216s/iter; left time: 4673.5271s
Epoch: 6 cost time: 15.867879629135132
Epoch: 6, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.288 Vali Acc: 0.184 Test Loss: 2.288 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6744150
	speed: 0.3246s/iter; left time: 4667.0775s
Epoch: 7 cost time: 15.784350395202637
Epoch: 7, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.215 Vali Acc: 0.358 Test Loss: 2.215 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5365624
	speed: 0.3168s/iter; left time: 4505.8856s
Epoch: 8 cost time: 15.414762735366821
Epoch: 8, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.622 Vali Acc: 0.107 Test Loss: 2.622 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5328077
	speed: 0.3038s/iter; left time: 4274.3562s
Epoch: 9 cost time: 15.317228078842163
Epoch: 9, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.379 Vali Acc: 0.136 Test Loss: 2.379 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1559191
	speed: 0.3338s/iter; left time: 4644.3261s
Epoch: 10 cost time: 16.952900648117065
Epoch: 10, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.906 Vali Acc: 0.112 Test Loss: 2.906 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6031318
	speed: 0.3198s/iter; left time: 4401.3243s
Epoch: 11 cost time: 16.234458684921265
Epoch: 11, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.627 Vali Acc: 0.130 Test Loss: 2.627 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.7434506
	speed: 0.3119s/iter; left time: 4243.8358s
Epoch: 12 cost time: 15.838270664215088
Epoch: 12, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.831 Vali Acc: 0.181 Test Loss: 2.831 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1317186
	speed: 0.3318s/iter; left time: 4464.3388s
Epoch: 13 cost time: 17.13943862915039
Epoch: 13, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.140 Vali Acc: 0.145 Test Loss: 3.140 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.8444371
	speed: 0.3519s/iter; left time: 4680.4541s
Epoch: 14 cost time: 16.494361400604248
Epoch: 14, Steps: 154 | Train Loss: 1.526 Vali Loss: 3.385 Vali Acc: 0.107 Test Loss: 3.385 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2252951
	speed: 0.3321s/iter; left time: 4364.9745s
Epoch: 15 cost time: 16.079142093658447
Epoch: 15, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.844 Vali Acc: 0.112 Test Loss: 2.844 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3657745336577453
model parameter : 311786
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1042218
	speed: 0.1272s/iter; left time: 1946.4317s
Epoch: 1 cost time: 18.808294773101807
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9801074
	speed: 0.3440s/iter; left time: 5209.9658s
Epoch: 2 cost time: 18.810974836349487
Epoch: 2, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.131 Vali Acc: 0.318 Test Loss: 2.131 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0308232
	speed: 0.3579s/iter; left time: 5366.4579s
Epoch: 3 cost time: 17.644249439239502
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.137 Vali Acc: 0.319 Test Loss: 2.137 Test Acc: 0.319
Validation loss decreased (-0.317497 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6653614
	speed: 0.3854s/iter; left time: 5719.0378s
Epoch: 4 cost time: 18.924419164657593
Epoch: 4, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.070 Vali Acc: 0.338 Test Loss: 2.070 Test Acc: 0.338
Validation loss decreased (-0.318713 --> -0.337773).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0351412
	speed: 0.3541s/iter; left time: 5200.5508s
Epoch: 5 cost time: 15.917829275131226
Epoch: 5, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.097 Vali Acc: 0.356 Test Loss: 2.097 Test Acc: 0.356
Validation loss decreased (-0.337773 --> -0.355616).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8799878
	speed: 0.3439s/iter; left time: 4997.6016s
Epoch: 6 cost time: 18.015179872512817
Epoch: 6, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.017 Vali Acc: 0.363 Test Loss: 2.017 Test Acc: 0.363
Validation loss decreased (-0.355616 --> -0.362916).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8071364
	speed: 0.3692s/iter; left time: 5308.3745s
Epoch: 7 cost time: 17.42929434776306
Epoch: 7, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.242 Vali Acc: 0.345 Test Loss: 2.242 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8094614
	speed: 0.3643s/iter; left time: 5182.0748s
Epoch: 8 cost time: 18.31529712677002
Epoch: 8, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.644 Vali Acc: 0.351 Test Loss: 2.644 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2755228
	speed: 0.3498s/iter; left time: 4921.8030s
Epoch: 9 cost time: 15.977842330932617
Epoch: 9, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.620 Vali Acc: 0.191 Test Loss: 2.620 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3188781
	speed: 0.3364s/iter; left time: 4680.7186s
Epoch: 10 cost time: 17.242454528808594
Epoch: 10, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.699 Vali Acc: 0.187 Test Loss: 2.699 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5591564
	speed: 0.3663s/iter; left time: 5040.7728s
Epoch: 11 cost time: 17.678297996520996
Epoch: 11, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.699 Vali Acc: 0.212 Test Loss: 2.699 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.6443342
	speed: 0.3492s/iter; left time: 4751.7337s
Epoch: 12 cost time: 17.058695316314697
Epoch: 12, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.544 Vali Acc: 0.367 Test Loss: 2.544 Test Acc: 0.367
Validation loss decreased (-0.362916 --> -0.366560).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1931717
	speed: 0.3232s/iter; left time: 4348.6586s
Epoch: 13 cost time: 17.480042219161987
Epoch: 13, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.749 Vali Acc: 0.337 Test Loss: 2.749 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5274363
	speed: 0.3253s/iter; left time: 4325.8939s
Epoch: 14 cost time: 16.427883863449097
Epoch: 14, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.900 Vali Acc: 0.189 Test Loss: 2.900 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7286727
	speed: 0.3155s/iter; left time: 4147.5970s
Epoch: 15 cost time: 15.71136212348938
Epoch: 15, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.624 Vali Acc: 0.232 Test Loss: 2.624 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0353818
	speed: 0.3217s/iter; left time: 4179.8238s
Epoch: 16 cost time: 15.07174038887024
Epoch: 16, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.788 Vali Acc: 0.116 Test Loss: 2.788 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5607592
	speed: 0.3140s/iter; left time: 4030.8157s
Epoch: 17 cost time: 15.687570571899414
Epoch: 17, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.729 Vali Acc: 0.364 Test Loss: 2.729 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3199248
	speed: 0.3230s/iter; left time: 4096.5216s
Epoch: 18 cost time: 15.822802543640137
Epoch: 18, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.180 Vali Acc: 0.104 Test Loss: 3.180 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3610809
	speed: 0.3254s/iter; left time: 4077.3844s
Epoch: 19 cost time: 15.797981023788452
Epoch: 19, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.242 Vali Acc: 0.081 Test Loss: 3.242 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.5062939
	speed: 0.3401s/iter; left time: 4209.1811s
Epoch: 20 cost time: 16.58966040611267
Epoch: 20, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.068 Vali Acc: 0.187 Test Loss: 3.068 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.5065310
	speed: 0.3389s/iter; left time: 4142.1124s
Epoch: 21 cost time: 16.712122917175293
Epoch: 21, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.797 Vali Acc: 0.386 Test Loss: 2.797 Test Acc: 0.386
Validation loss decreased (-0.366560 --> -0.385617).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6390847
	speed: 0.3241s/iter; left time: 3911.3219s
Epoch: 22 cost time: 15.914798974990845
Epoch: 22, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.126 Vali Acc: 0.221 Test Loss: 3.126 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2964151
	speed: 0.3098s/iter; left time: 3690.8183s
Epoch: 23 cost time: 14.822544574737549
Epoch: 23, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.136 Vali Acc: 0.094 Test Loss: 3.136 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.6615988
	speed: 0.3259s/iter; left time: 3831.8597s
Epoch: 24 cost time: 17.013476371765137
Epoch: 24, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.782 Vali Acc: 0.121 Test Loss: 2.782 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.0064411
	speed: 0.3258s/iter; left time: 3781.3397s
Epoch: 25 cost time: 15.600092649459839
Epoch: 25, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.163 Vali Acc: 0.114 Test Loss: 3.163 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2100855
	speed: 0.3316s/iter; left time: 3797.4136s
Epoch: 26 cost time: 16.759191274642944
Epoch: 26, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.042 Vali Acc: 0.128 Test Loss: 3.042 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.0596900
	speed: 0.3128s/iter; left time: 3533.3591s
Epoch: 27 cost time: 14.646626710891724
Epoch: 27, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.547 Vali Acc: 0.374 Test Loss: 2.547 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.2625513
	speed: 0.2916s/iter; left time: 3248.9165s
Epoch: 28 cost time: 15.089555501937866
Epoch: 28, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.808 Vali Acc: 0.124 Test Loss: 2.808 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.9148247
	speed: 0.3080s/iter; left time: 3384.6505s
Epoch: 29 cost time: 15.368252992630005
Epoch: 29, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.119 Vali Acc: 0.083 Test Loss: 3.119 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.4195657
	speed: 0.3106s/iter; left time: 3364.9466s
Epoch: 30 cost time: 14.921432495117188
Epoch: 30, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.981 Vali Acc: 0.137 Test Loss: 2.981 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.4401350
	speed: 0.3138s/iter; left time: 3352.1056s
Epoch: 31 cost time: 15.925561904907227
Epoch: 31, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.044 Vali Acc: 0.189 Test Loss: 3.044 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38564476885644766
model parameter : 311562
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7049865
	speed: 0.1163s/iter; left time: 1779.8698s
Epoch: 1 cost time: 16.579463481903076
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4306338
	speed: 0.3041s/iter; left time: 4605.9539s
Epoch: 2 cost time: 15.167006015777588
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.148 Vali Acc: 0.315 Test Loss: 2.148 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315064).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0263114
	speed: 0.3015s/iter; left time: 4520.0245s
Epoch: 3 cost time: 14.85380506515503
Epoch: 3, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.121 Vali Acc: 0.317 Test Loss: 2.121 Test Acc: 0.317
Validation loss decreased (-0.315064 --> -0.317092).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0464742
	speed: 0.2968s/iter; left time: 4404.9342s
Epoch: 4 cost time: 13.653357028961182
Epoch: 4, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.158 Vali Acc: 0.328 Test Loss: 2.158 Test Acc: 0.328
Validation loss decreased (-0.317092 --> -0.327635).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4158993
	speed: 0.3016s/iter; left time: 4429.6964s
Epoch: 5 cost time: 14.939450979232788
Epoch: 5, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.146 Vali Acc: 0.330 Test Loss: 2.146 Test Acc: 0.330
Validation loss decreased (-0.327635 --> -0.329662).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7851303
	speed: 0.3129s/iter; left time: 4546.0875s
Epoch: 6 cost time: 15.353159189224243
Epoch: 6, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.276 Vali Acc: 0.348 Test Loss: 2.276 Test Acc: 0.348
Validation loss decreased (-0.329662 --> -0.348315).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5545621
	speed: 0.3199s/iter; left time: 4599.1923s
Epoch: 7 cost time: 15.212373971939087
Epoch: 7, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.206 Vali Acc: 0.357 Test Loss: 2.206 Test Acc: 0.357
Validation loss decreased (-0.348315 --> -0.356831).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0556002
	speed: 0.3106s/iter; left time: 4417.1328s
Epoch: 8 cost time: 15.349922180175781
Epoch: 8, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.318 Vali Acc: 0.347 Test Loss: 2.318 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9768616
	speed: 0.3157s/iter; left time: 4441.8949s
Epoch: 9 cost time: 15.545929193496704
Epoch: 9, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.326 Vali Acc: 0.364 Test Loss: 2.326 Test Acc: 0.364
Validation loss decreased (-0.356831 --> -0.364129).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6630855
	speed: 0.3186s/iter; left time: 4433.6037s
Epoch: 10 cost time: 15.048845529556274
Epoch: 10, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.314 Vali Acc: 0.367 Test Loss: 2.314 Test Acc: 0.367
Validation loss decreased (-0.364129 --> -0.366562).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2949674
	speed: 0.3056s/iter; left time: 4205.4680s
Epoch: 11 cost time: 15.67538332939148
Epoch: 11, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.471 Vali Acc: 0.365 Test Loss: 2.471 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7506783
	speed: 0.3238s/iter; left time: 4405.9984s
Epoch: 12 cost time: 16.012192487716675
Epoch: 12, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.588 Vali Acc: 0.169 Test Loss: 2.588 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9438810
	speed: 0.3317s/iter; left time: 4462.6964s
Epoch: 13 cost time: 15.718167543411255
Epoch: 13, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.410 Vali Acc: 0.226 Test Loss: 2.410 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1853627
	speed: 0.3216s/iter; left time: 4277.4447s
Epoch: 14 cost time: 15.979726552963257
Epoch: 14, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.741 Vali Acc: 0.163 Test Loss: 2.741 Test Acc: 0.163
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.0881894
	speed: 0.3319s/iter; left time: 4363.4336s
Epoch: 15 cost time: 15.960816383361816
Epoch: 15, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.789 Vali Acc: 0.199 Test Loss: 2.789 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.7239751
	speed: 0.3155s/iter; left time: 4098.7340s
Epoch: 16 cost time: 15.371639966964722
Epoch: 16, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.460 Vali Acc: 0.367 Test Loss: 2.460 Test Acc: 0.367
Validation loss decreased (-0.366562 --> -0.367372).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1299562
	speed: 0.3207s/iter; left time: 4117.2299s
Epoch: 17 cost time: 15.641343355178833
Epoch: 17, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.698 Vali Acc: 0.236 Test Loss: 2.698 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3248429
	speed: 0.3109s/iter; left time: 3942.9526s
Epoch: 18 cost time: 16.277127504348755
Epoch: 18, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.657 Vali Acc: 0.178 Test Loss: 2.657 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.2959491
	speed: 0.3154s/iter; left time: 3951.1795s
Epoch: 19 cost time: 15.240323066711426
Epoch: 19, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.672 Vali Acc: 0.147 Test Loss: 2.672 Test Acc: 0.147
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6021397
	speed: 0.3274s/iter; left time: 4052.0699s
Epoch: 20 cost time: 16.273285150527954
Epoch: 20, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.424 Vali Acc: 0.367 Test Loss: 2.424 Test Acc: 0.367
Validation loss decreased (-0.367372 --> -0.367372).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3618003
	speed: 0.3314s/iter; left time: 4050.1986s
Epoch: 21 cost time: 16.94736909866333
Epoch: 21, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.820 Vali Acc: 0.270 Test Loss: 2.820 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.7027501
	speed: 0.3676s/iter; left time: 4436.1608s
Epoch: 22 cost time: 19.061548709869385
Epoch: 22, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.424 Vali Acc: 0.364 Test Loss: 2.424 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0255851
	speed: 0.3789s/iter; left time: 4513.7888s
Epoch: 23 cost time: 18.25780153274536
Epoch: 23, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.839 Vali Acc: 0.137 Test Loss: 2.839 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.3646914
	speed: 0.3477s/iter; left time: 4088.9415s
Epoch: 24 cost time: 16.65985107421875
Epoch: 24, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.824 Vali Acc: 0.103 Test Loss: 2.824 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.1390828
	speed: 0.3669s/iter; left time: 4257.3542s
Epoch: 25 cost time: 19.630107879638672
Epoch: 25, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.686 Vali Acc: 0.364 Test Loss: 2.686 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.6208626
	speed: 0.3707s/iter; left time: 4244.9453s
Epoch: 26 cost time: 18.819825649261475
Epoch: 26, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.864 Vali Acc: 0.105 Test Loss: 2.864 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.8308117
	speed: 0.3756s/iter; left time: 4243.6982s
Epoch: 27 cost time: 17.675158739089966
Epoch: 27, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.900 Vali Acc: 0.114 Test Loss: 2.900 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.2483578
	speed: 0.3400s/iter; left time: 3788.8560s
Epoch: 28 cost time: 16.981446504592896
Epoch: 28, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.675 Vali Acc: 0.362 Test Loss: 2.675 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.2809616
	speed: 0.3550s/iter; left time: 3901.3928s
Epoch: 29 cost time: 17.145909786224365
Epoch: 29, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.814 Vali Acc: 0.370 Test Loss: 2.814 Test Acc: 0.370
Validation loss decreased (-0.367372 --> -0.370207).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7608241
	speed: 0.3623s/iter; left time: 3925.1539s
Epoch: 30 cost time: 18.61254382133484
Epoch: 30, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.010 Vali Acc: 0.122 Test Loss: 3.010 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.6367173
	speed: 0.3605s/iter; left time: 3850.2206s
Epoch: 31 cost time: 16.66364884376526
Epoch: 31, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.698 Vali Acc: 0.331 Test Loss: 2.698 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3252813
	speed: 0.3446s/iter; left time: 3627.3880s
Epoch: 32 cost time: 17.269258975982666
Epoch: 32, Steps: 154 | Train Loss: 1.252 Vali Loss: 3.254 Vali Acc: 0.113 Test Loss: 3.254 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.2347924
	speed: 0.3527s/iter; left time: 3658.1569s
Epoch: 33 cost time: 19.186115264892578
Epoch: 33, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.006 Vali Acc: 0.117 Test Loss: 3.006 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.1080068
	speed: 0.3882s/iter; left time: 3967.3922s
Epoch: 34 cost time: 19.85451889038086
Epoch: 34, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.920 Vali Acc: 0.124 Test Loss: 2.920 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.8888089
	speed: 0.3811s/iter; left time: 3836.0762s
Epoch: 35 cost time: 17.561899423599243
Epoch: 35, Steps: 154 | Train Loss: 1.254 Vali Loss: 3.361 Vali Acc: 0.063 Test Loss: 3.361 Test Acc: 0.063
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.9223864
	speed: 0.3612s/iter; left time: 3579.5175s
Epoch: 36 cost time: 19.47585701942444
Epoch: 36, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.845 Vali Acc: 0.132 Test Loss: 2.845 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.6154547
	speed: 0.3729s/iter; left time: 3637.9351s
Epoch: 37 cost time: 18.489818572998047
Epoch: 37, Steps: 154 | Train Loss: 1.216 Vali Loss: 2.710 Vali Acc: 0.129 Test Loss: 2.710 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.4103627
	speed: 0.3610s/iter; left time: 3467.0107s
Epoch: 38 cost time: 17.619035005569458
Epoch: 38, Steps: 154 | Train Loss: 1.198 Vali Loss: 3.369 Vali Acc: 0.099 Test Loss: 3.369 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.9095474
	speed: 0.3285s/iter; left time: 3103.5887s
Epoch: 39 cost time: 15.423156023025513
Epoch: 39, Steps: 154 | Train Loss: 1.199 Vali Loss: 2.746 Vali Acc: 0.332 Test Loss: 2.746 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 237354
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9726235
	speed: 0.1294s/iter; left time: 1980.3543s
Epoch: 1 cost time: 18.054760694503784
Epoch: 1, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.188 Vali Acc: 0.316 Test Loss: 2.188 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9504993
	speed: 0.3176s/iter; left time: 4810.5758s
Epoch: 2 cost time: 15.599909543991089
Epoch: 2, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.147 Vali Acc: 0.315 Test Loss: 2.147 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4525712
	speed: 0.3189s/iter; left time: 4780.6343s
Epoch: 3 cost time: 15.447616577148438
Epoch: 3, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.145 Vali Acc: 0.318 Test Loss: 2.145 Test Acc: 0.318
Validation loss decreased (-0.315874 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6859940
	speed: 0.3375s/iter; left time: 5008.8762s
Epoch: 4 cost time: 18.223655939102173
Epoch: 4, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.148 Vali Acc: 0.333 Test Loss: 2.148 Test Acc: 0.333
Validation loss decreased (-0.317902 --> -0.332906).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1530700
	speed: 0.3842s/iter; left time: 5642.5545s
Epoch: 5 cost time: 19.709323167800903
Epoch: 5, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.096 Vali Acc: 0.335 Test Loss: 2.096 Test Acc: 0.335
Validation loss decreased (-0.332906 --> -0.335340).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9162196
	speed: 0.3884s/iter; left time: 5643.9943s
Epoch: 6 cost time: 18.27150583267212
Epoch: 6, Steps: 154 | Train Loss: 1.824 Vali Loss: 1.973 Vali Acc: 0.367 Test Loss: 1.973 Test Acc: 0.367
Validation loss decreased (-0.335340 --> -0.366971).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0004156
	speed: 0.3482s/iter; left time: 5005.9728s
Epoch: 7 cost time: 17.20535135269165
Epoch: 7, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.080 Vali Acc: 0.360 Test Loss: 2.080 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5602430
	speed: 0.3740s/iter; left time: 5319.6551s
Epoch: 8 cost time: 18.29788637161255
Epoch: 8, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.475 Vali Acc: 0.177 Test Loss: 2.475 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4908936
	speed: 0.3487s/iter; left time: 4906.5386s
Epoch: 9 cost time: 16.688111305236816
Epoch: 9, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.345 Vali Acc: 0.164 Test Loss: 2.345 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6159662
	speed: 0.3548s/iter; left time: 4937.1267s
Epoch: 10 cost time: 16.451351642608643
Epoch: 10, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.641 Vali Acc: 0.167 Test Loss: 2.641 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8025805
	speed: 0.3343s/iter; left time: 4600.2542s
Epoch: 11 cost time: 16.278026819229126
Epoch: 11, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.094 Vali Acc: 0.367 Test Loss: 2.094 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8948733
	speed: 0.3509s/iter; left time: 4774.5508s
Epoch: 12 cost time: 17.710543394088745
Epoch: 12, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.483 Vali Acc: 0.364 Test Loss: 2.483 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7731469
	speed: 0.3411s/iter; left time: 4589.3436s
Epoch: 13 cost time: 16.956174612045288
Epoch: 13, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.388 Vali Acc: 0.205 Test Loss: 2.388 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2957913
	speed: 0.3459s/iter; left time: 4599.7642s
Epoch: 14 cost time: 16.70279860496521
Epoch: 14, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.674 Vali Acc: 0.189 Test Loss: 2.674 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.6426193
	speed: 0.3435s/iter; left time: 4515.3220s
Epoch: 15 cost time: 17.606902599334717
Epoch: 15, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.157 Vali Acc: 0.147 Test Loss: 3.157 Test Acc: 0.147
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.6564877
	speed: 0.3835s/iter; left time: 4982.5469s
Epoch: 16 cost time: 20.08132576942444
Epoch: 16, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.832 Vali Acc: 0.361 Test Loss: 2.832 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 237130
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3910685
	speed: 0.1246s/iter; left time: 1906.5890s
Epoch: 1 cost time: 17.9768967628479
Epoch: 1, Steps: 154 | Train Loss: 2.235 Vali Loss: 2.205 Vali Acc: 0.315 Test Loss: 2.205 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9119051
	speed: 0.3315s/iter; left time: 5020.8091s
Epoch: 2 cost time: 15.841827154159546
Epoch: 2, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3082738
	speed: 0.3290s/iter; left time: 4932.8351s
Epoch: 3 cost time: 15.08240008354187
Epoch: 3, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.186 Vali Acc: 0.317 Test Loss: 2.186 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.317091).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8648707
	speed: 0.2994s/iter; left time: 4442.9692s
Epoch: 4 cost time: 14.967592477798462
Epoch: 4, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.106 Vali Acc: 0.330 Test Loss: 2.106 Test Acc: 0.330
Validation loss decreased (-0.317091 --> -0.330068).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9375685
	speed: 0.3048s/iter; left time: 4476.6185s
Epoch: 5 cost time: 14.6701500415802
Epoch: 5, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.219 Vali Acc: 0.330 Test Loss: 2.219 Test Acc: 0.330
Validation loss decreased (-0.330068 --> -0.330473).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7781265
	speed: 0.2893s/iter; left time: 4204.3414s
Epoch: 6 cost time: 14.292034387588501
Epoch: 6, Steps: 154 | Train Loss: 1.845 Vali Loss: 1.998 Vali Acc: 0.349 Test Loss: 1.998 Test Acc: 0.349
Validation loss decreased (-0.330473 --> -0.349128).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8838286
	speed: 0.3131s/iter; left time: 4501.0592s
Epoch: 7 cost time: 15.947054147720337
Epoch: 7, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.065 Vali Acc: 0.356 Test Loss: 2.065 Test Acc: 0.356
Validation loss decreased (-0.349128 --> -0.356427).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8987086
	speed: 0.3129s/iter; left time: 4450.6595s
Epoch: 8 cost time: 15.302465677261353
Epoch: 8, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.362 Vali Acc: 0.197 Test Loss: 2.362 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9634044
	speed: 0.3136s/iter; left time: 4412.3096s
Epoch: 9 cost time: 15.100651502609253
Epoch: 9, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.487 Vali Acc: 0.190 Test Loss: 2.487 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8455634
	speed: 0.3061s/iter; left time: 4259.5508s
Epoch: 10 cost time: 15.200305700302124
Epoch: 10, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.309 Vali Acc: 0.363 Test Loss: 2.309 Test Acc: 0.363
Validation loss decreased (-0.356427 --> -0.362507).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5796297
	speed: 0.3243s/iter; left time: 4463.2773s
Epoch: 11 cost time: 15.201455354690552
Epoch: 11, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.711 Vali Acc: 0.183 Test Loss: 2.711 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3637503
	speed: 0.3182s/iter; left time: 4329.5437s
Epoch: 12 cost time: 15.605594158172607
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.844 Vali Acc: 0.194 Test Loss: 2.844 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8303671
	speed: 0.3267s/iter; left time: 4394.9069s
Epoch: 13 cost time: 15.863276958465576
Epoch: 13, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.708 Vali Acc: 0.369 Test Loss: 2.708 Test Acc: 0.369
Validation loss decreased (-0.362507 --> -0.368586).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7861785
	speed: 0.3246s/iter; left time: 4317.1071s
Epoch: 14 cost time: 15.781097650527954
Epoch: 14, Steps: 154 | Train Loss: 1.506 Vali Loss: 3.216 Vali Acc: 0.099 Test Loss: 3.216 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3282617
	speed: 0.3129s/iter; left time: 4112.4172s
Epoch: 15 cost time: 15.614090204238892
Epoch: 15, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.755 Vali Acc: 0.295 Test Loss: 2.755 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5824386
	speed: 0.3117s/iter; left time: 4049.4618s
Epoch: 16 cost time: 15.046568870544434
Epoch: 16, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.897 Vali Acc: 0.368 Test Loss: 2.897 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3302112
	speed: 0.2985s/iter; left time: 3832.0566s
Epoch: 17 cost time: 14.697216272354126
Epoch: 17, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.054 Vali Acc: 0.115 Test Loss: 3.054 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4708371
	speed: 0.3190s/iter; left time: 4045.2556s
Epoch: 18 cost time: 15.474886417388916
Epoch: 18, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.902 Vali Acc: 0.233 Test Loss: 2.902 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4847834
	speed: 0.3147s/iter; left time: 3943.2568s
Epoch: 19 cost time: 15.119000673294067
Epoch: 19, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.766 Vali Acc: 0.130 Test Loss: 2.766 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.9497827
	speed: 0.2926s/iter; left time: 3621.4011s
Epoch: 20 cost time: 14.48246431350708
Epoch: 20, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.870 Vali Acc: 0.152 Test Loss: 2.870 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.9241351
	speed: 0.3063s/iter; left time: 3743.2255s
Epoch: 21 cost time: 15.551887035369873
Epoch: 21, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.828 Vali Acc: 0.205 Test Loss: 2.828 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0564387
	speed: 0.3017s/iter; left time: 3640.1722s
Epoch: 22 cost time: 15.02261233329773
Epoch: 22, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.657 Vali Acc: 0.369 Test Loss: 2.657 Test Acc: 0.369
Validation loss decreased (-0.368586 --> -0.369398).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3389996
	speed: 0.2967s/iter; left time: 3535.0334s
Epoch: 23 cost time: 14.327306985855103
Epoch: 23, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.837 Vali Acc: 0.225 Test Loss: 2.837 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5599965
	speed: 0.3321s/iter; left time: 3905.1585s
Epoch: 24 cost time: 15.207317113876343
Epoch: 24, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.796 Vali Acc: 0.118 Test Loss: 2.796 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0038481
	speed: 0.3034s/iter; left time: 3520.9303s
Epoch: 25 cost time: 15.001385927200317
Epoch: 25, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.870 Vali Acc: 0.358 Test Loss: 2.870 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2876419
	speed: 0.3679s/iter; left time: 4212.8941s
Epoch: 26 cost time: 18.511510848999023
Epoch: 26, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.927 Vali Acc: 0.130 Test Loss: 2.927 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.2947488
	speed: 0.3368s/iter; left time: 3804.9195s
Epoch: 27 cost time: 16.62602186203003
Epoch: 27, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.082 Vali Acc: 0.238 Test Loss: 3.082 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.7853861
	speed: 0.3209s/iter; left time: 3575.8382s
Epoch: 28 cost time: 15.397282361984253
Epoch: 28, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.046 Vali Acc: 0.089 Test Loss: 3.046 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.5466771
	speed: 0.3393s/iter; left time: 3728.8778s
Epoch: 29 cost time: 17.855639934539795
Epoch: 29, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.901 Vali Acc: 0.091 Test Loss: 2.901 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.7106736
	speed: 0.3384s/iter; left time: 3666.8975s
Epoch: 30 cost time: 16.208856344223022
Epoch: 30, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.328 Vali Acc: 0.079 Test Loss: 3.328 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.2109358
	speed: 0.3354s/iter; left time: 3582.7264s
Epoch: 31 cost time: 17.271089792251587
Epoch: 31, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.306 Vali Acc: 0.079 Test Loss: 3.306 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.3337468
	speed: 0.3335s/iter; left time: 3510.3091s
Epoch: 32 cost time: 16.172226428985596
Epoch: 32, Steps: 154 | Train Loss: 1.257 Vali Loss: 3.113 Vali Acc: 0.116 Test Loss: 3.113 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 236906
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1266079
	speed: 0.1463s/iter; left time: 2238.6093s
Epoch: 1 cost time: 20.149558305740356
Epoch: 1, Steps: 154 | Train Loss: 2.254 Vali Loss: 2.155 Vali Acc: 0.316 Test Loss: 2.155 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8037264
	speed: 0.3351s/iter; left time: 5076.2330s
Epoch: 2 cost time: 16.62724757194519
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.149 Vali Acc: 0.321 Test Loss: 2.149 Test Acc: 0.321
Validation loss decreased (-0.315875 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8555114
	speed: 0.3527s/iter; left time: 5288.5395s
Epoch: 3 cost time: 17.15599012374878
Epoch: 3, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.114 Vali Acc: 0.323 Test Loss: 2.114 Test Acc: 0.323
Validation loss decreased (-0.320741 --> -0.323174).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4249973
	speed: 0.3384s/iter; left time: 5021.0886s
Epoch: 4 cost time: 16.92094135284424
Epoch: 4, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.063 Vali Acc: 0.337 Test Loss: 2.063 Test Acc: 0.337
Validation loss decreased (-0.323174 --> -0.336962).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3690190
	speed: 0.3617s/iter; left time: 5311.6777s
Epoch: 5 cost time: 18.659800052642822
Epoch: 5, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.160 Vali Acc: 0.337 Test Loss: 2.160 Test Acc: 0.337
Validation loss decreased (-0.336962 --> -0.337367).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5581729
	speed: 0.3524s/iter; left time: 5120.8841s
Epoch: 6 cost time: 16.366557121276855
Epoch: 6, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.174 Vali Acc: 0.350 Test Loss: 2.174 Test Acc: 0.350
Validation loss decreased (-0.337367 --> -0.349938).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5166651
	speed: 0.3029s/iter; left time: 4354.4814s
Epoch: 7 cost time: 15.136613845825195
Epoch: 7, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.253 Vali Acc: 0.366 Test Loss: 2.253 Test Acc: 0.366
Validation loss decreased (-0.349938 --> -0.366158).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7069055
	speed: 0.3357s/iter; left time: 4774.4559s
Epoch: 8 cost time: 16.616679906845093
Epoch: 8, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.142 Vali Acc: 0.351 Test Loss: 2.142 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5555738
	speed: 0.3379s/iter; left time: 4754.5412s
Epoch: 9 cost time: 16.68878960609436
Epoch: 9, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.261 Vali Acc: 0.235 Test Loss: 2.261 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5602261
	speed: 0.3449s/iter; left time: 4798.7539s
Epoch: 10 cost time: 15.428797960281372
Epoch: 10, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.406 Vali Acc: 0.196 Test Loss: 2.406 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6222959
	speed: 0.3045s/iter; left time: 4190.3691s
Epoch: 11 cost time: 14.899089336395264
Epoch: 11, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.380 Vali Acc: 0.351 Test Loss: 2.380 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.9021182
	speed: 0.3424s/iter; left time: 4658.7713s
Epoch: 12 cost time: 16.8421790599823
Epoch: 12, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.500 Vali Acc: 0.207 Test Loss: 2.500 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3819761
	speed: 0.3440s/iter; left time: 4628.0357s
Epoch: 13 cost time: 17.769246578216553
Epoch: 13, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.634 Vali Acc: 0.145 Test Loss: 2.634 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.9061648
	speed: 0.3645s/iter; left time: 4847.2155s
Epoch: 14 cost time: 17.483242750167847
Epoch: 14, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.372 Vali Acc: 0.378 Test Loss: 2.372 Test Acc: 0.378
Validation loss decreased (-0.366158 --> -0.377511).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6107135
	speed: 0.3402s/iter; left time: 4471.9616s
Epoch: 15 cost time: 17.518283128738403
Epoch: 15, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.992 Vali Acc: 0.150 Test Loss: 2.992 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5942070
	speed: 0.3564s/iter; left time: 4630.4455s
Epoch: 16 cost time: 18.074371099472046
Epoch: 16, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.740 Vali Acc: 0.157 Test Loss: 2.740 Test Acc: 0.157
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5946357
	speed: 0.3565s/iter; left time: 4575.9068s
Epoch: 17 cost time: 16.93526029586792
Epoch: 17, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.690 Vali Acc: 0.144 Test Loss: 2.690 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2406068
	speed: 0.3353s/iter; left time: 4253.1201s
Epoch: 18 cost time: 16.71001148223877
Epoch: 18, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.447 Vali Acc: 0.077 Test Loss: 3.447 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1834717
	speed: 0.3243s/iter; left time: 4062.7418s
Epoch: 19 cost time: 16.32702136039734
Epoch: 19, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.141 Vali Acc: 0.122 Test Loss: 3.141 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.4783356
	speed: 0.3235s/iter; left time: 4003.6820s
Epoch: 20 cost time: 15.918542385101318
Epoch: 20, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.337 Vali Acc: 0.116 Test Loss: 3.337 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1700437
	speed: 0.3383s/iter; left time: 4134.6511s
Epoch: 21 cost time: 16.602632522583008
Epoch: 21, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.134 Vali Acc: 0.199 Test Loss: 3.134 Test Acc: 0.199
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.9423621
	speed: 0.3153s/iter; left time: 3804.8916s
Epoch: 22 cost time: 15.509721755981445
Epoch: 22, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.138 Vali Acc: 0.125 Test Loss: 3.138 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.4952077
	speed: 0.3233s/iter; left time: 3851.5586s
Epoch: 23 cost time: 16.644379377365112
Epoch: 23, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.065 Vali Acc: 0.116 Test Loss: 3.065 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.8291838
	speed: 0.3424s/iter; left time: 4025.8712s
Epoch: 24 cost time: 17.637121438980103
Epoch: 24, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.333 Vali Acc: 0.125 Test Loss: 3.333 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 236682
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4948914
	speed: 0.0971s/iter; left time: 1485.7178s
Epoch: 1 cost time: 14.383247375488281
Epoch: 1, Steps: 154 | Train Loss: 2.273 Vali Loss: 2.426 Vali Acc: 0.109 Test Loss: 2.426 Test Acc: 0.109
Validation loss decreased (inf --> -0.109059).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3176849
	speed: 0.2804s/iter; left time: 4247.0118s
Epoch: 2 cost time: 12.629831314086914
Epoch: 2, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.171 Vali Acc: 0.165 Test Loss: 2.171 Test Acc: 0.165
Validation loss decreased (-0.109059 --> -0.165428).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2937915
	speed: 0.2910s/iter; left time: 4362.6746s
Epoch: 3 cost time: 13.276045083999634
Epoch: 3, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.213 Vali Acc: 0.330 Test Loss: 2.213 Test Acc: 0.330
Validation loss decreased (-0.165428 --> -0.330067).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2855179
	speed: 0.2838s/iter; left time: 4211.8997s
Epoch: 4 cost time: 13.433466911315918
Epoch: 4, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.257 Vali Acc: 0.330 Test Loss: 2.257 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2069569
	speed: 0.2914s/iter; left time: 4279.3146s
Epoch: 5 cost time: 13.150194883346558
Epoch: 5, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.202 Vali Acc: 0.317 Test Loss: 2.202 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0000384
	speed: 0.2861s/iter; left time: 4158.0409s
Epoch: 6 cost time: 13.006640911102295
Epoch: 6, Steps: 154 | Train Loss: 2.189 Vali Loss: 3.566 Vali Acc: 0.031 Test Loss: 3.566 Test Acc: 0.031
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2481520
	speed: 0.2691s/iter; left time: 3868.6068s
Epoch: 7 cost time: 12.658150911331177
Epoch: 7, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.198 Vali Acc: 0.315 Test Loss: 2.198 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.0857260
	speed: 0.2646s/iter; left time: 3762.9457s
Epoch: 8 cost time: 12.636340856552124
Epoch: 8, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8801041
	speed: 0.2829s/iter; left time: 3980.7454s
Epoch: 9 cost time: 13.135336875915527
Epoch: 9, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.2004695
	speed: 0.2765s/iter; left time: 3847.1117s
Epoch: 10 cost time: 12.81217098236084
Epoch: 10, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.194 Vali Acc: 0.315 Test Loss: 2.194 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.2491469
	speed: 0.2727s/iter; left time: 3752.7484s
Epoch: 11 cost time: 12.600215435028076
Epoch: 11, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.1278203
	speed: 0.2795s/iter; left time: 3803.5601s
Epoch: 12 cost time: 13.123960494995117
Epoch: 12, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.4122841
	speed: 0.2753s/iter; left time: 3703.6928s
Epoch: 13 cost time: 12.481112480163574
Epoch: 13, Steps: 154 | Train Loss: 2.177 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33008921330089214
model parameter : 11117630
model size : 47.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2685487
	speed: 0.1085s/iter; left time: 1660.4333s
Epoch: 1 cost time: 15.14555811882019
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2724390
	speed: 0.2689s/iter; left time: 4072.8819s
Epoch: 2 cost time: 12.433104515075684
Epoch: 2, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.159 Vali Acc: 0.330 Test Loss: 2.159 Test Acc: 0.330
Validation loss decreased (-0.315063 --> -0.330473).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2837477
	speed: 0.2796s/iter; left time: 4192.6068s
Epoch: 3 cost time: 12.525339841842651
Epoch: 3, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.267 Vali Acc: 0.325 Test Loss: 2.267 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9479004
	speed: 0.2695s/iter; left time: 3998.6632s
Epoch: 4 cost time: 12.417955875396729
Epoch: 4, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.113 Vali Acc: 0.345 Test Loss: 2.113 Test Acc: 0.345
Validation loss decreased (-0.330473 --> -0.344667).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4701188
	speed: 0.2731s/iter; left time: 4010.7347s
Epoch: 5 cost time: 12.535297632217407
Epoch: 5, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.336 Vali Acc: 0.172 Test Loss: 2.336 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6977355
	speed: 0.2647s/iter; left time: 3847.0310s
Epoch: 6 cost time: 12.710231304168701
Epoch: 6, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.316 Vali Acc: 0.221 Test Loss: 2.316 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1927927
	speed: 0.2484s/iter; left time: 3570.8648s
Epoch: 7 cost time: 11.904944658279419
Epoch: 7, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.162 Vali Acc: 0.317 Test Loss: 2.162 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.2716546
	speed: 0.2540s/iter; left time: 3612.4400s
Epoch: 8 cost time: 12.418048620223999
Epoch: 8, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0866532
	speed: 0.2817s/iter; left time: 3963.3251s
Epoch: 9 cost time: 12.990955352783203
Epoch: 9, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.6059154
	speed: 0.2715s/iter; left time: 3778.0257s
Epoch: 10 cost time: 13.036562442779541
Epoch: 10, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.7668136
	speed: 0.2732s/iter; left time: 3759.5059s
Epoch: 11 cost time: 12.951635599136353
Epoch: 11, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.0022686
	speed: 0.2713s/iter; left time: 3691.3856s
Epoch: 12 cost time: 12.602380990982056
Epoch: 12, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.0698252
	speed: 0.2680s/iter; left time: 3605.0267s
Epoch: 13 cost time: 12.173322677612305
Epoch: 13, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.3152480
	speed: 0.2638s/iter; left time: 3507.6677s
Epoch: 14 cost time: 12.281970739364624
Epoch: 14, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3446877534468775
model parameter : 11116094
model size : 47.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8847733
	speed: 0.0984s/iter; left time: 1505.7603s
Epoch: 1 cost time: 14.27649998664856
Epoch: 1, Steps: 154 | Train Loss: 2.270 Vali Loss: 2.207 Vali Acc: 0.317 Test Loss: 2.207 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5933764
	speed: 0.2738s/iter; left time: 4147.0882s
Epoch: 2 cost time: 11.580239534378052
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.309 Vali Acc: 0.317 Test Loss: 2.309 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0185339
	speed: 0.2559s/iter; left time: 3836.1483s
Epoch: 3 cost time: 12.436667203903198
Epoch: 3, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.183 Vali Acc: 0.325 Test Loss: 2.183 Test Acc: 0.325
Validation loss decreased (-0.316685 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2580712
	speed: 0.2762s/iter; left time: 4098.6477s
Epoch: 4 cost time: 12.486111402511597
Epoch: 4, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.184 Vali Acc: 0.326 Test Loss: 2.184 Test Acc: 0.326
Validation loss decreased (-0.325201 --> -0.326418).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1314735
	speed: 0.2778s/iter; left time: 4079.0469s
Epoch: 5 cost time: 13.010025024414062
Epoch: 5, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.125 Vali Acc: 0.335 Test Loss: 2.125 Test Acc: 0.335
Validation loss decreased (-0.326418 --> -0.335340).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4709709
	speed: 0.2751s/iter; left time: 3996.8862s
Epoch: 6 cost time: 12.406481266021729
Epoch: 6, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.049 Vali Acc: 0.371 Test Loss: 2.049 Test Acc: 0.371
Validation loss decreased (-0.335340 --> -0.371431).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9396580
	speed: 0.2700s/iter; left time: 3882.4676s
Epoch: 7 cost time: 12.01166319847107
Epoch: 7, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.182 Vali Acc: 0.316 Test Loss: 2.182 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3641052
	speed: 0.2642s/iter; left time: 3758.1138s
Epoch: 8 cost time: 12.525663137435913
Epoch: 8, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.220 Vali Acc: 0.326 Test Loss: 2.220 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3033617
	speed: 0.2654s/iter; left time: 3734.5296s
Epoch: 9 cost time: 12.357262372970581
Epoch: 9, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3539903
	speed: 0.2634s/iter; left time: 3664.5665s
Epoch: 10 cost time: 12.655787467956543
Epoch: 10, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.1069806
	speed: 0.2646s/iter; left time: 3640.6232s
Epoch: 11 cost time: 12.173680067062378
Epoch: 11, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.8583429
	speed: 0.2740s/iter; left time: 3728.1872s
Epoch: 12 cost time: 13.115415811538696
Epoch: 12, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.2828445
	speed: 0.2750s/iter; left time: 3699.1945s
Epoch: 13 cost time: 12.647919654846191
Epoch: 13, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.2214413
	speed: 0.2692s/iter; left time: 3580.6672s
Epoch: 14 cost time: 13.168282270431519
Epoch: 14, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.1139333
	speed: 0.2850s/iter; left time: 3745.8953s
Epoch: 15 cost time: 13.496453285217285
Epoch: 15, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.2420981
	speed: 0.2653s/iter; left time: 3447.0350s
Epoch: 16 cost time: 12.674695253372192
Epoch: 16, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.190 Vali Acc: 0.315 Test Loss: 2.190 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 11114558
model size : 47.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1654835
	speed: 0.1040s/iter; left time: 1592.0017s
Epoch: 1 cost time: 15.006311416625977
Epoch: 1, Steps: 154 | Train Loss: 2.272 Vali Loss: 2.313 Vali Acc: 0.111 Test Loss: 2.313 Test Acc: 0.111
Validation loss decreased (inf --> -0.110682).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1241975
	speed: 0.2888s/iter; left time: 4375.0136s
Epoch: 2 cost time: 12.821340799331665
Epoch: 2, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.221 Vali Acc: 0.325 Test Loss: 2.221 Test Acc: 0.325
Validation loss decreased (-0.110682 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0281785
	speed: 0.3061s/iter; left time: 4589.9523s
Epoch: 3 cost time: 14.7061448097229
Epoch: 3, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.202 Vali Acc: 0.135 Test Loss: 2.202 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9552068
	speed: 0.2729s/iter; left time: 4049.0195s
Epoch: 4 cost time: 12.375226497650146
Epoch: 4, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.149 Vali Acc: 0.337 Test Loss: 2.149 Test Acc: 0.337
Validation loss decreased (-0.325201 --> -0.337367).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2381873
	speed: 0.2878s/iter; left time: 4226.5697s
Epoch: 5 cost time: 15.168030261993408
Epoch: 5, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.164 Vali Acc: 0.324 Test Loss: 2.164 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4956887
	speed: 0.3173s/iter; left time: 4610.3656s
Epoch: 6 cost time: 14.74621319770813
Epoch: 6, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.219 Vali Acc: 0.130 Test Loss: 2.219 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3058772
	speed: 0.3077s/iter; left time: 4423.2316s
Epoch: 7 cost time: 15.592126846313477
Epoch: 7, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.241 Vali Acc: 0.315 Test Loss: 2.241 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3745382
	speed: 0.3094s/iter; left time: 4401.2571s
Epoch: 8 cost time: 13.47386384010315
Epoch: 8, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.145 Vali Acc: 0.328 Test Loss: 2.145 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0597084
	speed: 0.2889s/iter; left time: 4064.2865s
Epoch: 9 cost time: 12.9948091506958
Epoch: 9, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.162 Vali Acc: 0.315 Test Loss: 2.162 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.8838879
	speed: 0.3047s/iter; left time: 4240.2725s
Epoch: 10 cost time: 14.334957122802734
Epoch: 10, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.223 Vali Acc: 0.315 Test Loss: 2.223 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.0755413
	speed: 0.2803s/iter; left time: 3857.8100s
Epoch: 11 cost time: 13.703773736953735
Epoch: 11, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.9199305
	speed: 0.2782s/iter; left time: 3785.5337s
Epoch: 12 cost time: 12.522019863128662
Epoch: 12, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.8460554
	speed: 0.2513s/iter; left time: 3380.1908s
Epoch: 13 cost time: 11.771524429321289
Epoch: 13, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.1333172
	speed: 0.2640s/iter; left time: 3510.9800s
Epoch: 14 cost time: 12.920568466186523
Epoch: 14, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33738848337388483
model parameter : 11113022
model size : 47.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1856892
	speed: 0.1016s/iter; left time: 1554.3595s
Epoch: 1 cost time: 14.576759815216064
Epoch: 1, Steps: 154 | Train Loss: 2.261 Vali Loss: 2.187 Vali Acc: 0.317 Test Loss: 2.187 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2935767
	speed: 0.2562s/iter; left time: 3880.4309s
Epoch: 2 cost time: 11.579874038696289
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.211 Vali Acc: 0.320 Test Loss: 2.211 Test Acc: 0.320
Validation loss decreased (-0.317091 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8597362
	speed: 0.2563s/iter; left time: 3843.0194s
Epoch: 3 cost time: 11.699978828430176
Epoch: 3, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.151 Vali Acc: 0.330 Test Loss: 2.151 Test Acc: 0.330
Validation loss decreased (-0.319524 --> -0.330473).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1967490
	speed: 0.2657s/iter; left time: 3942.6826s
Epoch: 4 cost time: 12.106685876846313
Epoch: 4, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.474 Vali Acc: 0.345 Test Loss: 2.474 Test Acc: 0.345
Validation loss decreased (-0.330473 --> -0.345474).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2719123
	speed: 0.2600s/iter; left time: 3817.5375s
Epoch: 5 cost time: 12.054778337478638
Epoch: 5, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.179 Vali Acc: 0.376 Test Loss: 2.179 Test Acc: 0.376
Validation loss decreased (-0.345474 --> -0.375485).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0577550
	speed: 0.2533s/iter; left time: 3681.1514s
Epoch: 6 cost time: 12.146420955657959
Epoch: 6, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.882 Vali Acc: 0.105 Test Loss: 2.882 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5848968
	speed: 0.2605s/iter; left time: 3744.7965s
Epoch: 7 cost time: 11.707397937774658
Epoch: 7, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.275 Vali Acc: 0.339 Test Loss: 2.275 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.5893276
	speed: 0.2534s/iter; left time: 3604.4513s
Epoch: 8 cost time: 11.724953413009644
Epoch: 8, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9373600
	speed: 0.2633s/iter; left time: 3704.3420s
Epoch: 9 cost time: 12.357282638549805
Epoch: 9, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.180 Vali Acc: 0.315 Test Loss: 2.180 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6789058
	speed: 0.2408s/iter; left time: 3350.2534s
Epoch: 10 cost time: 11.441949844360352
Epoch: 10, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.210 Vali Acc: 0.315 Test Loss: 2.210 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.0263212
	speed: 0.2519s/iter; left time: 3466.9452s
Epoch: 11 cost time: 12.39054822921753
Epoch: 11, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.2913139
	speed: 0.2415s/iter; left time: 3286.5735s
Epoch: 12 cost time: 11.267215967178345
Epoch: 12, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.4428906
	speed: 0.2414s/iter; left time: 3246.8966s
Epoch: 13 cost time: 11.94771432876587
Epoch: 13, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.1459007
	speed: 0.2539s/iter; left time: 3376.7950s
Epoch: 14 cost time: 11.504590272903442
Epoch: 14, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.6755772
	speed: 0.2311s/iter; left time: 3037.2646s
Epoch: 15 cost time: 11.512063264846802
Epoch: 15, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 9279038
model size : 40.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9891900
	speed: 0.0925s/iter; left time: 1414.8187s
Epoch: 1 cost time: 13.199520826339722
Epoch: 1, Steps: 154 | Train Loss: 2.276 Vali Loss: 2.244 Vali Acc: 0.315 Test Loss: 2.244 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3190360
	speed: 0.2504s/iter; left time: 3792.9633s
Epoch: 2 cost time: 11.741570234298706
Epoch: 2, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.144 Vali Acc: 0.177 Test Loss: 2.144 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9531703
	speed: 0.2539s/iter; left time: 3807.0651s
Epoch: 3 cost time: 12.15389609336853
Epoch: 3, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.094 Vali Acc: 0.178 Test Loss: 2.094 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0085206
	speed: 0.2522s/iter; left time: 3742.4108s
Epoch: 4 cost time: 11.923797845840454
Epoch: 4, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.405 Vali Acc: 0.356 Test Loss: 2.405 Test Acc: 0.356
Validation loss decreased (-0.315468 --> -0.356424).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2476835
	speed: 0.2611s/iter; left time: 3834.2151s
Epoch: 5 cost time: 12.29909062385559
Epoch: 5, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.297 Vali Acc: 0.135 Test Loss: 2.297 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4084755
	speed: 0.2427s/iter; left time: 3527.3575s
Epoch: 6 cost time: 11.227851629257202
Epoch: 6, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.165 Vali Acc: 0.357 Test Loss: 2.165 Test Acc: 0.357
Validation loss decreased (-0.356424 --> -0.356832).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0062137
	speed: 0.2468s/iter; left time: 3548.6134s
Epoch: 7 cost time: 11.308056592941284
Epoch: 7, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9875870
	speed: 0.2481s/iter; left time: 3529.2722s
Epoch: 8 cost time: 11.846724033355713
Epoch: 8, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.261 Vali Acc: 0.315 Test Loss: 2.261 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2636175
	speed: 0.2373s/iter; left time: 3338.2576s
Epoch: 9 cost time: 11.196966648101807
Epoch: 9, Steps: 154 | Train Loss: 2.186 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0036442
	speed: 0.2321s/iter; left time: 3229.5923s
Epoch: 10 cost time: 11.762653827667236
Epoch: 10, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.0600069
	speed: 0.2346s/iter; left time: 3228.9438s
Epoch: 11 cost time: 10.975667953491211
Epoch: 11, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.1377182
	speed: 0.2371s/iter; left time: 3226.2614s
Epoch: 12 cost time: 10.909090757369995
Epoch: 12, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.1488318
	speed: 0.2483s/iter; left time: 3339.7549s
Epoch: 13 cost time: 12.85520625114441
Epoch: 13, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.2257957
	speed: 0.2575s/iter; left time: 3425.0676s
Epoch: 14 cost time: 12.521037817001343
Epoch: 14, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.0199633
	speed: 0.2574s/iter; left time: 3384.0862s
Epoch: 15 cost time: 12.546536922454834
Epoch: 15, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.4352727
	speed: 0.2615s/iter; left time: 3396.6572s
Epoch: 16 cost time: 12.439218997955322
Epoch: 16, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35685320356853206
model parameter : 9277502
model size : 40.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9101956
	speed: 0.0924s/iter; left time: 1414.0857s
Epoch: 1 cost time: 13.364147663116455
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.253 Vali Acc: 0.109 Test Loss: 2.253 Test Acc: 0.109
Validation loss decreased (inf --> -0.109061).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4468720
	speed: 0.2474s/iter; left time: 3747.5104s
Epoch: 2 cost time: 11.617079973220825
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.157 Vali Acc: 0.322 Test Loss: 2.157 Test Acc: 0.322
Validation loss decreased (-0.109061 --> -0.321957).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9857031
	speed: 0.2546s/iter; left time: 3816.8320s
Epoch: 3 cost time: 11.556646347045898
Epoch: 3, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.523 Vali Acc: 0.149 Test Loss: 2.523 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3276000
	speed: 0.2341s/iter; left time: 3474.1452s
Epoch: 4 cost time: 11.47018551826477
Epoch: 4, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.073 Vali Acc: 0.352 Test Loss: 2.073 Test Acc: 0.352
Validation loss decreased (-0.321957 --> -0.351966).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5978401
	speed: 0.2358s/iter; left time: 3462.8076s
Epoch: 5 cost time: 11.222185134887695
Epoch: 5, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.302 Vali Acc: 0.373 Test Loss: 2.302 Test Acc: 0.373
Validation loss decreased (-0.351966 --> -0.372645).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2845676
	speed: 0.2555s/iter; left time: 3712.2192s
Epoch: 6 cost time: 11.238110542297363
Epoch: 6, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.123 Vali Acc: 0.359 Test Loss: 2.123 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7891850
	speed: 0.2444s/iter; left time: 3513.1399s
Epoch: 7 cost time: 11.607097864151001
Epoch: 7, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.164 Vali Acc: 0.320 Test Loss: 2.164 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0518479
	speed: 0.2394s/iter; left time: 3405.1958s
Epoch: 8 cost time: 10.914246320724487
Epoch: 8, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.201 Vali Acc: 0.329 Test Loss: 2.201 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.5774765
	speed: 0.2319s/iter; left time: 3261.9134s
Epoch: 9 cost time: 11.152135848999023
Epoch: 9, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.153 Vali Acc: 0.326 Test Loss: 2.153 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.4411120
	speed: 0.2527s/iter; left time: 3515.9415s
Epoch: 10 cost time: 11.80272889137268
Epoch: 10, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.169 Vali Acc: 0.322 Test Loss: 2.169 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.9761227
	speed: 0.2481s/iter; left time: 3414.5935s
Epoch: 11 cost time: 11.503754377365112
Epoch: 11, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.155 Vali Acc: 0.326 Test Loss: 2.155 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.6851614
	speed: 0.2632s/iter; left time: 3581.0153s
Epoch: 12 cost time: 13.407594203948975
Epoch: 12, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.115 Vali Acc: 0.332 Test Loss: 2.115 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.5767865
	speed: 0.2678s/iter; left time: 3602.9666s
Epoch: 13 cost time: 13.119740009307861
Epoch: 13, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.1818213
	speed: 0.2850s/iter; left time: 3790.4404s
Epoch: 14 cost time: 12.426086664199829
Epoch: 14, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.205 Vali Acc: 0.315 Test Loss: 2.205 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.0050941
	speed: 0.2505s/iter; left time: 3292.6548s
Epoch: 15 cost time: 11.770041227340698
Epoch: 15, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 9275966
model size : 40.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8767858
	speed: 0.0844s/iter; left time: 1291.6720s
Epoch: 1 cost time: 11.783302545547485
Epoch: 1, Steps: 154 | Train Loss: 2.267 Vali Loss: 2.232 Vali Acc: 0.315 Test Loss: 2.232 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7826179
	speed: 0.2240s/iter; left time: 3392.3021s
Epoch: 2 cost time: 10.575927257537842
Epoch: 2, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.165 Vali Acc: 0.321 Test Loss: 2.165 Test Acc: 0.321
Validation loss decreased (-0.315468 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9242427
	speed: 0.2407s/iter; left time: 3608.6274s
Epoch: 3 cost time: 11.069398880004883
Epoch: 3, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.081 Vali Acc: 0.339 Test Loss: 2.081 Test Acc: 0.339
Validation loss decreased (-0.320741 --> -0.338990).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6011465
	speed: 0.2341s/iter; left time: 3474.2127s
Epoch: 4 cost time: 10.573007106781006
Epoch: 4, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.120 Vali Acc: 0.351 Test Loss: 2.120 Test Acc: 0.351
Validation loss decreased (-0.338990 --> -0.350749).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8722906
	speed: 0.2357s/iter; left time: 3460.8816s
Epoch: 5 cost time: 10.233227014541626
Epoch: 5, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.061 Vali Acc: 0.351 Test Loss: 2.061 Test Acc: 0.351
Validation loss decreased (-0.350749 --> -0.351155).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4556259
	speed: 0.2361s/iter; left time: 3431.4184s
Epoch: 6 cost time: 11.670145750045776
Epoch: 6, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.043 Vali Acc: 0.365 Test Loss: 2.043 Test Acc: 0.365
Validation loss decreased (-0.351155 --> -0.364538).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0819926
	speed: 0.2563s/iter; left time: 3684.4820s
Epoch: 7 cost time: 11.75679898262024
Epoch: 7, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.091 Vali Acc: 0.366 Test Loss: 2.091 Test Acc: 0.366
Validation loss decreased (-0.364538 --> -0.366159).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9108514
	speed: 0.2564s/iter; left time: 3647.0404s
Epoch: 8 cost time: 11.550406694412231
Epoch: 8, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.370 Vali Acc: 0.346 Test Loss: 2.370 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6172566
	speed: 0.2354s/iter; left time: 3311.4598s
Epoch: 9 cost time: 11.660701036453247
Epoch: 9, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.112 Vali Acc: 0.357 Test Loss: 2.112 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5108469
	speed: 0.2310s/iter; left time: 3213.7704s
Epoch: 10 cost time: 10.936774492263794
Epoch: 10, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.670 Vali Acc: 0.145 Test Loss: 2.670 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6632429
	speed: 0.2447s/iter; left time: 3367.3600s
Epoch: 11 cost time: 11.701611042022705
Epoch: 11, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.160 Vali Acc: 0.316 Test Loss: 2.160 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.0619321
	speed: 0.2304s/iter; left time: 3135.1176s
Epoch: 12 cost time: 11.273400068283081
Epoch: 12, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.163 Vali Acc: 0.316 Test Loss: 2.163 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 2.0399535
	speed: 0.2380s/iter; left time: 3202.1381s
Epoch: 13 cost time: 11.227753639221191
Epoch: 13, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.7359738
	speed: 0.2295s/iter; left time: 3051.6211s
Epoch: 14 cost time: 10.505892992019653
Epoch: 14, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.1147268
	speed: 0.2174s/iter; left time: 2857.4095s
Epoch: 15 cost time: 10.558582067489624
Epoch: 15, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.9868335
	speed: 0.2372s/iter; left time: 3081.5562s
Epoch: 16 cost time: 11.04497766494751
Epoch: 16, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.199 Vali Acc: 0.315 Test Loss: 2.199 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.8365574
	speed: 0.2471s/iter; left time: 3171.7179s
Epoch: 17 cost time: 11.43643856048584
Epoch: 17, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 9274430
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8109545
	speed: 0.0859s/iter; left time: 1314.9554s
Epoch: 1 cost time: 12.558913469314575
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.215 Vali Acc: 0.315 Test Loss: 2.215 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2577466
	speed: 0.2494s/iter; left time: 3777.2638s
Epoch: 2 cost time: 11.794116735458374
Epoch: 2, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.245 Vali Acc: 0.136 Test Loss: 2.245 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2803330
	speed: 0.2498s/iter; left time: 3745.0137s
Epoch: 3 cost time: 11.210296630859375
Epoch: 3, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.138 Vali Acc: 0.328 Test Loss: 2.138 Test Acc: 0.328
Validation loss decreased (-0.315469 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5687058
	speed: 0.2438s/iter; left time: 3617.9991s
Epoch: 4 cost time: 11.073657989501953
Epoch: 4, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.102 Vali Acc: 0.344 Test Loss: 2.102 Test Acc: 0.344
Validation loss decreased (-0.327635 --> -0.344261).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8020914
	speed: 0.2410s/iter; left time: 3538.7057s
Epoch: 5 cost time: 10.651646852493286
Epoch: 5, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.038 Vali Acc: 0.347 Test Loss: 2.038 Test Acc: 0.347
Validation loss decreased (-0.344261 --> -0.346695).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7493279
	speed: 0.2350s/iter; left time: 3414.1365s
Epoch: 6 cost time: 10.697505712509155
Epoch: 6, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.105 Vali Acc: 0.345 Test Loss: 2.105 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6364965
	speed: 0.2351s/iter; left time: 3380.4512s
Epoch: 7 cost time: 10.957949876785278
Epoch: 7, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.205 Vali Acc: 0.316 Test Loss: 2.205 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1391599
	speed: 0.2348s/iter; left time: 3339.0326s
Epoch: 8 cost time: 11.038791179656982
Epoch: 8, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.219 Vali Acc: 0.315 Test Loss: 2.219 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.2923179
	speed: 0.2368s/iter; left time: 3331.5106s
Epoch: 9 cost time: 11.323431968688965
Epoch: 9, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.223 Vali Acc: 0.127 Test Loss: 2.223 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.2875175
	speed: 0.2435s/iter; left time: 3388.6820s
Epoch: 10 cost time: 10.973904848098755
Epoch: 10, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.1789870
	speed: 0.2261s/iter; left time: 3111.2224s
Epoch: 11 cost time: 11.614135265350342
Epoch: 11, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.1661289
	speed: 0.2316s/iter; left time: 3151.7403s
Epoch: 12 cost time: 10.833305597305298
Epoch: 12, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.181 Vali Acc: 0.155 Test Loss: 2.181 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.1986730
	speed: 0.2456s/iter; left time: 3303.7282s
Epoch: 13 cost time: 11.140405178070068
Epoch: 13, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.4520273
	speed: 0.2381s/iter; left time: 3166.0307s
Epoch: 14 cost time: 11.489523887634277
Epoch: 14, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.3183630
	speed: 0.2273s/iter; left time: 2987.7265s
Epoch: 15 cost time: 10.972742319107056
Epoch: 15, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3467153284671533
model parameter : 8359742
model size : 36.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4510369
	speed: 0.0923s/iter; left time: 1411.6701s
Epoch: 1 cost time: 13.117957592010498
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.336 Vali Acc: 0.315 Test Loss: 2.336 Test Acc: 0.315
Validation loss decreased (inf --> -0.315467).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0004227
	speed: 0.2463s/iter; left time: 3730.0772s
Epoch: 2 cost time: 11.653645753860474
Epoch: 2, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.115 Vali Acc: 0.333 Test Loss: 2.115 Test Acc: 0.333
Validation loss decreased (-0.315467 --> -0.332907).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8693024
	speed: 0.2544s/iter; left time: 3813.6566s
Epoch: 3 cost time: 11.89553689956665
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.225 Vali Acc: 0.326 Test Loss: 2.225 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9478339
	speed: 0.2459s/iter; left time: 3648.4215s
Epoch: 4 cost time: 11.02518892288208
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.013 Vali Acc: 0.348 Test Loss: 2.013 Test Acc: 0.348
Validation loss decreased (-0.332907 --> -0.347506).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9180231
	speed: 0.2415s/iter; left time: 3546.7248s
Epoch: 5 cost time: 11.416491508483887
Epoch: 5, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.217 Vali Acc: 0.191 Test Loss: 2.217 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7873842
	speed: 0.2246s/iter; left time: 3263.1177s
Epoch: 6 cost time: 11.170245170593262
Epoch: 6, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.251 Vali Acc: 0.202 Test Loss: 2.251 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6983930
	speed: 0.2248s/iter; left time: 3231.9816s
Epoch: 7 cost time: 11.626229286193848
Epoch: 7, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.137 Vali Acc: 0.351 Test Loss: 2.137 Test Acc: 0.351
Validation loss decreased (-0.347506 --> -0.351155).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9026941
	speed: 0.2450s/iter; left time: 3484.4536s
Epoch: 8 cost time: 10.928566217422485
Epoch: 8, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.160 Vali Acc: 0.357 Test Loss: 2.160 Test Acc: 0.357
Validation loss decreased (-0.351155 --> -0.357237).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6879013
	speed: 0.2262s/iter; left time: 3182.4276s
Epoch: 9 cost time: 10.616795063018799
Epoch: 9, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.247 Vali Acc: 0.187 Test Loss: 2.247 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2455246
	speed: 0.2342s/iter; left time: 3259.0113s
Epoch: 10 cost time: 11.84321141242981
Epoch: 10, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.122 Vali Acc: 0.337 Test Loss: 2.122 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.1084750
	speed: 0.2389s/iter; left time: 3287.5553s
Epoch: 11 cost time: 11.177742719650269
Epoch: 11, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.166 Vali Acc: 0.321 Test Loss: 2.166 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.9239974
	speed: 0.2265s/iter; left time: 3082.5786s
Epoch: 12 cost time: 11.00325632095337
Epoch: 12, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.2131453
	speed: 0.2381s/iter; left time: 3202.7720s
Epoch: 13 cost time: 11.329283952713013
Epoch: 13, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.4484618
	speed: 0.2361s/iter; left time: 3140.1260s
Epoch: 14 cost time: 11.302351236343384
Epoch: 14, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.166 Vali Acc: 0.322 Test Loss: 2.166 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.1077838
	speed: 0.2439s/iter; left time: 3206.2682s
Epoch: 15 cost time: 11.37904405593872
Epoch: 15, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.120 Vali Acc: 0.323 Test Loss: 2.120 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.3079653
	speed: 0.2355s/iter; left time: 3059.5037s
Epoch: 16 cost time: 11.581464052200317
Epoch: 16, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.189 Vali Acc: 0.315 Test Loss: 2.189 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 2.5519807
	speed: 0.2480s/iter; left time: 3183.9275s
Epoch: 17 cost time: 11.867835760116577
Epoch: 17, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.6981953
	speed: 0.2248s/iter; left time: 2851.3627s
Epoch: 18 cost time: 11.01119589805603
Epoch: 18, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3572587185725872
model parameter : 8358206
model size : 36.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6070056
	speed: 0.0911s/iter; left time: 1393.2541s
Epoch: 1 cost time: 12.36740779876709
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.263 Vali Acc: 0.155 Test Loss: 2.263 Test Acc: 0.155
Validation loss decreased (inf --> -0.155290).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0778787
	speed: 0.2238s/iter; left time: 3389.7235s
Epoch: 2 cost time: 10.273226737976074
Epoch: 2, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.187 Vali Acc: 0.327 Test Loss: 2.187 Test Acc: 0.327
Validation loss decreased (-0.155290 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3715634
	speed: 0.2277s/iter; left time: 3413.6232s
Epoch: 3 cost time: 11.009246349334717
Epoch: 3, Steps: 154 | Train Loss: 2.120 Vali Loss: 2.183 Vali Acc: 0.318 Test Loss: 2.183 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3658953
	speed: 0.2227s/iter; left time: 3304.9862s
Epoch: 4 cost time: 10.751582145690918
Epoch: 4, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.142 Vali Acc: 0.327 Test Loss: 2.142 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.9900105
	speed: 0.2184s/iter; left time: 3207.1723s
Epoch: 5 cost time: 10.600886821746826
Epoch: 5, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.260 Vali Acc: 0.341 Test Loss: 2.260 Test Acc: 0.341
Validation loss decreased (-0.327229 --> -0.340610).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0597184
	speed: 0.2410s/iter; left time: 3502.1890s
Epoch: 6 cost time: 12.180142402648926
Epoch: 6, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.135 Vali Acc: 0.331 Test Loss: 2.135 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0017064
	speed: 0.2463s/iter; left time: 3541.1149s
Epoch: 7 cost time: 11.57557988166809
Epoch: 7, Steps: 154 | Train Loss: 2.253 Vali Loss: 2.208 Vali Acc: 0.315 Test Loss: 2.208 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.5606670
	speed: 0.2339s/iter; left time: 3327.2023s
Epoch: 8 cost time: 11.292765378952026
Epoch: 8, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.229 Vali Acc: 0.315 Test Loss: 2.229 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0421684
	speed: 0.2449s/iter; left time: 3445.4101s
Epoch: 9 cost time: 10.749903440475464
Epoch: 9, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3004584
	speed: 0.2272s/iter; left time: 3161.4948s
Epoch: 10 cost time: 10.929765224456787
Epoch: 10, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.4797721
	speed: 0.2384s/iter; left time: 3280.5531s
Epoch: 11 cost time: 11.131763458251953
Epoch: 11, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.2969012
	speed: 0.2361s/iter; left time: 3212.2029s
Epoch: 12 cost time: 11.252278089523315
Epoch: 12, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.3079419
	speed: 0.2252s/iter; left time: 3029.0036s
Epoch: 13 cost time: 11.209795236587524
Epoch: 13, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.2883334
	speed: 0.2473s/iter; left time: 3288.8441s
Epoch: 14 cost time: 12.079721689224243
Epoch: 14, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.9599432
	speed: 0.2352s/iter; left time: 3092.1270s
Epoch: 15 cost time: 12.074853658676147
Epoch: 15, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.210 Vali Acc: 0.155 Test Loss: 2.210 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.340632603406326
model parameter : 8356670
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0207593
	speed: 0.0866s/iter; left time: 1325.3303s
Epoch: 1 cost time: 12.250381469726562
Epoch: 1, Steps: 154 | Train Loss: 2.300 Vali Loss: 2.258 Vali Acc: 0.109 Test Loss: 2.258 Test Acc: 0.109
Validation loss decreased (inf --> -0.108655).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2519135
	speed: 0.2161s/iter; left time: 3273.2632s
Epoch: 2 cost time: 10.438747882843018
Epoch: 2, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.180 Vali Acc: 0.321 Test Loss: 2.180 Test Acc: 0.321
Validation loss decreased (-0.108655 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0006521
	speed: 0.2664s/iter; left time: 3993.6022s
Epoch: 3 cost time: 12.309940814971924
Epoch: 3, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.158 Vali Acc: 0.331 Test Loss: 2.158 Test Acc: 0.331
Validation loss decreased (-0.320741 --> -0.331284).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1237879
	speed: 0.2595s/iter; left time: 3850.9420s
Epoch: 4 cost time: 11.30246877670288
Epoch: 4, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.106 Vali Acc: 0.333 Test Loss: 2.106 Test Acc: 0.333
Validation loss decreased (-0.331284 --> -0.332501).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0727854
	speed: 0.2688s/iter; left time: 3947.0820s
Epoch: 5 cost time: 12.580740690231323
Epoch: 5, Steps: 154 | Train Loss: 2.016 Vali Loss: 1.994 Vali Acc: 0.360 Test Loss: 1.994 Test Acc: 0.360
Validation loss decreased (-0.332501 --> -0.359672).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5379144
	speed: 0.2480s/iter; left time: 3602.9626s
Epoch: 6 cost time: 11.166638374328613
Epoch: 6, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.091 Vali Acc: 0.340 Test Loss: 2.091 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4322484
	speed: 0.2493s/iter; left time: 3583.9404s
Epoch: 7 cost time: 11.900897026062012
Epoch: 7, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.456 Vali Acc: 0.358 Test Loss: 2.456 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0884061
	speed: 0.2409s/iter; left time: 3426.9470s
Epoch: 8 cost time: 10.328811407089233
Epoch: 8, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.205 Vali Acc: 0.357 Test Loss: 2.205 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6277817
	speed: 0.2247s/iter; left time: 3161.0343s
Epoch: 9 cost time: 10.597441673278809
Epoch: 9, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.229 Vali Acc: 0.315 Test Loss: 2.229 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1216826
	speed: 0.2300s/iter; left time: 3200.7326s
Epoch: 10 cost time: 11.296189069747925
Epoch: 10, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.113 Vali Acc: 0.328 Test Loss: 2.113 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.2761052
	speed: 0.2258s/iter; left time: 3107.6537s
Epoch: 11 cost time: 11.068128108978271
Epoch: 11, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.147 Vali Acc: 0.318 Test Loss: 2.147 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.6510322
	speed: 0.2406s/iter; left time: 3273.1779s
Epoch: 12 cost time: 11.58078384399414
Epoch: 12, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.167 Vali Acc: 0.324 Test Loss: 2.167 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.9734963
	speed: 0.2394s/iter; left time: 3220.6822s
Epoch: 13 cost time: 11.085940599441528
Epoch: 13, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.175 Vali Acc: 0.324 Test Loss: 2.175 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.9533956
	speed: 0.2219s/iter; left time: 2951.6107s
Epoch: 14 cost time: 10.897658586502075
Epoch: 14, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.118 Vali Acc: 0.325 Test Loss: 2.118 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.4416080
	speed: 0.2195s/iter; left time: 2885.1052s
Epoch: 15 cost time: 11.476186037063599
Epoch: 15, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3596918085969181
model parameter : 8355134
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8878953
	speed: 0.0868s/iter; left time: 1328.5244s
Epoch: 1 cost time: 13.014520406723022
Epoch: 1, Steps: 154 | Train Loss: 2.254 Vali Loss: 2.213 Vali Acc: 0.316 Test Loss: 2.213 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1135943
	speed: 0.2541s/iter; left time: 3848.1702s
Epoch: 2 cost time: 11.633361577987671
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.303 Vali Acc: 0.315 Test Loss: 2.303 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1682820
	speed: 0.2302s/iter; left time: 3451.8458s
Epoch: 3 cost time: 10.27689003944397
Epoch: 3, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.148 Vali Acc: 0.339 Test Loss: 2.148 Test Acc: 0.339
Validation loss decreased (-0.315874 --> -0.339395).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8012983
	speed: 0.2171s/iter; left time: 3222.0534s
Epoch: 4 cost time: 10.368067026138306
Epoch: 4, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.182 Vali Acc: 0.345 Test Loss: 2.182 Test Acc: 0.345
Validation loss decreased (-0.339395 --> -0.344666).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0172906
	speed: 0.2170s/iter; left time: 3186.9152s
Epoch: 5 cost time: 9.74644684791565
Epoch: 5, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.418 Vali Acc: 0.076 Test Loss: 2.418 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9565127
	speed: 0.2290s/iter; left time: 3327.2995s
Epoch: 6 cost time: 11.36417555809021
Epoch: 6, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.512 Vali Acc: 0.349 Test Loss: 2.512 Test Acc: 0.349
Validation loss decreased (-0.344666 --> -0.349123).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4708332
	speed: 0.2297s/iter; left time: 3302.3289s
Epoch: 7 cost time: 10.643640518188477
Epoch: 7, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.236 Vali Acc: 0.334 Test Loss: 2.236 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2603211
	speed: 0.2134s/iter; left time: 3035.8539s
Epoch: 8 cost time: 10.151069402694702
Epoch: 8, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.256 Vali Acc: 0.315 Test Loss: 2.256 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1962690
	speed: 0.2240s/iter; left time: 3151.0146s
Epoch: 9 cost time: 11.662776708602905
Epoch: 9, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9589673
	speed: 0.2300s/iter; left time: 3200.7713s
Epoch: 10 cost time: 10.315308094024658
Epoch: 10, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.188 Vali Acc: 0.327 Test Loss: 2.188 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7877725
	speed: 0.2319s/iter; left time: 3190.9307s
Epoch: 11 cost time: 11.18213438987732
Epoch: 11, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.0856218
	speed: 0.2336s/iter; left time: 3178.2791s
Epoch: 12 cost time: 10.838826894760132
Epoch: 12, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.4161403
	speed: 0.2339s/iter; left time: 3146.7766s
Epoch: 13 cost time: 10.246161937713623
Epoch: 13, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.224 Vali Acc: 0.315 Test Loss: 2.224 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.4343836
	speed: 0.2342s/iter; left time: 3114.0612s
Epoch: 14 cost time: 11.252659559249878
Epoch: 14, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.3943532
	speed: 0.2292s/iter; left time: 3013.0577s
Epoch: 15 cost time: 10.833930253982544
Epoch: 15, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.4801114
	speed: 0.2310s/iter; left time: 3000.7511s
Epoch: 16 cost time: 11.094248056411743
Epoch: 16, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3491484184914842
model parameter : 7900094
model size : 35.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9341780
	speed: 0.0806s/iter; left time: 1232.6115s
Epoch: 1 cost time: 11.775930166244507
Epoch: 1, Steps: 154 | Train Loss: 2.275 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1324205
	speed: 0.2234s/iter; left time: 3384.3295s
Epoch: 2 cost time: 11.304645538330078
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.149 Vali Acc: 0.329 Test Loss: 2.149 Test Acc: 0.329
Validation loss decreased (-0.315469 --> -0.328851).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0157914
	speed: 0.2420s/iter; left time: 3628.4895s
Epoch: 3 cost time: 10.900347232818604
Epoch: 3, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.176 Vali Acc: 0.322 Test Loss: 2.176 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5792028
	speed: 0.2300s/iter; left time: 3413.3664s
Epoch: 4 cost time: 11.298526287078857
Epoch: 4, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.197 Vali Acc: 0.352 Test Loss: 2.197 Test Acc: 0.352
Validation loss decreased (-0.328851 --> -0.351965).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4996228
	speed: 0.2482s/iter; left time: 3645.2317s
Epoch: 5 cost time: 12.577512741088867
Epoch: 5, Steps: 154 | Train Loss: 1.907 Vali Loss: 2.125 Vali Acc: 0.348 Test Loss: 2.125 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4993596
	speed: 0.2313s/iter; left time: 3360.4199s
Epoch: 6 cost time: 10.599536418914795
Epoch: 6, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.521 Vali Acc: 0.188 Test Loss: 2.521 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6908371
	speed: 0.2226s/iter; left time: 3199.7035s
Epoch: 7 cost time: 10.922420740127563
Epoch: 7, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.099 Vali Acc: 0.353 Test Loss: 2.099 Test Acc: 0.353
Validation loss decreased (-0.351965 --> -0.352777).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9737313
	speed: 0.2541s/iter; left time: 3614.6895s
Epoch: 8 cost time: 12.464999914169312
Epoch: 8, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.195 Vali Acc: 0.315 Test Loss: 2.195 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5025933
	speed: 0.2407s/iter; left time: 3386.0200s
Epoch: 9 cost time: 11.889625787734985
Epoch: 9, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2130349
	speed: 0.2509s/iter; left time: 3491.5791s
Epoch: 10 cost time: 12.555408716201782
Epoch: 10, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9640667
	speed: 0.2460s/iter; left time: 3385.4005s
Epoch: 11 cost time: 11.48457407951355
Epoch: 11, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.3835623
	speed: 0.2427s/iter; left time: 3302.3255s
Epoch: 12 cost time: 12.15971851348877
Epoch: 12, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 2.6832612
	speed: 0.2546s/iter; left time: 3425.2419s
Epoch: 13 cost time: 11.35942268371582
Epoch: 13, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.5816603
	speed: 0.2301s/iter; left time: 3060.1328s
Epoch: 14 cost time: 10.775337219238281
Epoch: 14, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.4565136
	speed: 0.2185s/iter; left time: 2871.9092s
Epoch: 15 cost time: 10.417870283126831
Epoch: 15, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 2.0609245
	speed: 0.2339s/iter; left time: 3038.1549s
Epoch: 16 cost time: 11.075195550918579
Epoch: 16, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 2.2058709
	speed: 0.2242s/iter; left time: 2878.2931s
Epoch: 17 cost time: 10.95830249786377
Epoch: 17, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35279805352798055
model parameter : 7898558
model size : 35.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1108892
	speed: 0.0866s/iter; left time: 1324.7900s
Epoch: 1 cost time: 12.077158212661743
Epoch: 1, Steps: 154 | Train Loss: 2.265 Vali Loss: 2.253 Vali Acc: 0.315 Test Loss: 2.253 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1142488
	speed: 0.2146s/iter; left time: 3250.0774s
Epoch: 2 cost time: 10.080445528030396
Epoch: 2, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.368 Vali Acc: 0.318 Test Loss: 2.368 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.317900).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1879077
	speed: 0.2257s/iter; left time: 3383.3962s
Epoch: 3 cost time: 11.577116012573242
Epoch: 3, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.109 Vali Acc: 0.332 Test Loss: 2.109 Test Acc: 0.332
Validation loss decreased (-0.317900 --> -0.331690).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0135031
	speed: 0.2323s/iter; left time: 3447.0276s
Epoch: 4 cost time: 10.655890226364136
Epoch: 4, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.356 Vali Acc: 0.344 Test Loss: 2.356 Test Acc: 0.344
Validation loss decreased (-0.331690 --> -0.343853).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8883638
	speed: 0.2249s/iter; left time: 3301.9790s
Epoch: 5 cost time: 10.323756217956543
Epoch: 5, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.050 Vali Acc: 0.361 Test Loss: 2.050 Test Acc: 0.361
Validation loss decreased (-0.343853 --> -0.360888).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6244767
	speed: 0.2266s/iter; left time: 3292.0640s
Epoch: 6 cost time: 10.44971752166748
Epoch: 6, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.064 Vali Acc: 0.336 Test Loss: 2.064 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5599884
	speed: 0.2168s/iter; left time: 3117.2570s
Epoch: 7 cost time: 10.432385921478271
Epoch: 7, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.384 Vali Acc: 0.187 Test Loss: 2.384 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9285129
	speed: 0.2267s/iter; left time: 3224.9211s
Epoch: 8 cost time: 10.69678807258606
Epoch: 8, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.192 Vali Acc: 0.333 Test Loss: 2.192 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.1628101
	speed: 0.2185s/iter; left time: 3073.6094s
Epoch: 9 cost time: 9.98983907699585
Epoch: 9, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.139 Vali Acc: 0.329 Test Loss: 2.139 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.8372289
	speed: 0.2185s/iter; left time: 3040.6193s
Epoch: 10 cost time: 10.424355506896973
Epoch: 10, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.194 Vali Acc: 0.318 Test Loss: 2.194 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.4193232
	speed: 0.2087s/iter; left time: 2872.0711s
Epoch: 11 cost time: 10.069241762161255
Epoch: 11, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.180 Vali Acc: 0.315 Test Loss: 2.180 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.8863797
	speed: 0.2207s/iter; left time: 3002.5320s
Epoch: 12 cost time: 10.308159351348877
Epoch: 12, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.207 Vali Acc: 0.318 Test Loss: 2.207 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.4375708
	speed: 0.1952s/iter; left time: 2626.4905s
Epoch: 13 cost time: 9.911879301071167
Epoch: 13, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.169 Vali Acc: 0.316 Test Loss: 2.169 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.0156636
	speed: 0.2140s/iter; left time: 2846.0249s
Epoch: 14 cost time: 10.020148992538452
Epoch: 14, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.149 Vali Acc: 0.316 Test Loss: 2.149 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.7457423
	speed: 0.2160s/iter; left time: 2839.1875s
Epoch: 15 cost time: 10.28978967666626
Epoch: 15, Steps: 154 | Train Loss: 2.151 Vali Loss: 2.165 Vali Acc: 0.316 Test Loss: 2.165 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 7897022
model size : 35.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9715151
	speed: 0.0857s/iter; left time: 1311.9813s
Epoch: 1 cost time: 12.138020992279053
Epoch: 1, Steps: 154 | Train Loss: 2.279 Vali Loss: 2.223 Vali Acc: 0.315 Test Loss: 2.223 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0481753
	speed: 0.2316s/iter; left time: 3508.6175s
Epoch: 2 cost time: 10.894875526428223
Epoch: 2, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.203 Vali Acc: 0.327 Test Loss: 2.203 Test Acc: 0.327
Validation loss decreased (-0.315468 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9469249
	speed: 0.2383s/iter; left time: 3572.7091s
Epoch: 3 cost time: 10.832398891448975
Epoch: 3, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.178 Vali Acc: 0.337 Test Loss: 2.178 Test Acc: 0.337
Validation loss decreased (-0.327229 --> -0.336556).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8493036
	speed: 0.2273s/iter; left time: 3372.5943s
Epoch: 4 cost time: 10.487786054611206
Epoch: 4, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.213 Vali Acc: 0.112 Test Loss: 2.213 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4666589
	speed: 0.2320s/iter; left time: 3406.4338s
Epoch: 5 cost time: 10.910853862762451
Epoch: 5, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.229 Vali Acc: 0.333 Test Loss: 2.229 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9340049
	speed: 0.2270s/iter; left time: 3298.9203s
Epoch: 6 cost time: 11.610272407531738
Epoch: 6, Steps: 154 | Train Loss: 1.825 Vali Loss: 1.963 Vali Acc: 0.371 Test Loss: 1.963 Test Acc: 0.371
Validation loss decreased (-0.336556 --> -0.371432).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5533687
	speed: 0.2320s/iter; left time: 3335.9088s
Epoch: 7 cost time: 10.607033252716064
Epoch: 7, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.422 Vali Acc: 0.339 Test Loss: 2.422 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8613704
	speed: 0.2139s/iter; left time: 3041.5901s
Epoch: 8 cost time: 10.147570133209229
Epoch: 8, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.081 Vali Acc: 0.349 Test Loss: 2.081 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0231283
	speed: 0.2095s/iter; left time: 2947.0285s
Epoch: 9 cost time: 10.350035429000854
Epoch: 9, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.189 Vali Acc: 0.318 Test Loss: 2.189 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8793886
	speed: 0.2166s/iter; left time: 3013.4792s
Epoch: 10 cost time: 10.869551658630371
Epoch: 10, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.1158850
	speed: 0.2188s/iter; left time: 3010.4422s
Epoch: 11 cost time: 10.43954873085022
Epoch: 11, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.6891325
	speed: 0.2073s/iter; left time: 2821.0286s
Epoch: 12 cost time: 10.096425294876099
Epoch: 12, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.204 Vali Acc: 0.315 Test Loss: 2.204 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8810982
	speed: 0.2210s/iter; left time: 2973.0576s
Epoch: 13 cost time: 11.656753778457642
Epoch: 13, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.2545989
	speed: 0.2455s/iter; left time: 3264.6002s
Epoch: 14 cost time: 11.411261320114136
Epoch: 14, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.8636169
	speed: 0.2317s/iter; left time: 3045.4450s
Epoch: 15 cost time: 10.482248544692993
Epoch: 15, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.0864747
	speed: 0.2322s/iter; left time: 3016.1100s
Epoch: 16 cost time: 11.09823226928711
Epoch: 16, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 7895486
model size : 35.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4763439
	speed: 0.0858s/iter; left time: 1312.8340s
Epoch: 1 cost time: 12.469929218292236
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.262 Vali Acc: 0.315 Test Loss: 2.262 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8827747
	speed: 0.2572s/iter; left time: 3896.1728s
Epoch: 2 cost time: 12.2095046043396
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.194 Vali Acc: 0.316 Test Loss: 2.194 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1990309
	speed: 0.2307s/iter; left time: 3458.8283s
Epoch: 3 cost time: 11.14873218536377
Epoch: 3, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.120 Vali Acc: 0.333 Test Loss: 2.120 Test Acc: 0.333
Validation loss decreased (-0.316280 --> -0.332501).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9002768
	speed: 0.2327s/iter; left time: 3452.8684s
Epoch: 4 cost time: 11.443371057510376
Epoch: 4, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.151 Vali Acc: 0.337 Test Loss: 2.151 Test Acc: 0.337
Validation loss decreased (-0.332501 --> -0.336556).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3169355
	speed: 0.2162s/iter; left time: 3174.7409s
Epoch: 5 cost time: 9.952821731567383
Epoch: 5, Steps: 154 | Train Loss: 1.892 Vali Loss: 2.113 Vali Acc: 0.349 Test Loss: 2.113 Test Acc: 0.349
Validation loss decreased (-0.336556 --> -0.348722).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8274002
	speed: 0.2170s/iter; left time: 3153.1518s
Epoch: 6 cost time: 10.825002908706665
Epoch: 6, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.145 Vali Acc: 0.305 Test Loss: 2.145 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4421028
	speed: 0.2238s/iter; left time: 3217.2272s
Epoch: 7 cost time: 10.716239213943481
Epoch: 7, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.211 Vali Acc: 0.192 Test Loss: 2.211 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8572342
	speed: 0.2146s/iter; left time: 3051.7111s
Epoch: 8 cost time: 10.536360740661621
Epoch: 8, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.618 Vali Acc: 0.092 Test Loss: 2.618 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9132795
	speed: 0.2230s/iter; left time: 3137.1723s
Epoch: 9 cost time: 11.107680797576904
Epoch: 9, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.114 Vali Acc: 0.373 Test Loss: 2.114 Test Acc: 0.373
Validation loss decreased (-0.348722 --> -0.372647).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6934531
	speed: 0.2498s/iter; left time: 3476.6395s
Epoch: 10 cost time: 11.741767883300781
Epoch: 10, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.270 Vali Acc: 0.355 Test Loss: 2.270 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6168669
	speed: 0.2297s/iter; left time: 3161.4555s
Epoch: 11 cost time: 10.706034660339355
Epoch: 11, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.440 Vali Acc: 0.368 Test Loss: 2.440 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9788426
	speed: 0.2360s/iter; left time: 3210.6422s
Epoch: 12 cost time: 12.00936770439148
Epoch: 12, Steps: 154 | Train Loss: 1.725 Vali Loss: 3.143 Vali Acc: 0.174 Test Loss: 3.143 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4385684
	speed: 0.2233s/iter; left time: 3003.4782s
Epoch: 13 cost time: 10.467227697372437
Epoch: 13, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.617 Vali Acc: 0.193 Test Loss: 2.617 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3161380
	speed: 0.2147s/iter; left time: 2855.8725s
Epoch: 14 cost time: 10.427057027816772
Epoch: 14, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.169 Vali Acc: 0.369 Test Loss: 2.169 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.8173265
	speed: 0.2313s/iter; left time: 3040.5915s
Epoch: 15 cost time: 10.959036111831665
Epoch: 15, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.249 Vali Acc: 0.358 Test Loss: 2.249 Test Acc: 0.358
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.9663926
	speed: 0.2206s/iter; left time: 2865.8063s
Epoch: 16 cost time: 10.487044095993042
Epoch: 16, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.225 Vali Acc: 0.355 Test Loss: 2.225 Test Acc: 0.355
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.0259233
	speed: 0.2108s/iter; left time: 2705.7412s
Epoch: 17 cost time: 10.31137752532959
Epoch: 17, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.399 Vali Acc: 0.342 Test Loss: 2.399 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.7311943
	speed: 0.2109s/iter; left time: 2675.0049s
Epoch: 18 cost time: 9.632460355758667
Epoch: 18, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.400 Vali Acc: 0.196 Test Loss: 2.400 Test Acc: 0.196
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.1827199
	speed: 0.2073s/iter; left time: 2597.2196s
Epoch: 19 cost time: 10.642353057861328
Epoch: 19, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.282 Vali Acc: 0.378 Test Loss: 2.282 Test Acc: 0.378
Validation loss decreased (-0.372647 --> -0.377512).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5138605
	speed: 0.2159s/iter; left time: 2671.8373s
Epoch: 20 cost time: 10.753870725631714
Epoch: 20, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.760 Vali Acc: 0.180 Test Loss: 2.760 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6951431
	speed: 0.2226s/iter; left time: 2720.2416s
Epoch: 21 cost time: 10.532582998275757
Epoch: 21, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.382 Vali Acc: 0.153 Test Loss: 2.382 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.5638067
	speed: 0.1888s/iter; left time: 2277.8071s
Epoch: 22 cost time: 9.839372873306274
Epoch: 22, Steps: 154 | Train Loss: 1.618 Vali Loss: 3.128 Vali Acc: 0.183 Test Loss: 3.128 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.1209283
	speed: 0.2208s/iter; left time: 2629.9070s
Epoch: 23 cost time: 10.638909101486206
Epoch: 23, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.365 Vali Acc: 0.375 Test Loss: 2.365 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1960639
	speed: 0.2152s/iter; left time: 2530.9011s
Epoch: 24 cost time: 10.929345846176147
Epoch: 24, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.355 Vali Acc: 0.363 Test Loss: 2.355 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.7837287
	speed: 0.2384s/iter; left time: 2766.2242s
Epoch: 25 cost time: 11.280684471130371
Epoch: 25, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.575 Vali Acc: 0.172 Test Loss: 2.575 Test Acc: 0.172
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.9229006
	speed: 0.2372s/iter; left time: 2716.5410s
Epoch: 26 cost time: 11.08476448059082
Epoch: 26, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.315 Vali Acc: 0.205 Test Loss: 2.315 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.9094375
	speed: 0.2346s/iter; left time: 2649.9449s
Epoch: 27 cost time: 12.931109189987183
Epoch: 27, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.380 Vali Acc: 0.204 Test Loss: 2.380 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.4376172
	speed: 0.2445s/iter; left time: 2725.0035s
Epoch: 28 cost time: 11.395029306411743
Epoch: 28, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.870 Vali Acc: 0.190 Test Loss: 2.870 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.7888879
	speed: 0.2288s/iter; left time: 2514.8058s
Epoch: 29 cost time: 10.757664918899536
Epoch: 29, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.286 Vali Acc: 0.204 Test Loss: 2.286 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 3727422
model size : 16.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6208222
	speed: 0.0741s/iter; left time: 1133.4744s
Epoch: 1 cost time: 10.803242921829224
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.181 Vali Acc: 0.317 Test Loss: 2.181 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8613870
	speed: 0.2115s/iter; left time: 3203.9859s
Epoch: 2 cost time: 10.46617579460144
Epoch: 2, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.167 Vali Acc: 0.324 Test Loss: 2.167 Test Acc: 0.324
Validation loss decreased (-0.316685 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2541165
	speed: 0.2204s/iter; left time: 3305.0509s
Epoch: 3 cost time: 10.103678226470947
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.164 Vali Acc: 0.325 Test Loss: 2.164 Test Acc: 0.325
Validation loss decreased (-0.323579 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2503984
	speed: 0.2025s/iter; left time: 3005.2955s
Epoch: 4 cost time: 9.6284019947052
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.102 Vali Acc: 0.335 Test Loss: 2.102 Test Acc: 0.335
Validation loss decreased (-0.325201 --> -0.334529).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9210268
	speed: 0.2026s/iter; left time: 2974.4897s
Epoch: 5 cost time: 10.304869890213013
Epoch: 5, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.057 Vali Acc: 0.365 Test Loss: 2.057 Test Acc: 0.365
Validation loss decreased (-0.334529 --> -0.365348).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7150903
	speed: 0.2205s/iter; left time: 3203.4211s
Epoch: 6 cost time: 10.363305807113647
Epoch: 6, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.181 Vali Acc: 0.363 Test Loss: 2.181 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2978109
	speed: 0.2082s/iter; left time: 2993.1129s
Epoch: 7 cost time: 10.562540769577026
Epoch: 7, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.214 Vali Acc: 0.363 Test Loss: 2.214 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2092505
	speed: 0.2224s/iter; left time: 3162.6605s
Epoch: 8 cost time: 10.285536766052246
Epoch: 8, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.158 Vali Acc: 0.380 Test Loss: 2.158 Test Acc: 0.380
Validation loss decreased (-0.365348 --> -0.379540).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9445177
	speed: 0.2167s/iter; left time: 3048.2288s
Epoch: 9 cost time: 10.108991384506226
Epoch: 9, Steps: 154 | Train Loss: 1.633 Vali Loss: 3.197 Vali Acc: 0.117 Test Loss: 3.197 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9560558
	speed: 0.2198s/iter; left time: 3059.0217s
Epoch: 10 cost time: 10.645804166793823
Epoch: 10, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.495 Vali Acc: 0.200 Test Loss: 2.495 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4725521
	speed: 0.2277s/iter; left time: 3133.3897s
Epoch: 11 cost time: 10.640841484069824
Epoch: 11, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.749 Vali Acc: 0.182 Test Loss: 2.749 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.3313458
	speed: 0.2179s/iter; left time: 2965.2330s
Epoch: 12 cost time: 10.342965602874756
Epoch: 12, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.438 Vali Acc: 0.363 Test Loss: 2.438 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3460829
	speed: 0.2056s/iter; left time: 2766.2760s
Epoch: 13 cost time: 10.235234260559082
Epoch: 13, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.322 Vali Acc: 0.362 Test Loss: 2.322 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5129995
	speed: 0.2171s/iter; left time: 2887.0462s
Epoch: 14 cost time: 9.858274698257446
Epoch: 14, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.532 Vali Acc: 0.214 Test Loss: 2.532 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.6121899
	speed: 0.2057s/iter; left time: 2704.1190s
Epoch: 15 cost time: 9.947626113891602
Epoch: 15, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.278 Vali Acc: 0.360 Test Loss: 2.278 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3835515
	speed: 0.2098s/iter; left time: 2725.0708s
Epoch: 16 cost time: 10.313663959503174
Epoch: 16, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.096 Vali Acc: 0.368 Test Loss: 2.096 Test Acc: 0.368
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.1953105
	speed: 0.2140s/iter; left time: 2747.3229s
Epoch: 17 cost time: 9.599522113800049
Epoch: 17, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.358 Vali Acc: 0.369 Test Loss: 2.358 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.1998976
	speed: 0.1986s/iter; left time: 2519.2553s
Epoch: 18 cost time: 9.312956809997559
Epoch: 18, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.242 Vali Acc: 0.364 Test Loss: 2.242 Test Acc: 0.364
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 3726654
model size : 16.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0926647
	speed: 0.0843s/iter; left time: 1289.7986s
Epoch: 1 cost time: 12.233514070510864
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9543790
	speed: 0.2263s/iter; left time: 3427.9020s
Epoch: 2 cost time: 10.834706544876099
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.139 Vali Acc: 0.334 Test Loss: 2.139 Test Acc: 0.334
Validation loss decreased (-0.315063 --> -0.333717).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8504448
	speed: 0.2349s/iter; left time: 3521.6788s
Epoch: 3 cost time: 11.237815618515015
Epoch: 3, Steps: 154 | Train Loss: 1.996 Vali Loss: 1.992 Vali Acc: 0.372 Test Loss: 1.992 Test Acc: 0.372
Validation loss decreased (-0.333717 --> -0.371837).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6084141
	speed: 0.2323s/iter; left time: 3446.7060s
Epoch: 4 cost time: 11.379575967788696
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.258 Vali Acc: 0.172 Test Loss: 2.258 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9046690
	speed: 0.2415s/iter; left time: 3546.1165s
Epoch: 5 cost time: 11.758400678634644
Epoch: 5, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.098 Vali Acc: 0.195 Test Loss: 2.098 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9397479
	speed: 0.2407s/iter; left time: 3498.1055s
Epoch: 6 cost time: 11.007178544998169
Epoch: 6, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.210 Vali Acc: 0.250 Test Loss: 2.210 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.8951634
	speed: 0.2168s/iter; left time: 3117.0546s
Epoch: 7 cost time: 10.082629919052124
Epoch: 7, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.393 Vali Acc: 0.189 Test Loss: 2.393 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2926158
	speed: 0.2235s/iter; left time: 3178.4533s
Epoch: 8 cost time: 11.333809614181519
Epoch: 8, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.404 Vali Acc: 0.113 Test Loss: 2.404 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.6837424
	speed: 0.2247s/iter; left time: 3161.0783s
Epoch: 9 cost time: 11.348480939865112
Epoch: 9, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.327 Vali Acc: 0.369 Test Loss: 2.327 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.5150741
	speed: 0.2208s/iter; left time: 3072.9721s
Epoch: 10 cost time: 11.141087770462036
Epoch: 10, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.544 Vali Acc: 0.167 Test Loss: 2.544 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.6813506
	speed: 0.2250s/iter; left time: 3096.1224s
Epoch: 11 cost time: 10.813002109527588
Epoch: 11, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.309 Vali Acc: 0.203 Test Loss: 2.309 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.2767420
	speed: 0.2141s/iter; left time: 2913.6370s
Epoch: 12 cost time: 10.062106370925903
Epoch: 12, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.269 Vali Acc: 0.317 Test Loss: 2.269 Test Acc: 0.317
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.0518656
	speed: 0.2239s/iter; left time: 3011.6921s
Epoch: 13 cost time: 11.17402172088623
Epoch: 13, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.106 Vali Acc: 0.368 Test Loss: 2.106 Test Acc: 0.368
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 3725886
model size : 16.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9413276
	speed: 0.0887s/iter; left time: 1356.9464s
Epoch: 1 cost time: 12.343004703521729
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.250 Vali Acc: 0.318 Test Loss: 2.250 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9706076
	speed: 0.2235s/iter; left time: 3384.9213s
Epoch: 2 cost time: 10.14268183708191
Epoch: 2, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.150 Vali Acc: 0.320 Test Loss: 2.150 Test Acc: 0.320
Validation loss decreased (-0.317901 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0046051
	speed: 0.2268s/iter; left time: 3400.4173s
Epoch: 3 cost time: 10.81983470916748
Epoch: 3, Steps: 154 | Train Loss: 2.035 Vali Loss: 2.083 Vali Acc: 0.334 Test Loss: 2.083 Test Acc: 0.334
Validation loss decreased (-0.320335 --> -0.333718).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3914117
	speed: 0.2259s/iter; left time: 3352.5839s
Epoch: 4 cost time: 11.516770839691162
Epoch: 4, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.188 Vali Acc: 0.355 Test Loss: 2.188 Test Acc: 0.355
Validation loss decreased (-0.333718 --> -0.355209).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6832514
	speed: 0.2149s/iter; left time: 3155.0783s
Epoch: 5 cost time: 10.153357982635498
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.061 Vali Acc: 0.344 Test Loss: 2.061 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1948297
	speed: 0.2135s/iter; left time: 3102.8572s
Epoch: 6 cost time: 9.709759712219238
Epoch: 6, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.351 Vali Acc: 0.107 Test Loss: 2.351 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5064573
	speed: 0.1963s/iter; left time: 2821.9331s
Epoch: 7 cost time: 9.969585180282593
Epoch: 7, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.203 Vali Acc: 0.358 Test Loss: 2.203 Test Acc: 0.358
Validation loss decreased (-0.355209 --> -0.358453).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8029581
	speed: 0.2072s/iter; left time: 2947.5783s
Epoch: 8 cost time: 10.285242795944214
Epoch: 8, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.449 Vali Acc: 0.346 Test Loss: 2.449 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3382289
	speed: 0.2196s/iter; left time: 3089.3290s
Epoch: 9 cost time: 10.908459186553955
Epoch: 9, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.106 Vali Acc: 0.376 Test Loss: 2.106 Test Acc: 0.376
Validation loss decreased (-0.358453 --> -0.375891).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0182645
	speed: 0.2162s/iter; left time: 3007.9161s
Epoch: 10 cost time: 10.521916627883911
Epoch: 10, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.250 Vali Acc: 0.373 Test Loss: 2.250 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1963609
	speed: 0.2201s/iter; left time: 3029.1793s
Epoch: 11 cost time: 10.61331844329834
Epoch: 11, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.124 Vali Acc: 0.391 Test Loss: 2.124 Test Acc: 0.391
Validation loss decreased (-0.375891 --> -0.391301).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5730939
	speed: 0.2001s/iter; left time: 2723.3754s
Epoch: 12 cost time: 9.406224966049194
Epoch: 12, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.240 Vali Acc: 0.361 Test Loss: 2.240 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3120822
	speed: 0.2209s/iter; left time: 2971.6608s
Epoch: 13 cost time: 10.90621280670166
Epoch: 13, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.546 Vali Acc: 0.216 Test Loss: 2.546 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3436735
	speed: 0.2400s/iter; left time: 3191.2859s
Epoch: 14 cost time: 11.226850509643555
Epoch: 14, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.258 Vali Acc: 0.317 Test Loss: 2.258 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.9254590
	speed: 0.2173s/iter; left time: 2856.2046s
Epoch: 15 cost time: 10.322527647018433
Epoch: 15, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.096 Vali Acc: 0.360 Test Loss: 2.096 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.5097960
	speed: 0.2224s/iter; left time: 2889.7629s
Epoch: 16 cost time: 10.275769233703613
Epoch: 16, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.167 Vali Acc: 0.373 Test Loss: 2.167 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.7179626
	speed: 0.2241s/iter; left time: 2876.8880s
Epoch: 17 cost time: 10.41730809211731
Epoch: 17, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.634 Vali Acc: 0.146 Test Loss: 2.634 Test Acc: 0.146
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.0990344
	speed: 0.2111s/iter; left time: 2677.7008s
Epoch: 18 cost time: 9.906933069229126
Epoch: 18, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.443 Vali Acc: 0.368 Test Loss: 2.443 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.6188147
	speed: 0.2109s/iter; left time: 2642.8446s
Epoch: 19 cost time: 10.686220169067383
Epoch: 19, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.256 Vali Acc: 0.370 Test Loss: 2.256 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1229239
	speed: 0.2097s/iter; left time: 2595.4613s
Epoch: 20 cost time: 10.017319440841675
Epoch: 20, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.379 Vali Acc: 0.199 Test Loss: 2.379 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.5981181
	speed: 0.2002s/iter; left time: 2446.2739s
Epoch: 21 cost time: 9.803502082824707
Epoch: 21, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.278 Vali Acc: 0.356 Test Loss: 2.278 Test Acc: 0.356
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 3725118
model size : 16.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7289219
	speed: 0.0836s/iter; left time: 1278.7806s
Epoch: 1 cost time: 11.982311248779297
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.171 Vali Acc: 0.318 Test Loss: 2.171 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1398406
	speed: 0.2186s/iter; left time: 3311.1677s
Epoch: 2 cost time: 10.778177261352539
Epoch: 2, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.368 Vali Acc: 0.129 Test Loss: 2.368 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5847722
	speed: 0.2124s/iter; left time: 3184.3551s
Epoch: 3 cost time: 9.642259359359741
Epoch: 3, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.008 Vali Acc: 0.365 Test Loss: 2.008 Test Acc: 0.365
Validation loss decreased (-0.317497 --> -0.364943).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1919236
	speed: 0.2226s/iter; left time: 3303.6442s
Epoch: 4 cost time: 10.96667218208313
Epoch: 4, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.306 Vali Acc: 0.353 Test Loss: 2.306 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8902532
	speed: 0.2415s/iter; left time: 3545.8333s
Epoch: 5 cost time: 11.912145853042603
Epoch: 5, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.094 Vali Acc: 0.355 Test Loss: 2.094 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3814182
	speed: 0.2291s/iter; left time: 3329.6020s
Epoch: 6 cost time: 11.028256177902222
Epoch: 6, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.436 Vali Acc: 0.194 Test Loss: 2.436 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7510343
	speed: 0.2263s/iter; left time: 3253.3046s
Epoch: 7 cost time: 10.863715410232544
Epoch: 7, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.264 Vali Acc: 0.383 Test Loss: 2.264 Test Acc: 0.383
Validation loss decreased (-0.364943 --> -0.382784).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3491207
	speed: 0.2276s/iter; left time: 3237.5259s
Epoch: 8 cost time: 10.244604587554932
Epoch: 8, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.312 Vali Acc: 0.218 Test Loss: 2.312 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8212086
	speed: 0.2154s/iter; left time: 3030.3914s
Epoch: 9 cost time: 10.486067533493042
Epoch: 9, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.978 Vali Acc: 0.103 Test Loss: 2.978 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8258300
	speed: 0.2175s/iter; left time: 3027.0307s
Epoch: 10 cost time: 10.667450904846191
Epoch: 10, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.362 Vali Acc: 0.181 Test Loss: 2.362 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5636766
	speed: 0.2111s/iter; left time: 2905.2577s
Epoch: 11 cost time: 10.223320245742798
Epoch: 11, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.318 Vali Acc: 0.360 Test Loss: 2.318 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1669956
	speed: 0.2050s/iter; left time: 2789.7291s
Epoch: 12 cost time: 9.996187925338745
Epoch: 12, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.766 Vali Acc: 0.090 Test Loss: 2.766 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2598974
	speed: 0.2257s/iter; left time: 3036.2151s
Epoch: 13 cost time: 10.76317548751831
Epoch: 13, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.180 Vali Acc: 0.370 Test Loss: 2.180 Test Acc: 0.370
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1758862
	speed: 0.2140s/iter; left time: 2846.4293s
Epoch: 14 cost time: 10.924164772033691
Epoch: 14, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.391 Vali Acc: 0.375 Test Loss: 2.391 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6540543
	speed: 0.2274s/iter; left time: 2989.1131s
Epoch: 15 cost time: 11.164977788925171
Epoch: 15, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.459 Vali Acc: 0.374 Test Loss: 2.459 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6461059
	speed: 0.2177s/iter; left time: 2828.0392s
Epoch: 16 cost time: 10.339262008666992
Epoch: 16, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.434 Vali Acc: 0.388 Test Loss: 2.434 Test Acc: 0.388
Validation loss decreased (-0.382784 --> -0.388459).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5180330
	speed: 0.2287s/iter; left time: 2935.7964s
Epoch: 17 cost time: 10.69308090209961
Epoch: 17, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.538 Vali Acc: 0.207 Test Loss: 2.538 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3326230
	speed: 0.2238s/iter; left time: 2837.9868s
Epoch: 18 cost time: 11.015056371688843
Epoch: 18, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.172 Vali Acc: 0.369 Test Loss: 2.172 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.7009526
	speed: 0.2214s/iter; left time: 2774.5276s
Epoch: 19 cost time: 10.851990699768066
Epoch: 19, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.347 Vali Acc: 0.379 Test Loss: 2.347 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.4005438
	speed: 0.2258s/iter; left time: 2794.7601s
Epoch: 20 cost time: 10.843587636947632
Epoch: 20, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.688 Vali Acc: 0.363 Test Loss: 2.688 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.1989762
	speed: 0.2258s/iter; left time: 2759.4473s
Epoch: 21 cost time: 10.522306203842163
Epoch: 21, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.487 Vali Acc: 0.195 Test Loss: 2.487 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6827266
	speed: 0.2159s/iter; left time: 2605.1312s
Epoch: 22 cost time: 10.832024812698364
Epoch: 22, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.560 Vali Acc: 0.367 Test Loss: 2.560 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.1217926
	speed: 0.2233s/iter; left time: 2660.5773s
Epoch: 23 cost time: 10.748574018478394
Epoch: 23, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.349 Vali Acc: 0.212 Test Loss: 2.349 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3435639
	speed: 0.2147s/iter; left time: 2524.9723s
Epoch: 24 cost time: 10.267114639282227
Epoch: 24, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.561 Vali Acc: 0.167 Test Loss: 2.561 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.6156414
	speed: 0.2212s/iter; left time: 2567.1683s
Epoch: 25 cost time: 10.524219989776611
Epoch: 25, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.687 Vali Acc: 0.144 Test Loss: 2.687 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.3146025
	speed: 0.2172s/iter; left time: 2487.4464s
Epoch: 26 cost time: 10.62007188796997
Epoch: 26, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.425 Vali Acc: 0.215 Test Loss: 2.425 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 2806334
model size : 13.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1100793
	speed: 0.0822s/iter; left time: 1258.0851s
Epoch: 1 cost time: 11.528664827346802
Epoch: 1, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7282479
	speed: 0.2020s/iter; left time: 3060.3643s
Epoch: 2 cost time: 9.981857299804688
Epoch: 2, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.225 Vali Acc: 0.320 Test Loss: 2.225 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1126354
	speed: 0.2276s/iter; left time: 3412.7098s
Epoch: 3 cost time: 10.919399499893188
Epoch: 3, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.211 Vali Acc: 0.332 Test Loss: 2.211 Test Acc: 0.332
Validation loss decreased (-0.320335 --> -0.331689).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4307489
	speed: 0.2243s/iter; left time: 3327.9297s
Epoch: 4 cost time: 11.025982856750488
Epoch: 4, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.152 Vali Acc: 0.351 Test Loss: 2.152 Test Acc: 0.351
Validation loss decreased (-0.331689 --> -0.350749).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5573418
	speed: 0.2266s/iter; left time: 3327.4130s
Epoch: 5 cost time: 10.879422903060913
Epoch: 5, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.121 Vali Acc: 0.355 Test Loss: 2.121 Test Acc: 0.355
Validation loss decreased (-0.350749 --> -0.355210).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0431838
	speed: 0.2332s/iter; left time: 3389.3375s
Epoch: 6 cost time: 10.85575556755066
Epoch: 6, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.099 Vali Acc: 0.372 Test Loss: 2.099 Test Acc: 0.372
Validation loss decreased (-0.355210 --> -0.371836).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9470721
	speed: 0.2171s/iter; left time: 3120.9243s
Epoch: 7 cost time: 9.959842920303345
Epoch: 7, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.402 Vali Acc: 0.192 Test Loss: 2.402 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6909388
	speed: 0.2184s/iter; left time: 3106.7103s
Epoch: 8 cost time: 10.593011617660522
Epoch: 8, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.840 Vali Acc: 0.184 Test Loss: 2.840 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6968726
	speed: 0.2101s/iter; left time: 2955.4087s
Epoch: 9 cost time: 10.256217002868652
Epoch: 9, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.578 Vali Acc: 0.282 Test Loss: 2.578 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4910135
	speed: 0.2034s/iter; left time: 2830.0170s
Epoch: 10 cost time: 9.645585775375366
Epoch: 10, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.434 Vali Acc: 0.220 Test Loss: 2.434 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8569266
	speed: 0.2140s/iter; left time: 2944.3027s
Epoch: 11 cost time: 10.316751718521118
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.646 Vali Acc: 0.171 Test Loss: 2.646 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4296635
	speed: 0.2059s/iter; left time: 2801.0039s
Epoch: 12 cost time: 9.8058922290802
Epoch: 12, Steps: 154 | Train Loss: 1.526 Vali Loss: 3.037 Vali Acc: 0.126 Test Loss: 3.037 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3510797
	speed: 0.2073s/iter; left time: 2789.3482s
Epoch: 13 cost time: 10.71313762664795
Epoch: 13, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.677 Vali Acc: 0.176 Test Loss: 2.677 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.7631860
	speed: 0.2151s/iter; left time: 2860.2503s
Epoch: 14 cost time: 10.04316759109497
Epoch: 14, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.945 Vali Acc: 0.185 Test Loss: 2.945 Test Acc: 0.185
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3360072
	speed: 0.2097s/iter; left time: 2756.6140s
Epoch: 15 cost time: 10.310932636260986
Epoch: 15, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.463 Vali Acc: 0.197 Test Loss: 2.463 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.6162870
	speed: 0.2212s/iter; left time: 2874.2363s
Epoch: 16 cost time: 10.973526000976562
Epoch: 16, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.747 Vali Acc: 0.198 Test Loss: 2.747 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 2805566
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0883191
	speed: 0.0868s/iter; left time: 1328.7060s
Epoch: 1 cost time: 12.951107501983643
Epoch: 1, Steps: 154 | Train Loss: 2.256 Vali Loss: 2.214 Vali Acc: 0.315 Test Loss: 2.214 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0906982
	speed: 0.2312s/iter; left time: 3501.8692s
Epoch: 2 cost time: 10.284541606903076
Epoch: 2, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.157 Vali Acc: 0.322 Test Loss: 2.157 Test Acc: 0.322
Validation loss decreased (-0.315063 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8058138
	speed: 0.2133s/iter; left time: 3198.6085s
Epoch: 3 cost time: 10.093177318572998
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.353 Vali Acc: 0.334 Test Loss: 2.353 Test Acc: 0.334
Validation loss decreased (-0.322363 --> -0.334121).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6890135
	speed: 0.2120s/iter; left time: 3146.1630s
Epoch: 4 cost time: 10.79442834854126
Epoch: 4, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.182 Vali Acc: 0.180 Test Loss: 2.182 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6364144
	speed: 0.2184s/iter; left time: 3207.2275s
Epoch: 5 cost time: 9.981914043426514
Epoch: 5, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.321 Vali Acc: 0.232 Test Loss: 2.321 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6967591
	speed: 0.2104s/iter; left time: 3057.1031s
Epoch: 6 cost time: 10.229955673217773
Epoch: 6, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.512 Vali Acc: 0.371 Test Loss: 2.512 Test Acc: 0.371
Validation loss decreased (-0.334121 --> -0.370616).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1337230
	speed: 0.2146s/iter; left time: 3085.9703s
Epoch: 7 cost time: 9.64342999458313
Epoch: 7, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.256 Vali Acc: 0.363 Test Loss: 2.256 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6387601
	speed: 0.2054s/iter; left time: 2921.1358s
Epoch: 8 cost time: 10.283068656921387
Epoch: 8, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.790 Vali Acc: 0.114 Test Loss: 2.790 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4057274
	speed: 0.2206s/iter; left time: 3103.5721s
Epoch: 9 cost time: 10.926222324371338
Epoch: 9, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.172 Vali Acc: 0.358 Test Loss: 2.172 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3243079
	speed: 0.2162s/iter; left time: 3008.3521s
Epoch: 10 cost time: 9.942005634307861
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.438 Vali Acc: 0.161 Test Loss: 2.438 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4807541
	speed: 0.2206s/iter; left time: 3036.0950s
Epoch: 11 cost time: 10.798575162887573
Epoch: 11, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.481 Vali Acc: 0.181 Test Loss: 2.481 Test Acc: 0.181
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1756837
	speed: 0.2240s/iter; left time: 3047.8204s
Epoch: 12 cost time: 11.456209659576416
Epoch: 12, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.612 Vali Acc: 0.127 Test Loss: 2.612 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.5591497
	speed: 0.2293s/iter; left time: 3085.2655s
Epoch: 13 cost time: 11.347203969955444
Epoch: 13, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.698 Vali Acc: 0.201 Test Loss: 2.698 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.7056112
	speed: 0.2308s/iter; left time: 3068.8861s
Epoch: 14 cost time: 10.907956838607788
Epoch: 14, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.565 Vali Acc: 0.188 Test Loss: 2.565 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3737335
	speed: 0.2346s/iter; left time: 3083.5092s
Epoch: 15 cost time: 10.882639646530151
Epoch: 15, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.311 Vali Acc: 0.372 Test Loss: 2.311 Test Acc: 0.372
Validation loss decreased (-0.370616 --> -0.372240).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8540109
	speed: 0.2081s/iter; left time: 2703.9221s
Epoch: 16 cost time: 9.790000438690186
Epoch: 16, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.447 Vali Acc: 0.212 Test Loss: 2.447 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5291770
	speed: 0.2145s/iter; left time: 2753.4853s
Epoch: 17 cost time: 10.716880083084106
Epoch: 17, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.728 Vali Acc: 0.144 Test Loss: 2.728 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6717063
	speed: 0.2171s/iter; left time: 2753.5588s
Epoch: 18 cost time: 10.516947031021118
Epoch: 18, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.380 Vali Acc: 0.367 Test Loss: 2.380 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.2411904
	speed: 0.2120s/iter; left time: 2655.9193s
Epoch: 19 cost time: 10.711942434310913
Epoch: 19, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.729 Vali Acc: 0.083 Test Loss: 2.729 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2465366
	speed: 0.2178s/iter; left time: 2695.2949s
Epoch: 20 cost time: 9.918578386306763
Epoch: 20, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.433 Vali Acc: 0.347 Test Loss: 2.433 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.3767519
	speed: 0.2186s/iter; left time: 2671.1558s
Epoch: 21 cost time: 11.000946044921875
Epoch: 21, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.630 Vali Acc: 0.090 Test Loss: 2.630 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.4039139
	speed: 0.2408s/iter; left time: 2905.5483s
Epoch: 22 cost time: 11.924297332763672
Epoch: 22, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.350 Vali Acc: 0.324 Test Loss: 2.350 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2604401
	speed: 0.2343s/iter; left time: 2791.5775s
Epoch: 23 cost time: 11.381025791168213
Epoch: 23, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.532 Vali Acc: 0.364 Test Loss: 2.532 Test Acc: 0.364
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 2.1424222
	speed: 0.2213s/iter; left time: 2602.1423s
Epoch: 24 cost time: 11.314269781112671
Epoch: 24, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.631 Vali Acc: 0.361 Test Loss: 2.631 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.7598422
	speed: 0.2378s/iter; left time: 2760.0366s
Epoch: 25 cost time: 11.404919385910034
Epoch: 25, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.458 Vali Acc: 0.130 Test Loss: 2.458 Test Acc: 0.130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 2804798
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0797739
	speed: 0.0891s/iter; left time: 1364.0704s
Epoch: 1 cost time: 12.482019424438477
Epoch: 1, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.202 Vali Acc: 0.316 Test Loss: 2.202 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5626483
	speed: 0.2099s/iter; left time: 3179.1749s
Epoch: 2 cost time: 9.3294677734375
Epoch: 2, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.174 Vali Acc: 0.326 Test Loss: 2.174 Test Acc: 0.326
Validation loss decreased (-0.315874 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1434298
	speed: 0.2099s/iter; left time: 3146.3213s
Epoch: 3 cost time: 10.212763547897339
Epoch: 3, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.108 Vali Acc: 0.337 Test Loss: 2.108 Test Acc: 0.337
Validation loss decreased (-0.325607 --> -0.336556).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8661031
	speed: 0.2114s/iter; left time: 3137.1440s
Epoch: 4 cost time: 9.95278787612915
Epoch: 4, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.104 Vali Acc: 0.330 Test Loss: 2.104 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5209963
	speed: 0.2087s/iter; left time: 3064.1881s
Epoch: 5 cost time: 10.113388061523438
Epoch: 5, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.260 Vali Acc: 0.354 Test Loss: 2.260 Test Acc: 0.354
Validation loss decreased (-0.336556 --> -0.353992).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8125455
	speed: 0.2174s/iter; left time: 3158.9334s
Epoch: 6 cost time: 9.753538131713867
Epoch: 6, Steps: 154 | Train Loss: 1.777 Vali Loss: 2.554 Vali Acc: 0.187 Test Loss: 2.554 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5947849
	speed: 0.2115s/iter; left time: 3041.1361s
Epoch: 7 cost time: 10.749205350875854
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.344 Vali Acc: 0.362 Test Loss: 2.344 Test Acc: 0.362
Validation loss decreased (-0.353992 --> -0.362101).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6061217
	speed: 0.2299s/iter; left time: 3270.1473s
Epoch: 8 cost time: 11.702252864837646
Epoch: 8, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.289 Vali Acc: 0.363 Test Loss: 2.289 Test Acc: 0.363
Validation loss decreased (-0.362101 --> -0.362508).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9887744
	speed: 0.2233s/iter; left time: 3141.7301s
Epoch: 9 cost time: 10.864218950271606
Epoch: 9, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.687 Vali Acc: 0.200 Test Loss: 2.687 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4437397
	speed: 0.2260s/iter; left time: 3144.7904s
Epoch: 10 cost time: 11.331969261169434
Epoch: 10, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.133 Vali Acc: 0.359 Test Loss: 2.133 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2269688
	speed: 0.2229s/iter; left time: 3067.3218s
Epoch: 11 cost time: 10.44776463508606
Epoch: 11, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.371 Vali Acc: 0.365 Test Loss: 2.371 Test Acc: 0.365
Validation loss decreased (-0.362508 --> -0.364940).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9806526
	speed: 0.2192s/iter; left time: 2982.8491s
Epoch: 12 cost time: 10.580790042877197
Epoch: 12, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.552 Vali Acc: 0.200 Test Loss: 2.552 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9339895
	speed: 0.2185s/iter; left time: 2939.6436s
Epoch: 13 cost time: 10.111586809158325
Epoch: 13, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.479 Vali Acc: 0.168 Test Loss: 2.479 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3050292
	speed: 0.2116s/iter; left time: 2814.7017s
Epoch: 14 cost time: 9.987044334411621
Epoch: 14, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.726 Vali Acc: 0.230 Test Loss: 2.726 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5973271
	speed: 0.1977s/iter; left time: 2598.8404s
Epoch: 15 cost time: 8.922319889068604
Epoch: 15, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.719 Vali Acc: 0.178 Test Loss: 2.719 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2354509
	speed: 0.1970s/iter; left time: 2559.0160s
Epoch: 16 cost time: 9.610249519348145
Epoch: 16, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.287 Vali Acc: 0.224 Test Loss: 2.287 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.3485594
	speed: 0.1993s/iter; left time: 2558.8770s
Epoch: 17 cost time: 9.215074300765991
Epoch: 17, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.812 Vali Acc: 0.199 Test Loss: 2.812 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.6889898
	speed: 0.1914s/iter; left time: 2427.0488s
Epoch: 18 cost time: 9.470181226730347
Epoch: 18, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.776 Vali Acc: 0.145 Test Loss: 2.776 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.6790776
	speed: 0.2097s/iter; left time: 2627.2296s
Epoch: 19 cost time: 9.871231317520142
Epoch: 19, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.416 Vali Acc: 0.360 Test Loss: 2.416 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.7113936
	speed: 0.2004s/iter; left time: 2479.9147s
Epoch: 20 cost time: 10.223209857940674
Epoch: 20, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.572 Vali Acc: 0.222 Test Loss: 2.572 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1720251
	speed: 0.2086s/iter; left time: 2548.9428s
Epoch: 21 cost time: 10.280518770217896
Epoch: 21, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.442 Vali Acc: 0.378 Test Loss: 2.442 Test Acc: 0.378
Validation loss decreased (-0.364940 --> -0.378321).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2774414
	speed: 0.2173s/iter; left time: 2621.9932s
Epoch: 22 cost time: 10.347445011138916
Epoch: 22, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.733 Vali Acc: 0.124 Test Loss: 2.733 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.4600141
	speed: 0.2142s/iter; left time: 2551.7697s
Epoch: 23 cost time: 10.698274850845337
Epoch: 23, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.614 Vali Acc: 0.171 Test Loss: 2.614 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.2404892
	speed: 0.2252s/iter; left time: 2648.5703s
Epoch: 24 cost time: 10.418012142181396
Epoch: 24, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.673 Vali Acc: 0.194 Test Loss: 2.673 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.9598723
	speed: 0.2399s/iter; left time: 2783.4637s
Epoch: 25 cost time: 11.274665832519531
Epoch: 25, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.696 Vali Acc: 0.107 Test Loss: 2.696 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.5069532
	speed: 0.2178s/iter; left time: 2494.1293s
Epoch: 26 cost time: 10.607503414154053
Epoch: 26, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.195 Vali Acc: 0.385 Test Loss: 2.195 Test Acc: 0.385
Validation loss decreased (-0.378321 --> -0.385217).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.5334945
	speed: 0.2254s/iter; left time: 2546.4247s
Epoch: 27 cost time: 11.031006813049316
Epoch: 27, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.310 Vali Acc: 0.399 Test Loss: 2.310 Test Acc: 0.399
Validation loss decreased (-0.385217 --> -0.399409).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.2167104
	speed: 0.2108s/iter; left time: 2349.4418s
Epoch: 28 cost time: 9.890303611755371
Epoch: 28, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.779 Vali Acc: 0.065 Test Loss: 2.779 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.1489918
	speed: 0.1981s/iter; left time: 2176.3795s
Epoch: 29 cost time: 9.836632490158081
Epoch: 29, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.832 Vali Acc: 0.089 Test Loss: 2.832 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.4458996
	speed: 0.2078s/iter; left time: 2251.7701s
Epoch: 30 cost time: 9.632073879241943
Epoch: 30, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.405 Vali Acc: 0.071 Test Loss: 3.405 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.3585541
	speed: 0.2070s/iter; left time: 2211.4098s
Epoch: 31 cost time: 10.404234647750854
Epoch: 31, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.960 Vali Acc: 0.067 Test Loss: 2.960 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 2.0922601
	speed: 0.2104s/iter; left time: 2215.2831s
Epoch: 32 cost time: 10.457257747650146
Epoch: 32, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.286 Vali Acc: 0.202 Test Loss: 2.286 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.4920489
	speed: 0.2158s/iter; left time: 2238.1242s
Epoch: 33 cost time: 10.772788286209106
Epoch: 33, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.365 Vali Acc: 0.213 Test Loss: 2.365 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.2856354
	speed: 0.2029s/iter; left time: 2073.2368s
Epoch: 34 cost time: 9.603022813796997
Epoch: 34, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.240 Vali Acc: 0.373 Test Loss: 2.240 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.3779399
	speed: 0.2107s/iter; left time: 2120.4321s
Epoch: 35 cost time: 10.999761819839478
Epoch: 35, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.556 Vali Acc: 0.099 Test Loss: 2.556 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.3021944
	speed: 0.2229s/iter; left time: 2208.9816s
Epoch: 36 cost time: 10.919171810150146
Epoch: 36, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.394 Vali Acc: 0.199 Test Loss: 2.394 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 2.2550321
	speed: 0.2225s/iter; left time: 2170.5934s
Epoch: 37 cost time: 10.584688186645508
Epoch: 37, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.739 Vali Acc: 0.075 Test Loss: 2.739 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 2804030
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1816227
	speed: 0.0771s/iter; left time: 1180.3564s
Epoch: 1 cost time: 11.121508121490479
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8221756
	speed: 0.2105s/iter; left time: 3188.2785s
Epoch: 2 cost time: 10.71216082572937
Epoch: 2, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4616556
	speed: 0.2185s/iter; left time: 3275.4760s
Epoch: 3 cost time: 9.819526672363281
Epoch: 3, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.087 Vali Acc: 0.332 Test Loss: 2.087 Test Acc: 0.332
Validation loss decreased (-0.317497 --> -0.332096).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1756601
	speed: 0.1937s/iter; left time: 2874.0184s
Epoch: 4 cost time: 9.368996143341064
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.096 Vali Acc: 0.340 Test Loss: 2.096 Test Acc: 0.340
Validation loss decreased (-0.332096 --> -0.339801).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5530767
	speed: 0.1897s/iter; left time: 2786.4127s
Epoch: 5 cost time: 9.876523733139038
Epoch: 5, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.109 Vali Acc: 0.363 Test Loss: 2.109 Test Acc: 0.363
Validation loss decreased (-0.339801 --> -0.363320).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4954240
	speed: 0.2079s/iter; left time: 3021.3198s
Epoch: 6 cost time: 9.634021520614624
Epoch: 6, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.312 Vali Acc: 0.367 Test Loss: 2.312 Test Acc: 0.367
Validation loss decreased (-0.363320 --> -0.367373).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4698893
	speed: 0.1933s/iter; left time: 2779.7668s
Epoch: 7 cost time: 9.758914470672607
Epoch: 7, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.032 Vali Acc: 0.356 Test Loss: 2.032 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8437467
	speed: 0.1915s/iter; left time: 2724.3097s
Epoch: 8 cost time: 8.789230108261108
Epoch: 8, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.606 Vali Acc: 0.226 Test Loss: 2.606 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2805167
	speed: 0.1878s/iter; left time: 2641.6507s
Epoch: 9 cost time: 9.398930549621582
Epoch: 9, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.799 Vali Acc: 0.109 Test Loss: 2.799 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4133451
	speed: 0.2122s/iter; left time: 2953.1977s
Epoch: 10 cost time: 9.64115047454834
Epoch: 10, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.697 Vali Acc: 0.189 Test Loss: 2.697 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8575594
	speed: 0.1930s/iter; left time: 2655.8493s
Epoch: 11 cost time: 10.270318984985352
Epoch: 11, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.967 Vali Acc: 0.165 Test Loss: 2.967 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7131962
	speed: 0.2183s/iter; left time: 2970.2938s
Epoch: 12 cost time: 10.57814335823059
Epoch: 12, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.552 Vali Acc: 0.201 Test Loss: 2.552 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6032073
	speed: 0.2158s/iter; left time: 2902.9041s
Epoch: 13 cost time: 9.844029426574707
Epoch: 13, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.756 Vali Acc: 0.183 Test Loss: 2.756 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5325521
	speed: 0.2053s/iter; left time: 2730.5785s
Epoch: 14 cost time: 9.935157537460327
Epoch: 14, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.726 Vali Acc: 0.129 Test Loss: 2.726 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2528263
	speed: 0.2116s/iter; left time: 2781.7285s
Epoch: 15 cost time: 10.50068736076355
Epoch: 15, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.270 Vali Acc: 0.376 Test Loss: 2.270 Test Acc: 0.376
Validation loss decreased (-0.367373 --> -0.375890).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2956225
	speed: 0.2070s/iter; left time: 2689.4054s
Epoch: 16 cost time: 9.87437891960144
Epoch: 16, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.348 Vali Acc: 0.267 Test Loss: 2.348 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2494307
	speed: 0.2026s/iter; left time: 2601.3886s
Epoch: 17 cost time: 9.46448826789856
Epoch: 17, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.447 Vali Acc: 0.356 Test Loss: 2.447 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4269648
	speed: 0.2159s/iter; left time: 2738.0116s
Epoch: 18 cost time: 10.792380809783936
Epoch: 18, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.417 Vali Acc: 0.073 Test Loss: 3.417 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3881949
	speed: 0.2138s/iter; left time: 2678.4532s
Epoch: 19 cost time: 9.191365718841553
Epoch: 19, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.225 Vali Acc: 0.344 Test Loss: 2.225 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8490872
	speed: 0.1818s/iter; left time: 2250.1422s
Epoch: 20 cost time: 10.00499701499939
Epoch: 20, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.482 Vali Acc: 0.212 Test Loss: 2.482 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.7455821
	speed: 0.2002s/iter; left time: 2447.1535s
Epoch: 21 cost time: 9.308665990829468
Epoch: 21, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.400 Vali Acc: 0.363 Test Loss: 2.400 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.5681278
	speed: 0.1935s/iter; left time: 2335.1278s
Epoch: 22 cost time: 9.469526529312134
Epoch: 22, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.907 Vali Acc: 0.379 Test Loss: 2.907 Test Acc: 0.379
Validation loss decreased (-0.375890 --> -0.379127).  Saving model ...
	iters: 100, epoch: 23 | loss: 2.0416636
	speed: 0.1950s/iter; left time: 2322.7334s
Epoch: 23 cost time: 9.481775760650635
Epoch: 23, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.145 Vali Acc: 0.088 Test Loss: 3.145 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.6050503
	speed: 0.2039s/iter; left time: 2397.9144s
Epoch: 24 cost time: 9.988688468933105
Epoch: 24, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.424 Vali Acc: 0.232 Test Loss: 2.424 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.9163830
	speed: 0.1945s/iter; left time: 2257.7424s
Epoch: 25 cost time: 8.742513656616211
Epoch: 25, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.498 Vali Acc: 0.353 Test Loss: 2.498 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.7678692
	speed: 0.1930s/iter; left time: 2210.1266s
Epoch: 26 cost time: 9.732693195343018
Epoch: 26, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.280 Vali Acc: 0.377 Test Loss: 2.280 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.3453745
	speed: 0.2133s/iter; left time: 2409.8288s
Epoch: 27 cost time: 11.056288003921509
Epoch: 27, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.574 Vali Acc: 0.211 Test Loss: 2.574 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.3534907
	speed: 0.2188s/iter; left time: 2438.1936s
Epoch: 28 cost time: 10.324741125106812
Epoch: 28, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.487 Vali Acc: 0.375 Test Loss: 2.487 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.7721015
	speed: 0.2137s/iter; left time: 2347.8565s
Epoch: 29 cost time: 10.61146879196167
Epoch: 29, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.568 Vali Acc: 0.225 Test Loss: 2.568 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 2.3185580
	speed: 0.2154s/iter; left time: 2333.4738s
Epoch: 30 cost time: 9.923709392547607
Epoch: 30, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.537 Vali Acc: 0.165 Test Loss: 2.537 Test Acc: 0.165
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.9269224
	speed: 0.2106s/iter; left time: 2249.4372s
Epoch: 31 cost time: 9.935192346572876
Epoch: 31, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.488 Vali Acc: 0.189 Test Loss: 2.488 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.4977821
	speed: 0.2092s/iter; left time: 2202.4609s
Epoch: 32 cost time: 10.303879499435425
Epoch: 32, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.858 Vali Acc: 0.377 Test Loss: 2.858 Test Acc: 0.377
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 2345790
model size : 11.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7900333
	speed: 0.0743s/iter; left time: 1136.3786s
Epoch: 1 cost time: 10.823952436447144
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9937131
	speed: 0.1971s/iter; left time: 2985.2706s
Epoch: 2 cost time: 9.805293321609497
Epoch: 2, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.172 Vali Acc: 0.323 Test Loss: 2.172 Test Acc: 0.323
Validation loss decreased (-0.315063 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8864044
	speed: 0.2126s/iter; left time: 3188.2374s
Epoch: 3 cost time: 10.101903200149536
Epoch: 3, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.219 Vali Acc: 0.329 Test Loss: 2.219 Test Acc: 0.329
Validation loss decreased (-0.323174 --> -0.329256).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3721886
	speed: 0.2016s/iter; left time: 2992.1719s
Epoch: 4 cost time: 9.572526454925537
Epoch: 4, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.153 Vali Acc: 0.352 Test Loss: 2.153 Test Acc: 0.352
Validation loss decreased (-0.329256 --> -0.352371).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9967650
	speed: 0.2035s/iter; left time: 2988.4741s
Epoch: 5 cost time: 10.102171421051025
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.244 Vali Acc: 0.361 Test Loss: 2.244 Test Acc: 0.361
Validation loss decreased (-0.352371 --> -0.360480).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6299915
	speed: 0.2005s/iter; left time: 2913.0228s
Epoch: 6 cost time: 9.476405620574951
Epoch: 6, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.108 Vali Acc: 0.369 Test Loss: 2.108 Test Acc: 0.369
Validation loss decreased (-0.360480 --> -0.368592).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5891206
	speed: 0.2012s/iter; left time: 2893.1057s
Epoch: 7 cost time: 10.105788946151733
Epoch: 7, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.125 Vali Acc: 0.359 Test Loss: 2.125 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7668220
	speed: 0.2029s/iter; left time: 2885.9219s
Epoch: 8 cost time: 10.447164535522461
Epoch: 8, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.293 Vali Acc: 0.383 Test Loss: 2.293 Test Acc: 0.383
Validation loss decreased (-0.368592 --> -0.383189).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9579276
	speed: 0.2131s/iter; left time: 2998.6137s
Epoch: 9 cost time: 10.026615142822266
Epoch: 9, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.225 Vali Acc: 0.374 Test Loss: 2.225 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5466472
	speed: 0.2113s/iter; left time: 2940.1083s
Epoch: 10 cost time: 9.94188404083252
Epoch: 10, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.473 Vali Acc: 0.206 Test Loss: 2.473 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9931017
	speed: 0.2120s/iter; left time: 2917.2745s
Epoch: 11 cost time: 10.611624956130981
Epoch: 11, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.126 Vali Acc: 0.380 Test Loss: 2.126 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2914120
	speed: 0.2102s/iter; left time: 2860.6501s
Epoch: 12 cost time: 9.992119789123535
Epoch: 12, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.475 Vali Acc: 0.391 Test Loss: 2.475 Test Acc: 0.391
Validation loss decreased (-0.383189 --> -0.390892).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1799015
	speed: 0.2112s/iter; left time: 2840.6683s
Epoch: 13 cost time: 10.432484865188599
Epoch: 13, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.496 Vali Acc: 0.371 Test Loss: 2.496 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4391203
	speed: 0.2149s/iter; left time: 2857.9988s
Epoch: 14 cost time: 9.83230710029602
Epoch: 14, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.843 Vali Acc: 0.204 Test Loss: 2.843 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3033986
	speed: 0.1931s/iter; left time: 2538.2490s
Epoch: 15 cost time: 9.692649126052856
Epoch: 15, Steps: 154 | Train Loss: 1.473 Vali Loss: 3.075 Vali Acc: 0.126 Test Loss: 3.075 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3849169
	speed: 0.2003s/iter; left time: 2602.5867s
Epoch: 16 cost time: 9.719918489456177
Epoch: 16, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.405 Vali Acc: 0.212 Test Loss: 2.405 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5922334
	speed: 0.2097s/iter; left time: 2691.4234s
Epoch: 17 cost time: 10.005088567733765
Epoch: 17, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.471 Vali Acc: 0.223 Test Loss: 2.471 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1897007
	speed: 0.1915s/iter; left time: 2428.7435s
Epoch: 18 cost time: 9.395340919494629
Epoch: 18, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.435 Vali Acc: 0.197 Test Loss: 2.435 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9261577
	speed: 0.1957s/iter; left time: 2452.0727s
Epoch: 19 cost time: 9.80784821510315
Epoch: 19, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.336 Vali Acc: 0.224 Test Loss: 2.336 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2899187
	speed: 0.2287s/iter; left time: 2829.9904s
Epoch: 20 cost time: 11.131978273391724
Epoch: 20, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.630 Vali Acc: 0.342 Test Loss: 2.630 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.1679988
	speed: 0.2080s/iter; left time: 2541.9426s
Epoch: 21 cost time: 10.34905743598938
Epoch: 21, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.368 Vali Acc: 0.359 Test Loss: 2.368 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.9760981
	speed: 0.1951s/iter; left time: 2353.9544s
Epoch: 22 cost time: 9.405505895614624
Epoch: 22, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.767 Vali Acc: 0.122 Test Loss: 2.767 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 2345022
model size : 11.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5027740
	speed: 0.0830s/iter; left time: 1270.2261s
Epoch: 1 cost time: 12.076620817184448
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.188 Vali Acc: 0.315 Test Loss: 2.188 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1110959
	speed: 0.2100s/iter; left time: 3180.6105s
Epoch: 2 cost time: 9.911268472671509
Epoch: 2, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.126 Vali Acc: 0.323 Test Loss: 2.126 Test Acc: 0.323
Validation loss decreased (-0.314658 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6481802
	speed: 0.2087s/iter; left time: 3129.2817s
Epoch: 3 cost time: 10.071002006530762
Epoch: 3, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.121 Vali Acc: 0.333 Test Loss: 2.121 Test Acc: 0.333
Validation loss decreased (-0.323174 --> -0.332907).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8689939
	speed: 0.2190s/iter; left time: 3249.6869s
Epoch: 4 cost time: 9.630213260650635
Epoch: 4, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3908923
	speed: 0.2061s/iter; left time: 3026.4261s
Epoch: 5 cost time: 9.758209943771362
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.163 Vali Acc: 0.343 Test Loss: 2.163 Test Acc: 0.343
Validation loss decreased (-0.332907 --> -0.343044).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0995270
	speed: 0.1968s/iter; left time: 2859.3861s
Epoch: 6 cost time: 9.834285974502563
Epoch: 6, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.387 Vali Acc: 0.201 Test Loss: 2.387 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6434877
	speed: 0.2132s/iter; left time: 3065.1270s
Epoch: 7 cost time: 9.587881803512573
Epoch: 7, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.773 Vali Acc: 0.168 Test Loss: 2.773 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9003508
	speed: 0.1988s/iter; left time: 2827.6340s
Epoch: 8 cost time: 9.921947717666626
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.278 Vali Acc: 0.210 Test Loss: 2.278 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5935636
	speed: 0.2050s/iter; left time: 2884.5942s
Epoch: 9 cost time: 10.886513233184814
Epoch: 9, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.344 Vali Acc: 0.362 Test Loss: 2.344 Test Acc: 0.362
Validation loss decreased (-0.343044 --> -0.362101).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6685597
	speed: 0.2257s/iter; left time: 3139.9677s
Epoch: 10 cost time: 10.449912786483765
Epoch: 10, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.059 Vali Acc: 0.380 Test Loss: 2.059 Test Acc: 0.380
Validation loss decreased (-0.362101 --> -0.379947).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2561319
	speed: 0.2095s/iter; left time: 2883.4688s
Epoch: 11 cost time: 10.424901485443115
Epoch: 11, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.425 Vali Acc: 0.368 Test Loss: 2.425 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3959010
	speed: 0.2108s/iter; left time: 2867.9984s
Epoch: 12 cost time: 10.48775053024292
Epoch: 12, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.740 Vali Acc: 0.116 Test Loss: 2.740 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2988986
	speed: 0.2037s/iter; left time: 2740.6076s
Epoch: 13 cost time: 10.471128463745117
Epoch: 13, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.633 Vali Acc: 0.187 Test Loss: 2.633 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0802379
	speed: 0.2300s/iter; left time: 3059.2513s
Epoch: 14 cost time: 11.546527624130249
Epoch: 14, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.531 Vali Acc: 0.359 Test Loss: 2.531 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6056659
	speed: 0.2195s/iter; left time: 2885.9654s
Epoch: 15 cost time: 10.416380882263184
Epoch: 15, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.261 Vali Acc: 0.266 Test Loss: 2.261 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6452980
	speed: 0.2227s/iter; left time: 2893.3888s
Epoch: 16 cost time: 10.548843145370483
Epoch: 16, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.308 Vali Acc: 0.309 Test Loss: 2.308 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8246200
	speed: 0.2252s/iter; left time: 2890.4452s
Epoch: 17 cost time: 11.019336700439453
Epoch: 17, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.436 Vali Acc: 0.367 Test Loss: 2.436 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.1953986
	speed: 0.2279s/iter; left time: 2890.5863s
Epoch: 18 cost time: 11.186481237411499
Epoch: 18, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.675 Vali Acc: 0.135 Test Loss: 2.675 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.9574468
	speed: 0.2051s/iter; left time: 2569.8893s
Epoch: 19 cost time: 10.501789093017578
Epoch: 19, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.283 Vali Acc: 0.221 Test Loss: 2.283 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0909835
	speed: 0.2165s/iter; left time: 2679.6292s
Epoch: 20 cost time: 9.622411727905273
Epoch: 20, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.323 Vali Acc: 0.393 Test Loss: 2.323 Test Acc: 0.393
Validation loss decreased (-0.379947 --> -0.392921).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0149332
	speed: 0.1998s/iter; left time: 2441.8856s
Epoch: 21 cost time: 10.050348043441772
Epoch: 21, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.397 Vali Acc: 0.375 Test Loss: 2.397 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4777551
	speed: 0.2198s/iter; left time: 2652.5136s
Epoch: 22 cost time: 10.90635871887207
Epoch: 22, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.401 Vali Acc: 0.378 Test Loss: 2.401 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.8224038
	speed: 0.2203s/iter; left time: 2624.0046s
Epoch: 23 cost time: 10.505734920501709
Epoch: 23, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.550 Vali Acc: 0.164 Test Loss: 2.550 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.5222331
	speed: 0.2097s/iter; left time: 2465.8273s
Epoch: 24 cost time: 9.970341205596924
Epoch: 24, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.194 Vali Acc: 0.371 Test Loss: 2.194 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.4068024
	speed: 0.2107s/iter; left time: 2444.9334s
Epoch: 25 cost time: 10.740583896636963
Epoch: 25, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.549 Vali Acc: 0.366 Test Loss: 2.549 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.2933626
	speed: 0.2214s/iter; left time: 2535.1167s
Epoch: 26 cost time: 10.356468439102173
Epoch: 26, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.354 Vali Acc: 0.352 Test Loss: 2.354 Test Acc: 0.352
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.1222990
	speed: 0.2246s/iter; left time: 2536.8736s
Epoch: 27 cost time: 11.122678756713867
Epoch: 27, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.346 Vali Acc: 0.358 Test Loss: 2.346 Test Acc: 0.358
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.0320437
	speed: 0.2444s/iter; left time: 2723.4153s
Epoch: 28 cost time: 11.501870393753052
Epoch: 28, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.507 Vali Acc: 0.188 Test Loss: 2.507 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.2113073
	speed: 0.2241s/iter; left time: 2462.8400s
Epoch: 29 cost time: 10.784674406051636
Epoch: 29, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.916 Vali Acc: 0.090 Test Loss: 2.916 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.3679936
	speed: 0.2320s/iter; left time: 2513.3310s
Epoch: 30 cost time: 11.321029424667358
Epoch: 30, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.340 Vali Acc: 0.348 Test Loss: 2.340 Test Acc: 0.348
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3929440389294404
model parameter : 2344254
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0961647
	speed: 0.0837s/iter; left time: 1280.7508s
Epoch: 1 cost time: 11.981780767440796
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3691144
	speed: 0.2119s/iter; left time: 3210.0584s
Epoch: 2 cost time: 10.275503158569336
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.211 Vali Acc: 0.320 Test Loss: 2.211 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319929).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0558033
	speed: 0.2072s/iter; left time: 3107.1726s
Epoch: 3 cost time: 9.592488765716553
Epoch: 3, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.094 Vali Acc: 0.327 Test Loss: 2.094 Test Acc: 0.327
Validation loss decreased (-0.319929 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5344685
	speed: 0.2039s/iter; left time: 3025.6289s
Epoch: 4 cost time: 10.066795825958252
Epoch: 4, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.221 Vali Acc: 0.365 Test Loss: 2.221 Test Acc: 0.365
Validation loss decreased (-0.326824 --> -0.364536).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9622097
	speed: 0.2146s/iter; left time: 3152.0706s
Epoch: 5 cost time: 10.245256423950195
Epoch: 5, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.216 Vali Acc: 0.384 Test Loss: 2.216 Test Acc: 0.384
Validation loss decreased (-0.364536 --> -0.384406).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7396612
	speed: 0.1957s/iter; left time: 2844.0192s
Epoch: 6 cost time: 9.237097978591919
Epoch: 6, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.402 Vali Acc: 0.197 Test Loss: 2.402 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5132515
	speed: 0.2001s/iter; left time: 2876.3617s
Epoch: 7 cost time: 9.866119384765625
Epoch: 7, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.642 Vali Acc: 0.192 Test Loss: 2.642 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1694734
	speed: 0.2213s/iter; left time: 3147.1078s
Epoch: 8 cost time: 10.91365909576416
Epoch: 8, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.869 Vali Acc: 0.137 Test Loss: 2.869 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5323458
	speed: 0.2109s/iter; left time: 2967.0203s
Epoch: 9 cost time: 10.554015159606934
Epoch: 9, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.662 Vali Acc: 0.342 Test Loss: 2.662 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3159230
	speed: 0.2196s/iter; left time: 3056.0198s
Epoch: 10 cost time: 10.64420485496521
Epoch: 10, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.476 Vali Acc: 0.367 Test Loss: 2.476 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5342848
	speed: 0.2231s/iter; left time: 3069.9991s
Epoch: 11 cost time: 10.042495965957642
Epoch: 11, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.437 Vali Acc: 0.358 Test Loss: 2.437 Test Acc: 0.358
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.6821609
	speed: 0.2065s/iter; left time: 2810.2298s
Epoch: 12 cost time: 9.99057650566101
Epoch: 12, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.300 Vali Acc: 0.352 Test Loss: 2.300 Test Acc: 0.352
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2156669
	speed: 0.2105s/iter; left time: 2832.1724s
Epoch: 13 cost time: 10.428304433822632
Epoch: 13, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.781 Vali Acc: 0.205 Test Loss: 2.781 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.1272895
	speed: 0.2207s/iter; left time: 2934.9426s
Epoch: 14 cost time: 10.16659688949585
Epoch: 14, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.504 Vali Acc: 0.235 Test Loss: 2.504 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5347822
	speed: 0.2227s/iter; left time: 2927.9952s
Epoch: 15 cost time: 10.775938987731934
Epoch: 15, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.388 Vali Acc: 0.376 Test Loss: 2.388 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 2343486
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9506826
	speed: 0.0747s/iter; left time: 1143.6230s
Epoch: 1 cost time: 11.114053964614868
Epoch: 1, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.213 Vali Acc: 0.316 Test Loss: 2.213 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8320450
	speed: 0.2190s/iter; left time: 3316.7760s
Epoch: 2 cost time: 10.557429075241089
Epoch: 2, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.181 Vali Acc: 0.326 Test Loss: 2.181 Test Acc: 0.326
Validation loss decreased (-0.315874 --> -0.326012).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9256065
	speed: 0.2158s/iter; left time: 3234.9312s
Epoch: 3 cost time: 10.303149461746216
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.082 Vali Acc: 0.343 Test Loss: 2.082 Test Acc: 0.343
Validation loss decreased (-0.326012 --> -0.343045).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8932772
	speed: 0.2209s/iter; left time: 3278.2510s
Epoch: 4 cost time: 10.931606769561768
Epoch: 4, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.102 Vali Acc: 0.372 Test Loss: 2.102 Test Acc: 0.372
Validation loss decreased (-0.343045 --> -0.371836).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5333534
	speed: 0.2149s/iter; left time: 3155.5738s
Epoch: 5 cost time: 10.086092710494995
Epoch: 5, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.117 Vali Acc: 0.356 Test Loss: 2.117 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7672904
	speed: 0.2030s/iter; left time: 2950.4444s
Epoch: 6 cost time: 10.246336460113525
Epoch: 6, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.146 Vali Acc: 0.354 Test Loss: 2.146 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8010049
	speed: 0.2212s/iter; left time: 3179.7445s
Epoch: 7 cost time: 11.299553632736206
Epoch: 7, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.677 Vali Acc: 0.117 Test Loss: 2.677 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6976998
	speed: 0.2327s/iter; left time: 3309.3762s
Epoch: 8 cost time: 11.041760921478271
Epoch: 8, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.265 Vali Acc: 0.391 Test Loss: 2.265 Test Acc: 0.391
Validation loss decreased (-0.371836 --> -0.390488).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2495446
	speed: 0.2286s/iter; left time: 3216.4032s
Epoch: 9 cost time: 10.884822130203247
Epoch: 9, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.398 Vali Acc: 0.379 Test Loss: 2.398 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5244555
	speed: 0.2274s/iter; left time: 3164.2027s
Epoch: 10 cost time: 10.599943161010742
Epoch: 10, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.976 Vali Acc: 0.126 Test Loss: 2.976 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1496766
	speed: 0.2299s/iter; left time: 3163.3478s
Epoch: 11 cost time: 10.815794229507446
Epoch: 11, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.894 Vali Acc: 0.128 Test Loss: 2.894 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4472454
	speed: 0.2424s/iter; left time: 3298.1229s
Epoch: 12 cost time: 11.82953667640686
Epoch: 12, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.552 Vali Acc: 0.182 Test Loss: 2.552 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6145633
	speed: 0.2209s/iter; left time: 2971.9824s
Epoch: 13 cost time: 10.05817174911499
Epoch: 13, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.576 Vali Acc: 0.125 Test Loss: 2.576 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6679136
	speed: 0.2059s/iter; left time: 2737.6740s
Epoch: 14 cost time: 10.263663530349731
Epoch: 14, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.466 Vali Acc: 0.356 Test Loss: 2.466 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.6071336
	speed: 0.2221s/iter; left time: 2920.0586s
Epoch: 15 cost time: 10.224514484405518
Epoch: 15, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.205 Vali Acc: 0.382 Test Loss: 2.205 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1903684
	speed: 0.2108s/iter; left time: 2737.8842s
Epoch: 16 cost time: 10.467687129974365
Epoch: 16, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.588 Vali Acc: 0.134 Test Loss: 2.588 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0637531
	speed: 0.2203s/iter; left time: 2828.1487s
Epoch: 17 cost time: 10.552390575408936
Epoch: 17, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.464 Vali Acc: 0.366 Test Loss: 2.464 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.9672799
	speed: 0.2076s/iter; left time: 2632.9285s
Epoch: 18 cost time: 10.101155281066895
Epoch: 18, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.440 Vali Acc: 0.374 Test Loss: 2.440 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 2115518
model size : 10.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2546239
	speed: 0.0922s/iter; left time: 1410.2758s
Epoch: 1 cost time: 12.799525499343872
Epoch: 1, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.224 Vali Acc: 0.315 Test Loss: 2.224 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0454769
	speed: 0.2197s/iter; left time: 3328.0148s
Epoch: 2 cost time: 10.469730138778687
Epoch: 2, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.257 Vali Acc: 0.157 Test Loss: 2.257 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0109611
	speed: 0.2243s/iter; left time: 3362.8094s
Epoch: 3 cost time: 10.472635269165039
Epoch: 3, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.159 Vali Acc: 0.327 Test Loss: 2.159 Test Acc: 0.327
Validation loss decreased (-0.315063 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9407190
	speed: 0.2284s/iter; left time: 3389.2128s
Epoch: 4 cost time: 10.48153281211853
Epoch: 4, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.056 Vali Acc: 0.338 Test Loss: 2.056 Test Acc: 0.338
Validation loss decreased (-0.327229 --> -0.337773).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2225034
	speed: 0.2236s/iter; left time: 3284.1686s
Epoch: 5 cost time: 10.59703803062439
Epoch: 5, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.054 Vali Acc: 0.352 Test Loss: 2.054 Test Acc: 0.352
Validation loss decreased (-0.337773 --> -0.351561).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3942198
	speed: 0.2303s/iter; left time: 3346.3692s
Epoch: 6 cost time: 10.91873550415039
Epoch: 6, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.004 Vali Acc: 0.362 Test Loss: 2.004 Test Acc: 0.362
Validation loss decreased (-0.351561 --> -0.361699).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8191625
	speed: 0.2115s/iter; left time: 3040.4445s
Epoch: 7 cost time: 9.22665023803711
Epoch: 7, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.262 Vali Acc: 0.356 Test Loss: 2.262 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0682986
	speed: 0.1955s/iter; left time: 2780.6066s
Epoch: 8 cost time: 9.682617664337158
Epoch: 8, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.489 Vali Acc: 0.121 Test Loss: 2.489 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1076275
	speed: 0.2114s/iter; left time: 2974.3983s
Epoch: 9 cost time: 10.397937536239624
Epoch: 9, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.963 Vali Acc: 0.113 Test Loss: 2.963 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9112338
	speed: 0.2177s/iter; left time: 3029.8849s
Epoch: 10 cost time: 10.822412252426147
Epoch: 10, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.717 Vali Acc: 0.367 Test Loss: 2.717 Test Acc: 0.367
Validation loss decreased (-0.361699 --> -0.366964).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2397509
	speed: 0.2077s/iter; left time: 2858.2880s
Epoch: 11 cost time: 10.00879192352295
Epoch: 11, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.169 Vali Acc: 0.224 Test Loss: 2.169 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3715580
	speed: 0.2071s/iter; left time: 2818.2151s
Epoch: 12 cost time: 9.488285541534424
Epoch: 12, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.814 Vali Acc: 0.178 Test Loss: 2.814 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4147397
	speed: 0.2002s/iter; left time: 2693.3218s
Epoch: 13 cost time: 10.128697156906128
Epoch: 13, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.590 Vali Acc: 0.375 Test Loss: 2.590 Test Acc: 0.375
Validation loss decreased (-0.366964 --> -0.374670).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6546961
	speed: 0.2085s/iter; left time: 2773.4005s
Epoch: 14 cost time: 10.307860136032104
Epoch: 14, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.504 Vali Acc: 0.112 Test Loss: 2.504 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3891085
	speed: 0.2117s/iter; left time: 2783.0500s
Epoch: 15 cost time: 10.388605833053589
Epoch: 15, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.491 Vali Acc: 0.374 Test Loss: 2.491 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5935004
	speed: 0.2139s/iter; left time: 2778.6292s
Epoch: 16 cost time: 10.046262741088867
Epoch: 16, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.498 Vali Acc: 0.299 Test Loss: 2.498 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5629451
	speed: 0.2170s/iter; left time: 2785.1179s
Epoch: 17 cost time: 10.419480800628662
Epoch: 17, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.873 Vali Acc: 0.117 Test Loss: 2.873 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9782816
	speed: 0.2148s/iter; left time: 2723.9487s
Epoch: 18 cost time: 10.32323169708252
Epoch: 18, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.817 Vali Acc: 0.116 Test Loss: 2.817 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.0054257
	speed: 0.2228s/iter; left time: 2791.9695s
Epoch: 19 cost time: 10.635781049728394
Epoch: 19, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.534 Vali Acc: 0.130 Test Loss: 2.534 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.4755749
	speed: 0.2285s/iter; left time: 2827.1905s
Epoch: 20 cost time: 10.953876256942749
Epoch: 20, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.495 Vali Acc: 0.370 Test Loss: 2.495 Test Acc: 0.370
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5573087
	speed: 0.2062s/iter; left time: 2519.3791s
Epoch: 21 cost time: 9.775004863739014
Epoch: 21, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.134 Vali Acc: 0.382 Test Loss: 2.134 Test Acc: 0.382
Validation loss decreased (-0.374670 --> -0.382379).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.3529364
	speed: 0.2056s/iter; left time: 2481.0544s
Epoch: 22 cost time: 10.410989046096802
Epoch: 22, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.358 Vali Acc: 0.257 Test Loss: 2.358 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0532168
	speed: 0.2224s/iter; left time: 2649.9943s
Epoch: 23 cost time: 10.311434030532837
Epoch: 23, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.635 Vali Acc: 0.206 Test Loss: 2.635 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.5080825
	speed: 0.2079s/iter; left time: 2444.1864s
Epoch: 24 cost time: 10.308770895004272
Epoch: 24, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.162 Vali Acc: 0.372 Test Loss: 2.162 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.8438590
	speed: 0.2106s/iter; left time: 2443.5207s
Epoch: 25 cost time: 10.016414403915405
Epoch: 25, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.239 Vali Acc: 0.380 Test Loss: 2.239 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.5011089
	speed: 0.2148s/iter; left time: 2459.4897s
Epoch: 26 cost time: 10.16549801826477
Epoch: 26, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.194 Vali Acc: 0.368 Test Loss: 2.194 Test Acc: 0.368
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1600103
	speed: 0.2031s/iter; left time: 2294.9165s
Epoch: 27 cost time: 10.234699726104736
Epoch: 27, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.220 Vali Acc: 0.369 Test Loss: 2.220 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.6157416
	speed: 0.2048s/iter; left time: 2282.0340s
Epoch: 28 cost time: 10.629057884216309
Epoch: 28, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.423 Vali Acc: 0.284 Test Loss: 2.423 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.1654371
	speed: 0.2214s/iter; left time: 2432.7342s
Epoch: 29 cost time: 10.653984785079956
Epoch: 29, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.598 Vali Acc: 0.380 Test Loss: 2.598 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1958790
	speed: 0.2400s/iter; left time: 2600.2739s
Epoch: 30 cost time: 11.928821086883545
Epoch: 30, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.457 Vali Acc: 0.215 Test Loss: 2.457 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.0143396
	speed: 0.2366s/iter; left time: 2527.4191s
Epoch: 31 cost time: 11.181227445602417
Epoch: 31, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.619 Vali Acc: 0.206 Test Loss: 2.619 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 2114750
model size : 10.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9318403
	speed: 0.0787s/iter; left time: 1203.5234s
Epoch: 1 cost time: 11.357253313064575
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9550354
	speed: 0.2024s/iter; left time: 3065.0748s
Epoch: 2 cost time: 9.892683029174805
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.163 Vali Acc: 0.324 Test Loss: 2.163 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.324390).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1328840
	speed: 0.2186s/iter; left time: 3277.2532s
Epoch: 3 cost time: 10.191941261291504
Epoch: 3, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.071 Vali Acc: 0.345 Test Loss: 2.071 Test Acc: 0.345
Validation loss decreased (-0.324390 --> -0.345073).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7163258
	speed: 0.2084s/iter; left time: 3092.9979s
Epoch: 4 cost time: 9.83376693725586
Epoch: 4, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.214 Vali Acc: 0.339 Test Loss: 2.214 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6637585
	speed: 0.2088s/iter; left time: 3066.3926s
Epoch: 5 cost time: 10.11842155456543
Epoch: 5, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.177 Vali Acc: 0.340 Test Loss: 2.177 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6199725
	speed: 0.2086s/iter; left time: 3031.5327s
Epoch: 6 cost time: 9.969208002090454
Epoch: 6, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.136 Vali Acc: 0.355 Test Loss: 2.136 Test Acc: 0.355
Validation loss decreased (-0.345073 --> -0.355210).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6824315
	speed: 0.2174s/iter; left time: 3126.1252s
Epoch: 7 cost time: 10.462509155273438
Epoch: 7, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.304 Vali Acc: 0.368 Test Loss: 2.304 Test Acc: 0.368
Validation loss decreased (-0.355210 --> -0.368185).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7251409
	speed: 0.2288s/iter; left time: 3254.5151s
Epoch: 8 cost time: 11.37205457687378
Epoch: 8, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.730 Vali Acc: 0.185 Test Loss: 2.730 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4585545
	speed: 0.2203s/iter; left time: 3099.0964s
Epoch: 9 cost time: 11.245007753372192
Epoch: 9, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.096 Vali Acc: 0.185 Test Loss: 3.096 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.1783404
	speed: 0.2300s/iter; left time: 3200.4491s
Epoch: 10 cost time: 10.91800308227539
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.159 Vali Acc: 0.381 Test Loss: 2.159 Test Acc: 0.381
Validation loss decreased (-0.368185 --> -0.381163).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3818473
	speed: 0.2429s/iter; left time: 3342.0346s
Epoch: 11 cost time: 11.639640092849731
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 3.073 Vali Acc: 0.084 Test Loss: 3.073 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2106417
	speed: 0.2308s/iter; left time: 3139.8364s
Epoch: 12 cost time: 11.383692264556885
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.458 Vali Acc: 0.384 Test Loss: 2.458 Test Acc: 0.384
Validation loss decreased (-0.381163 --> -0.384404).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4819342
	speed: 0.2466s/iter; left time: 3316.9742s
Epoch: 13 cost time: 11.36156964302063
Epoch: 13, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.303 Vali Acc: 0.236 Test Loss: 2.303 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1658894
	speed: 0.2265s/iter; left time: 3012.0501s
Epoch: 14 cost time: 10.363600492477417
Epoch: 14, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.499 Vali Acc: 0.249 Test Loss: 2.499 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9295908
	speed: 0.2143s/iter; left time: 2817.5709s
Epoch: 15 cost time: 11.538797855377197
Epoch: 15, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.745 Vali Acc: 0.199 Test Loss: 2.745 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3523549
	speed: 0.2357s/iter; left time: 3061.9991s
Epoch: 16 cost time: 10.648751497268677
Epoch: 16, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.719 Vali Acc: 0.193 Test Loss: 2.719 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1166687
	speed: 0.2159s/iter; left time: 2771.5843s
Epoch: 17 cost time: 10.534734964370728
Epoch: 17, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.619 Vali Acc: 0.143 Test Loss: 2.619 Test Acc: 0.143
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1895095
	speed: 0.2227s/iter; left time: 2824.7347s
Epoch: 18 cost time: 11.10578727722168
Epoch: 18, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.811 Vali Acc: 0.140 Test Loss: 2.811 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.7149427
	speed: 0.2179s/iter; left time: 2730.6383s
Epoch: 19 cost time: 10.456968069076538
Epoch: 19, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.928 Vali Acc: 0.121 Test Loss: 2.928 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.2802293
	speed: 0.2195s/iter; left time: 2716.8307s
Epoch: 20 cost time: 10.363667488098145
Epoch: 20, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.527 Vali Acc: 0.157 Test Loss: 2.527 Test Acc: 0.157
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0578232
	speed: 0.2342s/iter; left time: 2862.3405s
Epoch: 21 cost time: 11.698733806610107
Epoch: 21, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.876 Vali Acc: 0.139 Test Loss: 2.876 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.8134214
	speed: 0.2395s/iter; left time: 2890.3945s
Epoch: 22 cost time: 11.190839290618896
Epoch: 22, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.287 Vali Acc: 0.371 Test Loss: 2.287 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 2113982
model size : 10.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2653639
	speed: 0.0852s/iter; left time: 1303.8908s
Epoch: 1 cost time: 11.885663747787476
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.254 Vali Acc: 0.315 Test Loss: 2.254 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1289055
	speed: 0.2161s/iter; left time: 3273.9410s
Epoch: 2 cost time: 10.246356010437012
Epoch: 2, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.145 Vali Acc: 0.327 Test Loss: 2.145 Test Acc: 0.327
Validation loss decreased (-0.315063 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9169555
	speed: 0.2183s/iter; left time: 3273.5839s
Epoch: 3 cost time: 10.037732124328613
Epoch: 3, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.348 Vali Acc: 0.330 Test Loss: 2.348 Test Acc: 0.330
Validation loss decreased (-0.327229 --> -0.330066).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0655529
	speed: 0.2054s/iter; left time: 3047.6376s
Epoch: 4 cost time: 9.662355899810791
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.154 Vali Acc: 0.350 Test Loss: 2.154 Test Acc: 0.350
Validation loss decreased (-0.330066 --> -0.350343).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2336769
	speed: 0.2136s/iter; left time: 3136.5285s
Epoch: 5 cost time: 10.598018884658813
Epoch: 5, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.291 Vali Acc: 0.179 Test Loss: 2.291 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7054377
	speed: 0.2087s/iter; left time: 3032.9937s
Epoch: 6 cost time: 9.9043550491333
Epoch: 6, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.351 Vali Acc: 0.352 Test Loss: 2.351 Test Acc: 0.352
Validation loss decreased (-0.350343 --> -0.351964).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6570330
	speed: 0.2121s/iter; left time: 3049.3289s
Epoch: 7 cost time: 9.98876166343689
Epoch: 7, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.532 Vali Acc: 0.247 Test Loss: 2.532 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1495855
	speed: 0.2138s/iter; left time: 3041.4367s
Epoch: 8 cost time: 10.516863584518433
Epoch: 8, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.247 Vali Acc: 0.373 Test Loss: 2.247 Test Acc: 0.373
Validation loss decreased (-0.351964 --> -0.373051).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6786486
	speed: 0.2020s/iter; left time: 2841.3570s
Epoch: 9 cost time: 9.468318700790405
Epoch: 9, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.726 Vali Acc: 0.192 Test Loss: 2.726 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8536825
	speed: 0.2064s/iter; left time: 2872.5452s
Epoch: 10 cost time: 10.160401344299316
Epoch: 10, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.826 Vali Acc: 0.162 Test Loss: 2.826 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4146386
	speed: 0.2073s/iter; left time: 2852.3599s
Epoch: 11 cost time: 10.406299591064453
Epoch: 11, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.782 Vali Acc: 0.185 Test Loss: 2.782 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5490283
	speed: 0.2058s/iter; left time: 2799.8225s
Epoch: 12 cost time: 9.778991937637329
Epoch: 12, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.461 Vali Acc: 0.137 Test Loss: 2.461 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.7508814
	speed: 0.2107s/iter; left time: 2835.1256s
Epoch: 13 cost time: 10.080774068832397
Epoch: 13, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.607 Vali Acc: 0.286 Test Loss: 2.607 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6701890
	speed: 0.2201s/iter; left time: 2927.5234s
Epoch: 14 cost time: 10.304500579833984
Epoch: 14, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.600 Vali Acc: 0.135 Test Loss: 2.600 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4104626
	speed: 0.2166s/iter; left time: 2847.7525s
Epoch: 15 cost time: 10.461981773376465
Epoch: 15, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.638 Vali Acc: 0.216 Test Loss: 2.638 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.4014827
	speed: 0.2187s/iter; left time: 2840.5128s
Epoch: 16 cost time: 10.281671285629272
Epoch: 16, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.423 Vali Acc: 0.225 Test Loss: 2.423 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2219118
	speed: 0.2204s/iter; left time: 2829.2670s
Epoch: 17 cost time: 9.848507642745972
Epoch: 17, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.422 Vali Acc: 0.255 Test Loss: 2.422 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.6432348
	speed: 0.2146s/iter; left time: 2722.1586s
Epoch: 18 cost time: 10.745301485061646
Epoch: 18, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.478 Vali Acc: 0.209 Test Loss: 2.478 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 2113214
model size : 10.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7981539
	speed: 0.0809s/iter; left time: 1238.4245s
Epoch: 1 cost time: 11.829545974731445
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.232 Vali Acc: 0.315 Test Loss: 2.232 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0573580
	speed: 0.1910s/iter; left time: 2893.2083s
Epoch: 2 cost time: 9.320355415344238
Epoch: 2, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.179 Vali Acc: 0.319 Test Loss: 2.179 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9671053
	speed: 0.2052s/iter; left time: 3076.9431s
Epoch: 3 cost time: 10.787132024765015
Epoch: 3, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.137 Vali Acc: 0.332 Test Loss: 2.137 Test Acc: 0.332
Validation loss decreased (-0.318713 --> -0.331690).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6192002
	speed: 0.2129s/iter; left time: 3159.6794s
Epoch: 4 cost time: 9.892051935195923
Epoch: 4, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.197 Vali Acc: 0.354 Test Loss: 2.197 Test Acc: 0.354
Validation loss decreased (-0.331690 --> -0.353993).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0817330
	speed: 0.2092s/iter; left time: 3072.8022s
Epoch: 5 cost time: 10.720614671707153
Epoch: 5, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.457 Vali Acc: 0.352 Test Loss: 2.457 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5585316
	speed: 0.2158s/iter; left time: 3135.5268s
Epoch: 6 cost time: 10.594677209854126
Epoch: 6, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.301 Vali Acc: 0.200 Test Loss: 2.301 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6513244
	speed: 0.2122s/iter; left time: 3050.1549s
Epoch: 7 cost time: 10.13999319076538
Epoch: 7, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.640 Vali Acc: 0.193 Test Loss: 2.640 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1263957
	speed: 0.2225s/iter; left time: 3164.5584s
Epoch: 8 cost time: 11.218218326568604
Epoch: 8, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.526 Vali Acc: 0.358 Test Loss: 2.526 Test Acc: 0.358
Validation loss decreased (-0.353993 --> -0.358044).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7424675
	speed: 0.2352s/iter; left time: 3309.6958s
Epoch: 9 cost time: 11.62861442565918
Epoch: 9, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.638 Vali Acc: 0.191 Test Loss: 2.638 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1351817
	speed: 0.2197s/iter; left time: 3057.4334s
Epoch: 10 cost time: 10.221868753433228
Epoch: 10, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.759 Vali Acc: 0.195 Test Loss: 2.759 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2574584
	speed: 0.2146s/iter; left time: 2952.5036s
Epoch: 11 cost time: 11.425217628479004
Epoch: 11, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.395 Vali Acc: 0.178 Test Loss: 2.395 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2339934
	speed: 0.2347s/iter; left time: 3193.1004s
Epoch: 12 cost time: 11.588852882385254
Epoch: 12, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.528 Vali Acc: 0.192 Test Loss: 2.528 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5758345
	speed: 0.2333s/iter; left time: 3138.9212s
Epoch: 13 cost time: 11.187575817108154
Epoch: 13, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.166 Vali Acc: 0.162 Test Loss: 3.166 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0342522
	speed: 0.2291s/iter; left time: 3047.0689s
Epoch: 14 cost time: 10.285756587982178
Epoch: 14, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.375 Vali Acc: 0.106 Test Loss: 3.375 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.9741071
	speed: 0.2094s/iter; left time: 2751.9136s
Epoch: 15 cost time: 10.23812747001648
Epoch: 15, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.219 Vali Acc: 0.129 Test Loss: 3.219 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1150258
	speed: 0.2052s/iter; left time: 2665.5920s
Epoch: 16 cost time: 10.106823921203613
Epoch: 16, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.503 Vali Acc: 0.379 Test Loss: 2.503 Test Acc: 0.379
Validation loss decreased (-0.358044 --> -0.379131).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0851408
	speed: 0.2254s/iter; left time: 2893.1242s
Epoch: 17 cost time: 11.040544986724854
Epoch: 17, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.800 Vali Acc: 0.130 Test Loss: 2.800 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6535242
	speed: 0.2276s/iter; left time: 2887.0569s
Epoch: 18 cost time: 11.388808965682983
Epoch: 18, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.770 Vali Acc: 0.170 Test Loss: 2.770 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4299203
	speed: 0.2290s/iter; left time: 2869.4525s
Epoch: 19 cost time: 10.658843994140625
Epoch: 19, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.992 Vali Acc: 0.090 Test Loss: 2.992 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.4915291
	speed: 0.2095s/iter; left time: 2592.1443s
Epoch: 20 cost time: 10.412937641143799
Epoch: 20, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.599 Vali Acc: 0.379 Test Loss: 2.599 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4732494
	speed: 0.2105s/iter; left time: 2572.4538s
Epoch: 21 cost time: 10.094634532928467
Epoch: 21, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.600 Vali Acc: 0.101 Test Loss: 2.600 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.1023865
	speed: 0.2200s/iter; left time: 2654.2717s
Epoch: 22 cost time: 10.780811548233032
Epoch: 22, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.010 Vali Acc: 0.368 Test Loss: 3.010 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.8400623
	speed: 0.2321s/iter; left time: 2764.4998s
Epoch: 23 cost time: 11.239212036132812
Epoch: 23, Steps: 154 | Train Loss: 1.289 Vali Loss: 3.447 Vali Acc: 0.077 Test Loss: 3.447 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3133631
	speed: 0.2341s/iter; left time: 2752.5410s
Epoch: 24 cost time: 10.649245500564575
Epoch: 24, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.060 Vali Acc: 0.079 Test Loss: 3.060 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.5110525
	speed: 0.2290s/iter; left time: 2657.4899s
Epoch: 25 cost time: 11.03481388092041
Epoch: 25, Steps: 154 | Train Loss: 1.285 Vali Loss: 2.671 Vali Acc: 0.198 Test Loss: 2.671 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.5362866
	speed: 0.2373s/iter; left time: 2717.7478s
Epoch: 26 cost time: 10.930912733078003
Epoch: 26, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.986 Vali Acc: 0.068 Test Loss: 3.986 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 1408574
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6613462
	speed: 0.0922s/iter; left time: 1410.6441s
Epoch: 1 cost time: 12.685011863708496
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.228 Vali Acc: 0.315 Test Loss: 2.228 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2880330
	speed: 0.1921s/iter; left time: 2909.0131s
Epoch: 2 cost time: 9.380031824111938
Epoch: 2, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.211 Vali Acc: 0.322 Test Loss: 2.211 Test Acc: 0.322
Validation loss decreased (-0.315063 --> -0.321551).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5777247
	speed: 0.2070s/iter; left time: 3103.9584s
Epoch: 3 cost time: 9.999497413635254
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.048 Vali Acc: 0.350 Test Loss: 2.048 Test Acc: 0.350
Validation loss decreased (-0.321551 --> -0.350344).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8230008
	speed: 0.2222s/iter; left time: 3296.8962s
Epoch: 4 cost time: 11.128297805786133
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 1.964 Vali Acc: 0.364 Test Loss: 1.964 Test Acc: 0.364
Validation loss decreased (-0.350344 --> -0.364133).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9956856
	speed: 0.2253s/iter; left time: 3308.3682s
Epoch: 5 cost time: 10.725837469100952
Epoch: 5, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.153 Vali Acc: 0.360 Test Loss: 2.153 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4874184
	speed: 0.2140s/iter; left time: 3108.9108s
Epoch: 6 cost time: 11.085302829742432
Epoch: 6, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.306 Vali Acc: 0.352 Test Loss: 2.306 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8182566
	speed: 0.2306s/iter; left time: 3315.4773s
Epoch: 7 cost time: 11.34228515625
Epoch: 7, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.403 Vali Acc: 0.382 Test Loss: 2.403 Test Acc: 0.382
Validation loss decreased (-0.364133 --> -0.381566).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4054766
	speed: 0.2436s/iter; left time: 3464.2006s
Epoch: 8 cost time: 12.328622341156006
Epoch: 8, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.394 Vali Acc: 0.374 Test Loss: 2.394 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8965845
	speed: 0.2597s/iter; left time: 3653.2977s
Epoch: 9 cost time: 11.917140245437622
Epoch: 9, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.348 Vali Acc: 0.399 Test Loss: 2.348 Test Acc: 0.399
Validation loss decreased (-0.381566 --> -0.398598).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1360760
	speed: 0.2249s/iter; left time: 3129.0234s
Epoch: 10 cost time: 11.270385026931763
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.905 Vali Acc: 0.117 Test Loss: 2.905 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4149494
	speed: 0.2349s/iter; left time: 3233.1213s
Epoch: 11 cost time: 11.136701583862305
Epoch: 11, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.194 Vali Acc: 0.240 Test Loss: 2.194 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5699935
	speed: 0.2363s/iter; left time: 3215.7867s
Epoch: 12 cost time: 10.397445678710938
Epoch: 12, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.851 Vali Acc: 0.248 Test Loss: 2.851 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1749967
	speed: 0.2131s/iter; left time: 2867.4769s
Epoch: 13 cost time: 10.814352035522461
Epoch: 13, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.648 Vali Acc: 0.180 Test Loss: 2.648 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.7194785
	speed: 0.2106s/iter; left time: 2800.5562s
Epoch: 14 cost time: 9.71842074394226
Epoch: 14, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.619 Vali Acc: 0.376 Test Loss: 2.619 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4907389
	speed: 0.2099s/iter; left time: 2759.2086s
Epoch: 15 cost time: 10.53731107711792
Epoch: 15, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.734 Vali Acc: 0.358 Test Loss: 2.734 Test Acc: 0.358
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.7472438
	speed: 0.2234s/iter; left time: 2902.4905s
Epoch: 16 cost time: 11.393568992614746
Epoch: 16, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.405 Vali Acc: 0.374 Test Loss: 2.405 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.1434493
	speed: 0.2244s/iter; left time: 2881.2500s
Epoch: 17 cost time: 10.84655237197876
Epoch: 17, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.870 Vali Acc: 0.178 Test Loss: 2.870 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6696452
	speed: 0.2187s/iter; left time: 2773.4223s
Epoch: 18 cost time: 10.651987791061401
Epoch: 18, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.913 Vali Acc: 0.163 Test Loss: 2.913 Test Acc: 0.163
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1718096
	speed: 0.2224s/iter; left time: 2785.9867s
Epoch: 19 cost time: 11.222323417663574
Epoch: 19, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.811 Vali Acc: 0.132 Test Loss: 2.811 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3986212489862125
model parameter : 1408190
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0234656
	speed: 0.0895s/iter; left time: 1368.9523s
Epoch: 1 cost time: 12.766989946365356
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0345104
	speed: 0.2214s/iter; left time: 3352.9455s
Epoch: 2 cost time: 9.843662738800049
Epoch: 2, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.137 Vali Acc: 0.318 Test Loss: 2.137 Test Acc: 0.318
Validation loss decreased (-0.315469 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1541870
	speed: 0.2090s/iter; left time: 3133.4540s
Epoch: 3 cost time: 9.44971489906311
Epoch: 3, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.163 Vali Acc: 0.168 Test Loss: 2.163 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9605385
	speed: 0.2142s/iter; left time: 3177.9006s
Epoch: 4 cost time: 10.495134830474854
Epoch: 4, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.078 Vali Acc: 0.355 Test Loss: 2.078 Test Acc: 0.355
Validation loss decreased (-0.318308 --> -0.354805).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0316556
	speed: 0.2088s/iter; left time: 3066.1495s
Epoch: 5 cost time: 9.67551589012146
Epoch: 5, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.040 Vali Acc: 0.348 Test Loss: 2.040 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2230624
	speed: 0.2004s/iter; left time: 2912.1077s
Epoch: 6 cost time: 9.99660849571228
Epoch: 6, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.122 Vali Acc: 0.364 Test Loss: 2.122 Test Acc: 0.364
Validation loss decreased (-0.354805 --> -0.364131).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3389347
	speed: 0.2005s/iter; left time: 2882.5126s
Epoch: 7 cost time: 9.52967357635498
Epoch: 7, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.115 Vali Acc: 0.357 Test Loss: 2.115 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3955131
	speed: 0.1907s/iter; left time: 2712.6195s
Epoch: 8 cost time: 9.852442026138306
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.754 Vali Acc: 0.183 Test Loss: 2.754 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4416108
	speed: 0.2031s/iter; left time: 2857.1800s
Epoch: 9 cost time: 10.005768775939941
Epoch: 9, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.504 Vali Acc: 0.357 Test Loss: 2.504 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2690519
	speed: 0.2072s/iter; left time: 2882.9548s
Epoch: 10 cost time: 9.713624954223633
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.753 Vali Acc: 0.360 Test Loss: 2.753 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3376397
	speed: 0.1837s/iter; left time: 2527.9539s
Epoch: 11 cost time: 9.198153972625732
Epoch: 11, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.574 Vali Acc: 0.194 Test Loss: 2.574 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3570111
	speed: 0.1949s/iter; left time: 2651.4406s
Epoch: 12 cost time: 9.841368913650513
Epoch: 12, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.463 Vali Acc: 0.363 Test Loss: 2.463 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1297336
	speed: 0.2054s/iter; left time: 2762.7421s
Epoch: 13 cost time: 10.523578405380249
Epoch: 13, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.148 Vali Acc: 0.237 Test Loss: 2.148 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4184788
	speed: 0.2130s/iter; left time: 2832.5084s
Epoch: 14 cost time: 10.508302211761475
Epoch: 14, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.782 Vali Acc: 0.361 Test Loss: 2.782 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0917230
	speed: 0.2178s/iter; left time: 2863.1910s
Epoch: 15 cost time: 10.418639898300171
Epoch: 15, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.110 Vali Acc: 0.190 Test Loss: 3.110 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0397785
	speed: 0.2060s/iter; left time: 2676.5750s
Epoch: 16 cost time: 9.86179256439209
Epoch: 16, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.161 Vali Acc: 0.148 Test Loss: 3.161 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36415247364152475
model parameter : 1407806
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1688814
	speed: 0.0808s/iter; left time: 1237.0550s
Epoch: 1 cost time: 11.684904098510742
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4574730
	speed: 0.2074s/iter; left time: 3141.2638s
Epoch: 2 cost time: 9.26219391822815
Epoch: 2, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.219 Vali Acc: 0.323 Test Loss: 2.219 Test Acc: 0.323
Validation loss decreased (-0.315064 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6195552
	speed: 0.1919s/iter; left time: 2876.9478s
Epoch: 3 cost time: 9.550220251083374
Epoch: 3, Steps: 154 | Train Loss: 2.007 Vali Loss: 2.195 Vali Acc: 0.333 Test Loss: 2.195 Test Acc: 0.333
Validation loss decreased (-0.322768 --> -0.332500).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8629118
	speed: 0.1940s/iter; left time: 2878.2161s
Epoch: 4 cost time: 9.531974792480469
Epoch: 4, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.138 Vali Acc: 0.185 Test Loss: 2.138 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6954690
	speed: 0.1990s/iter; left time: 2922.7801s
Epoch: 5 cost time: 9.607848644256592
Epoch: 5, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.365 Vali Acc: 0.356 Test Loss: 2.365 Test Acc: 0.356
Validation loss decreased (-0.332500 --> -0.355613).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6062598
	speed: 0.2021s/iter; left time: 2936.6956s
Epoch: 6 cost time: 9.622851133346558
Epoch: 6, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.384 Vali Acc: 0.358 Test Loss: 2.384 Test Acc: 0.358
Validation loss decreased (-0.355613 --> -0.358451).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7132869
	speed: 0.1928s/iter; left time: 2771.3458s
Epoch: 7 cost time: 9.185094118118286
Epoch: 7, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.580 Vali Acc: 0.197 Test Loss: 2.580 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0098743
	speed: 0.1864s/iter; left time: 2651.0388s
Epoch: 8 cost time: 9.374133825302124
Epoch: 8, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.623 Vali Acc: 0.190 Test Loss: 2.623 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4330288
	speed: 0.1897s/iter; left time: 2669.4354s
Epoch: 9 cost time: 9.748346328735352
Epoch: 9, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.639 Vali Acc: 0.123 Test Loss: 2.639 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4906807
	speed: 0.2031s/iter; left time: 2825.5485s
Epoch: 10 cost time: 10.122085332870483
Epoch: 10, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.567 Vali Acc: 0.189 Test Loss: 2.567 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7232714
	speed: 0.2079s/iter; left time: 2860.8835s
Epoch: 11 cost time: 10.106790542602539
Epoch: 11, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.813 Vali Acc: 0.149 Test Loss: 2.813 Test Acc: 0.149
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3801841
	speed: 0.2010s/iter; left time: 2734.9280s
Epoch: 12 cost time: 9.581189155578613
Epoch: 12, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.868 Vali Acc: 0.126 Test Loss: 2.868 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.9862602
	speed: 0.2126s/iter; left time: 2860.0457s
Epoch: 13 cost time: 10.415767669677734
Epoch: 13, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.763 Vali Acc: 0.195 Test Loss: 2.763 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5621505
	speed: 0.2032s/iter; left time: 2702.0740s
Epoch: 14 cost time: 9.52642273902893
Epoch: 14, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.672 Vali Acc: 0.207 Test Loss: 2.672 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2013831
	speed: 0.2077s/iter; left time: 2729.7866s
Epoch: 15 cost time: 9.932518482208252
Epoch: 15, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.084 Vali Acc: 0.126 Test Loss: 3.084 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.3985515
	speed: 0.1883s/iter; left time: 2445.8674s
Epoch: 16 cost time: 8.825506687164307
Epoch: 16, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.465 Vali Acc: 0.268 Test Loss: 2.465 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3584752635847526
model parameter : 1407422
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4321539
	speed: 0.0828s/iter; left time: 1266.9540s
Epoch: 1 cost time: 11.699109315872192
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9515911
	speed: 0.2031s/iter; left time: 3076.8083s
Epoch: 2 cost time: 9.60154914855957
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.168 Vali Acc: 0.170 Test Loss: 2.168 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8269439
	speed: 0.2033s/iter; left time: 3047.4135s
Epoch: 3 cost time: 9.323012113571167
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.069 Vali Acc: 0.341 Test Loss: 2.069 Test Acc: 0.341
Validation loss decreased (-0.315063 --> -0.340612).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2752564
	speed: 0.1963s/iter; left time: 2912.2021s
Epoch: 4 cost time: 10.021950483322144
Epoch: 4, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.206 Vali Acc: 0.345 Test Loss: 2.206 Test Acc: 0.345
Validation loss decreased (-0.340612 --> -0.344666).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5202340
	speed: 0.2144s/iter; left time: 3148.7309s
Epoch: 5 cost time: 10.826622724533081
Epoch: 5, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.264 Vali Acc: 0.190 Test Loss: 2.264 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9806143
	speed: 0.2070s/iter; left time: 3007.4942s
Epoch: 6 cost time: 9.987417936325073
Epoch: 6, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.660 Vali Acc: 0.184 Test Loss: 2.660 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3402345
	speed: 0.2115s/iter; left time: 3040.2752s
Epoch: 7 cost time: 9.754651069641113
Epoch: 7, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.369 Vali Acc: 0.214 Test Loss: 2.369 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4302055
	speed: 0.2083s/iter; left time: 2962.6568s
Epoch: 8 cost time: 10.012793064117432
Epoch: 8, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.776 Vali Acc: 0.205 Test Loss: 2.776 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3745782
	speed: 0.2156s/iter; left time: 3033.5162s
Epoch: 9 cost time: 10.384491443634033
Epoch: 9, Steps: 154 | Train Loss: 1.579 Vali Loss: 3.042 Vali Acc: 0.146 Test Loss: 3.042 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.8746330
	speed: 0.2227s/iter; left time: 3098.7024s
Epoch: 10 cost time: 10.95110535621643
Epoch: 10, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.981 Vali Acc: 0.117 Test Loss: 2.981 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1043116
	speed: 0.2257s/iter; left time: 3105.7654s
Epoch: 11 cost time: 10.322364330291748
Epoch: 11, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.715 Vali Acc: 0.193 Test Loss: 2.715 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.6668136
	speed: 0.2051s/iter; left time: 2790.8111s
Epoch: 12 cost time: 9.846330165863037
Epoch: 12, Steps: 154 | Train Loss: 1.459 Vali Loss: 3.081 Vali Acc: 0.189 Test Loss: 3.081 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2234945
	speed: 0.1995s/iter; left time: 2683.5007s
Epoch: 13 cost time: 11.022733211517334
Epoch: 13, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.211 Vali Acc: 0.113 Test Loss: 3.211 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3373781
	speed: 0.2141s/iter; left time: 2846.7014s
Epoch: 14 cost time: 10.103004455566406
Epoch: 14, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.973 Vali Acc: 0.130 Test Loss: 2.973 Test Acc: 0.130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3446877534468775
model parameter : 946238
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2797968
	speed: 0.0838s/iter; left time: 1282.4851s
Epoch: 1 cost time: 11.818703889846802
Epoch: 1, Steps: 154 | Train Loss: 2.200 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1212611
	speed: 0.2028s/iter; left time: 3072.1386s
Epoch: 2 cost time: 9.949027061462402
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.144 Vali Acc: 0.321 Test Loss: 2.144 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0588086
	speed: 0.2022s/iter; left time: 3030.8693s
Epoch: 3 cost time: 9.84639048576355
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.150 Vali Acc: 0.328 Test Loss: 2.150 Test Acc: 0.328
Validation loss decreased (-0.320741 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2066782
	speed: 0.2141s/iter; left time: 3177.2212s
Epoch: 4 cost time: 9.892720937728882
Epoch: 4, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.097 Vali Acc: 0.350 Test Loss: 2.097 Test Acc: 0.350
Validation loss decreased (-0.327635 --> -0.349938).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7560614
	speed: 0.2039s/iter; left time: 2994.2357s
Epoch: 5 cost time: 9.854450225830078
Epoch: 5, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.096 Vali Acc: 0.189 Test Loss: 2.096 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3891606
	speed: 0.2022s/iter; left time: 2938.6429s
Epoch: 6 cost time: 10.061148405075073
Epoch: 6, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.127 Vali Acc: 0.352 Test Loss: 2.127 Test Acc: 0.352
Validation loss decreased (-0.349938 --> -0.351966).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6121112
	speed: 0.2139s/iter; left time: 3075.3068s
Epoch: 7 cost time: 10.29844069480896
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.091 Vali Acc: 0.355 Test Loss: 2.091 Test Acc: 0.355
Validation loss decreased (-0.351966 --> -0.355210).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6404985
	speed: 0.2086s/iter; left time: 2966.2852s
Epoch: 8 cost time: 10.264129161834717
Epoch: 8, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.022 Vali Acc: 0.362 Test Loss: 2.022 Test Acc: 0.362
Validation loss decreased (-0.355210 --> -0.362105).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5691683
	speed: 0.2134s/iter; left time: 3002.9505s
Epoch: 9 cost time: 10.053478479385376
Epoch: 9, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.997 Vali Acc: 0.110 Test Loss: 2.997 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4574128
	speed: 0.2049s/iter; left time: 2851.4795s
Epoch: 10 cost time: 9.074335098266602
Epoch: 10, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.951 Vali Acc: 0.105 Test Loss: 2.951 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5168611
	speed: 0.1893s/iter; left time: 2605.6194s
Epoch: 11 cost time: 9.984652757644653
Epoch: 11, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.712 Vali Acc: 0.229 Test Loss: 2.712 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2475668
	speed: 0.1961s/iter; left time: 2668.0270s
Epoch: 12 cost time: 9.699542760848999
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.847 Vali Acc: 0.225 Test Loss: 2.847 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4346548
	speed: 0.1973s/iter; left time: 2654.2074s
Epoch: 13 cost time: 9.534103155136108
Epoch: 13, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.972 Vali Acc: 0.362 Test Loss: 2.972 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2694046
	speed: 0.1956s/iter; left time: 2601.6479s
Epoch: 14 cost time: 9.976407527923584
Epoch: 14, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.403 Vali Acc: 0.105 Test Loss: 3.403 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.5304871
	speed: 0.2189s/iter; left time: 2877.0417s
Epoch: 15 cost time: 10.914640188217163
Epoch: 15, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.877 Vali Acc: 0.342 Test Loss: 2.877 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.0871651
	speed: 0.2098s/iter; left time: 2725.9018s
Epoch: 16 cost time: 10.72156310081482
Epoch: 16, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.066 Vali Acc: 0.116 Test Loss: 3.066 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2466989
	speed: 0.2201s/iter; left time: 2825.1575s
Epoch: 17 cost time: 11.983172178268433
Epoch: 17, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.899 Vali Acc: 0.091 Test Loss: 2.899 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2582262
	speed: 0.2224s/iter; left time: 2820.4847s
Epoch: 18 cost time: 10.641380786895752
Epoch: 18, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.847 Vali Acc: 0.087 Test Loss: 2.847 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36212489862124897
model parameter : 945854
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1643648
	speed: 0.0832s/iter; left time: 1273.1801s
Epoch: 1 cost time: 11.887591361999512
Epoch: 1, Steps: 154 | Train Loss: 2.210 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1971242
	speed: 0.2180s/iter; left time: 3302.6026s
Epoch: 2 cost time: 10.57411527633667
Epoch: 2, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.139 Vali Acc: 0.324 Test Loss: 2.139 Test Acc: 0.324
Validation loss decreased (-0.314658 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6214002
	speed: 0.2193s/iter; left time: 3288.1233s
Epoch: 3 cost time: 10.468264102935791
Epoch: 3, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.222 Vali Acc: 0.329 Test Loss: 2.222 Test Acc: 0.329
Validation loss decreased (-0.324391 --> -0.328850).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1447058
	speed: 0.2211s/iter; left time: 3280.2820s
Epoch: 4 cost time: 10.553367137908936
Epoch: 4, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.022 Vali Acc: 0.359 Test Loss: 2.022 Test Acc: 0.359
Validation loss decreased (-0.328850 --> -0.359266).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6931534
	speed: 0.2102s/iter; left time: 3087.3538s
Epoch: 5 cost time: 10.400891542434692
Epoch: 5, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.738 Vali Acc: 0.096 Test Loss: 2.738 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9594812
	speed: 0.2141s/iter; left time: 3110.7631s
Epoch: 6 cost time: 10.319682121276855
Epoch: 6, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.303 Vali Acc: 0.355 Test Loss: 2.303 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5143137
	speed: 0.1927s/iter; left time: 2770.9925s
Epoch: 7 cost time: 9.305638313293457
Epoch: 7, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.630 Vali Acc: 0.122 Test Loss: 2.630 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5316170
	speed: 0.1762s/iter; left time: 2506.5860s
Epoch: 8 cost time: 9.473449230194092
Epoch: 8, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.415 Vali Acc: 0.366 Test Loss: 2.415 Test Acc: 0.366
Validation loss decreased (-0.359266 --> -0.366156).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9065493
	speed: 0.1993s/iter; left time: 2804.2925s
Epoch: 9 cost time: 9.960610389709473
Epoch: 9, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.527 Vali Acc: 0.242 Test Loss: 2.527 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4038832
	speed: 0.2059s/iter; left time: 2864.4953s
Epoch: 10 cost time: 11.239258289337158
Epoch: 10, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.876 Vali Acc: 0.147 Test Loss: 2.876 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8537883
	speed: 0.2180s/iter; left time: 3000.5022s
Epoch: 11 cost time: 10.382199048995972
Epoch: 11, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.626 Vali Acc: 0.219 Test Loss: 2.626 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5396441
	speed: 0.2126s/iter; left time: 2892.4522s
Epoch: 12 cost time: 10.813907384872437
Epoch: 12, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.875 Vali Acc: 0.167 Test Loss: 2.875 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.1749721
	speed: 0.2292s/iter; left time: 3083.2013s
Epoch: 13 cost time: 10.321942329406738
Epoch: 13, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.676 Vali Acc: 0.203 Test Loss: 2.676 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.1739771
	speed: 0.2094s/iter; left time: 2784.2323s
Epoch: 14 cost time: 9.938896179199219
Epoch: 14, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.757 Vali Acc: 0.152 Test Loss: 2.757 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1552396
	speed: 0.2207s/iter; left time: 2901.0332s
Epoch: 15 cost time: 10.947213649749756
Epoch: 15, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.061 Vali Acc: 0.195 Test Loss: 3.061 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.6114824
	speed: 0.2140s/iter; left time: 2780.0184s
Epoch: 16 cost time: 10.44426441192627
Epoch: 16, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.900 Vali Acc: 0.195 Test Loss: 2.900 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.7604612
	speed: 0.2095s/iter; left time: 2689.9661s
Epoch: 17 cost time: 10.065679788589478
Epoch: 17, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.493 Vali Acc: 0.107 Test Loss: 3.493 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0934426
	speed: 0.2121s/iter; left time: 2690.2308s
Epoch: 18 cost time: 10.163250923156738
Epoch: 18, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.385 Vali Acc: 0.124 Test Loss: 3.385 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 945470
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1762674
	speed: 0.0830s/iter; left time: 1269.8603s
Epoch: 1 cost time: 11.664133548736572
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.175 Vali Acc: 0.315 Test Loss: 2.175 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0655878
	speed: 0.1908s/iter; left time: 2889.5926s
Epoch: 2 cost time: 9.259244680404663
Epoch: 2, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.158 Vali Acc: 0.317 Test Loss: 2.158 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1590745
	speed: 0.1853s/iter; left time: 2778.6355s
Epoch: 3 cost time: 8.686603307723999
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.095 Vali Acc: 0.336 Test Loss: 2.095 Test Acc: 0.336
Validation loss decreased (-0.316686 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7665619
	speed: 0.1926s/iter; left time: 2857.5577s
Epoch: 4 cost time: 9.588299036026001
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.138 Vali Acc: 0.345 Test Loss: 2.138 Test Acc: 0.345
Validation loss decreased (-0.336151 --> -0.344666).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6404737
	speed: 0.1915s/iter; left time: 2811.9590s
Epoch: 5 cost time: 9.608144521713257
Epoch: 5, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.155 Vali Acc: 0.353 Test Loss: 2.155 Test Acc: 0.353
Validation loss decreased (-0.344666 --> -0.353182).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8908861
	speed: 0.2010s/iter; left time: 2920.1846s
Epoch: 6 cost time: 10.634440422058105
Epoch: 6, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.267 Vali Acc: 0.351 Test Loss: 2.267 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8085586
	speed: 0.2168s/iter; left time: 3117.4616s
Epoch: 7 cost time: 10.288356304168701
Epoch: 7, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.443 Vali Acc: 0.195 Test Loss: 2.443 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5100050
	speed: 0.2098s/iter; left time: 2984.1130s
Epoch: 8 cost time: 9.734151363372803
Epoch: 8, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.752 Vali Acc: 0.179 Test Loss: 2.752 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7904706
	speed: 0.2067s/iter; left time: 2907.5047s
Epoch: 9 cost time: 10.498270034790039
Epoch: 9, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.380 Vali Acc: 0.361 Test Loss: 2.380 Test Acc: 0.361
Validation loss decreased (-0.353182 --> -0.360479).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5762389
	speed: 0.2160s/iter; left time: 3005.0752s
Epoch: 10 cost time: 9.899564981460571
Epoch: 10, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.651 Vali Acc: 0.192 Test Loss: 2.651 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0349691
	speed: 0.2058s/iter; left time: 2832.2690s
Epoch: 11 cost time: 9.86215615272522
Epoch: 11, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.371 Vali Acc: 0.369 Test Loss: 2.371 Test Acc: 0.369
Validation loss decreased (-0.360479 --> -0.368589).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8638639
	speed: 0.1966s/iter; left time: 2675.5537s
Epoch: 12 cost time: 8.814252376556396
Epoch: 12, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.788 Vali Acc: 0.117 Test Loss: 2.788 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6312234
	speed: 0.1838s/iter; left time: 2472.0020s
Epoch: 13 cost time: 8.9486403465271
Epoch: 13, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.483 Vali Acc: 0.206 Test Loss: 2.483 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5923258
	speed: 0.1916s/iter; left time: 2548.4599s
Epoch: 14 cost time: 9.906310558319092
Epoch: 14, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.577 Vali Acc: 0.361 Test Loss: 2.577 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4767997
	speed: 0.1960s/iter; left time: 2576.9782s
Epoch: 15 cost time: 9.38344430923462
Epoch: 15, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.788 Vali Acc: 0.129 Test Loss: 2.788 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4299234
	speed: 0.1875s/iter; left time: 2436.2233s
Epoch: 16 cost time: 8.922416687011719
Epoch: 16, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.305 Vali Acc: 0.221 Test Loss: 2.305 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.3068470
	speed: 0.1819s/iter; left time: 2335.5742s
Epoch: 17 cost time: 9.389963150024414
Epoch: 17, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.579 Vali Acc: 0.184 Test Loss: 2.579 Test Acc: 0.184
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1460999
	speed: 0.1863s/iter; left time: 2363.0524s
Epoch: 18 cost time: 9.262696504592896
Epoch: 18, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.677 Vali Acc: 0.342 Test Loss: 2.677 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5514488
	speed: 0.1891s/iter; left time: 2368.8630s
Epoch: 19 cost time: 9.399873971939087
Epoch: 19, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.239 Vali Acc: 0.197 Test Loss: 3.239 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4536011
	speed: 0.1988s/iter; left time: 2460.5871s
Epoch: 20 cost time: 10.257307291030884
Epoch: 20, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.923 Vali Acc: 0.125 Test Loss: 2.923 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.3501663
	speed: 0.2012s/iter; left time: 2459.1742s
Epoch: 21 cost time: 9.407245635986328
Epoch: 21, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.153 Vali Acc: 0.116 Test Loss: 3.153 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 945086
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1907248
	speed: 0.0848s/iter; left time: 1297.0400s
Epoch: 1 cost time: 12.035269260406494
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.198 Vali Acc: 0.155 Test Loss: 2.198 Test Acc: 0.155
Validation loss decreased (inf --> -0.154885).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3550019
	speed: 0.2081s/iter; left time: 3151.7235s
Epoch: 2 cost time: 9.992068767547607
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.194 Vali Acc: 0.321 Test Loss: 2.194 Test Acc: 0.321
Validation loss decreased (-0.154885 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2131391
	speed: 0.2063s/iter; left time: 3093.4636s
Epoch: 3 cost time: 10.075291872024536
Epoch: 3, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.049 Vali Acc: 0.343 Test Loss: 2.049 Test Acc: 0.343
Validation loss decreased (-0.321146 --> -0.343451).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8864406
	speed: 0.2059s/iter; left time: 3055.0427s
Epoch: 4 cost time: 10.006172895431519
Epoch: 4, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.149 Vali Acc: 0.190 Test Loss: 2.149 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7662725
	speed: 0.2436s/iter; left time: 3577.5870s
Epoch: 5 cost time: 11.20684003829956
Epoch: 5, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.188 Vali Acc: 0.188 Test Loss: 2.188 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7158706
	speed: 0.2530s/iter; left time: 3676.6875s
Epoch: 6 cost time: 12.31564211845398
Epoch: 6, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.262 Vali Acc: 0.364 Test Loss: 2.262 Test Acc: 0.364
Validation loss decreased (-0.343451 --> -0.363724).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3176590
	speed: 0.2979s/iter; left time: 4283.0945s
Epoch: 7 cost time: 12.865890502929688
Epoch: 7, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.455 Vali Acc: 0.355 Test Loss: 2.455 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7620711
	speed: 0.2832s/iter; left time: 4028.1723s
Epoch: 8 cost time: 12.221647500991821
Epoch: 8, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.851 Vali Acc: 0.111 Test Loss: 2.851 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9135592
	speed: 0.2703s/iter; left time: 3803.5499s
Epoch: 9 cost time: 12.176361799240112
Epoch: 9, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.907 Vali Acc: 0.140 Test Loss: 2.907 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2517922
	speed: 0.2873s/iter; left time: 3997.3121s
Epoch: 10 cost time: 12.73419713973999
Epoch: 10, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.023 Vali Acc: 0.071 Test Loss: 3.023 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2650397
	speed: 0.2932s/iter; left time: 4034.7539s
Epoch: 11 cost time: 12.432509183883667
Epoch: 11, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.662 Vali Acc: 0.242 Test Loss: 2.662 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1890804
	speed: 0.2966s/iter; left time: 4035.7031s
Epoch: 12 cost time: 12.391570091247559
Epoch: 12, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.209 Vali Acc: 0.150 Test Loss: 3.209 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.4222080
	speed: 0.2932s/iter; left time: 3944.6924s
Epoch: 13 cost time: 12.966182708740234
Epoch: 13, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.945 Vali Acc: 0.205 Test Loss: 2.945 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.1955233
	speed: 0.3028s/iter; left time: 4026.2726s
Epoch: 14 cost time: 13.728972911834717
Epoch: 14, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.303 Vali Acc: 0.110 Test Loss: 3.303 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.9108784
	speed: 0.3717s/iter; left time: 4885.5939s
Epoch: 15 cost time: 15.591277599334717
Epoch: 15, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.005 Vali Acc: 0.195 Test Loss: 3.005 Test Acc: 0.195
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.6859013
	speed: 0.3797s/iter; left time: 4932.0531s
Epoch: 16 cost time: 15.615171432495117
Epoch: 16, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.200 Vali Acc: 0.133 Test Loss: 3.200 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3637469586374696
model parameter : 715070
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2263193
	speed: 0.1612s/iter; left time: 2466.4556s
Epoch: 1 cost time: 22.46784496307373
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6243405
	speed: 0.4538s/iter; left time: 6873.6271s
Epoch: 2 cost time: 20.167442083358765
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
Validation loss decreased (-0.314658 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7765741
	speed: 0.4430s/iter; left time: 6642.0830s
Epoch: 3 cost time: 17.829471826553345
Epoch: 3, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.036 Vali Acc: 0.340 Test Loss: 2.036 Test Acc: 0.340
Validation loss decreased (-0.319119 --> -0.339801).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2049239
	speed: 0.3974s/iter; left time: 5896.3985s
Epoch: 4 cost time: 16.929115772247314
Epoch: 4, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.119 Vali Acc: 0.351 Test Loss: 2.119 Test Acc: 0.351
Validation loss decreased (-0.339801 --> -0.351155).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5353138
	speed: 0.4083s/iter; left time: 5995.2197s
Epoch: 5 cost time: 16.934346914291382
Epoch: 5, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.333 Vali Acc: 0.194 Test Loss: 2.333 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1642840
	speed: 0.3905s/iter; left time: 5675.0818s
Epoch: 6 cost time: 16.37958312034607
Epoch: 6, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.001 Vali Acc: 0.362 Test Loss: 2.001 Test Acc: 0.362
Validation loss decreased (-0.351155 --> -0.362105).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6993322
	speed: 0.3745s/iter; left time: 5383.8610s
Epoch: 7 cost time: 16.058576345443726
Epoch: 7, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.820 Vali Acc: 0.178 Test Loss: 2.820 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1422535
	speed: 0.4000s/iter; left time: 5688.6430s
Epoch: 8 cost time: 17.202176094055176
Epoch: 8, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.494 Vali Acc: 0.184 Test Loss: 2.494 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9206547
	speed: 0.3875s/iter; left time: 5451.3407s
Epoch: 9 cost time: 15.284449815750122
Epoch: 9, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.766 Vali Acc: 0.187 Test Loss: 2.766 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5730853
	speed: 0.4185s/iter; left time: 5823.9531s
Epoch: 10 cost time: 16.592917919158936
Epoch: 10, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.679 Vali Acc: 0.191 Test Loss: 2.679 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3652135
	speed: 0.3834s/iter; left time: 5275.3590s
Epoch: 11 cost time: 15.841027021408081
Epoch: 11, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.831 Vali Acc: 0.193 Test Loss: 2.831 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3702170
	speed: 0.3984s/iter; left time: 5421.3947s
Epoch: 12 cost time: 18.07731580734253
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.065 Vali Acc: 0.120 Test Loss: 3.065 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9837588
	speed: 0.4065s/iter; left time: 5468.8546s
Epoch: 13 cost time: 15.830058336257935
Epoch: 13, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.064 Vali Acc: 0.189 Test Loss: 3.064 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3799552
	speed: 0.3906s/iter; left time: 5194.7763s
Epoch: 14 cost time: 15.782597303390503
Epoch: 14, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.865 Vali Acc: 0.377 Test Loss: 2.865 Test Acc: 0.377
Validation loss decreased (-0.362105 --> -0.376695).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2395713
	speed: 0.3974s/iter; left time: 5223.7221s
Epoch: 15 cost time: 18.34044122695923
Epoch: 15, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.575 Vali Acc: 0.105 Test Loss: 3.575 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1175356
	speed: 0.4317s/iter; left time: 5608.4611s
Epoch: 16 cost time: 17.458954572677612
Epoch: 16, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.802 Vali Acc: 0.120 Test Loss: 2.802 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3593574
	speed: 0.3965s/iter; left time: 5090.4757s
Epoch: 17 cost time: 16.753424167633057
Epoch: 17, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.420 Vali Acc: 0.112 Test Loss: 3.420 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2232312
	speed: 0.3945s/iter; left time: 5003.4212s
Epoch: 18 cost time: 16.80766987800598
Epoch: 18, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.798 Vali Acc: 0.117 Test Loss: 2.798 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2552584
	speed: 0.3702s/iter; left time: 4637.7051s
Epoch: 19 cost time: 14.918055057525635
Epoch: 19, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.048 Vali Acc: 0.153 Test Loss: 3.048 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.6433817
	speed: 0.3750s/iter; left time: 4640.7314s
Epoch: 20 cost time: 17.075337886810303
Epoch: 20, Steps: 154 | Train Loss: 1.322 Vali Loss: 3.283 Vali Acc: 0.117 Test Loss: 3.283 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.5727881
	speed: 0.3967s/iter; left time: 4847.4985s
Epoch: 21 cost time: 15.268051624298096
Epoch: 21, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.576 Vali Acc: 0.121 Test Loss: 3.576 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.2251867
	speed: 0.3809s/iter; left time: 4596.0578s
Epoch: 22 cost time: 15.324999332427979
Epoch: 22, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.164 Vali Acc: 0.122 Test Loss: 3.164 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.2556931
	speed: 0.3982s/iter; left time: 4743.1913s
Epoch: 23 cost time: 15.782566785812378
Epoch: 23, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.891 Vali Acc: 0.232 Test Loss: 2.891 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.5490845
	speed: 0.3533s/iter; left time: 4154.1873s
Epoch: 24 cost time: 15.337347507476807
Epoch: 24, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.546 Vali Acc: 0.176 Test Loss: 2.546 Test Acc: 0.176
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 714686
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9474626
	speed: 0.1249s/iter; left time: 1910.5198s
Epoch: 1 cost time: 17.89872932434082
Epoch: 1, Steps: 154 | Train Loss: 2.201 Vali Loss: 2.161 Vali Acc: 0.316 Test Loss: 2.161 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1318581
	speed: 0.3727s/iter; left time: 5645.4189s
Epoch: 2 cost time: 15.395199298858643
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.107 Vali Acc: 0.322 Test Loss: 2.107 Test Acc: 0.322
Validation loss decreased (-0.315875 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1508632
	speed: 0.3771s/iter; left time: 5653.3736s
Epoch: 3 cost time: 16.741551160812378
Epoch: 3, Steps: 154 | Train Loss: 2.029 Vali Loss: 2.201 Vali Acc: 0.328 Test Loss: 2.201 Test Acc: 0.328
Validation loss decreased (-0.322363 --> -0.328040).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4365622
	speed: 0.3842s/iter; left time: 5700.4541s
Epoch: 4 cost time: 14.193155527114868
Epoch: 4, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.038 Vali Acc: 0.354 Test Loss: 2.038 Test Acc: 0.354
Validation loss decreased (-0.328040 --> -0.354400).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0834177
	speed: 0.3718s/iter; left time: 5460.0867s
Epoch: 5 cost time: 15.95019006729126
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.191 Vali Acc: 0.197 Test Loss: 2.191 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5927138
	speed: 0.3884s/iter; left time: 5643.4781s
Epoch: 6 cost time: 16.472810983657837
Epoch: 6, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.135 Vali Acc: 0.363 Test Loss: 2.135 Test Acc: 0.363
Validation loss decreased (-0.354400 --> -0.362509).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5281363
	speed: 0.4062s/iter; left time: 5839.8386s
Epoch: 7 cost time: 18.41561484336853
Epoch: 7, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.264 Vali Acc: 0.385 Test Loss: 2.264 Test Acc: 0.385
Validation loss decreased (-0.362509 --> -0.385217).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3319149
	speed: 0.4278s/iter; left time: 6084.9617s
Epoch: 8 cost time: 17.156290292739868
Epoch: 8, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.642 Vali Acc: 0.195 Test Loss: 2.642 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0167675
	speed: 0.3897s/iter; left time: 5482.6505s
Epoch: 9 cost time: 15.688975095748901
Epoch: 9, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.795 Vali Acc: 0.144 Test Loss: 2.795 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3549279
	speed: 0.3734s/iter; left time: 5196.3564s
Epoch: 10 cost time: 15.31201434135437
Epoch: 10, Steps: 154 | Train Loss: 1.515 Vali Loss: 3.039 Vali Acc: 0.185 Test Loss: 3.039 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6508182
	speed: 0.3915s/iter; left time: 5387.4633s
Epoch: 11 cost time: 16.26199960708618
Epoch: 11, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.779 Vali Acc: 0.277 Test Loss: 2.779 Test Acc: 0.277
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3671416
	speed: 0.4015s/iter; left time: 5462.9978s
Epoch: 12 cost time: 16.946313619613647
Epoch: 12, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.893 Vali Acc: 0.202 Test Loss: 2.893 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5877006
	speed: 0.4370s/iter; left time: 5879.6059s
Epoch: 13 cost time: 17.605842113494873
Epoch: 13, Steps: 154 | Train Loss: 1.425 Vali Loss: 3.176 Vali Acc: 0.119 Test Loss: 3.176 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2917459
	speed: 0.3866s/iter; left time: 5141.3387s
Epoch: 14 cost time: 15.675524473190308
Epoch: 14, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.397 Vali Acc: 0.380 Test Loss: 2.397 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2340927
	speed: 0.3746s/iter; left time: 4924.7300s
Epoch: 15 cost time: 15.022692680358887
Epoch: 15, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.359 Vali Acc: 0.061 Test Loss: 3.359 Test Acc: 0.061
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4687005
	speed: 0.3596s/iter; left time: 4671.6073s
Epoch: 16 cost time: 15.922775030136108
Epoch: 16, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.536 Vali Acc: 0.217 Test Loss: 2.536 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1541085
	speed: 0.3849s/iter; left time: 4940.8424s
Epoch: 17 cost time: 17.241421699523926
Epoch: 17, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.895 Vali Acc: 0.213 Test Loss: 2.895 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 714302
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2377927
	speed: 0.1192s/iter; left time: 1823.5988s
Epoch: 1 cost time: 16.568416118621826
Epoch: 1, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1359487
	speed: 0.3459s/iter; left time: 5238.9893s
Epoch: 2 cost time: 14.679859161376953
Epoch: 2, Steps: 154 | Train Loss: 2.150 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4294238
	speed: 0.3683s/iter; left time: 5522.1773s
Epoch: 3 cost time: 15.24874472618103
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.086 Vali Acc: 0.330 Test Loss: 2.086 Test Acc: 0.330
Validation loss decreased (-0.315469 --> -0.330068).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9839046
	speed: 0.3506s/iter; left time: 5203.2466s
Epoch: 4 cost time: 14.040013790130615
Epoch: 4, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.079 Vali Acc: 0.348 Test Loss: 2.079 Test Acc: 0.348
Validation loss decreased (-0.330068 --> -0.348317).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3563527
	speed: 0.3212s/iter; left time: 4716.7474s
Epoch: 5 cost time: 13.336654901504517
Epoch: 5, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.204 Vali Acc: 0.351 Test Loss: 2.204 Test Acc: 0.351
Validation loss decreased (-0.348317 --> -0.351154).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6690484
	speed: 0.3486s/iter; left time: 5065.2461s
Epoch: 6 cost time: 13.835850477218628
Epoch: 6, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.076 Vali Acc: 0.353 Test Loss: 2.076 Test Acc: 0.353
Validation loss decreased (-0.351154 --> -0.352777).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6746141
	speed: 0.3631s/iter; left time: 5220.6467s
Epoch: 7 cost time: 15.088773250579834
Epoch: 7, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.603 Vali Acc: 0.185 Test Loss: 2.603 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4623582
	speed: 0.3585s/iter; left time: 5099.5925s
Epoch: 8 cost time: 14.68019700050354
Epoch: 8, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.659 Vali Acc: 0.164 Test Loss: 2.659 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8637661
	speed: 0.3543s/iter; left time: 4985.0389s
Epoch: 9 cost time: 15.04053020477295
Epoch: 9, Steps: 154 | Train Loss: 1.556 Vali Loss: 3.042 Vali Acc: 0.103 Test Loss: 3.042 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5755436
	speed: 0.3774s/iter; left time: 5251.9395s
Epoch: 10 cost time: 15.694048404693604
Epoch: 10, Steps: 154 | Train Loss: 1.548 Vali Loss: 3.333 Vali Acc: 0.129 Test Loss: 3.333 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1406199
	speed: 0.3579s/iter; left time: 4924.7836s
Epoch: 11 cost time: 14.485315084457397
Epoch: 11, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.044 Vali Acc: 0.114 Test Loss: 3.044 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7455226
	speed: 0.3491s/iter; left time: 4750.2300s
Epoch: 12 cost time: 15.810297012329102
Epoch: 12, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.862 Vali Acc: 0.121 Test Loss: 2.862 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.4423655
	speed: 0.3647s/iter; left time: 4906.3197s
Epoch: 13 cost time: 14.127651453018188
Epoch: 13, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.840 Vali Acc: 0.202 Test Loss: 2.840 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.7531782
	speed: 0.3421s/iter; left time: 4548.9682s
Epoch: 14 cost time: 14.456802606582642
Epoch: 14, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.210 Vali Acc: 0.065 Test Loss: 3.210 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.0877454
	speed: 0.3532s/iter; left time: 4643.2226s
Epoch: 15 cost time: 14.643471240997314
Epoch: 15, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.769 Vali Acc: 0.221 Test Loss: 2.769 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1121833
	speed: 0.3317s/iter; left time: 4309.2830s
Epoch: 16 cost time: 14.532585620880127
Epoch: 16, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.008 Vali Acc: 0.082 Test Loss: 3.008 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35279805352798055
model parameter : 713918
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9721949
	speed: 0.1296s/iter; left time: 1982.8205s
Epoch: 1 cost time: 18.092872619628906
Epoch: 1, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.226 Vali Acc: 0.315 Test Loss: 2.226 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8704026
	speed: 0.3409s/iter; left time: 5163.2650s
Epoch: 2 cost time: 14.138549089431763
Epoch: 2, Steps: 154 | Train Loss: 2.122 Vali Loss: 2.124 Vali Acc: 0.319 Test Loss: 2.124 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5455804
	speed: 0.3853s/iter; left time: 5776.3822s
Epoch: 3 cost time: 15.613138198852539
Epoch: 3, Steps: 154 | Train Loss: 2.037 Vali Loss: 2.225 Vali Acc: 0.324 Test Loss: 2.225 Test Acc: 0.324
Validation loss decreased (-0.319119 --> -0.323579).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0545828
	speed: 0.3822s/iter; left time: 5670.9104s
Epoch: 4 cost time: 15.865493535995483
Epoch: 4, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.134 Vali Acc: 0.343 Test Loss: 2.134 Test Acc: 0.343
Validation loss decreased (-0.323579 --> -0.343450).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1887491
	speed: 0.3635s/iter; left time: 5337.5273s
Epoch: 5 cost time: 14.74487590789795
Epoch: 5, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.344 Vali Acc: 0.362 Test Loss: 2.344 Test Acc: 0.362
Validation loss decreased (-0.343450 --> -0.361696).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3959006
	speed: 0.3577s/iter; left time: 5198.2355s
Epoch: 6 cost time: 14.881650924682617
Epoch: 6, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.256 Vali Acc: 0.355 Test Loss: 2.256 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7666278
	speed: 0.3641s/iter; left time: 5234.3254s
Epoch: 7 cost time: 16.1610689163208
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.502 Vali Acc: 0.194 Test Loss: 2.502 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5932071
	speed: 0.3732s/iter; left time: 5307.8922s
Epoch: 8 cost time: 15.843414545059204
Epoch: 8, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.624 Vali Acc: 0.138 Test Loss: 2.624 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2649089
	speed: 0.3870s/iter; left time: 5444.6877s
Epoch: 9 cost time: 16.684011220932007
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.253 Vali Acc: 0.088 Test Loss: 3.253 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.8363736
	speed: 0.3898s/iter; left time: 5424.0235s
Epoch: 10 cost time: 15.7492835521698
Epoch: 10, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.636 Vali Acc: 0.211 Test Loss: 2.636 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5600990
	speed: 0.3946s/iter; left time: 5429.8056s
Epoch: 11 cost time: 16.537203788757324
Epoch: 11, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.169 Vali Acc: 0.132 Test Loss: 3.169 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3550830
	speed: 0.3586s/iter; left time: 4879.5606s
Epoch: 12 cost time: 14.268735408782959
Epoch: 12, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.004 Vali Acc: 0.122 Test Loss: 3.004 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1881845
	speed: 0.3639s/iter; left time: 4896.1377s
Epoch: 13 cost time: 16.55834174156189
Epoch: 13, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.206 Vali Acc: 0.131 Test Loss: 3.206 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.5027314
	speed: 0.3780s/iter; left time: 5026.4763s
Epoch: 14 cost time: 15.0590341091156
Epoch: 14, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.031 Vali Acc: 0.178 Test Loss: 3.031 Test Acc: 0.178
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4808538
	speed: 0.3556s/iter; left time: 4673.8787s
Epoch: 15 cost time: 14.909757375717163
Epoch: 15, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.301 Vali Acc: 0.113 Test Loss: 3.301 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36171938361719386
model parameter : 599486
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7704279
	speed: 0.1078s/iter; left time: 1649.1971s
Epoch: 1 cost time: 15.595296621322632
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.203 Vali Acc: 0.315 Test Loss: 2.203 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0020204
	speed: 0.3494s/iter; left time: 5292.8059s
Epoch: 2 cost time: 15.193792819976807
Epoch: 2, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.196 Vali Acc: 0.316 Test Loss: 2.196 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6163821
	speed: 0.3587s/iter; left time: 5378.6305s
Epoch: 3 cost time: 16.42494010925293
Epoch: 3, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.092 Vali Acc: 0.352 Test Loss: 2.092 Test Acc: 0.352
Validation loss decreased (-0.315874 --> -0.351966).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6830848
	speed: 0.3863s/iter; left time: 5732.0488s
Epoch: 4 cost time: 14.599399328231812
Epoch: 4, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.144 Vali Acc: 0.344 Test Loss: 2.144 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5240052
	speed: 0.3670s/iter; left time: 5389.6344s
Epoch: 5 cost time: 15.210995435714722
Epoch: 5, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.394 Vali Acc: 0.335 Test Loss: 2.394 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4603417
	speed: 0.3729s/iter; left time: 5418.2134s
Epoch: 6 cost time: 15.554177284240723
Epoch: 6, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.919 Vali Acc: 0.192 Test Loss: 2.919 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6353780
	speed: 0.3710s/iter; left time: 5334.5041s
Epoch: 7 cost time: 15.595286846160889
Epoch: 7, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.799 Vali Acc: 0.100 Test Loss: 2.799 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.7062038
	speed: 0.3838s/iter; left time: 5458.2341s
Epoch: 8 cost time: 15.740329504013062
Epoch: 8, Steps: 154 | Train Loss: 1.601 Vali Loss: 3.109 Vali Acc: 0.184 Test Loss: 3.109 Test Acc: 0.184
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.7215506
	speed: 0.3616s/iter; left time: 5086.7886s
Epoch: 9 cost time: 17.00742745399475
Epoch: 9, Steps: 154 | Train Loss: 1.562 Vali Loss: 3.149 Vali Acc: 0.186 Test Loss: 3.149 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.5138392
	speed: 0.4045s/iter; left time: 5628.3357s
Epoch: 10 cost time: 16.36810302734375
Epoch: 10, Steps: 154 | Train Loss: 1.528 Vali Loss: 3.167 Vali Acc: 0.185 Test Loss: 3.167 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.4583499
	speed: 0.3549s/iter; left time: 4883.6039s
Epoch: 11 cost time: 15.403343200683594
Epoch: 11, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.374 Vali Acc: 0.191 Test Loss: 3.374 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.7975954
	speed: 0.3409s/iter; left time: 4639.2724s
Epoch: 12 cost time: 15.286398649215698
Epoch: 12, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.194 Vali Acc: 0.137 Test Loss: 3.194 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.5076458
	speed: 0.3862s/iter; left time: 5195.6383s
Epoch: 13 cost time: 17.36164379119873
Epoch: 13, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.231 Vali Acc: 0.079 Test Loss: 3.231 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3519870235198702
model parameter : 599102
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9788363
	speed: 0.1410s/iter; left time: 2156.7287s
Epoch: 1 cost time: 19.618504285812378
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.188 Vali Acc: 0.315 Test Loss: 2.188 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0415313
	speed: 0.3343s/iter; left time: 5064.2958s
Epoch: 2 cost time: 13.97566843032837
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.143 Vali Acc: 0.319 Test Loss: 2.143 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7201817
	speed: 0.3136s/iter; left time: 4701.3295s
Epoch: 3 cost time: 13.686024904251099
Epoch: 3, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.046 Vali Acc: 0.346 Test Loss: 2.046 Test Acc: 0.346
Validation loss decreased (-0.319119 --> -0.346289).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3529165
	speed: 0.3268s/iter; left time: 4849.1012s
Epoch: 4 cost time: 14.012850761413574
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.085 Vali Acc: 0.347 Test Loss: 2.085 Test Acc: 0.347
Validation loss decreased (-0.346289 --> -0.347100).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4843655
	speed: 0.3379s/iter; left time: 4961.8876s
Epoch: 5 cost time: 14.354023456573486
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.368 Vali Acc: 0.183 Test Loss: 2.368 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6175079
	speed: 0.3330s/iter; left time: 4838.2824s
Epoch: 6 cost time: 13.688847303390503
Epoch: 6, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.241 Vali Acc: 0.357 Test Loss: 2.241 Test Acc: 0.357
Validation loss decreased (-0.347100 --> -0.356831).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3906884
	speed: 0.3246s/iter; left time: 4666.5587s
Epoch: 7 cost time: 13.310392141342163
Epoch: 7, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.376 Vali Acc: 0.357 Test Loss: 2.376 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8378686
	speed: 0.3246s/iter; left time: 4616.8872s
Epoch: 8 cost time: 14.332414865493774
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.533 Vali Acc: 0.298 Test Loss: 2.533 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8541933
	speed: 0.3372s/iter; left time: 4744.2426s
Epoch: 9 cost time: 14.605567216873169
Epoch: 9, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.973 Vali Acc: 0.124 Test Loss: 2.973 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3974130
	speed: 0.3453s/iter; left time: 4805.2027s
Epoch: 10 cost time: 14.430542945861816
Epoch: 10, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.866 Vali Acc: 0.133 Test Loss: 2.866 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3532574
	speed: 0.3549s/iter; left time: 4883.6826s
Epoch: 11 cost time: 15.643953800201416
Epoch: 11, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.058 Vali Acc: 0.190 Test Loss: 3.058 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0501759
	speed: 0.3597s/iter; left time: 4894.6360s
Epoch: 12 cost time: 14.765448808670044
Epoch: 12, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.598 Vali Acc: 0.371 Test Loss: 2.598 Test Acc: 0.371
Validation loss decreased (-0.356831 --> -0.370615).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1681608
	speed: 0.3440s/iter; left time: 4628.2185s
Epoch: 13 cost time: 16.223823070526123
Epoch: 13, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.356 Vali Acc: 0.121 Test Loss: 3.356 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5085154
	speed: 0.3667s/iter; left time: 4877.1349s
Epoch: 14 cost time: 15.90386414527893
Epoch: 14, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.745 Vali Acc: 0.300 Test Loss: 2.745 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4498395
	speed: 0.3586s/iter; left time: 4713.5178s
Epoch: 15 cost time: 15.20668911933899
Epoch: 15, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.770 Vali Acc: 0.102 Test Loss: 3.770 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1226035
	speed: 0.3476s/iter; left time: 4515.0814s
Epoch: 16 cost time: 14.535422325134277
Epoch: 16, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.878 Vali Acc: 0.374 Test Loss: 2.878 Test Acc: 0.374
Validation loss decreased (-0.370615 --> -0.373856).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4432318
	speed: 0.3379s/iter; left time: 4338.2279s
Epoch: 17 cost time: 14.09482192993164
Epoch: 17, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.977 Vali Acc: 0.233 Test Loss: 2.977 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5484982
	speed: 0.3365s/iter; left time: 4268.1966s
Epoch: 18 cost time: 14.631585121154785
Epoch: 18, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.962 Vali Acc: 0.200 Test Loss: 2.962 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0914748
	speed: 0.3253s/iter; left time: 4075.8308s
Epoch: 19 cost time: 13.800844430923462
Epoch: 19, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.045 Vali Acc: 0.148 Test Loss: 3.045 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7053633
	speed: 0.3259s/iter; left time: 4033.3224s
Epoch: 20 cost time: 15.12532377243042
Epoch: 20, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.941 Vali Acc: 0.207 Test Loss: 2.941 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2578743
	speed: 0.3146s/iter; left time: 3845.2012s
Epoch: 21 cost time: 13.136609077453613
Epoch: 21, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.196 Vali Acc: 0.126 Test Loss: 3.196 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6127540
	speed: 0.3176s/iter; left time: 3833.0033s
Epoch: 22 cost time: 14.783630847930908
Epoch: 22, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.030 Vali Acc: 0.203 Test Loss: 3.030 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.9432404
	speed: 0.3393s/iter; left time: 4042.4538s
Epoch: 23 cost time: 15.03237771987915
Epoch: 23, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.454 Vali Acc: 0.078 Test Loss: 3.454 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.0098821
	speed: 0.3368s/iter; left time: 3960.6545s
Epoch: 24 cost time: 14.859222412109375
Epoch: 24, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.324 Vali Acc: 0.078 Test Loss: 3.324 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.2303643
	speed: 0.3472s/iter; left time: 4029.6566s
Epoch: 25 cost time: 15.483521938323975
Epoch: 25, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.605 Vali Acc: 0.117 Test Loss: 3.605 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.8992722
	speed: 0.3298s/iter; left time: 3776.0594s
Epoch: 26 cost time: 14.070598125457764
Epoch: 26, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.361 Vali Acc: 0.120 Test Loss: 3.361 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 598718
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7896999
	speed: 0.1298s/iter; left time: 1985.7641s
Epoch: 1 cost time: 18.266711235046387
Epoch: 1, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.142 Vali Acc: 0.315 Test Loss: 2.142 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9396610
	speed: 0.3522s/iter; left time: 5334.6608s
Epoch: 2 cost time: 15.022183418273926
Epoch: 2, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9399972
	speed: 0.3520s/iter; left time: 5277.6729s
Epoch: 3 cost time: 15.52062439918518
Epoch: 3, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.145 Vali Acc: 0.330 Test Loss: 2.145 Test Acc: 0.330
Validation loss decreased (-0.318308 --> -0.330068).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7320185
	speed: 0.3349s/iter; left time: 4970.3190s
Epoch: 4 cost time: 15.242653369903564
Epoch: 4, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.217 Vali Acc: 0.344 Test Loss: 2.217 Test Acc: 0.344
Validation loss decreased (-0.330068 --> -0.343855).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7400689
	speed: 0.3406s/iter; left time: 5001.1884s
Epoch: 5 cost time: 14.380930185317993
Epoch: 5, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.147 Vali Acc: 0.358 Test Loss: 2.147 Test Acc: 0.358
Validation loss decreased (-0.343855 --> -0.358454).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5554948
	speed: 0.3578s/iter; left time: 5199.5254s
Epoch: 6 cost time: 15.057748079299927
Epoch: 6, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.254 Vali Acc: 0.358 Test Loss: 2.254 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4032286
	speed: 0.3225s/iter; left time: 4636.5335s
Epoch: 7 cost time: 14.102099418640137
Epoch: 7, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.572 Vali Acc: 0.189 Test Loss: 2.572 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5334778
	speed: 0.3375s/iter; left time: 4799.8248s
Epoch: 8 cost time: 14.771278619766235
Epoch: 8, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.642 Vali Acc: 0.177 Test Loss: 2.642 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7738856
	speed: 0.3395s/iter; left time: 4776.9676s
Epoch: 9 cost time: 13.852055311203003
Epoch: 9, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.695 Vali Acc: 0.196 Test Loss: 2.695 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.0847425
	speed: 0.3169s/iter; left time: 4409.2393s
Epoch: 10 cost time: 14.070664644241333
Epoch: 10, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.689 Vali Acc: 0.216 Test Loss: 2.689 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5984052
	speed: 0.3288s/iter; left time: 4524.4965s
Epoch: 11 cost time: 13.41783857345581
Epoch: 11, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.909 Vali Acc: 0.197 Test Loss: 2.909 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0664631
	speed: 0.3231s/iter; left time: 4396.9769s
Epoch: 12 cost time: 14.76108717918396
Epoch: 12, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.625 Vali Acc: 0.240 Test Loss: 2.625 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3861270
	speed: 0.3398s/iter; left time: 4570.8461s
Epoch: 13 cost time: 14.188732385635376
Epoch: 13, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.872 Vali Acc: 0.211 Test Loss: 2.872 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.2950373
	speed: 0.3311s/iter; left time: 4403.1805s
Epoch: 14 cost time: 14.971985340118408
Epoch: 14, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.997 Vali Acc: 0.139 Test Loss: 2.997 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4829227
	speed: 0.3232s/iter; left time: 4249.0406s
Epoch: 15 cost time: 13.778669595718384
Epoch: 15, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.768 Vali Acc: 0.208 Test Loss: 2.768 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3584752635847526
model parameter : 598334
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6943785
	speed: 0.1167s/iter; left time: 1786.2163s
Epoch: 1 cost time: 16.64593815803528
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3382423
	speed: 0.3503s/iter; left time: 5305.9602s
Epoch: 2 cost time: 15.35149621963501
Epoch: 2, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.198 Vali Acc: 0.158 Test Loss: 2.198 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4415364
	speed: 0.3372s/iter; left time: 5054.8945s
Epoch: 3 cost time: 14.56721305847168
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.136 Vali Acc: 0.324 Test Loss: 2.136 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.323580).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8189381
	speed: 0.3316s/iter; left time: 4920.8419s
Epoch: 4 cost time: 14.383643865585327
Epoch: 4, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.074 Vali Acc: 0.340 Test Loss: 2.074 Test Acc: 0.340
Validation loss decreased (-0.323580 --> -0.340206).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9949147
	speed: 0.3342s/iter; left time: 4908.0179s
Epoch: 5 cost time: 14.159393787384033
Epoch: 5, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.046 Vali Acc: 0.351 Test Loss: 2.046 Test Acc: 0.351
Validation loss decreased (-0.340206 --> -0.351156).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7608523
	speed: 0.3240s/iter; left time: 4708.1976s
Epoch: 6 cost time: 13.455634593963623
Epoch: 6, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.456 Vali Acc: 0.343 Test Loss: 2.456 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7602639
	speed: 0.3119s/iter; left time: 4483.7549s
Epoch: 7 cost time: 14.648071527481079
Epoch: 7, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.041 Vali Acc: 0.374 Test Loss: 2.041 Test Acc: 0.374
Validation loss decreased (-0.351156 --> -0.373864).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7303190
	speed: 0.3054s/iter; left time: 4344.2646s
Epoch: 8 cost time: 12.986828804016113
Epoch: 8, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.541 Vali Acc: 0.180 Test Loss: 2.541 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6955829
	speed: 0.2967s/iter; left time: 4173.7586s
Epoch: 9 cost time: 14.006797313690186
Epoch: 9, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.653 Vali Acc: 0.232 Test Loss: 2.653 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1847217
	speed: 0.2944s/iter; left time: 4096.1418s
Epoch: 10 cost time: 13.11313509941101
Epoch: 10, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.685 Vali Acc: 0.176 Test Loss: 2.685 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6202891
	speed: 0.3217s/iter; left time: 4427.4392s
Epoch: 11 cost time: 15.676988363265991
Epoch: 11, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.263 Vali Acc: 0.210 Test Loss: 2.263 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7059734
	speed: 0.3311s/iter; left time: 4505.3420s
Epoch: 12 cost time: 15.129371881484985
Epoch: 12, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.977 Vali Acc: 0.119 Test Loss: 2.977 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2868348
	speed: 0.3510s/iter; left time: 4722.3879s
Epoch: 13 cost time: 14.708864212036133
Epoch: 13, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.075 Vali Acc: 0.184 Test Loss: 3.075 Test Acc: 0.184
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1698148
	speed: 0.3327s/iter; left time: 4424.4727s
Epoch: 14 cost time: 16.179003953933716
Epoch: 14, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.167 Vali Acc: 0.180 Test Loss: 3.167 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6672466
	speed: 0.3492s/iter; left time: 4590.5882s
Epoch: 15 cost time: 14.405882120132446
Epoch: 15, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.088 Vali Acc: 0.117 Test Loss: 3.088 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1820134
	speed: 0.3258s/iter; left time: 4232.5516s
Epoch: 16 cost time: 15.482625722885132
Epoch: 16, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.235 Vali Acc: 0.105 Test Loss: 3.235 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7521525
	speed: 0.3440s/iter; left time: 4415.8719s
Epoch: 17 cost time: 15.000267505645752
Epoch: 17, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.793 Vali Acc: 0.201 Test Loss: 2.793 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 593214
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8189633
	speed: 0.1426s/iter; left time: 2181.5943s
Epoch: 1 cost time: 20.775915145874023
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4434094
	speed: 0.4027s/iter; left time: 6100.4061s
Epoch: 2 cost time: 18.20633292198181
Epoch: 2, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.197 Vali Acc: 0.320 Test Loss: 2.197 Test Acc: 0.320
Validation loss decreased (-0.315064 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7828729
	speed: 0.3819s/iter; left time: 5725.8905s
Epoch: 3 cost time: 16.47342538833618
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.113 Vali Acc: 0.335 Test Loss: 2.113 Test Acc: 0.335
Validation loss decreased (-0.320335 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2541828
	speed: 0.3615s/iter; left time: 5363.7395s
Epoch: 4 cost time: 15.406575441360474
Epoch: 4, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.090 Vali Acc: 0.338 Test Loss: 2.090 Test Acc: 0.338
Validation loss decreased (-0.335340 --> -0.337773).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0247922
	speed: 0.3700s/iter; left time: 5432.9959s
Epoch: 5 cost time: 16.56274962425232
Epoch: 5, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.122 Vali Acc: 0.356 Test Loss: 2.122 Test Acc: 0.356
Validation loss decreased (-0.337773 --> -0.356021).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5979501
	speed: 0.3606s/iter; left time: 5239.5065s
Epoch: 6 cost time: 15.081399202346802
Epoch: 6, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.258 Vali Acc: 0.344 Test Loss: 2.258 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7021230
	speed: 0.3622s/iter; left time: 5207.8970s
Epoch: 7 cost time: 16.11272120475769
Epoch: 7, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.153 Vali Acc: 0.356 Test Loss: 2.153 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8552129
	speed: 0.3638s/iter; left time: 5174.9146s
Epoch: 8 cost time: 14.93311357498169
Epoch: 8, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.386 Vali Acc: 0.193 Test Loss: 2.386 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7533274
	speed: 0.3402s/iter; left time: 4786.1242s
Epoch: 9 cost time: 15.681298732757568
Epoch: 9, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.374 Vali Acc: 0.193 Test Loss: 2.374 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7456756
	speed: 0.3871s/iter; left time: 5386.9664s
Epoch: 10 cost time: 16.898680448532104
Epoch: 10, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.550 Vali Acc: 0.348 Test Loss: 2.550 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3384753
	speed: 0.3838s/iter; left time: 5281.1039s
Epoch: 11 cost time: 16.64685034751892
Epoch: 11, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.663 Vali Acc: 0.232 Test Loss: 2.663 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5048125
	speed: 0.3777s/iter; left time: 5139.1532s
Epoch: 12 cost time: 16.801469564437866
Epoch: 12, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.653 Vali Acc: 0.178 Test Loss: 2.653 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.6127601
	speed: 0.3751s/iter; left time: 5046.2312s
Epoch: 13 cost time: 15.649231195449829
Epoch: 13, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.803 Vali Acc: 0.193 Test Loss: 2.803 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6740249
	speed: 0.3691s/iter; left time: 4909.2861s
Epoch: 14 cost time: 18.184845685958862
Epoch: 14, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.697 Vali Acc: 0.200 Test Loss: 2.697 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3206443
	speed: 0.4389s/iter; left time: 5768.7940s
Epoch: 15 cost time: 19.23083806037903
Epoch: 15, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.844 Vali Acc: 0.178 Test Loss: 2.844 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3560421735604217
model parameter : 593022
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1817675
	speed: 0.1461s/iter; left time: 2236.0171s
Epoch: 1 cost time: 21.19343137741089
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.149 Vali Acc: 0.315 Test Loss: 2.149 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2211325
	speed: 0.3883s/iter; left time: 5881.7598s
Epoch: 2 cost time: 16.176979303359985
Epoch: 2, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.133 Vali Acc: 0.322 Test Loss: 2.133 Test Acc: 0.322
Validation loss decreased (-0.314658 --> -0.321958).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4846466
	speed: 0.3975s/iter; left time: 5960.3697s
Epoch: 3 cost time: 17.966151237487793
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.104 Vali Acc: 0.331 Test Loss: 2.104 Test Acc: 0.331
Validation loss decreased (-0.321958 --> -0.331285).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1203761
	speed: 0.3894s/iter; left time: 5777.9909s
Epoch: 4 cost time: 17.397956609725952
Epoch: 4, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.078 Vali Acc: 0.351 Test Loss: 2.078 Test Acc: 0.351
Validation loss decreased (-0.331285 --> -0.350750).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8182044
	speed: 0.3851s/iter; left time: 5655.2278s
Epoch: 5 cost time: 16.148168325424194
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.193 Vali Acc: 0.342 Test Loss: 2.193 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0186648
	speed: 0.3826s/iter; left time: 5559.0278s
Epoch: 6 cost time: 17.047173500061035
Epoch: 6, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.233 Vali Acc: 0.241 Test Loss: 2.233 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7234052
	speed: 0.3745s/iter; left time: 5384.7754s
Epoch: 7 cost time: 16.487930297851562
Epoch: 7, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.199 Vali Acc: 0.354 Test Loss: 2.199 Test Acc: 0.354
Validation loss decreased (-0.350750 --> -0.354398).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6575122
	speed: 0.3380s/iter; left time: 4807.3477s
Epoch: 8 cost time: 15.380360126495361
Epoch: 8, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.319 Vali Acc: 0.365 Test Loss: 2.319 Test Acc: 0.365
Validation loss decreased (-0.354398 --> -0.365346).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0620904
	speed: 0.3626s/iter; left time: 5100.9175s
Epoch: 9 cost time: 16.790000677108765
Epoch: 9, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.222 Vali Acc: 0.360 Test Loss: 2.222 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6784494
	speed: 0.3570s/iter; left time: 4967.5789s
Epoch: 10 cost time: 14.755139589309692
Epoch: 10, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.814 Vali Acc: 0.184 Test Loss: 2.814 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7291080
	speed: 0.3570s/iter; left time: 4913.1088s
Epoch: 11 cost time: 15.307767391204834
Epoch: 11, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.669 Vali Acc: 0.183 Test Loss: 2.669 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5414830
	speed: 0.3569s/iter; left time: 4856.7262s
Epoch: 12 cost time: 16.2375066280365
Epoch: 12, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.480 Vali Acc: 0.219 Test Loss: 2.480 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1611823
	speed: 0.3579s/iter; left time: 4814.2079s
Epoch: 13 cost time: 16.069162130355835
Epoch: 13, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.153 Vali Acc: 0.110 Test Loss: 3.153 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2619419
	speed: 0.3912s/iter; left time: 5202.1807s
Epoch: 14 cost time: 16.70709776878357
Epoch: 14, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.629 Vali Acc: 0.371 Test Loss: 2.629 Test Acc: 0.371
Validation loss decreased (-0.365346 --> -0.371425).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4859186
	speed: 0.3764s/iter; left time: 4947.7235s
Epoch: 15 cost time: 17.472715377807617
Epoch: 15, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.712 Vali Acc: 0.364 Test Loss: 2.712 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2604889
	speed: 0.3875s/iter; left time: 5034.0582s
Epoch: 16 cost time: 16.443265199661255
Epoch: 16, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.691 Vali Acc: 0.200 Test Loss: 2.691 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.0527240
	speed: 0.3707s/iter; left time: 4759.1980s
Epoch: 17 cost time: 15.07434868812561
Epoch: 17, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.838 Vali Acc: 0.197 Test Loss: 2.838 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.5303965
	speed: 0.3655s/iter; left time: 4635.8743s
Epoch: 18 cost time: 16.53334951400757
Epoch: 18, Steps: 154 | Train Loss: 1.435 Vali Loss: 3.104 Vali Acc: 0.113 Test Loss: 3.104 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.4829992
	speed: 0.3868s/iter; left time: 4846.5724s
Epoch: 19 cost time: 17.325437784194946
Epoch: 19, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.288 Vali Acc: 0.386 Test Loss: 2.288 Test Acc: 0.386
Validation loss decreased (-0.371425 --> -0.386027).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6209538
	speed: 0.3626s/iter; left time: 4487.7016s
Epoch: 20 cost time: 15.345141887664795
Epoch: 20, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.878 Vali Acc: 0.133 Test Loss: 2.878 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6347768
	speed: 0.3841s/iter; left time: 4694.4957s
Epoch: 21 cost time: 16.5648090839386
Epoch: 21, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.546 Vali Acc: 0.374 Test Loss: 2.546 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0445600
	speed: 0.3307s/iter; left time: 3990.1671s
Epoch: 22 cost time: 14.561457872390747
Epoch: 22, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.453 Vali Acc: 0.376 Test Loss: 2.453 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.2577138
	speed: 0.3616s/iter; left time: 4307.2643s
Epoch: 23 cost time: 16.30060052871704
Epoch: 23, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.840 Vali Acc: 0.110 Test Loss: 2.840 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.5205548
	speed: 0.3637s/iter; left time: 4276.9904s
Epoch: 24 cost time: 15.958256483078003
Epoch: 24, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.929 Vali Acc: 0.117 Test Loss: 2.929 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1666729
	speed: 0.3684s/iter; left time: 4275.7861s
Epoch: 25 cost time: 16.49223232269287
Epoch: 25, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.785 Vali Acc: 0.069 Test Loss: 2.785 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.3458383
	speed: 0.3674s/iter; left time: 4207.1747s
Epoch: 26 cost time: 16.469109058380127
Epoch: 26, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.814 Vali Acc: 0.086 Test Loss: 2.814 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1810274
	speed: 0.3719s/iter; left time: 4201.4027s
Epoch: 27 cost time: 14.764134883880615
Epoch: 27, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.011 Vali Acc: 0.178 Test Loss: 3.011 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.4048964
	speed: 0.3986s/iter; left time: 4441.1102s
Epoch: 28 cost time: 18.275638580322266
Epoch: 28, Steps: 154 | Train Loss: 1.313 Vali Loss: 2.806 Vali Acc: 0.183 Test Loss: 2.806 Test Acc: 0.183
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.2491785
	speed: 0.3777s/iter; left time: 4150.9685s
Epoch: 29 cost time: 16.708937406539917
Epoch: 29, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.848 Vali Acc: 0.195 Test Loss: 2.848 Test Acc: 0.195
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 592830
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0060263
	speed: 0.1066s/iter; left time: 1631.4672s
Epoch: 1 cost time: 14.854233026504517
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8281986
	speed: 0.3110s/iter; left time: 4710.0441s
Epoch: 2 cost time: 13.750320672988892
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.139 Vali Acc: 0.320 Test Loss: 2.139 Test Acc: 0.320
Validation loss decreased (-0.315063 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0540600
	speed: 0.3252s/iter; left time: 4875.0590s
Epoch: 3 cost time: 14.495965719223022
Epoch: 3, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.117 Vali Acc: 0.324 Test Loss: 2.117 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4590008
	speed: 0.3195s/iter; left time: 4741.3141s
Epoch: 4 cost time: 13.744847536087036
Epoch: 4, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.067 Vali Acc: 0.345 Test Loss: 2.067 Test Acc: 0.345
Validation loss decreased (-0.324391 --> -0.344667).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1874583
	speed: 0.3153s/iter; left time: 4630.7447s
Epoch: 5 cost time: 13.581796169281006
Epoch: 5, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.146 Vali Acc: 0.337 Test Loss: 2.146 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7136351
	speed: 0.3206s/iter; left time: 4658.5334s
Epoch: 6 cost time: 14.365219593048096
Epoch: 6, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.126 Vali Acc: 0.344 Test Loss: 2.126 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9903158
	speed: 0.3186s/iter; left time: 4580.6263s
Epoch: 7 cost time: 14.314768314361572
Epoch: 7, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.206 Vali Acc: 0.359 Test Loss: 2.206 Test Acc: 0.359
Validation loss decreased (-0.344667 --> -0.359264).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0020227
	speed: 0.3361s/iter; left time: 4780.2206s
Epoch: 8 cost time: 14.308696269989014
Epoch: 8, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.352 Vali Acc: 0.345 Test Loss: 2.352 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7538880
	speed: 0.3420s/iter; left time: 4811.2219s
Epoch: 9 cost time: 15.174865245819092
Epoch: 9, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.262 Vali Acc: 0.197 Test Loss: 2.262 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4447275
	speed: 0.3175s/iter; left time: 4417.5156s
Epoch: 10 cost time: 13.532708644866943
Epoch: 10, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.431 Vali Acc: 0.197 Test Loss: 2.431 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9342523
	speed: 0.3139s/iter; left time: 4319.0806s
Epoch: 11 cost time: 13.406882047653198
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.602 Vali Acc: 0.348 Test Loss: 2.602 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2018471
	speed: 0.2980s/iter; left time: 4055.5023s
Epoch: 12 cost time: 13.623053312301636
Epoch: 12, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.671 Vali Acc: 0.355 Test Loss: 2.671 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5789001
	speed: 0.3274s/iter; left time: 4404.3029s
Epoch: 13 cost time: 14.855536937713623
Epoch: 13, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.566 Vali Acc: 0.355 Test Loss: 2.566 Test Acc: 0.355
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3840517
	speed: 0.3630s/iter; left time: 4827.2082s
Epoch: 14 cost time: 15.969108581542969
Epoch: 14, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.126 Vali Acc: 0.181 Test Loss: 3.126 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.9248343
	speed: 0.3530s/iter; left time: 4640.6313s
Epoch: 15 cost time: 15.889894247055054
Epoch: 15, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.615 Vali Acc: 0.270 Test Loss: 2.615 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0675582
	speed: 0.3660s/iter; left time: 4755.0409s
Epoch: 16 cost time: 15.645327091217041
Epoch: 16, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.863 Vali Acc: 0.171 Test Loss: 2.863 Test Acc: 0.171
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.4279174
	speed: 0.3334s/iter; left time: 4279.7224s
Epoch: 17 cost time: 14.893182277679443
Epoch: 17, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.697 Vali Acc: 0.306 Test Loss: 2.697 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35928629359286296
model parameter : 592638
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2888541
	speed: 0.1370s/iter; left time: 2096.8812s
Epoch: 1 cost time: 19.507017374038696
Epoch: 1, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1600811
	speed: 0.3805s/iter; left time: 5763.3231s
Epoch: 2 cost time: 17.462712049484253
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0701327
	speed: 0.3472s/iter; left time: 5205.7656s
Epoch: 3 cost time: 16.016298055648804
Epoch: 3, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.138 Vali Acc: 0.320 Test Loss: 2.138 Test Acc: 0.320
Validation loss decreased (-0.315064 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2197926
	speed: 0.3575s/iter; left time: 5304.6202s
Epoch: 4 cost time: 15.788100719451904
Epoch: 4, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.118 Vali Acc: 0.331 Test Loss: 2.118 Test Acc: 0.331
Validation loss decreased (-0.319524 --> -0.330879).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8002093
	speed: 0.3560s/iter; left time: 5228.3814s
Epoch: 5 cost time: 14.809778928756714
Epoch: 5, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.282 Vali Acc: 0.182 Test Loss: 2.282 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9467080
	speed: 0.3493s/iter; left time: 5074.9657s
Epoch: 6 cost time: 15.84860372543335
Epoch: 6, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.173 Vali Acc: 0.182 Test Loss: 2.173 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0984228
	speed: 0.3751s/iter; left time: 5392.3165s
Epoch: 7 cost time: 16.281780242919922
Epoch: 7, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.217 Vali Acc: 0.341 Test Loss: 2.217 Test Acc: 0.341
Validation loss decreased (-0.330879 --> -0.341421).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1563761
	speed: 0.3719s/iter; left time: 5289.1628s
Epoch: 8 cost time: 16.179786682128906
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.775 Vali Acc: 0.123 Test Loss: 2.775 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7898180
	speed: 0.3952s/iter; left time: 5559.8792s
Epoch: 9 cost time: 17.61023449897766
Epoch: 9, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.446 Vali Acc: 0.195 Test Loss: 2.446 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8007193
	speed: 0.3750s/iter; left time: 5217.6485s
Epoch: 10 cost time: 15.747401237487793
Epoch: 10, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.480 Vali Acc: 0.192 Test Loss: 2.480 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1848438
	speed: 0.3753s/iter; left time: 5165.0377s
Epoch: 11 cost time: 17.019213914871216
Epoch: 11, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.673 Vali Acc: 0.382 Test Loss: 2.673 Test Acc: 0.382
Validation loss decreased (-0.341421 --> -0.381563).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3173440
	speed: 0.4154s/iter; left time: 5651.8631s
Epoch: 12 cost time: 19.243669986724854
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.668 Vali Acc: 0.352 Test Loss: 2.668 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9887735
	speed: 0.4010s/iter; left time: 5394.5421s
Epoch: 13 cost time: 20.170497179031372
Epoch: 13, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.704 Vali Acc: 0.198 Test Loss: 2.704 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3573343
	speed: 0.3969s/iter; left time: 5279.0095s
Epoch: 14 cost time: 18.054372787475586
Epoch: 14, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.099 Vali Acc: 0.170 Test Loss: 3.099 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.9249814
	speed: 0.3573s/iter; left time: 4696.8220s
Epoch: 15 cost time: 15.791311264038086
Epoch: 15, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.981 Vali Acc: 0.190 Test Loss: 2.981 Test Acc: 0.190
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3272735
	speed: 0.3661s/iter; left time: 4756.4394s
Epoch: 16 cost time: 14.231078624725342
Epoch: 16, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.967 Vali Acc: 0.118 Test Loss: 2.967 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.4362406
	speed: 0.3578s/iter; left time: 4593.2845s
Epoch: 17 cost time: 17.17349886894226
Epoch: 17, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.035 Vali Acc: 0.125 Test Loss: 3.035 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4246079
	speed: 0.3940s/iter; left time: 4997.1723s
Epoch: 18 cost time: 17.642715215682983
Epoch: 18, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.786 Vali Acc: 0.228 Test Loss: 2.786 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.7587600
	speed: 0.3906s/iter; left time: 4894.0915s
Epoch: 19 cost time: 16.61239194869995
Epoch: 19, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.564 Vali Acc: 0.136 Test Loss: 2.564 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.8256333
	speed: 0.4064s/iter; left time: 5028.8322s
Epoch: 20 cost time: 19.54837441444397
Epoch: 20, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.287 Vali Acc: 0.121 Test Loss: 3.287 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1590436
	speed: 0.4013s/iter; left time: 4904.5949s
Epoch: 21 cost time: 16.12107491493225
Epoch: 21, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.295 Vali Acc: 0.120 Test Loss: 3.295 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3815896188158962
model parameter : 360254
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1328743
	speed: 0.1209s/iter; left time: 1849.8805s
Epoch: 1 cost time: 17.64262890815735
Epoch: 1, Steps: 154 | Train Loss: 2.288 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6841272
	speed: 0.3484s/iter; left time: 5276.9671s
Epoch: 2 cost time: 15.059431552886963
Epoch: 2, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.141 Vali Acc: 0.315 Test Loss: 2.141 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1293130
	speed: 0.3695s/iter; left time: 5540.3902s
Epoch: 3 cost time: 15.729640483856201
Epoch: 3, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.149 Vali Acc: 0.320 Test Loss: 2.149 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4464207
	speed: 0.3546s/iter; left time: 5261.8788s
Epoch: 4 cost time: 16.02228045463562
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.043 Vali Acc: 0.337 Test Loss: 2.043 Test Acc: 0.337
Validation loss decreased (-0.319524 --> -0.336963).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5022252
	speed: 0.3474s/iter; left time: 5101.1252s
Epoch: 5 cost time: 15.754109382629395
Epoch: 5, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.128 Vali Acc: 0.342 Test Loss: 2.128 Test Acc: 0.342
Validation loss decreased (-0.336963 --> -0.341828).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0068610
	speed: 0.3717s/iter; left time: 5401.5314s
Epoch: 6 cost time: 16.38217258453369
Epoch: 6, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.045 Vali Acc: 0.353 Test Loss: 2.045 Test Acc: 0.353
Validation loss decreased (-0.341828 --> -0.353183).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7299298
	speed: 0.3577s/iter; left time: 5142.0853s
Epoch: 7 cost time: 15.851379156112671
Epoch: 7, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.057 Vali Acc: 0.352 Test Loss: 2.057 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6042501
	speed: 0.3316s/iter; left time: 4716.2146s
Epoch: 8 cost time: 14.61668872833252
Epoch: 8, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.266 Vali Acc: 0.368 Test Loss: 2.266 Test Acc: 0.368
Validation loss decreased (-0.353183 --> -0.368185).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0278361
	speed: 0.3286s/iter; left time: 4623.2856s
Epoch: 9 cost time: 14.076473712921143
Epoch: 9, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.261 Vali Acc: 0.364 Test Loss: 2.261 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5872042
	speed: 0.3359s/iter; left time: 4673.5521s
Epoch: 10 cost time: 15.303048849105835
Epoch: 10, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.989 Vali Acc: 0.107 Test Loss: 2.989 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7265882
	speed: 0.3492s/iter; left time: 4805.9062s
Epoch: 11 cost time: 14.921972274780273
Epoch: 11, Steps: 154 | Train Loss: 1.536 Vali Loss: 3.004 Vali Acc: 0.105 Test Loss: 3.004 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1081278
	speed: 0.3375s/iter; left time: 4593.0219s
Epoch: 12 cost time: 14.975825548171997
Epoch: 12, Steps: 154 | Train Loss: 1.531 Vali Loss: 3.028 Vali Acc: 0.109 Test Loss: 3.028 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6127026
	speed: 0.3302s/iter; left time: 4442.4892s
Epoch: 13 cost time: 15.7577805519104
Epoch: 13, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.039 Vali Acc: 0.176 Test Loss: 3.039 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5298661
	speed: 0.3685s/iter; left time: 4901.0866s
Epoch: 14 cost time: 17.046895265579224
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.063 Vali Acc: 0.103 Test Loss: 3.063 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.8734899
	speed: 0.3569s/iter; left time: 4690.9714s
Epoch: 15 cost time: 16.517271995544434
Epoch: 15, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.231 Vali Acc: 0.104 Test Loss: 3.231 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.6060429
	speed: 0.3550s/iter; left time: 4611.1598s
Epoch: 16 cost time: 15.603575468063354
Epoch: 16, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.246 Vali Acc: 0.116 Test Loss: 3.246 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3651359
	speed: 0.3602s/iter; left time: 4623.9890s
Epoch: 17 cost time: 15.915876388549805
Epoch: 17, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.070 Vali Acc: 0.176 Test Loss: 3.070 Test Acc: 0.176
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.9265660
	speed: 0.3485s/iter; left time: 4419.6331s
Epoch: 18 cost time: 16.332398891448975
Epoch: 18, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.742 Vali Acc: 0.372 Test Loss: 2.742 Test Acc: 0.372
Validation loss decreased (-0.368185 --> -0.372235).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6432908
	speed: 0.3447s/iter; left time: 4318.6626s
Epoch: 19 cost time: 14.459139347076416
Epoch: 19, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.269 Vali Acc: 0.112 Test Loss: 3.269 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3961029
	speed: 0.3379s/iter; left time: 4181.1784s
Epoch: 20 cost time: 15.256322145462036
Epoch: 20, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.111 Vali Acc: 0.116 Test Loss: 3.111 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0700637
	speed: 0.3441s/iter; left time: 4204.9642s
Epoch: 21 cost time: 14.82993483543396
Epoch: 21, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.706 Vali Acc: 0.131 Test Loss: 2.706 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1639663
	speed: 0.3381s/iter; left time: 4079.8085s
Epoch: 22 cost time: 15.467311143875122
Epoch: 22, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.903 Vali Acc: 0.160 Test Loss: 2.903 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.4444001
	speed: 0.3427s/iter; left time: 4082.5489s
Epoch: 23 cost time: 15.11063265800476
Epoch: 23, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.415 Vali Acc: 0.341 Test Loss: 2.415 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3747709
	speed: 0.3305s/iter; left time: 3886.6961s
Epoch: 24 cost time: 15.246472358703613
Epoch: 24, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.310 Vali Acc: 0.083 Test Loss: 3.310 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.5915095
	speed: 0.3355s/iter; left time: 3893.0426s
Epoch: 25 cost time: 14.440321683883667
Epoch: 25, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.219 Vali Acc: 0.117 Test Loss: 3.219 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.3930477
	speed: 0.3346s/iter; left time: 3831.0400s
Epoch: 26 cost time: 14.118651151657104
Epoch: 26, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.380 Vali Acc: 0.120 Test Loss: 3.380 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.7875269
	speed: 0.3477s/iter; left time: 3927.6847s
Epoch: 27 cost time: 16.053009748458862
Epoch: 27, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.726 Vali Acc: 0.158 Test Loss: 2.726 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.9186076
	speed: 0.3488s/iter; left time: 3886.2264s
Epoch: 28 cost time: 15.815837144851685
Epoch: 28, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.918 Vali Acc: 0.133 Test Loss: 2.918 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 360062
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1303301
	speed: 0.1447s/iter; left time: 2214.2813s
Epoch: 1 cost time: 20.49929118156433
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.181 Vali Acc: 0.155 Test Loss: 2.181 Test Acc: 0.155
Validation loss decreased (inf --> -0.155290).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9755820
	speed: 0.4202s/iter; left time: 6365.0657s
Epoch: 2 cost time: 18.173733949661255
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.140 Vali Acc: 0.318 Test Loss: 2.140 Test Acc: 0.318
Validation loss decreased (-0.155290 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8309218
	speed: 0.4124s/iter; left time: 6182.8504s
Epoch: 3 cost time: 17.55633020401001
Epoch: 3, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.156 Vali Acc: 0.323 Test Loss: 2.156 Test Acc: 0.323
Validation loss decreased (-0.318308 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9385208
	speed: 0.4185s/iter; left time: 6210.2710s
Epoch: 4 cost time: 18.321488857269287
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.110 Vali Acc: 0.331 Test Loss: 2.110 Test Acc: 0.331
Validation loss decreased (-0.322768 --> -0.330879).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9216799
	speed: 0.3890s/iter; left time: 5712.4615s
Epoch: 5 cost time: 15.495157957077026
Epoch: 5, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.121 Vali Acc: 0.348 Test Loss: 2.121 Test Acc: 0.348
Validation loss decreased (-0.330879 --> -0.348316).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6588326
	speed: 0.3601s/iter; left time: 5232.4298s
Epoch: 6 cost time: 16.575433015823364
Epoch: 6, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.180 Vali Acc: 0.193 Test Loss: 2.180 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5167292
	speed: 0.3808s/iter; left time: 5474.8921s
Epoch: 7 cost time: 17.6957790851593
Epoch: 7, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.283 Vali Acc: 0.187 Test Loss: 2.283 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3325253
	speed: 0.3893s/iter; left time: 5536.8246s
Epoch: 8 cost time: 17.603243350982666
Epoch: 8, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.113 Vali Acc: 0.366 Test Loss: 2.113 Test Acc: 0.366
Validation loss decreased (-0.348316 --> -0.366159).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3807052
	speed: 0.4026s/iter; left time: 5663.5731s
Epoch: 9 cost time: 17.982240676879883
Epoch: 9, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.366 Vali Acc: 0.197 Test Loss: 2.366 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5822285
	speed: 0.3875s/iter; left time: 5391.9075s
Epoch: 10 cost time: 16.201634645462036
Epoch: 10, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.656 Vali Acc: 0.178 Test Loss: 2.656 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7948161
	speed: 0.3650s/iter; left time: 5022.7202s
Epoch: 11 cost time: 17.142688035964966
Epoch: 11, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.943 Vali Acc: 0.113 Test Loss: 2.943 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0757821
	speed: 0.3938s/iter; left time: 5357.9949s
Epoch: 12 cost time: 17.68181037902832
Epoch: 12, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.858 Vali Acc: 0.139 Test Loss: 2.858 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5180409
	speed: 0.3983s/iter; left time: 5358.7108s
Epoch: 13 cost time: 17.58049178123474
Epoch: 13, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.495 Vali Acc: 0.368 Test Loss: 2.495 Test Acc: 0.368
Validation loss decreased (-0.366159 --> -0.367777).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4009272
	speed: 0.4067s/iter; left time: 5408.4356s
Epoch: 14 cost time: 16.83112907409668
Epoch: 14, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.376 Vali Acc: 0.097 Test Loss: 3.376 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2709153
	speed: 0.4054s/iter; left time: 5329.0833s
Epoch: 15 cost time: 17.838315963745117
Epoch: 15, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.988 Vali Acc: 0.175 Test Loss: 2.988 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.7050285
	speed: 0.4065s/iter; left time: 5281.3250s
Epoch: 16 cost time: 18.939796924591064
Epoch: 16, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.171 Vali Acc: 0.107 Test Loss: 3.171 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.6222775
	speed: 0.3987s/iter; left time: 5118.5461s
Epoch: 17 cost time: 16.836318254470825
Epoch: 17, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.770 Vali Acc: 0.156 Test Loss: 2.770 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5861487
	speed: 0.4011s/iter; left time: 5087.1609s
Epoch: 18 cost time: 18.672001600265503
Epoch: 18, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.713 Vali Acc: 0.379 Test Loss: 2.713 Test Acc: 0.379
Validation loss decreased (-0.367777 --> -0.378724).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1834829
	speed: 0.3900s/iter; left time: 4886.2123s
Epoch: 19 cost time: 18.137903928756714
Epoch: 19, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.722 Vali Acc: 0.212 Test Loss: 2.722 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6848797
	speed: 0.3993s/iter; left time: 4941.5203s
Epoch: 20 cost time: 18.05926823616028
Epoch: 20, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.138 Vali Acc: 0.118 Test Loss: 3.138 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.6004001
	speed: 0.4030s/iter; left time: 4925.6297s
Epoch: 21 cost time: 18.110694885253906
Epoch: 21, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.939 Vali Acc: 0.128 Test Loss: 2.939 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7500630
	speed: 0.3923s/iter; left time: 4734.3863s
Epoch: 22 cost time: 17.328362941741943
Epoch: 22, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.988 Vali Acc: 0.127 Test Loss: 2.988 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2858129
	speed: 0.3709s/iter; left time: 4419.0855s
Epoch: 23 cost time: 16.335771083831787
Epoch: 23, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.363 Vali Acc: 0.113 Test Loss: 3.363 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.8377284
	speed: 0.3941s/iter; left time: 4633.9965s
Epoch: 24 cost time: 17.645484685897827
Epoch: 24, Steps: 154 | Train Loss: 1.342 Vali Loss: 3.325 Vali Acc: 0.112 Test Loss: 3.325 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.4521925
	speed: 0.3744s/iter; left time: 4344.8437s
Epoch: 25 cost time: 16.381808042526245
Epoch: 25, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.038 Vali Acc: 0.120 Test Loss: 3.038 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.1636945
	speed: 0.3849s/iter; left time: 4407.0608s
Epoch: 26 cost time: 17.084856271743774
Epoch: 26, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.458 Vali Acc: 0.118 Test Loss: 3.458 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.2605780
	speed: 0.3807s/iter; left time: 4300.9992s
Epoch: 27 cost time: 16.442301988601685
Epoch: 27, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.221 Vali Acc: 0.118 Test Loss: 3.221 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.0156705
	speed: 0.4125s/iter; left time: 4596.8309s
Epoch: 28 cost time: 17.360403776168823
Epoch: 28, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.545 Vali Acc: 0.123 Test Loss: 3.545 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 359870
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1403284
	speed: 0.1416s/iter; left time: 2166.0601s
Epoch: 1 cost time: 20.15516185760498
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.147 Vali Acc: 0.315 Test Loss: 2.147 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9708148
	speed: 0.4027s/iter; left time: 6100.1351s
Epoch: 2 cost time: 19.340075969696045
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0601134
	speed: 0.3957s/iter; left time: 5933.1514s
Epoch: 3 cost time: 16.32877779006958
Epoch: 3, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.112 Vali Acc: 0.330 Test Loss: 2.112 Test Acc: 0.330
Validation loss decreased (-0.315469 --> -0.330068).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8253642
	speed: 0.3918s/iter; left time: 5814.4992s
Epoch: 4 cost time: 18.549874544143677
Epoch: 4, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.149 Vali Acc: 0.334 Test Loss: 2.149 Test Acc: 0.334
Validation loss decreased (-0.330068 --> -0.334123).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6608335
	speed: 0.4001s/iter; left time: 5875.0775s
Epoch: 5 cost time: 18.02887797355652
Epoch: 5, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.087 Vali Acc: 0.360 Test Loss: 2.087 Test Acc: 0.360
Validation loss decreased (-0.334123 --> -0.360076).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7419326
	speed: 0.3842s/iter; left time: 5582.4771s
Epoch: 6 cost time: 17.040078163146973
Epoch: 6, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.183 Vali Acc: 0.353 Test Loss: 2.183 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8305424
	speed: 0.3765s/iter; left time: 5413.3790s
Epoch: 7 cost time: 17.19133186340332
Epoch: 7, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.379 Vali Acc: 0.176 Test Loss: 2.379 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5068403
	speed: 0.3827s/iter; left time: 5443.6385s
Epoch: 8 cost time: 16.13604235649109
Epoch: 8, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.701 Vali Acc: 0.107 Test Loss: 2.701 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4920074
	speed: 0.3735s/iter; left time: 5255.1945s
Epoch: 9 cost time: 17.536908864974976
Epoch: 9, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.535 Vali Acc: 0.131 Test Loss: 2.535 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4098048
	speed: 0.3960s/iter; left time: 5510.6577s
Epoch: 10 cost time: 17.749876260757446
Epoch: 10, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.673 Vali Acc: 0.109 Test Loss: 2.673 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.9481065
	speed: 0.4040s/iter; left time: 5559.3824s
Epoch: 11 cost time: 17.73479199409485
Epoch: 11, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.946 Vali Acc: 0.103 Test Loss: 2.946 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3829162
	speed: 0.4085s/iter; left time: 5558.7796s
Epoch: 12 cost time: 16.357556581497192
Epoch: 12, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.903 Vali Acc: 0.183 Test Loss: 2.903 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.9524041
	speed: 0.4170s/iter; left time: 5610.1738s
Epoch: 13 cost time: 19.1184139251709
Epoch: 13, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.707 Vali Acc: 0.352 Test Loss: 2.707 Test Acc: 0.352
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6179445
	speed: 0.4233s/iter; left time: 5630.0284s
Epoch: 14 cost time: 18.781583547592163
Epoch: 14, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.975 Vali Acc: 0.138 Test Loss: 2.975 Test Acc: 0.138
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.9118738
	speed: 0.4060s/iter; left time: 5337.0509s
Epoch: 15 cost time: 16.785506010055542
Epoch: 15, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.159 Vali Acc: 0.124 Test Loss: 3.159 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 359678
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1700654
	speed: 0.1427s/iter; left time: 2183.4598s
Epoch: 1 cost time: 20.4562406539917
Epoch: 1, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.199 Vali Acc: 0.315 Test Loss: 2.199 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1261296
	speed: 0.3840s/iter; left time: 5816.7683s
Epoch: 2 cost time: 16.033753156661987
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.192 Vali Acc: 0.315 Test Loss: 2.192 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8751802
	speed: 0.4215s/iter; left time: 6319.6078s
Epoch: 3 cost time: 17.935152053833008
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.173 Vali Acc: 0.319 Test Loss: 2.173 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1684282
	speed: 0.4237s/iter; left time: 6287.6888s
Epoch: 4 cost time: 18.689298629760742
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.101 Vali Acc: 0.337 Test Loss: 2.101 Test Acc: 0.337
Validation loss decreased (-0.319119 --> -0.336962).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1570110
	speed: 0.3640s/iter; left time: 5345.8663s
Epoch: 5 cost time: 15.616056203842163
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.098 Vali Acc: 0.350 Test Loss: 2.098 Test Acc: 0.350
Validation loss decreased (-0.336962 --> -0.349938).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6770959
	speed: 0.3640s/iter; left time: 5288.6788s
Epoch: 6 cost time: 15.787253856658936
Epoch: 6, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.212 Vali Acc: 0.340 Test Loss: 2.212 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4821786
	speed: 0.3883s/iter; left time: 5582.2334s
Epoch: 7 cost time: 15.909163475036621
Epoch: 7, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.208 Vali Acc: 0.341 Test Loss: 2.208 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5086910
	speed: 0.3965s/iter; left time: 5639.1371s
Epoch: 8 cost time: 18.11794424057007
Epoch: 8, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.736 Vali Acc: 0.100 Test Loss: 2.736 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0814641
	speed: 0.4445s/iter; left time: 6253.6329s
Epoch: 9 cost time: 20.373554944992065
Epoch: 9, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.516 Vali Acc: 0.183 Test Loss: 2.516 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7394111
	speed: 0.4471s/iter; left time: 6221.0311s
Epoch: 10 cost time: 19.794058084487915
Epoch: 10, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.538 Vali Acc: 0.187 Test Loss: 2.538 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5524468
	speed: 0.4662s/iter; left time: 6414.8590s
Epoch: 11 cost time: 20.5270938873291
Epoch: 11, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.926 Vali Acc: 0.181 Test Loss: 2.926 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.2444328
	speed: 0.4459s/iter; left time: 6067.3928s
Epoch: 12 cost time: 20.536223888397217
Epoch: 12, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.827 Vali Acc: 0.176 Test Loss: 2.827 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2246456
	speed: 0.4632s/iter; left time: 6231.8500s
Epoch: 13 cost time: 19.954418897628784
Epoch: 13, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.535 Vali Acc: 0.209 Test Loss: 2.535 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.4755065
	speed: 0.4563s/iter; left time: 6067.8514s
Epoch: 14 cost time: 20.11297917366028
Epoch: 14, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.971 Vali Acc: 0.071 Test Loss: 2.971 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3952335
	speed: 0.4044s/iter; left time: 5316.2797s
Epoch: 15 cost time: 16.27016019821167
Epoch: 15, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.749 Vali Acc: 0.278 Test Loss: 2.749 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3499594484995945
model parameter : 243774
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7879440
	speed: 0.1370s/iter; left time: 2095.7668s
Epoch: 1 cost time: 19.479514598846436
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.237 Vali Acc: 0.315 Test Loss: 2.237 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1976349
	speed: 0.4026s/iter; left time: 6097.8382s
Epoch: 2 cost time: 18.057931900024414
Epoch: 2, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.140 Vali Acc: 0.316 Test Loss: 2.140 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0733824
	speed: 0.4134s/iter; left time: 6198.1997s
Epoch: 3 cost time: 17.76864743232727
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.081 Vali Acc: 0.333 Test Loss: 2.081 Test Acc: 0.333
Validation loss decreased (-0.315875 --> -0.332907).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6837168
	speed: 0.4094s/iter; left time: 6074.4266s
Epoch: 4 cost time: 17.61888813972473
Epoch: 4, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.118 Vali Acc: 0.335 Test Loss: 2.118 Test Acc: 0.335
Validation loss decreased (-0.332907 --> -0.334529).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5457582
	speed: 0.3866s/iter; left time: 5677.8084s
Epoch: 5 cost time: 18.26685643196106
Epoch: 5, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.260 Vali Acc: 0.170 Test Loss: 2.260 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8138125
	speed: 0.4156s/iter; left time: 6039.5670s
Epoch: 6 cost time: 19.18453288078308
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.034 Vali Acc: 0.352 Test Loss: 2.034 Test Acc: 0.352
Validation loss decreased (-0.334529 --> -0.351561).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6878654
	speed: 0.4700s/iter; left time: 6757.8875s
Epoch: 7 cost time: 20.96888017654419
Epoch: 7, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.273 Vali Acc: 0.361 Test Loss: 2.273 Test Acc: 0.361
Validation loss decreased (-0.351561 --> -0.361291).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8536230
	speed: 0.4544s/iter; left time: 6462.7904s
Epoch: 8 cost time: 18.753968954086304
Epoch: 8, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.499 Vali Acc: 0.189 Test Loss: 2.499 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5465415
	speed: 0.4284s/iter; left time: 6026.8950s
Epoch: 9 cost time: 19.56501269340515
Epoch: 9, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.574 Vali Acc: 0.181 Test Loss: 2.574 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4465146
	speed: 0.4241s/iter; left time: 5901.0369s
Epoch: 10 cost time: 19.246503591537476
Epoch: 10, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.681 Vali Acc: 0.145 Test Loss: 2.681 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2987114
	speed: 0.4446s/iter; left time: 6118.1748s
Epoch: 11 cost time: 18.933188676834106
Epoch: 11, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.952 Vali Acc: 0.120 Test Loss: 2.952 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6210129
	speed: 0.4119s/iter; left time: 5605.2852s
Epoch: 12 cost time: 16.2803373336792
Epoch: 12, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.258 Vali Acc: 0.092 Test Loss: 3.258 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.6763759
	speed: 0.4032s/iter; left time: 5424.8913s
Epoch: 13 cost time: 18.2780921459198
Epoch: 13, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.203 Vali Acc: 0.099 Test Loss: 3.203 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3090776
	speed: 0.4167s/iter; left time: 5542.1420s
Epoch: 14 cost time: 16.27067995071411
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.134 Vali Acc: 0.101 Test Loss: 3.134 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0789886
	speed: 0.4262s/iter; left time: 5602.3605s
Epoch: 15 cost time: 18.496909856796265
Epoch: 15, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.318 Vali Acc: 0.117 Test Loss: 3.318 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4029043
	speed: 0.4196s/iter; left time: 5450.5356s
Epoch: 16 cost time: 20.15636682510376
Epoch: 16, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.313 Vali Acc: 0.067 Test Loss: 3.313 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.8475270
	speed: 0.4181s/iter; left time: 5367.4521s
Epoch: 17 cost time: 17.294612884521484
Epoch: 17, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.254 Vali Acc: 0.118 Test Loss: 3.254 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3613138686131387
model parameter : 243582
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4751503
	speed: 0.1402s/iter; left time: 2145.3997s
Epoch: 1 cost time: 19.60922932624817
Epoch: 1, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1434829
	speed: 0.4001s/iter; left time: 6060.8057s
Epoch: 2 cost time: 18.44338083267212
Epoch: 2, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.157 Vali Acc: 0.321 Test Loss: 2.157 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9214871
	speed: 0.4006s/iter; left time: 6005.7764s
Epoch: 3 cost time: 16.994216680526733
Epoch: 3, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.114 Vali Acc: 0.322 Test Loss: 2.114 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9838399
	speed: 0.4174s/iter; left time: 6194.4658s
Epoch: 4 cost time: 18.289549827575684
Epoch: 4, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.076 Vali Acc: 0.334 Test Loss: 2.076 Test Acc: 0.334
Validation loss decreased (-0.322363 --> -0.333718).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0864270
	speed: 0.4237s/iter; left time: 6221.3644s
Epoch: 5 cost time: 18.65976119041443
Epoch: 5, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.157 Vali Acc: 0.350 Test Loss: 2.157 Test Acc: 0.350
Validation loss decreased (-0.333718 --> -0.349938).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5269866
	speed: 0.4380s/iter; left time: 6364.8025s
Epoch: 6 cost time: 17.92251443862915
Epoch: 6, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.410 Vali Acc: 0.100 Test Loss: 2.410 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6322846
	speed: 0.4107s/iter; left time: 5905.2576s
Epoch: 7 cost time: 17.322532892227173
Epoch: 7, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.153 Vali Acc: 0.214 Test Loss: 2.153 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1118140
	speed: 0.3949s/iter; left time: 5617.2171s
Epoch: 8 cost time: 16.42009711265564
Epoch: 8, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.562 Vali Acc: 0.176 Test Loss: 2.562 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.9115884
	speed: 0.3902s/iter; left time: 5489.1039s
Epoch: 9 cost time: 18.056472778320312
Epoch: 9, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.685 Vali Acc: 0.180 Test Loss: 2.685 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.0944324
	speed: 0.3901s/iter; left time: 5428.0270s
Epoch: 10 cost time: 18.23537254333496
Epoch: 10, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.557 Vali Acc: 0.190 Test Loss: 2.557 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.0836499
	speed: 0.4339s/iter; left time: 5970.6354s
Epoch: 11 cost time: 18.086077213287354
Epoch: 11, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.946 Vali Acc: 0.104 Test Loss: 2.946 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.8235563
	speed: 0.3881s/iter; left time: 5281.2497s
Epoch: 12 cost time: 16.48269486427307
Epoch: 12, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.079 Vali Acc: 0.097 Test Loss: 3.079 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5494496
	speed: 0.3979s/iter; left time: 5353.6149s
Epoch: 13 cost time: 18.406760692596436
Epoch: 13, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.868 Vali Acc: 0.195 Test Loss: 2.868 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3806101
	speed: 0.3962s/iter; left time: 5268.5957s
Epoch: 14 cost time: 18.77382779121399
Epoch: 14, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.802 Vali Acc: 0.362 Test Loss: 2.802 Test Acc: 0.362
Validation loss decreased (-0.349938 --> -0.362097).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4590472
	speed: 0.3905s/iter; left time: 5133.3317s
Epoch: 15 cost time: 17.898316860198975
Epoch: 15, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.842 Vali Acc: 0.359 Test Loss: 2.842 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0184047
	speed: 0.4440s/iter; left time: 5767.9806s
Epoch: 16 cost time: 20.217788219451904
Epoch: 16, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.101 Vali Acc: 0.080 Test Loss: 3.101 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2096306
	speed: 0.4101s/iter; left time: 5264.5594s
Epoch: 17 cost time: 17.117847442626953
Epoch: 17, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.697 Vali Acc: 0.369 Test Loss: 2.697 Test Acc: 0.369
Validation loss decreased (-0.362097 --> -0.368586).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.4404660
	speed: 0.4099s/iter; left time: 5199.1897s
Epoch: 18 cost time: 19.424798488616943
Epoch: 18, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.996 Vali Acc: 0.145 Test Loss: 2.996 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6573113
	speed: 0.4096s/iter; left time: 5131.6865s
Epoch: 19 cost time: 16.75283908843994
Epoch: 19, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.769 Vali Acc: 0.131 Test Loss: 2.769 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6989847
	speed: 0.4012s/iter; left time: 4965.0222s
Epoch: 20 cost time: 19.98018765449524
Epoch: 20, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.857 Vali Acc: 0.141 Test Loss: 2.857 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.5518762
	speed: 0.4407s/iter; left time: 5386.1454s
Epoch: 21 cost time: 20.404080152511597
Epoch: 21, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.284 Vali Acc: 0.121 Test Loss: 3.284 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3891386
	speed: 0.4437s/iter; left time: 5353.7339s
Epoch: 22 cost time: 18.060224294662476
Epoch: 22, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.074 Vali Acc: 0.128 Test Loss: 3.074 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.6744142
	speed: 0.3885s/iter; left time: 4627.9602s
Epoch: 23 cost time: 17.345884799957275
Epoch: 23, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.867 Vali Acc: 0.311 Test Loss: 2.867 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.9491935
	speed: 0.3736s/iter; left time: 4393.6615s
Epoch: 24 cost time: 18.052403926849365
Epoch: 24, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.491 Vali Acc: 0.113 Test Loss: 3.491 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7029022
	speed: 0.4126s/iter; left time: 4788.6672s
Epoch: 25 cost time: 18.66123366355896
Epoch: 25, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.356 Vali Acc: 0.122 Test Loss: 3.356 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.4157704
	speed: 0.4295s/iter; left time: 4918.1912s
Epoch: 26 cost time: 18.76756501197815
Epoch: 26, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.279 Vali Acc: 0.131 Test Loss: 3.279 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.3116771
	speed: 0.3681s/iter; left time: 4158.6167s
Epoch: 27 cost time: 15.811423540115356
Epoch: 27, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.435 Vali Acc: 0.122 Test Loss: 3.435 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 243390
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8160205
	speed: 0.1173s/iter; left time: 1795.1830s
Epoch: 1 cost time: 16.38624858856201
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1570501
	speed: 0.3484s/iter; left time: 5276.8892s
Epoch: 2 cost time: 14.635027647018433
Epoch: 2, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9316961
	speed: 0.3243s/iter; left time: 4862.4865s
Epoch: 3 cost time: 13.850322484970093
Epoch: 3, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.137 Vali Acc: 0.327 Test Loss: 2.137 Test Acc: 0.327
Validation loss decreased (-0.315469 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7183465
	speed: 0.3247s/iter; left time: 4818.8909s
Epoch: 4 cost time: 14.41215705871582
Epoch: 4, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.121 Vali Acc: 0.328 Test Loss: 2.121 Test Acc: 0.328
Validation loss decreased (-0.326824 --> -0.328446).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1217451
	speed: 0.3730s/iter; left time: 5477.0638s
Epoch: 5 cost time: 15.820592164993286
Epoch: 5, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.082 Vali Acc: 0.350 Test Loss: 2.082 Test Acc: 0.350
Validation loss decreased (-0.328446 --> -0.349939).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0416429
	speed: 0.3469s/iter; left time: 5040.7664s
Epoch: 6 cost time: 15.516295194625854
Epoch: 6, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.146 Vali Acc: 0.347 Test Loss: 2.146 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7456642
	speed: 0.3575s/iter; left time: 5139.9378s
Epoch: 7 cost time: 15.241144180297852
Epoch: 7, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.417 Vali Acc: 0.180 Test Loss: 2.417 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6833225
	speed: 0.3409s/iter; left time: 4848.8681s
Epoch: 8 cost time: 17.07222080230713
Epoch: 8, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.434 Vali Acc: 0.358 Test Loss: 2.434 Test Acc: 0.358
Validation loss decreased (-0.349939 --> -0.357640).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6123301
	speed: 0.3577s/iter; left time: 5031.8464s
Epoch: 9 cost time: 15.358602046966553
Epoch: 9, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.433 Vali Acc: 0.200 Test Loss: 2.433 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8326485
	speed: 0.3521s/iter; left time: 4899.7077s
Epoch: 10 cost time: 15.71460485458374
Epoch: 10, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.568 Vali Acc: 0.356 Test Loss: 2.568 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4103907
	speed: 0.3428s/iter; left time: 4716.8702s
Epoch: 11 cost time: 16.646323680877686
Epoch: 11, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.656 Vali Acc: 0.187 Test Loss: 2.656 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3893554
	speed: 0.3364s/iter; left time: 4576.8253s
Epoch: 12 cost time: 14.745306253433228
Epoch: 12, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.848 Vali Acc: 0.180 Test Loss: 2.848 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3357080
	speed: 0.3304s/iter; left time: 4445.0729s
Epoch: 13 cost time: 15.476101398468018
Epoch: 13, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.659 Vali Acc: 0.401 Test Loss: 2.659 Test Acc: 0.401
Validation loss decreased (-0.357640 --> -0.401028).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5174708
	speed: 0.3223s/iter; left time: 4286.6699s
Epoch: 14 cost time: 13.584185600280762
Epoch: 14, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.340 Vali Acc: 0.148 Test Loss: 3.340 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4018195
	speed: 0.3332s/iter; left time: 4380.4722s
Epoch: 15 cost time: 15.424965858459473
Epoch: 15, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.189 Vali Acc: 0.139 Test Loss: 3.189 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1669627
	speed: 0.3666s/iter; left time: 4762.1745s
Epoch: 16 cost time: 16.821478366851807
Epoch: 16, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.146 Vali Acc: 0.240 Test Loss: 3.146 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1013918
	speed: 0.3347s/iter; left time: 4297.1399s
Epoch: 17 cost time: 15.025781631469727
Epoch: 17, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.324 Vali Acc: 0.102 Test Loss: 3.324 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3713586
	speed: 0.3538s/iter; left time: 4487.6228s
Epoch: 18 cost time: 15.576400518417358
Epoch: 18, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.204 Vali Acc: 0.121 Test Loss: 3.204 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3871344
	speed: 0.3318s/iter; left time: 4156.7972s
Epoch: 19 cost time: 14.415776491165161
Epoch: 19, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.326 Vali Acc: 0.081 Test Loss: 3.326 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.1406112
	speed: 0.3676s/iter; left time: 4549.0644s
Epoch: 20 cost time: 16.070642948150635
Epoch: 20, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.276 Vali Acc: 0.077 Test Loss: 3.276 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.0836283
	speed: 0.3584s/iter; left time: 4379.8044s
Epoch: 21 cost time: 15.584057807922363
Epoch: 21, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.236 Vali Acc: 0.086 Test Loss: 3.236 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.2406454
	speed: 0.3464s/iter; left time: 4179.9477s
Epoch: 22 cost time: 15.540869951248169
Epoch: 22, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.215 Vali Acc: 0.102 Test Loss: 3.215 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.2741667
	speed: 0.3629s/iter; left time: 4323.4947s
Epoch: 23 cost time: 15.082483530044556
Epoch: 23, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.793 Vali Acc: 0.146 Test Loss: 2.793 Test Acc: 0.146
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4010543390105434
model parameter : 243198
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1755142
	speed: 0.1398s/iter; left time: 2139.1511s
Epoch: 1 cost time: 20.7176616191864
Epoch: 1, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.142 Vali Acc: 0.315 Test Loss: 2.142 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2055495
	speed: 0.3948s/iter; left time: 5980.3527s
Epoch: 2 cost time: 17.60321283340454
Epoch: 2, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.136 Vali Acc: 0.317 Test Loss: 2.136 Test Acc: 0.317
Validation loss decreased (-0.315064 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9348689
	speed: 0.4164s/iter; left time: 6243.5413s
Epoch: 3 cost time: 19.963483095169067
Epoch: 3, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.160 Vali Acc: 0.319 Test Loss: 2.160 Test Acc: 0.319
Validation loss decreased (-0.316686 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5959843
	speed: 0.3960s/iter; left time: 5876.5519s
Epoch: 4 cost time: 17.430562496185303
Epoch: 4, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.069 Vali Acc: 0.336 Test Loss: 2.069 Test Acc: 0.336
Validation loss decreased (-0.318713 --> -0.335746).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5562428
	speed: 0.3754s/iter; left time: 5513.3493s
Epoch: 5 cost time: 17.068944215774536
Epoch: 5, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.131 Vali Acc: 0.175 Test Loss: 2.131 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5982075
	speed: 0.4083s/iter; left time: 5932.4281s
Epoch: 6 cost time: 19.764959812164307
Epoch: 6, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.171 Vali Acc: 0.363 Test Loss: 2.171 Test Acc: 0.363
Validation loss decreased (-0.335746 --> -0.362509).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2719895
	speed: 0.4298s/iter; left time: 6179.4466s
Epoch: 7 cost time: 19.719160318374634
Epoch: 7, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.301 Vali Acc: 0.185 Test Loss: 2.301 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8963392
	speed: 0.4085s/iter; left time: 5810.2073s
Epoch: 8 cost time: 18.662782669067383
Epoch: 8, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.357 Vali Acc: 0.167 Test Loss: 2.357 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4395164
	speed: 0.4565s/iter; left time: 6422.2185s
Epoch: 9 cost time: 19.35668134689331
Epoch: 9, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.400 Vali Acc: 0.180 Test Loss: 2.400 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2408305
	speed: 0.3830s/iter; left time: 5329.0945s
Epoch: 10 cost time: 15.696715354919434
Epoch: 10, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.397 Vali Acc: 0.397 Test Loss: 2.397 Test Acc: 0.397
Validation loss decreased (-0.362509 --> -0.397381).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0119896
	speed: 0.4005s/iter; left time: 5511.0254s
Epoch: 11 cost time: 18.146292448043823
Epoch: 11, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.864 Vali Acc: 0.181 Test Loss: 2.864 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5317671
	speed: 0.3827s/iter; left time: 5207.5642s
Epoch: 12 cost time: 17.446592569351196
Epoch: 12, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.116 Vali Acc: 0.102 Test Loss: 3.116 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4986476
	speed: 0.3946s/iter; left time: 5308.0268s
Epoch: 13 cost time: 18.325494050979614
Epoch: 13, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.203 Vali Acc: 0.097 Test Loss: 3.203 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7322791
	speed: 0.4383s/iter; left time: 5828.8397s
Epoch: 14 cost time: 18.367525577545166
Epoch: 14, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.904 Vali Acc: 0.185 Test Loss: 2.904 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4081336
	speed: 0.3975s/iter; left time: 5225.6365s
Epoch: 15 cost time: 17.225854635238647
Epoch: 15, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.850 Vali Acc: 0.151 Test Loss: 2.850 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4968987
	speed: 0.4256s/iter; left time: 5528.4689s
Epoch: 16 cost time: 20.822885751724243
Epoch: 16, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.957 Vali Acc: 0.139 Test Loss: 2.957 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.4374015
	speed: 0.4261s/iter; left time: 5469.5017s
Epoch: 17 cost time: 18.86007070541382
Epoch: 17, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.058 Vali Acc: 0.120 Test Loss: 3.058 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4799473
	speed: 0.4375s/iter; left time: 5548.4534s
Epoch: 18 cost time: 17.841480493545532
Epoch: 18, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.363 Vali Acc: 0.111 Test Loss: 3.363 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.9855722
	speed: 0.3995s/iter; left time: 5005.3276s
Epoch: 19 cost time: 17.805813550949097
Epoch: 19, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.147 Vali Acc: 0.142 Test Loss: 3.147 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.3754163
	speed: 0.4336s/iter; left time: 5365.7402s
Epoch: 20 cost time: 19.167130708694458
Epoch: 20, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.032 Vali Acc: 0.133 Test Loss: 3.032 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39740470397404704
model parameter : 185534
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7857591
	speed: 0.1552s/iter; left time: 2374.3976s
Epoch: 1 cost time: 22.459192276000977
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1045547
	speed: 0.4077s/iter; left time: 6175.6373s
Epoch: 2 cost time: 17.899172067642212
Epoch: 2, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5388050
	speed: 0.4004s/iter; left time: 6002.6346s
Epoch: 3 cost time: 16.747860431671143
Epoch: 3, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.203 Vali Acc: 0.316 Test Loss: 2.203 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315874).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0272071
	speed: 0.4215s/iter; left time: 6254.4480s
Epoch: 4 cost time: 19.35814118385315
Epoch: 4, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.093 Vali Acc: 0.331 Test Loss: 2.093 Test Acc: 0.331
Validation loss decreased (-0.315874 --> -0.330879).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1419792
	speed: 0.4308s/iter; left time: 6326.7954s
Epoch: 5 cost time: 19.671455144882202
Epoch: 5, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.035 Vali Acc: 0.346 Test Loss: 2.035 Test Acc: 0.346
Validation loss decreased (-0.330879 --> -0.345884).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6983155
	speed: 0.4141s/iter; left time: 6016.7164s
Epoch: 6 cost time: 17.17183804512024
Epoch: 6, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.334 Vali Acc: 0.329 Test Loss: 2.334 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9306986
	speed: 0.4248s/iter; left time: 6107.0984s
Epoch: 7 cost time: 19.06848645210266
Epoch: 7, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.245 Vali Acc: 0.339 Test Loss: 2.245 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6475775
	speed: 0.4286s/iter; left time: 6095.3709s
Epoch: 8 cost time: 18.575575590133667
Epoch: 8, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.407 Vali Acc: 0.186 Test Loss: 2.407 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6610938
	speed: 0.4526s/iter; left time: 6368.1437s
Epoch: 9 cost time: 20.10807490348816
Epoch: 9, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.493 Vali Acc: 0.213 Test Loss: 2.493 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3880337
	speed: 0.4417s/iter; left time: 6145.8256s
Epoch: 10 cost time: 19.7130069732666
Epoch: 10, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.728 Vali Acc: 0.188 Test Loss: 2.728 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.9508865
	speed: 0.3879s/iter; left time: 5337.9060s
Epoch: 11 cost time: 16.932830095291138
Epoch: 11, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.632 Vali Acc: 0.359 Test Loss: 2.632 Test Acc: 0.359
Validation loss decreased (-0.345884 --> -0.358854).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2762538
	speed: 0.3878s/iter; left time: 5276.5272s
Epoch: 12 cost time: 16.48198437690735
Epoch: 12, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.187 Vali Acc: 0.115 Test Loss: 3.187 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2298148
	speed: 0.3608s/iter; left time: 4854.0053s
Epoch: 13 cost time: 15.278342962265015
Epoch: 13, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.966 Vali Acc: 0.109 Test Loss: 2.966 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4640118
	speed: 0.4100s/iter; left time: 5452.1600s
Epoch: 14 cost time: 20.18603515625
Epoch: 14, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.726 Vali Acc: 0.207 Test Loss: 2.726 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4817393
	speed: 0.4142s/iter; left time: 5444.1347s
Epoch: 15 cost time: 17.82546591758728
Epoch: 15, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.670 Vali Acc: 0.384 Test Loss: 2.670 Test Acc: 0.384
Validation loss decreased (-0.358854 --> -0.383996).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0499052
	speed: 0.4226s/iter; left time: 5489.5499s
Epoch: 16 cost time: 21.025309801101685
Epoch: 16, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.062 Vali Acc: 0.118 Test Loss: 3.062 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5359256
	speed: 0.4287s/iter; left time: 5503.6014s
Epoch: 17 cost time: 19.491933584213257
Epoch: 17, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.826 Vali Acc: 0.219 Test Loss: 2.826 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.2738822
	speed: 0.4071s/iter; left time: 5162.6845s
Epoch: 18 cost time: 18.809229850769043
Epoch: 18, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.457 Vali Acc: 0.109 Test Loss: 3.457 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.9674679
	speed: 0.4013s/iter; left time: 5027.7006s
Epoch: 19 cost time: 20.092262744903564
Epoch: 19, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.024 Vali Acc: 0.169 Test Loss: 3.024 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.6507785
	speed: 0.4135s/iter; left time: 5117.1713s
Epoch: 20 cost time: 19.972517728805542
Epoch: 20, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.729 Vali Acc: 0.372 Test Loss: 2.729 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.2843236
	speed: 0.4224s/iter; left time: 5161.7864s
Epoch: 21 cost time: 17.54898977279663
Epoch: 21, Steps: 154 | Train Loss: 1.342 Vali Loss: 3.171 Vali Acc: 0.120 Test Loss: 3.171 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2474823
	speed: 0.3729s/iter; left time: 4499.5803s
Epoch: 22 cost time: 16.928911685943604
Epoch: 22, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.788 Vali Acc: 0.130 Test Loss: 2.788 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2108734
	speed: 0.3884s/iter; left time: 4626.5559s
Epoch: 23 cost time: 18.50982165336609
Epoch: 23, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.937 Vali Acc: 0.144 Test Loss: 2.937 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.8668889
	speed: 0.4197s/iter; left time: 4934.8543s
Epoch: 24 cost time: 18.935009479522705
Epoch: 24, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.218 Vali Acc: 0.120 Test Loss: 3.218 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.4035903
	speed: 0.4083s/iter; left time: 4738.3116s
Epoch: 25 cost time: 19.075090885162354
Epoch: 25, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.905 Vali Acc: 0.154 Test Loss: 2.905 Test Acc: 0.154
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3840227088402271
model parameter : 185342
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8916963
	speed: 0.1412s/iter; left time: 2160.3792s
Epoch: 1 cost time: 19.581427097320557
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1248088
	speed: 0.3879s/iter; left time: 5875.3753s
Epoch: 2 cost time: 16.585338592529297
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4399841
	speed: 0.3955s/iter; left time: 5930.4378s
Epoch: 3 cost time: 17.052356004714966
Epoch: 3, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.185 Vali Acc: 0.322 Test Loss: 2.185 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.321957).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6479232
	speed: 0.4237s/iter; left time: 6287.1893s
Epoch: 4 cost time: 18.75992488861084
Epoch: 4, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.076 Vali Acc: 0.334 Test Loss: 2.076 Test Acc: 0.334
Validation loss decreased (-0.321957 --> -0.333718).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6950134
	speed: 0.4313s/iter; left time: 6333.3932s
Epoch: 5 cost time: 18.433337211608887
Epoch: 5, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.096 Vali Acc: 0.337 Test Loss: 2.096 Test Acc: 0.337
Validation loss decreased (-0.333718 --> -0.337368).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9005625
	speed: 0.4222s/iter; left time: 6135.2713s
Epoch: 6 cost time: 19.929806232452393
Epoch: 6, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.307 Vali Acc: 0.338 Test Loss: 2.307 Test Acc: 0.338
Validation loss decreased (-0.337368 --> -0.337771).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8567424
	speed: 0.4627s/iter; left time: 6652.1503s
Epoch: 7 cost time: 20.24319291114807
Epoch: 7, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.286 Vali Acc: 0.337 Test Loss: 2.286 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0091243
	speed: 0.4523s/iter; left time: 6432.8889s
Epoch: 8 cost time: 19.231409311294556
Epoch: 8, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.084 Vali Acc: 0.364 Test Loss: 2.084 Test Acc: 0.364
Validation loss decreased (-0.337771 --> -0.363726).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4761598
	speed: 0.4290s/iter; left time: 6035.3896s
Epoch: 9 cost time: 19.474196195602417
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.332 Vali Acc: 0.209 Test Loss: 2.332 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6557219
	speed: 0.4093s/iter; left time: 5695.9289s
Epoch: 10 cost time: 15.95571517944336
Epoch: 10, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.368 Vali Acc: 0.373 Test Loss: 2.368 Test Acc: 0.373
Validation loss decreased (-0.363726 --> -0.373456).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7402793
	speed: 0.3874s/iter; left time: 5330.6418s
Epoch: 11 cost time: 16.985084533691406
Epoch: 11, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.534 Vali Acc: 0.246 Test Loss: 2.534 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6132917
	speed: 0.4244s/iter; left time: 5775.0103s
Epoch: 12 cost time: 19.877448797225952
Epoch: 12, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.592 Vali Acc: 0.212 Test Loss: 2.592 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7960844
	speed: 0.4102s/iter; left time: 5518.4606s
Epoch: 13 cost time: 17.314150094985962
Epoch: 13, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.619 Vali Acc: 0.357 Test Loss: 2.619 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.2730558
	speed: 0.4234s/iter; left time: 5630.8486s
Epoch: 14 cost time: 22.57876944541931
Epoch: 14, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.632 Vali Acc: 0.349 Test Loss: 2.632 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4139048
	speed: 0.4359s/iter; left time: 5730.5354s
Epoch: 15 cost time: 17.129108905792236
Epoch: 15, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.643 Vali Acc: 0.270 Test Loss: 2.643 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5055869
	speed: 0.4190s/iter; left time: 5443.5065s
Epoch: 16 cost time: 21.602917432785034
Epoch: 16, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.786 Vali Acc: 0.366 Test Loss: 2.786 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2982929
	speed: 0.4534s/iter; left time: 5819.8090s
Epoch: 17 cost time: 21.510431051254272
Epoch: 17, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.999 Vali Acc: 0.108 Test Loss: 2.999 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7552871
	speed: 0.4879s/iter; left time: 6188.4453s
Epoch: 18 cost time: 23.531593084335327
Epoch: 18, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.032 Vali Acc: 0.144 Test Loss: 3.032 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.4967045
	speed: 0.4105s/iter; left time: 5143.1620s
Epoch: 19 cost time: 17.11469292640686
Epoch: 19, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.966 Vali Acc: 0.113 Test Loss: 2.966 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1118426
	speed: 0.3790s/iter; left time: 4690.7266s
Epoch: 20 cost time: 15.499953031539917
Epoch: 20, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.071 Vali Acc: 0.133 Test Loss: 3.071 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 185150
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2082462
	speed: 0.1136s/iter; left time: 1738.6439s
Epoch: 1 cost time: 15.990108728408813
Epoch: 1, Steps: 154 | Train Loss: 2.215 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3206041
	speed: 0.3500s/iter; left time: 5301.2136s
Epoch: 2 cost time: 14.652548789978027
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.143 Vali Acc: 0.315 Test Loss: 2.143 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9720641
	speed: 0.3546s/iter; left time: 5316.5541s
Epoch: 3 cost time: 15.76699686050415
Epoch: 3, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.112 Vali Acc: 0.323 Test Loss: 2.112 Test Acc: 0.323
Validation loss decreased (-0.315469 --> -0.322769).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8148719
	speed: 0.3604s/iter; left time: 5348.6511s
Epoch: 4 cost time: 17.113962173461914
Epoch: 4, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.212 Vali Acc: 0.328 Test Loss: 2.212 Test Acc: 0.328
Validation loss decreased (-0.322769 --> -0.328445).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7136657
	speed: 0.3626s/iter; left time: 5324.2963s
Epoch: 5 cost time: 14.727857828140259
Epoch: 5, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.255 Vali Acc: 0.327 Test Loss: 2.255 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1316233
	speed: 0.3374s/iter; left time: 4902.6813s
Epoch: 6 cost time: 15.541237354278564
Epoch: 6, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.077 Vali Acc: 0.200 Test Loss: 2.077 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3472658
	speed: 0.3656s/iter; left time: 5256.5448s
Epoch: 7 cost time: 15.702598094940186
Epoch: 7, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.205 Vali Acc: 0.367 Test Loss: 2.205 Test Acc: 0.367
Validation loss decreased (-0.328445 --> -0.366564).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8975570
	speed: 0.3433s/iter; left time: 4883.0624s
Epoch: 8 cost time: 15.440704345703125
Epoch: 8, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.513 Vali Acc: 0.186 Test Loss: 2.513 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4799950
	speed: 0.3366s/iter; left time: 4736.2560s
Epoch: 9 cost time: 15.08504343032837
Epoch: 9, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.249 Vali Acc: 0.215 Test Loss: 2.249 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7120118
	speed: 0.3132s/iter; left time: 4358.1987s
Epoch: 10 cost time: 14.907608032226562
Epoch: 10, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.567 Vali Acc: 0.255 Test Loss: 2.567 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3214223
	speed: 0.3591s/iter; left time: 4941.8025s
Epoch: 11 cost time: 16.218260526657104
Epoch: 11, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.818 Vali Acc: 0.196 Test Loss: 2.818 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4827026
	speed: 0.3257s/iter; left time: 4431.8008s
Epoch: 12 cost time: 14.621351718902588
Epoch: 12, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.888 Vali Acc: 0.115 Test Loss: 2.888 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4118276
	speed: 0.3500s/iter; left time: 4708.0381s
Epoch: 13 cost time: 17.652671337127686
Epoch: 13, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.681 Vali Acc: 0.177 Test Loss: 2.681 Test Acc: 0.177
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2031188
	speed: 0.3381s/iter; left time: 4496.2795s
Epoch: 14 cost time: 15.542379379272461
Epoch: 14, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.054 Vali Acc: 0.119 Test Loss: 3.054 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2344699
	speed: 0.3613s/iter; left time: 4749.0658s
Epoch: 15 cost time: 16.69892954826355
Epoch: 15, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.506 Vali Acc: 0.381 Test Loss: 2.506 Test Acc: 0.381
Validation loss decreased (-0.366564 --> -0.380754).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5619760
	speed: 0.3693s/iter; left time: 4797.7020s
Epoch: 16 cost time: 15.856241464614868
Epoch: 16, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.014 Vali Acc: 0.191 Test Loss: 3.014 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5199491
	speed: 0.3571s/iter; left time: 4584.0564s
Epoch: 17 cost time: 15.376555442810059
Epoch: 17, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.088 Vali Acc: 0.191 Test Loss: 3.088 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6833706
	speed: 0.3409s/iter; left time: 4323.5123s
Epoch: 18 cost time: 15.558204650878906
Epoch: 18, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.873 Vali Acc: 0.375 Test Loss: 2.873 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5403557
	speed: 0.3485s/iter; left time: 4366.8990s
Epoch: 19 cost time: 15.52053165435791
Epoch: 19, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.103 Vali Acc: 0.119 Test Loss: 3.103 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0815398
	speed: 0.3442s/iter; left time: 4259.9121s
Epoch: 20 cost time: 15.68190622329712
Epoch: 20, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.205 Vali Acc: 0.098 Test Loss: 3.205 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.5955346
	speed: 0.3520s/iter; left time: 4302.1982s
Epoch: 21 cost time: 15.724600553512573
Epoch: 21, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.205 Vali Acc: 0.131 Test Loss: 3.205 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.8486216
	speed: 0.3723s/iter; left time: 4492.1246s
Epoch: 22 cost time: 17.25166606903076
Epoch: 22, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.079 Vali Acc: 0.126 Test Loss: 3.079 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.5823190
	speed: 0.3758s/iter; left time: 4476.6481s
Epoch: 23 cost time: 15.790730953216553
Epoch: 23, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.063 Vali Acc: 0.366 Test Loss: 3.063 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.2179230
	speed: 0.3725s/iter; left time: 4380.4609s
Epoch: 24 cost time: 16.08720374107361
Epoch: 24, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.805 Vali Acc: 0.122 Test Loss: 2.805 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.0451641
	speed: 0.3464s/iter; left time: 4019.6602s
Epoch: 25 cost time: 15.743101596832275
Epoch: 25, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.581 Vali Acc: 0.139 Test Loss: 2.581 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 184958
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4482882
	speed: 0.1172s/iter; left time: 1792.7007s
Epoch: 1 cost time: 16.616880416870117
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2804542
	speed: 0.3430s/iter; left time: 5195.3791s
Epoch: 2 cost time: 13.154972314834595
Epoch: 2, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.289 Vali Acc: 0.319 Test Loss: 2.289 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.319117).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8951077
	speed: 0.3594s/iter; left time: 5388.8884s
Epoch: 3 cost time: 13.980581760406494
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.286 Vali Acc: 0.334 Test Loss: 2.286 Test Acc: 0.334
Validation loss decreased (-0.319117 --> -0.334122).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0701501
	speed: 0.3490s/iter; left time: 5178.6491s
Epoch: 4 cost time: 14.200510025024414
Epoch: 4, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.144 Vali Acc: 0.332 Test Loss: 2.144 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7238704
	speed: 0.3331s/iter; left time: 4890.8736s
Epoch: 5 cost time: 13.081692457199097
Epoch: 5, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.134 Vali Acc: 0.351 Test Loss: 2.134 Test Acc: 0.351
Validation loss decreased (-0.334122 --> -0.351155).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2976198
	speed: 0.3226s/iter; left time: 4687.5614s
Epoch: 6 cost time: 13.811554431915283
Epoch: 6, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.309 Vali Acc: 0.249 Test Loss: 2.309 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0677679
	speed: 0.3451s/iter; left time: 4961.2297s
Epoch: 7 cost time: 15.414219856262207
Epoch: 7, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.342 Vali Acc: 0.109 Test Loss: 2.342 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3286455
	speed: 0.3540s/iter; left time: 5035.0326s
Epoch: 8 cost time: 14.021334171295166
Epoch: 8, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.216 Vali Acc: 0.350 Test Loss: 2.216 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.7517715
	speed: 0.3300s/iter; left time: 4642.1508s
Epoch: 9 cost time: 13.434699296951294
Epoch: 9, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.197 Vali Acc: 0.315 Test Loss: 2.197 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.4859424
	speed: 0.3329s/iter; left time: 4631.9817s
Epoch: 10 cost time: 12.65147066116333
Epoch: 10, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.192 Vali Acc: 0.323 Test Loss: 2.192 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.7739973
	speed: 0.3272s/iter; left time: 4503.2684s
Epoch: 11 cost time: 13.598393678665161
Epoch: 11, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.146 Vali Acc: 0.325 Test Loss: 2.146 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.9867761
	speed: 0.3077s/iter; left time: 4187.3814s
Epoch: 12 cost time: 11.19299030303955
Epoch: 12, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.144 Vali Acc: 0.343 Test Loss: 2.144 Test Acc: 0.343
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.1691790
	speed: 0.3377s/iter; left time: 4542.4833s
Epoch: 13 cost time: 14.250173568725586
Epoch: 13, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.162 Vali Acc: 0.319 Test Loss: 2.162 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.1407809
	speed: 0.3390s/iter; left time: 4507.9690s
Epoch: 14 cost time: 13.100488662719727
Epoch: 14, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.151 Vali Acc: 0.329 Test Loss: 2.151 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.2821138
	speed: 0.3351s/iter; left time: 4404.7986s
Epoch: 15 cost time: 12.047526121139526
Epoch: 15, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.144 Vali Acc: 0.322 Test Loss: 2.144 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35117599351175993
model parameter : 7972146
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2525063
	speed: 0.1155s/iter; left time: 1767.8535s
Epoch: 1 cost time: 16.104002952575684
Epoch: 1, Steps: 154 | Train Loss: 2.313 Vali Loss: 2.287 Vali Acc: 0.317 Test Loss: 2.287 Test Acc: 0.317
Validation loss decreased (inf --> -0.316684).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8636224
	speed: 0.3427s/iter; left time: 5190.3855s
Epoch: 2 cost time: 11.947293996810913
Epoch: 2, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.154 Vali Acc: 0.323 Test Loss: 2.154 Test Acc: 0.323
Validation loss decreased (-0.316684 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0927403
	speed: 0.3132s/iter; left time: 4696.3311s
Epoch: 3 cost time: 11.951287269592285
Epoch: 3, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.270 Vali Acc: 0.328 Test Loss: 2.270 Test Acc: 0.328
Validation loss decreased (-0.323174 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6970497
	speed: 0.3381s/iter; left time: 5016.3460s
Epoch: 4 cost time: 14.158487319946289
Epoch: 4, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.022 Vali Acc: 0.353 Test Loss: 2.022 Test Acc: 0.353
Validation loss decreased (-0.328039 --> -0.352778).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7595758
	speed: 0.3293s/iter; left time: 4835.4474s
Epoch: 5 cost time: 11.742470741271973
Epoch: 5, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.206 Vali Acc: 0.182 Test Loss: 2.206 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7328830
	speed: 0.3347s/iter; left time: 4862.8283s
Epoch: 6 cost time: 13.63237738609314
Epoch: 6, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.265 Vali Acc: 0.353 Test Loss: 2.265 Test Acc: 0.353
Validation loss decreased (-0.352778 --> -0.353181).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8708464
	speed: 0.3741s/iter; left time: 5378.4354s
Epoch: 7 cost time: 15.670109272003174
Epoch: 7, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.103 Vali Acc: 0.354 Test Loss: 2.103 Test Acc: 0.354
Validation loss decreased (-0.353181 --> -0.353588).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2690828
	speed: 0.3435s/iter; left time: 4886.1551s
Epoch: 8 cost time: 12.814624071121216
Epoch: 8, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.169 Vali Acc: 0.194 Test Loss: 2.169 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6072007
	speed: 0.3481s/iter; left time: 4897.8138s
Epoch: 9 cost time: 13.507444381713867
Epoch: 9, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.191 Vali Acc: 0.316 Test Loss: 2.191 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9824872
	speed: 0.3428s/iter; left time: 4770.2704s
Epoch: 10 cost time: 14.149458885192871
Epoch: 10, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.208 Vali Acc: 0.318 Test Loss: 2.208 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.3239520
	speed: 0.3458s/iter; left time: 4759.2237s
Epoch: 11 cost time: 14.004556894302368
Epoch: 11, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.226 Vali Acc: 0.316 Test Loss: 2.226 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8794024
	speed: 0.3286s/iter; left time: 4470.9193s
Epoch: 12 cost time: 12.562132596969604
Epoch: 12, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.164 Vali Acc: 0.318 Test Loss: 2.164 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 2.1784682
	speed: 0.3148s/iter; left time: 4235.5668s
Epoch: 13 cost time: 13.165807723999023
Epoch: 13, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.231 Vali Acc: 0.315 Test Loss: 2.231 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7942461
	speed: 0.3430s/iter; left time: 4562.0919s
Epoch: 14 cost time: 12.74318265914917
Epoch: 14, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.0312095
	speed: 0.3288s/iter; left time: 4321.4960s
Epoch: 15 cost time: 12.648980140686035
Epoch: 15, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 2.1437290
	speed: 0.3414s/iter; left time: 4435.5003s
Epoch: 16 cost time: 14.201019287109375
Epoch: 16, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 2.2818944
	speed: 0.3098s/iter; left time: 3977.0848s
Epoch: 17 cost time: 12.960193395614624
Epoch: 17, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35360908353609083
model parameter : 7970866
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0640664
	speed: 0.1117s/iter; left time: 1708.5448s
Epoch: 1 cost time: 15.328830480575562
Epoch: 1, Steps: 154 | Train Loss: 2.289 Vali Loss: 2.366 Vali Acc: 0.111 Test Loss: 2.366 Test Acc: 0.111
Validation loss decreased (inf --> -0.110682).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3332157
	speed: 0.3070s/iter; left time: 4649.5051s
Epoch: 2 cost time: 12.367154836654663
Epoch: 2, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.293 Vali Acc: 0.321 Test Loss: 2.293 Test Acc: 0.321
Validation loss decreased (-0.110682 --> -0.321145).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3381586
	speed: 0.3221s/iter; left time: 4829.2816s
Epoch: 3 cost time: 12.36182951927185
Epoch: 3, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.146 Vali Acc: 0.180 Test Loss: 2.146 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2261505
	speed: 0.3030s/iter; left time: 4495.6705s
Epoch: 4 cost time: 11.504550695419312
Epoch: 4, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.128 Vali Acc: 0.168 Test Loss: 2.128 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1347356
	speed: 0.3092s/iter; left time: 4540.9226s
Epoch: 5 cost time: 13.010467290878296
Epoch: 5, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.293 Vali Acc: 0.352 Test Loss: 2.293 Test Acc: 0.352
Validation loss decreased (-0.321145 --> -0.351964).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6662772
	speed: 0.3195s/iter; left time: 4642.2114s
Epoch: 6 cost time: 12.502714395523071
Epoch: 6, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.174 Vali Acc: 0.337 Test Loss: 2.174 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6604656
	speed: 0.3075s/iter; left time: 4420.4507s
Epoch: 7 cost time: 12.083140850067139
Epoch: 7, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.197 Vali Acc: 0.343 Test Loss: 2.197 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3733876
	speed: 0.2993s/iter; left time: 4257.6108s
Epoch: 8 cost time: 11.593142986297607
Epoch: 8, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.243 Vali Acc: 0.315 Test Loss: 2.243 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7891763
	speed: 0.3041s/iter; left time: 4277.9985s
Epoch: 9 cost time: 12.259722232818604
Epoch: 9, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.247 Vali Acc: 0.316 Test Loss: 2.247 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1449931
	speed: 0.3116s/iter; left time: 4336.0625s
Epoch: 10 cost time: 12.9838285446167
Epoch: 10, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.283 Vali Acc: 0.319 Test Loss: 2.283 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.1020522
	speed: 0.3271s/iter; left time: 4501.2801s
Epoch: 11 cost time: 12.580319881439209
Epoch: 11, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.211 Vali Acc: 0.317 Test Loss: 2.211 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.2457759
	speed: 0.3165s/iter; left time: 4306.9475s
Epoch: 12 cost time: 12.487720966339111
Epoch: 12, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.186 Vali Acc: 0.318 Test Loss: 2.186 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.6478417
	speed: 0.3028s/iter; left time: 4073.8660s
Epoch: 13 cost time: 12.493908166885376
Epoch: 13, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.1938396
	speed: 0.3216s/iter; left time: 4277.1023s
Epoch: 14 cost time: 12.325854778289795
Epoch: 14, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.2111702
	speed: 0.3113s/iter; left time: 4092.2919s
Epoch: 15 cost time: 13.390273094177246
Epoch: 15, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3519870235198702
model parameter : 7969586
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9635696
	speed: 0.1031s/iter; left time: 1577.4321s
Epoch: 1 cost time: 14.376321792602539
Epoch: 1, Steps: 154 | Train Loss: 2.335 Vali Loss: 2.249 Vali Acc: 0.111 Test Loss: 2.249 Test Acc: 0.111
Validation loss decreased (inf --> -0.110683).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9946637
	speed: 0.2736s/iter; left time: 4144.4356s
Epoch: 2 cost time: 11.296089887619019
Epoch: 2, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.095 Vali Acc: 0.341 Test Loss: 2.095 Test Acc: 0.341
Validation loss decreased (-0.110683 --> -0.341423).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3814154
	speed: 0.2817s/iter; left time: 4223.7119s
Epoch: 3 cost time: 12.100481033325195
Epoch: 3, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.170 Vali Acc: 0.364 Test Loss: 2.170 Test Acc: 0.364
Validation loss decreased (-0.341423 --> -0.364131).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2594485
	speed: 0.3006s/iter; left time: 4460.5344s
Epoch: 4 cost time: 12.611269235610962
Epoch: 4, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.527 Vali Acc: 0.177 Test Loss: 2.527 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2537940
	speed: 0.2876s/iter; left time: 4223.2524s
Epoch: 5 cost time: 11.1531400680542
Epoch: 5, Steps: 154 | Train Loss: 1.851 Vali Loss: 2.164 Vali Acc: 0.343 Test Loss: 2.164 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2917707
	speed: 0.2744s/iter; left time: 3987.1306s
Epoch: 6 cost time: 11.461639165878296
Epoch: 6, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.277 Vali Acc: 0.105 Test Loss: 2.277 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0418639
	speed: 0.2995s/iter; left time: 4306.4952s
Epoch: 7 cost time: 12.030261039733887
Epoch: 7, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.300 Vali Acc: 0.340 Test Loss: 2.300 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5594617
	speed: 0.2954s/iter; left time: 4201.9072s
Epoch: 8 cost time: 11.364997386932373
Epoch: 8, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.413 Vali Acc: 0.197 Test Loss: 2.413 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.9620830
	speed: 0.3124s/iter; left time: 4395.7534s
Epoch: 9 cost time: 12.475641250610352
Epoch: 9, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.288 Vali Acc: 0.367 Test Loss: 2.288 Test Acc: 0.367
Validation loss decreased (-0.364131 --> -0.367374).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9281162
	speed: 0.2952s/iter; left time: 4107.5923s
Epoch: 10 cost time: 12.563027381896973
Epoch: 10, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.200 Vali Acc: 0.315 Test Loss: 2.200 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0230119
	speed: 0.2920s/iter; left time: 4018.2160s
Epoch: 11 cost time: 11.333834648132324
Epoch: 11, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.5645716
	speed: 0.2905s/iter; left time: 3952.1978s
Epoch: 12 cost time: 11.991878271102905
Epoch: 12, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.179 Vali Acc: 0.317 Test Loss: 2.179 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.1154225
	speed: 0.2737s/iter; left time: 3682.4616s
Epoch: 13 cost time: 10.877421140670776
Epoch: 13, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.577 Vali Acc: 0.062 Test Loss: 2.577 Test Acc: 0.062
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3338852
	speed: 0.2820s/iter; left time: 3750.1298s
Epoch: 14 cost time: 12.445975542068481
Epoch: 14, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.215 Vali Acc: 0.320 Test Loss: 2.215 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.8157525
	speed: 0.2966s/iter; left time: 3899.2720s
Epoch: 15 cost time: 11.209250688552856
Epoch: 15, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.208 Vali Acc: 0.330 Test Loss: 2.208 Test Acc: 0.330
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.0347817
	speed: 0.2838s/iter; left time: 3687.1734s
Epoch: 16 cost time: 10.82373595237732
Epoch: 16, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.172 Vali Acc: 0.325 Test Loss: 2.172 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.2297091
	speed: 0.2749s/iter; left time: 3528.7210s
Epoch: 17 cost time: 11.117191553115845
Epoch: 17, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.138 Vali Acc: 0.325 Test Loss: 2.138 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6646622
	speed: 0.2780s/iter; left time: 3525.6379s
Epoch: 18 cost time: 11.14963150024414
Epoch: 18, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.128 Vali Acc: 0.333 Test Loss: 2.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.1490600
	speed: 0.2835s/iter; left time: 3551.3766s
Epoch: 19 cost time: 10.977519273757935
Epoch: 19, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.123 Vali Acc: 0.325 Test Loss: 2.123 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36739659367396593
model parameter : 7968306
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0491929
	speed: 0.1191s/iter; left time: 1822.2083s
Epoch: 1 cost time: 15.932543754577637
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.172 Vali Acc: 0.318 Test Loss: 2.172 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8876160
	speed: 0.3465s/iter; left time: 5248.1130s
Epoch: 2 cost time: 13.897207260131836
Epoch: 2, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.462 Vali Acc: 0.321 Test Loss: 2.462 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321143).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1962168
	speed: 0.3398s/iter; left time: 5094.8614s
Epoch: 3 cost time: 12.365726232528687
Epoch: 3, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.077 Vali Acc: 0.345 Test Loss: 2.077 Test Acc: 0.345
Validation loss decreased (-0.321143 --> -0.344667).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6055529
	speed: 0.3395s/iter; left time: 5037.5826s
Epoch: 4 cost time: 12.294608354568481
Epoch: 4, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.240 Vali Acc: 0.344 Test Loss: 2.240 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1187592
	speed: 0.3334s/iter; left time: 4895.8036s
Epoch: 5 cost time: 14.852846622467041
Epoch: 5, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.256 Vali Acc: 0.186 Test Loss: 2.256 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7506151
	speed: 0.3462s/iter; left time: 5030.5015s
Epoch: 6 cost time: 15.773580312728882
Epoch: 6, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.268 Vali Acc: 0.384 Test Loss: 2.268 Test Acc: 0.384
Validation loss decreased (-0.344667 --> -0.384406).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4953666
	speed: 0.3208s/iter; left time: 4612.0141s
Epoch: 7 cost time: 12.811457633972168
Epoch: 7, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.192 Vali Acc: 0.348 Test Loss: 2.192 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9730601
	speed: 0.3211s/iter; left time: 4566.5090s
Epoch: 8 cost time: 11.871607780456543
Epoch: 8, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.295 Vali Acc: 0.318 Test Loss: 2.295 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0016479
	speed: 0.3151s/iter; left time: 4433.4407s
Epoch: 9 cost time: 12.803933382034302
Epoch: 9, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.138 Vali Acc: 0.330 Test Loss: 2.138 Test Acc: 0.330
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.1324756
	speed: 0.2959s/iter; left time: 4116.8393s
Epoch: 10 cost time: 12.035907745361328
Epoch: 10, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.235 Vali Acc: 0.321 Test Loss: 2.235 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.9933772
	speed: 0.3057s/iter; left time: 4206.6508s
Epoch: 11 cost time: 12.658363819122314
Epoch: 11, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.234 Vali Acc: 0.132 Test Loss: 2.234 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.3401368
	speed: 0.3180s/iter; left time: 4327.5740s
Epoch: 12 cost time: 12.533817768096924
Epoch: 12, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.153 Vali Acc: 0.320 Test Loss: 2.153 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8818370
	speed: 0.3029s/iter; left time: 4075.5029s
Epoch: 13 cost time: 11.973389148712158
Epoch: 13, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.115 Vali Acc: 0.322 Test Loss: 2.115 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.9000375
	speed: 0.3001s/iter; left time: 3990.5388s
Epoch: 14 cost time: 11.854223012924194
Epoch: 14, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.5248854
	speed: 0.3053s/iter; left time: 4012.7093s
Epoch: 15 cost time: 12.122261762619019
Epoch: 15, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.3201833
	speed: 0.3227s/iter; left time: 4191.8244s
Epoch: 16 cost time: 12.77980661392212
Epoch: 16, Steps: 154 | Train Loss: 2.319 Vali Loss: 2.295 Vali Acc: 0.315 Test Loss: 2.295 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 6658866
model size : 30.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8131750
	speed: 0.1102s/iter; left time: 1685.4319s
Epoch: 1 cost time: 15.475315570831299
Epoch: 1, Steps: 154 | Train Loss: 2.308 Vali Loss: 2.244 Vali Acc: 0.315 Test Loss: 2.244 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5403702
	speed: 0.2970s/iter; left time: 4498.3412s
Epoch: 2 cost time: 11.579725980758667
Epoch: 2, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.198 Vali Acc: 0.326 Test Loss: 2.198 Test Acc: 0.326
Validation loss decreased (-0.315063 --> -0.326012).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4274031
	speed: 0.3150s/iter; left time: 4723.0143s
Epoch: 3 cost time: 11.2701416015625
Epoch: 3, Steps: 154 | Train Loss: 2.043 Vali Loss: 2.182 Vali Acc: 0.341 Test Loss: 2.182 Test Acc: 0.341
Validation loss decreased (-0.326012 --> -0.341422).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4048257
	speed: 0.2979s/iter; left time: 4420.8289s
Epoch: 4 cost time: 11.75002908706665
Epoch: 4, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.104 Vali Acc: 0.348 Test Loss: 2.104 Test Acc: 0.348
Validation loss decreased (-0.341422 --> -0.347911).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5117643
	speed: 0.2795s/iter; left time: 4104.7413s
Epoch: 5 cost time: 11.1028733253479
Epoch: 5, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.343 Vali Acc: 0.182 Test Loss: 2.343 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8017831
	speed: 0.2637s/iter; left time: 3832.5271s
Epoch: 6 cost time: 11.21168327331543
Epoch: 6, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.190 Vali Acc: 0.373 Test Loss: 2.190 Test Acc: 0.373
Validation loss decreased (-0.347911 --> -0.373052).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9292455
	speed: 0.2678s/iter; left time: 3850.1871s
Epoch: 7 cost time: 11.215381145477295
Epoch: 7, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.083 Vali Acc: 0.341 Test Loss: 2.083 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4618022
	speed: 0.2489s/iter; left time: 3540.3715s
Epoch: 8 cost time: 10.95512318611145
Epoch: 8, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.022 Vali Acc: 0.364 Test Loss: 2.022 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4661348
	speed: 0.2688s/iter; left time: 3781.6225s
Epoch: 9 cost time: 11.698130130767822
Epoch: 9, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.137 Vali Acc: 0.350 Test Loss: 2.137 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9691515
	speed: 0.3045s/iter; left time: 4236.8088s
Epoch: 10 cost time: 12.400637865066528
Epoch: 10, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.233 Vali Acc: 0.326 Test Loss: 2.233 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.6044049
	speed: 0.3027s/iter; left time: 4165.6058s
Epoch: 11 cost time: 11.77695345878601
Epoch: 11, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.354 Vali Acc: 0.315 Test Loss: 2.354 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8443689
	speed: 0.2859s/iter; left time: 3889.6232s
Epoch: 12 cost time: 12.617193698883057
Epoch: 12, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.1754904
	speed: 0.3084s/iter; left time: 4148.6568s
Epoch: 13 cost time: 13.03139877319336
Epoch: 13, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.226 Vali Acc: 0.315 Test Loss: 2.226 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.9599390
	speed: 0.2846s/iter; left time: 3784.7683s
Epoch: 14 cost time: 11.441282272338867
Epoch: 14, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.206 Vali Acc: 0.315 Test Loss: 2.206 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.1408474
	speed: 0.2677s/iter; left time: 3518.4771s
Epoch: 15 cost time: 9.305395364761353
Epoch: 15, Steps: 154 | Train Loss: 2.186 Vali Loss: 2.249 Vali Acc: 0.155 Test Loss: 2.249 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.6883969
	speed: 0.2470s/iter; left time: 3208.6137s
Epoch: 16 cost time: 10.529121398925781
Epoch: 16, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 6657586
model size : 30.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3448856
	speed: 0.1126s/iter; left time: 1722.3461s
Epoch: 1 cost time: 15.51579475402832
Epoch: 1, Steps: 154 | Train Loss: 2.296 Vali Loss: 2.295 Vali Acc: 0.129 Test Loss: 2.295 Test Acc: 0.129
Validation loss decreased (inf --> -0.128525).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7132404
	speed: 0.3169s/iter; left time: 4799.7380s
Epoch: 2 cost time: 12.724316835403442
Epoch: 2, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.355 Vali Acc: 0.110 Test Loss: 2.355 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9183199
	speed: 0.3050s/iter; left time: 4573.2420s
Epoch: 3 cost time: 12.127636909484863
Epoch: 3, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.096 Vali Acc: 0.344 Test Loss: 2.096 Test Acc: 0.344
Validation loss decreased (-0.128525 --> -0.344261).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9343637
	speed: 0.2613s/iter; left time: 3876.8260s
Epoch: 4 cost time: 11.60785961151123
Epoch: 4, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.382 Vali Acc: 0.164 Test Loss: 2.382 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4073694
	speed: 0.2758s/iter; left time: 4050.6317s
Epoch: 5 cost time: 10.850735425949097
Epoch: 5, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.256 Vali Acc: 0.215 Test Loss: 2.256 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4004805
	speed: 0.2840s/iter; left time: 4126.1984s
Epoch: 6 cost time: 10.895074129104614
Epoch: 6, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.149 Vali Acc: 0.377 Test Loss: 2.149 Test Acc: 0.377
Validation loss decreased (-0.344261 --> -0.377107).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0605197
	speed: 0.2933s/iter; left time: 4216.6876s
Epoch: 7 cost time: 12.415020942687988
Epoch: 7, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.194 Vali Acc: 0.320 Test Loss: 2.194 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2231941
	speed: 0.3151s/iter; left time: 4481.8379s
Epoch: 8 cost time: 12.781355142593384
Epoch: 8, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.183 Vali Acc: 0.328 Test Loss: 2.183 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4111214
	speed: 0.3151s/iter; left time: 4433.2565s
Epoch: 9 cost time: 13.406525611877441
Epoch: 9, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.208 Vali Acc: 0.327 Test Loss: 2.208 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2601650
	speed: 0.3126s/iter; left time: 4349.7491s
Epoch: 10 cost time: 11.898707151412964
Epoch: 10, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.187 Vali Acc: 0.318 Test Loss: 2.187 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.1135602
	speed: 0.2993s/iter; left time: 4118.1099s
Epoch: 11 cost time: 11.548479795455933
Epoch: 11, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.1685369
	speed: 0.2825s/iter; left time: 3844.0172s
Epoch: 12 cost time: 11.49228811264038
Epoch: 12, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.183 Vali Acc: 0.316 Test Loss: 2.183 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.4041662
	speed: 0.2985s/iter; left time: 4015.4540s
Epoch: 13 cost time: 11.533804416656494
Epoch: 13, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.206 Vali Acc: 0.316 Test Loss: 2.206 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.4106355
	speed: 0.3091s/iter; left time: 4110.2461s
Epoch: 14 cost time: 11.534786224365234
Epoch: 14, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.2160783
	speed: 0.3031s/iter; left time: 3983.9383s
Epoch: 15 cost time: 12.132654190063477
Epoch: 15, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.164 Vali Acc: 0.316 Test Loss: 2.164 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.2715182
	speed: 0.3281s/iter; left time: 4262.6072s
Epoch: 16 cost time: 12.658544540405273
Epoch: 16, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 6656306
model size : 30.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4636989
	speed: 0.1110s/iter; left time: 1698.0495s
Epoch: 1 cost time: 15.372071743011475
Epoch: 1, Steps: 154 | Train Loss: 2.310 Vali Loss: 2.288 Vali Acc: 0.316 Test Loss: 2.288 Test Acc: 0.316
Validation loss decreased (inf --> -0.316279).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4498465
	speed: 0.2845s/iter; left time: 4310.0290s
Epoch: 2 cost time: 12.255929470062256
Epoch: 2, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.287 Vali Acc: 0.322 Test Loss: 2.287 Test Acc: 0.322
Validation loss decreased (-0.316279 --> -0.321956).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5819246
	speed: 0.3020s/iter; left time: 4528.3305s
Epoch: 3 cost time: 12.220873594284058
Epoch: 3, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.199 Vali Acc: 0.335 Test Loss: 2.199 Test Acc: 0.335
Validation loss decreased (-0.321956 --> -0.334528).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1582735
	speed: 0.3082s/iter; left time: 4573.0506s
Epoch: 4 cost time: 12.226762771606445
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.244 Vali Acc: 0.345 Test Loss: 2.244 Test Acc: 0.345
Validation loss decreased (-0.334528 --> -0.344665).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1869688
	speed: 0.2983s/iter; left time: 4380.1963s
Epoch: 5 cost time: 11.14719820022583
Epoch: 5, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.030 Vali Acc: 0.229 Test Loss: 2.030 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3966513
	speed: 0.3067s/iter; left time: 4456.1827s
Epoch: 6 cost time: 12.529997825622559
Epoch: 6, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.019 Vali Acc: 0.354 Test Loss: 2.019 Test Acc: 0.354
Validation loss decreased (-0.344665 --> -0.353589).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6540102
	speed: 0.3092s/iter; left time: 4445.3579s
Epoch: 7 cost time: 12.45830249786377
Epoch: 7, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.158 Vali Acc: 0.341 Test Loss: 2.158 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9882022
	speed: 0.2861s/iter; left time: 4069.5433s
Epoch: 8 cost time: 12.059183597564697
Epoch: 8, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.248 Vali Acc: 0.350 Test Loss: 2.248 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9273884
	speed: 0.3070s/iter; left time: 4319.3426s
Epoch: 9 cost time: 12.60353398323059
Epoch: 9, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.324 Vali Acc: 0.119 Test Loss: 2.324 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7951992
	speed: 0.2824s/iter; left time: 3929.2997s
Epoch: 10 cost time: 11.690950155258179
Epoch: 10, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.158 Vali Acc: 0.191 Test Loss: 2.158 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8188111
	speed: 0.2771s/iter; left time: 3812.7131s
Epoch: 11 cost time: 10.456517219543457
Epoch: 11, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.315 Vali Acc: 0.316 Test Loss: 2.315 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.4120274
	speed: 0.2774s/iter; left time: 3774.9424s
Epoch: 12 cost time: 10.94376826286316
Epoch: 12, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.0143745
	speed: 0.2580s/iter; left time: 3471.3234s
Epoch: 13 cost time: 10.952669143676758
Epoch: 13, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.080 Vali Acc: 0.347 Test Loss: 2.080 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.7218677
	speed: 0.2899s/iter; left time: 3855.0071s
Epoch: 14 cost time: 12.084064245223999
Epoch: 14, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.090 Vali Acc: 0.333 Test Loss: 2.090 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.6007798
	speed: 0.2999s/iter; left time: 3942.1454s
Epoch: 15 cost time: 12.018834352493286
Epoch: 15, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.113 Vali Acc: 0.339 Test Loss: 2.113 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.1359446
	speed: 0.2777s/iter; left time: 3607.2771s
Epoch: 16 cost time: 11.16778564453125
Epoch: 16, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.209 Vali Acc: 0.315 Test Loss: 2.209 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35360908353609083
model parameter : 6655026
model size : 30.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3402779
	speed: 0.1037s/iter; left time: 1586.3334s
Epoch: 1 cost time: 14.600550413131714
Epoch: 1, Steps: 154 | Train Loss: 2.308 Vali Loss: 2.294 Vali Acc: 0.316 Test Loss: 2.294 Test Acc: 0.316
Validation loss decreased (inf --> -0.315873).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0252488
	speed: 0.3282s/iter; left time: 4971.7067s
Epoch: 2 cost time: 13.530073404312134
Epoch: 2, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.281 Vali Acc: 0.162 Test Loss: 2.281 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9100617
	speed: 0.2905s/iter; left time: 4356.0814s
Epoch: 3 cost time: 12.341858386993408
Epoch: 3, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.163 Vali Acc: 0.340 Test Loss: 2.163 Test Acc: 0.340
Validation loss decreased (-0.315873 --> -0.339800).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3225808
	speed: 0.3283s/iter; left time: 4872.3819s
Epoch: 4 cost time: 12.621220111846924
Epoch: 4, Steps: 154 | Train Loss: 1.922 Vali Loss: 1.981 Vali Acc: 0.361 Test Loss: 1.981 Test Acc: 0.361
Validation loss decreased (-0.339800 --> -0.360483).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0116839
	speed: 0.2913s/iter; left time: 4278.4248s
Epoch: 5 cost time: 11.38255786895752
Epoch: 5, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.278 Vali Acc: 0.182 Test Loss: 2.278 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5252094
	speed: 0.2845s/iter; left time: 4133.7464s
Epoch: 6 cost time: 10.529885053634644
Epoch: 6, Steps: 154 | Train Loss: 1.726 Vali Loss: 3.194 Vali Acc: 0.189 Test Loss: 3.194 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9170101
	speed: 0.2732s/iter; left time: 3927.1415s
Epoch: 7 cost time: 10.725847959518433
Epoch: 7, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.155 Vali Acc: 0.339 Test Loss: 2.155 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.1936219
	speed: 0.2992s/iter; left time: 4255.5221s
Epoch: 8 cost time: 12.12399411201477
Epoch: 8, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.393 Vali Acc: 0.327 Test Loss: 2.393 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0481932
	speed: 0.2910s/iter; left time: 4093.8577s
Epoch: 9 cost time: 12.172923803329468
Epoch: 9, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.148 Vali Acc: 0.170 Test Loss: 2.148 Test Acc: 0.170
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.4421420
	speed: 0.2820s/iter; left time: 3924.6376s
Epoch: 10 cost time: 10.635634183883667
Epoch: 10, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.194 Vali Acc: 0.317 Test Loss: 2.194 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.9832704
	speed: 0.2816s/iter; left time: 3874.9076s
Epoch: 11 cost time: 12.522702932357788
Epoch: 11, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.124 Vali Acc: 0.323 Test Loss: 2.124 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.2873788
	speed: 0.3100s/iter; left time: 4218.3013s
Epoch: 12 cost time: 12.079348802566528
Epoch: 12, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.139 Vali Acc: 0.322 Test Loss: 2.139 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.9015756
	speed: 0.2933s/iter; left time: 3945.8660s
Epoch: 13 cost time: 11.015519618988037
Epoch: 13, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.162 Vali Acc: 0.318 Test Loss: 2.162 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.1497309
	speed: 0.3024s/iter; left time: 4021.2747s
Epoch: 14 cost time: 12.85384750366211
Epoch: 14, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.145 Vali Acc: 0.316 Test Loss: 2.145 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3605028386050284
model parameter : 6002226
model size : 27.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7482920
	speed: 0.1001s/iter; left time: 1531.8818s
Epoch: 1 cost time: 14.419912815093994
Epoch: 1, Steps: 154 | Train Loss: 2.291 Vali Loss: 2.287 Vali Acc: 0.316 Test Loss: 2.287 Test Acc: 0.316
Validation loss decreased (inf --> -0.315873).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2731287
	speed: 0.3011s/iter; left time: 4560.7012s
Epoch: 2 cost time: 12.1627676486969
Epoch: 2, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.231 Vali Acc: 0.327 Test Loss: 2.231 Test Acc: 0.327
Validation loss decreased (-0.315873 --> -0.327228).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6883692
	speed: 0.3024s/iter; left time: 4533.2829s
Epoch: 3 cost time: 11.057588577270508
Epoch: 3, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.262 Vali Acc: 0.327 Test Loss: 2.262 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9587438
	speed: 0.2950s/iter; left time: 4377.1080s
Epoch: 4 cost time: 11.840230703353882
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.203 Vali Acc: 0.351 Test Loss: 2.203 Test Acc: 0.351
Validation loss decreased (-0.327228 --> -0.350748).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7241927
	speed: 0.3258s/iter; left time: 4784.7938s
Epoch: 5 cost time: 12.741271018981934
Epoch: 5, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.111 Vali Acc: 0.378 Test Loss: 2.111 Test Acc: 0.378
Validation loss decreased (-0.350748 --> -0.378324).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7043824
	speed: 0.3241s/iter; left time: 4709.5027s
Epoch: 6 cost time: 13.584908962249756
Epoch: 6, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.017 Vali Acc: 0.377 Test Loss: 2.017 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7494358
	speed: 0.3277s/iter; left time: 4710.6997s
Epoch: 7 cost time: 12.94159460067749
Epoch: 7, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.295 Vali Acc: 0.210 Test Loss: 2.295 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1325960
	speed: 0.3016s/iter; left time: 4289.4354s
Epoch: 8 cost time: 10.982601165771484
Epoch: 8, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.016 Vali Acc: 0.377 Test Loss: 2.016 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7814862
	speed: 0.3047s/iter; left time: 4286.7709s
Epoch: 9 cost time: 11.947235107421875
Epoch: 9, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.700 Vali Acc: 0.375 Test Loss: 2.700 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6660211
	speed: 0.2980s/iter; left time: 4146.7569s
Epoch: 10 cost time: 10.756641387939453
Epoch: 10, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.173 Vali Acc: 0.345 Test Loss: 2.173 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6888241
	speed: 0.2973s/iter; left time: 4090.6468s
Epoch: 11 cost time: 12.133718013763428
Epoch: 11, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.172 Vali Acc: 0.336 Test Loss: 2.172 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.7634292
	speed: 0.2935s/iter; left time: 3993.9863s
Epoch: 12 cost time: 11.086071968078613
Epoch: 12, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.205 Vali Acc: 0.315 Test Loss: 2.205 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.6219766
	speed: 0.2832s/iter; left time: 3809.7259s
Epoch: 13 cost time: 11.73183536529541
Epoch: 13, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.2647135
	speed: 0.2891s/iter; left time: 3844.1694s
Epoch: 14 cost time: 12.180139303207397
Epoch: 14, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.111 Vali Acc: 0.330 Test Loss: 2.111 Test Acc: 0.330
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6634469
	speed: 0.3094s/iter; left time: 4066.7544s
Epoch: 15 cost time: 13.303940057754517
Epoch: 15, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.120 Vali Acc: 0.319 Test Loss: 2.120 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 6000946
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4811635
	speed: 0.1124s/iter; left time: 1719.1585s
Epoch: 1 cost time: 15.811134099960327
Epoch: 1, Steps: 154 | Train Loss: 2.310 Vali Loss: 2.336 Vali Acc: 0.129 Test Loss: 2.336 Test Acc: 0.129
Validation loss decreased (inf --> -0.129336).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3205729
	speed: 0.3446s/iter; left time: 5220.1700s
Epoch: 2 cost time: 13.498319625854492
Epoch: 2, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.157 Vali Acc: 0.328 Test Loss: 2.157 Test Acc: 0.328
Validation loss decreased (-0.129336 --> -0.328446).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4191301
	speed: 0.3282s/iter; left time: 4920.7185s
Epoch: 3 cost time: 14.46412467956543
Epoch: 3, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.259 Vali Acc: 0.344 Test Loss: 2.259 Test Acc: 0.344
Validation loss decreased (-0.328446 --> -0.343854).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6158552
	speed: 0.3316s/iter; left time: 4920.5269s
Epoch: 4 cost time: 13.436068773269653
Epoch: 4, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.350 Vali Acc: 0.163 Test Loss: 2.350 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4329513
	speed: 0.2953s/iter; left time: 4336.8609s
Epoch: 5 cost time: 12.733042001724243
Epoch: 5, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.260 Vali Acc: 0.339 Test Loss: 2.260 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5511707
	speed: 0.3078s/iter; left time: 4473.3678s
Epoch: 6 cost time: 12.38906478881836
Epoch: 6, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.426 Vali Acc: 0.350 Test Loss: 2.426 Test Acc: 0.350
Validation loss decreased (-0.343854 --> -0.349530).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5313264
	speed: 0.3366s/iter; left time: 4839.0565s
Epoch: 7 cost time: 13.524954319000244
Epoch: 7, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.186 Vali Acc: 0.232 Test Loss: 2.186 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4964684
	speed: 0.3760s/iter; left time: 5347.2089s
Epoch: 8 cost time: 14.593910455703735
Epoch: 8, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.493 Vali Acc: 0.135 Test Loss: 2.493 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7640575
	speed: 0.3266s/iter; left time: 4594.7176s
Epoch: 9 cost time: 13.248685121536255
Epoch: 9, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.432 Vali Acc: 0.176 Test Loss: 2.432 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8930185
	speed: 0.3332s/iter; left time: 4636.3435s
Epoch: 10 cost time: 13.825977087020874
Epoch: 10, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.233 Vali Acc: 0.315 Test Loss: 2.233 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6963890
	speed: 0.3370s/iter; left time: 4637.6604s
Epoch: 11 cost time: 13.693024635314941
Epoch: 11, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.226 Vali Acc: 0.315 Test Loss: 2.226 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8492045
	speed: 0.3178s/iter; left time: 4324.0995s
Epoch: 12 cost time: 13.056905746459961
Epoch: 12, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.210 Vali Acc: 0.315 Test Loss: 2.210 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8045096
	speed: 0.3500s/iter; left time: 4708.5593s
Epoch: 13 cost time: 14.985011577606201
Epoch: 13, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.3729548
	speed: 0.4009s/iter; left time: 5331.6682s
Epoch: 14 cost time: 17.22727108001709
Epoch: 14, Steps: 154 | Train Loss: 2.170 Vali Loss: 2.232 Vali Acc: 0.315 Test Loss: 2.232 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.1034732
	speed: 0.3892s/iter; left time: 5115.4407s
Epoch: 15 cost time: 15.482802867889404
Epoch: 15, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.221 Vali Acc: 0.315 Test Loss: 2.221 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.5077317
	speed: 0.3801s/iter; left time: 4937.4620s
Epoch: 16 cost time: 15.159905672073364
Epoch: 16, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3495539334955393
model parameter : 5999666
model size : 27.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1002729
	speed: 0.1126s/iter; left time: 1723.5684s
Epoch: 1 cost time: 15.51600193977356
Epoch: 1, Steps: 154 | Train Loss: 2.267 Vali Loss: 2.307 Vali Acc: 0.317 Test Loss: 2.307 Test Acc: 0.317
Validation loss decreased (inf --> -0.316684).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0674796
	speed: 0.3139s/iter; left time: 4754.4753s
Epoch: 2 cost time: 13.294655084609985
Epoch: 2, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.200 Vali Acc: 0.165 Test Loss: 2.200 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2698383
	speed: 0.3162s/iter; left time: 4741.1820s
Epoch: 3 cost time: 12.567665100097656
Epoch: 3, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.122 Vali Acc: 0.335 Test Loss: 2.122 Test Acc: 0.335
Validation loss decreased (-0.316684 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5619144
	speed: 0.3472s/iter; left time: 5152.5081s
Epoch: 4 cost time: 13.51354694366455
Epoch: 4, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.054 Vali Acc: 0.337 Test Loss: 2.054 Test Acc: 0.337
Validation loss decreased (-0.335340 --> -0.337368).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0225346
	speed: 0.3408s/iter; left time: 5003.9743s
Epoch: 5 cost time: 12.954192399978638
Epoch: 5, Steps: 154 | Train Loss: 1.838 Vali Loss: 1.977 Vali Acc: 0.372 Test Loss: 1.977 Test Acc: 0.372
Validation loss decreased (-0.337368 --> -0.371837).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6577719
	speed: 0.3343s/iter; left time: 4857.9720s
Epoch: 6 cost time: 13.801003694534302
Epoch: 6, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.199 Vali Acc: 0.254 Test Loss: 2.199 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7348906
	speed: 0.3625s/iter; left time: 5211.5528s
Epoch: 7 cost time: 14.592132806777954
Epoch: 7, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.041 Vali Acc: 0.367 Test Loss: 2.041 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0459762
	speed: 0.3778s/iter; left time: 5374.1529s
Epoch: 8 cost time: 15.754737615585327
Epoch: 8, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.238 Vali Acc: 0.365 Test Loss: 2.238 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6825156
	speed: 0.3534s/iter; left time: 4971.5143s
Epoch: 9 cost time: 14.111083984375
Epoch: 9, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.262 Vali Acc: 0.352 Test Loss: 2.262 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5027586
	speed: 0.3648s/iter; left time: 5076.6441s
Epoch: 10 cost time: 14.334812879562378
Epoch: 10, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.387 Vali Acc: 0.380 Test Loss: 2.387 Test Acc: 0.380
Validation loss decreased (-0.371837 --> -0.379538).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3508695
	speed: 0.3802s/iter; left time: 5231.4908s
Epoch: 11 cost time: 15.849854946136475
Epoch: 11, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.105 Vali Acc: 0.368 Test Loss: 2.105 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4763429
	speed: 0.3798s/iter; left time: 5167.3430s
Epoch: 12 cost time: 15.099608421325684
Epoch: 12, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.703 Vali Acc: 0.117 Test Loss: 2.703 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9056220
	speed: 0.3721s/iter; left time: 5005.8982s
Epoch: 13 cost time: 14.525938034057617
Epoch: 13, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.272 Vali Acc: 0.169 Test Loss: 2.272 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7143823
	speed: 0.3911s/iter; left time: 5200.6021s
Epoch: 14 cost time: 16.324702978134155
Epoch: 14, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.226 Vali Acc: 0.158 Test Loss: 2.226 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6027663
	speed: 0.3904s/iter; left time: 5132.2123s
Epoch: 15 cost time: 13.749762058258057
Epoch: 15, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.235 Vali Acc: 0.315 Test Loss: 2.235 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.2719514
	speed: 0.3309s/iter; left time: 4299.0872s
Epoch: 16 cost time: 13.062642335891724
Epoch: 16, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.0402594
	speed: 0.3664s/iter; left time: 4703.5810s
Epoch: 17 cost time: 13.742318868637085
Epoch: 17, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4775492
	speed: 0.3296s/iter; left time: 4180.5364s
Epoch: 18 cost time: 12.398256301879883
Epoch: 18, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.1652236
	speed: 0.3683s/iter; left time: 4613.8966s
Epoch: 19 cost time: 14.696020603179932
Epoch: 19, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.193 Vali Acc: 0.316 Test Loss: 2.193 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.8805714
	speed: 0.3630s/iter; left time: 4492.4595s
Epoch: 20 cost time: 14.125000238418579
Epoch: 20, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 5998386
model size : 27.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1477458
	speed: 0.1111s/iter; left time: 1700.4607s
Epoch: 1 cost time: 15.719516515731812
Epoch: 1, Steps: 154 | Train Loss: 2.287 Vali Loss: 2.262 Vali Acc: 0.156 Test Loss: 2.262 Test Acc: 0.156
Validation loss decreased (inf --> -0.156101).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1474376
	speed: 0.3394s/iter; left time: 5140.7208s
Epoch: 2 cost time: 11.827029466629028
Epoch: 2, Steps: 154 | Train Loss: 2.197 Vali Loss: 2.181 Vali Acc: 0.114 Test Loss: 2.181 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2742529
	speed: 0.3449s/iter; left time: 5170.4588s
Epoch: 3 cost time: 14.53678274154663
Epoch: 3, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.146 Vali Acc: 0.359 Test Loss: 2.146 Test Acc: 0.359
Validation loss decreased (-0.156101 --> -0.358859).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1710098
	speed: 0.3851s/iter; left time: 5714.4572s
Epoch: 4 cost time: 16.229644060134888
Epoch: 4, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.256 Vali Acc: 0.340 Test Loss: 2.256 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3767548
	speed: 0.3539s/iter; left time: 5196.6287s
Epoch: 5 cost time: 12.762515306472778
Epoch: 5, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.155 Vali Acc: 0.176 Test Loss: 2.155 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6116666
	speed: 0.3472s/iter; left time: 5045.6434s
Epoch: 6 cost time: 13.687016487121582
Epoch: 6, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.562 Vali Acc: 0.177 Test Loss: 2.562 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5209424
	speed: 0.3519s/iter; left time: 5058.9998s
Epoch: 7 cost time: 14.65883183479309
Epoch: 7, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.466 Vali Acc: 0.202 Test Loss: 2.466 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.2221096
	speed: 0.3443s/iter; left time: 4896.4970s
Epoch: 8 cost time: 13.191748142242432
Epoch: 8, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.180 Vali Acc: 0.355 Test Loss: 2.180 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.2850015
	speed: 0.3341s/iter; left time: 4700.2432s
Epoch: 9 cost time: 13.307038068771362
Epoch: 9, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.148 Vali Acc: 0.354 Test Loss: 2.148 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.7427734
	speed: 0.3794s/iter; left time: 5279.5049s
Epoch: 10 cost time: 15.350048780441284
Epoch: 10, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.196 Vali Acc: 0.315 Test Loss: 2.196 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.0127192
	speed: 0.3616s/iter; left time: 4976.3508s
Epoch: 11 cost time: 12.966113567352295
Epoch: 11, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.185 Vali Acc: 0.317 Test Loss: 2.185 Test Acc: 0.317
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.0635593
	speed: 0.3270s/iter; left time: 4449.2613s
Epoch: 12 cost time: 12.83095097541809
Epoch: 12, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.207 Vali Acc: 0.161 Test Loss: 2.207 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.2525892
	speed: 0.3476s/iter; left time: 4676.6573s
Epoch: 13 cost time: 14.794888257980347
Epoch: 13, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.141 Vali Acc: 0.327 Test Loss: 2.141 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3588807785888078
model parameter : 5673906
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7428510
	speed: 0.1134s/iter; left time: 1735.0441s
Epoch: 1 cost time: 15.187205791473389
Epoch: 1, Steps: 154 | Train Loss: 2.308 Vali Loss: 2.289 Vali Acc: 0.315 Test Loss: 2.289 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3488338
	speed: 0.2914s/iter; left time: 4413.5824s
Epoch: 2 cost time: 13.29014253616333
Epoch: 2, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.412 Vali Acc: 0.319 Test Loss: 2.412 Test Acc: 0.319
Validation loss decreased (-0.315468 --> -0.318711).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2854459
	speed: 0.3249s/iter; left time: 4870.7797s
Epoch: 3 cost time: 12.387053728103638
Epoch: 3, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.196 Vali Acc: 0.175 Test Loss: 2.196 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8112290
	speed: 0.3416s/iter; left time: 5068.2738s
Epoch: 4 cost time: 12.609845161437988
Epoch: 4, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.093 Vali Acc: 0.343 Test Loss: 2.093 Test Acc: 0.343
Validation loss decreased (-0.318711 --> -0.343045).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3146071
	speed: 0.3477s/iter; left time: 5105.5237s
Epoch: 5 cost time: 14.138152599334717
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.127 Vali Acc: 0.351 Test Loss: 2.127 Test Acc: 0.351
Validation loss decreased (-0.343045 --> -0.351155).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5678507
	speed: 0.3587s/iter; left time: 5212.7496s
Epoch: 6 cost time: 15.418596267700195
Epoch: 6, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.387 Vali Acc: 0.195 Test Loss: 2.387 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3262502
	speed: 0.3492s/iter; left time: 5020.3270s
Epoch: 7 cost time: 13.423416376113892
Epoch: 7, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.139 Vali Acc: 0.350 Test Loss: 2.139 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1221457
	speed: 0.3430s/iter; left time: 4878.7287s
Epoch: 8 cost time: 13.744517803192139
Epoch: 8, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.052 Vali Acc: 0.383 Test Loss: 2.052 Test Acc: 0.383
Validation loss decreased (-0.351155 --> -0.382786).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2245131
	speed: 0.3572s/iter; left time: 5025.9573s
Epoch: 9 cost time: 13.809258222579956
Epoch: 9, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.253 Vali Acc: 0.316 Test Loss: 2.253 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2044470
	speed: 0.3208s/iter; left time: 4463.8259s
Epoch: 10 cost time: 12.965828657150269
Epoch: 10, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.164 Vali Acc: 0.327 Test Loss: 2.164 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9884501
	speed: 0.3485s/iter; left time: 4795.2481s
Epoch: 11 cost time: 12.372597694396973
Epoch: 11, Steps: 154 | Train Loss: 2.101 Vali Loss: 2.147 Vali Acc: 0.164 Test Loss: 2.147 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2487955
	speed: 0.3220s/iter; left time: 4381.0215s
Epoch: 12 cost time: 12.01033639907837
Epoch: 12, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.0324612
	speed: 0.3391s/iter; left time: 4562.5708s
Epoch: 13 cost time: 13.583221912384033
Epoch: 13, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.200 Vali Acc: 0.315 Test Loss: 2.200 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.0278604
	speed: 0.3486s/iter; left time: 4636.4780s
Epoch: 14 cost time: 12.280511617660522
Epoch: 14, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.163 Vali Acc: 0.316 Test Loss: 2.163 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.0525198
	speed: 0.3225s/iter; left time: 4239.0969s
Epoch: 15 cost time: 12.564802408218384
Epoch: 15, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.211 Vali Acc: 0.158 Test Loss: 2.211 Test Acc: 0.158
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.4485362
	speed: 0.3362s/iter; left time: 4367.5396s
Epoch: 16 cost time: 12.699047327041626
Epoch: 16, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.7621777
	speed: 0.3553s/iter; left time: 4561.5190s
Epoch: 17 cost time: 13.059014558792114
Epoch: 17, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.161 Vali Acc: 0.315 Test Loss: 2.161 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 2.2416725
	speed: 0.3474s/iter; left time: 4405.4598s
Epoch: 18 cost time: 12.269559144973755
Epoch: 18, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.212 Vali Acc: 0.315 Test Loss: 2.212 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 5672626
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7737056
	speed: 0.1148s/iter; left time: 1756.1570s
Epoch: 1 cost time: 15.676270723342896
Epoch: 1, Steps: 154 | Train Loss: 2.300 Vali Loss: 2.287 Vali Acc: 0.157 Test Loss: 2.287 Test Acc: 0.157
Validation loss decreased (inf --> -0.156506).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9585780
	speed: 0.3225s/iter; left time: 4884.7858s
Epoch: 2 cost time: 13.226497173309326
Epoch: 2, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.355 Vali Acc: 0.328 Test Loss: 2.355 Test Acc: 0.328
Validation loss decreased (-0.156506 --> -0.328444).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2555690
	speed: 0.3517s/iter; left time: 5273.5466s
Epoch: 3 cost time: 13.004075527191162
Epoch: 3, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.091 Vali Acc: 0.343 Test Loss: 2.091 Test Acc: 0.343
Validation loss decreased (-0.328444 --> -0.343450).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0387781
	speed: 0.3208s/iter; left time: 4760.2923s
Epoch: 4 cost time: 13.457334995269775
Epoch: 4, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.453 Vali Acc: 0.340 Test Loss: 2.453 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6203310
	speed: 0.3138s/iter; left time: 4608.8443s
Epoch: 5 cost time: 12.498250246047974
Epoch: 5, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.111 Vali Acc: 0.355 Test Loss: 2.111 Test Acc: 0.355
Validation loss decreased (-0.343450 --> -0.354805).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9534830
	speed: 0.3330s/iter; left time: 4839.2927s
Epoch: 6 cost time: 13.754565715789795
Epoch: 6, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.109 Vali Acc: 0.367 Test Loss: 2.109 Test Acc: 0.367
Validation loss decreased (-0.354805 --> -0.366564).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4773979
	speed: 0.3420s/iter; left time: 4917.4646s
Epoch: 7 cost time: 11.753659009933472
Epoch: 7, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.209 Vali Acc: 0.332 Test Loss: 2.209 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3888752
	speed: 0.3131s/iter; left time: 4453.1867s
Epoch: 8 cost time: 12.461720943450928
Epoch: 8, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.133 Vali Acc: 0.169 Test Loss: 2.133 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7330662
	speed: 0.3454s/iter; left time: 4858.9258s
Epoch: 9 cost time: 13.019328117370605
Epoch: 9, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.210 Vali Acc: 0.316 Test Loss: 2.210 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9012704
	speed: 0.3168s/iter; left time: 4407.6846s
Epoch: 10 cost time: 11.409101009368896
Epoch: 10, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.205 Vali Acc: 0.322 Test Loss: 2.205 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.1842294
	speed: 0.3263s/iter; left time: 4490.4705s
Epoch: 11 cost time: 13.263485670089722
Epoch: 11, Steps: 154 | Train Loss: 2.112 Vali Loss: 2.172 Vali Acc: 0.318 Test Loss: 2.172 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.6521353
	speed: 0.3123s/iter; left time: 4249.2307s
Epoch: 12 cost time: 13.575971364974976
Epoch: 12, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.202 Vali Acc: 0.315 Test Loss: 2.202 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.1191382
	speed: 0.3304s/iter; left time: 4444.2770s
Epoch: 13 cost time: 14.180262804031372
Epoch: 13, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.4804459
	speed: 0.3364s/iter; left time: 4473.6118s
Epoch: 14 cost time: 13.203110218048096
Epoch: 14, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.0050323
	speed: 0.3144s/iter; left time: 4132.7537s
Epoch: 15 cost time: 13.497699737548828
Epoch: 15, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.1344256
	speed: 0.3201s/iter; left time: 4158.9084s
Epoch: 16 cost time: 12.391287088394165
Epoch: 16, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.162 Vali Acc: 0.315 Test Loss: 2.162 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36658556366585565
model parameter : 5671346
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2681835
	speed: 0.1020s/iter; left time: 1560.7630s
Epoch: 1 cost time: 14.047240734100342
Epoch: 1, Steps: 154 | Train Loss: 2.328 Vali Loss: 2.241 Vali Acc: 0.316 Test Loss: 2.241 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3952415
	speed: 0.3410s/iter; left time: 5165.4207s
Epoch: 2 cost time: 13.730368614196777
Epoch: 2, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.197 Vali Acc: 0.320 Test Loss: 2.197 Test Acc: 0.320
Validation loss decreased (-0.315874 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9497334
	speed: 0.3227s/iter; left time: 4838.3927s
Epoch: 3 cost time: 12.045127630233765
Epoch: 3, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.328 Vali Acc: 0.326 Test Loss: 2.328 Test Acc: 0.326
Validation loss decreased (-0.319524 --> -0.326011).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2903378
	speed: 0.3106s/iter; left time: 4608.9763s
Epoch: 4 cost time: 13.490149974822998
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.113 Vali Acc: 0.348 Test Loss: 2.113 Test Acc: 0.348
Validation loss decreased (-0.326011 --> -0.347911).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9055043
	speed: 0.3361s/iter; left time: 4934.9814s
Epoch: 5 cost time: 12.925214052200317
Epoch: 5, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.029 Vali Acc: 0.360 Test Loss: 2.029 Test Acc: 0.360
Validation loss decreased (-0.347911 --> -0.360077).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6705227
	speed: 0.3159s/iter; left time: 4590.9990s
Epoch: 6 cost time: 12.147192239761353
Epoch: 6, Steps: 154 | Train Loss: 1.777 Vali Loss: 2.108 Vali Acc: 0.349 Test Loss: 2.108 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0236862
	speed: 0.2939s/iter; left time: 4225.3887s
Epoch: 7 cost time: 12.35939073562622
Epoch: 7, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.126 Vali Acc: 0.356 Test Loss: 2.126 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7661289
	speed: 0.2980s/iter; left time: 4238.5176s
Epoch: 8 cost time: 12.232623815536499
Epoch: 8, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.129 Vali Acc: 0.347 Test Loss: 2.129 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0135212
	speed: 0.3049s/iter; left time: 4290.1315s
Epoch: 9 cost time: 12.38099217414856
Epoch: 9, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.260 Vali Acc: 0.333 Test Loss: 2.260 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.9677380
	speed: 0.2742s/iter; left time: 3815.5416s
Epoch: 10 cost time: 10.934861421585083
Epoch: 10, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.127 Vali Acc: 0.165 Test Loss: 2.127 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.7192370
	speed: 0.2663s/iter; left time: 3664.9886s
Epoch: 11 cost time: 11.67957878112793
Epoch: 11, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.0196347
	speed: 0.3063s/iter; left time: 4167.9888s
Epoch: 12 cost time: 11.508100986480713
Epoch: 12, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.1745307
	speed: 0.3344s/iter; left time: 4498.1885s
Epoch: 13 cost time: 13.128315210342407
Epoch: 13, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.157 Vali Acc: 0.322 Test Loss: 2.157 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.3114922
	speed: 0.3386s/iter; left time: 4502.5298s
Epoch: 14 cost time: 13.017441272735596
Epoch: 14, Steps: 154 | Train Loss: 2.169 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.3581636
	speed: 0.3181s/iter; left time: 4181.0020s
Epoch: 15 cost time: 11.924031257629395
Epoch: 15, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 5670066
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0985892
	speed: 0.1130s/iter; left time: 1728.2519s
Epoch: 1 cost time: 15.690222024917603
Epoch: 1, Steps: 154 | Train Loss: 2.288 Vali Loss: 2.245 Vali Acc: 0.315 Test Loss: 2.245 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0017009
	speed: 0.3531s/iter; left time: 5349.1191s
Epoch: 2 cost time: 14.660655975341797
Epoch: 2, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.215 Vali Acc: 0.321 Test Loss: 2.215 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3851585
	speed: 0.3773s/iter; left time: 5657.2106s
Epoch: 3 cost time: 13.32177734375
Epoch: 3, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.107 Vali Acc: 0.339 Test Loss: 2.107 Test Acc: 0.339
Validation loss decreased (-0.321146 --> -0.338989).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5407051
	speed: 0.3519s/iter; left time: 5221.9009s
Epoch: 4 cost time: 13.169747114181519
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.067 Vali Acc: 0.343 Test Loss: 2.067 Test Acc: 0.343
Validation loss decreased (-0.338989 --> -0.342640).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7062094
	speed: 0.3661s/iter; left time: 5375.5182s
Epoch: 5 cost time: 13.789320230484009
Epoch: 5, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.302 Vali Acc: 0.343 Test Loss: 2.302 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6940969
	speed: 0.3803s/iter; left time: 5526.2393s
Epoch: 6 cost time: 15.01008129119873
Epoch: 6, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.440 Vali Acc: 0.189 Test Loss: 2.440 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5732749
	speed: 0.3338s/iter; left time: 4799.3301s
Epoch: 7 cost time: 12.563402891159058
Epoch: 7, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.861 Vali Acc: 0.198 Test Loss: 2.861 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4222025
	speed: 0.3608s/iter; left time: 5131.5249s
Epoch: 8 cost time: 14.344796180725098
Epoch: 8, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.591 Vali Acc: 0.198 Test Loss: 2.591 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.8957807
	speed: 0.3531s/iter; left time: 4967.8135s
Epoch: 9 cost time: 13.665217876434326
Epoch: 9, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.505 Vali Acc: 0.202 Test Loss: 2.505 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5210571
	speed: 0.3360s/iter; left time: 4675.1807s
Epoch: 10 cost time: 12.950714111328125
Epoch: 10, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.573 Vali Acc: 0.198 Test Loss: 2.573 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3069042
	speed: 0.3567s/iter; left time: 4908.8968s
Epoch: 11 cost time: 13.557436227798462
Epoch: 11, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.956 Vali Acc: 0.201 Test Loss: 2.956 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.9672824
	speed: 0.3613s/iter; left time: 4916.8742s
Epoch: 12 cost time: 13.607388973236084
Epoch: 12, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.550 Vali Acc: 0.064 Test Loss: 3.550 Test Acc: 0.064
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.4285152
	speed: 0.3538s/iter; left time: 4759.1900s
Epoch: 13 cost time: 13.74494481086731
Epoch: 13, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.663 Vali Acc: 0.378 Test Loss: 2.663 Test Acc: 0.378
Validation loss decreased (-0.342640 --> -0.378319).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3385357
	speed: 0.3456s/iter; left time: 4596.4403s
Epoch: 14 cost time: 13.404465675354004
Epoch: 14, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.486 Vali Acc: 0.270 Test Loss: 2.486 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6455135
	speed: 0.3547s/iter; left time: 4662.1787s
Epoch: 15 cost time: 12.309259176254272
Epoch: 15, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.009 Vali Acc: 0.060 Test Loss: 3.009 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3790920
	speed: 0.3350s/iter; left time: 4351.9241s
Epoch: 16 cost time: 13.564205884933472
Epoch: 16, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.005 Vali Acc: 0.127 Test Loss: 3.005 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.7481749
	speed: 0.3585s/iter; left time: 4602.0616s
Epoch: 17 cost time: 13.293522596359253
Epoch: 17, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.413 Vali Acc: 0.312 Test Loss: 2.413 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3966404
	speed: 0.3674s/iter; left time: 4660.3168s
Epoch: 18 cost time: 14.406037092208862
Epoch: 18, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.949 Vali Acc: 0.168 Test Loss: 2.949 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4908160
	speed: 0.3274s/iter; left time: 4101.4720s
Epoch: 19 cost time: 13.355670690536499
Epoch: 19, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.808 Vali Acc: 0.260 Test Loss: 2.808 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.6027492
	speed: 0.3724s/iter; left time: 4607.8477s
Epoch: 20 cost time: 14.151305198669434
Epoch: 20, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.486 Vali Acc: 0.189 Test Loss: 2.486 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.2272370
	speed: 0.3816s/iter; left time: 4663.5197s
Epoch: 21 cost time: 14.398096561431885
Epoch: 21, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.581 Vali Acc: 0.199 Test Loss: 2.581 Test Acc: 0.199
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.5924907
	speed: 0.3657s/iter; left time: 4412.7612s
Epoch: 22 cost time: 13.591971397399902
Epoch: 22, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.826 Vali Acc: 0.187 Test Loss: 2.826 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.5412234
	speed: 0.3302s/iter; left time: 3933.7841s
Epoch: 23 cost time: 11.912574768066406
Epoch: 23, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.771 Vali Acc: 0.198 Test Loss: 2.771 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 2677938
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6130736
	speed: 0.1188s/iter; left time: 1817.9893s
Epoch: 1 cost time: 16.286155939102173
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.359 Vali Acc: 0.315 Test Loss: 2.359 Test Acc: 0.315
Validation loss decreased (inf --> -0.315467).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7944846
	speed: 0.3511s/iter; left time: 5318.8379s
Epoch: 2 cost time: 12.5132417678833
Epoch: 2, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.164 Vali Acc: 0.337 Test Loss: 2.164 Test Acc: 0.337
Validation loss decreased (-0.315467 --> -0.336556).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8468523
	speed: 0.3218s/iter; left time: 4825.0784s
Epoch: 3 cost time: 12.811064720153809
Epoch: 3, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.052 Vali Acc: 0.353 Test Loss: 2.052 Test Acc: 0.353
Validation loss decreased (-0.336556 --> -0.352778).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9171201
	speed: 0.3380s/iter; left time: 5016.0382s
Epoch: 4 cost time: 13.577459335327148
Epoch: 4, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.033 Vali Acc: 0.358 Test Loss: 2.033 Test Acc: 0.358
Validation loss decreased (-0.352778 --> -0.358455).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8610020
	speed: 0.3559s/iter; left time: 5225.8243s
Epoch: 5 cost time: 13.207452297210693
Epoch: 5, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.336 Vali Acc: 0.361 Test Loss: 2.336 Test Acc: 0.361
Validation loss decreased (-0.358455 --> -0.360479).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5220336
	speed: 0.3548s/iter; left time: 5155.0802s
Epoch: 6 cost time: 13.497479438781738
Epoch: 6, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.811 Vali Acc: 0.131 Test Loss: 2.811 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1686653
	speed: 0.3557s/iter; left time: 5113.5757s
Epoch: 7 cost time: 14.14147686958313
Epoch: 7, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.741 Vali Acc: 0.195 Test Loss: 2.741 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4652182
	speed: 0.3321s/iter; left time: 4723.1356s
Epoch: 8 cost time: 12.119300603866577
Epoch: 8, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.781 Vali Acc: 0.201 Test Loss: 2.781 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3160682
	speed: 0.3698s/iter; left time: 5203.3241s
Epoch: 9 cost time: 14.953340768814087
Epoch: 9, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.448 Vali Acc: 0.372 Test Loss: 2.448 Test Acc: 0.372
Validation loss decreased (-0.360479 --> -0.372238).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9591787
	speed: 0.3690s/iter; left time: 5134.6663s
Epoch: 10 cost time: 14.107398748397827
Epoch: 10, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.670 Vali Acc: 0.172 Test Loss: 2.670 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4368526
	speed: 0.3593s/iter; left time: 4944.0428s
Epoch: 11 cost time: 13.691620349884033
Epoch: 11, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.292 Vali Acc: 0.356 Test Loss: 2.292 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0835869
	speed: 0.3723s/iter; left time: 5065.5514s
Epoch: 12 cost time: 14.890434980392456
Epoch: 12, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.706 Vali Acc: 0.134 Test Loss: 2.706 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4217147
	speed: 0.3703s/iter; left time: 4982.1283s
Epoch: 13 cost time: 15.092984437942505
Epoch: 13, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.229 Vali Acc: 0.371 Test Loss: 2.229 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2269700
	speed: 0.3439s/iter; left time: 4573.9867s
Epoch: 14 cost time: 12.841195821762085
Epoch: 14, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.226 Vali Acc: 0.082 Test Loss: 3.226 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.6900475
	speed: 0.3246s/iter; left time: 4267.4288s
Epoch: 15 cost time: 13.355061054229736
Epoch: 15, Steps: 154 | Train Loss: 1.497 Vali Loss: 3.425 Vali Acc: 0.187 Test Loss: 3.425 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.6161572
	speed: 0.3232s/iter; left time: 4198.6022s
Epoch: 16 cost time: 13.04940390586853
Epoch: 16, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.542 Vali Acc: 0.202 Test Loss: 2.542 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.6766568
	speed: 0.3444s/iter; left time: 4421.3706s
Epoch: 17 cost time: 15.18297553062439
Epoch: 17, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.011 Vali Acc: 0.181 Test Loss: 3.011 Test Acc: 0.181
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.1029174
	speed: 0.3677s/iter; left time: 4663.1199s
Epoch: 18 cost time: 14.83558964729309
Epoch: 18, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.809 Vali Acc: 0.116 Test Loss: 2.809 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.0843830
	speed: 0.3448s/iter; left time: 4319.6723s
Epoch: 19 cost time: 12.763796091079712
Epoch: 19, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.836 Vali Acc: 0.197 Test Loss: 2.836 Test Acc: 0.197
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 2677298
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4692488
	speed: 0.1286s/iter; left time: 1967.7077s
Epoch: 1 cost time: 17.659600734710693
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.211 Vali Acc: 0.315 Test Loss: 2.211 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2543314
	speed: 0.3669s/iter; left time: 5556.7304s
Epoch: 2 cost time: 13.249011278152466
Epoch: 2, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.223 Vali Acc: 0.316 Test Loss: 2.223 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9956465
	speed: 0.3404s/iter; left time: 5103.6153s
Epoch: 3 cost time: 13.007368803024292
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.075 Vali Acc: 0.341 Test Loss: 2.075 Test Acc: 0.341
Validation loss decreased (-0.315874 --> -0.341423).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6998105
	speed: 0.3754s/iter; left time: 5570.6605s
Epoch: 4 cost time: 15.788957595825195
Epoch: 4, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.127 Vali Acc: 0.365 Test Loss: 2.127 Test Acc: 0.365
Validation loss decreased (-0.341423 --> -0.365348).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8308452
	speed: 0.3689s/iter; left time: 5417.0833s
Epoch: 5 cost time: 13.319578647613525
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.290 Vali Acc: 0.365 Test Loss: 2.290 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8850982
	speed: 0.3615s/iter; left time: 5252.6615s
Epoch: 6 cost time: 15.592242002487183
Epoch: 6, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.326 Vali Acc: 0.366 Test Loss: 2.326 Test Acc: 0.366
Validation loss decreased (-0.365348 --> -0.365751).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5996270
	speed: 0.3757s/iter; left time: 5402.0875s
Epoch: 7 cost time: 13.986030578613281
Epoch: 7, Steps: 154 | Train Loss: 1.631 Vali Loss: 3.045 Vali Acc: 0.189 Test Loss: 3.045 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4881436
	speed: 0.3621s/iter; left time: 5149.6536s
Epoch: 8 cost time: 15.312237024307251
Epoch: 8, Steps: 154 | Train Loss: 1.578 Vali Loss: 3.204 Vali Acc: 0.173 Test Loss: 3.204 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1643971
	speed: 0.3685s/iter; left time: 5183.7364s
Epoch: 9 cost time: 13.241019487380981
Epoch: 9, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.374 Vali Acc: 0.364 Test Loss: 2.374 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1502347
	speed: 0.3536s/iter; left time: 4919.7845s
Epoch: 10 cost time: 14.143305778503418
Epoch: 10, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.764 Vali Acc: 0.206 Test Loss: 2.764 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6704826
	speed: 0.3645s/iter; left time: 5016.1427s
Epoch: 11 cost time: 13.364256858825684
Epoch: 11, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.757 Vali Acc: 0.215 Test Loss: 2.757 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2907343
	speed: 0.3559s/iter; left time: 4842.6224s
Epoch: 12 cost time: 13.532635688781738
Epoch: 12, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.858 Vali Acc: 0.202 Test Loss: 2.858 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7235224
	speed: 0.3637s/iter; left time: 4892.9876s
Epoch: 13 cost time: 14.428759813308716
Epoch: 13, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.536 Vali Acc: 0.208 Test Loss: 2.536 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4483876
	speed: 0.3130s/iter; left time: 4162.4883s
Epoch: 14 cost time: 13.654891967773438
Epoch: 14, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.819 Vali Acc: 0.373 Test Loss: 2.819 Test Acc: 0.373
Validation loss decreased (-0.365751 --> -0.373451).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.5682747
	speed: 0.3435s/iter; left time: 4515.5304s
Epoch: 15 cost time: 12.977111339569092
Epoch: 15, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.802 Vali Acc: 0.119 Test Loss: 2.802 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.0616004
	speed: 0.3310s/iter; left time: 4300.5563s
Epoch: 16 cost time: 12.703869819641113
Epoch: 16, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.456 Vali Acc: 0.367 Test Loss: 2.456 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5525945
	speed: 0.3367s/iter; left time: 4321.9424s
Epoch: 17 cost time: 13.550384998321533
Epoch: 17, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.700 Vali Acc: 0.208 Test Loss: 2.700 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.6713315
	speed: 0.3599s/iter; left time: 4565.1335s
Epoch: 18 cost time: 14.406023502349854
Epoch: 18, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.405 Vali Acc: 0.090 Test Loss: 3.405 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.2578757
	speed: 0.4038s/iter; left time: 5059.8079s
Epoch: 19 cost time: 15.97167181968689
Epoch: 19, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.940 Vali Acc: 0.127 Test Loss: 2.940 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.4784327
	speed: 0.3544s/iter; left time: 4385.7979s
Epoch: 20 cost time: 14.364575147628784
Epoch: 20, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.553 Vali Acc: 0.139 Test Loss: 2.553 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.4504434
	speed: 0.3848s/iter; left time: 4702.5087s
Epoch: 21 cost time: 16.162402153015137
Epoch: 21, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.580 Vali Acc: 0.146 Test Loss: 2.580 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.2558517
	speed: 0.3498s/iter; left time: 4220.5863s
Epoch: 22 cost time: 12.83385419845581
Epoch: 22, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.847 Vali Acc: 0.138 Test Loss: 2.847 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.7633209
	speed: 0.3239s/iter; left time: 3858.3001s
Epoch: 23 cost time: 13.521455526351929
Epoch: 23, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.439 Vali Acc: 0.131 Test Loss: 2.439 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.9826193
	speed: 0.3571s/iter; left time: 4198.6694s
Epoch: 24 cost time: 13.757774591445923
Epoch: 24, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.708 Vali Acc: 0.288 Test Loss: 2.708 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 2676658
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5646737
	speed: 0.1219s/iter; left time: 1865.7926s
Epoch: 1 cost time: 17.39430069923401
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.315 Vali Acc: 0.315 Test Loss: 2.315 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5940999
	speed: 0.3775s/iter; left time: 5718.0605s
Epoch: 2 cost time: 14.387529611587524
Epoch: 2, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.200 Vali Acc: 0.330 Test Loss: 2.200 Test Acc: 0.330
Validation loss decreased (-0.315062 --> -0.329662).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1459613
	speed: 0.3528s/iter; left time: 5289.6743s
Epoch: 3 cost time: 14.699876308441162
Epoch: 3, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.112 Vali Acc: 0.356 Test Loss: 2.112 Test Acc: 0.356
Validation loss decreased (-0.329662 --> -0.356427).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6902773
	speed: 0.3727s/iter; left time: 5529.8468s
Epoch: 4 cost time: 15.156487464904785
Epoch: 4, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.027 Vali Acc: 0.362 Test Loss: 2.027 Test Acc: 0.362
Validation loss decreased (-0.356427 --> -0.362105).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5093576
	speed: 0.3784s/iter; left time: 5556.2141s
Epoch: 5 cost time: 15.190791368484497
Epoch: 5, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.417 Vali Acc: 0.366 Test Loss: 2.417 Test Acc: 0.366
Validation loss decreased (-0.362105 --> -0.366156).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5081608
	speed: 0.3635s/iter; left time: 5281.2950s
Epoch: 6 cost time: 14.75381088256836
Epoch: 6, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.422 Vali Acc: 0.358 Test Loss: 2.422 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6421844
	speed: 0.3460s/iter; left time: 4974.7588s
Epoch: 7 cost time: 14.213624715805054
Epoch: 7, Steps: 154 | Train Loss: 1.595 Vali Loss: 3.524 Vali Acc: 0.104 Test Loss: 3.524 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3220443
	speed: 0.3583s/iter; left time: 5096.3938s
Epoch: 8 cost time: 12.782184362411499
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.838 Vali Acc: 0.372 Test Loss: 2.838 Test Acc: 0.372
Validation loss decreased (-0.366156 --> -0.371829).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1194426
	speed: 0.3318s/iter; left time: 4667.6190s
Epoch: 9 cost time: 13.184066534042358
Epoch: 9, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.472 Vali Acc: 0.201 Test Loss: 2.472 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2375360
	speed: 0.3275s/iter; left time: 4556.5674s
Epoch: 10 cost time: 15.339447736740112
Epoch: 10, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.377 Vali Acc: 0.225 Test Loss: 2.377 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3997788
	speed: 0.3287s/iter; left time: 4523.1782s
Epoch: 11 cost time: 12.538431644439697
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.353 Vali Acc: 0.200 Test Loss: 2.353 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7329155
	speed: 0.3371s/iter; left time: 4587.1225s
Epoch: 12 cost time: 13.732045888900757
Epoch: 12, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.380 Vali Acc: 0.229 Test Loss: 2.380 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.8223698
	speed: 0.3261s/iter; left time: 4386.5515s
Epoch: 13 cost time: 12.873241662979126
Epoch: 13, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.571 Vali Acc: 0.195 Test Loss: 2.571 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6321992
	speed: 0.3501s/iter; left time: 4656.1570s
Epoch: 14 cost time: 12.750266075134277
Epoch: 14, Steps: 154 | Train Loss: 1.519 Vali Loss: 4.128 Vali Acc: 0.101 Test Loss: 4.128 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0125824
	speed: 0.3677s/iter; left time: 4833.5136s
Epoch: 15 cost time: 16.14755415916443
Epoch: 15, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.717 Vali Acc: 0.126 Test Loss: 2.717 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1826483
	speed: 0.3734s/iter; left time: 4850.8247s
Epoch: 16 cost time: 13.649560689926147
Epoch: 16, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.612 Vali Acc: 0.122 Test Loss: 2.612 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.4925210
	speed: 0.3426s/iter; left time: 4398.3104s
Epoch: 17 cost time: 12.830470561981201
Epoch: 17, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.609 Vali Acc: 0.205 Test Loss: 2.609 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3817869
	speed: 0.3641s/iter; left time: 4617.5393s
Epoch: 18 cost time: 14.637080192565918
Epoch: 18, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.353 Vali Acc: 0.381 Test Loss: 2.353 Test Acc: 0.381
Validation loss decreased (-0.371829 --> -0.381161).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8262653
	speed: 0.3516s/iter; left time: 4405.1508s
Epoch: 19 cost time: 12.894093751907349
Epoch: 19, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.874 Vali Acc: 0.083 Test Loss: 2.874 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5405147
	speed: 0.3430s/iter; left time: 4244.8689s
Epoch: 20 cost time: 13.853326082229614
Epoch: 20, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.519 Vali Acc: 0.206 Test Loss: 2.519 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4775997
	speed: 0.3584s/iter; left time: 4380.2084s
Epoch: 21 cost time: 14.065064668655396
Epoch: 21, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.489 Vali Acc: 0.385 Test Loss: 2.489 Test Acc: 0.385
Validation loss decreased (-0.381161 --> -0.385214).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2854149
	speed: 0.3647s/iter; left time: 4400.8975s
Epoch: 22 cost time: 12.028950214385986
Epoch: 22, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.906 Vali Acc: 0.178 Test Loss: 2.906 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6980793
	speed: 0.3283s/iter; left time: 3911.5140s
Epoch: 23 cost time: 12.92444133758545
Epoch: 23, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.435 Vali Acc: 0.362 Test Loss: 2.435 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.5678000
	speed: 0.3558s/iter; left time: 4183.9977s
Epoch: 24 cost time: 14.141544818878174
Epoch: 24, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.579 Vali Acc: 0.384 Test Loss: 2.579 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.3298361
	speed: 0.3590s/iter; left time: 4166.5096s
Epoch: 25 cost time: 14.402091026306152
Epoch: 25, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.555 Vali Acc: 0.127 Test Loss: 2.555 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.8992749
	speed: 0.3603s/iter; left time: 4126.0951s
Epoch: 26 cost time: 14.8194739818573
Epoch: 26, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.374 Vali Acc: 0.331 Test Loss: 2.374 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.3319722
	speed: 0.3548s/iter; left time: 4007.7061s
Epoch: 27 cost time: 15.256938219070435
Epoch: 27, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.425 Vali Acc: 0.212 Test Loss: 2.425 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.9836146
	speed: 0.3553s/iter; left time: 3959.1084s
Epoch: 28 cost time: 12.836807012557983
Epoch: 28, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.941 Vali Acc: 0.196 Test Loss: 2.941 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.1501607
	speed: 0.3403s/iter; left time: 3739.3658s
Epoch: 29 cost time: 13.387391090393066
Epoch: 29, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.632 Vali Acc: 0.191 Test Loss: 2.632 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.5724283
	speed: 0.3437s/iter; left time: 3724.4382s
Epoch: 30 cost time: 13.817886114120483
Epoch: 30, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.702 Vali Acc: 0.367 Test Loss: 2.702 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.8297179
	speed: 0.3285s/iter; left time: 3508.6218s
Epoch: 31 cost time: 12.290689468383789
Epoch: 31, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.298 Vali Acc: 0.375 Test Loss: 2.298 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 2676018
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5294802
	speed: 0.1294s/iter; left time: 1980.0714s
Epoch: 1 cost time: 18.153100967407227
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.228 Vali Acc: 0.315 Test Loss: 2.228 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1245685
	speed: 0.3485s/iter; left time: 5278.6630s
Epoch: 2 cost time: 12.163764953613281
Epoch: 2, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.180 Vali Acc: 0.324 Test Loss: 2.180 Test Acc: 0.324
Validation loss decreased (-0.315063 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8748094
	speed: 0.3425s/iter; left time: 5135.2389s
Epoch: 3 cost time: 13.954756736755371
Epoch: 3, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.225 Vali Acc: 0.339 Test Loss: 2.225 Test Acc: 0.339
Validation loss decreased (-0.323579 --> -0.338988).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6624616
	speed: 0.3512s/iter; left time: 5212.1972s
Epoch: 4 cost time: 13.693118333816528
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.436 Vali Acc: 0.176 Test Loss: 2.436 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6591113
	speed: 0.3404s/iter; left time: 4999.0074s
Epoch: 5 cost time: 12.431217908859253
Epoch: 5, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.299 Vali Acc: 0.363 Test Loss: 2.299 Test Acc: 0.363
Validation loss decreased (-0.338988 --> -0.362913).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4114364
	speed: 0.3468s/iter; left time: 5039.1012s
Epoch: 6 cost time: 13.239020586013794
Epoch: 6, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.173 Vali Acc: 0.228 Test Loss: 2.173 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5710365
	speed: 0.3222s/iter; left time: 4631.5693s
Epoch: 7 cost time: 13.509633541107178
Epoch: 7, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.579 Vali Acc: 0.207 Test Loss: 2.579 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3039761
	speed: 0.3477s/iter; left time: 4945.0185s
Epoch: 8 cost time: 12.554322719573975
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.642 Vali Acc: 0.390 Test Loss: 2.642 Test Acc: 0.390
Validation loss decreased (-0.362913 --> -0.390079).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8336532
	speed: 0.3230s/iter; left time: 4543.7617s
Epoch: 9 cost time: 12.77079176902771
Epoch: 9, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.544 Vali Acc: 0.393 Test Loss: 2.544 Test Acc: 0.393
Validation loss decreased (-0.390079 --> -0.392513).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5351152
	speed: 0.3195s/iter; left time: 4446.3536s
Epoch: 10 cost time: 13.44612741470337
Epoch: 10, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.428 Vali Acc: 0.396 Test Loss: 2.428 Test Acc: 0.396
Validation loss decreased (-0.392513 --> -0.396164).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3267595
	speed: 0.3635s/iter; left time: 5001.5942s
Epoch: 11 cost time: 13.771045207977295
Epoch: 11, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.656 Vali Acc: 0.177 Test Loss: 2.656 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3495646
	speed: 0.3393s/iter; left time: 4616.2414s
Epoch: 12 cost time: 12.715056657791138
Epoch: 12, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.360 Vali Acc: 0.202 Test Loss: 2.360 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0230005
	speed: 0.3162s/iter; left time: 4253.7502s
Epoch: 13 cost time: 12.185797452926636
Epoch: 13, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.862 Vali Acc: 0.177 Test Loss: 3.862 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2239056
	speed: 0.3346s/iter; left time: 4449.5844s
Epoch: 14 cost time: 13.725327014923096
Epoch: 14, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.587 Vali Acc: 0.246 Test Loss: 2.587 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5212204
	speed: 0.3467s/iter; left time: 4557.9896s
Epoch: 15 cost time: 14.323335409164429
Epoch: 15, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.305 Vali Acc: 0.236 Test Loss: 2.305 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4179779
	speed: 0.3509s/iter; left time: 4558.0110s
Epoch: 16 cost time: 13.854113101959229
Epoch: 16, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.584 Vali Acc: 0.392 Test Loss: 2.584 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7236282
	speed: 0.3559s/iter; left time: 4569.0378s
Epoch: 17 cost time: 12.929352283477783
Epoch: 17, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.108 Vali Acc: 0.114 Test Loss: 3.108 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3812279
	speed: 0.3363s/iter; left time: 4265.0803s
Epoch: 18 cost time: 12.905738830566406
Epoch: 18, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.600 Vali Acc: 0.296 Test Loss: 2.600 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.8833661
	speed: 0.2905s/iter; left time: 3639.2272s
Epoch: 19 cost time: 12.65562915802002
Epoch: 19, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.413 Vali Acc: 0.365 Test Loss: 2.413 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2629837
	speed: 0.3173s/iter; left time: 3926.5391s
Epoch: 20 cost time: 12.9561927318573
Epoch: 20, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.147 Vali Acc: 0.116 Test Loss: 3.147 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3961881589618816
model parameter : 2020018
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0920773
	speed: 0.0993s/iter; left time: 1518.9952s
Epoch: 1 cost time: 13.901029109954834
Epoch: 1, Steps: 154 | Train Loss: 2.271 Vali Loss: 2.263 Vali Acc: 0.315 Test Loss: 2.263 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9861234
	speed: 0.2971s/iter; left time: 4499.9164s
Epoch: 2 cost time: 12.008515357971191
Epoch: 2, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.213 Vali Acc: 0.320 Test Loss: 2.213 Test Acc: 0.320
Validation loss decreased (-0.315063 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8046038
	speed: 0.2798s/iter; left time: 4194.3539s
Epoch: 3 cost time: 11.207324981689453
Epoch: 3, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.229 Vali Acc: 0.177 Test Loss: 2.229 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5819082
	speed: 0.2898s/iter; left time: 4300.7650s
Epoch: 4 cost time: 11.74683427810669
Epoch: 4, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.242 Vali Acc: 0.350 Test Loss: 2.242 Test Acc: 0.350
Validation loss decreased (-0.320335 --> -0.350343).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0320370
	speed: 0.2960s/iter; left time: 4346.4781s
Epoch: 5 cost time: 11.126240730285645
Epoch: 5, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.376 Vali Acc: 0.354 Test Loss: 2.376 Test Acc: 0.354
Validation loss decreased (-0.350343 --> -0.353585).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2448241
	speed: 0.2916s/iter; left time: 4236.8148s
Epoch: 6 cost time: 11.800255298614502
Epoch: 6, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.905 Vali Acc: 0.105 Test Loss: 2.905 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4491607
	speed: 0.2867s/iter; left time: 4122.4797s
Epoch: 7 cost time: 11.358616352081299
Epoch: 7, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.251 Vali Acc: 0.364 Test Loss: 2.251 Test Acc: 0.364
Validation loss decreased (-0.353585 --> -0.363724).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6466427
	speed: 0.2788s/iter; left time: 3965.5089s
Epoch: 8 cost time: 10.661312341690063
Epoch: 8, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.600 Vali Acc: 0.187 Test Loss: 2.600 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4972121
	speed: 0.3436s/iter; left time: 4834.3103s
Epoch: 9 cost time: 15.250432968139648
Epoch: 9, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.730 Vali Acc: 0.361 Test Loss: 2.730 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6295795
	speed: 0.3719s/iter; left time: 5174.4932s
Epoch: 10 cost time: 15.997804403305054
Epoch: 10, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.571 Vali Acc: 0.208 Test Loss: 2.571 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9949002
	speed: 0.3736s/iter; left time: 5140.6383s
Epoch: 11 cost time: 13.107369899749756
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.389 Vali Acc: 0.394 Test Loss: 2.389 Test Acc: 0.394
Validation loss decreased (-0.363724 --> -0.394137).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7925141
	speed: 0.3515s/iter; left time: 4783.0274s
Epoch: 12 cost time: 13.553823947906494
Epoch: 12, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.195 Vali Acc: 0.382 Test Loss: 2.195 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5098245
	speed: 0.3469s/iter; left time: 4667.4997s
Epoch: 13 cost time: 13.590417623519897
Epoch: 13, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.755 Vali Acc: 0.189 Test Loss: 2.755 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3145833
	speed: 0.3506s/iter; left time: 4663.0354s
Epoch: 14 cost time: 14.514163494110107
Epoch: 14, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.658 Vali Acc: 0.337 Test Loss: 2.658 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4007775
	speed: 0.3829s/iter; left time: 5033.3700s
Epoch: 15 cost time: 15.899724245071411
Epoch: 15, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.723 Vali Acc: 0.129 Test Loss: 2.723 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1332932
	speed: 0.3783s/iter; left time: 4914.3928s
Epoch: 16 cost time: 15.289839506149292
Epoch: 16, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.836 Vali Acc: 0.123 Test Loss: 2.836 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.3735646
	speed: 0.3636s/iter; left time: 4668.1501s
Epoch: 17 cost time: 14.353769302368164
Epoch: 17, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.791 Vali Acc: 0.125 Test Loss: 2.791 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1643304
	speed: 0.3532s/iter; left time: 4480.1980s
Epoch: 18 cost time: 11.713082790374756
Epoch: 18, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.579 Vali Acc: 0.356 Test Loss: 2.579 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4387355
	speed: 0.3314s/iter; left time: 4152.4231s
Epoch: 19 cost time: 11.408371925354004
Epoch: 19, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.623 Vali Acc: 0.152 Test Loss: 2.623 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4856335
	speed: 0.3224s/iter; left time: 3989.8368s
Epoch: 20 cost time: 12.814873456954956
Epoch: 20, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.650 Vali Acc: 0.116 Test Loss: 2.650 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.6575443
	speed: 0.3307s/iter; left time: 4041.7816s
Epoch: 21 cost time: 11.442202806472778
Epoch: 21, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.906 Vali Acc: 0.127 Test Loss: 2.906 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39416058394160586
model parameter : 2019378
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4786913
	speed: 0.0874s/iter; left time: 1337.6224s
Epoch: 1 cost time: 12.840420484542847
Epoch: 1, Steps: 154 | Train Loss: 2.260 Vali Loss: 2.282 Vali Acc: 0.315 Test Loss: 2.282 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5945501
	speed: 0.3111s/iter; left time: 4711.9620s
Epoch: 2 cost time: 11.852192401885986
Epoch: 2, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.194 Vali Acc: 0.319 Test Loss: 2.194 Test Acc: 0.319
Validation loss decreased (-0.315062 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1531465
	speed: 0.2839s/iter; left time: 4256.5450s
Epoch: 3 cost time: 11.228473901748657
Epoch: 3, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.259 Vali Acc: 0.333 Test Loss: 2.259 Test Acc: 0.333
Validation loss decreased (-0.318713 --> -0.332905).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5362315
	speed: 0.2741s/iter; left time: 4067.3409s
Epoch: 4 cost time: 10.82746934890747
Epoch: 4, Steps: 154 | Train Loss: 1.941 Vali Loss: 2.047 Vali Acc: 0.355 Test Loss: 2.047 Test Acc: 0.355
Validation loss decreased (-0.332905 --> -0.354805).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1331518
	speed: 0.2596s/iter; left time: 3812.4263s
Epoch: 5 cost time: 11.307797908782959
Epoch: 5, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.378 Vali Acc: 0.183 Test Loss: 2.378 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3643472
	speed: 0.2976s/iter; left time: 4324.9004s
Epoch: 6 cost time: 12.206459283828735
Epoch: 6, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.409 Vali Acc: 0.195 Test Loss: 2.409 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7318239
	speed: 0.2753s/iter; left time: 3957.9606s
Epoch: 7 cost time: 10.786026239395142
Epoch: 7, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.141 Vali Acc: 0.349 Test Loss: 2.141 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.9296967
	speed: 0.2741s/iter; left time: 3898.6671s
Epoch: 8 cost time: 12.169738292694092
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.350 Vali Acc: 0.392 Test Loss: 2.350 Test Acc: 0.392
Validation loss decreased (-0.354805 --> -0.392110).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5881360
	speed: 0.2990s/iter; left time: 4207.1153s
Epoch: 9 cost time: 13.028831481933594
Epoch: 9, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.922 Vali Acc: 0.205 Test Loss: 2.922 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0979729
	speed: 0.3006s/iter; left time: 4182.7671s
Epoch: 10 cost time: 12.52844500541687
Epoch: 10, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.507 Vali Acc: 0.214 Test Loss: 2.507 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4026105
	speed: 0.2952s/iter; left time: 4061.8623s
Epoch: 11 cost time: 10.677216053009033
Epoch: 11, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.731 Vali Acc: 0.203 Test Loss: 2.731 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7066312
	speed: 0.2759s/iter; left time: 3754.6443s
Epoch: 12 cost time: 11.663496255874634
Epoch: 12, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.926 Vali Acc: 0.208 Test Loss: 2.926 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.4365523
	speed: 0.2704s/iter; left time: 3637.3127s
Epoch: 13 cost time: 11.114694356918335
Epoch: 13, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.452 Vali Acc: 0.358 Test Loss: 2.452 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6302389
	speed: 0.2901s/iter; left time: 3858.0363s
Epoch: 14 cost time: 11.869096040725708
Epoch: 14, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.042 Vali Acc: 0.069 Test Loss: 3.042 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.8855348
	speed: 0.2962s/iter; left time: 3893.8241s
Epoch: 15 cost time: 11.851634502410889
Epoch: 15, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.409 Vali Acc: 0.380 Test Loss: 2.409 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3309636
	speed: 0.2700s/iter; left time: 3508.0916s
Epoch: 16 cost time: 10.231362581253052
Epoch: 16, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.724 Vali Acc: 0.191 Test Loss: 2.724 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.9456104
	speed: 0.2669s/iter; left time: 3426.3140s
Epoch: 17 cost time: 11.169035196304321
Epoch: 17, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.271 Vali Acc: 0.373 Test Loss: 2.271 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3960087
	speed: 0.2592s/iter; left time: 3286.9593s
Epoch: 18 cost time: 11.121846914291382
Epoch: 18, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.879 Vali Acc: 0.127 Test Loss: 2.879 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3921330089213301
model parameter : 2018738
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0992281
	speed: 0.1069s/iter; left time: 1635.0448s
Epoch: 1 cost time: 15.594624996185303
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.321 Vali Acc: 0.315 Test Loss: 2.321 Test Acc: 0.315
Validation loss decreased (inf --> -0.315467).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1079748
	speed: 0.3309s/iter; left time: 5012.1422s
Epoch: 2 cost time: 12.136976718902588
Epoch: 2, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.253 Vali Acc: 0.320 Test Loss: 2.253 Test Acc: 0.320
Validation loss decreased (-0.315467 --> -0.320334).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0939770
	speed: 0.3273s/iter; left time: 4906.5991s
Epoch: 3 cost time: 12.648424863815308
Epoch: 3, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.111 Vali Acc: 0.343 Test Loss: 2.111 Test Acc: 0.343
Validation loss decreased (-0.320334 --> -0.343045).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2385163
	speed: 0.3260s/iter; left time: 4836.7831s
Epoch: 4 cost time: 13.587949514389038
Epoch: 4, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.184 Vali Acc: 0.182 Test Loss: 2.184 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4248919
	speed: 0.3378s/iter; left time: 4961.1762s
Epoch: 5 cost time: 12.70638632774353
Epoch: 5, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.164 Vali Acc: 0.356 Test Loss: 2.164 Test Acc: 0.356
Validation loss decreased (-0.343045 --> -0.356021).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1281883
	speed: 0.3359s/iter; left time: 4881.6205s
Epoch: 6 cost time: 13.90829348564148
Epoch: 6, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.191 Vali Acc: 0.371 Test Loss: 2.191 Test Acc: 0.371
Validation loss decreased (-0.356021 --> -0.370619).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7160881
	speed: 0.3314s/iter; left time: 4764.8810s
Epoch: 7 cost time: 12.505478382110596
Epoch: 7, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.336 Vali Acc: 0.366 Test Loss: 2.336 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2603002
	speed: 0.3450s/iter; left time: 4907.4999s
Epoch: 8 cost time: 16.34619450569153
Epoch: 8, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.366 Vali Acc: 0.250 Test Loss: 2.366 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9281220
	speed: 0.3570s/iter; left time: 5022.5403s
Epoch: 9 cost time: 13.956201553344727
Epoch: 9, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.088 Vali Acc: 0.120 Test Loss: 3.088 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3756956
	speed: 0.3527s/iter; left time: 4907.2711s
Epoch: 10 cost time: 16.146641969680786
Epoch: 10, Steps: 154 | Train Loss: 1.526 Vali Loss: 3.366 Vali Acc: 0.121 Test Loss: 3.366 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6219398
	speed: 0.3132s/iter; left time: 4310.5674s
Epoch: 11 cost time: 12.725048542022705
Epoch: 11, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.302 Vali Acc: 0.362 Test Loss: 2.302 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8117582
	speed: 0.3109s/iter; left time: 4230.9698s
Epoch: 12 cost time: 11.867234945297241
Epoch: 12, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.494 Vali Acc: 0.220 Test Loss: 2.494 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.9451495
	speed: 0.2993s/iter; left time: 4026.9153s
Epoch: 13 cost time: 12.250434875488281
Epoch: 13, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.750 Vali Acc: 0.152 Test Loss: 2.750 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.6838615
	speed: 0.3000s/iter; left time: 3990.3123s
Epoch: 14 cost time: 13.063704252243042
Epoch: 14, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.345 Vali Acc: 0.373 Test Loss: 2.345 Test Acc: 0.373
Validation loss decreased (-0.370619 --> -0.372645).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7577219
	speed: 0.3091s/iter; left time: 4063.3425s
Epoch: 15 cost time: 11.40061902999878
Epoch: 15, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.735 Vali Acc: 0.191 Test Loss: 2.735 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2505354
	speed: 0.3070s/iter; left time: 3987.9913s
Epoch: 16 cost time: 12.742682218551636
Epoch: 16, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.583 Vali Acc: 0.205 Test Loss: 2.583 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.0775872
	speed: 0.3225s/iter; left time: 4140.0989s
Epoch: 17 cost time: 13.046603441238403
Epoch: 17, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.048 Vali Acc: 0.200 Test Loss: 3.048 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2157135
	speed: 0.3144s/iter; left time: 3987.2734s
Epoch: 18 cost time: 11.536162376403809
Epoch: 18, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.946 Vali Acc: 0.201 Test Loss: 2.946 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5122056
	speed: 0.3046s/iter; left time: 3816.9342s
Epoch: 19 cost time: 12.015658855438232
Epoch: 19, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.974 Vali Acc: 0.202 Test Loss: 2.974 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.2004515
	speed: 0.3080s/iter; left time: 3811.4594s
Epoch: 20 cost time: 12.61807131767273
Epoch: 20, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.723 Vali Acc: 0.127 Test Loss: 2.723 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9049551
	speed: 0.3222s/iter; left time: 3937.0352s
Epoch: 21 cost time: 13.740273475646973
Epoch: 21, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.542 Vali Acc: 0.201 Test Loss: 2.542 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.0206223
	speed: 0.3396s/iter; left time: 4098.4684s
Epoch: 22 cost time: 11.907215118408203
Epoch: 22, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.295 Vali Acc: 0.395 Test Loss: 2.295 Test Acc: 0.395
Validation loss decreased (-0.372645 --> -0.394543).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.0086976
	speed: 0.3096s/iter; left time: 3688.5251s
Epoch: 23 cost time: 12.64940881729126
Epoch: 23, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.332 Vali Acc: 0.384 Test Loss: 2.332 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.0776042
	speed: 0.3403s/iter; left time: 4001.1014s
Epoch: 24 cost time: 13.898951530456543
Epoch: 24, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.419 Vali Acc: 0.379 Test Loss: 2.419 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4678965
	speed: 0.3176s/iter; left time: 3686.0615s
Epoch: 25 cost time: 12.669032096862793
Epoch: 25, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.737 Vali Acc: 0.206 Test Loss: 2.737 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 2.0943313
	speed: 0.3188s/iter; left time: 3650.4973s
Epoch: 26 cost time: 12.32068920135498
Epoch: 26, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.777 Vali Acc: 0.172 Test Loss: 2.777 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.4931129
	speed: 0.3072s/iter; left time: 3470.5607s
Epoch: 27 cost time: 11.54711127281189
Epoch: 27, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.929 Vali Acc: 0.203 Test Loss: 2.929 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.4775741
	speed: 0.3100s/iter; left time: 3454.5467s
Epoch: 28 cost time: 12.034439325332642
Epoch: 28, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.731 Vali Acc: 0.210 Test Loss: 2.731 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.4957764
	speed: 0.2920s/iter; left time: 3208.5926s
Epoch: 29 cost time: 12.341516971588135
Epoch: 29, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.472 Vali Acc: 0.378 Test Loss: 2.472 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.2691164
	speed: 0.3323s/iter; left time: 3600.7770s
Epoch: 30 cost time: 13.356525182723999
Epoch: 30, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.254 Vali Acc: 0.307 Test Loss: 2.254 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.6183312
	speed: 0.3260s/iter; left time: 3482.1489s
Epoch: 31 cost time: 12.409107685089111
Epoch: 31, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.387 Vali Acc: 0.367 Test Loss: 2.387 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.2641325
	speed: 0.3407s/iter; left time: 3586.2395s
Epoch: 32 cost time: 13.451004266738892
Epoch: 32, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.239 Vali Acc: 0.392 Test Loss: 2.239 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39456609894566097
model parameter : 2018098
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2807837
	speed: 0.0886s/iter; left time: 1356.3732s
Epoch: 1 cost time: 12.661169290542603
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.214 Vali Acc: 0.315 Test Loss: 2.214 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5048535
	speed: 0.2757s/iter; left time: 4175.5477s
Epoch: 2 cost time: 11.464190006256104
Epoch: 2, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.235 Vali Acc: 0.318 Test Loss: 2.235 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.317901).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0100613
	speed: 0.2738s/iter; left time: 4105.7643s
Epoch: 3 cost time: 11.569422721862793
Epoch: 3, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.164 Vali Acc: 0.333 Test Loss: 2.164 Test Acc: 0.333
Validation loss decreased (-0.317901 --> -0.332906).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7572272
	speed: 0.3012s/iter; left time: 4469.0894s
Epoch: 4 cost time: 11.652889013290405
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.235 Vali Acc: 0.347 Test Loss: 2.235 Test Acc: 0.347
Validation loss decreased (-0.332906 --> -0.346693).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5584401
	speed: 0.2926s/iter; left time: 4296.8082s
Epoch: 5 cost time: 11.270636081695557
Epoch: 5, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.374 Vali Acc: 0.192 Test Loss: 2.374 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5470217
	speed: 0.2874s/iter; left time: 4175.6330s
Epoch: 6 cost time: 11.141245603561401
Epoch: 6, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.456 Vali Acc: 0.351 Test Loss: 2.456 Test Acc: 0.351
Validation loss decreased (-0.346693 --> -0.350746).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2169496
	speed: 0.2865s/iter; left time: 4119.2353s
Epoch: 7 cost time: 12.116842031478882
Epoch: 7, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.263 Vali Acc: 0.373 Test Loss: 2.263 Test Acc: 0.373
Validation loss decreased (-0.350746 --> -0.373457).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6781662
	speed: 0.3135s/iter; left time: 4459.0439s
Epoch: 8 cost time: 12.034049034118652
Epoch: 8, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.423 Vali Acc: 0.363 Test Loss: 2.423 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4678071
	speed: 0.3123s/iter; left time: 4393.5296s
Epoch: 9 cost time: 12.252543926239014
Epoch: 9, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.656 Vali Acc: 0.201 Test Loss: 2.656 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7299465
	speed: 0.2913s/iter; left time: 4052.8448s
Epoch: 10 cost time: 10.434929370880127
Epoch: 10, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.540 Vali Acc: 0.222 Test Loss: 2.540 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2301855
	speed: 0.2750s/iter; left time: 3784.4607s
Epoch: 11 cost time: 11.77791452407837
Epoch: 11, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.015 Vali Acc: 0.133 Test Loss: 3.015 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1762209
	speed: 0.2829s/iter; left time: 3848.9896s
Epoch: 12 cost time: 10.918407917022705
Epoch: 12, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.135 Vali Acc: 0.074 Test Loss: 3.135 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4542987
	speed: 0.2737s/iter; left time: 3682.3445s
Epoch: 13 cost time: 11.309183120727539
Epoch: 13, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.476 Vali Acc: 0.205 Test Loss: 2.476 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.8979746
	speed: 0.2711s/iter; left time: 3605.1083s
Epoch: 14 cost time: 11.002183437347412
Epoch: 14, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.796 Vali Acc: 0.144 Test Loss: 2.796 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.7396969
	speed: 0.2744s/iter; left time: 3606.7883s
Epoch: 15 cost time: 11.389277458190918
Epoch: 15, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.923 Vali Acc: 0.125 Test Loss: 2.923 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.8257903
	speed: 0.2661s/iter; left time: 3456.6795s
Epoch: 16 cost time: 10.733935832977295
Epoch: 16, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.134 Vali Acc: 0.116 Test Loss: 3.134 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.4771686
	speed: 0.2597s/iter; left time: 3333.5904s
Epoch: 17 cost time: 12.242273092269897
Epoch: 17, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.755 Vali Acc: 0.124 Test Loss: 2.755 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 1691058
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0566294
	speed: 0.0847s/iter; left time: 1296.5929s
Epoch: 1 cost time: 12.050600051879883
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.180 Vali Acc: 0.316 Test Loss: 2.180 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9138136
	speed: 0.2656s/iter; left time: 4022.3501s
Epoch: 2 cost time: 10.136776208877563
Epoch: 2, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.445 Vali Acc: 0.116 Test Loss: 2.445 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9065393
	speed: 0.2711s/iter; left time: 4064.9339s
Epoch: 3 cost time: 10.660298109054565
Epoch: 3, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.254 Vali Acc: 0.169 Test Loss: 2.254 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4466780
	speed: 0.2635s/iter; left time: 3910.2036s
Epoch: 4 cost time: 10.465032577514648
Epoch: 4, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.353 Vali Acc: 0.187 Test Loss: 2.353 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6497781
	speed: 0.2692s/iter; left time: 3953.3622s
Epoch: 5 cost time: 11.027753591537476
Epoch: 5, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.603 Vali Acc: 0.350 Test Loss: 2.603 Test Acc: 0.350
Validation loss decreased (-0.315874 --> -0.349933).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4477350
	speed: 0.2830s/iter; left time: 4112.1078s
Epoch: 6 cost time: 11.452527284622192
Epoch: 6, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.194 Vali Acc: 0.218 Test Loss: 2.194 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6080667
	speed: 0.2789s/iter; left time: 4009.2876s
Epoch: 7 cost time: 11.793235778808594
Epoch: 7, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.638 Vali Acc: 0.197 Test Loss: 2.638 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6724150
	speed: 0.2745s/iter; left time: 3904.0339s
Epoch: 8 cost time: 11.626708030700684
Epoch: 8, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.513 Vali Acc: 0.211 Test Loss: 2.513 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5032723
	speed: 0.2989s/iter; left time: 4205.5666s
Epoch: 9 cost time: 13.108670234680176
Epoch: 9, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.711 Vali Acc: 0.130 Test Loss: 2.711 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.9896851
	speed: 0.2708s/iter; left time: 3767.6972s
Epoch: 10 cost time: 11.667960166931152
Epoch: 10, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.891 Vali Acc: 0.071 Test Loss: 2.891 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.9827473
	speed: 0.2886s/iter; left time: 3971.8911s
Epoch: 11 cost time: 11.783122777938843
Epoch: 11, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.404 Vali Acc: 0.195 Test Loss: 2.404 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5045301
	speed: 0.2772s/iter; left time: 3771.2479s
Epoch: 12 cost time: 11.834064722061157
Epoch: 12, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.671 Vali Acc: 0.399 Test Loss: 2.671 Test Acc: 0.399
Validation loss decreased (-0.349933 --> -0.398595).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5179718
	speed: 0.2907s/iter; left time: 3910.9957s
Epoch: 13 cost time: 10.963933229446411
Epoch: 13, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.176 Vali Acc: 0.112 Test Loss: 3.176 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9078265
	speed: 0.2780s/iter; left time: 3696.8135s
Epoch: 14 cost time: 11.357815742492676
Epoch: 14, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.616 Vali Acc: 0.375 Test Loss: 2.616 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2492944
	speed: 0.2982s/iter; left time: 3919.3554s
Epoch: 15 cost time: 11.81599497795105
Epoch: 15, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.353 Vali Acc: 0.234 Test Loss: 2.353 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.0052001
	speed: 0.2984s/iter; left time: 3876.4485s
Epoch: 16 cost time: 11.846116065979004
Epoch: 16, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.193 Vali Acc: 0.136 Test Loss: 3.193 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3288431
	speed: 0.2779s/iter; left time: 3566.9016s
Epoch: 17 cost time: 10.468931674957275
Epoch: 17, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.469 Vali Acc: 0.362 Test Loss: 2.469 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1624583
	speed: 0.2601s/iter; left time: 3299.0972s
Epoch: 18 cost time: 9.918059587478638
Epoch: 18, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.004 Vali Acc: 0.140 Test Loss: 3.004 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.6781584
	speed: 0.2441s/iter; left time: 3057.7591s
Epoch: 19 cost time: 9.910791635513306
Epoch: 19, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.206 Vali Acc: 0.118 Test Loss: 3.206 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.5401683
	speed: 0.2671s/iter; left time: 3304.9494s
Epoch: 20 cost time: 10.194308042526245
Epoch: 20, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.452 Vali Acc: 0.204 Test Loss: 2.452 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3541791
	speed: 0.2765s/iter; left time: 3378.9261s
Epoch: 21 cost time: 10.602450609207153
Epoch: 21, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.157 Vali Acc: 0.197 Test Loss: 3.157 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3061764
	speed: 0.2714s/iter; left time: 3275.1417s
Epoch: 22 cost time: 9.956907987594604
Epoch: 22, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.607 Vali Acc: 0.201 Test Loss: 2.607 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3986212489862125
model parameter : 1690418
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8479499
	speed: 0.0961s/iter; left time: 1470.2574s
Epoch: 1 cost time: 12.851904153823853
Epoch: 1, Steps: 154 | Train Loss: 2.210 Vali Loss: 2.243 Vali Acc: 0.315 Test Loss: 2.243 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9576817
	speed: 0.2565s/iter; left time: 3884.6168s
Epoch: 2 cost time: 11.376081466674805
Epoch: 2, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.196 Vali Acc: 0.324 Test Loss: 2.196 Test Acc: 0.324
Validation loss decreased (-0.315468 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7965558
	speed: 0.2905s/iter; left time: 4355.7152s
Epoch: 3 cost time: 11.647417783737183
Epoch: 3, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.229 Vali Acc: 0.328 Test Loss: 2.229 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2450078
	speed: 0.3096s/iter; left time: 4594.8796s
Epoch: 4 cost time: 11.688261985778809
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.313 Vali Acc: 0.333 Test Loss: 2.313 Test Acc: 0.333
Validation loss decreased (-0.328445 --> -0.332905).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8579434
	speed: 0.2934s/iter; left time: 4308.1503s
Epoch: 5 cost time: 11.635923385620117
Epoch: 5, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.373 Vali Acc: 0.151 Test Loss: 2.373 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9407105
	speed: 0.2735s/iter; left time: 3974.1485s
Epoch: 6 cost time: 11.833748817443848
Epoch: 6, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.320 Vali Acc: 0.368 Test Loss: 2.320 Test Acc: 0.368
Validation loss decreased (-0.332905 --> -0.368184).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1961586
	speed: 0.2848s/iter; left time: 4094.2991s
Epoch: 7 cost time: 11.453720569610596
Epoch: 7, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.923 Vali Acc: 0.201 Test Loss: 2.923 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3514681
	speed: 0.2908s/iter; left time: 4136.5313s
Epoch: 8 cost time: 12.066004991531372
Epoch: 8, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.719 Vali Acc: 0.206 Test Loss: 2.719 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8498554
	speed: 0.2830s/iter; left time: 3981.7105s
Epoch: 9 cost time: 11.301501512527466
Epoch: 9, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.455 Vali Acc: 0.189 Test Loss: 2.455 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5567496
	speed: 0.2716s/iter; left time: 3779.3470s
Epoch: 10 cost time: 10.703259706497192
Epoch: 10, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.069 Vali Acc: 0.139 Test Loss: 3.069 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5107021
	speed: 0.2647s/iter; left time: 3642.5433s
Epoch: 11 cost time: 10.93161916732788
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.605 Vali Acc: 0.162 Test Loss: 2.605 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5839477
	speed: 0.2774s/iter; left time: 3774.2758s
Epoch: 12 cost time: 11.216545820236206
Epoch: 12, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.427 Vali Acc: 0.370 Test Loss: 2.427 Test Acc: 0.370
Validation loss decreased (-0.368184 --> -0.370211).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2888813
	speed: 0.2665s/iter; left time: 3585.6543s
Epoch: 13 cost time: 10.977094888687134
Epoch: 13, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.562 Vali Acc: 0.382 Test Loss: 2.562 Test Acc: 0.382
Validation loss decreased (-0.370211 --> -0.382375).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9541976
	speed: 0.2839s/iter; left time: 3775.3160s
Epoch: 14 cost time: 10.69947099685669
Epoch: 14, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.543 Vali Acc: 0.209 Test Loss: 2.543 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9326354
	speed: 0.2591s/iter; left time: 3405.6919s
Epoch: 15 cost time: 11.538339614868164
Epoch: 15, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.685 Vali Acc: 0.354 Test Loss: 2.685 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9522287
	speed: 0.2731s/iter; left time: 3547.6757s
Epoch: 16 cost time: 10.458047151565552
Epoch: 16, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.642 Vali Acc: 0.165 Test Loss: 2.642 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3839067
	speed: 0.2742s/iter; left time: 3519.5494s
Epoch: 17 cost time: 10.941110849380493
Epoch: 17, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.639 Vali Acc: 0.383 Test Loss: 2.639 Test Acc: 0.383
Validation loss decreased (-0.382375 --> -0.383185).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1465224
	speed: 0.2837s/iter; left time: 3598.0939s
Epoch: 18 cost time: 10.907307624816895
Epoch: 18, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.237 Vali Acc: 0.366 Test Loss: 2.237 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.7495130
	speed: 0.2793s/iter; left time: 3499.1760s
Epoch: 19 cost time: 11.03511667251587
Epoch: 19, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.647 Vali Acc: 0.078 Test Loss: 2.647 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4313079
	speed: 0.2944s/iter; left time: 3642.6270s
Epoch: 20 cost time: 11.294208765029907
Epoch: 20, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.740 Vali Acc: 0.367 Test Loss: 2.740 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3460771
	speed: 0.2767s/iter; left time: 3381.1501s
Epoch: 21 cost time: 11.161394596099854
Epoch: 21, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.842 Vali Acc: 0.086 Test Loss: 2.842 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.2831911
	speed: 0.2922s/iter; left time: 3526.2075s
Epoch: 22 cost time: 10.842385292053223
Epoch: 22, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.931 Vali Acc: 0.213 Test Loss: 2.931 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3764307
	speed: 0.2720s/iter; left time: 3240.2694s
Epoch: 23 cost time: 10.476455688476562
Epoch: 23, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.746 Vali Acc: 0.283 Test Loss: 2.746 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.6191781
	speed: 0.2724s/iter; left time: 3202.8682s
Epoch: 24 cost time: 11.215501546859741
Epoch: 24, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.469 Vali Acc: 0.259 Test Loss: 2.469 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.3410938
	speed: 0.2803s/iter; left time: 3252.8619s
Epoch: 25 cost time: 12.06868600845337
Epoch: 25, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.792 Vali Acc: 0.179 Test Loss: 2.792 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.8142344
	speed: 0.2946s/iter; left time: 3373.7951s
Epoch: 26 cost time: 12.431380271911621
Epoch: 26, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.517 Vali Acc: 0.063 Test Loss: 3.517 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.2810079
	speed: 0.2755s/iter; left time: 3112.7335s
Epoch: 27 cost time: 11.267954111099243
Epoch: 27, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.821 Vali Acc: 0.085 Test Loss: 2.821 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 1689778
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2311571
	speed: 0.0911s/iter; left time: 1393.3251s
Epoch: 1 cost time: 12.4969322681427
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.218 Vali Acc: 0.315 Test Loss: 2.218 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9394367
	speed: 0.2617s/iter; left time: 3963.5954s
Epoch: 2 cost time: 10.499484062194824
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.159 Vali Acc: 0.325 Test Loss: 2.159 Test Acc: 0.325
Validation loss decreased (-0.315063 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1971211
	speed: 0.2606s/iter; left time: 3907.3409s
Epoch: 3 cost time: 10.269806146621704
Epoch: 3, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.225 Vali Acc: 0.345 Test Loss: 2.225 Test Acc: 0.345
Validation loss decreased (-0.324796 --> -0.344666).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9652051
	speed: 0.2649s/iter; left time: 3930.4785s
Epoch: 4 cost time: 11.033963918685913
Epoch: 4, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.054 Vali Acc: 0.367 Test Loss: 2.054 Test Acc: 0.367
Validation loss decreased (-0.344666 --> -0.366565).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1845284
	speed: 0.2734s/iter; left time: 4015.4589s
Epoch: 5 cost time: 11.572010040283203
Epoch: 5, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.201 Vali Acc: 0.226 Test Loss: 2.201 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5319984
	speed: 0.2938s/iter; left time: 4269.8866s
Epoch: 6 cost time: 11.039411306381226
Epoch: 6, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.844 Vali Acc: 0.186 Test Loss: 2.844 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3273308
	speed: 0.2900s/iter; left time: 4169.0598s
Epoch: 7 cost time: 10.711697101593018
Epoch: 7, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.381 Vali Acc: 0.354 Test Loss: 2.381 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4443398
	speed: 0.2767s/iter; left time: 3936.0797s
Epoch: 8 cost time: 10.45472502708435
Epoch: 8, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.774 Vali Acc: 0.189 Test Loss: 2.774 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.3702694
	speed: 0.2620s/iter; left time: 3685.4145s
Epoch: 9 cost time: 10.416399478912354
Epoch: 9, Steps: 154 | Train Loss: 1.550 Vali Loss: 3.021 Vali Acc: 0.158 Test Loss: 3.021 Test Acc: 0.158
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.6378497
	speed: 0.2726s/iter; left time: 3792.6484s
Epoch: 10 cost time: 10.22276520729065
Epoch: 10, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.860 Vali Acc: 0.124 Test Loss: 2.860 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.9147869
	speed: 0.2654s/iter; left time: 3652.6442s
Epoch: 11 cost time: 9.752498388290405
Epoch: 11, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.730 Vali Acc: 0.089 Test Loss: 2.730 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.9514881
	speed: 0.2647s/iter; left time: 3602.1727s
Epoch: 12 cost time: 10.615079164505005
Epoch: 12, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.452 Vali Acc: 0.310 Test Loss: 2.452 Test Acc: 0.310
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9288990
	speed: 0.2703s/iter; left time: 3637.0030s
Epoch: 13 cost time: 10.928486347198486
Epoch: 13, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.244 Vali Acc: 0.368 Test Loss: 2.244 Test Acc: 0.368
Validation loss decreased (-0.366565 --> -0.367780).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5341482
	speed: 0.2708s/iter; left time: 3601.5804s
Epoch: 14 cost time: 10.033716201782227
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.231 Vali Acc: 0.380 Test Loss: 2.231 Test Acc: 0.380
Validation loss decreased (-0.367780 --> -0.380351).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6583123
	speed: 0.2693s/iter; left time: 3540.5222s
Epoch: 15 cost time: 10.510657787322998
Epoch: 15, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.822 Vali Acc: 0.121 Test Loss: 2.822 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7207175
	speed: 0.2688s/iter; left time: 3491.5017s
Epoch: 16 cost time: 10.04960322380066
Epoch: 16, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.717 Vali Acc: 0.117 Test Loss: 2.717 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2531784
	speed: 0.2512s/iter; left time: 3224.9708s
Epoch: 17 cost time: 10.635499000549316
Epoch: 17, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.402 Vali Acc: 0.256 Test Loss: 2.402 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4694877
	speed: 0.2876s/iter; left time: 3647.3480s
Epoch: 18 cost time: 11.081266641616821
Epoch: 18, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.336 Vali Acc: 0.381 Test Loss: 2.336 Test Acc: 0.381
Validation loss decreased (-0.380351 --> -0.380755).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2881367
	speed: 0.2712s/iter; left time: 3398.4524s
Epoch: 19 cost time: 10.12290096282959
Epoch: 19, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.532 Vali Acc: 0.385 Test Loss: 2.532 Test Acc: 0.385
Validation loss decreased (-0.380755 --> -0.384808).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2522582
	speed: 0.2749s/iter; left time: 3401.6707s
Epoch: 20 cost time: 11.271541595458984
Epoch: 20, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.464 Vali Acc: 0.129 Test Loss: 3.464 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5797172
	speed: 0.2806s/iter; left time: 3428.6076s
Epoch: 21 cost time: 11.639182329177856
Epoch: 21, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.690 Vali Acc: 0.391 Test Loss: 2.690 Test Acc: 0.391
Validation loss decreased (-0.384808 --> -0.390890).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0552390
	speed: 0.2822s/iter; left time: 3405.1810s
Epoch: 22 cost time: 11.586022138595581
Epoch: 22, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.335 Vali Acc: 0.392 Test Loss: 2.335 Test Acc: 0.392
Validation loss decreased (-0.390890 --> -0.391704).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3510902
	speed: 0.2715s/iter; left time: 3233.8342s
Epoch: 23 cost time: 11.01985788345337
Epoch: 23, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.906 Vali Acc: 0.138 Test Loss: 2.906 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.9922119
	speed: 0.2597s/iter; left time: 3054.2439s
Epoch: 24 cost time: 10.932567834854126
Epoch: 24, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.378 Vali Acc: 0.185 Test Loss: 2.378 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4404650
	speed: 0.2952s/iter; left time: 3425.9384s
Epoch: 25 cost time: 12.74868893623352
Epoch: 25, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.630 Vali Acc: 0.140 Test Loss: 2.630 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.3396866
	speed: 0.2945s/iter; left time: 3372.4877s
Epoch: 26 cost time: 12.374283075332642
Epoch: 26, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.179 Vali Acc: 0.117 Test Loss: 3.179 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.0322622
	speed: 0.2850s/iter; left time: 3219.3119s
Epoch: 27 cost time: 11.892861127853394
Epoch: 27, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.627 Vali Acc: 0.371 Test Loss: 2.627 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.1526278
	speed: 0.2745s/iter; left time: 3058.6760s
Epoch: 28 cost time: 11.005200624465942
Epoch: 28, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.820 Vali Acc: 0.133 Test Loss: 2.820 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.2517163
	speed: 0.2806s/iter; left time: 3083.0262s
Epoch: 29 cost time: 11.450242519378662
Epoch: 29, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.904 Vali Acc: 0.201 Test Loss: 2.904 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.8211433
	speed: 0.2723s/iter; left time: 2950.7240s
Epoch: 30 cost time: 10.235931158065796
Epoch: 30, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.698 Vali Acc: 0.217 Test Loss: 2.698 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.0390295
	speed: 0.2502s/iter; left time: 2672.4285s
Epoch: 31 cost time: 10.282468557357788
Epoch: 31, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.135 Vali Acc: 0.110 Test Loss: 3.135 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.1039720
	speed: 0.2663s/iter; left time: 2803.3619s
Epoch: 32 cost time: 10.495383977890015
Epoch: 32, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.458 Vali Acc: 0.357 Test Loss: 2.458 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 1689138
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2427981
	speed: 0.0848s/iter; left time: 1297.4331s
Epoch: 1 cost time: 12.099932432174683
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.202 Vali Acc: 0.315 Test Loss: 2.202 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9731809
	speed: 0.2801s/iter; left time: 4242.6808s
Epoch: 2 cost time: 12.26826024055481
Epoch: 2, Steps: 154 | Train Loss: 2.171 Vali Loss: 2.315 Vali Acc: 0.317 Test Loss: 2.315 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.317090).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3512226
	speed: 0.2661s/iter; left time: 3989.0120s
Epoch: 3 cost time: 10.062393188476562
Epoch: 3, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.328 Vali Acc: 0.324 Test Loss: 2.328 Test Acc: 0.324
Validation loss decreased (-0.317090 --> -0.324389).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9145007
	speed: 0.2720s/iter; left time: 4035.8671s
Epoch: 4 cost time: 10.520681858062744
Epoch: 4, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.291 Vali Acc: 0.344 Test Loss: 2.291 Test Acc: 0.344
Validation loss decreased (-0.324389 --> -0.344259).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8004560
	speed: 0.2515s/iter; left time: 3693.0681s
Epoch: 5 cost time: 10.411150693893433
Epoch: 5, Steps: 154 | Train Loss: 1.851 Vali Loss: 2.479 Vali Acc: 0.189 Test Loss: 2.479 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6765178
	speed: 0.2684s/iter; left time: 3900.7357s
Epoch: 6 cost time: 10.41248369216919
Epoch: 6, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.174 Vali Acc: 0.219 Test Loss: 2.174 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4086901
	speed: 0.2752s/iter; left time: 3955.9361s
Epoch: 7 cost time: 11.599374055862427
Epoch: 7, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.468 Vali Acc: 0.215 Test Loss: 2.468 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4929416
	speed: 0.2798s/iter; left time: 3979.8146s
Epoch: 8 cost time: 11.078526258468628
Epoch: 8, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.556 Vali Acc: 0.210 Test Loss: 2.556 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7182882
	speed: 0.2593s/iter; left time: 3648.3385s
Epoch: 9 cost time: 11.370027542114258
Epoch: 9, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.821 Vali Acc: 0.191 Test Loss: 2.821 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4777170
	speed: 0.2928s/iter; left time: 4074.7357s
Epoch: 10 cost time: 11.53633975982666
Epoch: 10, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.680 Vali Acc: 0.373 Test Loss: 2.680 Test Acc: 0.373
Validation loss decreased (-0.344259 --> -0.372641).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7885736
	speed: 0.2964s/iter; left time: 4078.7672s
Epoch: 11 cost time: 13.087294816970825
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.341 Vali Acc: 0.242 Test Loss: 2.341 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4427948
	speed: 0.2923s/iter; left time: 3977.8552s
Epoch: 12 cost time: 12.438737630844116
Epoch: 12, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.000 Vali Acc: 0.189 Test Loss: 3.000 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2475350
	speed: 0.2895s/iter; left time: 3894.8455s
Epoch: 13 cost time: 11.443428754806519
Epoch: 13, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.414 Vali Acc: 0.399 Test Loss: 2.414 Test Acc: 0.399
Validation loss decreased (-0.372641 --> -0.399408).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5048283
	speed: 0.2562s/iter; left time: 3407.3389s
Epoch: 14 cost time: 9.45388388633728
Epoch: 14, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.724 Vali Acc: 0.391 Test Loss: 2.724 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3497584
	speed: 0.2561s/iter; left time: 3365.8821s
Epoch: 15 cost time: 9.723366975784302
Epoch: 15, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.606 Vali Acc: 0.379 Test Loss: 2.606 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4487212
	speed: 0.2649s/iter; left time: 3441.2472s
Epoch: 16 cost time: 10.055697917938232
Epoch: 16, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.370 Vali Acc: 0.376 Test Loss: 2.370 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2612202
	speed: 0.2629s/iter; left time: 3375.1450s
Epoch: 17 cost time: 10.109930753707886
Epoch: 17, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.608 Vali Acc: 0.391 Test Loss: 2.608 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0870765
	speed: 0.2619s/iter; left time: 3321.1288s
Epoch: 18 cost time: 10.479648351669312
Epoch: 18, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.523 Vali Acc: 0.380 Test Loss: 2.523 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.2234992
	speed: 0.2664s/iter; left time: 3338.0085s
Epoch: 19 cost time: 11.147643804550171
Epoch: 19, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.679 Vali Acc: 0.371 Test Loss: 2.679 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.3021698
	speed: 0.2771s/iter; left time: 3429.4681s
Epoch: 20 cost time: 11.500325918197632
Epoch: 20, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.005 Vali Acc: 0.142 Test Loss: 3.005 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.6261616
	speed: 0.2722s/iter; left time: 3326.7769s
Epoch: 21 cost time: 11.187739610671997
Epoch: 21, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.806 Vali Acc: 0.241 Test Loss: 2.806 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.3221239
	speed: 0.2648s/iter; left time: 3194.8729s
Epoch: 22 cost time: 10.506111860275269
Epoch: 22, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.703 Vali Acc: 0.144 Test Loss: 2.703 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.2036505
	speed: 0.2511s/iter; left time: 2990.9937s
Epoch: 23 cost time: 10.650871753692627
Epoch: 23, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.021 Vali Acc: 0.118 Test Loss: 3.021 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 1526578
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.0557637
	speed: 0.0993s/iter; left time: 1518.9143s
Epoch: 1 cost time: 13.631126403808594
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.315 Vali Acc: 0.315 Test Loss: 2.315 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8117809
	speed: 0.2539s/iter; left time: 3845.6109s
Epoch: 2 cost time: 10.67555856704712
Epoch: 2, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.246 Vali Acc: 0.107 Test Loss: 2.246 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8894956
	speed: 0.2842s/iter; left time: 4260.8117s
Epoch: 3 cost time: 12.301082134246826
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.091 Vali Acc: 0.342 Test Loss: 2.091 Test Acc: 0.342
Validation loss decreased (-0.315468 --> -0.341828).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0289166
	speed: 0.2503s/iter; left time: 3713.4844s
Epoch: 4 cost time: 10.59932565689087
Epoch: 4, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.159 Vali Acc: 0.201 Test Loss: 2.159 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2133598
	speed: 0.2397s/iter; left time: 3520.0450s
Epoch: 5 cost time: 11.091553449630737
Epoch: 5, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.370 Vali Acc: 0.184 Test Loss: 2.370 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7664052
	speed: 0.2813s/iter; left time: 4087.7183s
Epoch: 6 cost time: 12.447452068328857
Epoch: 6, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.684 Vali Acc: 0.193 Test Loss: 2.684 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5616099
	speed: 0.3016s/iter; left time: 4336.6242s
Epoch: 7 cost time: 10.9845290184021
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.698 Vali Acc: 0.181 Test Loss: 2.698 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5896451
	speed: 0.2618s/iter; left time: 3723.1934s
Epoch: 8 cost time: 10.484422445297241
Epoch: 8, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.795 Vali Acc: 0.156 Test Loss: 2.795 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.6417408
	speed: 0.2945s/iter; left time: 4143.4347s
Epoch: 9 cost time: 11.215718269348145
Epoch: 9, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.739 Vali Acc: 0.178 Test Loss: 2.739 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.7127739
	speed: 0.3131s/iter; left time: 4357.3736s
Epoch: 10 cost time: 13.109754085540771
Epoch: 10, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.579 Vali Acc: 0.368 Test Loss: 2.579 Test Acc: 0.368
Validation loss decreased (-0.341828 --> -0.368182).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4902683
	speed: 0.2935s/iter; left time: 4038.6416s
Epoch: 11 cost time: 11.699816703796387
Epoch: 11, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.116 Vali Acc: 0.208 Test Loss: 3.116 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4209567
	speed: 0.2921s/iter; left time: 3973.9752s
Epoch: 12 cost time: 11.322639465332031
Epoch: 12, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.895 Vali Acc: 0.132 Test Loss: 2.895 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3648509
	speed: 0.2791s/iter; left time: 3754.9678s
Epoch: 13 cost time: 10.610231876373291
Epoch: 13, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.644 Vali Acc: 0.193 Test Loss: 2.644 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2444640
	speed: 0.2678s/iter; left time: 3562.0572s
Epoch: 14 cost time: 10.663969993591309
Epoch: 14, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.745 Vali Acc: 0.138 Test Loss: 2.745 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6540036
	speed: 0.2582s/iter; left time: 3394.5192s
Epoch: 15 cost time: 10.238378286361694
Epoch: 15, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.504 Vali Acc: 0.234 Test Loss: 2.504 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2104141
	speed: 0.2661s/iter; left time: 3456.5884s
Epoch: 16 cost time: 10.982003211975098
Epoch: 16, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.405 Vali Acc: 0.363 Test Loss: 2.405 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.9349335
	speed: 0.2761s/iter; left time: 3544.3341s
Epoch: 17 cost time: 10.947880744934082
Epoch: 17, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.770 Vali Acc: 0.230 Test Loss: 2.770 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.2019780
	speed: 0.2799s/iter; left time: 3549.9215s
Epoch: 18 cost time: 11.612972736358643
Epoch: 18, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.200 Vali Acc: 0.178 Test Loss: 3.200 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1337445
	speed: 0.2871s/iter; left time: 3596.8859s
Epoch: 19 cost time: 11.966223239898682
Epoch: 19, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.522 Vali Acc: 0.179 Test Loss: 2.522 Test Acc: 0.179
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.4510864
	speed: 0.3176s/iter; left time: 3930.7711s
Epoch: 20 cost time: 13.868328332901001
Epoch: 20, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.435 Vali Acc: 0.377 Test Loss: 2.435 Test Acc: 0.377
Validation loss decreased (-0.368182 --> -0.376699).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3398938
	speed: 0.3027s/iter; left time: 3699.7038s
Epoch: 21 cost time: 12.8059983253479
Epoch: 21, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.529 Vali Acc: 0.079 Test Loss: 2.529 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.0397246
	speed: 0.3035s/iter; left time: 3662.6291s
Epoch: 22 cost time: 12.972778081893921
Epoch: 22, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.835 Vali Acc: 0.094 Test Loss: 2.835 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.9144232
	speed: 0.3093s/iter; left time: 3684.8944s
Epoch: 23 cost time: 12.978168964385986
Epoch: 23, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.870 Vali Acc: 0.205 Test Loss: 2.870 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.2569772
	speed: 0.2885s/iter; left time: 3392.0379s
Epoch: 24 cost time: 12.307096481323242
Epoch: 24, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.475 Vali Acc: 0.226 Test Loss: 2.475 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.8663071
	speed: 0.2772s/iter; left time: 3217.2471s
Epoch: 25 cost time: 11.415299654006958
Epoch: 25, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.286 Vali Acc: 0.391 Test Loss: 2.286 Test Acc: 0.391
Validation loss decreased (-0.376699 --> -0.390894).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.5779564
	speed: 0.2893s/iter; left time: 3312.7851s
Epoch: 26 cost time: 12.222351312637329
Epoch: 26, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.633 Vali Acc: 0.188 Test Loss: 2.633 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2540486
	speed: 0.2747s/iter; left time: 3103.7879s
Epoch: 27 cost time: 11.352473258972168
Epoch: 27, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.642 Vali Acc: 0.206 Test Loss: 2.642 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.9551089
	speed: 0.2832s/iter; left time: 3155.7784s
Epoch: 28 cost time: 11.53285002708435
Epoch: 28, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.533 Vali Acc: 0.212 Test Loss: 2.533 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.6478331
	speed: 0.2920s/iter; left time: 3209.2378s
Epoch: 29 cost time: 11.869343996047974
Epoch: 29, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.541 Vali Acc: 0.083 Test Loss: 2.541 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.7763871
	speed: 0.2933s/iter; left time: 3177.3665s
Epoch: 30 cost time: 11.451230764389038
Epoch: 30, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.815 Vali Acc: 0.131 Test Loss: 2.815 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.0041773
	speed: 0.2830s/iter; left time: 3022.3329s
Epoch: 31 cost time: 11.19206714630127
Epoch: 31, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.119 Vali Acc: 0.125 Test Loss: 3.119 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.7256795
	speed: 0.2756s/iter; left time: 2901.0189s
Epoch: 32 cost time: 10.669129133224487
Epoch: 32, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.641 Vali Acc: 0.378 Test Loss: 2.641 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.4108604
	speed: 0.2781s/iter; left time: 2884.9851s
Epoch: 33 cost time: 11.223455667495728
Epoch: 33, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.727 Vali Acc: 0.207 Test Loss: 2.727 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 1.9792463
	speed: 0.2802s/iter; left time: 2863.7167s
Epoch: 34 cost time: 11.32803463935852
Epoch: 34, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.732 Vali Acc: 0.210 Test Loss: 2.732 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.0799598
	speed: 0.2899s/iter; left time: 2917.4796s
Epoch: 35 cost time: 12.489125728607178
Epoch: 35, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.518 Vali Acc: 0.120 Test Loss: 2.518 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 1525938
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3255744
	speed: 0.0883s/iter; left time: 1351.3111s
Epoch: 1 cost time: 12.516500473022461
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.326 Vali Acc: 0.315 Test Loss: 2.326 Test Acc: 0.315
Validation loss decreased (inf --> -0.315467).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0784187
	speed: 0.2729s/iter; left time: 4134.2765s
Epoch: 2 cost time: 11.460875511169434
Epoch: 2, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.204 Vali Acc: 0.322 Test Loss: 2.204 Test Acc: 0.322
Validation loss decreased (-0.315467 --> -0.322362).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5613446
	speed: 0.2716s/iter; left time: 4072.6035s
Epoch: 3 cost time: 10.778754234313965
Epoch: 3, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.142 Vali Acc: 0.338 Test Loss: 2.142 Test Acc: 0.338
Validation loss decreased (-0.322362 --> -0.337773).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2091942
	speed: 0.2579s/iter; left time: 3827.1356s
Epoch: 4 cost time: 10.463018417358398
Epoch: 4, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.311 Vali Acc: 0.186 Test Loss: 2.311 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4528241
	speed: 0.2566s/iter; left time: 3768.6441s
Epoch: 5 cost time: 11.19374966621399
Epoch: 5, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.355 Vali Acc: 0.197 Test Loss: 2.355 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4692262
	speed: 0.2730s/iter; left time: 3967.1078s
Epoch: 6 cost time: 9.68268609046936
Epoch: 6, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.602 Vali Acc: 0.369 Test Loss: 2.602 Test Acc: 0.369
Validation loss decreased (-0.337773 --> -0.368993).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9695765
	speed: 0.2475s/iter; left time: 3557.8208s
Epoch: 7 cost time: 10.95727825164795
Epoch: 7, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.632 Vali Acc: 0.207 Test Loss: 2.632 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3036176
	speed: 0.2358s/iter; left time: 3354.2684s
Epoch: 8 cost time: 10.234869718551636
Epoch: 8, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.859 Vali Acc: 0.197 Test Loss: 2.859 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1935574
	speed: 0.2825s/iter; left time: 3974.8839s
Epoch: 9 cost time: 14.437222719192505
Epoch: 9, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.975 Vali Acc: 0.205 Test Loss: 2.975 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5163671
	speed: 0.3048s/iter; left time: 4241.0788s
Epoch: 10 cost time: 13.325751304626465
Epoch: 10, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.755 Vali Acc: 0.362 Test Loss: 2.755 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6302093
	speed: 0.3012s/iter; left time: 4144.7765s
Epoch: 11 cost time: 12.406689882278442
Epoch: 11, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.463 Vali Acc: 0.219 Test Loss: 2.463 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7574769
	speed: 0.3345s/iter; left time: 4552.0470s
Epoch: 12 cost time: 13.65189814567566
Epoch: 12, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.403 Vali Acc: 0.228 Test Loss: 2.403 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1094646
	speed: 0.2997s/iter; left time: 4031.2421s
Epoch: 13 cost time: 11.540101528167725
Epoch: 13, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.772 Vali Acc: 0.127 Test Loss: 2.772 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3272396
	speed: 0.2894s/iter; left time: 3848.7591s
Epoch: 14 cost time: 11.068720817565918
Epoch: 14, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.575 Vali Acc: 0.207 Test Loss: 2.575 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.4171180
	speed: 0.2967s/iter; left time: 3900.1752s
Epoch: 15 cost time: 12.476283073425293
Epoch: 15, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.406 Vali Acc: 0.217 Test Loss: 2.406 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1404634
	speed: 0.3096s/iter; left time: 4021.8080s
Epoch: 16 cost time: 13.722941637039185
Epoch: 16, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.636 Vali Acc: 0.376 Test Loss: 2.636 Test Acc: 0.376
Validation loss decreased (-0.368993 --> -0.376292).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3487465
	speed: 0.3360s/iter; left time: 4313.4655s
Epoch: 17 cost time: 14.048331022262573
Epoch: 17, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.615 Vali Acc: 0.395 Test Loss: 2.615 Test Acc: 0.395
Validation loss decreased (-0.376292 --> -0.394945).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.0547876
	speed: 0.3347s/iter; left time: 4245.1332s
Epoch: 18 cost time: 13.207804679870605
Epoch: 18, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.815 Vali Acc: 0.153 Test Loss: 2.815 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2952031
	speed: 0.3087s/iter; left time: 3868.0111s
Epoch: 19 cost time: 11.941933870315552
Epoch: 19, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.692 Vali Acc: 0.123 Test Loss: 2.692 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5597700
	speed: 0.3140s/iter; left time: 3885.5082s
Epoch: 20 cost time: 14.090777158737183
Epoch: 20, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.729 Vali Acc: 0.241 Test Loss: 2.729 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3917092
	speed: 0.3068s/iter; left time: 3749.1392s
Epoch: 21 cost time: 12.68317461013794
Epoch: 21, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.647 Vali Acc: 0.157 Test Loss: 2.647 Test Acc: 0.157
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.4140540
	speed: 0.3264s/iter; left time: 3938.6807s
Epoch: 22 cost time: 13.392150640487671
Epoch: 22, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.513 Vali Acc: 0.144 Test Loss: 2.513 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.4678202
	speed: 0.2997s/iter; left time: 3570.7788s
Epoch: 23 cost time: 11.907845497131348
Epoch: 23, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.632 Vali Acc: 0.203 Test Loss: 2.632 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.7800257
	speed: 0.2893s/iter; left time: 3402.2030s
Epoch: 24 cost time: 11.686349153518677
Epoch: 24, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.724 Vali Acc: 0.120 Test Loss: 2.724 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.6871933
	speed: 0.2718s/iter; left time: 3154.5770s
Epoch: 25 cost time: 11.231086730957031
Epoch: 25, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.457 Vali Acc: 0.238 Test Loss: 2.457 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.3069824
	speed: 0.3093s/iter; left time: 3541.6408s
Epoch: 26 cost time: 12.588362693786621
Epoch: 26, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.932 Vali Acc: 0.218 Test Loss: 2.932 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.2204934
	speed: 0.2864s/iter; left time: 3234.9783s
Epoch: 27 cost time: 11.26712417602539
Epoch: 27, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.384 Vali Acc: 0.380 Test Loss: 2.384 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 1525298
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1715999
	speed: 0.0901s/iter; left time: 1379.1710s
Epoch: 1 cost time: 12.909156560897827
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.281 Vali Acc: 0.156 Test Loss: 2.281 Test Acc: 0.156
Validation loss decreased (inf --> -0.155695).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4524736
	speed: 0.2623s/iter; left time: 3972.8055s
Epoch: 2 cost time: 10.569524049758911
Epoch: 2, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.205 Vali Acc: 0.320 Test Loss: 2.205 Test Acc: 0.320
Validation loss decreased (-0.155695 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1565006
	speed: 0.2669s/iter; left time: 4002.1023s
Epoch: 3 cost time: 11.36518669128418
Epoch: 3, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.142 Vali Acc: 0.336 Test Loss: 2.142 Test Acc: 0.336
Validation loss decreased (-0.319524 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7949244
	speed: 0.2973s/iter; left time: 4412.3713s
Epoch: 4 cost time: 12.706534624099731
Epoch: 4, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.227 Vali Acc: 0.351 Test Loss: 2.227 Test Acc: 0.351
Validation loss decreased (-0.336151 --> -0.350748).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7159323
	speed: 0.3081s/iter; left time: 4524.7999s
Epoch: 5 cost time: 12.26975965499878
Epoch: 5, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.576 Vali Acc: 0.182 Test Loss: 2.576 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9875851
	speed: 0.2916s/iter; left time: 4237.3491s
Epoch: 6 cost time: 12.799072504043579
Epoch: 6, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.552 Vali Acc: 0.193 Test Loss: 2.552 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2005500
	speed: 0.2817s/iter; left time: 4050.5223s
Epoch: 7 cost time: 11.167244672775269
Epoch: 7, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.905 Vali Acc: 0.190 Test Loss: 2.905 Test Acc: 0.190
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7284936
	speed: 0.2859s/iter; left time: 4066.1823s
Epoch: 8 cost time: 11.22924542427063
Epoch: 8, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.582 Vali Acc: 0.371 Test Loss: 2.582 Test Acc: 0.371
Validation loss decreased (-0.350748 --> -0.371426).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6249933
	speed: 0.2971s/iter; left time: 4179.9764s
Epoch: 9 cost time: 12.934637546539307
Epoch: 9, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.370 Vali Acc: 0.215 Test Loss: 2.370 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1243845
	speed: 0.3005s/iter; left time: 4181.7581s
Epoch: 10 cost time: 11.592429876327515
Epoch: 10, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.364 Vali Acc: 0.126 Test Loss: 2.364 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6677963
	speed: 0.2652s/iter; left time: 3649.4800s
Epoch: 11 cost time: 10.281547784805298
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.452 Vali Acc: 0.205 Test Loss: 2.452 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7224722
	speed: 0.2795s/iter; left time: 3803.7326s
Epoch: 12 cost time: 11.286038398742676
Epoch: 12, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.626 Vali Acc: 0.193 Test Loss: 2.626 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2459394
	speed: 0.2862s/iter; left time: 3850.4945s
Epoch: 13 cost time: 11.92419958114624
Epoch: 13, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.910 Vali Acc: 0.143 Test Loss: 2.910 Test Acc: 0.143
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3333995
	speed: 0.2740s/iter; left time: 3643.5942s
Epoch: 14 cost time: 11.428634405136108
Epoch: 14, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.697 Vali Acc: 0.118 Test Loss: 2.697 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.7271255
	speed: 0.2739s/iter; left time: 3600.5226s
Epoch: 15 cost time: 10.896730661392212
Epoch: 15, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.475 Vali Acc: 0.168 Test Loss: 2.475 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2428724
	speed: 0.2911s/iter; left time: 3781.7387s
Epoch: 16 cost time: 12.186712265014648
Epoch: 16, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.659 Vali Acc: 0.127 Test Loss: 2.659 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8479087
	speed: 0.2540s/iter; left time: 3260.8271s
Epoch: 17 cost time: 10.326537609100342
Epoch: 17, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.649 Vali Acc: 0.077 Test Loss: 2.649 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.8113804
	speed: 0.2623s/iter; left time: 3326.1642s
Epoch: 18 cost time: 11.014854192733765
Epoch: 18, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.404 Vali Acc: 0.320 Test Loss: 2.404 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 1524658
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5581212
	speed: 0.1017s/iter; left time: 1555.5325s
Epoch: 1 cost time: 14.197325468063354
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9486091
	speed: 0.2542s/iter; left time: 3849.6955s
Epoch: 2 cost time: 10.016739845275879
Epoch: 2, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.183 Vali Acc: 0.322 Test Loss: 2.183 Test Acc: 0.322
Validation loss decreased (-0.315064 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0975780
	speed: 0.2708s/iter; left time: 4060.5229s
Epoch: 3 cost time: 10.845565795898438
Epoch: 3, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.082 Vali Acc: 0.333 Test Loss: 2.082 Test Acc: 0.333
Validation loss decreased (-0.322363 --> -0.332501).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2906063
	speed: 0.2522s/iter; left time: 3742.3042s
Epoch: 4 cost time: 10.1960129737854
Epoch: 4, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.257 Vali Acc: 0.340 Test Loss: 2.257 Test Acc: 0.340
Validation loss decreased (-0.332501 --> -0.339799).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3733578
	speed: 0.2428s/iter; left time: 3565.1264s
Epoch: 5 cost time: 10.43770170211792
Epoch: 5, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.233 Vali Acc: 0.187 Test Loss: 2.233 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1572751
	speed: 0.2398s/iter; left time: 3484.5640s
Epoch: 6 cost time: 10.323980331420898
Epoch: 6, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.299 Vali Acc: 0.373 Test Loss: 2.299 Test Acc: 0.373
Validation loss decreased (-0.339799 --> -0.373456).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2172859
	speed: 0.2615s/iter; left time: 3760.0947s
Epoch: 7 cost time: 11.267382144927979
Epoch: 7, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.683 Vali Acc: 0.206 Test Loss: 2.683 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5514073
	speed: 0.3056s/iter; left time: 4346.9913s
Epoch: 8 cost time: 11.977780818939209
Epoch: 8, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.610 Vali Acc: 0.198 Test Loss: 2.610 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5590079
	speed: 0.2752s/iter; left time: 3871.1351s
Epoch: 9 cost time: 11.06131649017334
Epoch: 9, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.629 Vali Acc: 0.187 Test Loss: 2.629 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1868461
	speed: 0.2802s/iter; left time: 3899.1979s
Epoch: 10 cost time: 11.176827907562256
Epoch: 10, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.671 Vali Acc: 0.099 Test Loss: 3.671 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1838105
	speed: 0.2592s/iter; left time: 3566.8645s
Epoch: 11 cost time: 10.417387008666992
Epoch: 11, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.119 Vali Acc: 0.355 Test Loss: 3.119 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2191325
	speed: 0.2564s/iter; left time: 3489.2838s
Epoch: 12 cost time: 11.00927996635437
Epoch: 12, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.701 Vali Acc: 0.090 Test Loss: 3.701 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3464593
	speed: 0.2905s/iter; left time: 3907.7530s
Epoch: 13 cost time: 10.898298025131226
Epoch: 13, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.976 Vali Acc: 0.374 Test Loss: 2.976 Test Acc: 0.374
Validation loss decreased (-0.373456 --> -0.373855).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4602997
	speed: 0.2372s/iter; left time: 3153.9744s
Epoch: 14 cost time: 9.55821943283081
Epoch: 14, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.805 Vali Acc: 0.060 Test Loss: 3.805 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4126991
	speed: 0.2481s/iter; left time: 3261.5251s
Epoch: 15 cost time: 10.404038190841675
Epoch: 15, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.753 Vali Acc: 0.099 Test Loss: 3.753 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3598204
	speed: 0.2367s/iter; left time: 3075.4250s
Epoch: 16 cost time: 9.178998231887817
Epoch: 16, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.514 Vali Acc: 0.125 Test Loss: 3.514 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2600265
	speed: 0.2369s/iter; left time: 3041.0832s
Epoch: 17 cost time: 9.44304347038269
Epoch: 17, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.794 Vali Acc: 0.107 Test Loss: 3.794 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1954989
	speed: 0.2597s/iter; left time: 3294.1285s
Epoch: 18 cost time: 11.96299409866333
Epoch: 18, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.234 Vali Acc: 0.142 Test Loss: 3.234 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.2520596
	speed: 0.2718s/iter; left time: 3405.5478s
Epoch: 19 cost time: 10.721409797668457
Epoch: 19, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.480 Vali Acc: 0.121 Test Loss: 3.480 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.6824386
	speed: 0.2652s/iter; left time: 3282.3079s
Epoch: 20 cost time: 10.852031469345093
Epoch: 20, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.684 Vali Acc: 0.115 Test Loss: 3.684 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.2569742
	speed: 0.2708s/iter; left time: 3309.7006s
Epoch: 21 cost time: 9.459322214126587
Epoch: 21, Steps: 154 | Train Loss: 1.272 Vali Loss: 4.454 Vali Acc: 0.073 Test Loss: 4.454 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.2435579
	speed: 0.2518s/iter; left time: 3038.0545s
Epoch: 22 cost time: 10.656821250915527
Epoch: 22, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.577 Vali Acc: 0.131 Test Loss: 3.577 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.0666628
	speed: 0.2565s/iter; left time: 3055.2564s
Epoch: 23 cost time: 10.070759534835815
Epoch: 23, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.974 Vali Acc: 0.163 Test Loss: 2.974 Test Acc: 0.163
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 1013874
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0429835
	speed: 0.1036s/iter; left time: 1585.4450s
Epoch: 1 cost time: 14.32765531539917
Epoch: 1, Steps: 154 | Train Loss: 2.253 Vali Loss: 2.216 Vali Acc: 0.155 Test Loss: 2.216 Test Acc: 0.155
Validation loss decreased (inf --> -0.154885).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0657423
	speed: 0.2692s/iter; left time: 4077.4709s
Epoch: 2 cost time: 10.745572805404663
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.213 Vali Acc: 0.320 Test Loss: 2.213 Test Acc: 0.320
Validation loss decreased (-0.154885 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3053639
	speed: 0.2835s/iter; left time: 4250.9903s
Epoch: 3 cost time: 10.431124210357666
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.086 Vali Acc: 0.337 Test Loss: 2.086 Test Acc: 0.337
Validation loss decreased (-0.319524 --> -0.336557).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8621415
	speed: 0.2711s/iter; left time: 4023.1866s
Epoch: 4 cost time: 11.272765159606934
Epoch: 4, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.267 Vali Acc: 0.341 Test Loss: 2.267 Test Acc: 0.341
Validation loss decreased (-0.336557 --> -0.341421).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0935117
	speed: 0.2815s/iter; left time: 4133.6285s
Epoch: 5 cost time: 11.201599597930908
Epoch: 5, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.224 Vali Acc: 0.340 Test Loss: 2.224 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6533444
	speed: 0.2988s/iter; left time: 4342.0389s
Epoch: 6 cost time: 11.320477962493896
Epoch: 6, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.529 Vali Acc: 0.186 Test Loss: 2.529 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7315744
	speed: 0.2942s/iter; left time: 4229.6496s
Epoch: 7 cost time: 11.787047147750854
Epoch: 7, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.816 Vali Acc: 0.212 Test Loss: 2.816 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8153057
	speed: 0.2919s/iter; left time: 4151.5964s
Epoch: 8 cost time: 12.385624170303345
Epoch: 8, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.967 Vali Acc: 0.383 Test Loss: 2.967 Test Acc: 0.383
Validation loss decreased (-0.341421 --> -0.383182).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6392314
	speed: 0.2883s/iter; left time: 4056.6811s
Epoch: 9 cost time: 11.378659725189209
Epoch: 9, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.421 Vali Acc: 0.112 Test Loss: 3.421 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1861420
	speed: 0.2617s/iter; left time: 3640.9661s
Epoch: 10 cost time: 10.667728185653687
Epoch: 10, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.242 Vali Acc: 0.187 Test Loss: 3.242 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1441458
	speed: 0.2581s/iter; left time: 3551.4759s
Epoch: 11 cost time: 10.315556049346924
Epoch: 11, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.723 Vali Acc: 0.153 Test Loss: 2.723 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8911021
	speed: 0.2644s/iter; left time: 3597.5081s
Epoch: 12 cost time: 9.875669240951538
Epoch: 12, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.369 Vali Acc: 0.201 Test Loss: 3.369 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6351428
	speed: 0.2523s/iter; left time: 3393.8964s
Epoch: 13 cost time: 10.047420740127563
Epoch: 13, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.472 Vali Acc: 0.126 Test Loss: 3.472 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2905347
	speed: 0.2497s/iter; left time: 3320.6615s
Epoch: 14 cost time: 10.726155757904053
Epoch: 14, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.277 Vali Acc: 0.129 Test Loss: 3.277 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2163486
	speed: 0.2626s/iter; left time: 3452.0304s
Epoch: 15 cost time: 11.202801942825317
Epoch: 15, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.639 Vali Acc: 0.126 Test Loss: 3.639 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.8386998
	speed: 0.2640s/iter; left time: 3429.8910s
Epoch: 16 cost time: 10.82454228401184
Epoch: 16, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.403 Vali Acc: 0.114 Test Loss: 3.403 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.4065112
	speed: 0.2724s/iter; left time: 3497.2408s
Epoch: 17 cost time: 11.295389175415039
Epoch: 17, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.920 Vali Acc: 0.112 Test Loss: 3.920 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.8450912
	speed: 0.2811s/iter; left time: 3565.0909s
Epoch: 18 cost time: 11.557511806488037
Epoch: 18, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.381 Vali Acc: 0.124 Test Loss: 3.381 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 1013554
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1020036
	speed: 0.0937s/iter; left time: 1433.0919s
Epoch: 1 cost time: 13.734402656555176
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.186 Vali Acc: 0.315 Test Loss: 2.186 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2886364
	speed: 0.3119s/iter; left time: 4724.4389s
Epoch: 2 cost time: 12.149344205856323
Epoch: 2, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.171 Vali Acc: 0.321 Test Loss: 2.171 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9543636
	speed: 0.2736s/iter; left time: 4101.9385s
Epoch: 3 cost time: 12.008981943130493
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.088 Vali Acc: 0.342 Test Loss: 2.088 Test Acc: 0.342
Validation loss decreased (-0.320741 --> -0.342234).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9522207
	speed: 0.2998s/iter; left time: 4449.2910s
Epoch: 4 cost time: 11.71150517463684
Epoch: 4, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.162 Vali Acc: 0.361 Test Loss: 2.162 Test Acc: 0.361
Validation loss decreased (-0.342234 --> -0.361292).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6701299
	speed: 0.2534s/iter; left time: 3721.7098s
Epoch: 5 cost time: 9.908896207809448
Epoch: 5, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.126 Vali Acc: 0.361 Test Loss: 2.126 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0663817
	speed: 0.2571s/iter; left time: 3735.5341s
Epoch: 6 cost time: 10.382804155349731
Epoch: 6, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.272 Vali Acc: 0.356 Test Loss: 2.272 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3724926
	speed: 0.2466s/iter; left time: 3544.9258s
Epoch: 7 cost time: 10.118242979049683
Epoch: 7, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.296 Vali Acc: 0.369 Test Loss: 2.296 Test Acc: 0.369
Validation loss decreased (-0.361292 --> -0.368590).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1574128
	speed: 0.2508s/iter; left time: 3567.3181s
Epoch: 8 cost time: 9.69084358215332
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.266 Vali Acc: 0.358 Test Loss: 2.266 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7437007
	speed: 0.2558s/iter; left time: 3599.3970s
Epoch: 9 cost time: 10.175938606262207
Epoch: 9, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.845 Vali Acc: 0.378 Test Loss: 2.845 Test Acc: 0.378
Validation loss decreased (-0.368590 --> -0.377506).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6008786
	speed: 0.2995s/iter; left time: 4168.0493s
Epoch: 10 cost time: 10.679539918899536
Epoch: 10, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.338 Vali Acc: 0.139 Test Loss: 3.338 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2289898
	speed: 0.2690s/iter; left time: 3702.0120s
Epoch: 11 cost time: 11.14836597442627
Epoch: 11, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.987 Vali Acc: 0.364 Test Loss: 2.987 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3850214
	speed: 0.2981s/iter; left time: 4055.6772s
Epoch: 12 cost time: 11.859741449356079
Epoch: 12, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.806 Vali Acc: 0.111 Test Loss: 2.806 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3836919
	speed: 0.2763s/iter; left time: 3716.3922s
Epoch: 13 cost time: 11.210919618606567
Epoch: 13, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.165 Vali Acc: 0.114 Test Loss: 3.165 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2754151
	speed: 0.2644s/iter; left time: 3515.7307s
Epoch: 14 cost time: 9.879878759384155
Epoch: 14, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.276 Vali Acc: 0.114 Test Loss: 3.276 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.9548941
	speed: 0.2518s/iter; left time: 3309.6730s
Epoch: 15 cost time: 10.256813287734985
Epoch: 15, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.329 Vali Acc: 0.122 Test Loss: 3.329 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2219298
	speed: 0.2732s/iter; left time: 3548.8147s
Epoch: 16 cost time: 11.451889753341675
Epoch: 16, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.552 Vali Acc: 0.108 Test Loss: 3.552 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9317232
	speed: 0.2865s/iter; left time: 3677.4441s
Epoch: 17 cost time: 11.92338228225708
Epoch: 17, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.310 Vali Acc: 0.122 Test Loss: 3.310 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.5782620
	speed: 0.2634s/iter; left time: 3340.2525s
Epoch: 18 cost time: 9.763532638549805
Epoch: 18, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.330 Vali Acc: 0.080 Test Loss: 3.330 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.4526987
	speed: 0.2640s/iter; left time: 3307.2537s
Epoch: 19 cost time: 10.602190732955933
Epoch: 19, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.381 Vali Acc: 0.060 Test Loss: 3.381 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 1013234
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0385821
	speed: 0.0958s/iter; left time: 1465.4900s
Epoch: 1 cost time: 14.069785594940186
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1736906
	speed: 0.2814s/iter; left time: 4262.9494s
Epoch: 2 cost time: 10.71464991569519
Epoch: 2, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.161 Vali Acc: 0.321 Test Loss: 2.161 Test Acc: 0.321
Validation loss decreased (-0.315469 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8378454
	speed: 0.3021s/iter; left time: 4529.9172s
Epoch: 3 cost time: 11.775643825531006
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.092 Vali Acc: 0.339 Test Loss: 2.092 Test Acc: 0.339
Validation loss decreased (-0.321146 --> -0.338990).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8698134
	speed: 0.2897s/iter; left time: 4298.8161s
Epoch: 4 cost time: 10.5052649974823
Epoch: 4, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.255 Vali Acc: 0.356 Test Loss: 2.255 Test Acc: 0.356
Validation loss decreased (-0.338990 --> -0.355614).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4863698
	speed: 0.2986s/iter; left time: 4384.3496s
Epoch: 5 cost time: 11.227716207504272
Epoch: 5, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.405 Vali Acc: 0.378 Test Loss: 2.405 Test Acc: 0.378
Validation loss decreased (-0.355614 --> -0.378321).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5853997
	speed: 0.2788s/iter; left time: 4051.7982s
Epoch: 6 cost time: 10.96529221534729
Epoch: 6, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.150 Vali Acc: 0.208 Test Loss: 2.150 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3920915
	speed: 0.2754s/iter; left time: 3960.1375s
Epoch: 7 cost time: 11.864917516708374
Epoch: 7, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.637 Vali Acc: 0.238 Test Loss: 2.637 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0602937
	speed: 0.2882s/iter; left time: 4099.0046s
Epoch: 8 cost time: 10.79594087600708
Epoch: 8, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.801 Vali Acc: 0.369 Test Loss: 2.801 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3306372
	speed: 0.3031s/iter; left time: 4264.2482s
Epoch: 9 cost time: 12.436395406723022
Epoch: 9, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.998 Vali Acc: 0.124 Test Loss: 2.998 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6656309
	speed: 0.2935s/iter; left time: 4083.9762s
Epoch: 10 cost time: 11.54740309715271
Epoch: 10, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.198 Vali Acc: 0.120 Test Loss: 3.198 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4759609
	speed: 0.2808s/iter; left time: 3864.2524s
Epoch: 11 cost time: 10.366682291030884
Epoch: 11, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.900 Vali Acc: 0.132 Test Loss: 2.900 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4306443
	speed: 0.2813s/iter; left time: 3828.0842s
Epoch: 12 cost time: 10.809719562530518
Epoch: 12, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.675 Vali Acc: 0.052 Test Loss: 3.675 Test Acc: 0.052
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.0243026
	speed: 0.2800s/iter; left time: 3766.7779s
Epoch: 13 cost time: 12.217759847640991
Epoch: 13, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.467 Vali Acc: 0.098 Test Loss: 4.467 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3252910
	speed: 0.2990s/iter; left time: 3976.9688s
Epoch: 14 cost time: 11.616795301437378
Epoch: 14, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.045 Vali Acc: 0.118 Test Loss: 3.045 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2533066
	speed: 0.2980s/iter; left time: 3916.7461s
Epoch: 15 cost time: 12.704873085021973
Epoch: 15, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.038 Vali Acc: 0.116 Test Loss: 3.038 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 1012914
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5453091
	speed: 0.0911s/iter; left time: 1394.6058s
Epoch: 1 cost time: 12.81214451789856
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.264 Vali Acc: 0.315 Test Loss: 2.264 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9497583
	speed: 0.2789s/iter; left time: 4223.9211s
Epoch: 2 cost time: 11.143742322921753
Epoch: 2, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.182 Vali Acc: 0.157 Test Loss: 2.182 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8132685
	speed: 0.2828s/iter; left time: 4239.7562s
Epoch: 3 cost time: 11.071728229522705
Epoch: 3, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.096 Vali Acc: 0.346 Test Loss: 2.096 Test Acc: 0.346
Validation loss decreased (-0.315468 --> -0.345883).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0410712
	speed: 0.2852s/iter; left time: 4231.5714s
Epoch: 4 cost time: 10.554449319839478
Epoch: 4, Steps: 154 | Train Loss: 1.892 Vali Loss: 2.107 Vali Acc: 0.354 Test Loss: 2.107 Test Acc: 0.354
Validation loss decreased (-0.345883 --> -0.353994).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5990796
	speed: 0.2997s/iter; left time: 4400.8833s
Epoch: 5 cost time: 12.141881704330444
Epoch: 5, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.529 Vali Acc: 0.178 Test Loss: 2.529 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6623815
	speed: 0.2978s/iter; left time: 4327.9061s
Epoch: 6 cost time: 12.008111715316772
Epoch: 6, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.631 Vali Acc: 0.167 Test Loss: 2.631 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6101514
	speed: 0.2562s/iter; left time: 3683.2842s
Epoch: 7 cost time: 9.590201377868652
Epoch: 7, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.544 Vali Acc: 0.198 Test Loss: 2.544 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8206462
	speed: 0.2339s/iter; left time: 3326.1340s
Epoch: 8 cost time: 11.099485635757446
Epoch: 8, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.829 Vali Acc: 0.359 Test Loss: 2.829 Test Acc: 0.359
Validation loss decreased (-0.353994 --> -0.359258).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3575335
	speed: 0.2659s/iter; left time: 3740.8148s
Epoch: 9 cost time: 11.105903387069702
Epoch: 9, Steps: 154 | Train Loss: 1.519 Vali Loss: 3.050 Vali Acc: 0.198 Test Loss: 3.050 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3550563
	speed: 0.2497s/iter; left time: 3474.1793s
Epoch: 10 cost time: 10.163640975952148
Epoch: 10, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.102 Vali Acc: 0.160 Test Loss: 3.102 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1758293
	speed: 0.2799s/iter; left time: 3851.9007s
Epoch: 11 cost time: 11.353409051895142
Epoch: 11, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.675 Vali Acc: 0.250 Test Loss: 2.675 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3966464
	speed: 0.2916s/iter; left time: 3968.0434s
Epoch: 12 cost time: 11.773585796356201
Epoch: 12, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.615 Vali Acc: 0.063 Test Loss: 3.615 Test Acc: 0.063
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1822968
	speed: 0.2621s/iter; left time: 3526.0890s
Epoch: 13 cost time: 9.845677852630615
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.022 Vali Acc: 0.361 Test Loss: 3.022 Test Acc: 0.361
Validation loss decreased (-0.359258 --> -0.360878).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2846017
	speed: 0.2697s/iter; left time: 3586.9444s
Epoch: 14 cost time: 10.481602191925049
Epoch: 14, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.340 Vali Acc: 0.117 Test Loss: 3.340 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2694311
	speed: 0.2771s/iter; left time: 3642.3096s
Epoch: 15 cost time: 11.541466236114502
Epoch: 15, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.617 Vali Acc: 0.072 Test Loss: 3.617 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7467648
	speed: 0.2951s/iter; left time: 3833.1105s
Epoch: 16 cost time: 11.700093030929565
Epoch: 16, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.399 Vali Acc: 0.117 Test Loss: 3.399 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1931914
	speed: 0.2707s/iter; left time: 3475.2215s
Epoch: 17 cost time: 11.184085130691528
Epoch: 17, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.511 Vali Acc: 0.111 Test Loss: 3.511 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1385766
	speed: 0.2825s/iter; left time: 3582.9079s
Epoch: 18 cost time: 11.088072776794434
Epoch: 18, Steps: 154 | Train Loss: 1.296 Vali Loss: 4.319 Vali Acc: 0.103 Test Loss: 4.319 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8427673
	speed: 0.2731s/iter; left time: 3421.4574s
Epoch: 19 cost time: 10.46018385887146
Epoch: 19, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.147 Vali Acc: 0.119 Test Loss: 4.147 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.5982301
	speed: 0.2805s/iter; left time: 3471.5575s
Epoch: 20 cost time: 11.295220613479614
Epoch: 20, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.404 Vali Acc: 0.123 Test Loss: 3.404 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.0792416
	speed: 0.3046s/iter; left time: 3722.4731s
Epoch: 21 cost time: 11.885104417800903
Epoch: 21, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.721 Vali Acc: 0.121 Test Loss: 3.721 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8862335
	speed: 0.2912s/iter; left time: 3513.4439s
Epoch: 22 cost time: 11.121466636657715
Epoch: 22, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.576 Vali Acc: 0.123 Test Loss: 3.576 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.5187123
	speed: 0.2741s/iter; left time: 3265.2279s
Epoch: 23 cost time: 11.17443037033081
Epoch: 23, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.317 Vali Acc: 0.187 Test Loss: 3.317 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 683634
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0894508
	speed: 0.0993s/iter; left time: 1519.1103s
Epoch: 1 cost time: 14.053802490234375
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4110923
	speed: 0.3042s/iter; left time: 4607.5633s
Epoch: 2 cost time: 12.87274169921875
Epoch: 2, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.139 Vali Acc: 0.318 Test Loss: 2.139 Test Acc: 0.318
Validation loss decreased (-0.315469 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1136496
	speed: 0.2838s/iter; left time: 4254.4111s
Epoch: 3 cost time: 10.38228726387024
Epoch: 3, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.086 Vali Acc: 0.329 Test Loss: 2.086 Test Acc: 0.329
Validation loss decreased (-0.317497 --> -0.329257).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7930173
	speed: 0.2763s/iter; left time: 4100.6590s
Epoch: 4 cost time: 10.521209478378296
Epoch: 4, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.264 Vali Acc: 0.334 Test Loss: 2.264 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.334122).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9951785
	speed: 0.2652s/iter; left time: 3894.9607s
Epoch: 5 cost time: 10.797467708587646
Epoch: 5, Steps: 154 | Train Loss: 1.775 Vali Loss: 1.975 Vali Acc: 0.369 Test Loss: 1.975 Test Acc: 0.369
Validation loss decreased (-0.334122 --> -0.369404).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8496270
	speed: 0.2933s/iter; left time: 4262.0079s
Epoch: 6 cost time: 13.621587038040161
Epoch: 6, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.380 Vali Acc: 0.195 Test Loss: 2.380 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9774150
	speed: 0.2925s/iter; left time: 4205.0466s
Epoch: 7 cost time: 12.547131061553955
Epoch: 7, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.867 Vali Acc: 0.183 Test Loss: 2.867 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7225562
	speed: 0.3079s/iter; left time: 4379.4195s
Epoch: 8 cost time: 12.68860125541687
Epoch: 8, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.690 Vali Acc: 0.375 Test Loss: 2.690 Test Acc: 0.375
Validation loss decreased (-0.369404 --> -0.374669).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6042178
	speed: 0.2930s/iter; left time: 4122.3391s
Epoch: 9 cost time: 12.957028865814209
Epoch: 9, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.633 Vali Acc: 0.367 Test Loss: 2.633 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3260711
	speed: 0.2828s/iter; left time: 3934.5343s
Epoch: 10 cost time: 10.973933219909668
Epoch: 10, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.156 Vali Acc: 0.158 Test Loss: 3.156 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6249824
	speed: 0.2802s/iter; left time: 3855.3485s
Epoch: 11 cost time: 11.460913181304932
Epoch: 11, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.183 Vali Acc: 0.082 Test Loss: 3.183 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8410931
	speed: 0.2786s/iter; left time: 3790.4827s
Epoch: 12 cost time: 11.010381698608398
Epoch: 12, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.939 Vali Acc: 0.130 Test Loss: 2.939 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2229528
	speed: 0.2716s/iter; left time: 3653.7623s
Epoch: 13 cost time: 11.468111515045166
Epoch: 13, Steps: 154 | Train Loss: 1.387 Vali Loss: 3.602 Vali Acc: 0.115 Test Loss: 3.602 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3945947
	speed: 0.2906s/iter; left time: 3864.0492s
Epoch: 14 cost time: 12.724557399749756
Epoch: 14, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.142 Vali Acc: 0.122 Test Loss: 3.142 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2993102
	speed: 0.2829s/iter; left time: 3718.6442s
Epoch: 15 cost time: 11.523523569107056
Epoch: 15, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.888 Vali Acc: 0.144 Test Loss: 2.888 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.5741913
	speed: 0.2916s/iter; left time: 3788.8170s
Epoch: 16 cost time: 11.27462649345398
Epoch: 16, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.311 Vali Acc: 0.119 Test Loss: 3.311 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.1160648
	speed: 0.2939s/iter; left time: 3773.1276s
Epoch: 17 cost time: 11.138090372085571
Epoch: 17, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.056 Vali Acc: 0.118 Test Loss: 3.056 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.5050471
	speed: 0.2663s/iter; left time: 3377.4712s
Epoch: 18 cost time: 10.351672172546387
Epoch: 18, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.369 Vali Acc: 0.126 Test Loss: 3.369 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 683314
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2322569
	speed: 0.0961s/iter; left time: 1470.8989s
Epoch: 1 cost time: 13.21901249885559
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.173 Vali Acc: 0.316 Test Loss: 2.173 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0518022
	speed: 0.2656s/iter; left time: 4022.4335s
Epoch: 2 cost time: 10.460871934890747
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.196 Vali Acc: 0.316 Test Loss: 2.196 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0872855
	speed: 0.2507s/iter; left time: 3758.5135s
Epoch: 3 cost time: 10.652368783950806
Epoch: 3, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.154 Vali Acc: 0.327 Test Loss: 2.154 Test Acc: 0.327
Validation loss decreased (-0.315874 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3957148
	speed: 0.2321s/iter; left time: 3444.3891s
Epoch: 4 cost time: 9.893442630767822
Epoch: 4, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.189 Vali Acc: 0.345 Test Loss: 2.189 Test Acc: 0.345
Validation loss decreased (-0.327229 --> -0.345071).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8839008
	speed: 0.2401s/iter; left time: 3525.5528s
Epoch: 5 cost time: 10.183096885681152
Epoch: 5, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.353 Vali Acc: 0.348 Test Loss: 2.353 Test Acc: 0.348
Validation loss decreased (-0.345071 --> -0.347908).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7745630
	speed: 0.2208s/iter; left time: 3207.8941s
Epoch: 6 cost time: 9.688051700592041
Epoch: 6, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.784 Vali Acc: 0.114 Test Loss: 2.784 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8254948
	speed: 0.2629s/iter; left time: 3779.6628s
Epoch: 7 cost time: 11.676441669464111
Epoch: 7, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.465 Vali Acc: 0.240 Test Loss: 2.465 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3446012
	speed: 0.2775s/iter; left time: 3947.4628s
Epoch: 8 cost time: 10.547465562820435
Epoch: 8, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.541 Vali Acc: 0.214 Test Loss: 2.541 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5443821
	speed: 0.2722s/iter; left time: 3830.2514s
Epoch: 9 cost time: 10.952394247055054
Epoch: 9, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.763 Vali Acc: 0.195 Test Loss: 2.763 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7516568
	speed: 0.2663s/iter; left time: 3704.9458s
Epoch: 10 cost time: 10.662590980529785
Epoch: 10, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.213 Vali Acc: 0.124 Test Loss: 3.213 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.0033141
	speed: 0.2540s/iter; left time: 3494.8539s
Epoch: 11 cost time: 10.51748538017273
Epoch: 11, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.439 Vali Acc: 0.189 Test Loss: 3.439 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.6206104
	speed: 0.2483s/iter; left time: 3378.4620s
Epoch: 12 cost time: 10.855760097503662
Epoch: 12, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.481 Vali Acc: 0.182 Test Loss: 3.481 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5077455
	speed: 0.2536s/iter; left time: 3411.3016s
Epoch: 13 cost time: 10.594484567642212
Epoch: 13, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.328 Vali Acc: 0.191 Test Loss: 3.328 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3474715
	speed: 0.2677s/iter; left time: 3560.0858s
Epoch: 14 cost time: 10.29725956916809
Epoch: 14, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.705 Vali Acc: 0.213 Test Loss: 2.705 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.9307485
	speed: 0.2341s/iter; left time: 3077.2836s
Epoch: 15 cost time: 9.490064144134521
Epoch: 15, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.318 Vali Acc: 0.161 Test Loss: 3.318 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34793187347931875
model parameter : 682994
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8448012
	speed: 0.0908s/iter; left time: 1389.8805s
Epoch: 1 cost time: 12.204987525939941
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.178 Vali Acc: 0.315 Test Loss: 2.178 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4836051
	speed: 0.2463s/iter; left time: 3731.3292s
Epoch: 2 cost time: 9.988904237747192
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.151 Vali Acc: 0.319 Test Loss: 2.151 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4192508
	speed: 0.2294s/iter; left time: 3439.5523s
Epoch: 3 cost time: 9.728021621704102
Epoch: 3, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.125 Vali Acc: 0.341 Test Loss: 2.125 Test Acc: 0.341
Validation loss decreased (-0.318713 --> -0.341017).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9844321
	speed: 0.2629s/iter; left time: 3901.8015s
Epoch: 4 cost time: 10.410194396972656
Epoch: 4, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.108 Vali Acc: 0.349 Test Loss: 2.108 Test Acc: 0.349
Validation loss decreased (-0.341017 --> -0.348722).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3973137
	speed: 0.2446s/iter; left time: 3592.3981s
Epoch: 5 cost time: 9.824714660644531
Epoch: 5, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.336 Vali Acc: 0.341 Test Loss: 2.336 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8220601
	speed: 0.2480s/iter; left time: 3604.3251s
Epoch: 6 cost time: 10.860033750534058
Epoch: 6, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.230 Vali Acc: 0.373 Test Loss: 2.230 Test Acc: 0.373
Validation loss decreased (-0.348722 --> -0.373051).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3148454
	speed: 0.2582s/iter; left time: 3711.9894s
Epoch: 7 cost time: 10.261372566223145
Epoch: 7, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.597 Vali Acc: 0.187 Test Loss: 2.597 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4600606
	speed: 0.2661s/iter; left time: 3784.6907s
Epoch: 8 cost time: 9.845885515213013
Epoch: 8, Steps: 154 | Train Loss: 1.575 Vali Loss: 3.033 Vali Acc: 0.126 Test Loss: 3.033 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5040542
	speed: 0.2630s/iter; left time: 3699.9473s
Epoch: 9 cost time: 10.56610631942749
Epoch: 9, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.690 Vali Acc: 0.204 Test Loss: 2.690 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4832273
	speed: 0.2606s/iter; left time: 3626.6275s
Epoch: 10 cost time: 11.252392053604126
Epoch: 10, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.882 Vali Acc: 0.249 Test Loss: 2.882 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9353672
	speed: 0.2495s/iter; left time: 3434.0402s
Epoch: 11 cost time: 10.313809156417847
Epoch: 11, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.148 Vali Acc: 0.156 Test Loss: 3.148 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7629580
	speed: 0.2467s/iter; left time: 3357.0271s
Epoch: 12 cost time: 10.143189668655396
Epoch: 12, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.759 Vali Acc: 0.201 Test Loss: 2.759 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3034467
	speed: 0.2639s/iter; left time: 3549.8316s
Epoch: 13 cost time: 10.508091688156128
Epoch: 13, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.065 Vali Acc: 0.126 Test Loss: 3.065 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1539567
	speed: 0.2530s/iter; left time: 3364.8888s
Epoch: 14 cost time: 9.955464363098145
Epoch: 14, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.237 Vali Acc: 0.137 Test Loss: 3.237 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3952686
	speed: 0.2600s/iter; left time: 3417.8841s
Epoch: 15 cost time: 10.642829418182373
Epoch: 15, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.409 Vali Acc: 0.073 Test Loss: 3.409 Test Acc: 0.073
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2897123
	speed: 0.2522s/iter; left time: 3276.6304s
Epoch: 16 cost time: 10.673031330108643
Epoch: 16, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.086 Vali Acc: 0.155 Test Loss: 3.086 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 682674
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3425407
	speed: 0.0945s/iter; left time: 1445.6308s
Epoch: 1 cost time: 13.034158945083618
Epoch: 1, Steps: 154 | Train Loss: 2.235 Vali Loss: 2.263 Vali Acc: 0.315 Test Loss: 2.263 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4216034
	speed: 0.2765s/iter; left time: 4188.3907s
Epoch: 2 cost time: 11.409698247909546
Epoch: 2, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.209 Vali Acc: 0.318 Test Loss: 2.209 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.317496).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0509996
	speed: 0.2872s/iter; left time: 4306.4008s
Epoch: 3 cost time: 12.159175634384155
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.195 Vali Acc: 0.335 Test Loss: 2.195 Test Acc: 0.335
Validation loss decreased (-0.317496 --> -0.334528).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6596911
	speed: 0.2669s/iter; left time: 3960.5818s
Epoch: 4 cost time: 10.166512489318848
Epoch: 4, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.138 Vali Acc: 0.341 Test Loss: 2.138 Test Acc: 0.341
Validation loss decreased (-0.334528 --> -0.341017).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9421467
	speed: 0.2957s/iter; left time: 4341.6986s
Epoch: 5 cost time: 12.416513442993164
Epoch: 5, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.080 Vali Acc: 0.359 Test Loss: 2.080 Test Acc: 0.359
Validation loss decreased (-0.341017 --> -0.358860).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8533312
	speed: 0.3013s/iter; left time: 4377.6652s
Epoch: 6 cost time: 13.073310613632202
Epoch: 6, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.586 Vali Acc: 0.172 Test Loss: 2.586 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7180691
	speed: 0.3257s/iter; left time: 4682.5417s
Epoch: 7 cost time: 13.297284364700317
Epoch: 7, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.214 Vali Acc: 0.209 Test Loss: 2.214 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0997555
	speed: 0.3102s/iter; left time: 4411.6464s
Epoch: 8 cost time: 14.216836929321289
Epoch: 8, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.083 Vali Acc: 0.187 Test Loss: 3.083 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5971694
	speed: 0.3066s/iter; left time: 4314.2290s
Epoch: 9 cost time: 10.483731508255005
Epoch: 9, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.527 Vali Acc: 0.360 Test Loss: 2.527 Test Acc: 0.360
Validation loss decreased (-0.358860 --> -0.360072).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0845994
	speed: 0.2924s/iter; left time: 4068.3257s
Epoch: 10 cost time: 12.909693002700806
Epoch: 10, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.155 Vali Acc: 0.108 Test Loss: 3.155 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3034050
	speed: 0.3099s/iter; left time: 4263.8625s
Epoch: 11 cost time: 11.904028415679932
Epoch: 11, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.227 Vali Acc: 0.125 Test Loss: 3.227 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3524911
	speed: 0.2887s/iter; left time: 3928.8597s
Epoch: 12 cost time: 12.598877668380737
Epoch: 12, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.038 Vali Acc: 0.154 Test Loss: 3.038 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5282056
	speed: 0.2845s/iter; left time: 3826.7174s
Epoch: 13 cost time: 11.32622742652893
Epoch: 13, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.246 Vali Acc: 0.121 Test Loss: 3.246 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5840741
	speed: 0.2322s/iter; left time: 3087.4573s
Epoch: 14 cost time: 10.093783378601074
Epoch: 14, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.240 Vali Acc: 0.123 Test Loss: 3.240 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.1546302
	speed: 0.2451s/iter; left time: 3221.9159s
Epoch: 15 cost time: 9.999215841293335
Epoch: 15, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.142 Vali Acc: 0.117 Test Loss: 3.142 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3242545
	speed: 0.2874s/iter; left time: 3734.2614s
Epoch: 16 cost time: 12.009689569473267
Epoch: 16, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.202 Vali Acc: 0.078 Test Loss: 3.202 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3087730
	speed: 0.2848s/iter; left time: 3656.5826s
Epoch: 17 cost time: 12.247174739837646
Epoch: 17, Steps: 154 | Train Loss: 1.342 Vali Loss: 3.167 Vali Acc: 0.204 Test Loss: 3.167 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.0909286
	speed: 0.2701s/iter; left time: 3426.0217s
Epoch: 18 cost time: 11.750551700592041
Epoch: 18, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.945 Vali Acc: 0.198 Test Loss: 2.945 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9662891
	speed: 0.2937s/iter; left time: 3679.5871s
Epoch: 19 cost time: 12.127751588821411
Epoch: 19, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.048 Vali Acc: 0.187 Test Loss: 3.048 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 518514
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4032900
	speed: 0.0888s/iter; left time: 1358.3991s
Epoch: 1 cost time: 12.57119870185852
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.227 Vali Acc: 0.315 Test Loss: 2.227 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2224834
	speed: 0.2698s/iter; left time: 4086.2214s
Epoch: 2 cost time: 11.408835411071777
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.192 Vali Acc: 0.319 Test Loss: 2.192 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9978795
	speed: 0.2525s/iter; left time: 3785.7628s
Epoch: 3 cost time: 9.89499831199646
Epoch: 3, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.219 Vali Acc: 0.339 Test Loss: 2.219 Test Acc: 0.339
Validation loss decreased (-0.318713 --> -0.338583).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1334004
	speed: 0.2701s/iter; left time: 4007.5663s
Epoch: 4 cost time: 12.291003465652466
Epoch: 4, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.125 Vali Acc: 0.347 Test Loss: 2.125 Test Acc: 0.347
Validation loss decreased (-0.338583 --> -0.346694).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7104672
	speed: 0.2868s/iter; left time: 4212.1235s
Epoch: 5 cost time: 11.348989248275757
Epoch: 5, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.099 Vali Acc: 0.384 Test Loss: 2.099 Test Acc: 0.384
Validation loss decreased (-0.346694 --> -0.384407).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6354704
	speed: 0.2516s/iter; left time: 3656.1062s
Epoch: 6 cost time: 10.231196403503418
Epoch: 6, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.475 Vali Acc: 0.193 Test Loss: 2.475 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5382004
	speed: 0.2465s/iter; left time: 3544.1317s
Epoch: 7 cost time: 10.097915172576904
Epoch: 7, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.888 Vali Acc: 0.116 Test Loss: 2.888 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4212186
	speed: 0.2621s/iter; left time: 3728.0609s
Epoch: 8 cost time: 10.560091257095337
Epoch: 8, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.711 Vali Acc: 0.185 Test Loss: 2.711 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4724250
	speed: 0.2461s/iter; left time: 3462.9109s
Epoch: 9 cost time: 9.616761684417725
Epoch: 9, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.831 Vali Acc: 0.192 Test Loss: 2.831 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6565615
	speed: 0.2301s/iter; left time: 3201.9665s
Epoch: 10 cost time: 9.410119533538818
Epoch: 10, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.852 Vali Acc: 0.300 Test Loss: 2.852 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6188892
	speed: 0.2487s/iter; left time: 3422.6830s
Epoch: 11 cost time: 10.89734673500061
Epoch: 11, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.222 Vali Acc: 0.193 Test Loss: 3.222 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.7464879
	speed: 0.2385s/iter; left time: 3245.0773s
Epoch: 12 cost time: 9.386404037475586
Epoch: 12, Steps: 154 | Train Loss: 1.429 Vali Loss: 3.055 Vali Acc: 0.198 Test Loss: 3.055 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3127695
	speed: 0.2362s/iter; left time: 3177.0443s
Epoch: 13 cost time: 9.595735311508179
Epoch: 13, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.932 Vali Acc: 0.153 Test Loss: 2.932 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.8654248
	speed: 0.2478s/iter; left time: 3295.0957s
Epoch: 14 cost time: 10.918057441711426
Epoch: 14, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.778 Vali Acc: 0.210 Test Loss: 2.778 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4562411
	speed: 0.2768s/iter; left time: 3637.9673s
Epoch: 15 cost time: 10.662508964538574
Epoch: 15, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.279 Vali Acc: 0.181 Test Loss: 3.279 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 518194
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9949973
	speed: 0.1007s/iter; left time: 1541.4459s
Epoch: 1 cost time: 14.359803199768066
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.193 Vali Acc: 0.315 Test Loss: 2.193 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2435765
	speed: 0.2733s/iter; left time: 4140.3104s
Epoch: 2 cost time: 10.790651559829712
Epoch: 2, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.288 Vali Acc: 0.316 Test Loss: 2.288 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.315873).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7255865
	speed: 0.2589s/iter; left time: 3881.5253s
Epoch: 3 cost time: 10.703924179077148
Epoch: 3, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.063 Vali Acc: 0.331 Test Loss: 2.063 Test Acc: 0.331
Validation loss decreased (-0.315873 --> -0.331285).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5004625
	speed: 0.2842s/iter; left time: 4217.9537s
Epoch: 4 cost time: 12.111557722091675
Epoch: 4, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.207 Vali Acc: 0.180 Test Loss: 2.207 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6340650
	speed: 0.2846s/iter; left time: 4178.7992s
Epoch: 5 cost time: 11.16185998916626
Epoch: 5, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.482 Vali Acc: 0.350 Test Loss: 2.482 Test Acc: 0.350
Validation loss decreased (-0.331285 --> -0.349935).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4480147
	speed: 0.2791s/iter; left time: 4055.2018s
Epoch: 6 cost time: 12.082270622253418
Epoch: 6, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.457 Vali Acc: 0.217 Test Loss: 2.457 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6717968
	speed: 0.3040s/iter; left time: 4371.1121s
Epoch: 7 cost time: 11.457245349884033
Epoch: 7, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.539 Vali Acc: 0.342 Test Loss: 2.539 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9322212
	speed: 0.2769s/iter; left time: 3937.7374s
Epoch: 8 cost time: 11.049587965011597
Epoch: 8, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.667 Vali Acc: 0.378 Test Loss: 2.667 Test Acc: 0.378
Validation loss decreased (-0.349935 --> -0.377508).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5628659
	speed: 0.2680s/iter; left time: 3770.4570s
Epoch: 9 cost time: 10.978938817977905
Epoch: 9, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.766 Vali Acc: 0.155 Test Loss: 2.766 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6645689
	speed: 0.2501s/iter; left time: 3480.8269s
Epoch: 10 cost time: 10.178699493408203
Epoch: 10, Steps: 154 | Train Loss: 1.492 Vali Loss: 3.306 Vali Acc: 0.146 Test Loss: 3.306 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7959805
	speed: 0.2735s/iter; left time: 3763.0928s
Epoch: 11 cost time: 10.316241025924683
Epoch: 11, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.926 Vali Acc: 0.203 Test Loss: 2.926 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.0435834
	speed: 0.2717s/iter; left time: 3696.4164s
Epoch: 12 cost time: 10.912668704986572
Epoch: 12, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.218 Vali Acc: 0.200 Test Loss: 3.218 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3343074
	speed: 0.2785s/iter; left time: 3746.3143s
Epoch: 13 cost time: 12.401909351348877
Epoch: 13, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.526 Vali Acc: 0.193 Test Loss: 3.526 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.7843932
	speed: 0.2819s/iter; left time: 3749.5040s
Epoch: 14 cost time: 12.37865686416626
Epoch: 14, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.082 Vali Acc: 0.181 Test Loss: 3.082 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.3961524
	speed: 0.2916s/iter; left time: 3833.2656s
Epoch: 15 cost time: 11.397079467773438
Epoch: 15, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.275 Vali Acc: 0.141 Test Loss: 3.275 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3640696
	speed: 0.2746s/iter; left time: 3566.9304s
Epoch: 16 cost time: 11.345853805541992
Epoch: 16, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.294 Vali Acc: 0.140 Test Loss: 3.294 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.1696779
	speed: 0.2641s/iter; left time: 3390.4937s
Epoch: 17 cost time: 11.653425216674805
Epoch: 17, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.338 Vali Acc: 0.189 Test Loss: 3.338 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2810633
	speed: 0.2778s/iter; left time: 3523.5279s
Epoch: 18 cost time: 12.270079612731934
Epoch: 18, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.154 Vali Acc: 0.142 Test Loss: 3.154 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 517874
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9337710
	speed: 0.0947s/iter; left time: 1449.2143s
Epoch: 1 cost time: 12.456579208374023
Epoch: 1, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4592772
	speed: 0.2122s/iter; left time: 3214.1081s
Epoch: 2 cost time: 9.817816257476807
Epoch: 2, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.179 Vali Acc: 0.316 Test Loss: 2.179 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4598937
	speed: 0.2150s/iter; left time: 3224.0908s
Epoch: 3 cost time: 9.425526857376099
Epoch: 3, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.238 Vali Acc: 0.326 Test Loss: 2.238 Test Acc: 0.326
Validation loss decreased (-0.315874 --> -0.325606).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9334009
	speed: 0.2478s/iter; left time: 3676.9200s
Epoch: 4 cost time: 10.566558361053467
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.019 Vali Acc: 0.367 Test Loss: 2.019 Test Acc: 0.367
Validation loss decreased (-0.325606 --> -0.366565).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8758813
	speed: 0.2504s/iter; left time: 3677.0470s
Epoch: 5 cost time: 10.800504446029663
Epoch: 5, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.321 Vali Acc: 0.349 Test Loss: 2.321 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8240271
	speed: 0.2578s/iter; left time: 3745.7116s
Epoch: 6 cost time: 10.73084807395935
Epoch: 6, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.493 Vali Acc: 0.190 Test Loss: 2.493 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9063394
	speed: 0.2326s/iter; left time: 3343.8178s
Epoch: 7 cost time: 9.28600788116455
Epoch: 7, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.819 Vali Acc: 0.189 Test Loss: 2.819 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7926018
	speed: 0.2353s/iter; left time: 3346.8555s
Epoch: 8 cost time: 9.870770454406738
Epoch: 8, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.918 Vali Acc: 0.153 Test Loss: 2.918 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.9620227
	speed: 0.2575s/iter; left time: 3622.2421s
Epoch: 9 cost time: 11.229777574539185
Epoch: 9, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.817 Vali Acc: 0.174 Test Loss: 2.817 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.2687992
	speed: 0.2559s/iter; left time: 3560.9763s
Epoch: 10 cost time: 10.713387489318848
Epoch: 10, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.889 Vali Acc: 0.120 Test Loss: 2.889 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6959364
	speed: 0.2618s/iter; left time: 3602.7620s
Epoch: 11 cost time: 10.679806232452393
Epoch: 11, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.512 Vali Acc: 0.173 Test Loss: 3.512 Test Acc: 0.173
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2205325
	speed: 0.2625s/iter; left time: 3571.8291s
Epoch: 12 cost time: 11.621166944503784
Epoch: 12, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.566 Vali Acc: 0.198 Test Loss: 3.566 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6308529
	speed: 0.2422s/iter; left time: 3258.3630s
Epoch: 13 cost time: 10.162928819656372
Epoch: 13, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.856 Vali Acc: 0.115 Test Loss: 3.856 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.4376166
	speed: 0.2637s/iter; left time: 3507.4677s
Epoch: 14 cost time: 10.519386053085327
Epoch: 14, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.521 Vali Acc: 0.120 Test Loss: 3.521 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36658556366585565
model parameter : 517554
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4225914
	speed: 0.1111s/iter; left time: 1700.0779s
Epoch: 1 cost time: 14.681700706481934
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6477127
	speed: 0.2927s/iter; left time: 4433.0646s
Epoch: 2 cost time: 12.67354965209961
Epoch: 2, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.237 Vali Acc: 0.316 Test Loss: 2.237 Test Acc: 0.316
Validation loss decreased (-0.314658 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1636622
	speed: 0.2820s/iter; left time: 4227.8718s
Epoch: 3 cost time: 11.464354515075684
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.106 Vali Acc: 0.333 Test Loss: 2.106 Test Acc: 0.333
Validation loss decreased (-0.315874 --> -0.332501).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5707948
	speed: 0.2712s/iter; left time: 4023.7455s
Epoch: 4 cost time: 10.884491205215454
Epoch: 4, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.173 Vali Acc: 0.343 Test Loss: 2.173 Test Acc: 0.343
Validation loss decreased (-0.332501 --> -0.343044).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6714387
	speed: 0.2746s/iter; left time: 4033.2261s
Epoch: 5 cost time: 10.509082794189453
Epoch: 5, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.404 Vali Acc: 0.343 Test Loss: 2.404 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5745398
	speed: 0.2790s/iter; left time: 4054.2040s
Epoch: 6 cost time: 10.941229104995728
Epoch: 6, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.612 Vali Acc: 0.187 Test Loss: 2.612 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7294482
	speed: 0.2815s/iter; left time: 4047.5625s
Epoch: 7 cost time: 11.646726131439209
Epoch: 7, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.570 Vali Acc: 0.372 Test Loss: 2.570 Test Acc: 0.372
Validation loss decreased (-0.343044 --> -0.372237).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3584737
	speed: 0.2671s/iter; left time: 3799.2852s
Epoch: 8 cost time: 11.115894079208374
Epoch: 8, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.930 Vali Acc: 0.190 Test Loss: 2.930 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0361490
	speed: 0.2708s/iter; left time: 3810.4112s
Epoch: 9 cost time: 10.954671859741211
Epoch: 9, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.804 Vali Acc: 0.217 Test Loss: 2.804 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5554477
	speed: 0.2707s/iter; left time: 3766.7355s
Epoch: 10 cost time: 10.027732372283936
Epoch: 10, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.259 Vali Acc: 0.194 Test Loss: 3.259 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.1135526
	speed: 0.2754s/iter; left time: 3790.4179s
Epoch: 11 cost time: 12.329676389694214
Epoch: 11, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.986 Vali Acc: 0.198 Test Loss: 2.986 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0437869
	speed: 0.2747s/iter; left time: 3738.2162s
Epoch: 12 cost time: 11.361946821212769
Epoch: 12, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.072 Vali Acc: 0.204 Test Loss: 3.072 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2346497
	speed: 0.2870s/iter; left time: 3860.6192s
Epoch: 13 cost time: 11.79289197921753
Epoch: 13, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.484 Vali Acc: 0.199 Test Loss: 3.484 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7963750
	speed: 0.2665s/iter; left time: 3544.7540s
Epoch: 14 cost time: 10.253601551055908
Epoch: 14, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.907 Vali Acc: 0.217 Test Loss: 2.907 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1262927
	speed: 0.2820s/iter; left time: 3706.8795s
Epoch: 15 cost time: 11.602020025253296
Epoch: 15, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.924 Vali Acc: 0.192 Test Loss: 2.924 Test Acc: 0.192
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2351128
	speed: 0.2752s/iter; left time: 3575.5975s
Epoch: 16 cost time: 10.691929340362549
Epoch: 16, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.976 Vali Acc: 0.219 Test Loss: 2.976 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.6887133
	speed: 0.2951s/iter; left time: 3788.4012s
Epoch: 17 cost time: 12.260308980941772
Epoch: 17, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.190 Vali Acc: 0.149 Test Loss: 3.190 Test Acc: 0.149
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 435954
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4401941
	speed: 0.0821s/iter; left time: 1256.4184s
Epoch: 1 cost time: 11.72350811958313
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0378759
	speed: 0.2478s/iter; left time: 3752.9081s
Epoch: 2 cost time: 10.078282356262207
Epoch: 2, Steps: 154 | Train Loss: 2.122 Vali Loss: 2.194 Vali Acc: 0.158 Test Loss: 2.194 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3752112
	speed: 0.2673s/iter; left time: 4007.7300s
Epoch: 3 cost time: 11.740520477294922
Epoch: 3, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.162 Vali Acc: 0.165 Test Loss: 2.162 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.1547401
	speed: 0.2838s/iter; left time: 4211.2192s
Epoch: 4 cost time: 11.563557386398315
Epoch: 4, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.174 Vali Acc: 0.358 Test Loss: 2.174 Test Acc: 0.358
Validation loss decreased (-0.315063 --> -0.357642).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5385876
	speed: 0.2720s/iter; left time: 3994.9696s
Epoch: 5 cost time: 11.259307146072388
Epoch: 5, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.224 Vali Acc: 0.358 Test Loss: 2.224 Test Acc: 0.358
Validation loss decreased (-0.357642 --> -0.358453).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6777967
	speed: 0.2552s/iter; left time: 3708.2773s
Epoch: 6 cost time: 10.967658758163452
Epoch: 6, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.108 Vali Acc: 0.221 Test Loss: 2.108 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4824336
	speed: 0.2743s/iter; left time: 3943.5908s
Epoch: 7 cost time: 10.937723636627197
Epoch: 7, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.511 Vali Acc: 0.365 Test Loss: 2.511 Test Acc: 0.365
Validation loss decreased (-0.358453 --> -0.365344).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3776610
	speed: 0.2513s/iter; left time: 3574.4287s
Epoch: 8 cost time: 10.837861776351929
Epoch: 8, Steps: 154 | Train Loss: 1.573 Vali Loss: 3.116 Vali Acc: 0.104 Test Loss: 3.116 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2072873
	speed: 0.2872s/iter; left time: 4041.0159s
Epoch: 9 cost time: 12.017724514007568
Epoch: 9, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.935 Vali Acc: 0.146 Test Loss: 2.935 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3833077
	speed: 0.2921s/iter; left time: 4063.8847s
Epoch: 10 cost time: 12.723391056060791
Epoch: 10, Steps: 154 | Train Loss: 1.531 Vali Loss: 3.025 Vali Acc: 0.119 Test Loss: 3.025 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2688133
	speed: 0.2897s/iter; left time: 3986.4397s
Epoch: 11 cost time: 10.723327398300171
Epoch: 11, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.527 Vali Acc: 0.209 Test Loss: 2.527 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3926259
	speed: 0.2364s/iter; left time: 3216.4140s
Epoch: 12 cost time: 11.126024961471558
Epoch: 12, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.291 Vali Acc: 0.203 Test Loss: 3.291 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1782000
	speed: 0.2489s/iter; left time: 3348.2094s
Epoch: 13 cost time: 9.807090759277344
Epoch: 13, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.436 Vali Acc: 0.131 Test Loss: 3.436 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5797254
	speed: 0.2422s/iter; left time: 3221.5013s
Epoch: 14 cost time: 11.333271265029907
Epoch: 14, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.062 Vali Acc: 0.356 Test Loss: 3.062 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.8616934
	speed: 0.2325s/iter; left time: 3056.0708s
Epoch: 15 cost time: 9.65552544593811
Epoch: 15, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.201 Vali Acc: 0.128 Test Loss: 3.201 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1181868
	speed: 0.1961s/iter; left time: 2547.2123s
Epoch: 16 cost time: 8.892541885375977
Epoch: 16, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.206 Vali Acc: 0.132 Test Loss: 3.206 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3931613
	speed: 0.2238s/iter; left time: 2873.3014s
Epoch: 17 cost time: 9.945184230804443
Epoch: 17, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.772 Vali Acc: 0.372 Test Loss: 2.772 Test Acc: 0.372
Validation loss decreased (-0.365344 --> -0.372235).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0809420
	speed: 0.2588s/iter; left time: 3282.0902s
Epoch: 18 cost time: 11.385089874267578
Epoch: 18, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.229 Vali Acc: 0.130 Test Loss: 3.229 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.0236282
	speed: 0.2522s/iter; left time: 3160.1996s
Epoch: 19 cost time: 9.673260688781738
Epoch: 19, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.621 Vali Acc: 0.120 Test Loss: 3.621 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5509332
	speed: 0.2427s/iter; left time: 3003.0995s
Epoch: 20 cost time: 10.513027429580688
Epoch: 20, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.436 Vali Acc: 0.175 Test Loss: 3.436 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.5746994
	speed: 0.2536s/iter; left time: 3099.4290s
Epoch: 21 cost time: 10.697981357574463
Epoch: 21, Steps: 154 | Train Loss: 1.267 Vali Loss: 3.150 Vali Acc: 0.138 Test Loss: 3.150 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8247901
	speed: 0.2642s/iter; left time: 3187.9134s
Epoch: 22 cost time: 11.066852331161499
Epoch: 22, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.325 Vali Acc: 0.197 Test Loss: 3.325 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.7197255
	speed: 0.2514s/iter; left time: 2995.1698s
Epoch: 23 cost time: 10.284572124481201
Epoch: 23, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.060 Vali Acc: 0.191 Test Loss: 3.060 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.1431888
	speed: 0.2730s/iter; left time: 3210.3400s
Epoch: 24 cost time: 11.20530652999878
Epoch: 24, Steps: 154 | Train Loss: 1.242 Vali Loss: 4.269 Vali Acc: 0.064 Test Loss: 4.269 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.5207164
	speed: 0.2755s/iter; left time: 3197.2445s
Epoch: 25 cost time: 11.65247392654419
Epoch: 25, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.237 Vali Acc: 0.097 Test Loss: 3.237 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.3263539
	speed: 0.2833s/iter; left time: 3243.7157s
Epoch: 26 cost time: 11.04539680480957
Epoch: 26, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.113 Vali Acc: 0.261 Test Loss: 3.113 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.9961050
	speed: 0.2603s/iter; left time: 2940.4383s
Epoch: 27 cost time: 10.107945203781128
Epoch: 27, Steps: 154 | Train Loss: 1.204 Vali Loss: 3.636 Vali Acc: 0.118 Test Loss: 3.636 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 435634
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0197127
	speed: 0.0873s/iter; left time: 1336.4118s
Epoch: 1 cost time: 12.655683755874634
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.199 Vali Acc: 0.315 Test Loss: 2.199 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2775953
	speed: 0.2665s/iter; left time: 4036.7411s
Epoch: 2 cost time: 10.170178174972534
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.188 Vali Acc: 0.318 Test Loss: 2.188 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.318307).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7283319
	speed: 0.2478s/iter; left time: 3714.9105s
Epoch: 3 cost time: 10.432826042175293
Epoch: 3, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.098 Vali Acc: 0.335 Test Loss: 2.098 Test Acc: 0.335
Validation loss decreased (-0.318307 --> -0.334529).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9041039
	speed: 0.2291s/iter; left time: 3399.7395s
Epoch: 4 cost time: 10.077316045761108
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.124 Vali Acc: 0.198 Test Loss: 2.124 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7370005
	speed: 0.2525s/iter; left time: 3708.4739s
Epoch: 5 cost time: 11.246660470962524
Epoch: 5, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.296 Vali Acc: 0.195 Test Loss: 2.296 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4552554
	speed: 0.2350s/iter; left time: 3414.9766s
Epoch: 6 cost time: 8.953432083129883
Epoch: 6, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.385 Vali Acc: 0.349 Test Loss: 2.385 Test Acc: 0.349
Validation loss decreased (-0.334529 --> -0.348719).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7628068
	speed: 0.2330s/iter; left time: 3350.1465s
Epoch: 7 cost time: 9.127243041992188
Epoch: 7, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.767 Vali Acc: 0.148 Test Loss: 2.767 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9060974
	speed: 0.2381s/iter; left time: 3386.2990s
Epoch: 8 cost time: 10.012908697128296
Epoch: 8, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.876 Vali Acc: 0.193 Test Loss: 2.876 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6496545
	speed: 0.2153s/iter; left time: 3028.7561s
Epoch: 9 cost time: 9.116258144378662
Epoch: 9, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.201 Vali Acc: 0.193 Test Loss: 3.201 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4555064
	speed: 0.2197s/iter; left time: 3057.6450s
Epoch: 10 cost time: 10.167954206466675
Epoch: 10, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.953 Vali Acc: 0.121 Test Loss: 2.953 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1121106
	speed: 0.2267s/iter; left time: 3119.8816s
Epoch: 11 cost time: 10.278862953186035
Epoch: 11, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.306 Vali Acc: 0.137 Test Loss: 3.306 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4871889
	speed: 0.2395s/iter; left time: 3258.6276s
Epoch: 12 cost time: 10.633532762527466
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.134 Vali Acc: 0.110 Test Loss: 3.134 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3731002
	speed: 0.2683s/iter; left time: 3609.2731s
Epoch: 13 cost time: 10.21722149848938
Epoch: 13, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.337 Vali Acc: 0.116 Test Loss: 3.337 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2965431
	speed: 0.2461s/iter; left time: 3272.4364s
Epoch: 14 cost time: 9.434725761413574
Epoch: 14, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.964 Vali Acc: 0.122 Test Loss: 2.964 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.4894966
	speed: 0.2368s/iter; left time: 3112.7460s
Epoch: 15 cost time: 10.919851064682007
Epoch: 15, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.084 Vali Acc: 0.141 Test Loss: 3.084 Test Acc: 0.141
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9385919
	speed: 0.2450s/iter; left time: 3182.3828s
Epoch: 16 cost time: 10.072968482971191
Epoch: 16, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.441 Vali Acc: 0.116 Test Loss: 3.441 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34874290348742903
model parameter : 435314
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3879805
	speed: 0.0862s/iter; left time: 1318.3651s
Epoch: 1 cost time: 12.30595850944519
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.209 Vali Acc: 0.315 Test Loss: 2.209 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0049753
	speed: 0.2428s/iter; left time: 3677.3246s
Epoch: 2 cost time: 10.688956499099731
Epoch: 2, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5277680
	speed: 0.2212s/iter; left time: 3316.6816s
Epoch: 3 cost time: 9.35086178779602
Epoch: 3, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.062 Vali Acc: 0.333 Test Loss: 2.062 Test Acc: 0.333
Validation loss decreased (-0.315063 --> -0.332502).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7940923
	speed: 0.2350s/iter; left time: 3487.1066s
Epoch: 4 cost time: 9.077251434326172
Epoch: 4, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.339 Vali Acc: 0.323 Test Loss: 2.339 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9721392
	speed: 0.2254s/iter; left time: 3310.3447s
Epoch: 5 cost time: 9.780919790267944
Epoch: 5, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.262 Vali Acc: 0.103 Test Loss: 2.262 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5282389
	speed: 0.2383s/iter; left time: 3462.6677s
Epoch: 6 cost time: 11.244744539260864
Epoch: 6, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.339 Vali Acc: 0.356 Test Loss: 2.339 Test Acc: 0.356
Validation loss decreased (-0.332502 --> -0.356019).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5818422
	speed: 0.2345s/iter; left time: 3371.6264s
Epoch: 7 cost time: 9.6663236618042
Epoch: 7, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.989 Vali Acc: 0.193 Test Loss: 2.989 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5941894
	speed: 0.2376s/iter; left time: 3380.0325s
Epoch: 8 cost time: 10.095765113830566
Epoch: 8, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.784 Vali Acc: 0.137 Test Loss: 2.784 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0029068
	speed: 0.2328s/iter; left time: 3275.0243s
Epoch: 9 cost time: 8.862884521484375
Epoch: 9, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.663 Vali Acc: 0.193 Test Loss: 2.663 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4506712
	speed: 0.2220s/iter; left time: 3089.4090s
Epoch: 10 cost time: 9.221014261245728
Epoch: 10, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.066 Vali Acc: 0.127 Test Loss: 3.066 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5224477
	speed: 0.2102s/iter; left time: 2892.5836s
Epoch: 11 cost time: 9.796180725097656
Epoch: 11, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.953 Vali Acc: 0.243 Test Loss: 2.953 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7758980
	speed: 0.2072s/iter; left time: 2819.8429s
Epoch: 12 cost time: 9.357747554779053
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.726 Vali Acc: 0.360 Test Loss: 2.726 Test Acc: 0.360
Validation loss decreased (-0.356019 --> -0.360070).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4078779
	speed: 0.2240s/iter; left time: 3014.0173s
Epoch: 13 cost time: 9.389983177185059
Epoch: 13, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.892 Vali Acc: 0.212 Test Loss: 2.892 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1684985
	speed: 0.2015s/iter; left time: 2680.1119s
Epoch: 14 cost time: 8.486238718032837
Epoch: 14, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.922 Vali Acc: 0.204 Test Loss: 2.922 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3637204
	speed: 0.1942s/iter; left time: 2552.8920s
Epoch: 15 cost time: 8.815576791763306
Epoch: 15, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.714 Vali Acc: 0.212 Test Loss: 2.714 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2392428
	speed: 0.2363s/iter; left time: 3069.4355s
Epoch: 16 cost time: 10.000161170959473
Epoch: 16, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.798 Vali Acc: 0.211 Test Loss: 2.798 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3463280
	speed: 0.2527s/iter; left time: 3244.4944s
Epoch: 17 cost time: 9.989453315734863
Epoch: 17, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.942 Vali Acc: 0.156 Test Loss: 2.942 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.9857095
	speed: 0.2414s/iter; left time: 3061.4799s
Epoch: 18 cost time: 10.250564098358154
Epoch: 18, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.196 Vali Acc: 0.211 Test Loss: 3.196 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4581469
	speed: 0.2287s/iter; left time: 2865.4509s
Epoch: 19 cost time: 10.134583711624146
Epoch: 19, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.242 Vali Acc: 0.075 Test Loss: 3.242 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.8130878
	speed: 0.2301s/iter; left time: 2847.1311s
Epoch: 20 cost time: 10.103681325912476
Epoch: 20, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.939 Vali Acc: 0.086 Test Loss: 2.939 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3530974
	speed: 0.2434s/iter; left time: 2974.4511s
Epoch: 21 cost time: 10.126941442489624
Epoch: 21, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.851 Vali Acc: 0.164 Test Loss: 2.851 Test Acc: 0.164
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.1424376
	speed: 0.2437s/iter; left time: 2940.7339s
Epoch: 22 cost time: 9.563458681106567
Epoch: 22, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.716 Vali Acc: 0.123 Test Loss: 3.716 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 434994
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6243110
	speed: 0.0868s/iter; left time: 1327.9308s
Epoch: 1 cost time: 12.015385389328003
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4344451
	speed: 0.2271s/iter; left time: 3439.3112s
Epoch: 2 cost time: 9.337665319442749
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.161 Vali Acc: 0.316 Test Loss: 2.161 Test Acc: 0.316
Validation loss decreased (-0.314658 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0712452
	speed: 0.2236s/iter; left time: 3352.0436s
Epoch: 3 cost time: 9.771887063980103
Epoch: 3, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.049 Vali Acc: 0.335 Test Loss: 2.049 Test Acc: 0.335
Validation loss decreased (-0.316280 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0825710
	speed: 0.2301s/iter; left time: 3414.9059s
Epoch: 4 cost time: 10.69306755065918
Epoch: 4, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.007 Vali Acc: 0.360 Test Loss: 2.007 Test Acc: 0.360
Validation loss decreased (-0.335340 --> -0.359672).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4095957
	speed: 0.2337s/iter; left time: 3432.3609s
Epoch: 5 cost time: 9.64265251159668
Epoch: 5, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.401 Vali Acc: 0.334 Test Loss: 2.401 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4722229
	speed: 0.2334s/iter; left time: 3390.9770s
Epoch: 6 cost time: 9.481283903121948
Epoch: 6, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.239 Vali Acc: 0.367 Test Loss: 2.239 Test Acc: 0.367
Validation loss decreased (-0.359672 --> -0.366969).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5347595
	speed: 0.2383s/iter; left time: 3425.6714s
Epoch: 7 cost time: 9.733316659927368
Epoch: 7, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.971 Vali Acc: 0.178 Test Loss: 2.971 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6385055
	speed: 0.2288s/iter; left time: 3253.5526s
Epoch: 8 cost time: 10.136852502822876
Epoch: 8, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.619 Vali Acc: 0.185 Test Loss: 2.619 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8274634
	speed: 0.2335s/iter; left time: 3285.1790s
Epoch: 9 cost time: 10.656373977661133
Epoch: 9, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.352 Vali Acc: 0.346 Test Loss: 2.352 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9930351
	speed: 0.2420s/iter; left time: 3366.9092s
Epoch: 10 cost time: 10.46257209777832
Epoch: 10, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.774 Vali Acc: 0.194 Test Loss: 2.774 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0236220
	speed: 0.2422s/iter; left time: 3332.9233s
Epoch: 11 cost time: 10.4285306930542
Epoch: 11, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.813 Vali Acc: 0.125 Test Loss: 2.813 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0547724
	speed: 0.2439s/iter; left time: 3319.4260s
Epoch: 12 cost time: 9.350626468658447
Epoch: 12, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.310 Vali Acc: 0.098 Test Loss: 3.310 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.1062088
	speed: 0.2282s/iter; left time: 3069.5101s
Epoch: 13 cost time: 9.262031316757202
Epoch: 13, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.907 Vali Acc: 0.190 Test Loss: 2.907 Test Acc: 0.190
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.8568035
	speed: 0.2196s/iter; left time: 2920.4913s
Epoch: 14 cost time: 9.912764310836792
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.930 Vali Acc: 0.160 Test Loss: 2.930 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2302294
	speed: 0.2276s/iter; left time: 2991.7123s
Epoch: 15 cost time: 9.718774318695068
Epoch: 15, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.763 Vali Acc: 0.256 Test Loss: 2.763 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0143274
	speed: 0.2291s/iter; left time: 2975.9358s
Epoch: 16 cost time: 9.953738927841187
Epoch: 16, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.823 Vali Acc: 0.256 Test Loss: 2.823 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 427602
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8809114
	speed: 0.0901s/iter; left time: 1378.6677s
Epoch: 1 cost time: 12.472981214523315
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0939600
	speed: 0.2486s/iter; left time: 3766.2397s
Epoch: 2 cost time: 10.533835887908936
Epoch: 2, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.165 Vali Acc: 0.317 Test Loss: 2.165 Test Acc: 0.317
Validation loss decreased (-0.315064 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1337528
	speed: 0.2520s/iter; left time: 3777.8675s
Epoch: 3 cost time: 10.7693932056427
Epoch: 3, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.146 Vali Acc: 0.326 Test Loss: 2.146 Test Acc: 0.326
Validation loss decreased (-0.317091 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5411040
	speed: 0.2625s/iter; left time: 3895.9595s
Epoch: 4 cost time: 10.860649824142456
Epoch: 4, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.156 Vali Acc: 0.332 Test Loss: 2.156 Test Acc: 0.332
Validation loss decreased (-0.325607 --> -0.332095).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7487241
	speed: 0.2583s/iter; left time: 3792.9387s
Epoch: 5 cost time: 11.767269134521484
Epoch: 5, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.055 Vali Acc: 0.352 Test Loss: 2.055 Test Acc: 0.352
Validation loss decreased (-0.332095 --> -0.352372).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7073319
	speed: 0.2618s/iter; left time: 3804.7229s
Epoch: 6 cost time: 10.081387042999268
Epoch: 6, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.297 Vali Acc: 0.372 Test Loss: 2.297 Test Acc: 0.372
Validation loss decreased (-0.352372 --> -0.372240).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9281223
	speed: 0.2647s/iter; left time: 3805.6508s
Epoch: 7 cost time: 11.102474689483643
Epoch: 7, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.380 Vali Acc: 0.221 Test Loss: 2.380 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8548670
	speed: 0.2620s/iter; left time: 3726.6445s
Epoch: 8 cost time: 10.907230138778687
Epoch: 8, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.666 Vali Acc: 0.123 Test Loss: 2.666 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7550006
	speed: 0.2494s/iter; left time: 3508.1862s
Epoch: 9 cost time: 11.141129493713379
Epoch: 9, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.869 Vali Acc: 0.135 Test Loss: 2.869 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6061151
	speed: 0.2386s/iter; left time: 3320.6575s
Epoch: 10 cost time: 10.23256802558899
Epoch: 10, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.426 Vali Acc: 0.388 Test Loss: 2.426 Test Acc: 0.388
Validation loss decreased (-0.372240 --> -0.388054).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6553763
	speed: 0.2403s/iter; left time: 3307.1430s
Epoch: 11 cost time: 11.3683922290802
Epoch: 11, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.674 Vali Acc: 0.352 Test Loss: 2.674 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4047287
	speed: 0.2325s/iter; left time: 3164.1536s
Epoch: 12 cost time: 9.848480939865112
Epoch: 12, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.380 Vali Acc: 0.380 Test Loss: 2.380 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0847149
	speed: 0.2243s/iter; left time: 3018.1240s
Epoch: 13 cost time: 9.990134716033936
Epoch: 13, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.862 Vali Acc: 0.153 Test Loss: 2.862 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4363844
	speed: 0.2221s/iter; left time: 2953.9801s
Epoch: 14 cost time: 9.085983514785767
Epoch: 14, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.940 Vali Acc: 0.196 Test Loss: 2.940 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3496071
	speed: 0.2306s/iter; left time: 3031.3756s
Epoch: 15 cost time: 9.938101291656494
Epoch: 15, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.570 Vali Acc: 0.358 Test Loss: 2.570 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3243110
	speed: 0.2481s/iter; left time: 3223.4430s
Epoch: 16 cost time: 9.861933946609497
Epoch: 16, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.158 Vali Acc: 0.177 Test Loss: 3.158 Test Acc: 0.177
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5608815
	speed: 0.2259s/iter; left time: 2899.8055s
Epoch: 17 cost time: 9.661783456802368
Epoch: 17, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.193 Vali Acc: 0.118 Test Loss: 3.193 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0577230
	speed: 0.2288s/iter; left time: 2901.7446s
Epoch: 18 cost time: 9.58890151977539
Epoch: 18, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.264 Vali Acc: 0.140 Test Loss: 3.264 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.9289145
	speed: 0.2564s/iter; left time: 3212.1005s
Epoch: 19 cost time: 10.463503360748291
Epoch: 19, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.746 Vali Acc: 0.365 Test Loss: 2.746 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.6934361
	speed: 0.2451s/iter; left time: 3032.5614s
Epoch: 20 cost time: 9.948146343231201
Epoch: 20, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.996 Vali Acc: 0.140 Test Loss: 2.996 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 427442
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3334363
	speed: 0.0732s/iter; left time: 1119.4749s
Epoch: 1 cost time: 10.28910517692566
Epoch: 1, Steps: 154 | Train Loss: 2.238 Vali Loss: 2.192 Vali Acc: 0.315 Test Loss: 2.192 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9643925
	speed: 0.2101s/iter; left time: 3182.1405s
Epoch: 2 cost time: 8.677077054977417
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.186 Vali Acc: 0.317 Test Loss: 2.186 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316685).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8320390
	speed: 0.2253s/iter; left time: 3378.4572s
Epoch: 3 cost time: 10.409377336502075
Epoch: 3, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.178 Vali Acc: 0.156 Test Loss: 2.178 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1623533
	speed: 0.2128s/iter; left time: 3157.7217s
Epoch: 4 cost time: 9.395254373550415
Epoch: 4, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.123 Vali Acc: 0.337 Test Loss: 2.123 Test Acc: 0.337
Validation loss decreased (-0.316685 --> -0.336556).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7020539
	speed: 0.2285s/iter; left time: 3355.6996s
Epoch: 5 cost time: 10.628636360168457
Epoch: 5, Steps: 154 | Train Loss: 1.858 Vali Loss: 1.985 Vali Acc: 0.342 Test Loss: 1.985 Test Acc: 0.342
Validation loss decreased (-0.336556 --> -0.342235).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6549596
	speed: 0.2243s/iter; left time: 3258.8601s
Epoch: 6 cost time: 8.67685055732727
Epoch: 6, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.264 Vali Acc: 0.345 Test Loss: 2.264 Test Acc: 0.345
Validation loss decreased (-0.342235 --> -0.345476).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8527650
	speed: 0.2118s/iter; left time: 3045.5131s
Epoch: 7 cost time: 8.930062055587769
Epoch: 7, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.344 Vali Acc: 0.352 Test Loss: 2.344 Test Acc: 0.352
Validation loss decreased (-0.345476 --> -0.351964).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6757182
	speed: 0.2280s/iter; left time: 3242.1907s
Epoch: 8 cost time: 10.506458520889282
Epoch: 8, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.531 Vali Acc: 0.375 Test Loss: 2.531 Test Acc: 0.375
Validation loss decreased (-0.351964 --> -0.375076).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7189956
	speed: 0.2346s/iter; left time: 3300.4760s
Epoch: 9 cost time: 10.09698486328125
Epoch: 9, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.793 Vali Acc: 0.108 Test Loss: 2.793 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6429980
	speed: 0.2223s/iter; left time: 3093.7120s
Epoch: 10 cost time: 10.203555583953857
Epoch: 10, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.705 Vali Acc: 0.196 Test Loss: 2.705 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4661762
	speed: 0.2287s/iter; left time: 3146.9424s
Epoch: 11 cost time: 10.320364236831665
Epoch: 11, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.991 Vali Acc: 0.103 Test Loss: 2.991 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7481993
	speed: 0.2262s/iter; left time: 3077.4747s
Epoch: 12 cost time: 9.174349784851074
Epoch: 12, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.754 Vali Acc: 0.358 Test Loss: 2.754 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6618119
	speed: 0.2160s/iter; left time: 2906.4204s
Epoch: 13 cost time: 8.766484260559082
Epoch: 13, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.466 Vali Acc: 0.101 Test Loss: 3.466 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.4884509
	speed: 0.2139s/iter; left time: 2844.4861s
Epoch: 14 cost time: 8.436285972595215
Epoch: 14, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.499 Vali Acc: 0.356 Test Loss: 2.499 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.3020428
	speed: 0.2193s/iter; left time: 2882.2758s
Epoch: 15 cost time: 9.504132509231567
Epoch: 15, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.247 Vali Acc: 0.118 Test Loss: 3.247 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.5178273
	speed: 0.2194s/iter; left time: 2850.2085s
Epoch: 16 cost time: 9.526859760284424
Epoch: 16, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.748 Vali Acc: 0.102 Test Loss: 2.748 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3964617
	speed: 0.2312s/iter; left time: 2968.2419s
Epoch: 17 cost time: 11.50680923461914
Epoch: 17, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.020 Vali Acc: 0.150 Test Loss: 3.020 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.4093050
	speed: 0.2221s/iter; left time: 2816.9092s
Epoch: 18 cost time: 8.994823455810547
Epoch: 18, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.808 Vali Acc: 0.378 Test Loss: 2.808 Test Acc: 0.378
Validation loss decreased (-0.375076 --> -0.377506).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1053839
	speed: 0.2096s/iter; left time: 2626.4399s
Epoch: 19 cost time: 9.475614786148071
Epoch: 19, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.659 Vali Acc: 0.155 Test Loss: 2.659 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4079025
	speed: 0.2162s/iter; left time: 2675.4138s
Epoch: 20 cost time: 10.096480131149292
Epoch: 20, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.793 Vali Acc: 0.152 Test Loss: 2.793 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2841328
	speed: 0.2245s/iter; left time: 2743.7542s
Epoch: 21 cost time: 8.738667011260986
Epoch: 21, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.342 Vali Acc: 0.112 Test Loss: 3.342 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.9392090
	speed: 0.2283s/iter; left time: 2755.1881s
Epoch: 22 cost time: 10.279896259307861
Epoch: 22, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.105 Vali Acc: 0.124 Test Loss: 3.105 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3533133
	speed: 0.2095s/iter; left time: 2496.1932s
Epoch: 23 cost time: 9.008426666259766
Epoch: 23, Steps: 154 | Train Loss: 1.313 Vali Loss: 2.716 Vali Acc: 0.195 Test Loss: 2.716 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.5730364
	speed: 0.2178s/iter; left time: 2561.6248s
Epoch: 24 cost time: 9.369496583938599
Epoch: 24, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.167 Vali Acc: 0.144 Test Loss: 3.167 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.2809505
	speed: 0.2233s/iter; left time: 2591.0818s
Epoch: 25 cost time: 9.816930294036865
Epoch: 25, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.495 Vali Acc: 0.200 Test Loss: 3.495 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.4385886
	speed: 0.2127s/iter; left time: 2435.8177s
Epoch: 26 cost time: 9.881865739822388
Epoch: 26, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.145 Vali Acc: 0.118 Test Loss: 3.145 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.3792477
	speed: 0.2214s/iter; left time: 2501.1986s
Epoch: 27 cost time: 9.40176272392273
Epoch: 27, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.808 Vali Acc: 0.092 Test Loss: 3.808 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1713963
	speed: 0.1824s/iter; left time: 2032.3852s
Epoch: 28 cost time: 8.058686971664429
Epoch: 28, Steps: 154 | Train Loss: 1.235 Vali Loss: 3.561 Vali Acc: 0.076 Test Loss: 3.561 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 427282
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1547999
	speed: 0.0783s/iter; left time: 1198.2096s
Epoch: 1 cost time: 10.809991359710693
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9504883
	speed: 0.2153s/iter; left time: 3260.9474s
Epoch: 2 cost time: 9.042362928390503
Epoch: 2, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.138 Vali Acc: 0.321 Test Loss: 2.138 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4443276
	speed: 0.2032s/iter; left time: 3045.8888s
Epoch: 3 cost time: 8.707830667495728
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.114 Vali Acc: 0.325 Test Loss: 2.114 Test Acc: 0.325
Validation loss decreased (-0.321146 --> -0.325202).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0614722
	speed: 0.2109s/iter; left time: 3129.7929s
Epoch: 4 cost time: 8.861507415771484
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.092 Vali Acc: 0.341 Test Loss: 2.092 Test Acc: 0.341
Validation loss decreased (-0.325202 --> -0.340612).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0286527
	speed: 0.2175s/iter; left time: 3193.2685s
Epoch: 5 cost time: 9.238431692123413
Epoch: 5, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.214 Vali Acc: 0.370 Test Loss: 2.214 Test Acc: 0.370
Validation loss decreased (-0.340612 --> -0.370213).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6703557
	speed: 0.1906s/iter; left time: 2769.2220s
Epoch: 6 cost time: 7.7623913288116455
Epoch: 6, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.381 Vali Acc: 0.351 Test Loss: 2.381 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3675078
	speed: 0.2167s/iter; left time: 3115.2015s
Epoch: 7 cost time: 9.434528589248657
Epoch: 7, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.334 Vali Acc: 0.189 Test Loss: 2.334 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6788629
	speed: 0.2128s/iter; left time: 3026.5731s
Epoch: 8 cost time: 8.682099103927612
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.688 Vali Acc: 0.192 Test Loss: 2.688 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.1112366
	speed: 0.2103s/iter; left time: 2958.1443s
Epoch: 9 cost time: 8.543279886245728
Epoch: 9, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.337 Vali Acc: 0.356 Test Loss: 2.337 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7906846
	speed: 0.2247s/iter; left time: 3126.6065s
Epoch: 10 cost time: 9.164883852005005
Epoch: 10, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.465 Vali Acc: 0.364 Test Loss: 2.465 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.7693987
	speed: 0.2103s/iter; left time: 2894.5154s
Epoch: 11 cost time: 9.290194272994995
Epoch: 11, Steps: 154 | Train Loss: 1.528 Vali Loss: 3.220 Vali Acc: 0.225 Test Loss: 3.220 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.8714970
	speed: 0.2259s/iter; left time: 3073.8265s
Epoch: 12 cost time: 9.449350833892822
Epoch: 12, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.553 Vali Acc: 0.368 Test Loss: 2.553 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3658739
	speed: 0.2318s/iter; left time: 3118.5326s
Epoch: 13 cost time: 9.647291898727417
Epoch: 13, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.689 Vali Acc: 0.200 Test Loss: 2.689 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2910156
	speed: 0.2184s/iter; left time: 2903.9402s
Epoch: 14 cost time: 9.029433727264404
Epoch: 14, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.432 Vali Acc: 0.369 Test Loss: 2.432 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2439108
	speed: 0.2140s/iter; left time: 2812.5527s
Epoch: 15 cost time: 9.314997434616089
Epoch: 15, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.538 Vali Acc: 0.371 Test Loss: 2.538 Test Acc: 0.371
Validation loss decreased (-0.370213 --> -0.371021).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2341745
	speed: 0.2172s/iter; left time: 2821.9956s
Epoch: 16 cost time: 8.976078987121582
Epoch: 16, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.714 Vali Acc: 0.345 Test Loss: 2.714 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2608078
	speed: 0.2197s/iter; left time: 2819.6538s
Epoch: 17 cost time: 9.739151239395142
Epoch: 17, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.150 Vali Acc: 0.200 Test Loss: 3.150 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6146765
	speed: 0.2118s/iter; left time: 2686.1841s
Epoch: 18 cost time: 8.609848022460938
Epoch: 18, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.565 Vali Acc: 0.371 Test Loss: 2.565 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5259542
	speed: 0.2072s/iter; left time: 2596.4610s
Epoch: 19 cost time: 9.219738483428955
Epoch: 19, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.757 Vali Acc: 0.135 Test Loss: 2.757 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.1575632
	speed: 0.2264s/iter; left time: 2802.0706s
Epoch: 20 cost time: 8.386860609054565
Epoch: 20, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.998 Vali Acc: 0.129 Test Loss: 2.998 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.1148753
	speed: 0.1950s/iter; left time: 2382.5827s
Epoch: 21 cost time: 9.015471458435059
Epoch: 21, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.750 Vali Acc: 0.159 Test Loss: 2.750 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6747907
	speed: 0.2033s/iter; left time: 2452.9926s
Epoch: 22 cost time: 8.576601266860962
Epoch: 22, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.588 Vali Acc: 0.206 Test Loss: 2.588 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3787218
	speed: 0.2219s/iter; left time: 2643.0019s
Epoch: 23 cost time: 8.882806539535522
Epoch: 23, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.646 Vali Acc: 0.140 Test Loss: 2.646 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 2.0915842
	speed: 0.2051s/iter; left time: 2411.7603s
Epoch: 24 cost time: 8.617173910140991
Epoch: 24, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.870 Vali Acc: 0.133 Test Loss: 2.870 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.4060992
	speed: 0.2178s/iter; left time: 2527.2096s
Epoch: 25 cost time: 9.309760570526123
Epoch: 25, Steps: 154 | Train Loss: 1.286 Vali Loss: 2.666 Vali Acc: 0.128 Test Loss: 2.666 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 427122
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1656742
	speed: 0.0855s/iter; left time: 1307.7290s
Epoch: 1 cost time: 11.550379276275635
Epoch: 1, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.178 Vali Acc: 0.318 Test Loss: 2.178 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1311133
	speed: 0.2139s/iter; left time: 3240.5207s
Epoch: 2 cost time: 8.688697814941406
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0931354
	speed: 0.2031s/iter; left time: 3044.5430s
Epoch: 3 cost time: 8.307801008224487
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.145 Vali Acc: 0.328 Test Loss: 2.145 Test Acc: 0.328
Validation loss decreased (-0.317902 --> -0.328446).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8261986
	speed: 0.2072s/iter; left time: 3074.9714s
Epoch: 4 cost time: 8.7044095993042
Epoch: 4, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.171 Vali Acc: 0.326 Test Loss: 2.171 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7716773
	speed: 0.2148s/iter; left time: 3155.0460s
Epoch: 5 cost time: 8.852231740951538
Epoch: 5, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.268 Vali Acc: 0.346 Test Loss: 2.268 Test Acc: 0.346
Validation loss decreased (-0.328446 --> -0.345882).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6943684
	speed: 0.2016s/iter; left time: 2929.8747s
Epoch: 6 cost time: 8.455446243286133
Epoch: 6, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.273 Vali Acc: 0.369 Test Loss: 2.273 Test Acc: 0.369
Validation loss decreased (-0.345882 --> -0.368996).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6305314
	speed: 0.1918s/iter; left time: 2757.5226s
Epoch: 7 cost time: 9.09823489189148
Epoch: 7, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.684 Vali Acc: 0.190 Test Loss: 2.684 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1748078
	speed: 0.2194s/iter; left time: 3119.8977s
Epoch: 8 cost time: 8.519843578338623
Epoch: 8, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.849 Vali Acc: 0.163 Test Loss: 2.849 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1292764
	speed: 0.2052s/iter; left time: 2887.4979s
Epoch: 9 cost time: 8.559570074081421
Epoch: 9, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.522 Vali Acc: 0.347 Test Loss: 2.522 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6775296
	speed: 0.2113s/iter; left time: 2939.6932s
Epoch: 10 cost time: 8.616188049316406
Epoch: 10, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.231 Vali Acc: 0.102 Test Loss: 3.231 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7693720
	speed: 0.1903s/iter; left time: 2619.3703s
Epoch: 11 cost time: 9.034106492996216
Epoch: 11, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.241 Vali Acc: 0.103 Test Loss: 3.241 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.6508480
	speed: 0.1928s/iter; left time: 2623.4208s
Epoch: 12 cost time: 8.13560962677002
Epoch: 12, Steps: 154 | Train Loss: 1.508 Vali Loss: 3.201 Vali Acc: 0.072 Test Loss: 3.201 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.5535250
	speed: 0.1844s/iter; left time: 2480.7502s
Epoch: 13 cost time: 7.013540506362915
Epoch: 13, Steps: 154 | Train Loss: 1.507 Vali Loss: 3.030 Vali Acc: 0.188 Test Loss: 3.030 Test Acc: 0.188
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9441667
	speed: 0.1821s/iter; left time: 2422.3723s
Epoch: 14 cost time: 8.633711099624634
Epoch: 14, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.287 Vali Acc: 0.193 Test Loss: 3.287 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0080638
	speed: 0.1763s/iter; left time: 2317.6593s
Epoch: 15 cost time: 8.411475658416748
Epoch: 15, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.399 Vali Acc: 0.116 Test Loss: 3.399 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.4844358
	speed: 0.1923s/iter; left time: 2498.4345s
Epoch: 16 cost time: 8.34603214263916
Epoch: 16, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.627 Vali Acc: 0.114 Test Loss: 3.627 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36901865369018655
model parameter : 261202
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4049573
	speed: 0.0772s/iter; left time: 1181.2889s
Epoch: 1 cost time: 10.465039730072021
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.201 Vali Acc: 0.315 Test Loss: 2.201 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3931723
	speed: 0.1935s/iter; left time: 2931.5545s
Epoch: 2 cost time: 8.255815982818604
Epoch: 2, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315064).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7916819
	speed: 0.2155s/iter; left time: 3230.8064s
Epoch: 3 cost time: 8.8605318069458
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.118 Vali Acc: 0.326 Test Loss: 2.118 Test Acc: 0.326
Validation loss decreased (-0.315064 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8131226
	speed: 0.2309s/iter; left time: 3425.7513s
Epoch: 4 cost time: 9.101871252059937
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.180 Vali Acc: 0.352 Test Loss: 2.180 Test Acc: 0.352
Validation loss decreased (-0.325607 --> -0.351560).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6908576
	speed: 0.2036s/iter; left time: 2990.0521s
Epoch: 5 cost time: 7.996810674667358
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.103 Vali Acc: 0.346 Test Loss: 2.103 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7543356
	speed: 0.1960s/iter; left time: 2847.6883s
Epoch: 6 cost time: 8.845962047576904
Epoch: 6, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.039 Vali Acc: 0.352 Test Loss: 2.039 Test Acc: 0.352
Validation loss decreased (-0.351560 --> -0.351561).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8335584
	speed: 0.2158s/iter; left time: 3103.0805s
Epoch: 7 cost time: 9.437807559967041
Epoch: 7, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.326 Vali Acc: 0.351 Test Loss: 2.326 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6618299
	speed: 0.2025s/iter; left time: 2879.6784s
Epoch: 8 cost time: 8.432659149169922
Epoch: 8, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.696 Vali Acc: 0.191 Test Loss: 2.696 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6445662
	speed: 0.2068s/iter; left time: 2909.3503s
Epoch: 9 cost time: 9.434752464294434
Epoch: 9, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.639 Vali Acc: 0.191 Test Loss: 2.639 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5938519
	speed: 0.2129s/iter; left time: 2962.3073s
Epoch: 10 cost time: 8.761250257492065
Epoch: 10, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.764 Vali Acc: 0.184 Test Loss: 2.764 Test Acc: 0.184
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8893117
	speed: 0.1949s/iter; left time: 2681.8994s
Epoch: 11 cost time: 8.714073896408081
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.568 Vali Acc: 0.241 Test Loss: 2.568 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.0203054
	speed: 0.2063s/iter; left time: 2806.4547s
Epoch: 12 cost time: 9.435402870178223
Epoch: 12, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.399 Vali Acc: 0.099 Test Loss: 3.399 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8320800
	speed: 0.2216s/iter; left time: 2980.7056s
Epoch: 13 cost time: 8.559918880462646
Epoch: 13, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.222 Vali Acc: 0.185 Test Loss: 3.222 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1815426
	speed: 0.1925s/iter; left time: 2559.6653s
Epoch: 14 cost time: 8.228925943374634
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.922 Vali Acc: 0.172 Test Loss: 2.922 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0264150
	speed: 0.1976s/iter; left time: 2597.0505s
Epoch: 15 cost time: 8.405157566070557
Epoch: 15, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.173 Vali Acc: 0.109 Test Loss: 3.173 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2843335
	speed: 0.1980s/iter; left time: 2572.3256s
Epoch: 16 cost time: 8.72953748703003
Epoch: 16, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.201 Vali Acc: 0.193 Test Loss: 3.201 Test Acc: 0.193
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3515815085158151
model parameter : 261042
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0001409
	speed: 0.0758s/iter; left time: 1160.5427s
Epoch: 1 cost time: 10.56079888343811
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4446571
	speed: 0.2352s/iter; left time: 3562.4439s
Epoch: 2 cost time: 9.820235252380371
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.218 Vali Acc: 0.315 Test Loss: 2.218 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0605450
	speed: 0.2196s/iter; left time: 3292.1019s
Epoch: 3 cost time: 9.072640419006348
Epoch: 3, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.151 Vali Acc: 0.319 Test Loss: 2.151 Test Acc: 0.319
Validation loss decreased (-0.315063 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9779975
	speed: 0.2296s/iter; left time: 3407.7703s
Epoch: 4 cost time: 9.518598318099976
Epoch: 4, Steps: 154 | Train Loss: 2.010 Vali Loss: 2.149 Vali Acc: 0.326 Test Loss: 2.149 Test Acc: 0.326
Validation loss decreased (-0.318713 --> -0.326013).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5390102
	speed: 0.2061s/iter; left time: 3026.6277s
Epoch: 5 cost time: 8.880394220352173
Epoch: 5, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.090 Vali Acc: 0.338 Test Loss: 2.090 Test Acc: 0.338
Validation loss decreased (-0.326013 --> -0.338179).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9691470
	speed: 0.2098s/iter; left time: 3048.6702s
Epoch: 6 cost time: 8.945128202438354
Epoch: 6, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.419 Vali Acc: 0.186 Test Loss: 2.419 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1830289
	speed: 0.2107s/iter; left time: 3028.7654s
Epoch: 7 cost time: 8.974018573760986
Epoch: 7, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.251 Vali Acc: 0.350 Test Loss: 2.251 Test Acc: 0.350
Validation loss decreased (-0.338179 --> -0.349937).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3300947
	speed: 0.2162s/iter; left time: 3075.3529s
Epoch: 8 cost time: 8.166073083877563
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.619 Vali Acc: 0.120 Test Loss: 2.619 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1208236
	speed: 0.2003s/iter; left time: 2818.1573s
Epoch: 9 cost time: 8.403442144393921
Epoch: 9, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.513 Vali Acc: 0.355 Test Loss: 2.513 Test Acc: 0.355
Validation loss decreased (-0.349937 --> -0.354801).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3387549
	speed: 0.2142s/iter; left time: 2980.7693s
Epoch: 10 cost time: 9.585159063339233
Epoch: 10, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.764 Vali Acc: 0.102 Test Loss: 2.764 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6614825
	speed: 0.2140s/iter; left time: 2945.5087s
Epoch: 11 cost time: 9.231085777282715
Epoch: 11, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.967 Vali Acc: 0.163 Test Loss: 2.967 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1582623
	speed: 0.2127s/iter; left time: 2894.8199s
Epoch: 12 cost time: 8.841781377792358
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.932 Vali Acc: 0.365 Test Loss: 2.932 Test Acc: 0.365
Validation loss decreased (-0.354801 --> -0.365340).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4817412
	speed: 0.2151s/iter; left time: 2893.3789s
Epoch: 13 cost time: 10.097108364105225
Epoch: 13, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.953 Vali Acc: 0.197 Test Loss: 2.953 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.0934591
	speed: 0.2192s/iter; left time: 2914.6812s
Epoch: 14 cost time: 9.335663318634033
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.350 Vali Acc: 0.108 Test Loss: 3.350 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2119941
	speed: 0.2058s/iter; left time: 2705.4171s
Epoch: 15 cost time: 9.799329996109009
Epoch: 15, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.158 Vali Acc: 0.127 Test Loss: 3.158 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.1229856
	speed: 0.2181s/iter; left time: 2832.7115s
Epoch: 16 cost time: 8.974648714065552
Epoch: 16, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.913 Vali Acc: 0.198 Test Loss: 2.913 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4863278
	speed: 0.2275s/iter; left time: 2920.7263s
Epoch: 17 cost time: 10.008936166763306
Epoch: 17, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.152 Vali Acc: 0.171 Test Loss: 3.152 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5266986
	speed: 0.2267s/iter; left time: 2875.3760s
Epoch: 18 cost time: 8.419120073318481
Epoch: 18, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.488 Vali Acc: 0.124 Test Loss: 3.488 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.5547717
	speed: 0.2227s/iter; left time: 2790.2684s
Epoch: 19 cost time: 8.856445550918579
Epoch: 19, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.686 Vali Acc: 0.373 Test Loss: 2.686 Test Acc: 0.373
Validation loss decreased (-0.365340 --> -0.373047).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1749951
	speed: 0.2132s/iter; left time: 2638.6423s
Epoch: 20 cost time: 8.50125765800476
Epoch: 20, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.700 Vali Acc: 0.313 Test Loss: 2.700 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4280101
	speed: 0.1820s/iter; left time: 2224.7880s
Epoch: 21 cost time: 8.804374694824219
Epoch: 21, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.972 Vali Acc: 0.139 Test Loss: 2.972 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4572622
	speed: 0.2094s/iter; left time: 2526.6154s
Epoch: 22 cost time: 9.624015092849731
Epoch: 22, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.837 Vali Acc: 0.198 Test Loss: 2.837 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9995204
	speed: 0.2167s/iter; left time: 2581.1616s
Epoch: 23 cost time: 9.666836738586426
Epoch: 23, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.218 Vali Acc: 0.127 Test Loss: 3.218 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1633689
	speed: 0.2164s/iter; left time: 2545.0625s
Epoch: 24 cost time: 9.163071632385254
Epoch: 24, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.348 Vali Acc: 0.125 Test Loss: 3.348 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.3506142
	speed: 0.2109s/iter; left time: 2447.8190s
Epoch: 25 cost time: 8.723980903625488
Epoch: 25, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.548 Vali Acc: 0.122 Test Loss: 3.548 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.1923493
	speed: 0.2071s/iter; left time: 2371.9511s
Epoch: 26 cost time: 8.494587421417236
Epoch: 26, Steps: 154 | Train Loss: 1.255 Vali Loss: 3.250 Vali Acc: 0.131 Test Loss: 3.250 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2965472
	speed: 0.2023s/iter; left time: 2285.7081s
Epoch: 27 cost time: 8.387004375457764
Epoch: 27, Steps: 154 | Train Loss: 1.252 Vali Loss: 4.007 Vali Acc: 0.119 Test Loss: 4.007 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.1276907
	speed: 0.2064s/iter; left time: 2300.2555s
Epoch: 28 cost time: 8.66375184059143
Epoch: 28, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.500 Vali Acc: 0.082 Test Loss: 3.500 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.3268669
	speed: 0.2234s/iter; left time: 2455.4819s
Epoch: 29 cost time: 10.145466566085815
Epoch: 29, Steps: 154 | Train Loss: 1.225 Vali Loss: 3.745 Vali Acc: 0.116 Test Loss: 3.745 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 260882
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2894230
	speed: 0.0811s/iter; left time: 1240.9921s
Epoch: 1 cost time: 11.293065309524536
Epoch: 1, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.142 Vali Acc: 0.315 Test Loss: 2.142 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9626479
	speed: 0.2145s/iter; left time: 3248.7336s
Epoch: 2 cost time: 8.680959939956665
Epoch: 2, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.146 Vali Acc: 0.317 Test Loss: 2.146 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9200113
	speed: 0.2147s/iter; left time: 3219.2458s
Epoch: 3 cost time: 9.334923267364502
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.217 Vali Acc: 0.325 Test Loss: 2.217 Test Acc: 0.325
Validation loss decreased (-0.316686 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0280240
	speed: 0.2144s/iter; left time: 3180.7624s
Epoch: 4 cost time: 9.093859910964966
Epoch: 4, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.087 Vali Acc: 0.336 Test Loss: 2.087 Test Acc: 0.336
Validation loss decreased (-0.325201 --> -0.335746).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0713310
	speed: 0.2182s/iter; left time: 3203.6321s
Epoch: 5 cost time: 8.665143013000488
Epoch: 5, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.346 Vali Acc: 0.343 Test Loss: 2.346 Test Acc: 0.343
Validation loss decreased (-0.335746 --> -0.343448).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5871699
	speed: 0.2018s/iter; left time: 2933.0501s
Epoch: 6 cost time: 8.270878076553345
Epoch: 6, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.446 Vali Acc: 0.186 Test Loss: 2.446 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6511205
	speed: 0.1928s/iter; left time: 2771.1989s
Epoch: 7 cost time: 8.288504123687744
Epoch: 7, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.312 Vali Acc: 0.247 Test Loss: 2.312 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1751565
	speed: 0.1886s/iter; left time: 2683.1228s
Epoch: 8 cost time: 8.7106192111969
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.689 Vali Acc: 0.184 Test Loss: 2.689 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4636300
	speed: 0.1958s/iter; left time: 2755.1104s
Epoch: 9 cost time: 8.300871133804321
Epoch: 9, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.950 Vali Acc: 0.103 Test Loss: 2.950 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3160893
	speed: 0.2093s/iter; left time: 2912.4161s
Epoch: 10 cost time: 8.858446598052979
Epoch: 10, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.631 Vali Acc: 0.121 Test Loss: 2.631 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4487152
	speed: 0.2136s/iter; left time: 2939.6460s
Epoch: 11 cost time: 8.539745569229126
Epoch: 11, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.788 Vali Acc: 0.200 Test Loss: 2.788 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.2723737
	speed: 0.2031s/iter; left time: 2763.4313s
Epoch: 12 cost time: 8.666738271713257
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.440 Vali Acc: 0.159 Test Loss: 3.440 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2111416
	speed: 0.2069s/iter; left time: 2782.8929s
Epoch: 13 cost time: 8.362032413482666
Epoch: 13, Steps: 154 | Train Loss: 1.491 Vali Loss: 3.132 Vali Acc: 0.119 Test Loss: 3.132 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6946822
	speed: 0.2129s/iter; left time: 2831.5146s
Epoch: 14 cost time: 9.653047800064087
Epoch: 14, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.992 Vali Acc: 0.120 Test Loss: 2.992 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5559189
	speed: 0.2274s/iter; left time: 2988.7738s
Epoch: 15 cost time: 8.84741735458374
Epoch: 15, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.019 Vali Acc: 0.131 Test Loss: 3.019 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34347120843471207
model parameter : 260722
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9069636
	speed: 0.0774s/iter; left time: 1184.9274s
Epoch: 1 cost time: 10.691077709197998
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9438918
	speed: 0.2138s/iter; left time: 3238.5082s
Epoch: 2 cost time: 8.507027864456177
Epoch: 2, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.141 Vali Acc: 0.315 Test Loss: 2.141 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2414544
	speed: 0.2101s/iter; left time: 3149.3855s
Epoch: 3 cost time: 8.788847923278809
Epoch: 3, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.117 Vali Acc: 0.322 Test Loss: 2.117 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6119730
	speed: 0.2317s/iter; left time: 3437.4861s
Epoch: 4 cost time: 9.117306232452393
Epoch: 4, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.048 Vali Acc: 0.333 Test Loss: 2.048 Test Acc: 0.333
Validation loss decreased (-0.322363 --> -0.332907).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6343143
	speed: 0.2168s/iter; left time: 3183.7492s
Epoch: 5 cost time: 8.759633302688599
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.072 Vali Acc: 0.347 Test Loss: 2.072 Test Acc: 0.347
Validation loss decreased (-0.332907 --> -0.346695).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1088972
	speed: 0.1964s/iter; left time: 2853.8920s
Epoch: 6 cost time: 8.17714810371399
Epoch: 6, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.285 Vali Acc: 0.209 Test Loss: 2.285 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1475563
	speed: 0.2025s/iter; left time: 2911.6406s
Epoch: 7 cost time: 8.9475839138031
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.510 Vali Acc: 0.195 Test Loss: 2.510 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5441186
	speed: 0.2074s/iter; left time: 2950.4811s
Epoch: 8 cost time: 8.518004179000854
Epoch: 8, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.481 Vali Acc: 0.354 Test Loss: 2.481 Test Acc: 0.354
Validation loss decreased (-0.346695 --> -0.353584).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0341917
	speed: 0.2169s/iter; left time: 3050.9792s
Epoch: 9 cost time: 8.554346323013306
Epoch: 9, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.373 Vali Acc: 0.382 Test Loss: 2.373 Test Acc: 0.382
Validation loss decreased (-0.353584 --> -0.381971).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4921894
	speed: 0.2197s/iter; left time: 3057.2106s
Epoch: 10 cost time: 8.976592302322388
Epoch: 10, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.877 Vali Acc: 0.266 Test Loss: 2.877 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2332215
	speed: 0.2101s/iter; left time: 2891.0004s
Epoch: 11 cost time: 9.137266874313354
Epoch: 11, Steps: 154 | Train Loss: 1.535 Vali Loss: 3.167 Vali Acc: 0.192 Test Loss: 3.167 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7279243
	speed: 0.1979s/iter; left time: 2693.4129s
Epoch: 12 cost time: 8.012261629104614
Epoch: 12, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.964 Vali Acc: 0.127 Test Loss: 2.964 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1132052
	speed: 0.2028s/iter; left time: 2728.0402s
Epoch: 13 cost time: 8.94099497795105
Epoch: 13, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.888 Vali Acc: 0.153 Test Loss: 2.888 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.9644488
	speed: 0.2132s/iter; left time: 2835.3563s
Epoch: 14 cost time: 7.931980609893799
Epoch: 14, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.372 Vali Acc: 0.102 Test Loss: 3.372 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.2352642
	speed: 0.1996s/iter; left time: 2623.4419s
Epoch: 15 cost time: 9.641325235366821
Epoch: 15, Steps: 154 | Train Loss: 1.448 Vali Loss: 3.052 Vali Acc: 0.191 Test Loss: 3.052 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4642497
	speed: 0.2177s/iter; left time: 2828.2553s
Epoch: 16 cost time: 8.810991525650024
Epoch: 16, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.545 Vali Acc: 0.056 Test Loss: 3.545 Test Acc: 0.056
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3403586
	speed: 0.2130s/iter; left time: 2734.0339s
Epoch: 17 cost time: 9.158945798873901
Epoch: 17, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.179 Vali Acc: 0.225 Test Loss: 3.179 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.8535409
	speed: 0.2216s/iter; left time: 2810.7572s
Epoch: 18 cost time: 8.799596309661865
Epoch: 18, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.692 Vali Acc: 0.062 Test Loss: 3.692 Test Acc: 0.062
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.7964671
	speed: 0.2109s/iter; left time: 2642.9189s
Epoch: 19 cost time: 9.32489824295044
Epoch: 19, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.385 Vali Acc: 0.121 Test Loss: 3.385 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 178002
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9810069
	speed: 0.0698s/iter; left time: 1067.6865s
Epoch: 1 cost time: 9.85510516166687
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 2.196 Vali Acc: 0.155 Test Loss: 2.196 Test Acc: 0.155
Validation loss decreased (inf --> -0.154885).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0479493
	speed: 0.2025s/iter; left time: 3066.8532s
Epoch: 2 cost time: 8.38498044013977
Epoch: 2, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.131 Vali Acc: 0.315 Test Loss: 2.131 Test Acc: 0.315
Validation loss decreased (-0.154885 --> -0.314658).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2535577
	speed: 0.1872s/iter; left time: 2806.4454s
Epoch: 3 cost time: 7.981464862823486
Epoch: 3, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.111 Vali Acc: 0.324 Test Loss: 2.111 Test Acc: 0.324
Validation loss decreased (-0.314658 --> -0.323985).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2185152
	speed: 0.1843s/iter; left time: 2734.6634s
Epoch: 4 cost time: 8.013983964920044
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.129 Vali Acc: 0.321 Test Loss: 2.129 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7539572
	speed: 0.1977s/iter; left time: 2902.5226s
Epoch: 5 cost time: 8.644288301467896
Epoch: 5, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.273 Vali Acc: 0.337 Test Loss: 2.273 Test Acc: 0.337
Validation loss decreased (-0.323985 --> -0.337366).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6357205
	speed: 0.2051s/iter; left time: 2980.2654s
Epoch: 6 cost time: 8.858376741409302
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.265 Vali Acc: 0.336 Test Loss: 2.265 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7029284
	speed: 0.1966s/iter; left time: 2826.0302s
Epoch: 7 cost time: 8.275550365447998
Epoch: 7, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.355 Vali Acc: 0.188 Test Loss: 2.355 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8078561
	speed: 0.1818s/iter; left time: 2586.0688s
Epoch: 8 cost time: 8.140753984451294
Epoch: 8, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.487 Vali Acc: 0.190 Test Loss: 2.487 Test Acc: 0.190
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3830506
	speed: 0.1864s/iter; left time: 2622.8081s
Epoch: 9 cost time: 8.482853651046753
Epoch: 9, Steps: 154 | Train Loss: 1.603 Vali Loss: 3.041 Vali Acc: 0.177 Test Loss: 3.041 Test Acc: 0.177
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4661210
	speed: 0.1850s/iter; left time: 2574.4421s
Epoch: 10 cost time: 7.673572301864624
Epoch: 10, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.557 Vali Acc: 0.387 Test Loss: 2.557 Test Acc: 0.387
Validation loss decreased (-0.337366 --> -0.387241).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8008602
	speed: 0.1979s/iter; left time: 2723.3527s
Epoch: 11 cost time: 9.054423093795776
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.293 Vali Acc: 0.130 Test Loss: 3.293 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8310685
	speed: 0.2014s/iter; left time: 2739.8816s
Epoch: 12 cost time: 8.446665048599243
Epoch: 12, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.994 Vali Acc: 0.358 Test Loss: 2.994 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4074284
	speed: 0.1902s/iter; left time: 2559.2803s
Epoch: 13 cost time: 8.224250078201294
Epoch: 13, Steps: 154 | Train Loss: 1.510 Vali Loss: 3.246 Vali Acc: 0.103 Test Loss: 3.246 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4193008
	speed: 0.1981s/iter; left time: 2633.9401s
Epoch: 14 cost time: 8.655289888381958
Epoch: 14, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.278 Vali Acc: 0.181 Test Loss: 3.278 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5257595
	speed: 0.2055s/iter; left time: 2700.8058s
Epoch: 15 cost time: 8.186270952224731
Epoch: 15, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.320 Vali Acc: 0.113 Test Loss: 3.320 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.7289075
	speed: 0.2031s/iter; left time: 2638.4664s
Epoch: 16 cost time: 8.566841840744019
Epoch: 16, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.566 Vali Acc: 0.110 Test Loss: 3.566 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.4541628
	speed: 0.2120s/iter; left time: 2721.9018s
Epoch: 17 cost time: 9.092676162719727
Epoch: 17, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.605 Vali Acc: 0.107 Test Loss: 3.605 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9199004
	speed: 0.1925s/iter; left time: 2441.5948s
Epoch: 18 cost time: 8.247740507125854
Epoch: 18, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.969 Vali Acc: 0.366 Test Loss: 2.969 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8447422
	speed: 0.1827s/iter; left time: 2289.3186s
Epoch: 19 cost time: 7.605481147766113
Epoch: 19, Steps: 154 | Train Loss: 1.387 Vali Loss: 3.078 Vali Acc: 0.170 Test Loss: 3.078 Test Acc: 0.170
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2986833
	speed: 0.1895s/iter; left time: 2345.2078s
Epoch: 20 cost time: 8.171342849731445
Epoch: 20, Steps: 154 | Train Loss: 1.359 Vali Loss: 3.422 Vali Acc: 0.116 Test Loss: 3.422 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 177842
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9517190
	speed: 0.0719s/iter; left time: 1100.3464s
Epoch: 1 cost time: 9.708250999450684
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4471915
	speed: 0.1839s/iter; left time: 2785.4698s
Epoch: 2 cost time: 8.223844766616821
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.149 Vali Acc: 0.315 Test Loss: 2.149 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315064).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9430726
	speed: 0.1877s/iter; left time: 2813.6711s
Epoch: 3 cost time: 7.803063154220581
Epoch: 3, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.119 Vali Acc: 0.325 Test Loss: 2.119 Test Acc: 0.325
Validation loss decreased (-0.315064 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3238881
	speed: 0.1808s/iter; left time: 2682.9216s
Epoch: 4 cost time: 7.722472667694092
Epoch: 4, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.224 Vali Acc: 0.329 Test Loss: 2.224 Test Acc: 0.329
Validation loss decreased (-0.324796 --> -0.328850).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7988834
	speed: 0.1828s/iter; left time: 2684.1522s
Epoch: 5 cost time: 7.844965219497681
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.328 Vali Acc: 0.178 Test Loss: 2.328 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5241404
	speed: 0.1975s/iter; left time: 2869.4392s
Epoch: 6 cost time: 9.65929889678955
Epoch: 6, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.257 Vali Acc: 0.349 Test Loss: 2.257 Test Acc: 0.349
Validation loss decreased (-0.328850 --> -0.348720).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9766005
	speed: 0.2079s/iter; left time: 2988.8888s
Epoch: 7 cost time: 8.486429214477539
Epoch: 7, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.331 Vali Acc: 0.354 Test Loss: 2.331 Test Acc: 0.354
Validation loss decreased (-0.348720 --> -0.354397).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7595211
	speed: 0.2005s/iter; left time: 2851.0841s
Epoch: 8 cost time: 8.048895835876465
Epoch: 8, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.539 Vali Acc: 0.202 Test Loss: 2.539 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3089390
	speed: 0.2053s/iter; left time: 2887.6847s
Epoch: 9 cost time: 8.484584093093872
Epoch: 9, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.945 Vali Acc: 0.127 Test Loss: 2.945 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4367287
	speed: 0.2009s/iter; left time: 2795.6938s
Epoch: 10 cost time: 8.655149698257446
Epoch: 10, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.390 Vali Acc: 0.371 Test Loss: 2.390 Test Acc: 0.371
Validation loss decreased (-0.354397 --> -0.370617).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7842047
	speed: 0.1989s/iter; left time: 2736.4974s
Epoch: 11 cost time: 8.670757293701172
Epoch: 11, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3969542
	speed: 0.2026s/iter; left time: 2756.4224s
Epoch: 12 cost time: 9.048414468765259
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.480 Vali Acc: 0.100 Test Loss: 3.480 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3053339
	speed: 0.1966s/iter; left time: 2645.3993s
Epoch: 13 cost time: 7.741376161575317
Epoch: 13, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.976 Vali Acc: 0.137 Test Loss: 2.976 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0322148
	speed: 0.1810s/iter; left time: 2406.4594s
Epoch: 14 cost time: 7.703965902328491
Epoch: 14, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.187 Vali Acc: 0.183 Test Loss: 3.187 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5328625
	speed: 0.1836s/iter; left time: 2413.8738s
Epoch: 15 cost time: 8.514146566390991
Epoch: 15, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.006 Vali Acc: 0.163 Test Loss: 3.006 Test Acc: 0.163
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7842206
	speed: 0.2004s/iter; left time: 2603.7519s
Epoch: 16 cost time: 8.297930240631104
Epoch: 16, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.935 Vali Acc: 0.213 Test Loss: 2.935 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.9392358
	speed: 0.1959s/iter; left time: 2515.0161s
Epoch: 17 cost time: 8.265856504440308
Epoch: 17, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.127 Vali Acc: 0.193 Test Loss: 3.127 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.6485521
	speed: 0.1892s/iter; left time: 2399.4092s
Epoch: 18 cost time: 8.523011207580566
Epoch: 18, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.367 Vali Acc: 0.116 Test Loss: 3.367 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3843554
	speed: 0.1852s/iter; left time: 2320.2889s
Epoch: 19 cost time: 7.669987916946411
Epoch: 19, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.183 Vali Acc: 0.135 Test Loss: 3.183 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1138976
	speed: 0.1830s/iter; left time: 2265.2195s
Epoch: 20 cost time: 7.65942645072937
Epoch: 20, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.442 Vali Acc: 0.125 Test Loss: 3.442 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 177682
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2244418
	speed: 0.0721s/iter; left time: 1103.8492s
Epoch: 1 cost time: 9.900206804275513
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4485099
	speed: 0.1934s/iter; left time: 2929.0347s
Epoch: 2 cost time: 8.54328179359436
Epoch: 2, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8466699
	speed: 0.1755s/iter; left time: 2631.4909s
Epoch: 3 cost time: 8.488415956497192
Epoch: 3, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.163 Vali Acc: 0.321 Test Loss: 2.163 Test Acc: 0.321
Validation loss decreased (-0.315064 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0856850
	speed: 0.1874s/iter; left time: 2781.3350s
Epoch: 4 cost time: 7.729227066040039
Epoch: 4, Steps: 154 | Train Loss: 2.007 Vali Loss: 2.094 Vali Acc: 0.328 Test Loss: 2.094 Test Acc: 0.328
Validation loss decreased (-0.320741 --> -0.328041).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5997993
	speed: 0.2020s/iter; left time: 2966.1035s
Epoch: 5 cost time: 9.433157205581665
Epoch: 5, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.060 Vali Acc: 0.342 Test Loss: 2.060 Test Acc: 0.342
Validation loss decreased (-0.328041 --> -0.342234).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5018986
	speed: 0.2145s/iter; left time: 3117.5760s
Epoch: 6 cost time: 8.192736148834229
Epoch: 6, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.199 Vali Acc: 0.187 Test Loss: 2.199 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3817062
	speed: 0.1920s/iter; left time: 2759.6750s
Epoch: 7 cost time: 8.466202735900879
Epoch: 7, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.304 Vali Acc: 0.359 Test Loss: 2.304 Test Acc: 0.359
Validation loss decreased (-0.342234 --> -0.358858).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5521172
	speed: 0.2003s/iter; left time: 2849.3825s
Epoch: 8 cost time: 8.360280752182007
Epoch: 8, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.518 Vali Acc: 0.188 Test Loss: 2.518 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6680667
	speed: 0.1961s/iter; left time: 2758.4855s
Epoch: 9 cost time: 7.913058042526245
Epoch: 9, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.395 Vali Acc: 0.370 Test Loss: 2.395 Test Acc: 0.370
Validation loss decreased (-0.358858 --> -0.370211).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6718463
	speed: 0.1758s/iter; left time: 2446.1771s
Epoch: 10 cost time: 7.30043625831604
Epoch: 10, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.512 Vali Acc: 0.200 Test Loss: 2.512 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3391038
	speed: 0.1924s/iter; left time: 2647.0948s
Epoch: 11 cost time: 8.818138599395752
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.510 Vali Acc: 0.360 Test Loss: 2.510 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4992679
	speed: 0.1964s/iter; left time: 2671.9127s
Epoch: 12 cost time: 8.854637145996094
Epoch: 12, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.507 Vali Acc: 0.327 Test Loss: 2.507 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2603713
	speed: 0.1926s/iter; left time: 2591.3918s
Epoch: 13 cost time: 8.235365152359009
Epoch: 13, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.815 Vali Acc: 0.242 Test Loss: 2.815 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.4161813
	speed: 0.1832s/iter; left time: 2436.9872s
Epoch: 14 cost time: 7.464020252227783
Epoch: 14, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.047 Vali Acc: 0.191 Test Loss: 3.047 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.5413226
	speed: 0.1923s/iter; left time: 2528.1653s
Epoch: 15 cost time: 8.61527156829834
Epoch: 15, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.042 Vali Acc: 0.200 Test Loss: 3.042 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.5429412
	speed: 0.1717s/iter; left time: 2230.8313s
Epoch: 16 cost time: 7.618593215942383
Epoch: 16, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.844 Vali Acc: 0.208 Test Loss: 2.844 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.5562630
	speed: 0.1822s/iter; left time: 2338.6153s
Epoch: 17 cost time: 8.410796165466309
Epoch: 17, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.799 Vali Acc: 0.343 Test Loss: 2.799 Test Acc: 0.343
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3758318
	speed: 0.1893s/iter; left time: 2401.4140s
Epoch: 18 cost time: 8.007756471633911
Epoch: 18, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.321 Vali Acc: 0.120 Test Loss: 3.321 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9126216
	speed: 0.2056s/iter; left time: 2575.3677s
Epoch: 19 cost time: 8.810532093048096
Epoch: 19, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.120 Vali Acc: 0.114 Test Loss: 3.120 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 177522
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1732538
	speed: 0.0673s/iter; left time: 1029.4501s
Epoch: 1 cost time: 9.778080701828003
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3781881
	speed: 0.1959s/iter; left time: 2967.0266s
Epoch: 2 cost time: 8.09463381767273
Epoch: 2, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7567259
	speed: 0.2034s/iter; left time: 3049.4330s
Epoch: 3 cost time: 8.160349607467651
Epoch: 3, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.137 Vali Acc: 0.320 Test Loss: 2.137 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9131997
	speed: 0.2075s/iter; left time: 3079.0577s
Epoch: 4 cost time: 9.69876503944397
Epoch: 4, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.097 Vali Acc: 0.331 Test Loss: 2.097 Test Acc: 0.331
Validation loss decreased (-0.319524 --> -0.331285).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0141799
	speed: 0.2020s/iter; left time: 2966.6619s
Epoch: 5 cost time: 8.073688983917236
Epoch: 5, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.110 Vali Acc: 0.348 Test Loss: 2.110 Test Acc: 0.348
Validation loss decreased (-0.331285 --> -0.347911).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6588494
	speed: 0.1792s/iter; left time: 2603.5470s
Epoch: 6 cost time: 7.792820930480957
Epoch: 6, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.336 Vali Acc: 0.185 Test Loss: 2.336 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8429058
	speed: 0.1771s/iter; left time: 2546.5244s
Epoch: 7 cost time: 7.971307039260864
Epoch: 7, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.585 Vali Acc: 0.197 Test Loss: 2.585 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8073010
	speed: 0.2113s/iter; left time: 3005.6119s
Epoch: 8 cost time: 9.16955828666687
Epoch: 8, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.541 Vali Acc: 0.182 Test Loss: 2.541 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3461399
	speed: 0.1788s/iter; left time: 2515.2435s
Epoch: 9 cost time: 7.647714376449585
Epoch: 9, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.601 Vali Acc: 0.200 Test Loss: 2.601 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.2581239
	speed: 0.1929s/iter; left time: 2683.5762s
Epoch: 10 cost time: 9.173715829849243
Epoch: 10, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.684 Vali Acc: 0.154 Test Loss: 2.684 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4781295
	speed: 0.2018s/iter; left time: 2777.6358s
Epoch: 11 cost time: 8.05082631111145
Epoch: 11, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.829 Vali Acc: 0.195 Test Loss: 2.829 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.6746315
	speed: 0.1885s/iter; left time: 2564.5805s
Epoch: 12 cost time: 7.271913528442383
Epoch: 12, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.082 Vali Acc: 0.170 Test Loss: 3.082 Test Acc: 0.170
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4218099
	speed: 0.1797s/iter; left time: 2416.9729s
Epoch: 13 cost time: 8.120636940002441
Epoch: 13, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.319 Vali Acc: 0.189 Test Loss: 3.319 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2187152
	speed: 0.1948s/iter; left time: 2590.0004s
Epoch: 14 cost time: 8.707960844039917
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.009 Vali Acc: 0.189 Test Loss: 3.009 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4284723
	speed: 0.1842s/iter; left time: 2421.6491s
Epoch: 15 cost time: 8.673940420150757
Epoch: 15, Steps: 154 | Train Loss: 1.455 Vali Loss: 3.405 Vali Acc: 0.128 Test Loss: 3.405 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34793187347931875
model parameter : 136402
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0332313
	speed: 0.0684s/iter; left time: 1046.3149s
Epoch: 1 cost time: 9.613632678985596
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.165 Vali Acc: 0.315 Test Loss: 2.165 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0085905
	speed: 0.1942s/iter; left time: 2941.5391s
Epoch: 2 cost time: 7.727822542190552
Epoch: 2, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
Validation loss decreased (-0.314658 --> -0.315064).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9057497
	speed: 0.2033s/iter; left time: 3048.3271s
Epoch: 3 cost time: 9.287483930587769
Epoch: 3, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.147 Vali Acc: 0.316 Test Loss: 2.147 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4517508
	speed: 0.2051s/iter; left time: 3042.7671s
Epoch: 4 cost time: 9.071983337402344
Epoch: 4, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.075 Vali Acc: 0.328 Test Loss: 2.075 Test Acc: 0.328
Validation loss decreased (-0.316280 --> -0.328041).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0124815
	speed: 0.2047s/iter; left time: 3005.6517s
Epoch: 5 cost time: 8.754356145858765
Epoch: 5, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.186 Vali Acc: 0.353 Test Loss: 2.186 Test Acc: 0.353
Validation loss decreased (-0.328041 --> -0.352776).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4595469
	speed: 0.1877s/iter; left time: 2727.7855s
Epoch: 6 cost time: 7.550342559814453
Epoch: 6, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.289 Vali Acc: 0.185 Test Loss: 2.289 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1979778
	speed: 0.1824s/iter; left time: 2622.0187s
Epoch: 7 cost time: 7.753503799438477
Epoch: 7, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.533 Vali Acc: 0.185 Test Loss: 2.533 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8658993
	speed: 0.1826s/iter; left time: 2597.5023s
Epoch: 8 cost time: 8.087578296661377
Epoch: 8, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.624 Vali Acc: 0.184 Test Loss: 2.624 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.8773992
	speed: 0.1884s/iter; left time: 2651.1695s
Epoch: 9 cost time: 8.807995080947876
Epoch: 9, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.455 Vali Acc: 0.199 Test Loss: 2.455 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3182067
	speed: 0.1890s/iter; left time: 2629.6097s
Epoch: 10 cost time: 7.437737941741943
Epoch: 10, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.757 Vali Acc: 0.189 Test Loss: 2.757 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3387362
	speed: 0.1795s/iter; left time: 2470.0023s
Epoch: 11 cost time: 8.01968240737915
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.868 Vali Acc: 0.188 Test Loss: 2.868 Test Acc: 0.188
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4691517
	speed: 0.1809s/iter; left time: 2462.0513s
Epoch: 12 cost time: 7.766868352890015
Epoch: 12, Steps: 154 | Train Loss: 1.507 Vali Loss: 3.140 Vali Acc: 0.109 Test Loss: 3.140 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.8019210
	speed: 0.1788s/iter; left time: 2404.9397s
Epoch: 13 cost time: 7.8870580196380615
Epoch: 13, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.714 Vali Acc: 0.206 Test Loss: 2.714 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9233072
	speed: 0.1484s/iter; left time: 1972.9518s
Epoch: 14 cost time: 6.864765644073486
Epoch: 14, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.567 Vali Acc: 0.100 Test Loss: 3.567 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5846505
	speed: 0.1586s/iter; left time: 2084.4041s
Epoch: 15 cost time: 7.502064943313599
Epoch: 15, Steps: 154 | Train Loss: 1.448 Vali Loss: 3.213 Vali Acc: 0.127 Test Loss: 3.213 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35279805352798055
model parameter : 136242
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2510452
	speed: 0.0735s/iter; left time: 1124.5565s
Epoch: 1 cost time: 10.113699674606323
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0440922
	speed: 0.2040s/iter; left time: 3089.4203s
Epoch: 2 cost time: 9.419309377670288
Epoch: 2, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9415628
	speed: 0.2048s/iter; left time: 3070.9152s
Epoch: 3 cost time: 8.555218696594238
Epoch: 3, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.121 Vali Acc: 0.321 Test Loss: 2.121 Test Acc: 0.321
Validation loss decreased (-0.315469 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2776623
	speed: 0.1912s/iter; left time: 2837.3807s
Epoch: 4 cost time: 8.017264604568481
Epoch: 4, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.097 Vali Acc: 0.334 Test Loss: 2.097 Test Acc: 0.334
Validation loss decreased (-0.320741 --> -0.334123).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6749619
	speed: 0.1910s/iter; left time: 2804.6540s
Epoch: 5 cost time: 8.226906776428223
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.146 Vali Acc: 0.346 Test Loss: 2.146 Test Acc: 0.346
Validation loss decreased (-0.334123 --> -0.345883).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6000071
	speed: 0.1870s/iter; left time: 2717.9404s
Epoch: 6 cost time: 7.810515880584717
Epoch: 6, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.237 Vali Acc: 0.352 Test Loss: 2.237 Test Acc: 0.352
Validation loss decreased (-0.345883 --> -0.351965).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6099025
	speed: 0.1933s/iter; left time: 2779.6718s
Epoch: 7 cost time: 7.880735158920288
Epoch: 7, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.549 Vali Acc: 0.201 Test Loss: 2.549 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9135053
	speed: 0.1866s/iter; left time: 2653.7715s
Epoch: 8 cost time: 7.939295768737793
Epoch: 8, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.417 Vali Acc: 0.387 Test Loss: 2.417 Test Acc: 0.387
Validation loss decreased (-0.351965 --> -0.386837).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4595486
	speed: 0.1877s/iter; left time: 2641.2520s
Epoch: 9 cost time: 8.066915273666382
Epoch: 9, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.582 Vali Acc: 0.213 Test Loss: 2.582 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4577144
	speed: 0.1805s/iter; left time: 2511.2212s
Epoch: 10 cost time: 7.538410663604736
Epoch: 10, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.727 Vali Acc: 0.370 Test Loss: 2.727 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5042777
	speed: 0.1816s/iter; left time: 2498.5127s
Epoch: 11 cost time: 8.230085849761963
Epoch: 11, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.901 Vali Acc: 0.204 Test Loss: 2.901 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8051527
	speed: 0.1965s/iter; left time: 2674.1168s
Epoch: 12 cost time: 8.440281629562378
Epoch: 12, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.840 Vali Acc: 0.193 Test Loss: 2.840 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4792787
	speed: 0.1867s/iter; left time: 2511.7481s
Epoch: 13 cost time: 7.5963099002838135
Epoch: 13, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.833 Vali Acc: 0.187 Test Loss: 2.833 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3051755
	speed: 0.1856s/iter; left time: 2468.7892s
Epoch: 14 cost time: 7.889975309371948
Epoch: 14, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.090 Vali Acc: 0.224 Test Loss: 3.090 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1675173
	speed: 0.1852s/iter; left time: 2434.0605s
Epoch: 15 cost time: 8.43913745880127
Epoch: 15, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.004 Vali Acc: 0.211 Test Loss: 3.004 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.5054044
	speed: 0.1997s/iter; left time: 2594.7953s
Epoch: 16 cost time: 8.416474342346191
Epoch: 16, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.983 Vali Acc: 0.366 Test Loss: 2.983 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.7292048
	speed: 0.1973s/iter; left time: 2532.6830s
Epoch: 17 cost time: 8.124240159988403
Epoch: 17, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.159 Vali Acc: 0.114 Test Loss: 3.159 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.8404148
	speed: 0.1988s/iter; left time: 2521.3949s
Epoch: 18 cost time: 8.642171382904053
Epoch: 18, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.503 Vali Acc: 0.105 Test Loss: 3.503 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 136082
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2017314
	speed: 0.0719s/iter; left time: 1099.8367s
Epoch: 1 cost time: 9.93253493309021
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2378066
	speed: 0.2024s/iter; left time: 3066.2926s
Epoch: 2 cost time: 8.4501211643219
Epoch: 2, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.208 Vali Acc: 0.315 Test Loss: 2.208 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9883707
	speed: 0.1916s/iter; left time: 2871.9110s
Epoch: 3 cost time: 7.44198203086853
Epoch: 3, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.117 Vali Acc: 0.318 Test Loss: 2.117 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2420981
	speed: 0.2043s/iter; left time: 3031.7530s
Epoch: 4 cost time: 8.088825702667236
Epoch: 4, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.111 Vali Acc: 0.342 Test Loss: 2.111 Test Acc: 0.342
Validation loss decreased (-0.318308 --> -0.342234).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9307789
	speed: 0.1958s/iter; left time: 2874.8143s
Epoch: 5 cost time: 8.45336627960205
Epoch: 5, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.147 Vali Acc: 0.343 Test Loss: 2.147 Test Acc: 0.343
Validation loss decreased (-0.342234 --> -0.343044).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6982830
	speed: 0.1922s/iter; left time: 2792.6257s
Epoch: 6 cost time: 8.012474298477173
Epoch: 6, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.297 Vali Acc: 0.353 Test Loss: 2.297 Test Acc: 0.353
Validation loss decreased (-0.343044 --> -0.353181).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7355802
	speed: 0.1946s/iter; left time: 2797.3053s
Epoch: 7 cost time: 8.990547180175781
Epoch: 7, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.267 Vali Acc: 0.181 Test Loss: 2.267 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1009195
	speed: 0.1998s/iter; left time: 2841.2452s
Epoch: 8 cost time: 9.00688123703003
Epoch: 8, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.383 Vali Acc: 0.191 Test Loss: 2.383 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5423957
	speed: 0.2052s/iter; left time: 2886.3636s
Epoch: 9 cost time: 7.743487596511841
Epoch: 9, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.403 Vali Acc: 0.196 Test Loss: 2.403 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3725549
	speed: 0.2121s/iter; left time: 2950.9248s
Epoch: 10 cost time: 9.009155750274658
Epoch: 10, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.558 Vali Acc: 0.225 Test Loss: 2.558 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4612980
	speed: 0.2102s/iter; left time: 2892.5181s
Epoch: 11 cost time: 8.270864248275757
Epoch: 11, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.611 Vali Acc: 0.376 Test Loss: 2.611 Test Acc: 0.376
Validation loss decreased (-0.353181 --> -0.375481).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2164707
	speed: 0.2048s/iter; left time: 2786.6444s
Epoch: 12 cost time: 8.226561307907104
Epoch: 12, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.390 Vali Acc: 0.354 Test Loss: 2.390 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7493926
	speed: 0.2133s/iter; left time: 2870.1805s
Epoch: 13 cost time: 8.697163343429565
Epoch: 13, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.697 Vali Acc: 0.139 Test Loss: 2.697 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0491657
	speed: 0.2070s/iter; left time: 2752.7722s
Epoch: 14 cost time: 8.670557498931885
Epoch: 14, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.760 Vali Acc: 0.198 Test Loss: 2.760 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2522234
	speed: 0.2051s/iter; left time: 2696.0502s
Epoch: 15 cost time: 9.025054216384888
Epoch: 15, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.789 Vali Acc: 0.370 Test Loss: 2.789 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3597286
	speed: 0.2104s/iter; left time: 2732.8336s
Epoch: 16 cost time: 8.339934349060059
Epoch: 16, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.641 Vali Acc: 0.359 Test Loss: 2.641 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0714365
	speed: 0.2030s/iter; left time: 2606.0226s
Epoch: 17 cost time: 8.275516271591187
Epoch: 17, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.932 Vali Acc: 0.200 Test Loss: 2.932 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1420350
	speed: 0.1944s/iter; left time: 2466.1641s
Epoch: 18 cost time: 8.160617351531982
Epoch: 18, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.875 Vali Acc: 0.148 Test Loss: 2.875 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4746139
	speed: 0.1863s/iter; left time: 2334.4082s
Epoch: 19 cost time: 7.315808296203613
Epoch: 19, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.744 Vali Acc: 0.138 Test Loss: 2.744 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1710558
	speed: 0.1954s/iter; left time: 2418.0198s
Epoch: 20 cost time: 8.116722822189331
Epoch: 20, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.484 Vali Acc: 0.373 Test Loss: 2.484 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.0471175
	speed: 0.2049s/iter; left time: 2504.2121s
Epoch: 21 cost time: 8.712660074234009
Epoch: 21, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.734 Vali Acc: 0.128 Test Loss: 2.734 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 135922
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0217819
	speed: 0.0500s/iter; left time: 765.2649s
Epoch: 1 cost time: 6.791531562805176
Epoch: 1, Steps: 154 | Train Loss: 2.291 Vali Loss: 2.401 Vali Acc: 0.316 Test Loss: 2.401 Test Acc: 0.316
Validation loss decreased (inf --> -0.315872).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1065624
	speed: 0.1545s/iter; left time: 2340.6493s
Epoch: 2 cost time: 5.635168552398682
Epoch: 2, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.350 Vali Acc: 0.320 Test Loss: 2.350 Test Acc: 0.320
Validation loss decreased (-0.315872 --> -0.319928).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6838477
	speed: 0.1741s/iter; left time: 2609.8959s
Epoch: 3 cost time: 5.891229629516602
Epoch: 3, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.344 Vali Acc: 0.339 Test Loss: 2.344 Test Acc: 0.339
Validation loss decreased (-0.319928 --> -0.338582).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4001379
	speed: 0.1614s/iter; left time: 2394.5172s
Epoch: 4 cost time: 5.276819467544556
Epoch: 4, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.581 Vali Acc: 0.348 Test Loss: 2.581 Test Acc: 0.348
Validation loss decreased (-0.338582 --> -0.348312).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9606559
	speed: 0.1402s/iter; left time: 2058.4097s
Epoch: 5 cost time: 4.995277166366577
Epoch: 5, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.722 Vali Acc: 0.348 Test Loss: 2.722 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0634506
	speed: 0.1403s/iter; left time: 2039.3911s
Epoch: 6 cost time: 5.2663044929504395
Epoch: 6, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.778 Vali Acc: 0.183 Test Loss: 2.778 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0241776
	speed: 0.1606s/iter; left time: 2309.5391s
Epoch: 7 cost time: 5.950284719467163
Epoch: 7, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.046 Vali Acc: 0.392 Test Loss: 2.046 Test Acc: 0.392
Validation loss decreased (-0.348312 --> -0.392113).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1255043
	speed: 0.1664s/iter; left time: 2366.2291s
Epoch: 8 cost time: 6.007717609405518
Epoch: 8, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.139 Vali Acc: 0.391 Test Loss: 2.139 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0595684
	speed: 0.1737s/iter; left time: 2444.0919s
Epoch: 9 cost time: 6.621793270111084
Epoch: 9, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.333 Vali Acc: 0.380 Test Loss: 2.333 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0812351
	speed: 0.1654s/iter; left time: 2301.5054s
Epoch: 10 cost time: 6.010383605957031
Epoch: 10, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.693 Vali Acc: 0.075 Test Loss: 2.693 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3568010
	speed: 0.1637s/iter; left time: 2252.1865s
Epoch: 11 cost time: 6.154558181762695
Epoch: 11, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.299 Vali Acc: 0.367 Test Loss: 2.299 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5367149
	speed: 0.1660s/iter; left time: 2258.4180s
Epoch: 12 cost time: 5.953375339508057
Epoch: 12, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.503 Vali Acc: 0.184 Test Loss: 2.503 Test Acc: 0.184
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3090343
	speed: 0.1604s/iter; left time: 2158.0413s
Epoch: 13 cost time: 5.972217559814453
Epoch: 13, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.483 Vali Acc: 0.213 Test Loss: 2.483 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4719740
	speed: 0.1540s/iter; left time: 2047.6622s
Epoch: 14 cost time: 5.364425897598267
Epoch: 14, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.331 Vali Acc: 0.189 Test Loss: 2.331 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6836154
	speed: 0.1464s/iter; left time: 1924.5988s
Epoch: 15 cost time: 5.452093839645386
Epoch: 15, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.061 Vali Acc: 0.352 Test Loss: 2.061 Test Acc: 0.352
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.9840848
	speed: 0.1566s/iter; left time: 2034.2203s
Epoch: 16 cost time: 5.755870342254639
Epoch: 16, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.103 Vali Acc: 0.359 Test Loss: 2.103 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.6236513
	speed: 0.1533s/iter; left time: 1967.4754s
Epoch: 17 cost time: 4.901689529418945
Epoch: 17, Steps: 154 | Train Loss: 1.916 Vali Loss: 2.292 Vali Acc: 0.347 Test Loss: 2.292 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3921330089213301
model parameter : 4825638
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0989375
	speed: 0.0540s/iter; left time: 825.7800s
Epoch: 1 cost time: 6.9919798374176025
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.225 Vali Acc: 0.315 Test Loss: 2.225 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7496343
	speed: 0.1394s/iter; left time: 2111.1117s
Epoch: 2 cost time: 5.09732723236084
Epoch: 2, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.355 Vali Acc: 0.324 Test Loss: 2.355 Test Acc: 0.324
Validation loss decreased (-0.315063 --> -0.323983).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7064545
	speed: 0.1443s/iter; left time: 2163.4131s
Epoch: 3 cost time: 4.944346189498901
Epoch: 3, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.488 Vali Acc: 0.084 Test Loss: 2.488 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7331649
	speed: 0.1403s/iter; left time: 2082.5267s
Epoch: 4 cost time: 5.080887317657471
Epoch: 4, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.776 Vali Acc: 0.339 Test Loss: 2.776 Test Acc: 0.339
Validation loss decreased (-0.323983 --> -0.338983).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9695032
	speed: 0.1450s/iter; left time: 2129.9781s
Epoch: 5 cost time: 5.121316194534302
Epoch: 5, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.681 Vali Acc: 0.186 Test Loss: 2.681 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7656901
	speed: 0.1521s/iter; left time: 2210.8625s
Epoch: 6 cost time: 5.21724271774292
Epoch: 6, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.194 Vali Acc: 0.236 Test Loss: 2.194 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6166385
	speed: 0.1406s/iter; left time: 2021.5434s
Epoch: 7 cost time: 5.296426773071289
Epoch: 7, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.383 Vali Acc: 0.210 Test Loss: 2.383 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6410286
	speed: 0.1492s/iter; left time: 2122.3938s
Epoch: 8 cost time: 5.578371047973633
Epoch: 8, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.206 Vali Acc: 0.362 Test Loss: 2.206 Test Acc: 0.362
Validation loss decreased (-0.338983 --> -0.362103).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7434682
	speed: 0.1615s/iter; left time: 2272.2338s
Epoch: 9 cost time: 5.884495496749878
Epoch: 9, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.238 Vali Acc: 0.369 Test Loss: 2.238 Test Acc: 0.369
Validation loss decreased (-0.362103 --> -0.369402).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5971969
	speed: 0.1567s/iter; left time: 2179.9523s
Epoch: 10 cost time: 5.723421812057495
Epoch: 10, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.808 Vali Acc: 0.285 Test Loss: 2.808 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5777011
	speed: 0.1541s/iter; left time: 2120.6431s
Epoch: 11 cost time: 5.488125801086426
Epoch: 11, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.563 Vali Acc: 0.345 Test Loss: 2.563 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6886292
	speed: 0.1587s/iter; left time: 2159.1159s
Epoch: 12 cost time: 5.904121398925781
Epoch: 12, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.425 Vali Acc: 0.240 Test Loss: 2.425 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7746025
	speed: 0.1548s/iter; left time: 2082.0440s
Epoch: 13 cost time: 5.500202417373657
Epoch: 13, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.610 Vali Acc: 0.195 Test Loss: 2.610 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.4581069
	speed: 0.1633s/iter; left time: 2171.1279s
Epoch: 14 cost time: 5.730638027191162
Epoch: 14, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.116 Vali Acc: 0.227 Test Loss: 2.116 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1518726
	speed: 0.1679s/iter; left time: 2207.3294s
Epoch: 15 cost time: 6.076935052871704
Epoch: 15, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.327 Vali Acc: 0.250 Test Loss: 2.327 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.2471755
	speed: 0.1482s/iter; left time: 1925.5270s
Epoch: 16 cost time: 5.229806900024414
Epoch: 16, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.120 Vali Acc: 0.350 Test Loss: 2.120 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.5794642
	speed: 0.1490s/iter; left time: 1912.9943s
Epoch: 17 cost time: 5.7991673946380615
Epoch: 17, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.190 Vali Acc: 0.391 Test Loss: 2.190 Test Acc: 0.391
Validation loss decreased (-0.369402 --> -0.390489).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.0555139
	speed: 0.1521s/iter; left time: 1929.6692s
Epoch: 18 cost time: 5.107948303222656
Epoch: 18, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.255 Vali Acc: 0.361 Test Loss: 2.255 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0629647
	speed: 0.1494s/iter; left time: 1871.7897s
Epoch: 19 cost time: 5.3874900341033936
Epoch: 19, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.491 Vali Acc: 0.337 Test Loss: 2.491 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.3378735
	speed: 0.1475s/iter; left time: 1825.5983s
Epoch: 20 cost time: 5.393265962600708
Epoch: 20, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.613 Vali Acc: 0.324 Test Loss: 2.613 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3907843
	speed: 0.1498s/iter; left time: 1830.5293s
Epoch: 21 cost time: 5.473925828933716
Epoch: 21, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.447 Vali Acc: 0.221 Test Loss: 2.447 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.2817661
	speed: 0.1533s/iter; left time: 1849.2861s
Epoch: 22 cost time: 5.171032428741455
Epoch: 22, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.498 Vali Acc: 0.376 Test Loss: 2.498 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.4415553
	speed: 0.1402s/iter; left time: 1670.3818s
Epoch: 23 cost time: 5.232348918914795
Epoch: 23, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.236 Vali Acc: 0.375 Test Loss: 2.236 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.3321358
	speed: 0.1406s/iter; left time: 1653.4797s
Epoch: 24 cost time: 4.872782468795776
Epoch: 24, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.474 Vali Acc: 0.377 Test Loss: 2.474 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 2.1238558
	speed: 0.1523s/iter; left time: 1767.4726s
Epoch: 25 cost time: 5.5750651359558105
Epoch: 25, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.482 Vali Acc: 0.187 Test Loss: 2.482 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 2.2785385
	speed: 0.1464s/iter; left time: 1676.6091s
Epoch: 26 cost time: 5.236922264099121
Epoch: 26, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.732 Vali Acc: 0.184 Test Loss: 2.732 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.7709090
	speed: 0.1428s/iter; left time: 1613.6309s
Epoch: 27 cost time: 4.97400426864624
Epoch: 27, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.711 Vali Acc: 0.179 Test Loss: 2.711 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 4824870
model size : 23.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4855742
	speed: 0.0582s/iter; left time: 890.8768s
Epoch: 1 cost time: 7.903215169906616
Epoch: 1, Steps: 154 | Train Loss: 2.301 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1971335
	speed: 0.1601s/iter; left time: 2425.3293s
Epoch: 2 cost time: 5.4808878898620605
Epoch: 2, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.248 Vali Acc: 0.170 Test Loss: 2.248 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0587986
	speed: 0.1568s/iter; left time: 2350.5620s
Epoch: 3 cost time: 5.5051429271698
Epoch: 3, Steps: 154 | Train Loss: 2.174 Vali Loss: 2.488 Vali Acc: 0.339 Test Loss: 2.488 Test Acc: 0.339
Validation loss decreased (-0.315469 --> -0.338580).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8083314
	speed: 0.1716s/iter; left time: 2546.9023s
Epoch: 4 cost time: 5.863614320755005
Epoch: 4, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.803 Vali Acc: 0.333 Test Loss: 2.803 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3636303
	speed: 0.1720s/iter; left time: 2526.1038s
Epoch: 5 cost time: 5.930659532546997
Epoch: 5, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.486 Vali Acc: 0.203 Test Loss: 2.486 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.7248669
	speed: 0.1559s/iter; left time: 2265.0144s
Epoch: 6 cost time: 5.357438087463379
Epoch: 6, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.707 Vali Acc: 0.371 Test Loss: 2.707 Test Acc: 0.371
Validation loss decreased (-0.338580 --> -0.371019).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4315492
	speed: 0.1646s/iter; left time: 2366.8424s
Epoch: 7 cost time: 6.364732503890991
Epoch: 7, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.461 Vali Acc: 0.356 Test Loss: 2.461 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2378275
	speed: 0.1656s/iter; left time: 2355.8249s
Epoch: 8 cost time: 5.24555778503418
Epoch: 8, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.660 Vali Acc: 0.198 Test Loss: 2.660 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4156053
	speed: 0.1513s/iter; left time: 2128.3588s
Epoch: 9 cost time: 5.417656183242798
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.395 Vali Acc: 0.202 Test Loss: 2.395 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6499436
	speed: 0.1558s/iter; left time: 2168.3640s
Epoch: 10 cost time: 5.403046131134033
Epoch: 10, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.548 Vali Acc: 0.205 Test Loss: 2.548 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4582578
	speed: 0.1562s/iter; left time: 2149.6935s
Epoch: 11 cost time: 5.574508905410767
Epoch: 11, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.650 Vali Acc: 0.116 Test Loss: 2.650 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.1330323
	speed: 0.1568s/iter; left time: 2134.1969s
Epoch: 12 cost time: 6.272701740264893
Epoch: 12, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.590 Vali Acc: 0.204 Test Loss: 2.590 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6794708
	speed: 0.1622s/iter; left time: 2181.8891s
Epoch: 13 cost time: 5.527080059051514
Epoch: 13, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.545 Vali Acc: 0.354 Test Loss: 2.545 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5954432
	speed: 0.1623s/iter; left time: 2158.5308s
Epoch: 14 cost time: 5.289381504058838
Epoch: 14, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.706 Vali Acc: 0.179 Test Loss: 2.706 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.5185914
	speed: 0.1505s/iter; left time: 1978.0779s
Epoch: 15 cost time: 5.639436960220337
Epoch: 15, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.471 Vali Acc: 0.373 Test Loss: 2.471 Test Acc: 0.373
Validation loss decreased (-0.371019 --> -0.373049).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7902567
	speed: 0.1500s/iter; left time: 1948.1428s
Epoch: 16 cost time: 5.555387735366821
Epoch: 16, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.373 Vali Acc: 0.362 Test Loss: 2.373 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2574139
	speed: 0.1450s/iter; left time: 1860.7916s
Epoch: 17 cost time: 4.888697862625122
Epoch: 17, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.765 Vali Acc: 0.193 Test Loss: 2.765 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4223280
	speed: 0.1306s/iter; left time: 1656.5778s
Epoch: 18 cost time: 4.69458794593811
Epoch: 18, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.326 Vali Acc: 0.360 Test Loss: 2.326 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1590021
	speed: 0.1289s/iter; left time: 1614.8482s
Epoch: 19 cost time: 5.260548830032349
Epoch: 19, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.129 Vali Acc: 0.372 Test Loss: 2.129 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.3883529
	speed: 0.1664s/iter; left time: 2058.9922s
Epoch: 20 cost time: 6.131787061691284
Epoch: 20, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.971 Vali Acc: 0.122 Test Loss: 2.971 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.4074152
	speed: 0.1683s/iter; left time: 2056.7123s
Epoch: 21 cost time: 6.045186758041382
Epoch: 21, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.308 Vali Acc: 0.374 Test Loss: 2.308 Test Acc: 0.374
Validation loss decreased (-0.373049 --> -0.373862).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0636030
	speed: 0.1587s/iter; left time: 1915.0703s
Epoch: 22 cost time: 5.312081813812256
Epoch: 22, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.306 Vali Acc: 0.373 Test Loss: 2.306 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6485029
	speed: 0.1570s/iter; left time: 1870.4713s
Epoch: 23 cost time: 5.727623224258423
Epoch: 23, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.727 Vali Acc: 0.198 Test Loss: 2.727 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.7871469
	speed: 0.1630s/iter; left time: 1916.1571s
Epoch: 24 cost time: 6.186962842941284
Epoch: 24, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.258 Vali Acc: 0.364 Test Loss: 2.258 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.0768478
	speed: 0.1690s/iter; left time: 1961.5849s
Epoch: 25 cost time: 6.122286319732666
Epoch: 25, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.301 Vali Acc: 0.378 Test Loss: 2.301 Test Acc: 0.378
Validation loss decreased (-0.373862 --> -0.377917).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4120487
	speed: 0.1682s/iter; left time: 1925.6325s
Epoch: 26 cost time: 5.435371398925781
Epoch: 26, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.630 Vali Acc: 0.198 Test Loss: 2.630 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.5365802
	speed: 0.1591s/iter; left time: 1797.9098s
Epoch: 27 cost time: 5.4375386238098145
Epoch: 27, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.575 Vali Acc: 0.195 Test Loss: 2.575 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.1674714
	speed: 0.1538s/iter; left time: 1713.7338s
Epoch: 28 cost time: 5.889119386672974
Epoch: 28, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.382 Vali Acc: 0.372 Test Loss: 2.382 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.5935295
	speed: 0.1634s/iter; left time: 1796.0635s
Epoch: 29 cost time: 5.7170820236206055
Epoch: 29, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.735 Vali Acc: 0.139 Test Loss: 2.735 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.5204186
	speed: 0.1492s/iter; left time: 1616.5491s
Epoch: 30 cost time: 5.240236520767212
Epoch: 30, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.824 Vali Acc: 0.127 Test Loss: 2.824 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.5297431
	speed: 0.1554s/iter; left time: 1660.3390s
Epoch: 31 cost time: 5.616178512573242
Epoch: 31, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.720 Vali Acc: 0.163 Test Loss: 2.720 Test Acc: 0.163
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.5664040
	speed: 0.1524s/iter; left time: 1603.9703s
Epoch: 32 cost time: 5.846368312835693
Epoch: 32, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.721 Vali Acc: 0.115 Test Loss: 2.721 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.2691283
	speed: 0.1623s/iter; left time: 1683.7773s
Epoch: 33 cost time: 6.525042772293091
Epoch: 33, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.430 Vali Acc: 0.210 Test Loss: 2.430 Test Acc: 0.210
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.9674187
	speed: 0.1588s/iter; left time: 1622.6240s
Epoch: 34 cost time: 5.284193754196167
Epoch: 34, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.280 Vali Acc: 0.211 Test Loss: 2.280 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.5557966
	speed: 0.1543s/iter; left time: 1552.5814s
Epoch: 35 cost time: 6.331259489059448
Epoch: 35, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.720 Vali Acc: 0.129 Test Loss: 2.720 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 4824102
model size : 23.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1408172
	speed: 0.0492s/iter; left time: 753.3397s
Epoch: 1 cost time: 6.670543432235718
Epoch: 1, Steps: 154 | Train Loss: 2.290 Vali Loss: 2.297 Vali Acc: 0.316 Test Loss: 2.297 Test Acc: 0.316
Validation loss decreased (inf --> -0.315873).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7776000
	speed: 0.1557s/iter; left time: 2358.7565s
Epoch: 2 cost time: 5.66025710105896
Epoch: 2, Steps: 154 | Train Loss: 2.210 Vali Loss: 2.282 Vali Acc: 0.325 Test Loss: 2.282 Test Acc: 0.325
Validation loss decreased (-0.315873 --> -0.325200).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0093443
	speed: 0.1632s/iter; left time: 2446.3886s
Epoch: 3 cost time: 5.740281343460083
Epoch: 3, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.229 Vali Acc: 0.342 Test Loss: 2.229 Test Acc: 0.342
Validation loss decreased (-0.325200 --> -0.341827).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9974675
	speed: 0.1670s/iter; left time: 2478.1557s
Epoch: 4 cost time: 5.9361701011657715
Epoch: 4, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.516 Vali Acc: 0.345 Test Loss: 2.516 Test Acc: 0.345
Validation loss decreased (-0.341827 --> -0.345474).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4633627
	speed: 0.1593s/iter; left time: 2339.4678s
Epoch: 5 cost time: 5.749107599258423
Epoch: 5, Steps: 154 | Train Loss: 1.988 Vali Loss: 3.283 Vali Acc: 0.182 Test Loss: 3.283 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3947775
	speed: 0.1655s/iter; left time: 2404.3494s
Epoch: 6 cost time: 5.737607479095459
Epoch: 6, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.537 Vali Acc: 0.247 Test Loss: 2.537 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6266394
	speed: 0.1492s/iter; left time: 2144.3490s
Epoch: 7 cost time: 5.778029918670654
Epoch: 7, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.031 Vali Acc: 0.363 Test Loss: 2.031 Test Acc: 0.363
Validation loss decreased (-0.345474 --> -0.363321).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8515052
	speed: 0.1647s/iter; left time: 2342.2223s
Epoch: 8 cost time: 6.064913511276245
Epoch: 8, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.179 Vali Acc: 0.363 Test Loss: 2.179 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8372613
	speed: 0.1741s/iter; left time: 2450.0305s
Epoch: 9 cost time: 6.179160833358765
Epoch: 9, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.067 Vali Acc: 0.370 Test Loss: 2.067 Test Acc: 0.370
Validation loss decreased (-0.363321 --> -0.370215).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4911456
	speed: 0.1693s/iter; left time: 2355.9036s
Epoch: 10 cost time: 6.433138370513916
Epoch: 10, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.355 Vali Acc: 0.207 Test Loss: 2.355 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5314636
	speed: 0.1648s/iter; left time: 2268.2598s
Epoch: 11 cost time: 6.258450508117676
Epoch: 11, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.525 Vali Acc: 0.204 Test Loss: 2.525 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4172499
	speed: 0.1696s/iter; left time: 2307.4270s
Epoch: 12 cost time: 6.262728452682495
Epoch: 12, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.440 Vali Acc: 0.221 Test Loss: 2.440 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1350002
	speed: 0.1609s/iter; left time: 2164.0760s
Epoch: 13 cost time: 5.655769348144531
Epoch: 13, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.619 Vali Acc: 0.202 Test Loss: 2.619 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.0966269
	speed: 0.1454s/iter; left time: 1933.3927s
Epoch: 14 cost time: 5.417466163635254
Epoch: 14, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.927 Vali Acc: 0.197 Test Loss: 2.927 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4406153
	speed: 0.1568s/iter; left time: 2061.6983s
Epoch: 15 cost time: 5.633899927139282
Epoch: 15, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.454 Vali Acc: 0.195 Test Loss: 2.454 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0442388
	speed: 0.1581s/iter; left time: 2053.8434s
Epoch: 16 cost time: 6.196229457855225
Epoch: 16, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.924 Vali Acc: 0.138 Test Loss: 2.924 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8868852
	speed: 0.1689s/iter; left time: 2168.2058s
Epoch: 17 cost time: 5.239104509353638
Epoch: 17, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.995 Vali Acc: 0.128 Test Loss: 2.995 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.5487432
	speed: 0.1546s/iter; left time: 1960.2470s
Epoch: 18 cost time: 5.514753341674805
Epoch: 18, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.255 Vali Acc: 0.229 Test Loss: 2.255 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1014861
	speed: 0.1565s/iter; left time: 1960.7007s
Epoch: 19 cost time: 5.524698257446289
Epoch: 19, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.298 Vali Acc: 0.361 Test Loss: 2.298 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 4823334
model size : 23.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1067214
	speed: 0.0530s/iter; left time: 810.6995s
Epoch: 1 cost time: 7.270469665527344
Epoch: 1, Steps: 154 | Train Loss: 2.306 Vali Loss: 2.318 Vali Acc: 0.161 Test Loss: 2.318 Test Acc: 0.161
Validation loss decreased (inf --> -0.161372).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9038920
	speed: 0.1545s/iter; left time: 2340.7021s
Epoch: 2 cost time: 5.365180730819702
Epoch: 2, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.474 Vali Acc: 0.335 Test Loss: 2.474 Test Acc: 0.335
Validation loss decreased (-0.161372 --> -0.335336).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8028092
	speed: 0.1623s/iter; left time: 2433.7089s
Epoch: 3 cost time: 5.741829872131348
Epoch: 3, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.242 Vali Acc: 0.181 Test Loss: 2.242 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7178611
	speed: 0.1602s/iter; left time: 2377.4447s
Epoch: 4 cost time: 5.708490610122681
Epoch: 4, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.489 Vali Acc: 0.334 Test Loss: 2.489 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8457576
	speed: 0.1623s/iter; left time: 2383.3378s
Epoch: 5 cost time: 5.511555194854736
Epoch: 5, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.588 Vali Acc: 0.340 Test Loss: 2.588 Test Acc: 0.340
Validation loss decreased (-0.335336 --> -0.339796).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5445521
	speed: 0.1710s/iter; left time: 2485.4318s
Epoch: 6 cost time: 6.128746509552002
Epoch: 6, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.328 Vali Acc: 0.200 Test Loss: 2.328 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9818712
	speed: 0.1630s/iter; left time: 2343.0319s
Epoch: 7 cost time: 5.802173376083374
Epoch: 7, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.783 Vali Acc: 0.326 Test Loss: 2.783 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1936177
	speed: 0.1621s/iter; left time: 2304.8560s
Epoch: 8 cost time: 5.504558086395264
Epoch: 8, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.403 Vali Acc: 0.193 Test Loss: 2.403 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5588188
	speed: 0.1702s/iter; left time: 2394.5463s
Epoch: 9 cost time: 5.876929998397827
Epoch: 9, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.867 Vali Acc: 0.193 Test Loss: 2.867 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4723799
	speed: 0.1539s/iter; left time: 2141.1166s
Epoch: 10 cost time: 5.7215492725372314
Epoch: 10, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.279 Vali Acc: 0.101 Test Loss: 2.279 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5167265
	speed: 0.1634s/iter; left time: 2249.0219s
Epoch: 11 cost time: 5.226855278015137
Epoch: 11, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.461 Vali Acc: 0.373 Test Loss: 2.461 Test Acc: 0.373
Validation loss decreased (-0.339796 --> -0.373455).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2379880
	speed: 0.1597s/iter; left time: 2173.1804s
Epoch: 12 cost time: 5.715780735015869
Epoch: 12, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.405 Vali Acc: 0.191 Test Loss: 2.405 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3426840
	speed: 0.1589s/iter; left time: 2137.0411s
Epoch: 13 cost time: 5.988821744918823
Epoch: 13, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.424 Vali Acc: 0.363 Test Loss: 2.424 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8028971
	speed: 0.1469s/iter; left time: 1953.5660s
Epoch: 14 cost time: 4.589048624038696
Epoch: 14, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.343 Vali Acc: 0.212 Test Loss: 2.343 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4789765
	speed: 0.1255s/iter; left time: 1649.7218s
Epoch: 15 cost time: 4.642402172088623
Epoch: 15, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.204 Vali Acc: 0.210 Test Loss: 2.204 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.7292221
	speed: 0.1367s/iter; left time: 1775.9817s
Epoch: 16 cost time: 5.310703277587891
Epoch: 16, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.595 Vali Acc: 0.210 Test Loss: 2.595 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.4975940
	speed: 0.1563s/iter; left time: 2006.0246s
Epoch: 17 cost time: 5.648129224777222
Epoch: 17, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.495 Vali Acc: 0.197 Test Loss: 2.495 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 2.0281541
	speed: 0.1755s/iter; left time: 2226.2369s
Epoch: 18 cost time: 6.30309796333313
Epoch: 18, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.306 Vali Acc: 0.194 Test Loss: 2.306 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5487781
	speed: 0.1612s/iter; left time: 2019.0877s
Epoch: 19 cost time: 5.5438432693481445
Epoch: 19, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.421 Vali Acc: 0.205 Test Loss: 2.421 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0104773
	speed: 0.1633s/iter; left time: 2020.2375s
Epoch: 20 cost time: 5.3088908195495605
Epoch: 20, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.156 Vali Acc: 0.203 Test Loss: 2.156 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.5955459
	speed: 0.1604s/iter; left time: 1959.7216s
Epoch: 21 cost time: 5.996902704238892
Epoch: 21, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.533 Vali Acc: 0.199 Test Loss: 2.533 Test Acc: 0.199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 4037670
model size : 20.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4243593
	speed: 0.0540s/iter; left time: 826.3634s
Epoch: 1 cost time: 7.2074103355407715
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.227 Vali Acc: 0.317 Test Loss: 2.227 Test Acc: 0.317
Validation loss decreased (inf --> -0.317090).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2253394
	speed: 0.1580s/iter; left time: 2393.8905s
Epoch: 2 cost time: 5.307650089263916
Epoch: 2, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.376 Vali Acc: 0.168 Test Loss: 2.376 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.6239789
	speed: 0.1586s/iter; left time: 2377.2200s
Epoch: 3 cost time: 5.756523609161377
Epoch: 3, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.540 Vali Acc: 0.218 Test Loss: 2.540 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.8965569
	speed: 0.1596s/iter; left time: 2367.7351s
Epoch: 4 cost time: 6.059260845184326
Epoch: 4, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.456 Vali Acc: 0.355 Test Loss: 2.456 Test Acc: 0.355
Validation loss decreased (-0.317090 --> -0.355207).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5743949
	speed: 0.1675s/iter; left time: 2460.2194s
Epoch: 5 cost time: 5.770884990692139
Epoch: 5, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.270 Vali Acc: 0.384 Test Loss: 2.270 Test Acc: 0.384
Validation loss decreased (-0.355207 --> -0.383594).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6034950
	speed: 0.1581s/iter; left time: 2297.7149s
Epoch: 6 cost time: 5.337012529373169
Epoch: 6, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.363 Vali Acc: 0.198 Test Loss: 2.363 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2574424
	speed: 0.1557s/iter; left time: 2237.7910s
Epoch: 7 cost time: 5.559979200363159
Epoch: 7, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.320 Vali Acc: 0.403 Test Loss: 2.320 Test Acc: 0.403
Validation loss decreased (-0.383594 --> -0.403059).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3760436
	speed: 0.1499s/iter; left time: 2132.0126s
Epoch: 8 cost time: 5.4795145988464355
Epoch: 8, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.576 Vali Acc: 0.358 Test Loss: 2.576 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7394791
	speed: 0.1514s/iter; left time: 2130.0837s
Epoch: 9 cost time: 5.3933000564575195
Epoch: 9, Steps: 154 | Train Loss: 1.692 Vali Loss: 3.054 Vali Acc: 0.105 Test Loss: 3.054 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.6339054
	speed: 0.1447s/iter; left time: 2013.2604s
Epoch: 10 cost time: 5.66146445274353
Epoch: 10, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.333 Vali Acc: 0.379 Test Loss: 2.333 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7231053
	speed: 0.1543s/iter; left time: 2123.6840s
Epoch: 11 cost time: 5.332213640213013
Epoch: 11, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.482 Vali Acc: 0.372 Test Loss: 2.482 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8135158
	speed: 0.1483s/iter; left time: 2018.4517s
Epoch: 12 cost time: 4.975405931472778
Epoch: 12, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.492 Vali Acc: 0.365 Test Loss: 2.492 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2058315
	speed: 0.1436s/iter; left time: 1931.9918s
Epoch: 13 cost time: 5.1460113525390625
Epoch: 13, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.225 Vali Acc: 0.212 Test Loss: 2.225 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4680104
	speed: 0.1404s/iter; left time: 1867.1263s
Epoch: 14 cost time: 5.316844701766968
Epoch: 14, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.462 Vali Acc: 0.194 Test Loss: 2.462 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4360003
	speed: 0.1584s/iter; left time: 2082.7380s
Epoch: 15 cost time: 5.495338678359985
Epoch: 15, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.470 Vali Acc: 0.195 Test Loss: 2.470 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6700429
	speed: 0.1433s/iter; left time: 1862.1602s
Epoch: 16 cost time: 5.48333215713501
Epoch: 16, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.343 Vali Acc: 0.201 Test Loss: 2.343 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2621768
	speed: 0.1404s/iter; left time: 1802.7465s
Epoch: 17 cost time: 5.190556049346924
Epoch: 17, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.489 Vali Acc: 0.201 Test Loss: 2.489 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40308191403081917
model parameter : 4036902
model size : 20.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2059269
	speed: 0.0573s/iter; left time: 876.6008s
Epoch: 1 cost time: 7.6135172843933105
Epoch: 1, Steps: 154 | Train Loss: 2.264 Vali Loss: 2.223 Vali Acc: 0.319 Test Loss: 2.223 Test Acc: 0.319
Validation loss decreased (inf --> -0.319118).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4994125
	speed: 0.1760s/iter; left time: 2665.6554s
Epoch: 2 cost time: 5.7412896156311035
Epoch: 2, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.242 Vali Acc: 0.139 Test Loss: 2.242 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9078891
	speed: 0.1667s/iter; left time: 2499.1477s
Epoch: 3 cost time: 5.882918357849121
Epoch: 3, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.712 Vali Acc: 0.326 Test Loss: 2.712 Test Acc: 0.326
Validation loss decreased (-0.319118 --> -0.326412).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5929477
	speed: 0.1730s/iter; left time: 2567.1382s
Epoch: 4 cost time: 5.72559928894043
Epoch: 4, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.953 Vali Acc: 0.332 Test Loss: 2.953 Test Acc: 0.332
Validation loss decreased (-0.326412 --> -0.331682).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6062789
	speed: 0.1627s/iter; left time: 2389.1331s
Epoch: 5 cost time: 5.697454929351807
Epoch: 5, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.356 Vali Acc: 0.196 Test Loss: 2.356 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2828053
	speed: 0.1646s/iter; left time: 2391.2382s
Epoch: 6 cost time: 5.661557912826538
Epoch: 6, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.781 Vali Acc: 0.343 Test Loss: 2.781 Test Acc: 0.343
Validation loss decreased (-0.331682 --> -0.342632).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1342628
	speed: 0.1663s/iter; left time: 2390.8461s
Epoch: 7 cost time: 6.049497365951538
Epoch: 7, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.696 Vali Acc: 0.357 Test Loss: 2.696 Test Acc: 0.357
Validation loss decreased (-0.342632 --> -0.356826).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3611974
	speed: 0.1679s/iter; left time: 2387.6488s
Epoch: 8 cost time: 5.788509368896484
Epoch: 8, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.613 Vali Acc: 0.352 Test Loss: 2.613 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8716843
	speed: 0.1652s/iter; left time: 2323.7670s
Epoch: 9 cost time: 5.362372875213623
Epoch: 9, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.935 Vali Acc: 0.197 Test Loss: 2.935 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9008348
	speed: 0.1571s/iter; left time: 2186.0349s
Epoch: 10 cost time: 5.724262714385986
Epoch: 10, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.366 Vali Acc: 0.387 Test Loss: 2.366 Test Acc: 0.387
Validation loss decreased (-0.356826 --> -0.386838).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6118965
	speed: 0.1567s/iter; left time: 2155.9518s
Epoch: 11 cost time: 5.328078746795654
Epoch: 11, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.441 Vali Acc: 0.199 Test Loss: 2.441 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9141120
	speed: 0.1519s/iter; left time: 2066.5346s
Epoch: 12 cost time: 5.222079277038574
Epoch: 12, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.150 Vali Acc: 0.208 Test Loss: 2.150 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5120878
	speed: 0.1476s/iter; left time: 1986.0875s
Epoch: 13 cost time: 5.340741395950317
Epoch: 13, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.526 Vali Acc: 0.377 Test Loss: 2.526 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6479862
	speed: 0.1516s/iter; left time: 2015.6126s
Epoch: 14 cost time: 6.172523498535156
Epoch: 14, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.239 Vali Acc: 0.397 Test Loss: 2.239 Test Acc: 0.397
Validation loss decreased (-0.386838 --> -0.397382).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9036461
	speed: 0.1613s/iter; left time: 2120.7046s
Epoch: 15 cost time: 5.368621587753296
Epoch: 15, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.720 Vali Acc: 0.209 Test Loss: 2.720 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0281351
	speed: 0.1622s/iter; left time: 2107.0259s
Epoch: 16 cost time: 5.248575925827026
Epoch: 16, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.335 Vali Acc: 0.235 Test Loss: 2.335 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.0983186
	speed: 0.1600s/iter; left time: 2053.8780s
Epoch: 17 cost time: 5.759763479232788
Epoch: 17, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.638 Vali Acc: 0.366 Test Loss: 2.638 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.5590065
	speed: 0.1596s/iter; left time: 2024.0950s
Epoch: 18 cost time: 5.751049757003784
Epoch: 18, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.717 Vali Acc: 0.234 Test Loss: 2.717 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.9130154
	speed: 0.1391s/iter; left time: 1742.8918s
Epoch: 19 cost time: 5.047568321228027
Epoch: 19, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.589 Vali Acc: 0.196 Test Loss: 2.589 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.8771240
	speed: 0.1568s/iter; left time: 1940.7806s
Epoch: 20 cost time: 5.4255051612854
Epoch: 20, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.442 Vali Acc: 0.365 Test Loss: 2.442 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3595082
	speed: 0.1625s/iter; left time: 1985.3854s
Epoch: 21 cost time: 6.55219292640686
Epoch: 21, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.786 Vali Acc: 0.207 Test Loss: 2.786 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4263093
	speed: 0.1717s/iter; left time: 2072.4982s
Epoch: 22 cost time: 6.352184772491455
Epoch: 22, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.262 Vali Acc: 0.139 Test Loss: 3.262 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.2502654
	speed: 0.1736s/iter; left time: 2068.0312s
Epoch: 23 cost time: 6.121943950653076
Epoch: 23, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.708 Vali Acc: 0.264 Test Loss: 2.708 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.2950248
	speed: 0.1673s/iter; left time: 1967.7415s
Epoch: 24 cost time: 5.901579141616821
Epoch: 24, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.574 Vali Acc: 0.167 Test Loss: 2.574 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39740470397404704
model parameter : 4036134
model size : 20.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2684541
	speed: 0.0525s/iter; left time: 802.7171s
Epoch: 1 cost time: 7.151493310928345
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.191 Vali Acc: 0.315 Test Loss: 2.191 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0829198
	speed: 0.1691s/iter; left time: 2561.4541s
Epoch: 2 cost time: 6.2640087604522705
Epoch: 2, Steps: 154 | Train Loss: 2.255 Vali Loss: 2.232 Vali Acc: 0.164 Test Loss: 2.232 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4748907
	speed: 0.1548s/iter; left time: 2321.3052s
Epoch: 3 cost time: 5.775934457778931
Epoch: 3, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.490 Vali Acc: 0.341 Test Loss: 2.490 Test Acc: 0.341
Validation loss decreased (-0.315063 --> -0.341419).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7423230
	speed: 0.1522s/iter; left time: 2259.1398s
Epoch: 4 cost time: 5.142959356307983
Epoch: 4, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.680 Vali Acc: 0.196 Test Loss: 2.680 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7904142
	speed: 0.1646s/iter; left time: 2416.5237s
Epoch: 5 cost time: 5.7204084396362305
Epoch: 5, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.678 Vali Acc: 0.379 Test Loss: 2.678 Test Acc: 0.379
Validation loss decreased (-0.341419 --> -0.378724).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4271436
	speed: 0.1625s/iter; left time: 2361.1796s
Epoch: 6 cost time: 5.802567481994629
Epoch: 6, Steps: 154 | Train Loss: 1.879 Vali Loss: 3.285 Vali Acc: 0.165 Test Loss: 3.285 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4020250
	speed: 0.1615s/iter; left time: 2321.4688s
Epoch: 7 cost time: 5.435302972793579
Epoch: 7, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.726 Vali Acc: 0.260 Test Loss: 2.726 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1622114
	speed: 0.1296s/iter; left time: 1843.3817s
Epoch: 8 cost time: 3.828381299972534
Epoch: 8, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.248 Vali Acc: 0.372 Test Loss: 2.248 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.8903155
	speed: 0.1232s/iter; left time: 1732.6984s
Epoch: 9 cost time: 4.656435966491699
Epoch: 9, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.415 Vali Acc: 0.217 Test Loss: 2.415 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4611024
	speed: 0.1236s/iter; left time: 1719.5143s
Epoch: 10 cost time: 5.1907782554626465
Epoch: 10, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.404 Vali Acc: 0.363 Test Loss: 2.404 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.9212581
	speed: 0.1496s/iter; left time: 2058.5478s
Epoch: 11 cost time: 5.301517486572266
Epoch: 11, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.871 Vali Acc: 0.114 Test Loss: 2.871 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1197388
	speed: 0.1464s/iter; left time: 1991.4421s
Epoch: 12 cost time: 5.234133243560791
Epoch: 12, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.688 Vali Acc: 0.113 Test Loss: 2.688 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.7996178
	speed: 0.1576s/iter; left time: 2120.8578s
Epoch: 13 cost time: 6.281870365142822
Epoch: 13, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.522 Vali Acc: 0.196 Test Loss: 2.522 Test Acc: 0.196
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.5355680
	speed: 0.1511s/iter; left time: 2009.3164s
Epoch: 14 cost time: 5.586335897445679
Epoch: 14, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.326 Vali Acc: 0.205 Test Loss: 2.326 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4004389
	speed: 0.1563s/iter; left time: 2053.9400s
Epoch: 15 cost time: 5.103255033493042
Epoch: 15, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.485 Vali Acc: 0.367 Test Loss: 2.485 Test Acc: 0.367
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 4035366
model size : 20.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1975093
	speed: 0.0503s/iter; left time: 770.3981s
Epoch: 1 cost time: 6.897456407546997
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.436 Vali Acc: 0.109 Test Loss: 2.436 Test Acc: 0.109
Validation loss decreased (inf --> -0.109465).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0875626
	speed: 0.1401s/iter; left time: 2121.6491s
Epoch: 2 cost time: 5.48468542098999
Epoch: 2, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.188 Vali Acc: 0.321 Test Loss: 2.188 Test Acc: 0.321
Validation loss decreased (-0.109465 --> -0.320740).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6974500
	speed: 0.1554s/iter; left time: 2330.2472s
Epoch: 3 cost time: 5.041991710662842
Epoch: 3, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.461 Vali Acc: 0.171 Test Loss: 2.461 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6105492
	speed: 0.1449s/iter; left time: 2149.4936s
Epoch: 4 cost time: 5.275891304016113
Epoch: 4, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.267 Vali Acc: 0.354 Test Loss: 2.267 Test Acc: 0.354
Validation loss decreased (-0.320740 --> -0.353992).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2158992
	speed: 0.1442s/iter; left time: 2116.9403s
Epoch: 5 cost time: 5.69182825088501
Epoch: 5, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.758 Vali Acc: 0.361 Test Loss: 2.758 Test Acc: 0.361
Validation loss decreased (-0.353992 --> -0.361286).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1654422
	speed: 0.1477s/iter; left time: 2145.5203s
Epoch: 6 cost time: 5.2353997230529785
Epoch: 6, Steps: 154 | Train Loss: 1.892 Vali Loss: 3.270 Vali Acc: 0.196 Test Loss: 3.270 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0932937
	speed: 0.1535s/iter; left time: 2206.2770s
Epoch: 7 cost time: 5.355663776397705
Epoch: 7, Steps: 154 | Train Loss: 1.917 Vali Loss: 2.394 Vali Acc: 0.390 Test Loss: 2.394 Test Acc: 0.390
Validation loss decreased (-0.361286 --> -0.389676).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9731426
	speed: 0.1506s/iter; left time: 2141.8890s
Epoch: 8 cost time: 5.144316911697388
Epoch: 8, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.711 Vali Acc: 0.198 Test Loss: 2.711 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0226188
	speed: 0.1350s/iter; left time: 1899.6956s
Epoch: 9 cost time: 5.284292459487915
Epoch: 9, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.610 Vali Acc: 0.369 Test Loss: 2.610 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3214699
	speed: 0.1512s/iter; left time: 2104.5995s
Epoch: 10 cost time: 5.799193620681763
Epoch: 10, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.382 Vali Acc: 0.238 Test Loss: 2.382 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6427758
	speed: 0.1496s/iter; left time: 2058.0342s
Epoch: 11 cost time: 5.365076541900635
Epoch: 11, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.321 Vali Acc: 0.376 Test Loss: 2.321 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7436738
	speed: 0.1460s/iter; left time: 1986.8869s
Epoch: 12 cost time: 5.340352296829224
Epoch: 12, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.408 Vali Acc: 0.365 Test Loss: 2.408 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3329126
	speed: 0.1434s/iter; left time: 1929.4029s
Epoch: 13 cost time: 5.54105281829834
Epoch: 13, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.901 Vali Acc: 0.193 Test Loss: 2.901 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3870345
	speed: 0.1376s/iter; left time: 1829.7508s
Epoch: 14 cost time: 5.07404088973999
Epoch: 14, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.458 Vali Acc: 0.205 Test Loss: 2.458 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.7604831
	speed: 0.1447s/iter; left time: 1902.2477s
Epoch: 15 cost time: 5.098264932632446
Epoch: 15, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.180 Vali Acc: 0.207 Test Loss: 2.180 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.5285795
	speed: 0.1332s/iter; left time: 1730.6554s
Epoch: 16 cost time: 5.304441690444946
Epoch: 16, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.371 Vali Acc: 0.228 Test Loss: 2.371 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2377537
	speed: 0.1400s/iter; left time: 1797.6604s
Epoch: 17 cost time: 5.1221208572387695
Epoch: 17, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.233 Vali Acc: 0.223 Test Loss: 2.233 Test Acc: 0.223
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 3643686
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0134892
	speed: 0.0519s/iter; left time: 794.5838s
Epoch: 1 cost time: 6.7912797927856445
Epoch: 1, Steps: 154 | Train Loss: 2.260 Vali Loss: 2.360 Vali Acc: 0.156 Test Loss: 2.360 Test Acc: 0.156
Validation loss decreased (inf --> -0.156100).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3183537
	speed: 0.1319s/iter; left time: 1998.4833s
Epoch: 2 cost time: 4.911112546920776
Epoch: 2, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.359 Vali Acc: 0.113 Test Loss: 2.359 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5299335
	speed: 0.1358s/iter; left time: 2036.6781s
Epoch: 3 cost time: 5.3540380001068115
Epoch: 3, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.613 Vali Acc: 0.182 Test Loss: 2.613 Test Acc: 0.182
Validation loss decreased (-0.156100 --> -0.181645).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0689359
	speed: 0.1405s/iter; left time: 2084.2074s
Epoch: 4 cost time: 4.884189128875732
Epoch: 4, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.903 Vali Acc: 0.333 Test Loss: 2.903 Test Acc: 0.333
Validation loss decreased (-0.181645 --> -0.333304).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5251801
	speed: 0.1463s/iter; left time: 2147.7402s
Epoch: 5 cost time: 5.225872278213501
Epoch: 5, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.605 Vali Acc: 0.362 Test Loss: 2.605 Test Acc: 0.362
Validation loss decreased (-0.333304 --> -0.361693).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0419073
	speed: 0.1408s/iter; left time: 2045.5859s
Epoch: 6 cost time: 5.561370134353638
Epoch: 6, Steps: 154 | Train Loss: 1.833 Vali Loss: 3.327 Vali Acc: 0.191 Test Loss: 3.327 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4652075
	speed: 0.1441s/iter; left time: 2072.3962s
Epoch: 7 cost time: 5.245185375213623
Epoch: 7, Steps: 154 | Train Loss: 1.866 Vali Loss: 3.226 Vali Acc: 0.358 Test Loss: 3.226 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2526975
	speed: 0.1520s/iter; left time: 2161.2695s
Epoch: 8 cost time: 5.650927543640137
Epoch: 8, Steps: 154 | Train Loss: 1.791 Vali Loss: 3.083 Vali Acc: 0.115 Test Loss: 3.083 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1730227
	speed: 0.1606s/iter; left time: 2259.9506s
Epoch: 9 cost time: 6.028520345687866
Epoch: 9, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.628 Vali Acc: 0.343 Test Loss: 2.628 Test Acc: 0.343
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6229089
	speed: 0.1493s/iter; left time: 2077.1201s
Epoch: 10 cost time: 5.588027238845825
Epoch: 10, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.103 Vali Acc: 0.387 Test Loss: 2.103 Test Acc: 0.387
Validation loss decreased (-0.361693 --> -0.387246).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5366302
	speed: 0.1501s/iter; left time: 2065.0998s
Epoch: 11 cost time: 5.398117303848267
Epoch: 11, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.638 Vali Acc: 0.193 Test Loss: 2.638 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3252285
	speed: 0.1515s/iter; left time: 2061.3842s
Epoch: 12 cost time: 5.3743250370025635
Epoch: 12, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.808 Vali Acc: 0.232 Test Loss: 2.808 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8005079
	speed: 0.1597s/iter; left time: 2148.0956s
Epoch: 13 cost time: 5.962339162826538
Epoch: 13, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.352 Vali Acc: 0.377 Test Loss: 2.352 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.8772790
	speed: 0.1550s/iter; left time: 2061.3730s
Epoch: 14 cost time: 5.369693279266357
Epoch: 14, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.330 Vali Acc: 0.206 Test Loss: 2.330 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.9649495
	speed: 0.1487s/iter; left time: 1954.1212s
Epoch: 15 cost time: 5.309830904006958
Epoch: 15, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.058 Vali Acc: 0.389 Test Loss: 2.058 Test Acc: 0.389
Validation loss decreased (-0.387246 --> -0.389274).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9541636
	speed: 0.1525s/iter; left time: 1980.7744s
Epoch: 16 cost time: 5.4543373584747314
Epoch: 16, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.268 Vali Acc: 0.297 Test Loss: 2.268 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5929081
	speed: 0.1488s/iter; left time: 1910.6988s
Epoch: 17 cost time: 5.149761915206909
Epoch: 17, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.541 Vali Acc: 0.378 Test Loss: 2.541 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3736068
	speed: 0.1387s/iter; left time: 1759.4553s
Epoch: 18 cost time: 5.269526958465576
Epoch: 18, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.612 Vali Acc: 0.375 Test Loss: 2.612 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.5770972
	speed: 0.1325s/iter; left time: 1659.7246s
Epoch: 19 cost time: 4.639807462692261
Epoch: 19, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.499 Vali Acc: 0.207 Test Loss: 2.499 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0613955
	speed: 0.1459s/iter; left time: 1806.0029s
Epoch: 20 cost time: 5.131026744842529
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.786 Vali Acc: 0.180 Test Loss: 2.786 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.8566076
	speed: 0.1492s/iter; left time: 1822.9038s
Epoch: 21 cost time: 5.599932909011841
Epoch: 21, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.445 Vali Acc: 0.388 Test Loss: 2.445 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2249242
	speed: 0.1392s/iter; left time: 1679.5066s
Epoch: 22 cost time: 5.302531003952026
Epoch: 22, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.502 Vali Acc: 0.201 Test Loss: 2.502 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3910822
	speed: 0.1460s/iter; left time: 1738.9572s
Epoch: 23 cost time: 5.144277334213257
Epoch: 23, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.534 Vali Acc: 0.249 Test Loss: 2.534 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.2544764
	speed: 0.1466s/iter; left time: 1724.2788s
Epoch: 24 cost time: 5.056499719619751
Epoch: 24, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.527 Vali Acc: 0.144 Test Loss: 2.527 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.9932904
	speed: 0.1413s/iter; left time: 1639.5182s
Epoch: 25 cost time: 5.260822534561157
Epoch: 25, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.484 Vali Acc: 0.179 Test Loss: 2.484 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 3642918
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2123854
	speed: 0.0455s/iter; left time: 695.7202s
Epoch: 1 cost time: 6.213952302932739
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.307 Vali Acc: 0.315 Test Loss: 2.307 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2380435
	speed: 0.1494s/iter; left time: 2263.4483s
Epoch: 2 cost time: 5.299569606781006
Epoch: 2, Steps: 154 | Train Loss: 2.207 Vali Loss: 2.310 Vali Acc: 0.324 Test Loss: 2.310 Test Acc: 0.324
Validation loss decreased (-0.315468 --> -0.323578).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0803599
	speed: 0.1502s/iter; left time: 2252.6128s
Epoch: 3 cost time: 5.8120951652526855
Epoch: 3, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.200 Vali Acc: 0.347 Test Loss: 2.200 Test Acc: 0.347
Validation loss decreased (-0.323578 --> -0.346693).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8809596
	speed: 0.1585s/iter; left time: 2352.5252s
Epoch: 4 cost time: 5.792583465576172
Epoch: 4, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.101 Vali Acc: 0.395 Test Loss: 2.101 Test Acc: 0.395
Validation loss decreased (-0.346693 --> -0.394951).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1093547
	speed: 0.1437s/iter; left time: 2110.7899s
Epoch: 5 cost time: 4.572124004364014
Epoch: 5, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.493 Vali Acc: 0.298 Test Loss: 2.493 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6062002
	speed: 0.1236s/iter; left time: 1795.4025s
Epoch: 6 cost time: 4.645528554916382
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.847 Vali Acc: 0.130 Test Loss: 2.847 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1111946
	speed: 0.1326s/iter; left time: 1906.6880s
Epoch: 7 cost time: 5.8250768184661865
Epoch: 7, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.803 Vali Acc: 0.358 Test Loss: 2.803 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4676279
	speed: 0.1525s/iter; left time: 2168.5665s
Epoch: 8 cost time: 5.666433572769165
Epoch: 8, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.512 Vali Acc: 0.204 Test Loss: 2.512 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8232286
	speed: 0.1477s/iter; left time: 2078.6180s
Epoch: 9 cost time: 5.360937595367432
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.262 Vali Acc: 0.380 Test Loss: 2.262 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.0907886
	speed: 0.1552s/iter; left time: 2159.2507s
Epoch: 10 cost time: 5.674952507019043
Epoch: 10, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.614 Vali Acc: 0.379 Test Loss: 2.614 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.9185991
	speed: 0.1482s/iter; left time: 2040.0129s
Epoch: 11 cost time: 5.418336868286133
Epoch: 11, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.402 Vali Acc: 0.363 Test Loss: 2.402 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.7476853
	speed: 0.1404s/iter; left time: 1909.9562s
Epoch: 12 cost time: 5.029437780380249
Epoch: 12, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.613 Vali Acc: 0.138 Test Loss: 2.613 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3369858
	speed: 0.1376s/iter; left time: 1851.0202s
Epoch: 13 cost time: 4.984401702880859
Epoch: 13, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.382 Vali Acc: 0.202 Test Loss: 2.382 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.1641054
	speed: 0.1505s/iter; left time: 2001.0655s
Epoch: 14 cost time: 6.074302434921265
Epoch: 14, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.539 Vali Acc: 0.179 Test Loss: 2.539 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 3642150
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3462939
	speed: 0.0463s/iter; left time: 708.7319s
Epoch: 1 cost time: 6.379222631454468
Epoch: 1, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.282 Vali Acc: 0.317 Test Loss: 2.282 Test Acc: 0.317
Validation loss decreased (inf --> -0.317090).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6054258
	speed: 0.1528s/iter; left time: 2315.0538s
Epoch: 2 cost time: 5.010987043380737
Epoch: 2, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.539 Vali Acc: 0.162 Test Loss: 2.539 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8834057
	speed: 0.1441s/iter; left time: 2160.4083s
Epoch: 3 cost time: 5.049803256988525
Epoch: 3, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.260 Vali Acc: 0.192 Test Loss: 2.260 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.6515489
	speed: 0.1477s/iter; left time: 2191.4235s
Epoch: 4 cost time: 5.403190851211548
Epoch: 4, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.142 Vali Acc: 0.371 Test Loss: 2.142 Test Acc: 0.371
Validation loss decreased (-0.317090 --> -0.371430).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9719646
	speed: 0.1369s/iter; left time: 2010.2285s
Epoch: 5 cost time: 4.979717016220093
Epoch: 5, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.438 Vali Acc: 0.309 Test Loss: 2.438 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2066219
	speed: 0.1458s/iter; left time: 2118.9316s
Epoch: 6 cost time: 5.248747825622559
Epoch: 6, Steps: 154 | Train Loss: 1.866 Vali Loss: 3.653 Vali Acc: 0.055 Test Loss: 3.653 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4496952
	speed: 0.1524s/iter; left time: 2191.3324s
Epoch: 7 cost time: 5.362777471542358
Epoch: 7, Steps: 154 | Train Loss: 1.819 Vali Loss: 3.078 Vali Acc: 0.138 Test Loss: 3.078 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8052560
	speed: 0.1416s/iter; left time: 2013.3231s
Epoch: 8 cost time: 5.266923904418945
Epoch: 8, Steps: 154 | Train Loss: 1.771 Vali Loss: 3.000 Vali Acc: 0.183 Test Loss: 3.000 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7058817
	speed: 0.1561s/iter; left time: 2196.4257s
Epoch: 9 cost time: 5.605252742767334
Epoch: 9, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.254 Vali Acc: 0.402 Test Loss: 2.254 Test Acc: 0.402
Validation loss decreased (-0.371430 --> -0.401843).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0640974
	speed: 0.1694s/iter; left time: 2356.6086s
Epoch: 10 cost time: 5.515613794326782
Epoch: 10, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.612 Vali Acc: 0.369 Test Loss: 2.612 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6254754
	speed: 0.1607s/iter; left time: 2212.0482s
Epoch: 11 cost time: 5.676277160644531
Epoch: 11, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.397 Vali Acc: 0.365 Test Loss: 2.397 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7653871
	speed: 0.1512s/iter; left time: 2056.8280s
Epoch: 12 cost time: 5.3088765144348145
Epoch: 12, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.405 Vali Acc: 0.204 Test Loss: 2.405 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6842701
	speed: 0.1557s/iter; left time: 2094.1938s
Epoch: 13 cost time: 6.340587615966797
Epoch: 13, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.638 Vali Acc: 0.199 Test Loss: 2.638 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.8259079
	speed: 0.1616s/iter; left time: 2149.1414s
Epoch: 14 cost time: 5.876596689224243
Epoch: 14, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.515 Vali Acc: 0.197 Test Loss: 2.515 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4215666
	speed: 0.1595s/iter; left time: 2096.2559s
Epoch: 15 cost time: 6.043520450592041
Epoch: 15, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.466 Vali Acc: 0.195 Test Loss: 2.466 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.6309345
	speed: 0.1597s/iter; left time: 2074.8796s
Epoch: 16 cost time: 6.112950086593628
Epoch: 16, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.416 Vali Acc: 0.372 Test Loss: 2.416 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4220548
	speed: 0.1574s/iter; left time: 2020.7706s
Epoch: 17 cost time: 5.214378833770752
Epoch: 17, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.705 Vali Acc: 0.193 Test Loss: 2.705 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3579078
	speed: 0.1500s/iter; left time: 1902.6416s
Epoch: 18 cost time: 4.936664581298828
Epoch: 18, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.637 Vali Acc: 0.209 Test Loss: 2.637 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9179038
	speed: 0.1415s/iter; left time: 1772.7006s
Epoch: 19 cost time: 5.028449296951294
Epoch: 19, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.443 Vali Acc: 0.212 Test Loss: 2.443 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4018653690186537
model parameter : 3641382
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1561558
	speed: 0.0485s/iter; left time: 742.7029s
Epoch: 1 cost time: 6.520971298217773
Epoch: 1, Steps: 154 | Train Loss: 2.260 Vali Loss: 2.399 Vali Acc: 0.316 Test Loss: 2.399 Test Acc: 0.316
Validation loss decreased (inf --> -0.315872).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9827530
	speed: 0.1414s/iter; left time: 2141.4449s
Epoch: 2 cost time: 5.170247793197632
Epoch: 2, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.339 Vali Acc: 0.320 Test Loss: 2.339 Test Acc: 0.320
Validation loss decreased (-0.315872 --> -0.319928).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4763811
	speed: 0.1592s/iter; left time: 2386.2966s
Epoch: 3 cost time: 5.713927745819092
Epoch: 3, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.547 Vali Acc: 0.149 Test Loss: 2.547 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1106172
	speed: 0.1546s/iter; left time: 2294.5484s
Epoch: 4 cost time: 5.291086435317993
Epoch: 4, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.694 Vali Acc: 0.362 Test Loss: 2.694 Test Acc: 0.362
Validation loss decreased (-0.319928 --> -0.361692).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3259716
	speed: 0.1458s/iter; left time: 2140.6516s
Epoch: 5 cost time: 5.086624383926392
Epoch: 5, Steps: 154 | Train Loss: 2.013 Vali Loss: 3.208 Vali Acc: 0.193 Test Loss: 3.208 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4207815
	speed: 0.1312s/iter; left time: 1905.8582s
Epoch: 6 cost time: 4.867724657058716
Epoch: 6, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.580 Vali Acc: 0.383 Test Loss: 2.580 Test Acc: 0.383
Validation loss decreased (-0.361692 --> -0.382780).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3145437
	speed: 0.1466s/iter; left time: 2108.0316s
Epoch: 7 cost time: 5.929642915725708
Epoch: 7, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.238 Vali Acc: 0.362 Test Loss: 2.238 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5342878
	speed: 0.1518s/iter; left time: 2159.3252s
Epoch: 8 cost time: 4.7050299644470215
Epoch: 8, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.932 Vali Acc: 0.191 Test Loss: 2.932 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0260419
	speed: 0.1348s/iter; left time: 1896.2568s
Epoch: 9 cost time: 4.993269681930542
Epoch: 9, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.204 Vali Acc: 0.315 Test Loss: 2.204 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.0266266
	speed: 0.1426s/iter; left time: 1984.1648s
Epoch: 10 cost time: 5.444540739059448
Epoch: 10, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.295 Vali Acc: 0.369 Test Loss: 2.295 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8139776
	speed: 0.1538s/iter; left time: 2117.0452s
Epoch: 11 cost time: 6.036076068878174
Epoch: 11, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.882 Vali Acc: 0.178 Test Loss: 2.882 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5110388
	speed: 0.1626s/iter; left time: 2212.0215s
Epoch: 12 cost time: 5.267496347427368
Epoch: 12, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.522 Vali Acc: 0.198 Test Loss: 2.522 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6878198
	speed: 0.1447s/iter; left time: 1947.0519s
Epoch: 13 cost time: 5.637187480926514
Epoch: 13, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.217 Vali Acc: 0.402 Test Loss: 2.217 Test Acc: 0.402
Validation loss decreased (-0.382780 --> -0.402249).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4044561
	speed: 0.1526s/iter; left time: 2029.2696s
Epoch: 14 cost time: 5.431951999664307
Epoch: 14, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.431 Vali Acc: 0.386 Test Loss: 2.431 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5662955
	speed: 0.1576s/iter; left time: 2071.3027s
Epoch: 15 cost time: 5.821014165878296
Epoch: 15, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.514 Vali Acc: 0.157 Test Loss: 2.514 Test Acc: 0.157
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8466260
	speed: 0.1565s/iter; left time: 2032.5423s
Epoch: 16 cost time: 5.417853355407715
Epoch: 16, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.367 Vali Acc: 0.197 Test Loss: 2.367 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0892812
	speed: 0.1486s/iter; left time: 1908.2172s
Epoch: 17 cost time: 5.141462802886963
Epoch: 17, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.442 Vali Acc: 0.287 Test Loss: 2.442 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.8679212
	speed: 0.1417s/iter; left time: 1797.3322s
Epoch: 18 cost time: 5.974355220794678
Epoch: 18, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.389 Vali Acc: 0.331 Test Loss: 2.389 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.8137596
	speed: 0.1561s/iter; left time: 1955.3759s
Epoch: 19 cost time: 5.864321708679199
Epoch: 19, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.628 Vali Acc: 0.201 Test Loss: 2.628 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.3218862
	speed: 0.1475s/iter; left time: 1825.0515s
Epoch: 20 cost time: 4.932372331619263
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.381 Vali Acc: 0.202 Test Loss: 2.381 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.2218351
	speed: 0.1446s/iter; left time: 1767.5711s
Epoch: 21 cost time: 5.488250255584717
Epoch: 21, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.813 Vali Acc: 0.176 Test Loss: 2.813 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.5512663
	speed: 0.1438s/iter; left time: 1735.1238s
Epoch: 22 cost time: 5.599101305007935
Epoch: 22, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.213 Vali Acc: 0.324 Test Loss: 2.213 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.4594767
	speed: 0.1487s/iter; left time: 1771.1993s
Epoch: 23 cost time: 5.5264482498168945
Epoch: 23, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.452 Vali Acc: 0.380 Test Loss: 2.452 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40227088402270883
model parameter : 3446694
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0736527
	speed: 0.0557s/iter; left time: 852.6123s
Epoch: 1 cost time: 7.6471428871154785
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.296 Vali Acc: 0.155 Test Loss: 2.296 Test Acc: 0.155
Validation loss decreased (inf --> -0.155289).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7246692
	speed: 0.1497s/iter; left time: 2267.4111s
Epoch: 2 cost time: 5.451642274856567
Epoch: 2, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.341 Vali Acc: 0.317 Test Loss: 2.341 Test Acc: 0.317
Validation loss decreased (-0.155289 --> -0.316684).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6518189
	speed: 0.1328s/iter; left time: 1990.3463s
Epoch: 3 cost time: 4.4992287158966064
Epoch: 3, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.332 Vali Acc: 0.338 Test Loss: 2.332 Test Acc: 0.338
Validation loss decreased (-0.316684 --> -0.337771).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8312924
	speed: 0.1182s/iter; left time: 1754.3821s
Epoch: 4 cost time: 4.272655487060547
Epoch: 4, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.411 Vali Acc: 0.341 Test Loss: 2.411 Test Acc: 0.341
Validation loss decreased (-0.337771 --> -0.341014).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1939919
	speed: 0.1367s/iter; left time: 2007.5780s
Epoch: 5 cost time: 5.641441822052002
Epoch: 5, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.328 Vali Acc: 0.357 Test Loss: 2.328 Test Acc: 0.357
Validation loss decreased (-0.341014 --> -0.357235).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0095420
	speed: 0.1658s/iter; left time: 2409.9179s
Epoch: 6 cost time: 6.1503236293792725
Epoch: 6, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.255 Vali Acc: 0.393 Test Loss: 2.255 Test Acc: 0.393
Validation loss decreased (-0.357235 --> -0.392921).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4567456
	speed: 0.1632s/iter; left time: 2345.9841s
Epoch: 7 cost time: 5.792791366577148
Epoch: 7, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.692 Vali Acc: 0.191 Test Loss: 2.692 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4293346
	speed: 0.1591s/iter; left time: 2262.9104s
Epoch: 8 cost time: 5.834598064422607
Epoch: 8, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.335 Vali Acc: 0.206 Test Loss: 2.335 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5236567
	speed: 0.1658s/iter; left time: 2332.7327s
Epoch: 9 cost time: 5.920860052108765
Epoch: 9, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.181 Vali Acc: 0.206 Test Loss: 2.181 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6567037
	speed: 0.1591s/iter; left time: 2214.2423s
Epoch: 10 cost time: 5.449346542358398
Epoch: 10, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.599 Vali Acc: 0.118 Test Loss: 2.599 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2300012
	speed: 0.1577s/iter; left time: 2169.8159s
Epoch: 11 cost time: 5.9099109172821045
Epoch: 11, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.431 Vali Acc: 0.198 Test Loss: 2.431 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.0247555
	speed: 0.1583s/iter; left time: 2154.2525s
Epoch: 12 cost time: 6.113062143325806
Epoch: 12, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.280 Vali Acc: 0.198 Test Loss: 2.280 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3921868
	speed: 0.1548s/iter; left time: 2082.1714s
Epoch: 13 cost time: 5.246127367019653
Epoch: 13, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.181 Vali Acc: 0.356 Test Loss: 2.181 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3729544
	speed: 0.1600s/iter; left time: 2128.3749s
Epoch: 14 cost time: 6.319809913635254
Epoch: 14, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.338 Vali Acc: 0.200 Test Loss: 2.338 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.8790958
	speed: 0.1507s/iter; left time: 1981.4007s
Epoch: 15 cost time: 5.243527412414551
Epoch: 15, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.342 Vali Acc: 0.210 Test Loss: 2.342 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.6358290
	speed: 0.1529s/iter; left time: 1986.0538s
Epoch: 16 cost time: 5.450422525405884
Epoch: 16, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.494 Vali Acc: 0.369 Test Loss: 2.494 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3929440389294404
model parameter : 3445926
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.0384791
	speed: 0.0479s/iter; left time: 732.9294s
Epoch: 1 cost time: 6.6236732006073
Epoch: 1, Steps: 154 | Train Loss: 2.334 Vali Loss: 2.512 Vali Acc: 0.315 Test Loss: 2.512 Test Acc: 0.315
Validation loss decreased (inf --> -0.315466).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4390378
	speed: 0.1560s/iter; left time: 2362.5712s
Epoch: 2 cost time: 5.235934257507324
Epoch: 2, Steps: 154 | Train Loss: 2.284 Vali Loss: 2.197 Vali Acc: 0.324 Test Loss: 2.197 Test Acc: 0.324
Validation loss decreased (-0.315466 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7411149
	speed: 0.1502s/iter; left time: 2251.7866s
Epoch: 3 cost time: 5.237663745880127
Epoch: 3, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.176 Vali Acc: 0.325 Test Loss: 2.176 Test Acc: 0.325
Validation loss decreased (-0.323579 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3652775
	speed: 0.1578s/iter; left time: 2341.4598s
Epoch: 4 cost time: 5.644558668136597
Epoch: 4, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.126 Vali Acc: 0.357 Test Loss: 2.126 Test Acc: 0.357
Validation loss decreased (-0.324796 --> -0.356832).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5542257
	speed: 0.1398s/iter; left time: 2052.2582s
Epoch: 5 cost time: 5.308095455169678
Epoch: 5, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.246 Vali Acc: 0.395 Test Loss: 2.246 Test Acc: 0.395
Validation loss decreased (-0.356832 --> -0.394949).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8428007
	speed: 0.1442s/iter; left time: 2095.7920s
Epoch: 6 cost time: 5.563142776489258
Epoch: 6, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.085 Vali Acc: 0.369 Test Loss: 2.085 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1098473
	speed: 0.1512s/iter; left time: 2173.7858s
Epoch: 7 cost time: 5.52182149887085
Epoch: 7, Steps: 154 | Train Loss: 1.832 Vali Loss: 3.549 Vali Acc: 0.113 Test Loss: 3.549 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0901554
	speed: 0.1552s/iter; left time: 2207.1200s
Epoch: 8 cost time: 5.430340051651001
Epoch: 8, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.350 Vali Acc: 0.200 Test Loss: 2.350 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0653732
	speed: 0.1546s/iter; left time: 2175.5827s
Epoch: 9 cost time: 5.9985363483428955
Epoch: 9, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.553 Vali Acc: 0.200 Test Loss: 2.553 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4826829
	speed: 0.1673s/iter; left time: 2328.5928s
Epoch: 10 cost time: 6.165780305862427
Epoch: 10, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.341 Vali Acc: 0.397 Test Loss: 2.341 Test Acc: 0.397
Validation loss decreased (-0.394949 --> -0.396976).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7928228
	speed: 0.1611s/iter; left time: 2216.8883s
Epoch: 11 cost time: 5.7207350730896
Epoch: 11, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.196 Vali Acc: 0.202 Test Loss: 2.196 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6393155
	speed: 0.1691s/iter; left time: 2301.2301s
Epoch: 12 cost time: 5.987524032592773
Epoch: 12, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.495 Vali Acc: 0.329 Test Loss: 2.495 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7804372
	speed: 0.1672s/iter; left time: 2249.2845s
Epoch: 13 cost time: 5.864292860031128
Epoch: 13, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.634 Vali Acc: 0.180 Test Loss: 2.634 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7296300
	speed: 0.1534s/iter; left time: 2039.8605s
Epoch: 14 cost time: 5.833487510681152
Epoch: 14, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.360 Vali Acc: 0.385 Test Loss: 2.360 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6071521
	speed: 0.1461s/iter; left time: 1920.5444s
Epoch: 15 cost time: 5.032947778701782
Epoch: 15, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.459 Vali Acc: 0.355 Test Loss: 2.459 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5367378
	speed: 0.1439s/iter; left time: 1869.2911s
Epoch: 16 cost time: 5.319107532501221
Epoch: 16, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.379 Vali Acc: 0.370 Test Loss: 2.379 Test Acc: 0.370
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3644428
	speed: 0.1425s/iter; left time: 1829.2170s
Epoch: 17 cost time: 5.2754294872283936
Epoch: 17, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.499 Vali Acc: 0.383 Test Loss: 2.499 Test Acc: 0.383
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.8046644
	speed: 0.1535s/iter; left time: 1946.6268s
Epoch: 18 cost time: 5.331325531005859
Epoch: 18, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.385 Vali Acc: 0.217 Test Loss: 2.385 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.8411349
	speed: 0.1547s/iter; left time: 1938.1721s
Epoch: 19 cost time: 5.921635389328003
Epoch: 19, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.498 Vali Acc: 0.367 Test Loss: 2.498 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.9011385
	speed: 0.1586s/iter; left time: 1962.5531s
Epoch: 20 cost time: 6.03333592414856
Epoch: 20, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.363 Vali Acc: 0.367 Test Loss: 2.363 Test Acc: 0.367
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39699918896999187
model parameter : 3445158
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2164907
	speed: 0.0487s/iter; left time: 745.6458s
Epoch: 1 cost time: 6.73417592048645
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.274 Vali Acc: 0.315 Test Loss: 2.274 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6260750
	speed: 0.1472s/iter; left time: 2229.0047s
Epoch: 2 cost time: 4.9911181926727295
Epoch: 2, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.496 Vali Acc: 0.159 Test Loss: 2.496 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0012875
	speed: 0.1404s/iter; left time: 2105.4060s
Epoch: 3 cost time: 5.280929088592529
Epoch: 3, Steps: 154 | Train Loss: 2.164 Vali Loss: 2.448 Vali Acc: 0.143 Test Loss: 2.448 Test Acc: 0.143
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3237119
	speed: 0.1534s/iter; left time: 2275.7583s
Epoch: 4 cost time: 5.42166543006897
Epoch: 4, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.402 Vali Acc: 0.097 Test Loss: 2.402 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6098393
	speed: 0.1532s/iter; left time: 2249.8912s
Epoch: 5 cost time: 5.471285104751587
Epoch: 5, Steps: 154 | Train Loss: 2.017 Vali Loss: 3.172 Vali Acc: 0.204 Test Loss: 3.172 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.2046213
	speed: 0.1458s/iter; left time: 2118.7100s
Epoch: 6 cost time: 5.71265172958374
Epoch: 6, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.817 Vali Acc: 0.188 Test Loss: 2.817 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.1675138
	speed: 0.1616s/iter; left time: 2323.4292s
Epoch: 7 cost time: 5.996623516082764
Epoch: 7, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.366 Vali Acc: 0.354 Test Loss: 2.366 Test Acc: 0.354
Validation loss decreased (-0.315468 --> -0.354396).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6845646
	speed: 0.1621s/iter; left time: 2305.3850s
Epoch: 8 cost time: 5.306927442550659
Epoch: 8, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.700 Vali Acc: 0.198 Test Loss: 2.700 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5467734
	speed: 0.1634s/iter; left time: 2298.3332s
Epoch: 9 cost time: 5.421738624572754
Epoch: 9, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.639 Vali Acc: 0.190 Test Loss: 2.639 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7873639
	speed: 0.1536s/iter; left time: 2137.2506s
Epoch: 10 cost time: 5.225617408752441
Epoch: 10, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.321 Vali Acc: 0.316 Test Loss: 2.321 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7464203
	speed: 0.1567s/iter; left time: 2156.7587s
Epoch: 11 cost time: 5.694825172424316
Epoch: 11, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.418 Vali Acc: 0.196 Test Loss: 2.418 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6877499
	speed: 0.1615s/iter; left time: 2197.3396s
Epoch: 12 cost time: 5.352205276489258
Epoch: 12, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.397 Vali Acc: 0.242 Test Loss: 2.397 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7243505
	speed: 0.1557s/iter; left time: 2094.6013s
Epoch: 13 cost time: 5.964041233062744
Epoch: 13, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.511 Vali Acc: 0.212 Test Loss: 2.511 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8959022
	speed: 0.1692s/iter; left time: 2250.8164s
Epoch: 14 cost time: 5.288581848144531
Epoch: 14, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.060 Vali Acc: 0.373 Test Loss: 2.060 Test Acc: 0.373
Validation loss decreased (-0.354396 --> -0.372648).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5247430
	speed: 0.1626s/iter; left time: 2137.1318s
Epoch: 15 cost time: 5.696423292160034
Epoch: 15, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.276 Vali Acc: 0.388 Test Loss: 2.276 Test Acc: 0.388
Validation loss decreased (-0.372648 --> -0.388055).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3912740
	speed: 0.1453s/iter; left time: 1887.5308s
Epoch: 16 cost time: 4.8488945960998535
Epoch: 16, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.312 Vali Acc: 0.218 Test Loss: 2.312 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.8698965
	speed: 0.1487s/iter; left time: 1908.7338s
Epoch: 17 cost time: 5.478211402893066
Epoch: 17, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.428 Vali Acc: 0.219 Test Loss: 2.428 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.2321155
	speed: 0.1626s/iter; left time: 2061.9853s
Epoch: 18 cost time: 5.917955636978149
Epoch: 18, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.567 Vali Acc: 0.202 Test Loss: 2.567 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.7867954
	speed: 0.1528s/iter; left time: 1914.4796s
Epoch: 19 cost time: 5.5308849811553955
Epoch: 19, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.591 Vali Acc: 0.210 Test Loss: 2.591 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.6265033
	speed: 0.1527s/iter; left time: 1889.3514s
Epoch: 20 cost time: 5.437787055969238
Epoch: 20, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.871 Vali Acc: 0.206 Test Loss: 2.871 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.0112420
	speed: 0.1520s/iter; left time: 1857.4018s
Epoch: 21 cost time: 4.983505725860596
Epoch: 21, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.746 Vali Acc: 0.178 Test Loss: 2.746 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.0874486
	speed: 0.1481s/iter; left time: 1787.7187s
Epoch: 22 cost time: 5.336024045944214
Epoch: 22, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.827 Vali Acc: 0.088 Test Loss: 2.827 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3080500
	speed: 0.1467s/iter; left time: 1747.9717s
Epoch: 23 cost time: 5.197544813156128
Epoch: 23, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.518 Vali Acc: 0.336 Test Loss: 2.518 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.4995847
	speed: 0.1445s/iter; left time: 1699.4751s
Epoch: 24 cost time: 5.271585702896118
Epoch: 24, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.629 Vali Acc: 0.085 Test Loss: 2.629 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.5249133
	speed: 0.1541s/iter; left time: 1787.7563s
Epoch: 25 cost time: 5.07965350151062
Epoch: 25, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.390 Vali Acc: 0.158 Test Loss: 2.390 Test Acc: 0.158
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 3444390
model size : 18.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0461957
	speed: 0.0526s/iter; left time: 804.1707s
Epoch: 1 cost time: 6.974722623825073
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.192 Vali Acc: 0.316 Test Loss: 2.192 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6633172
	speed: 0.1490s/iter; left time: 2256.4121s
Epoch: 2 cost time: 5.370017766952515
Epoch: 2, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.293 Vali Acc: 0.322 Test Loss: 2.293 Test Acc: 0.322
Validation loss decreased (-0.315874 --> -0.322362).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7747142
	speed: 0.1454s/iter; left time: 2180.3087s
Epoch: 3 cost time: 5.712227821350098
Epoch: 3, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.173 Vali Acc: 0.321 Test Loss: 2.173 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9565936
	speed: 0.1543s/iter; left time: 2289.9677s
Epoch: 4 cost time: 5.4340972900390625
Epoch: 4, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.193 Vali Acc: 0.189 Test Loss: 2.193 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0029967
	speed: 0.1530s/iter; left time: 2247.5172s
Epoch: 5 cost time: 5.359451532363892
Epoch: 5, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.173 Vali Acc: 0.361 Test Loss: 2.173 Test Acc: 0.361
Validation loss decreased (-0.322362 --> -0.360887).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7447610
	speed: 0.1478s/iter; left time: 2148.0804s
Epoch: 6 cost time: 5.34105658531189
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.909 Vali Acc: 0.358 Test Loss: 2.909 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5087057
	speed: 0.1501s/iter; left time: 2157.9412s
Epoch: 7 cost time: 5.574449062347412
Epoch: 7, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.599 Vali Acc: 0.361 Test Loss: 2.599 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8867369
	speed: 0.1575s/iter; left time: 2240.1068s
Epoch: 8 cost time: 5.336400985717773
Epoch: 8, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.766 Vali Acc: 0.371 Test Loss: 2.766 Test Acc: 0.371
Validation loss decreased (-0.360887 --> -0.370613).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6549734
	speed: 0.1430s/iter; left time: 2011.5306s
Epoch: 9 cost time: 5.247164487838745
Epoch: 9, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.809 Vali Acc: 0.144 Test Loss: 2.809 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5993006
	speed: 0.1400s/iter; left time: 1947.9206s
Epoch: 10 cost time: 5.150849103927612
Epoch: 10, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.055 Vali Acc: 0.375 Test Loss: 3.055 Test Acc: 0.375
Validation loss decreased (-0.370613 --> -0.374665).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4554852
	speed: 0.1493s/iter; left time: 2054.9272s
Epoch: 11 cost time: 5.776335000991821
Epoch: 11, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.944 Vali Acc: 0.099 Test Loss: 2.944 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0478653
	speed: 0.1492s/iter; left time: 2030.5486s
Epoch: 12 cost time: 5.0322980880737305
Epoch: 12, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.564 Vali Acc: 0.277 Test Loss: 2.564 Test Acc: 0.277
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2111512
	speed: 0.1420s/iter; left time: 1910.1547s
Epoch: 13 cost time: 4.790006399154663
Epoch: 13, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.395 Vali Acc: 0.368 Test Loss: 2.395 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3321136
	speed: 0.1445s/iter; left time: 1921.3502s
Epoch: 14 cost time: 4.964769124984741
Epoch: 14, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.760 Vali Acc: 0.136 Test Loss: 2.760 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5178424
	speed: 0.1423s/iter; left time: 1870.8122s
Epoch: 15 cost time: 5.408579349517822
Epoch: 15, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.994 Vali Acc: 0.196 Test Loss: 2.994 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8636256
	speed: 0.1548s/iter; left time: 2010.7654s
Epoch: 16 cost time: 5.4961769580841064
Epoch: 16, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.502 Vali Acc: 0.370 Test Loss: 2.502 Test Acc: 0.370
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.4221472
	speed: 0.1332s/iter; left time: 1710.2074s
Epoch: 17 cost time: 4.82344388961792
Epoch: 17, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.656 Vali Acc: 0.306 Test Loss: 2.656 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.7445574
	speed: 0.1368s/iter; left time: 1734.8764s
Epoch: 18 cost time: 4.869760990142822
Epoch: 18, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.987 Vali Acc: 0.158 Test Loss: 2.987 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3802644
	speed: 0.1464s/iter; left time: 1834.1486s
Epoch: 19 cost time: 5.2131102085113525
Epoch: 19, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.747 Vali Acc: 0.217 Test Loss: 2.747 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.8467909
	speed: 0.1378s/iter; left time: 1705.1226s
Epoch: 20 cost time: 4.954862594604492
Epoch: 20, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.744 Vali Acc: 0.214 Test Loss: 2.744 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 1627942
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1076798
	speed: 0.0462s/iter; left time: 707.0864s
Epoch: 1 cost time: 6.376690149307251
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.176 Vali Acc: 0.315 Test Loss: 2.176 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1875434
	speed: 0.1440s/iter; left time: 2181.4206s
Epoch: 2 cost time: 5.14767599105835
Epoch: 2, Steps: 154 | Train Loss: 2.193 Vali Loss: 2.472 Vali Acc: 0.318 Test Loss: 2.472 Test Acc: 0.318
Validation loss decreased (-0.315063 --> -0.318305).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4065831
	speed: 0.1351s/iter; left time: 2025.6748s
Epoch: 3 cost time: 5.37989354133606
Epoch: 3, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.373 Vali Acc: 0.324 Test Loss: 2.373 Test Acc: 0.324
Validation loss decreased (-0.318305 --> -0.323983).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0543256
	speed: 0.1433s/iter; left time: 2126.1783s
Epoch: 4 cost time: 5.314687252044678
Epoch: 4, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.574 Vali Acc: 0.340 Test Loss: 2.574 Test Acc: 0.340
Validation loss decreased (-0.323983 --> -0.340201).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8540875
	speed: 0.1503s/iter; left time: 2206.9809s
Epoch: 5 cost time: 5.515350103378296
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.153 Vali Acc: 0.355 Test Loss: 2.153 Test Acc: 0.355
Validation loss decreased (-0.340201 --> -0.355210).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2322609
	speed: 0.1537s/iter; left time: 2232.7214s
Epoch: 6 cost time: 5.703566074371338
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.381 Vali Acc: 0.358 Test Loss: 2.381 Test Acc: 0.358
Validation loss decreased (-0.355210 --> -0.357640).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3811935
	speed: 0.1470s/iter; left time: 2113.5486s
Epoch: 7 cost time: 5.603015899658203
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 3.036 Vali Acc: 0.199 Test Loss: 3.036 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7586212
	speed: 0.1482s/iter; left time: 2108.2431s
Epoch: 8 cost time: 4.849664926528931
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.862 Vali Acc: 0.193 Test Loss: 2.862 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2350090
	speed: 0.1425s/iter; left time: 2005.1780s
Epoch: 9 cost time: 5.567523002624512
Epoch: 9, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.524 Vali Acc: 0.208 Test Loss: 2.524 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7328203
	speed: 0.1484s/iter; left time: 2064.6581s
Epoch: 10 cost time: 5.309331178665161
Epoch: 10, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.827 Vali Acc: 0.199 Test Loss: 2.827 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3995365
	speed: 0.1338s/iter; left time: 1841.2861s
Epoch: 11 cost time: 4.7132158279418945
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.570 Vali Acc: 0.365 Test Loss: 2.570 Test Acc: 0.365
Validation loss decreased (-0.357640 --> -0.364938).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7637739
	speed: 0.1356s/iter; left time: 1845.7659s
Epoch: 12 cost time: 4.842141151428223
Epoch: 12, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.708 Vali Acc: 0.365 Test Loss: 2.708 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9341309
	speed: 0.1306s/iter; left time: 1757.1054s
Epoch: 13 cost time: 4.807455062866211
Epoch: 13, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.476 Vali Acc: 0.378 Test Loss: 2.476 Test Acc: 0.378
Validation loss decreased (-0.364938 --> -0.378321).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6133968
	speed: 0.1427s/iter; left time: 1897.1959s
Epoch: 14 cost time: 5.2576904296875
Epoch: 14, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.739 Vali Acc: 0.223 Test Loss: 2.739 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2473738
	speed: 0.1352s/iter; left time: 1777.3565s
Epoch: 15 cost time: 4.9007415771484375
Epoch: 15, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.772 Vali Acc: 0.209 Test Loss: 2.772 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8956056
	speed: 0.1325s/iter; left time: 1720.9870s
Epoch: 16 cost time: 4.82495903968811
Epoch: 16, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.474 Vali Acc: 0.216 Test Loss: 2.474 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.6397538
	speed: 0.1387s/iter; left time: 1780.3560s
Epoch: 17 cost time: 5.016312837600708
Epoch: 17, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.419 Vali Acc: 0.390 Test Loss: 2.419 Test Acc: 0.390
Validation loss decreased (-0.378321 --> -0.390081).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0536469
	speed: 0.1470s/iter; left time: 1864.1304s
Epoch: 18 cost time: 5.352056980133057
Epoch: 18, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.843 Vali Acc: 0.205 Test Loss: 2.843 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6681374
	speed: 0.1372s/iter; left time: 1719.4077s
Epoch: 19 cost time: 4.733773469924927
Epoch: 19, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.121 Vali Acc: 0.069 Test Loss: 3.121 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.7586703
	speed: 0.1350s/iter; left time: 1670.2731s
Epoch: 20 cost time: 4.722620725631714
Epoch: 20, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.249 Vali Acc: 0.095 Test Loss: 3.249 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3841254
	speed: 0.1356s/iter; left time: 1657.2985s
Epoch: 21 cost time: 5.207467317581177
Epoch: 21, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.937 Vali Acc: 0.161 Test Loss: 2.937 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.1780468
	speed: 0.1515s/iter; left time: 1827.8886s
Epoch: 22 cost time: 5.427396059036255
Epoch: 22, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.774 Vali Acc: 0.209 Test Loss: 2.774 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3615047
	speed: 0.1613s/iter; left time: 1922.0827s
Epoch: 23 cost time: 5.598973274230957
Epoch: 23, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.017 Vali Acc: 0.170 Test Loss: 3.017 Test Acc: 0.170
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.5747046
	speed: 0.1514s/iter; left time: 1780.3607s
Epoch: 24 cost time: 5.646849632263184
Epoch: 24, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.641 Vali Acc: 0.179 Test Loss: 2.641 Test Acc: 0.179
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.4590597
	speed: 0.1485s/iter; left time: 1722.9117s
Epoch: 25 cost time: 4.847839832305908
Epoch: 25, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.288 Vali Acc: 0.082 Test Loss: 3.288 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.0705210
	speed: 0.1493s/iter; left time: 1710.0681s
Epoch: 26 cost time: 5.272064447402954
Epoch: 26, Steps: 154 | Train Loss: 1.217 Vali Loss: 2.695 Vali Acc: 0.400 Test Loss: 2.695 Test Acc: 0.400
Validation loss decreased (-0.390081 --> -0.399811).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.8449411
	speed: 0.1567s/iter; left time: 1769.7808s
Epoch: 27 cost time: 5.608169317245483
Epoch: 27, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.616 Vali Acc: 0.172 Test Loss: 2.616 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5139850
	speed: 0.1441s/iter; left time: 1606.2024s
Epoch: 28 cost time: 5.2710487842559814
Epoch: 28, Steps: 154 | Train Loss: 1.216 Vali Loss: 2.505 Vali Acc: 0.234 Test Loss: 2.505 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.6620072
	speed: 0.1419s/iter; left time: 1558.8150s
Epoch: 29 cost time: 4.98356819152832
Epoch: 29, Steps: 154 | Train Loss: 1.190 Vali Loss: 2.864 Vali Acc: 0.165 Test Loss: 2.864 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.4014207
	speed: 0.1526s/iter; left time: 1653.8009s
Epoch: 30 cost time: 5.725064992904663
Epoch: 30, Steps: 154 | Train Loss: 1.196 Vali Loss: 2.649 Vali Acc: 0.217 Test Loss: 2.649 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.8822712
	speed: 0.1462s/iter; left time: 1561.9503s
Epoch: 31 cost time: 5.604496717453003
Epoch: 31, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.682 Vali Acc: 0.205 Test Loss: 2.682 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.5228511
	speed: 0.1406s/iter; left time: 1480.5719s
Epoch: 32 cost time: 5.100837230682373
Epoch: 32, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.483 Vali Acc: 0.260 Test Loss: 2.483 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 1.0020615
	speed: 0.1397s/iter; left time: 1449.5289s
Epoch: 33 cost time: 4.795757055282593
Epoch: 33, Steps: 154 | Train Loss: 1.156 Vali Loss: 3.114 Vali Acc: 0.131 Test Loss: 3.114 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.0561482
	speed: 0.1459s/iter; left time: 1490.5717s
Epoch: 34 cost time: 5.863107919692993
Epoch: 34, Steps: 154 | Train Loss: 1.159 Vali Loss: 2.740 Vali Acc: 0.390 Test Loss: 2.740 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.3498371
	speed: 0.1425s/iter; left time: 1434.5449s
Epoch: 35 cost time: 5.128337860107422
Epoch: 35, Steps: 154 | Train Loss: 1.151 Vali Loss: 2.575 Vali Acc: 0.331 Test Loss: 2.575 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 1.0613933
	speed: 0.1441s/iter; left time: 1427.8480s
Epoch: 36 cost time: 5.440441846847534
Epoch: 36, Steps: 154 | Train Loss: 1.127 Vali Loss: 2.871 Vali Acc: 0.129 Test Loss: 2.871 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39983779399837793
model parameter : 1627558
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0232668
	speed: 0.0462s/iter; left time: 707.2021s
Epoch: 1 cost time: 6.304964780807495
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.211 Vali Acc: 0.155 Test Loss: 2.211 Test Acc: 0.155
Validation loss decreased (inf --> -0.155290).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3184967
	speed: 0.1207s/iter; left time: 1828.6938s
Epoch: 2 cost time: 4.196025609970093
Epoch: 2, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.121 Vali Acc: 0.323 Test Loss: 2.121 Test Acc: 0.323
Validation loss decreased (-0.155290 --> -0.322769).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1506543
	speed: 0.1098s/iter; left time: 1646.0443s
Epoch: 3 cost time: 4.138196229934692
Epoch: 3, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.325 Vali Acc: 0.325 Test Loss: 2.325 Test Acc: 0.325
Validation loss decreased (-0.322769 --> -0.324794).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8529947
	speed: 0.1205s/iter; left time: 1788.0144s
Epoch: 4 cost time: 5.399125576019287
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.333 Vali Acc: 0.110 Test Loss: 2.333 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0900953
	speed: 0.1429s/iter; left time: 2098.0689s
Epoch: 5 cost time: 5.111521482467651
Epoch: 5, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.330 Vali Acc: 0.202 Test Loss: 2.330 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6435459
	speed: 0.1460s/iter; left time: 2121.6063s
Epoch: 6 cost time: 5.05104923248291
Epoch: 6, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.270 Vali Acc: 0.354 Test Loss: 2.270 Test Acc: 0.354
Validation loss decreased (-0.324794 --> -0.353992).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7299005
	speed: 0.1406s/iter; left time: 2020.8842s
Epoch: 7 cost time: 4.97963285446167
Epoch: 7, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.784 Vali Acc: 0.200 Test Loss: 2.784 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8019942
	speed: 0.1374s/iter; left time: 1953.5309s
Epoch: 8 cost time: 5.035853862762451
Epoch: 8, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.978 Vali Acc: 0.199 Test Loss: 2.978 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4469433
	speed: 0.1393s/iter; left time: 1959.8741s
Epoch: 9 cost time: 5.237502098083496
Epoch: 9, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.793 Vali Acc: 0.181 Test Loss: 2.793 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7423602
	speed: 0.1419s/iter; left time: 1974.8078s
Epoch: 10 cost time: 5.32313871383667
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.913 Vali Acc: 0.144 Test Loss: 2.913 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0276661
	speed: 0.1447s/iter; left time: 1990.9149s
Epoch: 11 cost time: 5.354093790054321
Epoch: 11, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.995 Vali Acc: 0.077 Test Loss: 2.995 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.1582263
	speed: 0.1394s/iter; left time: 1896.4467s
Epoch: 12 cost time: 4.7539496421813965
Epoch: 12, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.010 Vali Acc: 0.207 Test Loss: 3.010 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.5038810
	speed: 0.1547s/iter; left time: 2081.7181s
Epoch: 13 cost time: 5.694513320922852
Epoch: 13, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.757 Vali Acc: 0.249 Test Loss: 2.757 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.7607316
	speed: 0.1341s/iter; left time: 1783.1742s
Epoch: 14 cost time: 4.834723472595215
Epoch: 14, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.914 Vali Acc: 0.208 Test Loss: 2.914 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2315012
	speed: 0.1376s/iter; left time: 1808.2750s
Epoch: 15 cost time: 4.950587749481201
Epoch: 15, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.581 Vali Acc: 0.227 Test Loss: 2.581 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.7467881
	speed: 0.1377s/iter; left time: 1788.9123s
Epoch: 16 cost time: 4.964457035064697
Epoch: 16, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.663 Vali Acc: 0.222 Test Loss: 2.663 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.354014598540146
model parameter : 1627174
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6400943
	speed: 0.0446s/iter; left time: 682.2487s
Epoch: 1 cost time: 6.214221239089966
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.238 Vali Acc: 0.315 Test Loss: 2.238 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4739811
	speed: 0.1439s/iter; left time: 2179.2492s
Epoch: 2 cost time: 5.007607936859131
Epoch: 2, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.154 Vali Acc: 0.320 Test Loss: 2.154 Test Acc: 0.320
Validation loss decreased (-0.315468 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4010892
	speed: 0.1453s/iter; left time: 2177.9118s
Epoch: 3 cost time: 5.2945311069488525
Epoch: 3, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.227 Vali Acc: 0.333 Test Loss: 2.227 Test Acc: 0.333
Validation loss decreased (-0.320335 --> -0.332500).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9044671
	speed: 0.1363s/iter; left time: 2021.9412s
Epoch: 4 cost time: 5.391631364822388
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.037 Vali Acc: 0.358 Test Loss: 2.037 Test Acc: 0.358
Validation loss decreased (-0.332500 --> -0.357644).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5955145
	speed: 0.1451s/iter; left time: 2130.5550s
Epoch: 5 cost time: 5.7394068241119385
Epoch: 5, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.930 Vali Acc: 0.102 Test Loss: 2.930 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6390661
	speed: 0.1440s/iter; left time: 2091.8181s
Epoch: 6 cost time: 4.958329200744629
Epoch: 6, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.944 Vali Acc: 0.180 Test Loss: 2.944 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4082413
	speed: 0.1353s/iter; left time: 1944.8212s
Epoch: 7 cost time: 4.511807441711426
Epoch: 7, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.715 Vali Acc: 0.192 Test Loss: 2.715 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3455381
	speed: 0.1357s/iter; left time: 1930.3715s
Epoch: 8 cost time: 5.023322105407715
Epoch: 8, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.638 Vali Acc: 0.377 Test Loss: 2.638 Test Acc: 0.377
Validation loss decreased (-0.357644 --> -0.376697).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0334098
	speed: 0.1388s/iter; left time: 1952.9590s
Epoch: 9 cost time: 5.32466983795166
Epoch: 9, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.084 Vali Acc: 0.236 Test Loss: 3.084 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4941831
	speed: 0.1423s/iter; left time: 1980.6157s
Epoch: 10 cost time: 5.1589415073394775
Epoch: 10, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.963 Vali Acc: 0.197 Test Loss: 2.963 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3727499
	speed: 0.1470s/iter; left time: 2022.9669s
Epoch: 11 cost time: 5.307835340499878
Epoch: 11, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.666 Vali Acc: 0.406 Test Loss: 2.666 Test Acc: 0.406
Validation loss decreased (-0.376697 --> -0.405894).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4107553
	speed: 0.1428s/iter; left time: 1943.5148s
Epoch: 12 cost time: 5.59354829788208
Epoch: 12, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.461 Vali Acc: 0.207 Test Loss: 2.461 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1818465
	speed: 0.1501s/iter; left time: 2019.4638s
Epoch: 13 cost time: 5.102748155593872
Epoch: 13, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.485 Vali Acc: 0.384 Test Loss: 2.485 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2145841
	speed: 0.1414s/iter; left time: 1880.2297s
Epoch: 14 cost time: 5.242850065231323
Epoch: 14, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.764 Vali Acc: 0.208 Test Loss: 2.764 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1454672
	speed: 0.1441s/iter; left time: 1893.5402s
Epoch: 15 cost time: 5.757364988327026
Epoch: 15, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.368 Vali Acc: 0.119 Test Loss: 3.368 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1242254
	speed: 0.1485s/iter; left time: 1928.5714s
Epoch: 16 cost time: 5.2428297996521
Epoch: 16, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.967 Vali Acc: 0.186 Test Loss: 2.967 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1780431
	speed: 0.1486s/iter; left time: 1906.9906s
Epoch: 17 cost time: 5.21126651763916
Epoch: 17, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.865 Vali Acc: 0.134 Test Loss: 2.865 Test Acc: 0.134
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3293914
	speed: 0.1475s/iter; left time: 1870.8721s
Epoch: 18 cost time: 5.574140787124634
Epoch: 18, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.810 Vali Acc: 0.283 Test Loss: 2.810 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3889604
	speed: 0.1396s/iter; left time: 1749.0163s
Epoch: 19 cost time: 4.93376612663269
Epoch: 19, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.345 Vali Acc: 0.112 Test Loss: 3.345 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9759296
	speed: 0.1405s/iter; left time: 1739.1370s
Epoch: 20 cost time: 4.704267501831055
Epoch: 20, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.410 Vali Acc: 0.166 Test Loss: 3.410 Test Acc: 0.166
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1725945
	speed: 0.1297s/iter; left time: 1585.2128s
Epoch: 21 cost time: 5.0190589427948
Epoch: 21, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.816 Vali Acc: 0.112 Test Loss: 2.816 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4059205190592052
model parameter : 1626790
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9367847
	speed: 0.0442s/iter; left time: 676.4805s
Epoch: 1 cost time: 6.060866594314575
Epoch: 1, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.236 Vali Acc: 0.162 Test Loss: 2.236 Test Acc: 0.162
Validation loss decreased (inf --> -0.161778).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2319987
	speed: 0.1411s/iter; left time: 2136.6989s
Epoch: 2 cost time: 5.165495872497559
Epoch: 2, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.218 Vali Acc: 0.324 Test Loss: 2.218 Test Acc: 0.324
Validation loss decreased (-0.161778 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0677667
	speed: 0.1447s/iter; left time: 2169.9415s
Epoch: 3 cost time: 5.902794122695923
Epoch: 3, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.256 Vali Acc: 0.328 Test Loss: 2.256 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0102577
	speed: 0.1602s/iter; left time: 2377.2810s
Epoch: 4 cost time: 5.691745281219482
Epoch: 4, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.197 Vali Acc: 0.343 Test Loss: 2.197 Test Acc: 0.343
Validation loss decreased (-0.328445 --> -0.342638).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5195057
	speed: 0.1463s/iter; left time: 2148.6737s
Epoch: 5 cost time: 4.828475475311279
Epoch: 5, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.232 Vali Acc: 0.351 Test Loss: 2.232 Test Acc: 0.351
Validation loss decreased (-0.342638 --> -0.351154).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4227835
	speed: 0.1324s/iter; left time: 1923.3255s
Epoch: 6 cost time: 4.773339509963989
Epoch: 6, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.445 Vali Acc: 0.222 Test Loss: 2.445 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3925457
	speed: 0.1322s/iter; left time: 1901.3493s
Epoch: 7 cost time: 5.1554484367370605
Epoch: 7, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.924 Vali Acc: 0.107 Test Loss: 2.924 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1551826
	speed: 0.1497s/iter; left time: 2129.4461s
Epoch: 8 cost time: 5.001431941986084
Epoch: 8, Steps: 154 | Train Loss: 1.620 Vali Loss: 3.003 Vali Acc: 0.199 Test Loss: 3.003 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7622489
	speed: 0.1494s/iter; left time: 2101.4622s
Epoch: 9 cost time: 5.524642467498779
Epoch: 9, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.982 Vali Acc: 0.203 Test Loss: 2.982 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3426791
	speed: 0.1456s/iter; left time: 2026.3130s
Epoch: 10 cost time: 5.805153131484985
Epoch: 10, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.009 Vali Acc: 0.201 Test Loss: 3.009 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6642529
	speed: 0.1510s/iter; left time: 2077.3186s
Epoch: 11 cost time: 5.392112970352173
Epoch: 11, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.838 Vali Acc: 0.201 Test Loss: 2.838 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.2621620
	speed: 0.1528s/iter; left time: 2079.3001s
Epoch: 12 cost time: 5.31501030921936
Epoch: 12, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.438 Vali Acc: 0.383 Test Loss: 2.438 Test Acc: 0.383
Validation loss decreased (-0.351154 --> -0.382782).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4396664
	speed: 0.1454s/iter; left time: 1956.1702s
Epoch: 13 cost time: 5.612122297286987
Epoch: 13, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.618 Vali Acc: 0.176 Test Loss: 2.618 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8720832
	speed: 0.1464s/iter; left time: 1947.2571s
Epoch: 14 cost time: 5.163385629653931
Epoch: 14, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.760 Vali Acc: 0.373 Test Loss: 2.760 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5530390
	speed: 0.1562s/iter; left time: 2053.5257s
Epoch: 15 cost time: 5.353301048278809
Epoch: 15, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.307 Vali Acc: 0.221 Test Loss: 2.307 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4878117
	speed: 0.1433s/iter; left time: 1861.8794s
Epoch: 16 cost time: 5.242430686950684
Epoch: 16, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.390 Vali Acc: 0.359 Test Loss: 2.390 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.9980921
	speed: 0.1438s/iter; left time: 1845.6765s
Epoch: 17 cost time: 5.253857851028442
Epoch: 17, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.202 Vali Acc: 0.395 Test Loss: 2.202 Test Acc: 0.395
Validation loss decreased (-0.382782 --> -0.394544).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.9382085
	speed: 0.1414s/iter; left time: 1793.8009s
Epoch: 18 cost time: 4.716115236282349
Epoch: 18, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.671 Vali Acc: 0.141 Test Loss: 2.671 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1355101
	speed: 0.1543s/iter; left time: 1933.5063s
Epoch: 19 cost time: 5.708584785461426
Epoch: 19, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.489 Vali Acc: 0.375 Test Loss: 2.489 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1459171
	speed: 0.1395s/iter; left time: 1726.5309s
Epoch: 20 cost time: 4.941483020782471
Epoch: 20, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.549 Vali Acc: 0.235 Test Loss: 2.549 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.2595139
	speed: 0.1389s/iter; left time: 1697.0705s
Epoch: 21 cost time: 5.086756944656372
Epoch: 21, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.621 Vali Acc: 0.155 Test Loss: 2.621 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.2205874
	speed: 0.1477s/iter; left time: 1782.0385s
Epoch: 22 cost time: 4.831892967224121
Epoch: 22, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.674 Vali Acc: 0.148 Test Loss: 2.674 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1352479
	speed: 0.1456s/iter; left time: 1734.2898s
Epoch: 23 cost time: 5.105821371078491
Epoch: 23, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.819 Vali Acc: 0.087 Test Loss: 2.819 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.8788489
	speed: 0.1380s/iter; left time: 1622.7116s
Epoch: 24 cost time: 4.74804162979126
Epoch: 24, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.001 Vali Acc: 0.220 Test Loss: 3.001 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.3635312
	speed: 0.1414s/iter; left time: 1641.0609s
Epoch: 25 cost time: 4.939205646514893
Epoch: 25, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.144 Vali Acc: 0.149 Test Loss: 3.144 Test Acc: 0.149
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.2830828
	speed: 0.1373s/iter; left time: 1572.7296s
Epoch: 26 cost time: 5.1206769943237305
Epoch: 26, Steps: 154 | Train Loss: 1.207 Vali Loss: 2.728 Vali Acc: 0.163 Test Loss: 2.728 Test Acc: 0.163
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.5992322
	speed: 0.1357s/iter; left time: 1533.4572s
Epoch: 27 cost time: 5.090794563293457
Epoch: 27, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.765 Vali Acc: 0.153 Test Loss: 2.765 Test Acc: 0.153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39456609894566097
model parameter : 1233190
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2010515
	speed: 0.0479s/iter; left time: 732.5341s
Epoch: 1 cost time: 6.303177833557129
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.235 Vali Acc: 0.316 Test Loss: 2.235 Test Acc: 0.316
Validation loss decreased (inf --> -0.316279).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3828182
	speed: 0.1520s/iter; left time: 2301.9302s
Epoch: 2 cost time: 5.8087944984436035
Epoch: 2, Steps: 154 | Train Loss: 2.186 Vali Loss: 2.333 Vali Acc: 0.320 Test Loss: 2.333 Test Acc: 0.320
Validation loss decreased (-0.316279 --> -0.319928).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0867832
	speed: 0.1476s/iter; left time: 2213.0115s
Epoch: 3 cost time: 5.238356828689575
Epoch: 3, Steps: 154 | Train Loss: 2.167 Vali Loss: 2.191 Vali Acc: 0.328 Test Loss: 2.191 Test Acc: 0.328
Validation loss decreased (-0.319928 --> -0.327634).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7456429
	speed: 0.1415s/iter; left time: 2099.4784s
Epoch: 4 cost time: 5.238584518432617
Epoch: 4, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.118 Vali Acc: 0.345 Test Loss: 2.118 Test Acc: 0.345
Validation loss decreased (-0.327634 --> -0.345072).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4093250
	speed: 0.1490s/iter; left time: 2187.7385s
Epoch: 5 cost time: 5.7349982261657715
Epoch: 5, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.120 Vali Acc: 0.366 Test Loss: 2.120 Test Acc: 0.366
Validation loss decreased (-0.345072 --> -0.365753).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5885612
	speed: 0.1525s/iter; left time: 2215.2652s
Epoch: 6 cost time: 5.7748703956604
Epoch: 6, Steps: 154 | Train Loss: 1.777 Vali Loss: 2.596 Vali Acc: 0.269 Test Loss: 2.596 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1416050
	speed: 0.1530s/iter; left time: 2199.6686s
Epoch: 7 cost time: 4.679560899734497
Epoch: 7, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.723 Vali Acc: 0.209 Test Loss: 2.723 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3639510
	speed: 0.1362s/iter; left time: 1937.5734s
Epoch: 8 cost time: 4.413254499435425
Epoch: 8, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.929 Vali Acc: 0.113 Test Loss: 2.929 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7256589
	speed: 0.1124s/iter; left time: 1581.6906s
Epoch: 9 cost time: 4.688742399215698
Epoch: 9, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.741 Vali Acc: 0.249 Test Loss: 2.741 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6257178
	speed: 0.1265s/iter; left time: 1760.0287s
Epoch: 10 cost time: 4.73215651512146
Epoch: 10, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.153 Vali Acc: 0.380 Test Loss: 3.153 Test Acc: 0.380
Validation loss decreased (-0.365753 --> -0.379936).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0870059
	speed: 0.1368s/iter; left time: 1882.6392s
Epoch: 11 cost time: 5.399342060089111
Epoch: 11, Steps: 154 | Train Loss: 1.511 Vali Loss: 3.073 Vali Acc: 0.360 Test Loss: 3.073 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1735718
	speed: 0.1469s/iter; left time: 1998.5961s
Epoch: 12 cost time: 5.304509162902832
Epoch: 12, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.461 Vali Acc: 0.377 Test Loss: 2.461 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5334547
	speed: 0.1510s/iter; left time: 2030.9438s
Epoch: 13 cost time: 4.86833643913269
Epoch: 13, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.714 Vali Acc: 0.226 Test Loss: 2.714 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5213765
	speed: 0.1306s/iter; left time: 1736.8919s
Epoch: 14 cost time: 4.646076679229736
Epoch: 14, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.891 Vali Acc: 0.206 Test Loss: 2.891 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9758363
	speed: 0.1284s/iter; left time: 1687.8781s
Epoch: 15 cost time: 4.639675617218018
Epoch: 15, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.921 Vali Acc: 0.147 Test Loss: 2.921 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2058290
	speed: 0.1385s/iter; left time: 1799.2460s
Epoch: 16 cost time: 4.87106990814209
Epoch: 16, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.907 Vali Acc: 0.204 Test Loss: 2.907 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.9491165
	speed: 0.1287s/iter; left time: 1652.1503s
Epoch: 17 cost time: 4.8163228034973145
Epoch: 17, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.560 Vali Acc: 0.338 Test Loss: 2.560 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.6161522
	speed: 0.1475s/iter; left time: 1870.3606s
Epoch: 18 cost time: 5.5937628746032715
Epoch: 18, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.624 Vali Acc: 0.193 Test Loss: 2.624 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.0274820
	speed: 0.1439s/iter; left time: 1802.7505s
Epoch: 19 cost time: 4.810987234115601
Epoch: 19, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.669 Vali Acc: 0.399 Test Loss: 2.669 Test Acc: 0.399
Validation loss decreased (-0.379936 --> -0.399406).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.0270538
	speed: 0.1483s/iter; left time: 1835.5924s
Epoch: 20 cost time: 5.085968971252441
Epoch: 20, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.612 Vali Acc: 0.270 Test Loss: 2.612 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0335628
	speed: 0.1379s/iter; left time: 1684.9657s
Epoch: 21 cost time: 5.763282299041748
Epoch: 21, Steps: 154 | Train Loss: 1.283 Vali Loss: 2.807 Vali Acc: 0.179 Test Loss: 2.807 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4784538
	speed: 0.1494s/iter; left time: 1802.3970s
Epoch: 22 cost time: 5.1427929401397705
Epoch: 22, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.585 Vali Acc: 0.086 Test Loss: 3.585 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8480369
	speed: 0.1311s/iter; left time: 1562.3678s
Epoch: 23 cost time: 4.866443395614624
Epoch: 23, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.722 Vali Acc: 0.168 Test Loss: 2.722 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.3298932
	speed: 0.1361s/iter; left time: 1600.5186s
Epoch: 24 cost time: 4.857775688171387
Epoch: 24, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.522 Vali Acc: 0.337 Test Loss: 2.522 Test Acc: 0.337
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1970354
	speed: 0.1316s/iter; left time: 1527.6874s
Epoch: 25 cost time: 5.458787202835083
Epoch: 25, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.876 Vali Acc: 0.178 Test Loss: 2.876 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.0772557
	speed: 0.1500s/iter; left time: 1717.4812s
Epoch: 26 cost time: 5.2881269454956055
Epoch: 26, Steps: 154 | Train Loss: 1.234 Vali Loss: 2.945 Vali Acc: 0.201 Test Loss: 2.945 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.4107900
	speed: 0.1343s/iter; left time: 1517.6995s
Epoch: 27 cost time: 4.638943433761597
Epoch: 27, Steps: 154 | Train Loss: 1.199 Vali Loss: 2.859 Vali Acc: 0.084 Test Loss: 2.859 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.2810899
	speed: 0.1430s/iter; left time: 1593.6848s
Epoch: 28 cost time: 5.445070266723633
Epoch: 28, Steps: 154 | Train Loss: 1.176 Vali Loss: 3.212 Vali Acc: 0.087 Test Loss: 3.212 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.6766275
	speed: 0.1555s/iter; left time: 1708.3061s
Epoch: 29 cost time: 6.146147012710571
Epoch: 29, Steps: 154 | Train Loss: 1.179 Vali Loss: 2.771 Vali Acc: 0.135 Test Loss: 2.771 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 1232806
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5838404
	speed: 0.0504s/iter; left time: 770.4215s
Epoch: 1 cost time: 6.8295793533325195
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.221 Vali Acc: 0.315 Test Loss: 2.221 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4027998
	speed: 0.1559s/iter; left time: 2361.5992s
Epoch: 2 cost time: 5.777807235717773
Epoch: 2, Steps: 154 | Train Loss: 2.163 Vali Loss: 2.222 Vali Acc: 0.316 Test Loss: 2.222 Test Acc: 0.316
Validation loss decreased (-0.315468 --> -0.316279).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5545195
	speed: 0.1582s/iter; left time: 2371.8829s
Epoch: 3 cost time: 5.706268072128296
Epoch: 3, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.268 Vali Acc: 0.087 Test Loss: 2.268 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1300516
	speed: 0.1470s/iter; left time: 2181.5416s
Epoch: 4 cost time: 5.233222007751465
Epoch: 4, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.205 Vali Acc: 0.330 Test Loss: 2.205 Test Acc: 0.330
Validation loss decreased (-0.316279 --> -0.330067).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4282497
	speed: 0.1523s/iter; left time: 2236.9914s
Epoch: 5 cost time: 5.79219126701355
Epoch: 5, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.325 Vali Acc: 0.350 Test Loss: 2.325 Test Acc: 0.350
Validation loss decreased (-0.330067 --> -0.350342).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8585365
	speed: 0.1539s/iter; left time: 2236.0528s
Epoch: 6 cost time: 5.406695365905762
Epoch: 6, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.168 Vali Acc: 0.363 Test Loss: 2.168 Test Acc: 0.363
Validation loss decreased (-0.350342 --> -0.362509).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0085034
	speed: 0.1412s/iter; left time: 2029.7307s
Epoch: 7 cost time: 4.597403049468994
Epoch: 7, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.518 Vali Acc: 0.199 Test Loss: 2.518 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1531948
	speed: 0.1355s/iter; left time: 1927.1715s
Epoch: 8 cost time: 4.690075635910034
Epoch: 8, Steps: 154 | Train Loss: 1.647 Vali Loss: 3.181 Vali Acc: 0.124 Test Loss: 3.181 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5642843
	speed: 0.1338s/iter; left time: 1881.8511s
Epoch: 9 cost time: 4.910459756851196
Epoch: 9, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.799 Vali Acc: 0.132 Test Loss: 2.799 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8470286
	speed: 0.1404s/iter; left time: 1953.4710s
Epoch: 10 cost time: 5.5589494705200195
Epoch: 10, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.631 Vali Acc: 0.363 Test Loss: 2.631 Test Acc: 0.363
Validation loss decreased (-0.362509 --> -0.362910).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2742625
	speed: 0.1499s/iter; left time: 2063.3711s
Epoch: 11 cost time: 5.0199360847473145
Epoch: 11, Steps: 154 | Train Loss: 1.538 Vali Loss: 3.008 Vali Acc: 0.203 Test Loss: 3.008 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1373992
	speed: 0.1453s/iter; left time: 1977.6268s
Epoch: 12 cost time: 4.968230724334717
Epoch: 12, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.986 Vali Acc: 0.131 Test Loss: 2.986 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6152126
	speed: 0.1346s/iter; left time: 1810.5708s
Epoch: 13 cost time: 5.0946197509765625
Epoch: 13, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.268 Vali Acc: 0.188 Test Loss: 3.268 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0711136
	speed: 0.1447s/iter; left time: 1925.0301s
Epoch: 14 cost time: 4.995006561279297
Epoch: 14, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.089 Vali Acc: 0.124 Test Loss: 3.089 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.8370413
	speed: 0.1433s/iter; left time: 1883.2976s
Epoch: 15 cost time: 4.824427366256714
Epoch: 15, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.895 Vali Acc: 0.204 Test Loss: 2.895 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6520613
	speed: 0.1361s/iter; left time: 1768.1022s
Epoch: 16 cost time: 4.989700555801392
Epoch: 16, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.532 Vali Acc: 0.220 Test Loss: 2.532 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2546026
	speed: 0.1357s/iter; left time: 1741.7243s
Epoch: 17 cost time: 4.845542907714844
Epoch: 17, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.675 Vali Acc: 0.137 Test Loss: 2.675 Test Acc: 0.137
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.6170539
	speed: 0.1500s/iter; left time: 1901.9722s
Epoch: 18 cost time: 5.126291275024414
Epoch: 18, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.971 Vali Acc: 0.137 Test Loss: 2.971 Test Acc: 0.137
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1439762
	speed: 0.1555s/iter; left time: 1948.1220s
Epoch: 19 cost time: 5.678508758544922
Epoch: 19, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.011 Vali Acc: 0.088 Test Loss: 3.011 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1524661
	speed: 0.1514s/iter; left time: 1872.9636s
Epoch: 20 cost time: 5.64733624458313
Epoch: 20, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.745 Vali Acc: 0.198 Test Loss: 2.745 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3629359286293593
model parameter : 1232422
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3651769
	speed: 0.0546s/iter; left time: 836.1374s
Epoch: 1 cost time: 6.958605051040649
Epoch: 1, Steps: 154 | Train Loss: 2.247 Vali Loss: 2.174 Vali Acc: 0.318 Test Loss: 2.174 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2594230
	speed: 0.1413s/iter; left time: 2139.9392s
Epoch: 2 cost time: 5.3134989738464355
Epoch: 2, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.306 Vali Acc: 0.160 Test Loss: 2.306 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1463511
	speed: 0.1522s/iter; left time: 2281.8153s
Epoch: 3 cost time: 5.822998285293579
Epoch: 3, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.275 Vali Acc: 0.210 Test Loss: 2.275 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6380199
	speed: 0.1507s/iter; left time: 2235.8098s
Epoch: 4 cost time: 5.3357203006744385
Epoch: 4, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.276 Vali Acc: 0.182 Test Loss: 2.276 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.8667576
	speed: 0.1547s/iter; left time: 2272.1070s
Epoch: 5 cost time: 5.353354454040527
Epoch: 5, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.721 Vali Acc: 0.096 Test Loss: 2.721 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4411099
	speed: 0.1459s/iter; left time: 2119.4101s
Epoch: 6 cost time: 4.929683685302734
Epoch: 6, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.706 Vali Acc: 0.359 Test Loss: 2.706 Test Acc: 0.359
Validation loss decreased (-0.317497 --> -0.358854).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1525097
	speed: 0.1336s/iter; left time: 1921.1689s
Epoch: 7 cost time: 5.125365257263184
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 3.224 Vali Acc: 0.059 Test Loss: 3.224 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2656901
	speed: 0.1432s/iter; left time: 2036.8475s
Epoch: 8 cost time: 5.274938344955444
Epoch: 8, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.964 Vali Acc: 0.200 Test Loss: 2.964 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7967072
	speed: 0.1337s/iter; left time: 1881.2445s
Epoch: 9 cost time: 4.957324028015137
Epoch: 9, Steps: 154 | Train Loss: 1.628 Vali Loss: 3.040 Vali Acc: 0.200 Test Loss: 3.040 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0571572
	speed: 0.1430s/iter; left time: 1990.5246s
Epoch: 10 cost time: 4.905419588088989
Epoch: 10, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.154 Vali Acc: 0.140 Test Loss: 3.154 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6735373
	speed: 0.1387s/iter; left time: 1909.1872s
Epoch: 11 cost time: 5.51786732673645
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.006 Vali Acc: 0.126 Test Loss: 3.006 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0749524
	speed: 0.1470s/iter; left time: 2000.5822s
Epoch: 12 cost time: 5.061794996261597
Epoch: 12, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.745 Vali Acc: 0.354 Test Loss: 2.745 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1520556
	speed: 0.1430s/iter; left time: 1923.1609s
Epoch: 13 cost time: 5.1902852058410645
Epoch: 13, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.917 Vali Acc: 0.205 Test Loss: 2.917 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3060086
	speed: 0.1328s/iter; left time: 1766.5352s
Epoch: 14 cost time: 4.864419460296631
Epoch: 14, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.952 Vali Acc: 0.365 Test Loss: 2.952 Test Acc: 0.365
Validation loss decreased (-0.358854 --> -0.364934).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4548867
	speed: 0.1439s/iter; left time: 1891.3402s
Epoch: 15 cost time: 5.17230486869812
Epoch: 15, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.564 Vali Acc: 0.252 Test Loss: 2.564 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2137605
	speed: 0.1527s/iter; left time: 1983.4655s
Epoch: 16 cost time: 5.611475944519043
Epoch: 16, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.587 Vali Acc: 0.222 Test Loss: 2.587 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5662885
	speed: 0.1472s/iter; left time: 1890.1811s
Epoch: 17 cost time: 5.535928010940552
Epoch: 17, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.506 Vali Acc: 0.252 Test Loss: 2.506 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.0673292
	speed: 0.1488s/iter; left time: 1887.6912s
Epoch: 18 cost time: 5.766100883483887
Epoch: 18, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.617 Vali Acc: 0.370 Test Loss: 2.617 Test Acc: 0.370
Validation loss decreased (-0.364934 --> -0.370209).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1248701
	speed: 0.1590s/iter; left time: 1991.8527s
Epoch: 19 cost time: 5.670112133026123
Epoch: 19, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.736 Vali Acc: 0.221 Test Loss: 2.736 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4109337
	speed: 0.1609s/iter; left time: 1990.6015s
Epoch: 20 cost time: 5.381431341171265
Epoch: 20, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.970 Vali Acc: 0.083 Test Loss: 2.970 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.3115780
	speed: 0.1441s/iter; left time: 1761.4125s
Epoch: 21 cost time: 5.060910224914551
Epoch: 21, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.508 Vali Acc: 0.391 Test Loss: 2.508 Test Acc: 0.391
Validation loss decreased (-0.370209 --> -0.390891).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9539171
	speed: 0.1401s/iter; left time: 1690.4237s
Epoch: 22 cost time: 5.117250204086304
Epoch: 22, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.889 Vali Acc: 0.202 Test Loss: 2.889 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0752107
	speed: 0.1508s/iter; left time: 1796.6061s
Epoch: 23 cost time: 5.377475261688232
Epoch: 23, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.677 Vali Acc: 0.385 Test Loss: 2.677 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.3435625
	speed: 0.1447s/iter; left time: 1701.1828s
Epoch: 24 cost time: 5.185783624649048
Epoch: 24, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.648 Vali Acc: 0.285 Test Loss: 2.648 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8709918
	speed: 0.1393s/iter; left time: 1616.3962s
Epoch: 25 cost time: 5.140482187271118
Epoch: 25, Steps: 154 | Train Loss: 1.225 Vali Loss: 2.699 Vali Acc: 0.382 Test Loss: 2.699 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2892183
	speed: 0.1408s/iter; left time: 1611.7803s
Epoch: 26 cost time: 5.055160760879517
Epoch: 26, Steps: 154 | Train Loss: 1.211 Vali Loss: 3.237 Vali Acc: 0.084 Test Loss: 3.237 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1884290
	speed: 0.1415s/iter; left time: 1598.7502s
Epoch: 27 cost time: 5.056766510009766
Epoch: 27, Steps: 154 | Train Loss: 1.218 Vali Loss: 3.117 Vali Acc: 0.089 Test Loss: 3.117 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.1411860
	speed: 0.1242s/iter; left time: 1383.8527s
Epoch: 28 cost time: 4.249928951263428
Epoch: 28, Steps: 154 | Train Loss: 1.181 Vali Loss: 2.632 Vali Acc: 0.338 Test Loss: 2.632 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.5056384
	speed: 0.1072s/iter; left time: 1178.2977s
Epoch: 29 cost time: 3.949939727783203
Epoch: 29, Steps: 154 | Train Loss: 1.187 Vali Loss: 2.490 Vali Acc: 0.252 Test Loss: 2.490 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.9775720
	speed: 0.1120s/iter; left time: 1213.6648s
Epoch: 30 cost time: 4.590268135070801
Epoch: 30, Steps: 154 | Train Loss: 1.166 Vali Loss: 3.245 Vali Acc: 0.130 Test Loss: 3.245 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.4800780
	speed: 0.1346s/iter; left time: 1437.8224s
Epoch: 31 cost time: 4.866389036178589
Epoch: 31, Steps: 154 | Train Loss: 1.158 Vali Loss: 3.121 Vali Acc: 0.094 Test Loss: 3.121 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 1232038
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0305233
	speed: 0.0558s/iter; left time: 853.4272s
Epoch: 1 cost time: 7.870233535766602
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.467 Vali Acc: 0.318 Test Loss: 2.467 Test Acc: 0.318
Validation loss decreased (inf --> -0.318305).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8629432
	speed: 0.1484s/iter; left time: 2247.8116s
Epoch: 2 cost time: 5.0071492195129395
Epoch: 2, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.185 Vali Acc: 0.317 Test Loss: 2.185 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9379194
	speed: 0.1312s/iter; left time: 1967.4425s
Epoch: 3 cost time: 4.872002124786377
Epoch: 3, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.380 Vali Acc: 0.322 Test Loss: 2.380 Test Acc: 0.322
Validation loss decreased (-0.318305 --> -0.322361).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4064131
	speed: 0.1507s/iter; left time: 2236.0147s
Epoch: 4 cost time: 5.1535561084747314
Epoch: 4, Steps: 154 | Train Loss: 2.089 Vali Loss: 2.233 Vali Acc: 0.363 Test Loss: 2.233 Test Acc: 0.363
Validation loss decreased (-0.322361 --> -0.362914).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9504176
	speed: 0.1472s/iter; left time: 2161.8737s
Epoch: 5 cost time: 5.48173975944519
Epoch: 5, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.473 Vali Acc: 0.182 Test Loss: 2.473 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5854721
	speed: 0.1428s/iter; left time: 2075.0852s
Epoch: 6 cost time: 5.115278720855713
Epoch: 6, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.146 Vali Acc: 0.095 Test Loss: 3.146 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7576427
	speed: 0.1521s/iter; left time: 2186.5428s
Epoch: 7 cost time: 6.036322355270386
Epoch: 7, Steps: 154 | Train Loss: 1.734 Vali Loss: 3.309 Vali Acc: 0.200 Test Loss: 3.309 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3114319
	speed: 0.1575s/iter; left time: 2240.5447s
Epoch: 8 cost time: 6.091977119445801
Epoch: 8, Steps: 154 | Train Loss: 1.663 Vali Loss: 3.150 Vali Acc: 0.318 Test Loss: 3.150 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.9771125
	speed: 0.1553s/iter; left time: 2184.9399s
Epoch: 9 cost time: 5.609650611877441
Epoch: 9, Steps: 154 | Train Loss: 1.603 Vali Loss: 3.105 Vali Acc: 0.193 Test Loss: 3.105 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.9584733
	speed: 0.1543s/iter; left time: 2146.7289s
Epoch: 10 cost time: 5.374999046325684
Epoch: 10, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.115 Vali Acc: 0.208 Test Loss: 3.115 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3049395
	speed: 0.1502s/iter; left time: 2067.1911s
Epoch: 11 cost time: 5.628633737564087
Epoch: 11, Steps: 154 | Train Loss: 1.588 Vali Loss: 3.693 Vali Acc: 0.107 Test Loss: 3.693 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.7508314
	speed: 0.1685s/iter; left time: 2293.1084s
Epoch: 12 cost time: 5.9523608684539795
Epoch: 12, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.686 Vali Acc: 0.359 Test Loss: 2.686 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3725547
	speed: 0.1588s/iter; left time: 2136.9924s
Epoch: 13 cost time: 5.573877811431885
Epoch: 13, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.756 Vali Acc: 0.367 Test Loss: 2.756 Test Acc: 0.367
Validation loss decreased (-0.362914 --> -0.366558).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2409776
	speed: 0.1531s/iter; left time: 2036.2927s
Epoch: 14 cost time: 5.782018423080444
Epoch: 14, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.589 Vali Acc: 0.202 Test Loss: 2.589 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4517385
	speed: 0.1423s/iter; left time: 1870.0361s
Epoch: 15 cost time: 5.672407150268555
Epoch: 15, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.783 Vali Acc: 0.130 Test Loss: 2.783 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3295040
	speed: 0.1467s/iter; left time: 1906.2931s
Epoch: 16 cost time: 5.089371919631958
Epoch: 16, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.782 Vali Acc: 0.378 Test Loss: 2.782 Test Acc: 0.378
Validation loss decreased (-0.366558 --> -0.378318).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.9922438
	speed: 0.1477s/iter; left time: 1895.4152s
Epoch: 17 cost time: 5.24860405921936
Epoch: 17, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.813 Vali Acc: 0.291 Test Loss: 2.813 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0856166
	speed: 0.1404s/iter; left time: 1780.6360s
Epoch: 18 cost time: 4.98259711265564
Epoch: 18, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.860 Vali Acc: 0.138 Test Loss: 2.860 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4736198
	speed: 0.1477s/iter; left time: 1850.7523s
Epoch: 19 cost time: 5.342702388763428
Epoch: 19, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.736 Vali Acc: 0.167 Test Loss: 2.736 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7053651
	speed: 0.1588s/iter; left time: 1965.1224s
Epoch: 20 cost time: 5.257213115692139
Epoch: 20, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.789 Vali Acc: 0.096 Test Loss: 2.789 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4042745
	speed: 0.1420s/iter; left time: 1734.8584s
Epoch: 21 cost time: 5.089069128036499
Epoch: 21, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.909 Vali Acc: 0.147 Test Loss: 2.909 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0201235
	speed: 0.1335s/iter; left time: 1611.0548s
Epoch: 22 cost time: 4.951452970504761
Epoch: 22, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.834 Vali Acc: 0.107 Test Loss: 2.834 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.0546149
	speed: 0.1401s/iter; left time: 1669.0533s
Epoch: 23 cost time: 5.4525651931762695
Epoch: 23, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.872 Vali Acc: 0.159 Test Loss: 2.872 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.0461310
	speed: 0.1526s/iter; left time: 1793.9782s
Epoch: 24 cost time: 5.35233473777771
Epoch: 24, Steps: 154 | Train Loss: 1.215 Vali Loss: 2.729 Vali Acc: 0.087 Test Loss: 2.729 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.1616669
	speed: 0.1500s/iter; left time: 1740.8916s
Epoch: 25 cost time: 5.136419057846069
Epoch: 25, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.774 Vali Acc: 0.144 Test Loss: 2.774 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.2629362
	speed: 0.1417s/iter; left time: 1623.1337s
Epoch: 26 cost time: 5.418556451797485
Epoch: 26, Steps: 154 | Train Loss: 1.191 Vali Loss: 3.182 Vali Acc: 0.135 Test Loss: 3.182 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 1035814
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9931587
	speed: 0.0498s/iter; left time: 761.4612s
Epoch: 1 cost time: 6.630159854888916
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.221 Vali Acc: 0.130 Test Loss: 2.221 Test Acc: 0.130
Validation loss decreased (inf --> -0.129743).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3157828
	speed: 0.1438s/iter; left time: 2178.7918s
Epoch: 2 cost time: 5.232499599456787
Epoch: 2, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.266 Vali Acc: 0.322 Test Loss: 2.266 Test Acc: 0.322
Validation loss decreased (-0.129743 --> -0.321956).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2310624
	speed: 0.1552s/iter; left time: 2326.5715s
Epoch: 3 cost time: 5.693551063537598
Epoch: 3, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.285 Vali Acc: 0.328 Test Loss: 2.285 Test Acc: 0.328
Validation loss decreased (-0.321956 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0516117
	speed: 0.1460s/iter; left time: 2167.1706s
Epoch: 4 cost time: 4.955303192138672
Epoch: 4, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.279 Vali Acc: 0.326 Test Loss: 2.279 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3792990
	speed: 0.1401s/iter; left time: 2057.6807s
Epoch: 5 cost time: 4.830973148345947
Epoch: 5, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.402 Vali Acc: 0.181 Test Loss: 2.402 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0123954
	speed: 0.1475s/iter; left time: 2143.1672s
Epoch: 6 cost time: 5.889490604400635
Epoch: 6, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.665 Vali Acc: 0.368 Test Loss: 2.665 Test Acc: 0.368
Validation loss decreased (-0.328039 --> -0.367775).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9354942
	speed: 0.1478s/iter; left time: 2124.3094s
Epoch: 7 cost time: 5.272157669067383
Epoch: 7, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.956 Vali Acc: 0.198 Test Loss: 2.956 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5370235
	speed: 0.1399s/iter; left time: 1990.3349s
Epoch: 8 cost time: 4.612081289291382
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 3.263 Vali Acc: 0.126 Test Loss: 3.263 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7978076
	speed: 0.1320s/iter; left time: 1856.6954s
Epoch: 9 cost time: 4.666720628738403
Epoch: 9, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.703 Vali Acc: 0.202 Test Loss: 2.703 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4660486
	speed: 0.1417s/iter; left time: 1971.8402s
Epoch: 10 cost time: 5.580784320831299
Epoch: 10, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.783 Vali Acc: 0.363 Test Loss: 2.783 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8800852
	speed: 0.1482s/iter; left time: 2039.6830s
Epoch: 11 cost time: 5.302867889404297
Epoch: 11, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.929 Vali Acc: 0.090 Test Loss: 2.929 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1663820
	speed: 0.1412s/iter; left time: 1921.7111s
Epoch: 12 cost time: 4.945401191711426
Epoch: 12, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.032 Vali Acc: 0.152 Test Loss: 3.032 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6050910
	speed: 0.1426s/iter; left time: 1918.6186s
Epoch: 13 cost time: 5.2853474617004395
Epoch: 13, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.668 Vali Acc: 0.249 Test Loss: 2.668 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.9608793
	speed: 0.1458s/iter; left time: 1939.0135s
Epoch: 14 cost time: 5.847499370574951
Epoch: 14, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.859 Vali Acc: 0.201 Test Loss: 2.859 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1015311
	speed: 0.1400s/iter; left time: 1840.8006s
Epoch: 15 cost time: 4.645736932754517
Epoch: 15, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.481 Vali Acc: 0.077 Test Loss: 3.481 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.7544280
	speed: 0.1317s/iter; left time: 1711.1107s
Epoch: 16 cost time: 4.853001117706299
Epoch: 16, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.673 Vali Acc: 0.371 Test Loss: 2.673 Test Acc: 0.371
Validation loss decreased (-0.367775 --> -0.371020).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4833541
	speed: 0.1340s/iter; left time: 1719.8680s
Epoch: 17 cost time: 4.933288097381592
Epoch: 17, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.709 Vali Acc: 0.140 Test Loss: 2.709 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4166316
	speed: 0.1392s/iter; left time: 1765.9325s
Epoch: 18 cost time: 5.186444282531738
Epoch: 18, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.793 Vali Acc: 0.198 Test Loss: 2.793 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4281244
	speed: 0.1375s/iter; left time: 1722.7863s
Epoch: 19 cost time: 4.959590911865234
Epoch: 19, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.762 Vali Acc: 0.165 Test Loss: 3.762 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2875712
	speed: 0.1366s/iter; left time: 1690.4550s
Epoch: 20 cost time: 4.983326435089111
Epoch: 20, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.912 Vali Acc: 0.091 Test Loss: 2.912 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.5273148
	speed: 0.1394s/iter; left time: 1704.0557s
Epoch: 21 cost time: 5.469877004623413
Epoch: 21, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.837 Vali Acc: 0.150 Test Loss: 2.837 Test Acc: 0.150
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.9326299
	speed: 0.1491s/iter; left time: 1798.6683s
Epoch: 22 cost time: 5.4789018630981445
Epoch: 22, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.306 Vali Acc: 0.221 Test Loss: 2.306 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.9838819
	speed: 0.1453s/iter; left time: 1731.4634s
Epoch: 23 cost time: 5.371107339859009
Epoch: 23, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.545 Vali Acc: 0.383 Test Loss: 2.545 Test Acc: 0.383
Validation loss decreased (-0.371020 --> -0.383186).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8119620
	speed: 0.1515s/iter; left time: 1781.3163s
Epoch: 24 cost time: 5.303740739822388
Epoch: 24, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.755 Vali Acc: 0.369 Test Loss: 2.755 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.2193495
	speed: 0.1497s/iter; left time: 1737.6520s
Epoch: 25 cost time: 5.618293046951294
Epoch: 25, Steps: 154 | Train Loss: 1.220 Vali Loss: 3.297 Vali Acc: 0.090 Test Loss: 3.297 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0418425
	speed: 0.1554s/iter; left time: 1779.9643s
Epoch: 26 cost time: 5.416308164596558
Epoch: 26, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.986 Vali Acc: 0.206 Test Loss: 2.986 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1531725
	speed: 0.1405s/iter; left time: 1587.0132s
Epoch: 27 cost time: 5.098710298538208
Epoch: 27, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.655 Vali Acc: 0.189 Test Loss: 2.655 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.4462948
	speed: 0.1468s/iter; left time: 1635.3968s
Epoch: 28 cost time: 5.197057723999023
Epoch: 28, Steps: 154 | Train Loss: 1.200 Vali Loss: 2.731 Vali Acc: 0.343 Test Loss: 2.731 Test Acc: 0.343
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.4236355
	speed: 0.1482s/iter; left time: 1628.3061s
Epoch: 29 cost time: 5.464700937271118
Epoch: 29, Steps: 154 | Train Loss: 1.148 Vali Loss: 2.718 Vali Acc: 0.145 Test Loss: 2.718 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.2662854
	speed: 0.1341s/iter; left time: 1452.8292s
Epoch: 30 cost time: 4.878182888031006
Epoch: 30, Steps: 154 | Train Loss: 1.150 Vali Loss: 2.835 Vali Acc: 0.167 Test Loss: 2.835 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0506977
	speed: 0.1393s/iter; left time: 1488.1784s
Epoch: 31 cost time: 4.99535346031189
Epoch: 31, Steps: 154 | Train Loss: 1.134 Vali Loss: 2.548 Vali Acc: 0.242 Test Loss: 2.548 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.4310966
	speed: 0.1473s/iter; left time: 1550.4786s
Epoch: 32 cost time: 5.611994504928589
Epoch: 32, Steps: 154 | Train Loss: 1.117 Vali Loss: 2.872 Vali Acc: 0.092 Test Loss: 2.872 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1632618
	speed: 0.1519s/iter; left time: 1576.0616s
Epoch: 33 cost time: 5.523183345794678
Epoch: 33, Steps: 154 | Train Loss: 1.105 Vali Loss: 3.488 Vali Acc: 0.092 Test Loss: 3.488 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 1035430
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9387730
	speed: 0.0481s/iter; left time: 735.4170s
Epoch: 1 cost time: 6.447048664093018
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.287 Vali Acc: 0.315 Test Loss: 2.287 Test Acc: 0.315
Validation loss decreased (inf --> -0.315062).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0702379
	speed: 0.1398s/iter; left time: 2117.0340s
Epoch: 2 cost time: 4.9970598220825195
Epoch: 2, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.260 Vali Acc: 0.163 Test Loss: 2.260 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2130029
	speed: 0.1390s/iter; left time: 2084.3831s
Epoch: 3 cost time: 5.274560213088989
Epoch: 3, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.274 Vali Acc: 0.166 Test Loss: 2.274 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.9102540
	speed: 0.1305s/iter; left time: 1935.7937s
Epoch: 4 cost time: 4.87926983833313
Epoch: 4, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.170 Vali Acc: 0.339 Test Loss: 2.170 Test Acc: 0.339
Validation loss decreased (-0.315062 --> -0.338989).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3299456
	speed: 0.1193s/iter; left time: 1751.6256s
Epoch: 5 cost time: 4.191966772079468
Epoch: 5, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.276 Vali Acc: 0.197 Test Loss: 2.276 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1382697
	speed: 0.1303s/iter; left time: 1893.8590s
Epoch: 6 cost time: 4.65049934387207
Epoch: 6, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.610 Vali Acc: 0.192 Test Loss: 2.610 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7960531
	speed: 0.1429s/iter; left time: 2054.6428s
Epoch: 7 cost time: 5.222157001495361
Epoch: 7, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.250 Vali Acc: 0.371 Test Loss: 2.250 Test Acc: 0.371
Validation loss decreased (-0.338989 --> -0.370618).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2009078
	speed: 0.1475s/iter; left time: 2098.0614s
Epoch: 8 cost time: 5.850651502609253
Epoch: 8, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.704 Vali Acc: 0.258 Test Loss: 2.704 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2735353
	speed: 0.1477s/iter; left time: 2078.5041s
Epoch: 9 cost time: 5.54218053817749
Epoch: 9, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.302 Vali Acc: 0.367 Test Loss: 2.302 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6559556
	speed: 0.1436s/iter; left time: 1998.3517s
Epoch: 10 cost time: 5.156220197677612
Epoch: 10, Steps: 154 | Train Loss: 1.599 Vali Loss: 3.626 Vali Acc: 0.200 Test Loss: 3.626 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1358027
	speed: 0.1444s/iter; left time: 1987.1538s
Epoch: 11 cost time: 5.231434106826782
Epoch: 11, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.118 Vali Acc: 0.199 Test Loss: 3.118 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6597874
	speed: 0.1512s/iter; left time: 2056.9559s
Epoch: 12 cost time: 5.213592052459717
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.624 Vali Acc: 0.161 Test Loss: 2.624 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 2.0784795
	speed: 0.1459s/iter; left time: 1962.9491s
Epoch: 13 cost time: 5.302337884902954
Epoch: 13, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.228 Vali Acc: 0.206 Test Loss: 3.228 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.6543170
	speed: 0.1493s/iter; left time: 1985.0104s
Epoch: 14 cost time: 5.799607515335083
Epoch: 14, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.109 Vali Acc: 0.109 Test Loss: 3.109 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.3854065
	speed: 0.1500s/iter; left time: 1971.4129s
Epoch: 15 cost time: 5.237789869308472
Epoch: 15, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.787 Vali Acc: 0.251 Test Loss: 2.787 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4127824
	speed: 0.1443s/iter; left time: 1874.6717s
Epoch: 16 cost time: 5.029653072357178
Epoch: 16, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.647 Vali Acc: 0.098 Test Loss: 3.647 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.6698940
	speed: 0.1468s/iter; left time: 1884.2840s
Epoch: 17 cost time: 5.211756706237793
Epoch: 17, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.106 Vali Acc: 0.176 Test Loss: 3.106 Test Acc: 0.176
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 1035046
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9579159
	speed: 0.0503s/iter; left time: 770.1868s
Epoch: 1 cost time: 7.254259824752808
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.260 Vali Acc: 0.315 Test Loss: 2.260 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1045694
	speed: 0.1572s/iter; left time: 2381.7493s
Epoch: 2 cost time: 6.061159372329712
Epoch: 2, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.293 Vali Acc: 0.317 Test Loss: 2.293 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316684).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8497925
	speed: 0.1479s/iter; left time: 2218.0319s
Epoch: 3 cost time: 5.506903648376465
Epoch: 3, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.137 Vali Acc: 0.324 Test Loss: 2.137 Test Acc: 0.324
Validation loss decreased (-0.316684 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3242247
	speed: 0.1346s/iter; left time: 1997.3828s
Epoch: 4 cost time: 4.569109916687012
Epoch: 4, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.429 Vali Acc: 0.177 Test Loss: 2.429 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8254299
	speed: 0.1338s/iter; left time: 1965.3006s
Epoch: 5 cost time: 5.414410591125488
Epoch: 5, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.501 Vali Acc: 0.188 Test Loss: 2.501 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4593323
	speed: 0.1460s/iter; left time: 2120.9938s
Epoch: 6 cost time: 5.188573598861694
Epoch: 6, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.401 Vali Acc: 0.356 Test Loss: 2.401 Test Acc: 0.356
Validation loss decreased (-0.324391 --> -0.356424).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3177254
	speed: 0.1389s/iter; left time: 1996.3278s
Epoch: 7 cost time: 5.1237242221832275
Epoch: 7, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.598 Vali Acc: 0.127 Test Loss: 2.598 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3024468
	speed: 0.1369s/iter; left time: 1946.7459s
Epoch: 8 cost time: 5.200829744338989
Epoch: 8, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.519 Vali Acc: 0.372 Test Loss: 2.519 Test Acc: 0.372
Validation loss decreased (-0.356424 --> -0.372238).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3914059
	speed: 0.1428s/iter; left time: 2008.3852s
Epoch: 9 cost time: 5.539596319198608
Epoch: 9, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.257 Vali Acc: 0.074 Test Loss: 3.257 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2144308
	speed: 0.1535s/iter; left time: 2136.3048s
Epoch: 10 cost time: 5.227787256240845
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.755 Vali Acc: 0.373 Test Loss: 2.755 Test Acc: 0.373
Validation loss decreased (-0.372238 --> -0.373046).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4313709
	speed: 0.1583s/iter; left time: 2177.8318s
Epoch: 11 cost time: 5.855100154876709
Epoch: 11, Steps: 154 | Train Loss: 1.576 Vali Loss: 3.269 Vali Acc: 0.196 Test Loss: 3.269 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2837595
	speed: 0.1604s/iter; left time: 2181.9619s
Epoch: 12 cost time: 5.713712692260742
Epoch: 12, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.401 Vali Acc: 0.108 Test Loss: 3.401 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2293224
	speed: 0.1681s/iter; left time: 2261.7829s
Epoch: 13 cost time: 5.984191656112671
Epoch: 13, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.045 Vali Acc: 0.067 Test Loss: 3.045 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1518954
	speed: 0.1521s/iter; left time: 2023.4099s
Epoch: 14 cost time: 5.329695701599121
Epoch: 14, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.489 Vali Acc: 0.105 Test Loss: 2.489 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5412160
	speed: 0.1616s/iter; left time: 2123.6820s
Epoch: 15 cost time: 5.988685846328735
Epoch: 15, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.735 Vali Acc: 0.131 Test Loss: 2.735 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2271353
	speed: 0.1695s/iter; left time: 2201.5589s
Epoch: 16 cost time: 5.751671314239502
Epoch: 16, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.466 Vali Acc: 0.371 Test Loss: 2.466 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3946526
	speed: 0.1655s/iter; left time: 2124.4365s
Epoch: 17 cost time: 5.943035364151001
Epoch: 17, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.317 Vali Acc: 0.379 Test Loss: 2.317 Test Acc: 0.379
Validation loss decreased (-0.373046 --> -0.378728).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6885182
	speed: 0.1487s/iter; left time: 1885.9207s
Epoch: 18 cost time: 5.8763322830200195
Epoch: 18, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.865 Vali Acc: 0.092 Test Loss: 2.865 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8412282
	speed: 0.1512s/iter; left time: 1894.8567s
Epoch: 19 cost time: 5.173336744308472
Epoch: 19, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.564 Vali Acc: 0.209 Test Loss: 2.564 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4189146
	speed: 0.1601s/iter; left time: 1981.1926s
Epoch: 20 cost time: 5.599397659301758
Epoch: 20, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.456 Vali Acc: 0.162 Test Loss: 2.456 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.2159272
	speed: 0.1346s/iter; left time: 1644.8857s
Epoch: 21 cost time: 4.747210502624512
Epoch: 21, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.344 Vali Acc: 0.398 Test Loss: 2.344 Test Acc: 0.398
Validation loss decreased (-0.378728 --> -0.397787).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.3944942
	speed: 0.1419s/iter; left time: 1712.2765s
Epoch: 22 cost time: 4.9213337898254395
Epoch: 22, Steps: 154 | Train Loss: 1.275 Vali Loss: 3.012 Vali Acc: 0.174 Test Loss: 3.012 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6289830
	speed: 0.1561s/iter; left time: 1859.7344s
Epoch: 23 cost time: 6.402211904525757
Epoch: 23, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.673 Vali Acc: 0.167 Test Loss: 2.673 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1935630
	speed: 0.1518s/iter; left time: 1784.9768s
Epoch: 24 cost time: 5.258002519607544
Epoch: 24, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.941 Vali Acc: 0.085 Test Loss: 2.941 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.0739971
	speed: 0.1426s/iter; left time: 1654.9384s
Epoch: 25 cost time: 4.839786767959595
Epoch: 25, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.623 Vali Acc: 0.102 Test Loss: 2.623 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.5841779
	speed: 0.1403s/iter; left time: 1606.3731s
Epoch: 26 cost time: 4.933332920074463
Epoch: 26, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.859 Vali Acc: 0.112 Test Loss: 2.859 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.0482476
	speed: 0.1418s/iter; left time: 1601.6451s
Epoch: 27 cost time: 5.297016859054565
Epoch: 27, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.835 Vali Acc: 0.132 Test Loss: 2.835 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.0028054
	speed: 0.1575s/iter; left time: 1755.0297s
Epoch: 28 cost time: 4.946877479553223
Epoch: 28, Steps: 154 | Train Loss: 1.209 Vali Loss: 2.601 Vali Acc: 0.367 Test Loss: 2.601 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.2304723
	speed: 0.1437s/iter; left time: 1579.2831s
Epoch: 29 cost time: 4.703115701675415
Epoch: 29, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.598 Vali Acc: 0.138 Test Loss: 2.598 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.5878921
	speed: 0.1377s/iter; left time: 1491.7683s
Epoch: 30 cost time: 4.980016231536865
Epoch: 30, Steps: 154 | Train Loss: 1.172 Vali Loss: 2.986 Vali Acc: 0.146 Test Loss: 2.986 Test Acc: 0.146
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.1186950
	speed: 0.1606s/iter; left time: 1714.9906s
Epoch: 31 cost time: 6.58024001121521
Epoch: 31, Steps: 154 | Train Loss: 1.178 Vali Loss: 2.603 Vali Acc: 0.123 Test Loss: 2.603 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 1034662
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8633696
	speed: 0.0501s/iter; left time: 766.5063s
Epoch: 1 cost time: 6.804894924163818
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.205 Vali Acc: 0.155 Test Loss: 2.205 Test Acc: 0.155
Validation loss decreased (inf --> -0.155290).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0633624
	speed: 0.1416s/iter; left time: 2144.2981s
Epoch: 2 cost time: 5.1323888301849365
Epoch: 2, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.304 Vali Acc: 0.316 Test Loss: 2.304 Test Acc: 0.316
Validation loss decreased (-0.155290 --> -0.315873).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1933000
	speed: 0.1643s/iter; left time: 2463.8614s
Epoch: 3 cost time: 5.707263469696045
Epoch: 3, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.205 Vali Acc: 0.167 Test Loss: 2.205 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0598083
	speed: 0.1644s/iter; left time: 2439.9150s
Epoch: 4 cost time: 5.763692140579224
Epoch: 4, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.104 Vali Acc: 0.345 Test Loss: 2.104 Test Acc: 0.345
Validation loss decreased (-0.315873 --> -0.345072).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7957728
	speed: 0.1545s/iter; left time: 2268.1337s
Epoch: 5 cost time: 5.9246416091918945
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.409 Vali Acc: 0.194 Test Loss: 2.409 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4267648
	speed: 0.1716s/iter; left time: 2493.0289s
Epoch: 6 cost time: 6.286687850952148
Epoch: 6, Steps: 154 | Train Loss: 1.747 Vali Loss: 3.249 Vali Acc: 0.197 Test Loss: 3.249 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0511999
	speed: 0.1501s/iter; left time: 2157.6090s
Epoch: 7 cost time: 5.557875156402588
Epoch: 7, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.415 Vali Acc: 0.363 Test Loss: 2.415 Test Acc: 0.363
Validation loss decreased (-0.345072 --> -0.362506).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3611851
	speed: 0.1395s/iter; left time: 1984.3952s
Epoch: 8 cost time: 5.079610824584961
Epoch: 8, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.752 Vali Acc: 0.352 Test Loss: 2.752 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3399055
	speed: 0.1491s/iter; left time: 2097.1092s
Epoch: 9 cost time: 6.1541571617126465
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.741 Vali Acc: 0.200 Test Loss: 2.741 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4287879
	speed: 0.1615s/iter; left time: 2246.8098s
Epoch: 10 cost time: 5.3448991775512695
Epoch: 10, Steps: 154 | Train Loss: 1.617 Vali Loss: 3.093 Vali Acc: 0.124 Test Loss: 3.093 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6641052
	speed: 0.1451s/iter; left time: 1996.9753s
Epoch: 11 cost time: 5.5348875522613525
Epoch: 11, Steps: 154 | Train Loss: 1.547 Vali Loss: 3.031 Vali Acc: 0.125 Test Loss: 3.031 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7348032
	speed: 0.1569s/iter; left time: 2134.4540s
Epoch: 12 cost time: 5.975492477416992
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.109 Vali Acc: 0.202 Test Loss: 3.109 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1044595
	speed: 0.1606s/iter; left time: 2160.9153s
Epoch: 13 cost time: 5.757533073425293
Epoch: 13, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.602 Vali Acc: 0.210 Test Loss: 2.602 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.0223689
	speed: 0.1388s/iter; left time: 1845.4193s
Epoch: 14 cost time: 5.382145166397095
Epoch: 14, Steps: 154 | Train Loss: 1.483 Vali Loss: 3.750 Vali Acc: 0.148 Test Loss: 3.750 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4854853
	speed: 0.1257s/iter; left time: 1652.6779s
Epoch: 15 cost time: 4.601930618286133
Epoch: 15, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.774 Vali Acc: 0.213 Test Loss: 2.774 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3379610
	speed: 0.1371s/iter; left time: 1780.4893s
Epoch: 16 cost time: 4.843528747558594
Epoch: 16, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.370 Vali Acc: 0.210 Test Loss: 2.370 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.9058402
	speed: 0.1421s/iter; left time: 1824.4162s
Epoch: 17 cost time: 5.243947267532349
Epoch: 17, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.879 Vali Acc: 0.126 Test Loss: 2.879 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36253041362530414
model parameter : 937126
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8847734
	speed: 0.0542s/iter; left time: 830.0157s
Epoch: 1 cost time: 7.163414716720581
Epoch: 1, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.301 Vali Acc: 0.315 Test Loss: 2.301 Test Acc: 0.315
Validation loss decreased (inf --> -0.315468).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9926744
	speed: 0.1477s/iter; left time: 2237.4214s
Epoch: 2 cost time: 5.2163262367248535
Epoch: 2, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.280 Vali Acc: 0.316 Test Loss: 2.280 Test Acc: 0.316
Validation loss decreased (-0.315468 --> -0.316279).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3894408
	speed: 0.1458s/iter; left time: 2185.4262s
Epoch: 3 cost time: 5.176469564437866
Epoch: 3, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.191 Vali Acc: 0.328 Test Loss: 2.191 Test Acc: 0.328
Validation loss decreased (-0.316279 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6479493
	speed: 0.1475s/iter; left time: 2188.3314s
Epoch: 4 cost time: 5.651247024536133
Epoch: 4, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.295 Vali Acc: 0.333 Test Loss: 2.295 Test Acc: 0.333
Validation loss decreased (-0.328445 --> -0.332499).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3197885
	speed: 0.1538s/iter; left time: 2258.2360s
Epoch: 5 cost time: 5.801150321960449
Epoch: 5, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.462 Vali Acc: 0.348 Test Loss: 2.462 Test Acc: 0.348
Validation loss decreased (-0.332499 --> -0.348313).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6699510
	speed: 0.1569s/iter; left time: 2279.9263s
Epoch: 6 cost time: 5.558040618896484
Epoch: 6, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.928 Vali Acc: 0.191 Test Loss: 2.928 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6598117
	speed: 0.1485s/iter; left time: 2134.4239s
Epoch: 7 cost time: 4.9986772537231445
Epoch: 7, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.579 Vali Acc: 0.360 Test Loss: 2.579 Test Acc: 0.360
Validation loss decreased (-0.348313 --> -0.360072).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1343018
	speed: 0.1549s/iter; left time: 2202.9416s
Epoch: 8 cost time: 6.0268683433532715
Epoch: 8, Steps: 154 | Train Loss: 1.659 Vali Loss: 3.001 Vali Acc: 0.118 Test Loss: 3.001 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2668064
	speed: 0.1427s/iter; left time: 2007.7243s
Epoch: 9 cost time: 4.9286370277404785
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.817 Vali Acc: 0.245 Test Loss: 2.817 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7029862
	speed: 0.1320s/iter; left time: 1836.7526s
Epoch: 10 cost time: 4.900543928146362
Epoch: 10, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.967 Vali Acc: 0.204 Test Loss: 2.967 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4858235
	speed: 0.1442s/iter; left time: 1984.6962s
Epoch: 11 cost time: 5.7497217655181885
Epoch: 11, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.113 Vali Acc: 0.199 Test Loss: 3.113 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.1509314
	speed: 0.1468s/iter; left time: 1997.1067s
Epoch: 12 cost time: 5.109379529953003
Epoch: 12, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.713 Vali Acc: 0.131 Test Loss: 2.713 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.8002890
	speed: 0.1462s/iter; left time: 1967.2087s
Epoch: 13 cost time: 5.07737398147583
Epoch: 13, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.356 Vali Acc: 0.197 Test Loss: 3.356 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3428137
	speed: 0.1427s/iter; left time: 1898.0869s
Epoch: 14 cost time: 5.659646987915039
Epoch: 14, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.811 Vali Acc: 0.070 Test Loss: 3.811 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6837972
	speed: 0.1377s/iter; left time: 1809.8791s
Epoch: 15 cost time: 5.426520586013794
Epoch: 15, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.959 Vali Acc: 0.130 Test Loss: 2.959 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6861068
	speed: 0.1377s/iter; left time: 1789.1049s
Epoch: 16 cost time: 5.2223286628723145
Epoch: 16, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.117 Vali Acc: 0.381 Test Loss: 3.117 Test Acc: 0.381
Validation loss decreased (-0.360072 --> -0.381153).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3799431
	speed: 0.1362s/iter; left time: 1747.7951s
Epoch: 17 cost time: 4.953537702560425
Epoch: 17, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.322 Vali Acc: 0.120 Test Loss: 3.322 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2737229
	speed: 0.1344s/iter; left time: 1704.5589s
Epoch: 18 cost time: 5.009169340133667
Epoch: 18, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.024 Vali Acc: 0.205 Test Loss: 3.024 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1518922
	speed: 0.1436s/iter; left time: 1798.8634s
Epoch: 19 cost time: 5.073484897613525
Epoch: 19, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.712 Vali Acc: 0.266 Test Loss: 2.712 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.4183298
	speed: 0.1455s/iter; left time: 1800.3029s
Epoch: 20 cost time: 5.231673717498779
Epoch: 20, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.250 Vali Acc: 0.174 Test Loss: 3.250 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.1300379
	speed: 0.1333s/iter; left time: 1628.9339s
Epoch: 21 cost time: 5.147480249404907
Epoch: 21, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.033 Vali Acc: 0.173 Test Loss: 3.033 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.4425892
	speed: 0.1424s/iter; left time: 1718.8110s
Epoch: 22 cost time: 5.328359603881836
Epoch: 22, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.143 Vali Acc: 0.182 Test Loss: 3.143 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.4787122
	speed: 0.1430s/iter; left time: 1703.1827s
Epoch: 23 cost time: 5.056028604507446
Epoch: 23, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.784 Vali Acc: 0.196 Test Loss: 2.784 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.7232511
	speed: 0.1492s/iter; left time: 1754.2562s
Epoch: 24 cost time: 5.480955123901367
Epoch: 24, Steps: 154 | Train Loss: 1.267 Vali Loss: 3.165 Vali Acc: 0.190 Test Loss: 3.165 Test Acc: 0.190
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.6504704
	speed: 0.1499s/iter; left time: 1739.0359s
Epoch: 25 cost time: 5.38850998878479
Epoch: 25, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.269 Vali Acc: 0.126 Test Loss: 3.269 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.5040388
	speed: 0.1449s/iter; left time: 1659.3520s
Epoch: 26 cost time: 5.746655702590942
Epoch: 26, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.138 Vali Acc: 0.181 Test Loss: 3.138 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38118410381184104
model parameter : 936742
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4936874
	speed: 0.0553s/iter; left time: 846.0191s
Epoch: 1 cost time: 7.231388568878174
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.235 Vali Acc: 0.315 Test Loss: 2.235 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6318783
	speed: 0.1528s/iter; left time: 2314.4916s
Epoch: 2 cost time: 5.148346662521362
Epoch: 2, Steps: 154 | Train Loss: 2.158 Vali Loss: 2.231 Vali Acc: 0.316 Test Loss: 2.231 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.316279).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1696219
	speed: 0.1380s/iter; left time: 2068.4057s
Epoch: 3 cost time: 4.441531419754028
Epoch: 3, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.134 Vali Acc: 0.322 Test Loss: 2.134 Test Acc: 0.322
Validation loss decreased (-0.316279 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9415154
	speed: 0.1503s/iter; left time: 2229.6894s
Epoch: 4 cost time: 5.7038373947143555
Epoch: 4, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.232 Vali Acc: 0.328 Test Loss: 2.232 Test Acc: 0.328
Validation loss decreased (-0.322363 --> -0.328039).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4474895
	speed: 0.1558s/iter; left time: 2288.3557s
Epoch: 5 cost time: 5.950737237930298
Epoch: 5, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.202 Vali Acc: 0.343 Test Loss: 2.202 Test Acc: 0.343
Validation loss decreased (-0.328039 --> -0.343449).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6022154
	speed: 0.1508s/iter; left time: 2191.0119s
Epoch: 6 cost time: 5.067271709442139
Epoch: 6, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.814 Vali Acc: 0.183 Test Loss: 2.814 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7225701
	speed: 0.1336s/iter; left time: 1920.7267s
Epoch: 7 cost time: 4.768498659133911
Epoch: 7, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.733 Vali Acc: 0.347 Test Loss: 2.733 Test Acc: 0.347
Validation loss decreased (-0.343449 --> -0.347094).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5730454
	speed: 0.1457s/iter; left time: 2071.9079s
Epoch: 8 cost time: 5.1398255825042725
Epoch: 8, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.445 Vali Acc: 0.357 Test Loss: 2.445 Test Acc: 0.357
Validation loss decreased (-0.347094 --> -0.357234).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1577817
	speed: 0.1503s/iter; left time: 2114.3646s
Epoch: 9 cost time: 5.700184106826782
Epoch: 9, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.282 Vali Acc: 0.116 Test Loss: 3.282 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5384051
	speed: 0.1398s/iter; left time: 1945.5587s
Epoch: 10 cost time: 4.882389068603516
Epoch: 10, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.931 Vali Acc: 0.204 Test Loss: 2.931 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1452228
	speed: 0.1368s/iter; left time: 1882.0870s
Epoch: 11 cost time: 4.93971061706543
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.756 Vali Acc: 0.206 Test Loss: 2.756 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.6769727
	speed: 0.1426s/iter; left time: 1939.7024s
Epoch: 12 cost time: 4.839731931686401
Epoch: 12, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.946 Vali Acc: 0.201 Test Loss: 2.946 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0758599
	speed: 0.1391s/iter; left time: 1871.7237s
Epoch: 13 cost time: 5.4806177616119385
Epoch: 13, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.771 Vali Acc: 0.206 Test Loss: 2.771 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.9366146
	speed: 0.1444s/iter; left time: 1920.8764s
Epoch: 14 cost time: 5.592057704925537
Epoch: 14, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.179 Vali Acc: 0.135 Test Loss: 3.179 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.6757205
	speed: 0.1347s/iter; left time: 1770.0164s
Epoch: 15 cost time: 5.07520055770874
Epoch: 15, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.846 Vali Acc: 0.131 Test Loss: 3.846 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3047994
	speed: 0.1386s/iter; left time: 1800.3126s
Epoch: 16 cost time: 5.2050087451934814
Epoch: 16, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.384 Vali Acc: 0.414 Test Loss: 2.384 Test Acc: 0.414
Validation loss decreased (-0.357234 --> -0.414412).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4822851
	speed: 0.1411s/iter; left time: 1811.1365s
Epoch: 17 cost time: 4.762605905532837
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.770 Vali Acc: 0.354 Test Loss: 2.770 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1447573
	speed: 0.1371s/iter; left time: 1739.4681s
Epoch: 18 cost time: 5.000177621841431
Epoch: 18, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.579 Vali Acc: 0.182 Test Loss: 2.579 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8857455
	speed: 0.1471s/iter; left time: 1842.4319s
Epoch: 19 cost time: 5.699474811553955
Epoch: 19, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.659 Vali Acc: 0.189 Test Loss: 2.659 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6752965
	speed: 0.1557s/iter; left time: 1926.3454s
Epoch: 20 cost time: 6.127235651016235
Epoch: 20, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.481 Vali Acc: 0.223 Test Loss: 2.481 Test Acc: 0.223
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.5706980
	speed: 0.1608s/iter; left time: 1965.3527s
Epoch: 21 cost time: 5.7212748527526855
Epoch: 21, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.829 Vali Acc: 0.086 Test Loss: 2.829 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0082718
	speed: 0.1672s/iter; left time: 2018.1689s
Epoch: 22 cost time: 5.545500755310059
Epoch: 22, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.844 Vali Acc: 0.140 Test Loss: 2.844 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.5174290
	speed: 0.1568s/iter; left time: 1868.1796s
Epoch: 23 cost time: 5.359453916549683
Epoch: 23, Steps: 154 | Train Loss: 1.245 Vali Loss: 2.535 Vali Acc: 0.266 Test Loss: 2.535 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3794194
	speed: 0.1533s/iter; left time: 1803.0824s
Epoch: 24 cost time: 5.5903050899505615
Epoch: 24, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.655 Vali Acc: 0.209 Test Loss: 2.655 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.0620130
	speed: 0.1528s/iter; left time: 1773.3840s
Epoch: 25 cost time: 5.55817437171936
Epoch: 25, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.733 Vali Acc: 0.144 Test Loss: 2.733 Test Acc: 0.144
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.1389407
	speed: 0.1705s/iter; left time: 1952.3251s
Epoch: 26 cost time: 6.575448274612427
Epoch: 26, Steps: 154 | Train Loss: 1.200 Vali Loss: 2.986 Vali Acc: 0.088 Test Loss: 2.986 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4144363341443633
model parameter : 936358
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8582059
	speed: 0.0487s/iter; left time: 745.7508s
Epoch: 1 cost time: 6.437567949295044
Epoch: 1, Steps: 154 | Train Loss: 2.247 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6877507
	speed: 0.1439s/iter; left time: 2180.2462s
Epoch: 2 cost time: 5.329770565032959
Epoch: 2, Steps: 154 | Train Loss: 2.212 Vali Loss: 2.274 Vali Acc: 0.112 Test Loss: 2.274 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7211714
	speed: 0.1482s/iter; left time: 2221.6203s
Epoch: 3 cost time: 5.1596479415893555
Epoch: 3, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.131 Vali Acc: 0.331 Test Loss: 2.131 Test Acc: 0.331
Validation loss decreased (-0.315063 --> -0.330879).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3277409
	speed: 0.1386s/iter; left time: 2056.3222s
Epoch: 4 cost time: 4.981346368789673
Epoch: 4, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.205 Vali Acc: 0.343 Test Loss: 2.205 Test Acc: 0.343
Validation loss decreased (-0.330879 --> -0.343449).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4164897
	speed: 0.1578s/iter; left time: 2317.9800s
Epoch: 5 cost time: 5.832732677459717
Epoch: 5, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.895 Vali Acc: 0.176 Test Loss: 2.895 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5321195
	speed: 0.1569s/iter; left time: 2279.6805s
Epoch: 6 cost time: 5.614866256713867
Epoch: 6, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.574 Vali Acc: 0.202 Test Loss: 2.574 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1852540
	speed: 0.1544s/iter; left time: 2219.0984s
Epoch: 7 cost time: 5.188165903091431
Epoch: 7, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.327 Vali Acc: 0.200 Test Loss: 2.327 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1629444
	speed: 0.1546s/iter; left time: 2199.5729s
Epoch: 8 cost time: 5.381267547607422
Epoch: 8, Steps: 154 | Train Loss: 1.640 Vali Loss: 3.058 Vali Acc: 0.189 Test Loss: 3.058 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7984682
	speed: 0.1538s/iter; left time: 2164.3322s
Epoch: 9 cost time: 5.75619912147522
Epoch: 9, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.813 Vali Acc: 0.393 Test Loss: 2.813 Test Acc: 0.393
Validation loss decreased (-0.343449 --> -0.392510).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9136258
	speed: 0.1413s/iter; left time: 1966.3652s
Epoch: 10 cost time: 5.188539028167725
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.980 Vali Acc: 0.206 Test Loss: 2.980 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4614112
	speed: 0.1459s/iter; left time: 2007.4461s
Epoch: 11 cost time: 4.9592766761779785
Epoch: 11, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.795 Vali Acc: 0.135 Test Loss: 2.795 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3455499
	speed: 0.1679s/iter; left time: 2284.1074s
Epoch: 12 cost time: 6.268076181411743
Epoch: 12, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.741 Vali Acc: 0.136 Test Loss: 2.741 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.0202758
	speed: 0.1610s/iter; left time: 2166.1522s
Epoch: 13 cost time: 5.729281663894653
Epoch: 13, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.665 Vali Acc: 0.206 Test Loss: 2.665 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.0500901
	speed: 0.1608s/iter; left time: 2139.1344s
Epoch: 14 cost time: 5.618891477584839
Epoch: 14, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.894 Vali Acc: 0.207 Test Loss: 2.894 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.6693943
	speed: 0.1528s/iter; left time: 2009.0855s
Epoch: 15 cost time: 5.817806243896484
Epoch: 15, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.634 Vali Acc: 0.183 Test Loss: 2.634 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.9213175
	speed: 0.1681s/iter; left time: 2183.3419s
Epoch: 16 cost time: 5.526839971542358
Epoch: 16, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.293 Vali Acc: 0.386 Test Loss: 2.293 Test Acc: 0.386
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.5102499
	speed: 0.1498s/iter; left time: 1922.6568s
Epoch: 17 cost time: 5.4597673416137695
Epoch: 17, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.256 Vali Acc: 0.396 Test Loss: 2.256 Test Acc: 0.396
Validation loss decreased (-0.392510 --> -0.396166).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2435288
	speed: 0.1606s/iter; left time: 2037.0179s
Epoch: 18 cost time: 6.198442697525024
Epoch: 18, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.732 Vali Acc: 0.153 Test Loss: 2.732 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.8877627
	speed: 0.1779s/iter; left time: 2228.6420s
Epoch: 19 cost time: 5.766736268997192
Epoch: 19, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.355 Vali Acc: 0.219 Test Loss: 2.355 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.0270489
	speed: 0.1470s/iter; left time: 1819.1794s
Epoch: 20 cost time: 5.234780788421631
Epoch: 20, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.601 Vali Acc: 0.274 Test Loss: 2.601 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.6158496
	speed: 0.1500s/iter; left time: 1833.7349s
Epoch: 21 cost time: 5.003108501434326
Epoch: 21, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.702 Vali Acc: 0.232 Test Loss: 2.702 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.0238936
	speed: 0.1483s/iter; left time: 1789.5698s
Epoch: 22 cost time: 5.268402338027954
Epoch: 22, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.428 Vali Acc: 0.376 Test Loss: 2.428 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.7549418
	speed: 0.1487s/iter; left time: 1770.8878s
Epoch: 23 cost time: 5.096632242202759
Epoch: 23, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.964 Vali Acc: 0.087 Test Loss: 2.964 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.8796835
	speed: 0.1504s/iter; left time: 1768.7683s
Epoch: 24 cost time: 5.570474624633789
Epoch: 24, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.446 Vali Acc: 0.224 Test Loss: 2.446 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9489940
	speed: 0.1526s/iter; left time: 1771.3343s
Epoch: 25 cost time: 6.01080584526062
Epoch: 25, Steps: 154 | Train Loss: 1.240 Vali Loss: 2.653 Vali Acc: 0.190 Test Loss: 2.653 Test Acc: 0.190
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.4519687
	speed: 0.1640s/iter; left time: 1878.1808s
Epoch: 26 cost time: 5.720792531967163
Epoch: 26, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.766 Vali Acc: 0.113 Test Loss: 2.766 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.1307843
	speed: 0.1482s/iter; left time: 1674.7526s
Epoch: 27 cost time: 5.751225709915161
Epoch: 27, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.871 Vali Acc: 0.089 Test Loss: 2.871 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3961881589618816
model parameter : 935974
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0216219
	speed: 0.0512s/iter; left time: 783.5393s
Epoch: 1 cost time: 7.1273064613342285
Epoch: 1, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.195 Vali Acc: 0.315 Test Loss: 2.195 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7189008
	speed: 0.1550s/iter; left time: 2348.2954s
Epoch: 2 cost time: 5.6289379596710205
Epoch: 2, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.144 Vali Acc: 0.315 Test Loss: 2.144 Test Acc: 0.315
Validation loss decreased (-0.315469 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8163847
	speed: 0.1553s/iter; left time: 2327.9380s
Epoch: 3 cost time: 6.564990758895874
Epoch: 3, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.193 Vali Acc: 0.320 Test Loss: 2.193 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319929).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7437875
	speed: 0.1643s/iter; left time: 2438.1517s
Epoch: 4 cost time: 6.366015195846558
Epoch: 4, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.088 Vali Acc: 0.190 Test Loss: 2.088 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2532734
	speed: 0.1695s/iter; left time: 2489.5766s
Epoch: 5 cost time: 5.871801853179932
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.288 Vali Acc: 0.370 Test Loss: 2.288 Test Acc: 0.370
Validation loss decreased (-0.319929 --> -0.370212).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6140743
	speed: 0.1620s/iter; left time: 2353.7824s
Epoch: 6 cost time: 5.5916478633880615
Epoch: 6, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.386 Vali Acc: 0.195 Test Loss: 2.386 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3336668
	speed: 0.1460s/iter; left time: 2099.2078s
Epoch: 7 cost time: 5.157843589782715
Epoch: 7, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.494 Vali Acc: 0.261 Test Loss: 2.494 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9514777
	speed: 0.1466s/iter; left time: 2085.1823s
Epoch: 8 cost time: 5.4259350299835205
Epoch: 8, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.589 Vali Acc: 0.207 Test Loss: 2.589 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5836129
	speed: 0.1540s/iter; left time: 2167.3219s
Epoch: 9 cost time: 5.236460447311401
Epoch: 9, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.952 Vali Acc: 0.362 Test Loss: 2.952 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4319496
	speed: 0.1434s/iter; left time: 1995.7820s
Epoch: 10 cost time: 5.3093461990356445
Epoch: 10, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.979 Vali Acc: 0.280 Test Loss: 2.979 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3192614
	speed: 0.1440s/iter; left time: 1981.5186s
Epoch: 11 cost time: 5.623879909515381
Epoch: 11, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.638 Vali Acc: 0.114 Test Loss: 3.638 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5300090
	speed: 0.1468s/iter; left time: 1997.9863s
Epoch: 12 cost time: 5.210236549377441
Epoch: 12, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.057 Vali Acc: 0.187 Test Loss: 3.057 Test Acc: 0.187
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4745407
	speed: 0.1353s/iter; left time: 1820.0410s
Epoch: 13 cost time: 4.837793588638306
Epoch: 13, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.568 Vali Acc: 0.201 Test Loss: 3.568 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.7437359
	speed: 0.1350s/iter; left time: 1795.9594s
Epoch: 14 cost time: 5.030591011047363
Epoch: 14, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.837 Vali Acc: 0.187 Test Loss: 3.837 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5144362
	speed: 0.1323s/iter; left time: 1738.4756s
Epoch: 15 cost time: 5.31876802444458
Epoch: 15, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.555 Vali Acc: 0.121 Test Loss: 3.555 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 618918
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3122311
	speed: 0.0507s/iter; left time: 775.4959s
Epoch: 1 cost time: 6.7551069259643555
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.223 Vali Acc: 0.129 Test Loss: 2.223 Test Acc: 0.129
Validation loss decreased (inf --> -0.128932).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9044995
	speed: 0.1345s/iter; left time: 2037.2883s
Epoch: 2 cost time: 5.11690878868103
Epoch: 2, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.131 Vali Acc: 0.315 Test Loss: 2.131 Test Acc: 0.315
Validation loss decreased (-0.128932 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0235400
	speed: 0.1553s/iter; left time: 2329.1526s
Epoch: 3 cost time: 5.269374132156372
Epoch: 3, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.206 Vali Acc: 0.324 Test Loss: 2.206 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.323579).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1915467
	speed: 0.1396s/iter; left time: 2071.1165s
Epoch: 4 cost time: 5.210097789764404
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.036 Vali Acc: 0.343 Test Loss: 2.036 Test Acc: 0.343
Validation loss decreased (-0.323579 --> -0.342640).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8077253
	speed: 0.1387s/iter; left time: 2036.3609s
Epoch: 5 cost time: 5.222689628601074
Epoch: 5, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.487 Vali Acc: 0.183 Test Loss: 2.487 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4409220
	speed: 0.1491s/iter; left time: 2166.7972s
Epoch: 6 cost time: 6.0433619022369385
Epoch: 6, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.724 Vali Acc: 0.200 Test Loss: 2.724 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9111071
	speed: 0.1585s/iter; left time: 2279.2955s
Epoch: 7 cost time: 5.881329298019409
Epoch: 7, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.888 Vali Acc: 0.212 Test Loss: 2.888 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1777294
	speed: 0.1478s/iter; left time: 2102.2807s
Epoch: 8 cost time: 5.580363750457764
Epoch: 8, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.186 Vali Acc: 0.198 Test Loss: 3.186 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0509768
	speed: 0.1610s/iter; left time: 2264.5788s
Epoch: 9 cost time: 5.544853687286377
Epoch: 9, Steps: 154 | Train Loss: 1.570 Vali Loss: 3.416 Vali Acc: 0.116 Test Loss: 3.416 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5755837
	speed: 0.1607s/iter; left time: 2236.5489s
Epoch: 10 cost time: 6.086540699005127
Epoch: 10, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.400 Vali Acc: 0.112 Test Loss: 3.400 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.0457062
	speed: 0.1418s/iter; left time: 1950.6700s
Epoch: 11 cost time: 5.4078967571258545
Epoch: 11, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.411 Vali Acc: 0.204 Test Loss: 3.411 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.7725124
	speed: 0.1531s/iter; left time: 2083.7564s
Epoch: 12 cost time: 5.680978298187256
Epoch: 12, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.704 Vali Acc: 0.194 Test Loss: 3.704 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1857345
	speed: 0.1594s/iter; left time: 2143.9328s
Epoch: 13 cost time: 6.188953638076782
Epoch: 13, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.869 Vali Acc: 0.118 Test Loss: 3.869 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.2486541
	speed: 0.1468s/iter; left time: 1952.8631s
Epoch: 14 cost time: 5.507925748825073
Epoch: 14, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.427 Vali Acc: 0.190 Test Loss: 3.427 Test Acc: 0.190
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3426601784266018
model parameter : 618726
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3087258
	speed: 0.0477s/iter; left time: 729.5778s
Epoch: 1 cost time: 6.549347877502441
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.206 Vali Acc: 0.315 Test Loss: 2.206 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8589015
	speed: 0.1404s/iter; left time: 2126.8609s
Epoch: 2 cost time: 5.463198661804199
Epoch: 2, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.202 Vali Acc: 0.315 Test Loss: 2.202 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4641430
	speed: 0.1217s/iter; left time: 1825.2473s
Epoch: 3 cost time: 4.579587697982788
Epoch: 3, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.155 Vali Acc: 0.326 Test Loss: 2.155 Test Acc: 0.326
Validation loss decreased (-0.315469 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0779974
	speed: 0.1334s/iter; left time: 1979.1563s
Epoch: 4 cost time: 4.987404823303223
Epoch: 4, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.285 Vali Acc: 0.337 Test Loss: 2.285 Test Acc: 0.337
Validation loss decreased (-0.325607 --> -0.336555).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9252864
	speed: 0.1405s/iter; left time: 2062.7151s
Epoch: 5 cost time: 5.3393871784210205
Epoch: 5, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.229 Vali Acc: 0.344 Test Loss: 2.229 Test Acc: 0.344
Validation loss decreased (-0.336555 --> -0.344260).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7535342
	speed: 0.1390s/iter; left time: 2019.8416s
Epoch: 6 cost time: 5.361371994018555
Epoch: 6, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.610 Vali Acc: 0.114 Test Loss: 2.610 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9363178
	speed: 0.1355s/iter; left time: 1947.8427s
Epoch: 7 cost time: 4.241137981414795
Epoch: 7, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.666 Vali Acc: 0.199 Test Loss: 2.666 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7073882
	speed: 0.1163s/iter; left time: 1653.7025s
Epoch: 8 cost time: 4.287763595581055
Epoch: 8, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.971 Vali Acc: 0.201 Test Loss: 2.971 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6465864
	speed: 0.1291s/iter; left time: 1815.9714s
Epoch: 9 cost time: 5.392608404159546
Epoch: 9, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.454 Vali Acc: 0.119 Test Loss: 3.454 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6601061
	speed: 0.1387s/iter; left time: 1929.9287s
Epoch: 10 cost time: 4.78337287902832
Epoch: 10, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.199 Vali Acc: 0.136 Test Loss: 3.199 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1752950
	speed: 0.1271s/iter; left time: 1749.5132s
Epoch: 11 cost time: 4.659594297409058
Epoch: 11, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.375 Vali Acc: 0.189 Test Loss: 3.375 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1299995
	speed: 0.1334s/iter; left time: 1814.8486s
Epoch: 12 cost time: 4.9211671352386475
Epoch: 12, Steps: 154 | Train Loss: 1.464 Vali Loss: 4.311 Vali Acc: 0.105 Test Loss: 4.311 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3125610
	speed: 0.1439s/iter; left time: 1936.3634s
Epoch: 13 cost time: 5.73013710975647
Epoch: 13, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.434 Vali Acc: 0.146 Test Loss: 3.434 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3640988
	speed: 0.1459s/iter; left time: 1939.6673s
Epoch: 14 cost time: 5.412014484405518
Epoch: 14, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.426 Vali Acc: 0.198 Test Loss: 3.426 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.0487944
	speed: 0.1468s/iter; left time: 1930.1888s
Epoch: 15 cost time: 5.126365661621094
Epoch: 15, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.790 Vali Acc: 0.135 Test Loss: 3.790 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3442822384428224
model parameter : 618534
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4321291
	speed: 0.0522s/iter; left time: 798.3103s
Epoch: 1 cost time: 6.887059688568115
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3033919
	speed: 0.1449s/iter; left time: 2194.8434s
Epoch: 2 cost time: 5.228280305862427
Epoch: 2, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.252 Vali Acc: 0.317 Test Loss: 2.252 Test Acc: 0.317
Validation loss decreased (-0.314658 --> -0.316685).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1747782
	speed: 0.1443s/iter; left time: 2162.7573s
Epoch: 3 cost time: 5.101214647293091
Epoch: 3, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.088 Vali Acc: 0.330 Test Loss: 2.088 Test Acc: 0.330
Validation loss decreased (-0.316685 --> -0.329663).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9921420
	speed: 0.1446s/iter; left time: 2145.2058s
Epoch: 4 cost time: 5.094884872436523
Epoch: 4, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.799 Vali Acc: 0.169 Test Loss: 2.799 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4337227
	speed: 0.1371s/iter; left time: 2012.7788s
Epoch: 5 cost time: 4.797274827957153
Epoch: 5, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.474 Vali Acc: 0.342 Test Loss: 2.474 Test Acc: 0.342
Validation loss decreased (-0.329663 --> -0.341824).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4092563
	speed: 0.1393s/iter; left time: 2023.8393s
Epoch: 6 cost time: 5.255913019180298
Epoch: 6, Steps: 154 | Train Loss: 1.676 Vali Loss: 3.083 Vali Acc: 0.172 Test Loss: 3.083 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5387992
	speed: 0.1367s/iter; left time: 1965.0042s
Epoch: 7 cost time: 5.085772275924683
Epoch: 7, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.572 Vali Acc: 0.208 Test Loss: 2.572 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5477701
	speed: 0.1324s/iter; left time: 1882.9464s
Epoch: 8 cost time: 4.7869873046875
Epoch: 8, Steps: 154 | Train Loss: 1.548 Vali Loss: 3.439 Vali Acc: 0.177 Test Loss: 3.439 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6660786
	speed: 0.1261s/iter; left time: 1774.1896s
Epoch: 9 cost time: 4.770918369293213
Epoch: 9, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.211 Vali Acc: 0.118 Test Loss: 3.211 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3024789
	speed: 0.1372s/iter; left time: 1909.1781s
Epoch: 10 cost time: 5.203762769699097
Epoch: 10, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.418 Vali Acc: 0.110 Test Loss: 3.418 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4389378
	speed: 0.1402s/iter; left time: 1928.9085s
Epoch: 11 cost time: 4.785626173019409
Epoch: 11, Steps: 154 | Train Loss: 1.484 Vali Loss: 4.028 Vali Acc: 0.123 Test Loss: 4.028 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4795732
	speed: 0.1246s/iter; left time: 1695.3651s
Epoch: 12 cost time: 4.87109899520874
Epoch: 12, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.393 Vali Acc: 0.114 Test Loss: 3.393 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3344545
	speed: 0.1214s/iter; left time: 1633.0810s
Epoch: 13 cost time: 4.4865882396698
Epoch: 13, Steps: 154 | Train Loss: 1.419 Vali Loss: 4.395 Vali Acc: 0.124 Test Loss: 4.395 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.8673260
	speed: 0.1241s/iter; left time: 1650.2057s
Epoch: 14 cost time: 5.009181976318359
Epoch: 14, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.068 Vali Acc: 0.146 Test Loss: 3.068 Test Acc: 0.146
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2877055
	speed: 0.1311s/iter; left time: 1723.2603s
Epoch: 15 cost time: 4.5562684535980225
Epoch: 15, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.635 Vali Acc: 0.071 Test Loss: 3.635 Test Acc: 0.071
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3418491484184915
model parameter : 618342
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0508683
	speed: 0.0469s/iter; left time: 717.8494s
Epoch: 1 cost time: 6.380476713180542
Epoch: 1, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.192 Vali Acc: 0.315 Test Loss: 2.192 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0256212
	speed: 0.1361s/iter; left time: 2062.1273s
Epoch: 2 cost time: 5.023168087005615
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.182 Vali Acc: 0.316 Test Loss: 2.182 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3341181
	speed: 0.1389s/iter; left time: 2081.9729s
Epoch: 3 cost time: 5.063706874847412
Epoch: 3, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.152 Vali Acc: 0.322 Test Loss: 2.152 Test Acc: 0.322
Validation loss decreased (-0.315874 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6894125
	speed: 0.1430s/iter; left time: 2122.2271s
Epoch: 4 cost time: 5.502244472503662
Epoch: 4, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.098 Vali Acc: 0.335 Test Loss: 2.098 Test Acc: 0.335
Validation loss decreased (-0.322363 --> -0.334934).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7130634
	speed: 0.1421s/iter; left time: 2087.1968s
Epoch: 5 cost time: 5.286175727844238
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.158 Vali Acc: 0.362 Test Loss: 2.158 Test Acc: 0.362
Validation loss decreased (-0.334934 --> -0.362103).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7320900
	speed: 0.1484s/iter; left time: 2155.9644s
Epoch: 6 cost time: 5.33225679397583
Epoch: 6, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.334 Vali Acc: 0.365 Test Loss: 2.334 Test Acc: 0.365
Validation loss decreased (-0.362103 --> -0.365346).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5688670
	speed: 0.1402s/iter; left time: 2016.1088s
Epoch: 7 cost time: 5.185755968093872
Epoch: 7, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.766 Vali Acc: 0.148 Test Loss: 2.766 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0252526
	speed: 0.1411s/iter; left time: 2006.9281s
Epoch: 8 cost time: 5.416077375411987
Epoch: 8, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.946 Vali Acc: 0.144 Test Loss: 2.946 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9629731
	speed: 0.1494s/iter; left time: 2101.2466s
Epoch: 9 cost time: 5.186877012252808
Epoch: 9, Steps: 154 | Train Loss: 1.528 Vali Loss: 3.287 Vali Acc: 0.114 Test Loss: 3.287 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2732989
	speed: 0.1383s/iter; left time: 1924.6247s
Epoch: 10 cost time: 4.921876668930054
Epoch: 10, Steps: 154 | Train Loss: 1.516 Vali Loss: 3.190 Vali Acc: 0.238 Test Loss: 3.190 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3922181
	speed: 0.1313s/iter; left time: 1807.0194s
Epoch: 11 cost time: 5.235799312591553
Epoch: 11, Steps: 154 | Train Loss: 1.479 Vali Loss: 3.584 Vali Acc: 0.118 Test Loss: 3.584 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5331475
	speed: 0.1329s/iter; left time: 1807.8666s
Epoch: 12 cost time: 5.331841468811035
Epoch: 12, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.711 Vali Acc: 0.077 Test Loss: 3.711 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.4773239
	speed: 0.1408s/iter; left time: 1893.8442s
Epoch: 13 cost time: 4.767321825027466
Epoch: 13, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.906 Vali Acc: 0.350 Test Loss: 2.906 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4095093
	speed: 0.1282s/iter; left time: 1705.0212s
Epoch: 14 cost time: 4.5718677043914795
Epoch: 14, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.351 Vali Acc: 0.197 Test Loss: 3.351 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.6154755
	speed: 0.1257s/iter; left time: 1651.7119s
Epoch: 15 cost time: 4.656555652618408
Epoch: 15, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.831 Vali Acc: 0.127 Test Loss: 3.831 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.6137159
	speed: 0.1350s/iter; left time: 1754.1653s
Epoch: 16 cost time: 4.717185974121094
Epoch: 16, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.409 Vali Acc: 0.118 Test Loss: 3.409 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 420774
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0230618
	speed: 0.0488s/iter; left time: 746.1302s
Epoch: 1 cost time: 6.427384376525879
Epoch: 1, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2662218
	speed: 0.1233s/iter; left time: 1867.8090s
Epoch: 2 cost time: 4.5651633739471436
Epoch: 2, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.190 Vali Acc: 0.316 Test Loss: 2.190 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4451277
	speed: 0.1294s/iter; left time: 1940.0213s
Epoch: 3 cost time: 4.904816627502441
Epoch: 3, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.237 Vali Acc: 0.317 Test Loss: 2.237 Test Acc: 0.317
Validation loss decreased (-0.315874 --> -0.317090).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4216146
	speed: 0.1357s/iter; left time: 2013.0400s
Epoch: 4 cost time: 5.251185178756714
Epoch: 4, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.106 Vali Acc: 0.332 Test Loss: 2.106 Test Acc: 0.332
Validation loss decreased (-0.317090 --> -0.332096).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7293694
	speed: 0.1353s/iter; left time: 1987.2869s
Epoch: 5 cost time: 5.107331275939941
Epoch: 5, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.025 Vali Acc: 0.359 Test Loss: 2.025 Test Acc: 0.359
Validation loss decreased (-0.332096 --> -0.358861).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0515230
	speed: 0.1408s/iter; left time: 2045.5484s
Epoch: 6 cost time: 4.9720940589904785
Epoch: 6, Steps: 154 | Train Loss: 1.729 Vali Loss: 3.008 Vali Acc: 0.185 Test Loss: 3.008 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7799457
	speed: 0.1384s/iter; left time: 1989.2532s
Epoch: 7 cost time: 5.212358713150024
Epoch: 7, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.715 Vali Acc: 0.216 Test Loss: 2.715 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6708722
	speed: 0.1404s/iter; left time: 1996.3920s
Epoch: 8 cost time: 5.271204233169556
Epoch: 8, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.862 Vali Acc: 0.120 Test Loss: 2.862 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5853553
	speed: 0.1463s/iter; left time: 2057.7941s
Epoch: 9 cost time: 5.309400796890259
Epoch: 9, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.053 Vali Acc: 0.330 Test Loss: 3.053 Test Acc: 0.330
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.9096353
	speed: 0.1380s/iter; left time: 1919.6595s
Epoch: 10 cost time: 4.982104301452637
Epoch: 10, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.925 Vali Acc: 0.112 Test Loss: 3.925 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.0971458
	speed: 0.1383s/iter; left time: 1903.0935s
Epoch: 11 cost time: 5.192585229873657
Epoch: 11, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.582 Vali Acc: 0.121 Test Loss: 3.582 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.9661623
	speed: 0.1449s/iter; left time: 1971.0295s
Epoch: 12 cost time: 4.979980707168579
Epoch: 12, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.323 Vali Acc: 0.135 Test Loss: 3.323 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3686682
	speed: 0.1420s/iter; left time: 1910.1179s
Epoch: 13 cost time: 5.2152259349823
Epoch: 13, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.791 Vali Acc: 0.117 Test Loss: 3.791 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9593560
	speed: 0.1295s/iter; left time: 1721.9649s
Epoch: 14 cost time: 4.818225383758545
Epoch: 14, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.576 Vali Acc: 0.118 Test Loss: 3.576 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4922221
	speed: 0.1385s/iter; left time: 1820.3244s
Epoch: 15 cost time: 5.251405477523804
Epoch: 15, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.111 Vali Acc: 0.219 Test Loss: 3.111 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3588807785888078
model parameter : 420582
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3690348
	speed: 0.0463s/iter; left time: 708.8671s
Epoch: 1 cost time: 6.235801935195923
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.189 Vali Acc: 0.315 Test Loss: 2.189 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3374562
	speed: 0.1393s/iter; left time: 2110.5745s
Epoch: 2 cost time: 5.054704189300537
Epoch: 2, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.196 Vali Acc: 0.315 Test Loss: 2.196 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2739935
	speed: 0.1485s/iter; left time: 2226.8188s
Epoch: 3 cost time: 5.191359996795654
Epoch: 3, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6384978
	speed: 0.1334s/iter; left time: 1979.7145s
Epoch: 4 cost time: 4.9389777183532715
Epoch: 4, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.276 Vali Acc: 0.328 Test Loss: 2.276 Test Acc: 0.328
Validation loss decreased (-0.318713 --> -0.328039).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4336762
	speed: 0.1414s/iter; left time: 2075.7455s
Epoch: 5 cost time: 5.121483087539673
Epoch: 5, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.189 Vali Acc: 0.350 Test Loss: 2.189 Test Acc: 0.350
Validation loss decreased (-0.328039 --> -0.350343).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4506879
	speed: 0.1479s/iter; left time: 2148.9712s
Epoch: 6 cost time: 5.504047870635986
Epoch: 6, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.215 Vali Acc: 0.358 Test Loss: 2.215 Test Acc: 0.358
Validation loss decreased (-0.350343 --> -0.358048).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4066603
	speed: 0.1322s/iter; left time: 1900.7835s
Epoch: 7 cost time: 4.83484673500061
Epoch: 7, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.718 Vali Acc: 0.196 Test Loss: 2.718 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3583705
	speed: 0.1341s/iter; left time: 1906.8002s
Epoch: 8 cost time: 4.896747827529907
Epoch: 8, Steps: 154 | Train Loss: 1.576 Vali Loss: 3.248 Vali Acc: 0.119 Test Loss: 3.248 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5824784
	speed: 0.1375s/iter; left time: 1934.7296s
Epoch: 9 cost time: 5.184748411178589
Epoch: 9, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.347 Vali Acc: 0.193 Test Loss: 3.347 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8135977
	speed: 0.1591s/iter; left time: 2213.9143s
Epoch: 10 cost time: 5.582338333129883
Epoch: 10, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.480 Vali Acc: 0.111 Test Loss: 3.480 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6079167
	speed: 0.1435s/iter; left time: 1975.1826s
Epoch: 11 cost time: 4.843461275100708
Epoch: 11, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.220 Vali Acc: 0.224 Test Loss: 3.220 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4032692
	speed: 0.1375s/iter; left time: 1870.6647s
Epoch: 12 cost time: 4.936387062072754
Epoch: 12, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.535 Vali Acc: 0.200 Test Loss: 3.535 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0774312
	speed: 0.1385s/iter; left time: 1862.7965s
Epoch: 13 cost time: 5.175133466720581
Epoch: 13, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.863 Vali Acc: 0.121 Test Loss: 3.863 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2338606
	speed: 0.1463s/iter; left time: 1946.0543s
Epoch: 14 cost time: 5.113379716873169
Epoch: 14, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.277 Vali Acc: 0.136 Test Loss: 3.277 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3602349
	speed: 0.1534s/iter; left time: 2016.3356s
Epoch: 15 cost time: 5.757628679275513
Epoch: 15, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.958 Vali Acc: 0.184 Test Loss: 3.958 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.5857397
	speed: 0.1482s/iter; left time: 1925.5559s
Epoch: 16 cost time: 5.274186849594116
Epoch: 16, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.631 Vali Acc: 0.123 Test Loss: 3.631 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3580697485806975
model parameter : 420390
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0969748
	speed: 0.0474s/iter; left time: 725.4547s
Epoch: 1 cost time: 6.391190528869629
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.190 Vali Acc: 0.315 Test Loss: 2.190 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0790877
	speed: 0.1408s/iter; left time: 2133.1786s
Epoch: 2 cost time: 5.317347764968872
Epoch: 2, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.186 Vali Acc: 0.316 Test Loss: 2.186 Test Acc: 0.316
Validation loss decreased (-0.315063 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3782196
	speed: 0.1419s/iter; left time: 2126.7852s
Epoch: 3 cost time: 4.808506727218628
Epoch: 3, Steps: 154 | Train Loss: 2.112 Vali Loss: 2.252 Vali Acc: 0.166 Test Loss: 2.252 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6077008
	speed: 0.1364s/iter; left time: 2024.4254s
Epoch: 4 cost time: 5.189265251159668
Epoch: 4, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.059 Vali Acc: 0.339 Test Loss: 2.059 Test Acc: 0.339
Validation loss decreased (-0.316280 --> -0.338990).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0670199
	speed: 0.1388s/iter; left time: 2038.3547s
Epoch: 5 cost time: 5.41495418548584
Epoch: 5, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.374 Vali Acc: 0.182 Test Loss: 2.374 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7746433
	speed: 0.1464s/iter; left time: 2126.7818s
Epoch: 6 cost time: 5.179303884506226
Epoch: 6, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.692 Vali Acc: 0.187 Test Loss: 2.692 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4644407
	speed: 0.1357s/iter; left time: 1950.7356s
Epoch: 7 cost time: 5.230280160903931
Epoch: 7, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.854 Vali Acc: 0.359 Test Loss: 2.854 Test Acc: 0.359
Validation loss decreased (-0.338990 --> -0.358852).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8336000
	speed: 0.1416s/iter; left time: 2013.8603s
Epoch: 8 cost time: 5.0163915157318115
Epoch: 8, Steps: 154 | Train Loss: 1.573 Vali Loss: 3.225 Vali Acc: 0.119 Test Loss: 3.225 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3571566
	speed: 0.1389s/iter; left time: 1954.5881s
Epoch: 9 cost time: 5.169828653335571
Epoch: 9, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.852 Vali Acc: 0.190 Test Loss: 2.852 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8436605
	speed: 0.1449s/iter; left time: 2015.9725s
Epoch: 10 cost time: 5.028131484985352
Epoch: 10, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.071 Vali Acc: 0.204 Test Loss: 3.071 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5090656
	speed: 0.1296s/iter; left time: 1783.5691s
Epoch: 11 cost time: 5.024332523345947
Epoch: 11, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.595 Vali Acc: 0.114 Test Loss: 3.595 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5209777
	speed: 0.1337s/iter; left time: 1819.8705s
Epoch: 12 cost time: 5.119067668914795
Epoch: 12, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.280 Vali Acc: 0.187 Test Loss: 3.280 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3224225
	speed: 0.1571s/iter; left time: 2113.0168s
Epoch: 13 cost time: 5.624273777008057
Epoch: 13, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.047 Vali Acc: 0.380 Test Loss: 3.047 Test Acc: 0.380
Validation loss decreased (-0.358852 --> -0.379937).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6216534
	speed: 0.1593s/iter; left time: 2118.6699s
Epoch: 14 cost time: 5.522656202316284
Epoch: 14, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.283 Vali Acc: 0.142 Test Loss: 3.283 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.8135784
	speed: 0.1560s/iter; left time: 2050.0860s
Epoch: 15 cost time: 5.434014797210693
Epoch: 15, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.268 Vali Acc: 0.204 Test Loss: 3.268 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6403866
	speed: 0.1540s/iter; left time: 2000.3103s
Epoch: 16 cost time: 5.246922492980957
Epoch: 16, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.182 Vali Acc: 0.127 Test Loss: 3.182 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8529437
	speed: 0.1595s/iter; left time: 2047.4270s
Epoch: 17 cost time: 5.4910173416137695
Epoch: 17, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.405 Vali Acc: 0.206 Test Loss: 3.405 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2705665
	speed: 0.1442s/iter; left time: 1829.3499s
Epoch: 18 cost time: 5.2225611209869385
Epoch: 18, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.528 Vali Acc: 0.202 Test Loss: 3.528 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1250141
	speed: 0.1485s/iter; left time: 1860.9390s
Epoch: 19 cost time: 5.619637489318848
Epoch: 19, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.562 Vali Acc: 0.150 Test Loss: 3.562 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2975484
	speed: 0.1699s/iter; left time: 2101.9020s
Epoch: 20 cost time: 6.136222839355469
Epoch: 20, Steps: 154 | Train Loss: 1.304 Vali Loss: 4.100 Vali Acc: 0.199 Test Loss: 4.100 Test Acc: 0.199
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.1519827
	speed: 0.1418s/iter; left time: 1732.5304s
Epoch: 21 cost time: 4.915573835372925
Epoch: 21, Steps: 154 | Train Loss: 1.303 Vali Loss: 3.542 Vali Acc: 0.129 Test Loss: 3.542 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.4667472
	speed: 0.1329s/iter; left time: 1603.2246s
Epoch: 22 cost time: 5.17320704460144
Epoch: 22, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.309 Vali Acc: 0.167 Test Loss: 3.309 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.4116881
	speed: 0.1429s/iter; left time: 1702.0293s
Epoch: 23 cost time: 4.869757890701294
Epoch: 23, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.878 Vali Acc: 0.131 Test Loss: 3.878 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 420198
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2191310
	speed: 0.0499s/iter; left time: 763.5850s
Epoch: 1 cost time: 6.55338191986084
Epoch: 1, Steps: 154 | Train Loss: 2.254 Vali Loss: 2.143 Vali Acc: 0.315 Test Loss: 2.143 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1135869
	speed: 0.1308s/iter; left time: 1981.8535s
Epoch: 2 cost time: 4.700232982635498
Epoch: 2, Steps: 154 | Train Loss: 2.151 Vali Loss: 2.207 Vali Acc: 0.316 Test Loss: 2.207 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8821052
	speed: 0.1544s/iter; left time: 2314.6445s
Epoch: 3 cost time: 5.88110089302063
Epoch: 3, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.207 Vali Acc: 0.324 Test Loss: 2.207 Test Acc: 0.324
Validation loss decreased (-0.315874 --> -0.324390).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9313276
	speed: 0.1454s/iter; left time: 2157.1794s
Epoch: 4 cost time: 4.870363712310791
Epoch: 4, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.135 Vali Acc: 0.339 Test Loss: 2.135 Test Acc: 0.339
Validation loss decreased (-0.324390 --> -0.338584).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7874200
	speed: 0.1333s/iter; left time: 1956.8073s
Epoch: 5 cost time: 5.104226112365723
Epoch: 5, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.263 Vali Acc: 0.190 Test Loss: 2.263 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1836607
	speed: 0.1365s/iter; left time: 1983.6758s
Epoch: 6 cost time: 5.048334360122681
Epoch: 6, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.327 Vali Acc: 0.351 Test Loss: 2.327 Test Acc: 0.351
Validation loss decreased (-0.338584 --> -0.350747).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9706563
	speed: 0.1454s/iter; left time: 2090.2630s
Epoch: 7 cost time: 5.37457799911499
Epoch: 7, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.518 Vali Acc: 0.200 Test Loss: 2.518 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7003745
	speed: 0.1492s/iter; left time: 2122.3182s
Epoch: 8 cost time: 5.212367057800293
Epoch: 8, Steps: 154 | Train Loss: 1.602 Vali Loss: 3.053 Vali Acc: 0.114 Test Loss: 3.053 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6696196
	speed: 0.1551s/iter; left time: 2181.7617s
Epoch: 9 cost time: 5.75194239616394
Epoch: 9, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.076 Vali Acc: 0.127 Test Loss: 3.076 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9031404
	speed: 0.1461s/iter; left time: 2033.0779s
Epoch: 10 cost time: 5.350531101226807
Epoch: 10, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.945 Vali Acc: 0.340 Test Loss: 2.945 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4443210
	speed: 0.1759s/iter; left time: 2420.8502s
Epoch: 11 cost time: 6.190772533416748
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.833 Vali Acc: 0.373 Test Loss: 2.833 Test Acc: 0.373
Validation loss decreased (-0.350747 --> -0.372640).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2970647
	speed: 0.1404s/iter; left time: 1909.8114s
Epoch: 12 cost time: 5.289348840713501
Epoch: 12, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.359 Vali Acc: 0.162 Test Loss: 3.359 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5568986
	speed: 0.1441s/iter; left time: 1938.2790s
Epoch: 13 cost time: 5.401833772659302
Epoch: 13, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.710 Vali Acc: 0.116 Test Loss: 3.710 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.7775446
	speed: 0.1449s/iter; left time: 1927.2861s
Epoch: 14 cost time: 5.514336109161377
Epoch: 14, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.960 Vali Acc: 0.368 Test Loss: 2.960 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2412375
	speed: 0.1605s/iter; left time: 2109.2863s
Epoch: 15 cost time: 5.512764930725098
Epoch: 15, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.948 Vali Acc: 0.214 Test Loss: 2.948 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4424571
	speed: 0.1484s/iter; left time: 1927.4056s
Epoch: 16 cost time: 4.9833903312683105
Epoch: 16, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.439 Vali Acc: 0.079 Test Loss: 3.439 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1768750
	speed: 0.1309s/iter; left time: 1679.9171s
Epoch: 17 cost time: 4.907317876815796
Epoch: 17, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.504 Vali Acc: 0.204 Test Loss: 3.504 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3698061
	speed: 0.1412s/iter; left time: 1791.1991s
Epoch: 18 cost time: 4.932386159896851
Epoch: 18, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.649 Vali Acc: 0.142 Test Loss: 3.649 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5305458
	speed: 0.1412s/iter; left time: 1769.0682s
Epoch: 19 cost time: 5.081860303878784
Epoch: 19, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.694 Vali Acc: 0.127 Test Loss: 3.694 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.5015657
	speed: 0.1385s/iter; left time: 1713.5931s
Epoch: 20 cost time: 5.473806142807007
Epoch: 20, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.574 Vali Acc: 0.205 Test Loss: 3.574 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.6384052
	speed: 0.1385s/iter; left time: 1692.6379s
Epoch: 21 cost time: 5.170284748077393
Epoch: 21, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.958 Vali Acc: 0.148 Test Loss: 2.958 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 321702
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1587601
	speed: 0.0484s/iter; left time: 740.1761s
Epoch: 1 cost time: 6.697919845581055
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.168 Vali Acc: 0.315 Test Loss: 2.168 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5320592
	speed: 0.1438s/iter; left time: 2178.7867s
Epoch: 2 cost time: 5.000458240509033
Epoch: 2, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.185 Vali Acc: 0.315 Test Loss: 2.185 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1062305
	speed: 0.1453s/iter; left time: 2177.8080s
Epoch: 3 cost time: 5.6606526374816895
Epoch: 3, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.157 Vali Acc: 0.321 Test Loss: 2.157 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2020023
	speed: 0.1459s/iter; left time: 2165.4516s
Epoch: 4 cost time: 4.70365571975708
Epoch: 4, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.135 Vali Acc: 0.328 Test Loss: 2.135 Test Acc: 0.328
Validation loss decreased (-0.320741 --> -0.328446).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2001784
	speed: 0.1274s/iter; left time: 1871.0383s
Epoch: 5 cost time: 5.1850669384002686
Epoch: 5, Steps: 154 | Train Loss: 1.886 Vali Loss: 2.264 Vali Acc: 0.186 Test Loss: 2.264 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5091190
	speed: 0.1493s/iter; left time: 2169.0689s
Epoch: 6 cost time: 5.6745545864105225
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.267 Vali Acc: 0.191 Test Loss: 2.267 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4713515
	speed: 0.1571s/iter; left time: 2258.8656s
Epoch: 7 cost time: 5.568696737289429
Epoch: 7, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.706 Vali Acc: 0.192 Test Loss: 2.706 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9051224
	speed: 0.1498s/iter; left time: 2129.9817s
Epoch: 8 cost time: 5.10857892036438
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.920 Vali Acc: 0.193 Test Loss: 2.920 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8543577
	speed: 0.1528s/iter; left time: 2149.9671s
Epoch: 9 cost time: 5.300691366195679
Epoch: 9, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.693 Vali Acc: 0.377 Test Loss: 2.693 Test Acc: 0.377
Validation loss decreased (-0.328446 --> -0.376697).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9593071
	speed: 0.1493s/iter; left time: 2077.0968s
Epoch: 10 cost time: 5.576477527618408
Epoch: 10, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.374 Vali Acc: 0.118 Test Loss: 3.374 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3927220
	speed: 0.1528s/iter; left time: 2102.0219s
Epoch: 11 cost time: 5.806965112686157
Epoch: 11, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.852 Vali Acc: 0.219 Test Loss: 2.852 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9234946
	speed: 0.1510s/iter; left time: 2054.2097s
Epoch: 12 cost time: 5.298413038253784
Epoch: 12, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.220 Vali Acc: 0.130 Test Loss: 3.220 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6761960
	speed: 0.1475s/iter; left time: 1984.6351s
Epoch: 13 cost time: 5.2054524421691895
Epoch: 13, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.457 Vali Acc: 0.200 Test Loss: 3.457 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.1664838
	speed: 0.1440s/iter; left time: 1915.3770s
Epoch: 14 cost time: 4.802488565444946
Epoch: 14, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.871 Vali Acc: 0.108 Test Loss: 3.871 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.2993710
	speed: 0.1404s/iter; left time: 1845.1242s
Epoch: 15 cost time: 4.74196195602417
Epoch: 15, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.694 Vali Acc: 0.124 Test Loss: 3.694 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0391867
	speed: 0.1337s/iter; left time: 1736.5807s
Epoch: 16 cost time: 4.441512823104858
Epoch: 16, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.603 Vali Acc: 0.100 Test Loss: 3.603 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.1957548
	speed: 0.1159s/iter; left time: 1487.1776s
Epoch: 17 cost time: 4.750139951705933
Epoch: 17, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.037 Vali Acc: 0.211 Test Loss: 3.037 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.7406914
	speed: 0.1321s/iter; left time: 1674.8456s
Epoch: 18 cost time: 4.839391231536865
Epoch: 18, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.908 Vali Acc: 0.123 Test Loss: 3.908 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.0137316
	speed: 0.1463s/iter; left time: 1832.7966s
Epoch: 19 cost time: 5.069064378738403
Epoch: 19, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.870 Vali Acc: 0.118 Test Loss: 3.870 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 321510
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2635210
	speed: 0.0466s/iter; left time: 712.7776s
Epoch: 1 cost time: 6.533976078033447
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8067943
	speed: 0.1383s/iter; left time: 2095.1356s
Epoch: 2 cost time: 4.592700719833374
Epoch: 2, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.137 Vali Acc: 0.315 Test Loss: 2.137 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9970535
	speed: 0.1361s/iter; left time: 2040.2777s
Epoch: 3 cost time: 5.0831122398376465
Epoch: 3, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.287 Vali Acc: 0.319 Test Loss: 2.287 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.318712).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3369346
	speed: 0.1367s/iter; left time: 2027.9452s
Epoch: 4 cost time: 5.109823942184448
Epoch: 4, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.125 Vali Acc: 0.335 Test Loss: 2.125 Test Acc: 0.335
Validation loss decreased (-0.318712 --> -0.334934).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9900934
	speed: 0.1375s/iter; left time: 2019.8243s
Epoch: 5 cost time: 5.0005784034729
Epoch: 5, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.342 Vali Acc: 0.330 Test Loss: 2.342 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4637129
	speed: 0.1440s/iter; left time: 2092.1236s
Epoch: 6 cost time: 5.407487154006958
Epoch: 6, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.781 Vali Acc: 0.181 Test Loss: 2.781 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1656055
	speed: 0.1578s/iter; left time: 2269.0944s
Epoch: 7 cost time: 5.997441053390503
Epoch: 7, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.416 Vali Acc: 0.379 Test Loss: 2.416 Test Acc: 0.379
Validation loss decreased (-0.334934 --> -0.378727).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6643687
	speed: 0.1470s/iter; left time: 2090.4049s
Epoch: 8 cost time: 5.516541242599487
Epoch: 8, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.542 Vali Acc: 0.204 Test Loss: 2.542 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3985529
	speed: 0.1526s/iter; left time: 2147.4177s
Epoch: 9 cost time: 5.209683418273926
Epoch: 9, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.054 Vali Acc: 0.193 Test Loss: 3.054 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0301905
	speed: 0.1486s/iter; left time: 2068.1382s
Epoch: 10 cost time: 5.967090368270874
Epoch: 10, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.322 Vali Acc: 0.188 Test Loss: 3.322 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2370275
	speed: 0.1549s/iter; left time: 2132.1516s
Epoch: 11 cost time: 5.678203582763672
Epoch: 11, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.769 Vali Acc: 0.114 Test Loss: 3.769 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2794366
	speed: 0.1492s/iter; left time: 2029.5390s
Epoch: 12 cost time: 5.177198648452759
Epoch: 12, Steps: 154 | Train Loss: 1.473 Vali Loss: 3.292 Vali Acc: 0.146 Test Loss: 3.292 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2777203
	speed: 0.1348s/iter; left time: 1812.8270s
Epoch: 13 cost time: 4.813812971115112
Epoch: 13, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.508 Vali Acc: 0.118 Test Loss: 3.508 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5379522
	speed: 0.1416s/iter; left time: 1882.9568s
Epoch: 14 cost time: 5.45896577835083
Epoch: 14, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.482 Vali Acc: 0.145 Test Loss: 3.482 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5607444
	speed: 0.1408s/iter; left time: 1850.2951s
Epoch: 15 cost time: 5.169925212860107
Epoch: 15, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.388 Vali Acc: 0.138 Test Loss: 3.388 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0468967
	speed: 0.1406s/iter; left time: 1826.0810s
Epoch: 16 cost time: 5.115460157394409
Epoch: 16, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.665 Vali Acc: 0.129 Test Loss: 3.665 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.0189505
	speed: 0.1403s/iter; left time: 1801.4228s
Epoch: 17 cost time: 5.953550815582275
Epoch: 17, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.992 Vali Acc: 0.144 Test Loss: 2.992 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 321318
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8045050
	speed: 0.0468s/iter; left time: 716.8074s
Epoch: 1 cost time: 6.369895935058594
Epoch: 1, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.200 Vali Acc: 0.315 Test Loss: 2.200 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9784205
	speed: 0.1396s/iter; left time: 2114.4661s
Epoch: 2 cost time: 4.773905277252197
Epoch: 2, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2989438
	speed: 0.1400s/iter; left time: 2098.6891s
Epoch: 3 cost time: 5.707819700241089
Epoch: 3, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.155 Vali Acc: 0.319 Test Loss: 2.155 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3745077
	speed: 0.1485s/iter; left time: 2204.3045s
Epoch: 4 cost time: 4.894404888153076
Epoch: 4, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.200 Vali Acc: 0.333 Test Loss: 2.200 Test Acc: 0.333
Validation loss decreased (-0.319119 --> -0.332500).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1006675
	speed: 0.1442s/iter; left time: 2117.2672s
Epoch: 5 cost time: 5.2433953285217285
Epoch: 5, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.341 Vali Acc: 0.179 Test Loss: 2.341 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3321350
	speed: 0.1530s/iter; left time: 2223.4285s
Epoch: 6 cost time: 6.4172203540802
Epoch: 6, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.411 Vali Acc: 0.275 Test Loss: 2.411 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5073191
	speed: 0.1603s/iter; left time: 2304.1247s
Epoch: 7 cost time: 5.726496696472168
Epoch: 7, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.918 Vali Acc: 0.175 Test Loss: 2.918 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3236411
	speed: 0.1521s/iter; left time: 2163.5365s
Epoch: 8 cost time: 5.269940376281738
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 3.333 Vali Acc: 0.142 Test Loss: 3.333 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6249803
	speed: 0.1566s/iter; left time: 2203.0775s
Epoch: 9 cost time: 5.418406248092651
Epoch: 9, Steps: 154 | Train Loss: 1.547 Vali Loss: 3.175 Vali Acc: 0.134 Test Loss: 3.175 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5310708
	speed: 0.1541s/iter; left time: 2143.7329s
Epoch: 10 cost time: 5.73775315284729
Epoch: 10, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.980 Vali Acc: 0.361 Test Loss: 2.980 Test Acc: 0.361
Validation loss decreased (-0.332500 --> -0.361284).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3393474
	speed: 0.1593s/iter; left time: 2191.8051s
Epoch: 11 cost time: 5.661803483963013
Epoch: 11, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.712 Vali Acc: 0.138 Test Loss: 2.712 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8547965
	speed: 0.1496s/iter; left time: 2035.3480s
Epoch: 12 cost time: 5.125735282897949
Epoch: 12, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.759 Vali Acc: 0.108 Test Loss: 3.759 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5269715
	speed: 0.1591s/iter; left time: 2140.3673s
Epoch: 13 cost time: 5.874549627304077
Epoch: 13, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.562 Vali Acc: 0.122 Test Loss: 3.562 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.1471450
	speed: 0.1506s/iter; left time: 2002.7698s
Epoch: 14 cost time: 5.486603021621704
Epoch: 14, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.704 Vali Acc: 0.162 Test Loss: 3.704 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0504231
	speed: 0.1418s/iter; left time: 1864.2411s
Epoch: 15 cost time: 4.759318113327026
Epoch: 15, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.503 Vali Acc: 0.126 Test Loss: 3.503 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3217229
	speed: 0.1394s/iter; left time: 1811.5908s
Epoch: 16 cost time: 5.31951379776001
Epoch: 16, Steps: 154 | Train Loss: 1.377 Vali Loss: 4.074 Vali Acc: 0.118 Test Loss: 4.074 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5738206
	speed: 0.1474s/iter; left time: 1891.8134s
Epoch: 17 cost time: 5.569594383239746
Epoch: 17, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.140 Vali Acc: 0.088 Test Loss: 3.140 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.7559474
	speed: 0.1504s/iter; left time: 1907.8764s
Epoch: 18 cost time: 5.3184802532196045
Epoch: 18, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.019 Vali Acc: 0.210 Test Loss: 3.019 Test Acc: 0.210
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.4242272
	speed: 0.1462s/iter; left time: 1832.0059s
Epoch: 19 cost time: 5.141965389251709
Epoch: 19, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.786 Vali Acc: 0.219 Test Loss: 2.786 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 2.0762300
	speed: 0.1471s/iter; left time: 1820.4865s
Epoch: 20 cost time: 5.475423812866211
Epoch: 20, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.841 Vali Acc: 0.123 Test Loss: 3.841 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3613138686131387
model parameter : 321126
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9452177
	speed: 0.0478s/iter; left time: 731.8101s
Epoch: 1 cost time: 6.350001335144043
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8741963
	speed: 0.1330s/iter; left time: 2014.3715s
Epoch: 2 cost time: 5.057668924331665
Epoch: 2, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.249 Vali Acc: 0.316 Test Loss: 2.249 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8382907
	speed: 0.1476s/iter; left time: 2212.8859s
Epoch: 3 cost time: 4.946955919265747
Epoch: 3, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.184 Vali Acc: 0.320 Test Loss: 2.184 Test Acc: 0.320
Validation loss decreased (-0.315874 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9273582
	speed: 0.1409s/iter; left time: 2091.5341s
Epoch: 4 cost time: 5.119266748428345
Epoch: 4, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.176 Vali Acc: 0.338 Test Loss: 2.176 Test Acc: 0.338
Validation loss decreased (-0.319524 --> -0.337772).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0991616
	speed: 0.1407s/iter; left time: 2066.2083s
Epoch: 5 cost time: 5.113258123397827
Epoch: 5, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.204 Vali Acc: 0.189 Test Loss: 2.204 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3753629
	speed: 0.1608s/iter; left time: 2336.9753s
Epoch: 6 cost time: 5.695741891860962
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.197 Vali Acc: 0.372 Test Loss: 2.197 Test Acc: 0.372
Validation loss decreased (-0.337772 --> -0.372241).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7029686
	speed: 0.1456s/iter; left time: 2092.6848s
Epoch: 7 cost time: 4.807422637939453
Epoch: 7, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.844 Vali Acc: 0.183 Test Loss: 2.844 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1288925
	speed: 0.1198s/iter; left time: 1703.2849s
Epoch: 8 cost time: 4.50578761100769
Epoch: 8, Steps: 154 | Train Loss: 1.564 Vali Loss: 3.583 Vali Acc: 0.109 Test Loss: 3.583 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4990715
	speed: 0.1167s/iter; left time: 1641.2131s
Epoch: 9 cost time: 4.772677183151245
Epoch: 9, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.674 Vali Acc: 0.218 Test Loss: 2.674 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0330224
	speed: 0.1385s/iter; left time: 1927.6844s
Epoch: 10 cost time: 5.245847940444946
Epoch: 10, Steps: 154 | Train Loss: 1.516 Vali Loss: 3.422 Vali Acc: 0.065 Test Loss: 3.422 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5192956
	speed: 0.1470s/iter; left time: 2022.7990s
Epoch: 11 cost time: 6.072867155075073
Epoch: 11, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.929 Vali Acc: 0.216 Test Loss: 2.929 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.9156296
	speed: 0.1572s/iter; left time: 2138.5387s
Epoch: 12 cost time: 5.514803171157837
Epoch: 12, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.503 Vali Acc: 0.117 Test Loss: 3.503 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6231611
	speed: 0.1346s/iter; left time: 1810.9925s
Epoch: 13 cost time: 5.049540758132935
Epoch: 13, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.370 Vali Acc: 0.206 Test Loss: 3.370 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.0073618
	speed: 0.1338s/iter; left time: 1779.0192s
Epoch: 14 cost time: 4.588058233261108
Epoch: 14, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.510 Vali Acc: 0.079 Test Loss: 3.510 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3433112
	speed: 0.1358s/iter; left time: 1784.8041s
Epoch: 15 cost time: 5.328761339187622
Epoch: 15, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.874 Vali Acc: 0.145 Test Loss: 3.874 Test Acc: 0.145
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0622038
	speed: 0.1436s/iter; left time: 1865.3114s
Epoch: 16 cost time: 5.2035956382751465
Epoch: 16, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.562 Vali Acc: 0.128 Test Loss: 3.562 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 272166
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9496050
	speed: 0.0502s/iter; left time: 768.0327s
Epoch: 1 cost time: 6.847069978713989
Epoch: 1, Steps: 154 | Train Loss: 2.235 Vali Loss: 2.213 Vali Acc: 0.315 Test Loss: 2.213 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4702239
	speed: 0.1502s/iter; left time: 2274.6890s
Epoch: 2 cost time: 5.284989833831787
Epoch: 2, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.195 Vali Acc: 0.158 Test Loss: 2.195 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3845487
	speed: 0.1541s/iter; left time: 2310.8068s
Epoch: 3 cost time: 5.091402530670166
Epoch: 3, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.118 Vali Acc: 0.323 Test Loss: 2.118 Test Acc: 0.323
Validation loss decreased (-0.315469 --> -0.322769).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1773651
	speed: 0.1352s/iter; left time: 2006.3949s
Epoch: 4 cost time: 5.03027081489563
Epoch: 4, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.161 Vali Acc: 0.326 Test Loss: 2.161 Test Acc: 0.326
Validation loss decreased (-0.322769 --> -0.326012).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7032351
	speed: 0.1371s/iter; left time: 2012.7998s
Epoch: 5 cost time: 5.049680709838867
Epoch: 5, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.127 Vali Acc: 0.191 Test Loss: 2.127 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3166510
	speed: 0.1489s/iter; left time: 2163.1523s
Epoch: 6 cost time: 5.370543718338013
Epoch: 6, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.583 Vali Acc: 0.190 Test Loss: 2.583 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5923891
	speed: 0.1513s/iter; left time: 2175.6724s
Epoch: 7 cost time: 5.200397253036499
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.668 Vali Acc: 0.139 Test Loss: 2.668 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2883052
	speed: 0.1632s/iter; left time: 2321.8359s
Epoch: 8 cost time: 5.863701343536377
Epoch: 8, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.844 Vali Acc: 0.191 Test Loss: 2.844 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4702524
	speed: 0.1524s/iter; left time: 2143.4943s
Epoch: 9 cost time: 5.635612487792969
Epoch: 9, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.767 Vali Acc: 0.195 Test Loss: 2.767 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3035746
	speed: 0.1548s/iter; left time: 2153.6205s
Epoch: 10 cost time: 5.142781019210815
Epoch: 10, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.864 Vali Acc: 0.137 Test Loss: 2.864 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6026357
	speed: 0.1503s/iter; left time: 2067.8291s
Epoch: 11 cost time: 5.5176801681518555
Epoch: 11, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.066 Vali Acc: 0.197 Test Loss: 3.066 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2106470
	speed: 0.1560s/iter; left time: 2123.3710s
Epoch: 12 cost time: 5.716592073440552
Epoch: 12, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.792 Vali Acc: 0.374 Test Loss: 2.792 Test Acc: 0.374
Validation loss decreased (-0.326012 --> -0.373857).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8419681
	speed: 0.1562s/iter; left time: 2100.8702s
Epoch: 13 cost time: 5.878970146179199
Epoch: 13, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.948 Vali Acc: 0.160 Test Loss: 2.948 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2734249
	speed: 0.1541s/iter; left time: 2049.9608s
Epoch: 14 cost time: 5.426482439041138
Epoch: 14, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.890 Vali Acc: 0.365 Test Loss: 2.890 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4069136
	speed: 0.1599s/iter; left time: 2101.4869s
Epoch: 15 cost time: 5.413135766983032
Epoch: 15, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.078 Vali Acc: 0.369 Test Loss: 3.078 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.8357127
	speed: 0.1530s/iter; left time: 1988.2294s
Epoch: 16 cost time: 5.687640905380249
Epoch: 16, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.862 Vali Acc: 0.391 Test Loss: 2.862 Test Acc: 0.391
Validation loss decreased (-0.373857 --> -0.391293).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6527131
	speed: 0.1427s/iter; left time: 1831.5509s
Epoch: 17 cost time: 5.177743196487427
Epoch: 17, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.311 Vali Acc: 0.160 Test Loss: 3.311 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1591655
	speed: 0.1448s/iter; left time: 1836.5982s
Epoch: 18 cost time: 5.586537837982178
Epoch: 18, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.003 Vali Acc: 0.270 Test Loss: 3.003 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4655133
	speed: 0.1427s/iter; left time: 1788.0058s
Epoch: 19 cost time: 5.508630990982056
Epoch: 19, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.054 Vali Acc: 0.179 Test Loss: 3.054 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.1744714
	speed: 0.1545s/iter; left time: 1912.0054s
Epoch: 20 cost time: 4.947346448898315
Epoch: 20, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.136 Vali Acc: 0.218 Test Loss: 3.136 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4791521
	speed: 0.1476s/iter; left time: 1804.2390s
Epoch: 21 cost time: 5.533239126205444
Epoch: 21, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.906 Vali Acc: 0.219 Test Loss: 2.906 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6566257
	speed: 0.1424s/iter; left time: 1718.2263s
Epoch: 22 cost time: 5.075048923492432
Epoch: 22, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.872 Vali Acc: 0.230 Test Loss: 2.872 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.9763412
	speed: 0.1464s/iter; left time: 1744.1075s
Epoch: 23 cost time: 5.3143932819366455
Epoch: 23, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.041 Vali Acc: 0.208 Test Loss: 3.041 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.0173796
	speed: 0.1526s/iter; left time: 1794.7845s
Epoch: 24 cost time: 5.655891418457031
Epoch: 24, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.366 Vali Acc: 0.084 Test Loss: 3.366 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.1645678
	speed: 0.1445s/iter; left time: 1676.4391s
Epoch: 25 cost time: 4.76338267326355
Epoch: 25, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.367 Vali Acc: 0.090 Test Loss: 3.367 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.4571241
	speed: 0.1433s/iter; left time: 1641.2609s
Epoch: 26 cost time: 5.542520761489868
Epoch: 26, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.104 Vali Acc: 0.117 Test Loss: 3.104 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 271974
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4740431
	speed: 0.0550s/iter; left time: 841.7545s
Epoch: 1 cost time: 7.314918041229248
Epoch: 1, Steps: 154 | Train Loss: 2.186 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9805551
	speed: 0.1607s/iter; left time: 2434.4468s
Epoch: 2 cost time: 5.59310245513916
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.171 Vali Acc: 0.317 Test Loss: 2.171 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8119090
	speed: 0.1537s/iter; left time: 2304.0572s
Epoch: 3 cost time: 5.305424213409424
Epoch: 3, Steps: 154 | Train Loss: 2.101 Vali Loss: 2.174 Vali Acc: 0.162 Test Loss: 2.174 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9618661
	speed: 0.1686s/iter; left time: 2502.2815s
Epoch: 4 cost time: 6.097377777099609
Epoch: 4, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.168 Vali Acc: 0.335 Test Loss: 2.168 Test Acc: 0.335
Validation loss decreased (-0.316686 --> -0.334934).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7519958
	speed: 0.1612s/iter; left time: 2366.7053s
Epoch: 5 cost time: 5.6007399559021
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.105 Vali Acc: 0.193 Test Loss: 2.105 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7540421
	speed: 0.1589s/iter; left time: 2308.2872s
Epoch: 6 cost time: 6.279370546340942
Epoch: 6, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.507 Vali Acc: 0.195 Test Loss: 2.507 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3178508
	speed: 0.1655s/iter; left time: 2379.9755s
Epoch: 7 cost time: 5.664443492889404
Epoch: 7, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.629 Vali Acc: 0.214 Test Loss: 2.629 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8035884
	speed: 0.1520s/iter; left time: 2161.8990s
Epoch: 8 cost time: 5.221689224243164
Epoch: 8, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.653 Vali Acc: 0.202 Test Loss: 2.653 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.9404999
	speed: 0.1466s/iter; left time: 2062.2860s
Epoch: 9 cost time: 5.108274936676025
Epoch: 9, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.628 Vali Acc: 0.204 Test Loss: 2.628 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.6492449
	speed: 0.1421s/iter; left time: 1977.5440s
Epoch: 10 cost time: 5.480299949645996
Epoch: 10, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.403 Vali Acc: 0.193 Test Loss: 3.403 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1369723
	speed: 0.1400s/iter; left time: 1926.6805s
Epoch: 11 cost time: 5.0080482959747314
Epoch: 11, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.845 Vali Acc: 0.206 Test Loss: 2.845 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.8668388
	speed: 0.1421s/iter; left time: 1933.3805s
Epoch: 12 cost time: 5.357078790664673
Epoch: 12, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.134 Vali Acc: 0.262 Test Loss: 3.134 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3534197
	speed: 0.1487s/iter; left time: 2000.9936s
Epoch: 13 cost time: 5.579593658447266
Epoch: 13, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.724 Vali Acc: 0.196 Test Loss: 3.724 Test Acc: 0.196
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3723183
	speed: 0.1505s/iter; left time: 2001.7796s
Epoch: 14 cost time: 5.2887794971466064
Epoch: 14, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.122 Vali Acc: 0.207 Test Loss: 3.122 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33495539334955393
model parameter : 271782
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9282348
	speed: 0.0437s/iter; left time: 668.6349s
Epoch: 1 cost time: 5.819140672683716
Epoch: 1, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3044310
	speed: 0.1402s/iter; left time: 2123.2985s
Epoch: 2 cost time: 4.994211435317993
Epoch: 2, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.218 Vali Acc: 0.156 Test Loss: 2.218 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1612470
	speed: 0.1394s/iter; left time: 2090.6887s
Epoch: 3 cost time: 5.116365432739258
Epoch: 3, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.136 Vali Acc: 0.322 Test Loss: 2.136 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1262338
	speed: 0.1518s/iter; left time: 2252.8668s
Epoch: 4 cost time: 5.664095640182495
Epoch: 4, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.244 Vali Acc: 0.328 Test Loss: 2.244 Test Acc: 0.328
Validation loss decreased (-0.321552 --> -0.328039).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0712740
	speed: 0.1614s/iter; left time: 2370.4810s
Epoch: 5 cost time: 5.674506187438965
Epoch: 5, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.076 Vali Acc: 0.327 Test Loss: 2.076 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9789077
	speed: 0.1673s/iter; left time: 2430.8735s
Epoch: 6 cost time: 5.372607469558716
Epoch: 6, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.376 Vali Acc: 0.361 Test Loss: 2.376 Test Acc: 0.361
Validation loss decreased (-0.328039 --> -0.360885).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1865778
	speed: 0.1498s/iter; left time: 2153.7820s
Epoch: 7 cost time: 5.369740724563599
Epoch: 7, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.442 Vali Acc: 0.200 Test Loss: 2.442 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2463405
	speed: 0.1494s/iter; left time: 2124.6648s
Epoch: 8 cost time: 5.735801935195923
Epoch: 8, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.756 Vali Acc: 0.214 Test Loss: 2.756 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9154564
	speed: 0.1618s/iter; left time: 2276.5981s
Epoch: 9 cost time: 6.115783452987671
Epoch: 9, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.954 Vali Acc: 0.193 Test Loss: 2.954 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1190106
	speed: 0.1571s/iter; left time: 2186.3197s
Epoch: 10 cost time: 5.624817371368408
Epoch: 10, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.498 Vali Acc: 0.111 Test Loss: 3.498 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3976744
	speed: 0.1564s/iter; left time: 2152.8264s
Epoch: 11 cost time: 5.069313287734985
Epoch: 11, Steps: 154 | Train Loss: 1.497 Vali Loss: 3.618 Vali Acc: 0.134 Test Loss: 3.618 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2872376
	speed: 0.1558s/iter; left time: 2119.9677s
Epoch: 12 cost time: 5.402399301528931
Epoch: 12, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.980 Vali Acc: 0.228 Test Loss: 2.980 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3655024
	speed: 0.1485s/iter; left time: 1997.4042s
Epoch: 13 cost time: 5.4679858684539795
Epoch: 13, Steps: 154 | Train Loss: 1.456 Vali Loss: 4.053 Vali Acc: 0.069 Test Loss: 4.053 Test Acc: 0.069
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.8253809
	speed: 0.1487s/iter; left time: 1977.2494s
Epoch: 14 cost time: 5.1210644245147705
Epoch: 14, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.469 Vali Acc: 0.122 Test Loss: 3.469 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.0445721
	speed: 0.1343s/iter; left time: 1764.7418s
Epoch: 15 cost time: 4.811309576034546
Epoch: 15, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.912 Vali Acc: 0.128 Test Loss: 3.912 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9095440
	speed: 0.1374s/iter; left time: 1784.9461s
Epoch: 16 cost time: 4.826653480529785
Epoch: 16, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.297 Vali Acc: 0.183 Test Loss: 3.297 Test Acc: 0.183
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 271590
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9936783
	speed: 0.0502s/iter; left time: 768.2546s
Epoch: 1 cost time: 7.036214113235474
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6826562
	speed: 0.1512s/iter; left time: 2290.0541s
Epoch: 2 cost time: 5.535228252410889
Epoch: 2, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.148 Vali Acc: 0.315 Test Loss: 2.148 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2264082
	speed: 0.1451s/iter; left time: 2175.3207s
Epoch: 3 cost time: 5.0712668895721436
Epoch: 3, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.128 Vali Acc: 0.319 Test Loss: 2.128 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.318714).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1437223
	speed: 0.1384s/iter; left time: 2053.8018s
Epoch: 4 cost time: 4.7965614795684814
Epoch: 4, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.175 Vali Acc: 0.326 Test Loss: 2.175 Test Acc: 0.326
Validation loss decreased (-0.318714 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7500745
	speed: 0.1465s/iter; left time: 2151.0625s
Epoch: 5 cost time: 4.952654600143433
Epoch: 5, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.065 Vali Acc: 0.351 Test Loss: 2.065 Test Acc: 0.351
Validation loss decreased (-0.325607 --> -0.350750).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0136135
	speed: 0.1381s/iter; left time: 2006.7042s
Epoch: 6 cost time: 5.314314126968384
Epoch: 6, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.503 Vali Acc: 0.343 Test Loss: 2.503 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5581839
	speed: 0.1567s/iter; left time: 2253.2117s
Epoch: 7 cost time: 5.994436740875244
Epoch: 7, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.580 Vali Acc: 0.194 Test Loss: 2.580 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5467532
	speed: 0.1503s/iter; left time: 2138.1740s
Epoch: 8 cost time: 5.410833358764648
Epoch: 8, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.431 Vali Acc: 0.364 Test Loss: 2.431 Test Acc: 0.364
Validation loss decreased (-0.350750 --> -0.363723).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7628764
	speed: 0.1629s/iter; left time: 2291.4722s
Epoch: 9 cost time: 5.7021379470825195
Epoch: 9, Steps: 154 | Train Loss: 1.619 Vali Loss: 3.227 Vali Acc: 0.118 Test Loss: 3.227 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3060330
	speed: 0.1604s/iter; left time: 2231.4574s
Epoch: 10 cost time: 5.653269290924072
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 3.026 Vali Acc: 0.110 Test Loss: 3.026 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4290230
	speed: 0.1536s/iter; left time: 2113.2982s
Epoch: 11 cost time: 5.619192361831665
Epoch: 11, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.233 Vali Acc: 0.265 Test Loss: 3.233 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8512864
	speed: 0.1673s/iter; left time: 2276.3255s
Epoch: 12 cost time: 6.282078266143799
Epoch: 12, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.876 Vali Acc: 0.366 Test Loss: 2.876 Test Acc: 0.366
Validation loss decreased (-0.363723 --> -0.366151).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8578084
	speed: 0.1610s/iter; left time: 2165.9375s
Epoch: 13 cost time: 5.644243240356445
Epoch: 13, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.437 Vali Acc: 0.362 Test Loss: 3.437 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5174931
	speed: 0.1610s/iter; left time: 2140.8687s
Epoch: 14 cost time: 6.022260665893555
Epoch: 14, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.189 Vali Acc: 0.345 Test Loss: 3.189 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3325607
	speed: 0.1541s/iter; left time: 2025.0834s
Epoch: 15 cost time: 5.428111791610718
Epoch: 15, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.424 Vali Acc: 0.154 Test Loss: 3.424 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6063758
	speed: 0.1478s/iter; left time: 1919.6124s
Epoch: 16 cost time: 5.286815404891968
Epoch: 16, Steps: 154 | Train Loss: 1.387 Vali Loss: 3.404 Vali Acc: 0.155 Test Loss: 3.404 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5735449
	speed: 0.1433s/iter; left time: 1839.1423s
Epoch: 17 cost time: 4.803033351898193
Epoch: 17, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.699 Vali Acc: 0.099 Test Loss: 3.699 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.7685175
	speed: 0.1325s/iter; left time: 1680.5040s
Epoch: 18 cost time: 4.897681951522827
Epoch: 18, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.477 Vali Acc: 0.162 Test Loss: 3.477 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4640296
	speed: 0.1397s/iter; left time: 1750.8092s
Epoch: 19 cost time: 4.979001760482788
Epoch: 19, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.733 Vali Acc: 0.123 Test Loss: 3.733 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.7773438
	speed: 0.1575s/iter; left time: 1949.1390s
Epoch: 20 cost time: 5.636310338973999
Epoch: 20, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.953 Vali Acc: 0.120 Test Loss: 3.953 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3231715
	speed: 0.1471s/iter; left time: 1798.0293s
Epoch: 21 cost time: 5.257375240325928
Epoch: 21, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.678 Vali Acc: 0.115 Test Loss: 3.678 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.0436180
	speed: 0.1465s/iter; left time: 1767.4884s
Epoch: 22 cost time: 5.301146507263184
Epoch: 22, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.655 Vali Acc: 0.121 Test Loss: 3.655 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 261862
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2445395
	speed: 0.0503s/iter; left time: 768.9439s
Epoch: 1 cost time: 6.7370991706848145
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 2.177 Vali Acc: 0.315 Test Loss: 2.177 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8369008
	speed: 0.1490s/iter; left time: 2256.3793s
Epoch: 2 cost time: 4.9865663051605225
Epoch: 2, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.172 Vali Acc: 0.315 Test Loss: 2.172 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3337016
	speed: 0.1520s/iter; left time: 2279.2517s
Epoch: 3 cost time: 5.5446929931640625
Epoch: 3, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
Validation loss decreased (-0.315063 --> -0.321146).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8973740
	speed: 0.1615s/iter; left time: 2397.0061s
Epoch: 4 cost time: 5.775805950164795
Epoch: 4, Steps: 154 | Train Loss: 2.009 Vali Loss: 2.107 Vali Acc: 0.325 Test Loss: 2.107 Test Acc: 0.325
Validation loss decreased (-0.321146 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2098687
	speed: 0.1578s/iter; left time: 2317.5522s
Epoch: 5 cost time: 5.779355525970459
Epoch: 5, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.091 Vali Acc: 0.336 Test Loss: 2.091 Test Acc: 0.336
Validation loss decreased (-0.324796 --> -0.336151).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5117960
	speed: 0.1533s/iter; left time: 2227.6940s
Epoch: 6 cost time: 5.343271017074585
Epoch: 6, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.418 Vali Acc: 0.180 Test Loss: 2.418 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8045204
	speed: 0.1565s/iter; left time: 2249.4564s
Epoch: 7 cost time: 5.743698596954346
Epoch: 7, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.407 Vali Acc: 0.356 Test Loss: 2.407 Test Acc: 0.356
Validation loss decreased (-0.336151 --> -0.355613).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5864208
	speed: 0.1519s/iter; left time: 2159.8639s
Epoch: 8 cost time: 5.415961980819702
Epoch: 8, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.519 Vali Acc: 0.198 Test Loss: 2.519 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5908655
	speed: 0.1618s/iter; left time: 2275.9312s
Epoch: 9 cost time: 5.724939823150635
Epoch: 9, Steps: 154 | Train Loss: 1.601 Vali Loss: 3.114 Vali Acc: 0.120 Test Loss: 3.114 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2904958
	speed: 0.1597s/iter; left time: 2221.9196s
Epoch: 10 cost time: 6.325533390045166
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.985 Vali Acc: 0.115 Test Loss: 2.985 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1578910
	speed: 0.1580s/iter; left time: 2173.6274s
Epoch: 11 cost time: 5.392420530319214
Epoch: 11, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.962 Vali Acc: 0.201 Test Loss: 2.962 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7010945
	speed: 0.1268s/iter; left time: 1724.9223s
Epoch: 12 cost time: 4.344289064407349
Epoch: 12, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.080 Vali Acc: 0.194 Test Loss: 3.080 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1623828
	speed: 0.1212s/iter; left time: 1630.1425s
Epoch: 13 cost time: 4.515739440917969
Epoch: 13, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.750 Vali Acc: 0.233 Test Loss: 2.750 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3943982
	speed: 0.1361s/iter; left time: 1810.4590s
Epoch: 14 cost time: 5.136679649353027
Epoch: 14, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.467 Vali Acc: 0.144 Test Loss: 3.467 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.7213186
	speed: 0.1377s/iter; left time: 1809.4802s
Epoch: 15 cost time: 5.248148202896118
Epoch: 15, Steps: 154 | Train Loss: 1.429 Vali Loss: 3.287 Vali Acc: 0.161 Test Loss: 3.287 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.5911398
	speed: 0.1537s/iter; left time: 1997.2197s
Epoch: 16 cost time: 5.879721641540527
Epoch: 16, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.425 Vali Acc: 0.187 Test Loss: 3.425 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1323928
	speed: 0.1520s/iter; left time: 1951.6469s
Epoch: 17 cost time: 5.74634313583374
Epoch: 17, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.235 Vali Acc: 0.204 Test Loss: 3.235 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35563665855636656
model parameter : 261766
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3207366
	speed: 0.0541s/iter; left time: 827.1693s
Epoch: 1 cost time: 7.1405041217803955
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.158 Vali Acc: 0.316 Test Loss: 2.158 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3185966
	speed: 0.1518s/iter; left time: 2299.4196s
Epoch: 2 cost time: 5.288421630859375
Epoch: 2, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.166 Vali Acc: 0.317 Test Loss: 2.166 Test Acc: 0.317
Validation loss decreased (-0.316280 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1424942
	speed: 0.1505s/iter; left time: 2256.5706s
Epoch: 3 cost time: 5.115875482559204
Epoch: 3, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.159 Vali Acc: 0.319 Test Loss: 2.159 Test Acc: 0.319
Validation loss decreased (-0.316686 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0586305
	speed: 0.1559s/iter; left time: 2313.7220s
Epoch: 4 cost time: 5.835421323776245
Epoch: 4, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.118 Vali Acc: 0.329 Test Loss: 2.118 Test Acc: 0.329
Validation loss decreased (-0.319119 --> -0.329257).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6441180
	speed: 0.1713s/iter; left time: 2515.3635s
Epoch: 5 cost time: 6.455103397369385
Epoch: 5, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.040 Vali Acc: 0.343 Test Loss: 2.040 Test Acc: 0.343
Validation loss decreased (-0.329257 --> -0.343451).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9868456
	speed: 0.1621s/iter; left time: 2356.1679s
Epoch: 6 cost time: 5.772959232330322
Epoch: 6, Steps: 154 | Train Loss: 1.777 Vali Loss: 2.269 Vali Acc: 0.347 Test Loss: 2.269 Test Acc: 0.347
Validation loss decreased (-0.343451 --> -0.347098).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2733482
	speed: 0.1556s/iter; left time: 2236.9002s
Epoch: 7 cost time: 5.4209349155426025
Epoch: 7, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.194 Vali Acc: 0.388 Test Loss: 2.194 Test Acc: 0.388
Validation loss decreased (-0.347098 --> -0.388056).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0920129
	speed: 0.1650s/iter; left time: 2347.2849s
Epoch: 8 cost time: 5.920343399047852
Epoch: 8, Steps: 154 | Train Loss: 1.651 Vali Loss: 3.024 Vali Acc: 0.183 Test Loss: 3.024 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5428528
	speed: 0.1503s/iter; left time: 2113.8800s
Epoch: 9 cost time: 5.26822566986084
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.886 Vali Acc: 0.193 Test Loss: 2.886 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6792825
	speed: 0.1473s/iter; left time: 2050.1177s
Epoch: 10 cost time: 5.394241809844971
Epoch: 10, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.218 Vali Acc: 0.175 Test Loss: 3.218 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.0223525
	speed: 0.1548s/iter; left time: 2130.3915s
Epoch: 11 cost time: 5.850794553756714
Epoch: 11, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.713 Vali Acc: 0.215 Test Loss: 2.713 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7190531
	speed: 0.1487s/iter; left time: 2024.0078s
Epoch: 12 cost time: 4.80915093421936
Epoch: 12, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.924 Vali Acc: 0.361 Test Loss: 2.924 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7496463
	speed: 0.1429s/iter; left time: 1922.8103s
Epoch: 13 cost time: 5.157983303070068
Epoch: 13, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.619 Vali Acc: 0.401 Test Loss: 2.619 Test Acc: 0.401
Validation loss decreased (-0.388056 --> -0.401434).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4355408
	speed: 0.1457s/iter; left time: 1937.5165s
Epoch: 14 cost time: 5.772305965423584
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.631 Vali Acc: 0.123 Test Loss: 3.631 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3002920
	speed: 0.1533s/iter; left time: 2015.7650s
Epoch: 15 cost time: 5.586078405380249
Epoch: 15, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.883 Vali Acc: 0.344 Test Loss: 2.883 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3712262
	speed: 0.1460s/iter; left time: 1896.0578s
Epoch: 16 cost time: 5.006909132003784
Epoch: 16, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.602 Vali Acc: 0.114 Test Loss: 3.602 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1631635
	speed: 0.1454s/iter; left time: 1866.6903s
Epoch: 17 cost time: 4.8691370487213135
Epoch: 17, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.465 Vali Acc: 0.127 Test Loss: 3.465 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1479887
	speed: 0.1444s/iter; left time: 1830.8283s
Epoch: 18 cost time: 5.0830206871032715
Epoch: 18, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.902 Vali Acc: 0.115 Test Loss: 3.902 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.5532304
	speed: 0.1506s/iter; left time: 1886.6315s
Epoch: 19 cost time: 5.125506639480591
Epoch: 19, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.491 Vali Acc: 0.124 Test Loss: 3.491 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2242813
	speed: 0.1447s/iter; left time: 1790.2068s
Epoch: 20 cost time: 4.870887756347656
Epoch: 20, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.884 Vali Acc: 0.125 Test Loss: 3.884 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5212960
	speed: 0.1459s/iter; left time: 1782.6799s
Epoch: 21 cost time: 5.632277250289917
Epoch: 21, Steps: 154 | Train Loss: 1.337 Vali Loss: 4.142 Vali Acc: 0.111 Test Loss: 4.142 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0939919
	speed: 0.1487s/iter; left time: 1794.4317s
Epoch: 22 cost time: 5.723775386810303
Epoch: 22, Steps: 154 | Train Loss: 1.322 Vali Loss: 4.028 Vali Acc: 0.123 Test Loss: 4.028 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1941702
	speed: 0.1586s/iter; left time: 1889.3591s
Epoch: 23 cost time: 5.673436880111694
Epoch: 23, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.759 Vali Acc: 0.124 Test Loss: 3.759 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40145985401459855
model parameter : 261670
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2021949
	speed: 0.0499s/iter; left time: 763.8719s
Epoch: 1 cost time: 6.814311504364014
Epoch: 1, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.158 Vali Acc: 0.315 Test Loss: 2.158 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0557594
	speed: 0.1573s/iter; left time: 2381.9973s
Epoch: 2 cost time: 5.301701307296753
Epoch: 2, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.181 Vali Acc: 0.315 Test Loss: 2.181 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0318766
	speed: 0.1560s/iter; left time: 2339.4738s
Epoch: 3 cost time: 5.6474339962005615
Epoch: 3, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.167 Vali Acc: 0.332 Test Loss: 2.167 Test Acc: 0.332
Validation loss decreased (-0.315064 --> -0.331690).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5290706
	speed: 0.1635s/iter; left time: 2426.6796s
Epoch: 4 cost time: 5.941972255706787
Epoch: 4, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.110 Vali Acc: 0.331 Test Loss: 2.110 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2100575
	speed: 0.1622s/iter; left time: 2382.2249s
Epoch: 5 cost time: 5.790337324142456
Epoch: 5, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.225 Vali Acc: 0.349 Test Loss: 2.225 Test Acc: 0.349
Validation loss decreased (-0.331690 --> -0.348721).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7015730
	speed: 0.1428s/iter; left time: 2075.0989s
Epoch: 6 cost time: 5.187982797622681
Epoch: 6, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.428 Vali Acc: 0.193 Test Loss: 2.428 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8339666
	speed: 0.1413s/iter; left time: 2030.8279s
Epoch: 7 cost time: 5.018437147140503
Epoch: 7, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.515 Vali Acc: 0.129 Test Loss: 2.515 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0287583
	speed: 0.1518s/iter; left time: 2159.0283s
Epoch: 8 cost time: 5.638786315917969
Epoch: 8, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.517 Vali Acc: 0.373 Test Loss: 2.517 Test Acc: 0.373
Validation loss decreased (-0.348721 --> -0.373049).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7378842
	speed: 0.1458s/iter; left time: 2050.7750s
Epoch: 9 cost time: 4.897367238998413
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 3.056 Vali Acc: 0.058 Test Loss: 3.056 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4181303
	speed: 0.1426s/iter; left time: 1984.2517s
Epoch: 10 cost time: 4.845890283584595
Epoch: 10, Steps: 154 | Train Loss: 1.552 Vali Loss: 3.168 Vali Acc: 0.160 Test Loss: 3.168 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3667301
	speed: 0.1480s/iter; left time: 2036.7772s
Epoch: 11 cost time: 5.077582120895386
Epoch: 11, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.069 Vali Acc: 0.202 Test Loss: 3.069 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.6818789
	speed: 0.1624s/iter; left time: 2210.4462s
Epoch: 12 cost time: 6.016981601715088
Epoch: 12, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.105 Vali Acc: 0.200 Test Loss: 3.105 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3966227
	speed: 0.1428s/iter; left time: 1920.5310s
Epoch: 13 cost time: 4.8826048374176025
Epoch: 13, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.320 Vali Acc: 0.193 Test Loss: 3.320 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.4773347
	speed: 0.1394s/iter; left time: 1853.9014s
Epoch: 14 cost time: 5.34271502494812
Epoch: 14, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.662 Vali Acc: 0.116 Test Loss: 3.662 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.7673289
	speed: 0.1423s/iter; left time: 1870.0047s
Epoch: 15 cost time: 5.347453594207764
Epoch: 15, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.564 Vali Acc: 0.112 Test Loss: 3.564 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1881188
	speed: 0.1424s/iter; left time: 1849.3489s
Epoch: 16 cost time: 4.806272029876709
Epoch: 16, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.191 Vali Acc: 0.219 Test Loss: 3.191 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2875736
	speed: 0.1524s/iter; left time: 1956.8170s
Epoch: 17 cost time: 5.585829019546509
Epoch: 17, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.361 Vali Acc: 0.137 Test Loss: 3.361 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.8669266
	speed: 0.1533s/iter; left time: 1944.2200s
Epoch: 18 cost time: 5.640901565551758
Epoch: 18, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.753 Vali Acc: 0.116 Test Loss: 3.753 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 261574
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8273935
	speed: 0.0512s/iter; left time: 783.5083s
Epoch: 1 cost time: 6.8896400928497314
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.189 Vali Acc: 0.156 Test Loss: 2.189 Test Acc: 0.156
Validation loss decreased (inf --> -0.155696).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1779969
	speed: 0.1549s/iter; left time: 2346.1257s
Epoch: 2 cost time: 5.386656284332275
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
Validation loss decreased (-0.155696 --> -0.315064).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8231860
	speed: 0.1557s/iter; left time: 2334.9438s
Epoch: 3 cost time: 5.855351209640503
Epoch: 3, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.204 Vali Acc: 0.319 Test Loss: 2.204 Test Acc: 0.319
Validation loss decreased (-0.315064 --> -0.319118).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8565605
	speed: 0.1495s/iter; left time: 2218.5295s
Epoch: 4 cost time: 5.516735792160034
Epoch: 4, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.094 Vali Acc: 0.325 Test Loss: 2.094 Test Acc: 0.325
Validation loss decreased (-0.319118 --> -0.324797).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8541955
	speed: 0.1522s/iter; left time: 2235.6090s
Epoch: 5 cost time: 5.5644142627716064
Epoch: 5, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.118 Vali Acc: 0.328 Test Loss: 2.118 Test Acc: 0.328
Validation loss decreased (-0.324797 --> -0.328446).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5798287
	speed: 0.1579s/iter; left time: 2294.2387s
Epoch: 6 cost time: 6.045901775360107
Epoch: 6, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.278 Vali Acc: 0.346 Test Loss: 2.278 Test Acc: 0.346
Validation loss decreased (-0.328446 --> -0.346287).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9640446
	speed: 0.1507s/iter; left time: 2166.0475s
Epoch: 7 cost time: 5.161438703536987
Epoch: 7, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.561 Vali Acc: 0.350 Test Loss: 2.561 Test Acc: 0.350
Validation loss decreased (-0.346287 --> -0.350339).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5434978
	speed: 0.1359s/iter; left time: 1933.3027s
Epoch: 8 cost time: 5.250243663787842
Epoch: 8, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.499 Vali Acc: 0.352 Test Loss: 2.499 Test Acc: 0.352
Validation loss decreased (-0.350339 --> -0.351557).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5484945
	speed: 0.1396s/iter; left time: 1963.4180s
Epoch: 9 cost time: 5.218812942504883
Epoch: 9, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.240 Vali Acc: 0.200 Test Loss: 2.240 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4133956
	speed: 0.1701s/iter; left time: 2366.5244s
Epoch: 10 cost time: 6.0949201583862305
Epoch: 10, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.766 Vali Acc: 0.198 Test Loss: 2.766 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6790175
	speed: 0.1495s/iter; left time: 2057.6596s
Epoch: 11 cost time: 4.911066293716431
Epoch: 11, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.660 Vali Acc: 0.202 Test Loss: 2.660 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.0650747
	speed: 0.1310s/iter; left time: 1782.3333s
Epoch: 12 cost time: 4.935213804244995
Epoch: 12, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.148 Vali Acc: 0.195 Test Loss: 3.148 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0426768
	speed: 0.1452s/iter; left time: 1953.6810s
Epoch: 13 cost time: 5.931305170059204
Epoch: 13, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.581 Vali Acc: 0.112 Test Loss: 3.581 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8384053
	speed: 0.1346s/iter; left time: 1790.1648s
Epoch: 14 cost time: 4.72010612487793
Epoch: 14, Steps: 154 | Train Loss: 1.446 Vali Loss: 3.359 Vali Acc: 0.358 Test Loss: 3.359 Test Acc: 0.358
Validation loss decreased (-0.351557 --> -0.358036).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8822695
	speed: 0.1405s/iter; left time: 1847.2255s
Epoch: 15 cost time: 4.847031831741333
Epoch: 15, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.585 Vali Acc: 0.125 Test Loss: 3.585 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1963530
	speed: 0.1448s/iter; left time: 1880.7196s
Epoch: 16 cost time: 5.4369800090789795
Epoch: 16, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.256 Vali Acc: 0.382 Test Loss: 3.256 Test Acc: 0.382
Validation loss decreased (-0.358036 --> -0.381557).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1792458
	speed: 0.1469s/iter; left time: 1886.0087s
Epoch: 17 cost time: 5.663246154785156
Epoch: 17, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.666 Vali Acc: 0.122 Test Loss: 3.666 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3730075
	speed: 0.1605s/iter; left time: 2035.4907s
Epoch: 18 cost time: 5.712689161300659
Epoch: 18, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.624 Vali Acc: 0.117 Test Loss: 3.624 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.5523537
	speed: 0.1729s/iter; left time: 2165.9503s
Epoch: 19 cost time: 6.31373143196106
Epoch: 19, Steps: 154 | Train Loss: 1.355 Vali Loss: 3.704 Vali Acc: 0.120 Test Loss: 3.704 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7491561
	speed: 0.1545s/iter; left time: 1911.7674s
Epoch: 20 cost time: 5.80469536781311
Epoch: 20, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.600 Vali Acc: 0.118 Test Loss: 3.600 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.0420530
	speed: 0.1434s/iter; left time: 1752.6692s
Epoch: 21 cost time: 5.178065776824951
Epoch: 21, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.423 Vali Acc: 0.122 Test Loss: 3.423 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0588094
	speed: 0.1518s/iter; left time: 1831.4859s
Epoch: 22 cost time: 5.535290956497192
Epoch: 22, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.721 Vali Acc: 0.131 Test Loss: 3.721 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.6556147
	speed: 0.1571s/iter; left time: 1871.0804s
Epoch: 23 cost time: 5.5459184646606445
Epoch: 23, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.770 Vali Acc: 0.126 Test Loss: 3.770 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3480656
	speed: 0.1535s/iter; left time: 1805.0627s
Epoch: 24 cost time: 5.6618452072143555
Epoch: 24, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.889 Vali Acc: 0.142 Test Loss: 3.889 Test Acc: 0.142
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.2696664
	speed: 0.1487s/iter; left time: 1725.2558s
Epoch: 25 cost time: 4.954432249069214
Epoch: 25, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.646 Vali Acc: 0.125 Test Loss: 3.646 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.1823505
	speed: 0.1406s/iter; left time: 1609.8667s
Epoch: 26 cost time: 5.141536712646484
Epoch: 26, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.681 Vali Acc: 0.132 Test Loss: 3.681 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3815896188158962
model parameter : 162022
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1761432
	speed: 0.0495s/iter; left time: 757.6225s
Epoch: 1 cost time: 6.706914186477661
Epoch: 1, Steps: 154 | Train Loss: 2.279 Vali Loss: 2.149 Vali Acc: 0.316 Test Loss: 2.149 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0083377
	speed: 0.1390s/iter; left time: 2105.8896s
Epoch: 2 cost time: 4.755598306655884
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.164 Vali Acc: 0.316 Test Loss: 2.164 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4260254
	speed: 0.1405s/iter; left time: 2106.6418s
Epoch: 3 cost time: 5.005119800567627
Epoch: 3, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.191 Vali Acc: 0.316 Test Loss: 2.191 Test Acc: 0.316
Validation loss decreased (-0.315875 --> -0.316280).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6559722
	speed: 0.1365s/iter; left time: 2024.9839s
Epoch: 4 cost time: 5.53436279296875
Epoch: 4, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.173 Vali Acc: 0.319 Test Loss: 2.173 Test Acc: 0.319
Validation loss decreased (-0.316280 --> -0.319119).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6934891
	speed: 0.1489s/iter; left time: 2187.0346s
Epoch: 5 cost time: 5.4682488441467285
Epoch: 5, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.109 Vali Acc: 0.326 Test Loss: 2.109 Test Acc: 0.326
Validation loss decreased (-0.319119 --> -0.326013).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6391932
	speed: 0.1375s/iter; left time: 1997.9640s
Epoch: 6 cost time: 4.990021705627441
Epoch: 6, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.301 Vali Acc: 0.189 Test Loss: 2.301 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6133394
	speed: 0.1317s/iter; left time: 1893.1622s
Epoch: 7 cost time: 4.742854356765747
Epoch: 7, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.282 Vali Acc: 0.196 Test Loss: 2.282 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5612730
	speed: 0.1320s/iter; left time: 1877.5680s
Epoch: 8 cost time: 5.130540370941162
Epoch: 8, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.464 Vali Acc: 0.356 Test Loss: 2.464 Test Acc: 0.356
Validation loss decreased (-0.326013 --> -0.355612).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6737075
	speed: 0.1445s/iter; left time: 2033.1062s
Epoch: 9 cost time: 5.045019865036011
Epoch: 9, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.844 Vali Acc: 0.191 Test Loss: 2.844 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5502138
	speed: 0.1374s/iter; left time: 1911.7461s
Epoch: 10 cost time: 5.364714860916138
Epoch: 10, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.051 Vali Acc: 0.108 Test Loss: 3.051 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6729120
	speed: 0.1416s/iter; left time: 1949.0931s
Epoch: 11 cost time: 5.094850540161133
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 3.058 Vali Acc: 0.193 Test Loss: 3.058 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2151608
	speed: 0.1598s/iter; left time: 2174.7789s
Epoch: 12 cost time: 5.640408039093018
Epoch: 12, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.918 Vali Acc: 0.368 Test Loss: 2.918 Test Acc: 0.368
Validation loss decreased (-0.355612 --> -0.367773).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4237140
	speed: 0.1409s/iter; left time: 1895.8642s
Epoch: 13 cost time: 5.341232776641846
Epoch: 13, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.178 Vali Acc: 0.183 Test Loss: 3.178 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2494979
	speed: 0.1392s/iter; left time: 1851.3244s
Epoch: 14 cost time: 5.353403329849243
Epoch: 14, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.364 Vali Acc: 0.195 Test Loss: 3.364 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9639295
	speed: 0.1485s/iter; left time: 1951.3841s
Epoch: 15 cost time: 5.280239105224609
Epoch: 15, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.499 Vali Acc: 0.118 Test Loss: 3.499 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4316963
	speed: 0.1416s/iter; left time: 1839.2046s
Epoch: 16 cost time: 5.343550443649292
Epoch: 16, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.403 Vali Acc: 0.203 Test Loss: 3.403 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3872443
	speed: 0.1420s/iter; left time: 1822.4624s
Epoch: 17 cost time: 5.356112718582153
Epoch: 17, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.703 Vali Acc: 0.108 Test Loss: 3.703 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2270410
	speed: 0.1472s/iter; left time: 1867.0158s
Epoch: 18 cost time: 5.422857999801636
Epoch: 18, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.717 Vali Acc: 0.135 Test Loss: 3.717 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3923870
	speed: 0.1389s/iter; left time: 1739.8417s
Epoch: 19 cost time: 5.270416736602783
Epoch: 19, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.829 Vali Acc: 0.115 Test Loss: 3.829 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0352383
	speed: 0.1279s/iter; left time: 1583.0245s
Epoch: 20 cost time: 4.619904279708862
Epoch: 20, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.895 Vali Acc: 0.116 Test Loss: 3.895 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3524590
	speed: 0.1324s/iter; left time: 1618.2564s
Epoch: 21 cost time: 4.640259504318237
Epoch: 21, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.700 Vali Acc: 0.122 Test Loss: 3.700 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.1362034
	speed: 0.1366s/iter; left time: 1648.0242s
Epoch: 22 cost time: 5.6689772605896
Epoch: 22, Steps: 154 | Train Loss: 1.328 Vali Loss: 4.190 Vali Acc: 0.111 Test Loss: 4.190 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 161926
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1031518
	speed: 0.0522s/iter; left time: 798.4265s
Epoch: 1 cost time: 6.93854546546936
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 2.149 Vali Acc: 0.315 Test Loss: 2.149 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6715137
	speed: 0.1553s/iter; left time: 2351.7803s
Epoch: 2 cost time: 5.860504388809204
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0726285
	speed: 0.1611s/iter; left time: 2415.3466s
Epoch: 3 cost time: 5.267237186431885
Epoch: 3, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.136 Vali Acc: 0.317 Test Loss: 2.136 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.317091).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2119987
	speed: 0.1570s/iter; left time: 2329.3151s
Epoch: 4 cost time: 5.530879974365234
Epoch: 4, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.108 Vali Acc: 0.327 Test Loss: 2.108 Test Acc: 0.327
Validation loss decreased (-0.317091 --> -0.326824).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0486877
	speed: 0.1287s/iter; left time: 1889.8809s
Epoch: 5 cost time: 4.533766508102417
Epoch: 5, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.154 Vali Acc: 0.328 Test Loss: 2.154 Test Acc: 0.328
Validation loss decreased (-0.326824 --> -0.328446).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9418406
	speed: 0.1380s/iter; left time: 2005.1145s
Epoch: 6 cost time: 5.311047792434692
Epoch: 6, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.349 Vali Acc: 0.348 Test Loss: 2.349 Test Acc: 0.348
Validation loss decreased (-0.328446 --> -0.348314).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6276098
	speed: 0.1783s/iter; left time: 2563.0115s
Epoch: 7 cost time: 6.113292217254639
Epoch: 7, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.319 Vali Acc: 0.377 Test Loss: 2.319 Test Acc: 0.377
Validation loss decreased (-0.348314 --> -0.376700).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2218375
	speed: 0.1658s/iter; left time: 2358.3729s
Epoch: 8 cost time: 5.823977708816528
Epoch: 8, Steps: 154 | Train Loss: 1.620 Vali Loss: 3.011 Vali Acc: 0.190 Test Loss: 3.011 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8386592
	speed: 0.1660s/iter; left time: 2335.6262s
Epoch: 9 cost time: 6.413644790649414
Epoch: 9, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.521 Vali Acc: 0.188 Test Loss: 2.521 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5943635
	speed: 0.1694s/iter; left time: 2357.7463s
Epoch: 10 cost time: 5.740089654922485
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.158 Vali Acc: 0.188 Test Loss: 3.158 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9178014
	speed: 0.1668s/iter; left time: 2295.3334s
Epoch: 11 cost time: 5.911064147949219
Epoch: 11, Steps: 154 | Train Loss: 1.519 Vali Loss: 3.094 Vali Acc: 0.142 Test Loss: 3.094 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5441710
	speed: 0.1645s/iter; left time: 2238.7147s
Epoch: 12 cost time: 6.0420451164245605
Epoch: 12, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.545 Vali Acc: 0.193 Test Loss: 3.545 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4613988
	speed: 0.1676s/iter; left time: 2254.9787s
Epoch: 13 cost time: 6.099836111068726
Epoch: 13, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.530 Vali Acc: 0.184 Test Loss: 3.530 Test Acc: 0.184
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.9667130
	speed: 0.1636s/iter; left time: 2175.8349s
Epoch: 14 cost time: 5.846640586853027
Epoch: 14, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.509 Vali Acc: 0.193 Test Loss: 3.509 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4571236
	speed: 0.1536s/iter; left time: 2018.5834s
Epoch: 15 cost time: 4.9113991260528564
Epoch: 15, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.740 Vali Acc: 0.107 Test Loss: 3.740 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.5086997
	speed: 0.1589s/iter; left time: 2064.2315s
Epoch: 16 cost time: 6.2294697761535645
Epoch: 16, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.367 Vali Acc: 0.211 Test Loss: 3.367 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1843926
	speed: 0.1567s/iter; left time: 2011.5305s
Epoch: 17 cost time: 5.455443382263184
Epoch: 17, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.212 Vali Acc: 0.155 Test Loss: 3.212 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 161830
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3547125
	speed: 0.0434s/iter; left time: 664.0331s
Epoch: 1 cost time: 5.953258752822876
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4096997
	speed: 0.1511s/iter; left time: 2289.2776s
Epoch: 2 cost time: 5.3791823387146
Epoch: 2, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2855494
	speed: 0.1465s/iter; left time: 2196.5073s
Epoch: 3 cost time: 5.2849040031433105
Epoch: 3, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.241 Vali Acc: 0.317 Test Loss: 2.241 Test Acc: 0.317
Validation loss decreased (-0.315064 --> -0.317090).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8348610
	speed: 0.1446s/iter; left time: 2145.3339s
Epoch: 4 cost time: 5.361992835998535
Epoch: 4, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.144 Vali Acc: 0.326 Test Loss: 2.144 Test Acc: 0.326
Validation loss decreased (-0.317090 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2601180
	speed: 0.1468s/iter; left time: 2156.0955s
Epoch: 5 cost time: 4.7073259353637695
Epoch: 5, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.091 Vali Acc: 0.334 Test Loss: 2.091 Test Acc: 0.334
Validation loss decreased (-0.325607 --> -0.334123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7904551
	speed: 0.1333s/iter; left time: 1936.5325s
Epoch: 6 cost time: 5.2792088985443115
Epoch: 6, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.335 Vali Acc: 0.336 Test Loss: 2.335 Test Acc: 0.336
Validation loss decreased (-0.334123 --> -0.335743).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1670535
	speed: 0.1434s/iter; left time: 2062.1225s
Epoch: 7 cost time: 5.078526496887207
Epoch: 7, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.727 Vali Acc: 0.230 Test Loss: 2.727 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7941527
	speed: 0.1432s/iter; left time: 2036.1705s
Epoch: 8 cost time: 5.098255395889282
Epoch: 8, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.401 Vali Acc: 0.384 Test Loss: 2.401 Test Acc: 0.384
Validation loss decreased (-0.335743 --> -0.383593).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8913635
	speed: 0.1573s/iter; left time: 2213.3247s
Epoch: 9 cost time: 5.779088735580444
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.606 Vali Acc: 0.371 Test Loss: 2.606 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3926420
	speed: 0.1548s/iter; left time: 2153.8998s
Epoch: 10 cost time: 5.833704233169556
Epoch: 10, Steps: 154 | Train Loss: 1.579 Vali Loss: 3.053 Vali Acc: 0.187 Test Loss: 3.053 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1269825
	speed: 0.1550s/iter; left time: 2133.5958s
Epoch: 11 cost time: 5.710134267807007
Epoch: 11, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.846 Vali Acc: 0.197 Test Loss: 2.846 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7660918
	speed: 0.1608s/iter; left time: 2187.3761s
Epoch: 12 cost time: 5.450477361679077
Epoch: 12, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.497 Vali Acc: 0.188 Test Loss: 3.497 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0265621
	speed: 0.1473s/iter; left time: 1981.3226s
Epoch: 13 cost time: 5.389860391616821
Epoch: 13, Steps: 154 | Train Loss: 1.499 Vali Loss: 3.321 Vali Acc: 0.110 Test Loss: 3.321 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9431646
	speed: 0.1507s/iter; left time: 2004.2790s
Epoch: 14 cost time: 5.641453266143799
Epoch: 14, Steps: 154 | Train Loss: 1.465 Vali Loss: 3.472 Vali Acc: 0.112 Test Loss: 3.472 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.0302742
	speed: 0.1496s/iter; left time: 1967.0446s
Epoch: 15 cost time: 5.338319540023804
Epoch: 15, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.688 Vali Acc: 0.109 Test Loss: 3.688 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.9328074
	speed: 0.1629s/iter; left time: 2115.6773s
Epoch: 16 cost time: 5.957019329071045
Epoch: 16, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.609 Vali Acc: 0.130 Test Loss: 3.609 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.5862317
	speed: 0.1547s/iter; left time: 1986.2941s
Epoch: 17 cost time: 5.207195997238159
Epoch: 17, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.197 Vali Acc: 0.223 Test Loss: 3.197 Test Acc: 0.223
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2333033
	speed: 0.1281s/iter; left time: 1624.8177s
Epoch: 18 cost time: 4.6640260219573975
Epoch: 18, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.323 Vali Acc: 0.153 Test Loss: 3.323 Test Acc: 0.153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38361719383617193
model parameter : 161734
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3290534
	speed: 0.0528s/iter; left time: 807.9622s
Epoch: 1 cost time: 7.04174280166626
Epoch: 1, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.201 Vali Acc: 0.315 Test Loss: 2.201 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4619706
	speed: 0.1359s/iter; left time: 2058.6409s
Epoch: 2 cost time: 5.031639337539673
Epoch: 2, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.189 Vali Acc: 0.315 Test Loss: 2.189 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315063).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0129948
	speed: 0.1375s/iter; left time: 2062.0467s
Epoch: 3 cost time: 5.11513614654541
Epoch: 3, Steps: 154 | Train Loss: 2.112 Vali Loss: 2.133 Vali Acc: 0.315 Test Loss: 2.133 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315064).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2968554
	speed: 0.1558s/iter; left time: 2311.5266s
Epoch: 4 cost time: 6.12092137336731
Epoch: 4, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.123 Vali Acc: 0.324 Test Loss: 2.123 Test Acc: 0.324
Validation loss decreased (-0.315064 --> -0.324391).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2950368
	speed: 0.1524s/iter; left time: 2237.6448s
Epoch: 5 cost time: 5.054101943969727
Epoch: 5, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.197 Vali Acc: 0.328 Test Loss: 2.197 Test Acc: 0.328
Validation loss decreased (-0.324391 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0694783
	speed: 0.1477s/iter; left time: 2145.6443s
Epoch: 6 cost time: 5.119389057159424
Epoch: 6, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.429 Vali Acc: 0.182 Test Loss: 2.429 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4855088
	speed: 0.1506s/iter; left time: 2165.5592s
Epoch: 7 cost time: 5.253901481628418
Epoch: 7, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.325 Vali Acc: 0.347 Test Loss: 2.325 Test Acc: 0.347
Validation loss decreased (-0.327634 --> -0.347098).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8559904
	speed: 0.1592s/iter; left time: 2264.2839s
Epoch: 8 cost time: 6.0800621509552
Epoch: 8, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.571 Vali Acc: 0.187 Test Loss: 2.571 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5184985
	speed: 0.1527s/iter; left time: 2148.9748s
Epoch: 9 cost time: 5.270287752151489
Epoch: 9, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.941 Vali Acc: 0.113 Test Loss: 2.941 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6724023
	speed: 0.1390s/iter; left time: 1934.2346s
Epoch: 10 cost time: 5.1884987354278564
Epoch: 10, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.642 Vali Acc: 0.197 Test Loss: 2.642 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4219437
	speed: 0.1371s/iter; left time: 1886.2907s
Epoch: 11 cost time: 5.317746162414551
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.735 Vali Acc: 0.371 Test Loss: 2.735 Test Acc: 0.371
Validation loss decreased (-0.347098 --> -0.371019).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9365489
	speed: 0.1555s/iter; left time: 2115.4448s
Epoch: 12 cost time: 5.560631036758423
Epoch: 12, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.858 Vali Acc: 0.366 Test Loss: 2.858 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2234554
	speed: 0.1599s/iter; left time: 2150.4938s
Epoch: 13 cost time: 5.763838291168213
Epoch: 13, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.825 Vali Acc: 0.363 Test Loss: 2.825 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8115556
	speed: 0.1522s/iter; left time: 2024.2503s
Epoch: 14 cost time: 5.842418193817139
Epoch: 14, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.691 Vali Acc: 0.219 Test Loss: 2.691 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4124197
	speed: 0.1527s/iter; left time: 2006.9637s
Epoch: 15 cost time: 5.3166890144348145
Epoch: 15, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.078 Vali Acc: 0.134 Test Loss: 3.078 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1170594
	speed: 0.1605s/iter; left time: 2085.0201s
Epoch: 16 cost time: 5.794292688369751
Epoch: 16, Steps: 154 | Train Loss: 1.412 Vali Loss: 3.033 Vali Acc: 0.371 Test Loss: 3.033 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.6400217
	speed: 0.1530s/iter; left time: 1964.5210s
Epoch: 17 cost time: 5.440903425216675
Epoch: 17, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.124 Vali Acc: 0.135 Test Loss: 3.124 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.7235507
	speed: 0.1597s/iter; left time: 2025.9605s
Epoch: 18 cost time: 6.1410393714904785
Epoch: 18, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.066 Vali Acc: 0.326 Test Loss: 3.066 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5768951
	speed: 0.1641s/iter; left time: 2056.4527s
Epoch: 19 cost time: 5.645663261413574
Epoch: 19, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.083 Vali Acc: 0.365 Test Loss: 3.083 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.6799827
	speed: 0.1578s/iter; left time: 1953.3782s
Epoch: 20 cost time: 5.492485523223877
Epoch: 20, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.237 Vali Acc: 0.169 Test Loss: 3.237 Test Acc: 0.169
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.5678072
	speed: 0.1533s/iter; left time: 1873.7282s
Epoch: 21 cost time: 5.592748165130615
Epoch: 21, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.192 Vali Acc: 0.210 Test Loss: 3.192 Test Acc: 0.210
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 112102
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1417325
	speed: 0.0528s/iter; left time: 807.8969s
Epoch: 1 cost time: 6.7781617641448975
Epoch: 1, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.156 Vali Acc: 0.315 Test Loss: 2.156 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2085869
	speed: 0.1416s/iter; left time: 2144.4617s
Epoch: 2 cost time: 5.23308801651001
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.169 Vali Acc: 0.316 Test Loss: 2.169 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8934168
	speed: 0.1443s/iter; left time: 2162.8094s
Epoch: 3 cost time: 5.203628063201904
Epoch: 3, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.147 Vali Acc: 0.315 Test Loss: 2.147 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7565262
	speed: 0.1452s/iter; left time: 2155.2099s
Epoch: 4 cost time: 5.475596189498901
Epoch: 4, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.169 Vali Acc: 0.320 Test Loss: 2.169 Test Acc: 0.320
Validation loss decreased (-0.315874 --> -0.319524).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2837362
	speed: 0.1522s/iter; left time: 2234.9531s
Epoch: 5 cost time: 5.144618988037109
Epoch: 5, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.108 Vali Acc: 0.326 Test Loss: 2.108 Test Acc: 0.326
Validation loss decreased (-0.319524 --> -0.326418).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8990682
	speed: 0.1517s/iter; left time: 2205.0339s
Epoch: 6 cost time: 5.682786226272583
Epoch: 6, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.128 Vali Acc: 0.345 Test Loss: 2.128 Test Acc: 0.345
Validation loss decreased (-0.326418 --> -0.345478).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9248848
	speed: 0.1421s/iter; left time: 2042.8903s
Epoch: 7 cost time: 5.153368234634399
Epoch: 7, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.390 Vali Acc: 0.371 Test Loss: 2.390 Test Acc: 0.371
Validation loss decreased (-0.345478 --> -0.371428).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2309784
	speed: 0.1406s/iter; left time: 1999.4853s
Epoch: 8 cost time: 5.231547117233276
Epoch: 8, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.627 Vali Acc: 0.193 Test Loss: 2.627 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1975026
	speed: 0.1469s/iter; left time: 2066.6161s
Epoch: 9 cost time: 4.7422263622283936
Epoch: 9, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.827 Vali Acc: 0.191 Test Loss: 2.827 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8096040
	speed: 0.1460s/iter; left time: 2030.9431s
Epoch: 10 cost time: 5.596186876296997
Epoch: 10, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.003 Vali Acc: 0.355 Test Loss: 3.003 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2419934
	speed: 0.1528s/iter; left time: 2103.3183s
Epoch: 11 cost time: 5.37378191947937
Epoch: 11, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.812 Vali Acc: 0.363 Test Loss: 2.812 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1250337
	speed: 0.1377s/iter; left time: 1873.8108s
Epoch: 12 cost time: 4.92028546333313
Epoch: 12, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.290 Vali Acc: 0.197 Test Loss: 3.290 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4968663
	speed: 0.1512s/iter; left time: 2034.4137s
Epoch: 13 cost time: 5.142670154571533
Epoch: 13, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.441 Vali Acc: 0.195 Test Loss: 3.441 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5037670
	speed: 0.1497s/iter; left time: 1990.4974s
Epoch: 14 cost time: 5.780595779418945
Epoch: 14, Steps: 154 | Train Loss: 1.446 Vali Loss: 3.059 Vali Acc: 0.207 Test Loss: 3.059 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1585448
	speed: 0.1537s/iter; left time: 2020.8259s
Epoch: 15 cost time: 5.633955478668213
Epoch: 15, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.974 Vali Acc: 0.205 Test Loss: 2.974 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6133565
	speed: 0.1644s/iter; left time: 2136.2111s
Epoch: 16 cost time: 5.595743417739868
Epoch: 16, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.189 Vali Acc: 0.208 Test Loss: 3.189 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3437834
	speed: 0.1498s/iter; left time: 1922.4721s
Epoch: 17 cost time: 5.433849096298218
Epoch: 17, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.833 Vali Acc: 0.062 Test Loss: 3.833 Test Acc: 0.062
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 112006
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5642782
	speed: 0.0549s/iter; left time: 839.9584s
Epoch: 1 cost time: 7.423986911773682
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.179 Vali Acc: 0.315 Test Loss: 2.179 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9137231
	speed: 0.1495s/iter; left time: 2263.8515s
Epoch: 2 cost time: 5.3555333614349365
Epoch: 2, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.164 Vali Acc: 0.315 Test Loss: 2.164 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9111309
	speed: 0.1395s/iter; left time: 2092.0032s
Epoch: 3 cost time: 4.6772894859313965
Epoch: 3, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.147 Vali Acc: 0.316 Test Loss: 2.147 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8966820
	speed: 0.1382s/iter; left time: 2050.2522s
Epoch: 4 cost time: 4.695211410522461
Epoch: 4, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.080 Vali Acc: 0.326 Test Loss: 2.080 Test Acc: 0.326
Validation loss decreased (-0.315875 --> -0.326013).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0039365
	speed: 0.1455s/iter; left time: 2136.4811s
Epoch: 5 cost time: 5.576677322387695
Epoch: 5, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.076 Vali Acc: 0.334 Test Loss: 2.076 Test Acc: 0.334
Validation loss decreased (-0.326013 --> -0.334124).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2118640
	speed: 0.1514s/iter; left time: 2199.9360s
Epoch: 6 cost time: 5.3087685108184814
Epoch: 6, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.353 Vali Acc: 0.182 Test Loss: 2.353 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9800045
	speed: 0.1414s/iter; left time: 2033.2335s
Epoch: 7 cost time: 5.130293369293213
Epoch: 7, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.298 Vali Acc: 0.195 Test Loss: 2.298 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8018187
	speed: 0.1559s/iter; left time: 2217.5949s
Epoch: 8 cost time: 5.630383491516113
Epoch: 8, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.678 Vali Acc: 0.192 Test Loss: 2.678 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6399895
	speed: 0.1517s/iter; left time: 2134.2447s
Epoch: 9 cost time: 5.097872257232666
Epoch: 9, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.553 Vali Acc: 0.197 Test Loss: 2.553 Test Acc: 0.197
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6092063
	speed: 0.1437s/iter; left time: 1999.0628s
Epoch: 10 cost time: 5.359882116317749
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.104 Vali Acc: 0.195 Test Loss: 3.104 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5782684
	speed: 0.1493s/iter; left time: 2053.9595s
Epoch: 11 cost time: 5.44404673576355
Epoch: 11, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.360 Vali Acc: 0.108 Test Loss: 3.360 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3199425
	speed: 0.1613s/iter; left time: 2195.0883s
Epoch: 12 cost time: 5.619452238082886
Epoch: 12, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.379 Vali Acc: 0.113 Test Loss: 3.379 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.9613351
	speed: 0.1537s/iter; left time: 2067.9179s
Epoch: 13 cost time: 5.203911066055298
Epoch: 13, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.319 Vali Acc: 0.139 Test Loss: 3.319 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.5566094
	speed: 0.1574s/iter; left time: 2093.2483s
Epoch: 14 cost time: 5.752972364425659
Epoch: 14, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.445 Vali Acc: 0.191 Test Loss: 3.445 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.9565517
	speed: 0.1646s/iter; left time: 2163.0875s
Epoch: 15 cost time: 6.209592342376709
Epoch: 15, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.517 Vali Acc: 0.161 Test Loss: 3.517 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33414436334144365
model parameter : 111910
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4642606
	speed: 0.0541s/iter; left time: 827.3137s
Epoch: 1 cost time: 7.215967178344727
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8076663
	speed: 0.1668s/iter; left time: 2526.7609s
Epoch: 2 cost time: 6.112644672393799
Epoch: 2, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0984807
	speed: 0.1711s/iter; left time: 2564.6306s
Epoch: 3 cost time: 6.18566107749939
Epoch: 3, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9877057
	speed: 0.1652s/iter; left time: 2452.0111s
Epoch: 4 cost time: 6.0435473918914795
Epoch: 4, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.197 Vali Acc: 0.322 Test Loss: 2.197 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.321957).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1745589
	speed: 0.1640s/iter; left time: 2409.0632s
Epoch: 5 cost time: 5.720848560333252
Epoch: 5, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.110 Vali Acc: 0.328 Test Loss: 2.110 Test Acc: 0.328
Validation loss decreased (-0.321957 --> -0.328446).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5877504
	speed: 0.1589s/iter; left time: 2309.4578s
Epoch: 6 cost time: 5.171443223953247
Epoch: 6, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.375 Vali Acc: 0.341 Test Loss: 2.375 Test Acc: 0.341
Validation loss decreased (-0.328446 --> -0.341420).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6999226
	speed: 0.1611s/iter; left time: 2316.2873s
Epoch: 7 cost time: 5.8112006187438965
Epoch: 7, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.258 Vali Acc: 0.363 Test Loss: 2.258 Test Acc: 0.363
Validation loss decreased (-0.341420 --> -0.363319).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4866674
	speed: 0.1553s/iter; left time: 2208.3749s
Epoch: 8 cost time: 5.744721174240112
Epoch: 8, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.604 Vali Acc: 0.192 Test Loss: 2.604 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2768413
	speed: 0.1581s/iter; left time: 2224.5200s
Epoch: 9 cost time: 5.759988069534302
Epoch: 9, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.414 Vali Acc: 0.371 Test Loss: 2.414 Test Acc: 0.371
Validation loss decreased (-0.363319 --> -0.371428).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8895097
	speed: 0.1569s/iter; left time: 2183.6436s
Epoch: 10 cost time: 5.39093017578125
Epoch: 10, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.836 Vali Acc: 0.360 Test Loss: 2.836 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5829378
	speed: 0.1590s/iter; left time: 2188.4213s
Epoch: 11 cost time: 5.589237689971924
Epoch: 11, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.184 Vali Acc: 0.199 Test Loss: 3.184 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4028189
	speed: 0.1626s/iter; left time: 2212.5170s
Epoch: 12 cost time: 5.715303659439087
Epoch: 12, Steps: 154 | Train Loss: 1.498 Vali Loss: 3.034 Vali Acc: 0.372 Test Loss: 3.034 Test Acc: 0.372
Validation loss decreased (-0.371428 --> -0.371827).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1481957
	speed: 0.1443s/iter; left time: 1941.4657s
Epoch: 13 cost time: 5.063672065734863
Epoch: 13, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.073 Vali Acc: 0.205 Test Loss: 3.073 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3560144
	speed: 0.1565s/iter; left time: 2081.3506s
Epoch: 14 cost time: 6.087954044342041
Epoch: 14, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.213 Vali Acc: 0.197 Test Loss: 3.213 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2309566
	speed: 0.1601s/iter; left time: 2103.9879s
Epoch: 15 cost time: 5.533579349517822
Epoch: 15, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.021 Vali Acc: 0.364 Test Loss: 3.021 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.8318475
	speed: 0.1710s/iter; left time: 2221.7509s
Epoch: 16 cost time: 5.627525329589844
Epoch: 16, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.188 Vali Acc: 0.116 Test Loss: 3.188 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5836626
	speed: 0.1540s/iter; left time: 1977.0188s
Epoch: 17 cost time: 5.279505968093872
Epoch: 17, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.498 Vali Acc: 0.123 Test Loss: 3.498 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0595945
	speed: 0.1615s/iter; left time: 2047.9768s
Epoch: 18 cost time: 5.7616963386535645
Epoch: 18, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.531 Vali Acc: 0.127 Test Loss: 3.531 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4343423
	speed: 0.1680s/iter; left time: 2104.4423s
Epoch: 19 cost time: 6.530484437942505
Epoch: 19, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.475 Vali Acc: 0.128 Test Loss: 3.475 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.4431008
	speed: 0.1820s/iter; left time: 2252.5843s
Epoch: 20 cost time: 6.566451549530029
Epoch: 20, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.493 Vali Acc: 0.195 Test Loss: 3.493 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3160425
	speed: 0.1669s/iter; left time: 2040.1931s
Epoch: 21 cost time: 5.841538906097412
Epoch: 21, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.478 Vali Acc: 0.122 Test Loss: 3.478 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.4053786
	speed: 0.1770s/iter; left time: 2135.3138s
Epoch: 22 cost time: 5.950077056884766
Epoch: 22, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.528 Vali Acc: 0.190 Test Loss: 3.528 Test Acc: 0.190
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 111814
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4633992
	speed: 0.0548s/iter; left time: 838.4891s
Epoch: 1 cost time: 7.4420037269592285
Epoch: 1, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.149 Vali Acc: 0.315 Test Loss: 2.149 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0344858
	speed: 0.1643s/iter; left time: 2488.5798s
Epoch: 2 cost time: 6.048149347305298
Epoch: 2, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.226 Vali Acc: 0.315 Test Loss: 2.226 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8893031
	speed: 0.1680s/iter; left time: 2518.4404s
Epoch: 3 cost time: 6.246119737625122
Epoch: 3, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.138 Vali Acc: 0.315 Test Loss: 2.138 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2058909
	speed: 0.1721s/iter; left time: 2554.0458s
Epoch: 4 cost time: 6.493078947067261
Epoch: 4, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.136 Vali Acc: 0.322 Test Loss: 2.136 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.321552).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7813963
	speed: 0.1801s/iter; left time: 2644.5305s
Epoch: 5 cost time: 5.7395055294036865
Epoch: 5, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.071 Vali Acc: 0.330 Test Loss: 2.071 Test Acc: 0.330
Validation loss decreased (-0.321552 --> -0.330474).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8521800
	speed: 0.1747s/iter; left time: 2538.8857s
Epoch: 6 cost time: 5.595573425292969
Epoch: 6, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.142 Vali Acc: 0.350 Test Loss: 2.142 Test Acc: 0.350
Validation loss decreased (-0.330474 --> -0.350344).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7489767
	speed: 0.1428s/iter; left time: 2053.3617s
Epoch: 7 cost time: 5.0174784660339355
Epoch: 7, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.230 Vali Acc: 0.194 Test Loss: 2.230 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9040571
	speed: 0.1530s/iter; left time: 2175.7671s
Epoch: 8 cost time: 5.971776008605957
Epoch: 8, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.317 Vali Acc: 0.195 Test Loss: 2.317 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5627170
	speed: 0.1494s/iter; left time: 2102.5003s
Epoch: 9 cost time: 5.545585870742798
Epoch: 9, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.639 Vali Acc: 0.193 Test Loss: 2.639 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1831170
	speed: 0.1647s/iter; left time: 2291.2990s
Epoch: 10 cost time: 5.6357645988464355
Epoch: 10, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.785 Vali Acc: 0.193 Test Loss: 2.785 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2325950
	speed: 0.1618s/iter; left time: 2226.4537s
Epoch: 11 cost time: 5.626262903213501
Epoch: 11, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.654 Vali Acc: 0.371 Test Loss: 2.654 Test Acc: 0.371
Validation loss decreased (-0.350344 --> -0.371425).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4474230
	speed: 0.1747s/iter; left time: 2376.5415s
Epoch: 12 cost time: 6.550789833068848
Epoch: 12, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.325 Vali Acc: 0.060 Test Loss: 3.325 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0141828
	speed: 0.1634s/iter; left time: 2198.7758s
Epoch: 13 cost time: 5.852936029434204
Epoch: 13, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.324 Vali Acc: 0.117 Test Loss: 3.324 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0727769
	speed: 0.1551s/iter; left time: 2063.0709s
Epoch: 14 cost time: 5.771366119384766
Epoch: 14, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.148 Vali Acc: 0.206 Test Loss: 3.148 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2824938
	speed: 0.1633s/iter; left time: 2146.7066s
Epoch: 15 cost time: 5.48180079460144
Epoch: 15, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.195 Vali Acc: 0.131 Test Loss: 3.195 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.4716492
	speed: 0.1643s/iter; left time: 2133.9484s
Epoch: 16 cost time: 5.942590713500977
Epoch: 16, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.989 Vali Acc: 0.367 Test Loss: 2.989 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9263778
	speed: 0.1642s/iter; left time: 2107.8585s
Epoch: 17 cost time: 5.698150634765625
Epoch: 17, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.294 Vali Acc: 0.188 Test Loss: 3.294 Test Acc: 0.188
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.0696937
	speed: 0.1543s/iter; left time: 1956.5471s
Epoch: 18 cost time: 5.400022268295288
Epoch: 18, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.275 Vali Acc: 0.138 Test Loss: 3.275 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2772833
	speed: 0.1685s/iter; left time: 2111.2211s
Epoch: 19 cost time: 6.419871807098389
Epoch: 19, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.267 Vali Acc: 0.127 Test Loss: 3.267 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1589458
	speed: 0.1669s/iter; left time: 2064.8484s
Epoch: 20 cost time: 5.6900482177734375
Epoch: 20, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.131 Vali Acc: 0.162 Test Loss: 3.131 Test Acc: 0.162
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.2260255
	speed: 0.1666s/iter; left time: 2035.8037s
Epoch: 21 cost time: 6.054705381393433
Epoch: 21, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.609 Vali Acc: 0.197 Test Loss: 3.609 Test Acc: 0.197
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 87142
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0247512
	speed: 0.0536s/iter; left time: 819.9653s
Epoch: 1 cost time: 7.373890399932861
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.170 Vali Acc: 0.315 Test Loss: 2.170 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3309505
	speed: 0.1685s/iter; left time: 2551.8448s
Epoch: 2 cost time: 5.882482051849365
Epoch: 2, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.173 Vali Acc: 0.315 Test Loss: 2.173 Test Acc: 0.315
Validation loss decreased (-0.315063 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0246062
	speed: 0.1709s/iter; left time: 2562.6478s
Epoch: 3 cost time: 5.936679124832153
Epoch: 3, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.7298660
	speed: 0.1660s/iter; left time: 2462.8586s
Epoch: 4 cost time: 6.043766975402832
Epoch: 4, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.127 Vali Acc: 0.318 Test Loss: 2.127 Test Acc: 0.318
Validation loss decreased (-0.315469 --> -0.317902).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2966700
	speed: 0.1715s/iter; left time: 2517.9996s
Epoch: 5 cost time: 5.910530090332031
Epoch: 5, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.099 Vali Acc: 0.325 Test Loss: 2.099 Test Acc: 0.325
Validation loss decreased (-0.317902 --> -0.325202).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3415525
	speed: 0.1562s/iter; left time: 2269.7882s
Epoch: 6 cost time: 5.250126361846924
Epoch: 6, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.181 Vali Acc: 0.350 Test Loss: 2.181 Test Acc: 0.350
Validation loss decreased (-0.325202 --> -0.349532).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0236578
	speed: 0.1512s/iter; left time: 2173.8188s
Epoch: 7 cost time: 5.477667331695557
Epoch: 7, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.213 Vali Acc: 0.369 Test Loss: 2.213 Test Acc: 0.369
Validation loss decreased (-0.349532 --> -0.368997).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6056625
	speed: 0.1655s/iter; left time: 2353.3431s
Epoch: 8 cost time: 5.961137533187866
Epoch: 8, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.656 Vali Acc: 0.190 Test Loss: 2.656 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6654514
	speed: 0.1738s/iter; left time: 2444.7327s
Epoch: 9 cost time: 5.670037508010864
Epoch: 9, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.652 Vali Acc: 0.367 Test Loss: 2.652 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7212737
	speed: 0.1638s/iter; left time: 2279.6007s
Epoch: 10 cost time: 5.543022632598877
Epoch: 10, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.778 Vali Acc: 0.389 Test Loss: 2.778 Test Acc: 0.389
Validation loss decreased (-0.368997 --> -0.388861).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4996467
	speed: 0.1599s/iter; left time: 2200.8452s
Epoch: 11 cost time: 5.585514307022095
Epoch: 11, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.111 Vali Acc: 0.139 Test Loss: 3.111 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3887694
	speed: 0.1633s/iter; left time: 2221.4588s
Epoch: 12 cost time: 6.021894931793213
Epoch: 12, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.613 Vali Acc: 0.215 Test Loss: 2.613 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8448017
	speed: 0.1576s/iter; left time: 2120.7574s
Epoch: 13 cost time: 5.708007097244263
Epoch: 13, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.121 Vali Acc: 0.194 Test Loss: 3.121 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4896848
	speed: 0.1444s/iter; left time: 1920.7063s
Epoch: 14 cost time: 5.2415478229522705
Epoch: 14, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.218 Vali Acc: 0.362 Test Loss: 3.218 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4746424
	speed: 0.1431s/iter; left time: 1881.5453s
Epoch: 15 cost time: 5.371413469314575
Epoch: 15, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.288 Vali Acc: 0.141 Test Loss: 3.288 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4505892
	speed: 0.1526s/iter; left time: 1982.3582s
Epoch: 16 cost time: 5.505425453186035
Epoch: 16, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.238 Vali Acc: 0.076 Test Loss: 3.238 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2107060
	speed: 0.1634s/iter; left time: 2097.9880s
Epoch: 17 cost time: 5.344816446304321
Epoch: 17, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.425 Vali Acc: 0.122 Test Loss: 3.425 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3134040
	speed: 0.1533s/iter; left time: 1944.9323s
Epoch: 18 cost time: 5.771780252456665
Epoch: 18, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.379 Vali Acc: 0.161 Test Loss: 3.379 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3673675
	speed: 0.1670s/iter; left time: 2092.6304s
Epoch: 19 cost time: 6.041088581085205
Epoch: 19, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.188 Vali Acc: 0.206 Test Loss: 3.188 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.6438322
	speed: 0.1611s/iter; left time: 1994.0964s
Epoch: 20 cost time: 5.732441186904907
Epoch: 20, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.353 Vali Acc: 0.087 Test Loss: 3.353 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3888888888888889
model parameter : 87046
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2375212
	speed: 0.0530s/iter; left time: 810.7566s
Epoch: 1 cost time: 7.211542129516602
Epoch: 1, Steps: 154 | Train Loss: 2.232 Vali Loss: 2.174 Vali Acc: 0.315 Test Loss: 2.174 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1523418
	speed: 0.1616s/iter; left time: 2447.5984s
Epoch: 2 cost time: 5.696255445480347
Epoch: 2, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.167 Vali Acc: 0.315 Test Loss: 2.167 Test Acc: 0.315
Validation loss decreased (-0.315469 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1707270
	speed: 0.1733s/iter; left time: 2597.8371s
Epoch: 3 cost time: 5.988508224487305
Epoch: 3, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.136 Vali Acc: 0.316 Test Loss: 2.136 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9259833
	speed: 0.1660s/iter; left time: 2463.6477s
Epoch: 4 cost time: 5.6643548011779785
Epoch: 4, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.197 Vali Acc: 0.319 Test Loss: 2.197 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.319118).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6297181
	speed: 0.1595s/iter; left time: 2341.8851s
Epoch: 5 cost time: 5.2285380363464355
Epoch: 5, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.062 Vali Acc: 0.330 Test Loss: 2.062 Test Acc: 0.330
Validation loss decreased (-0.319118 --> -0.330474).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5022955
	speed: 0.1431s/iter; left time: 2078.6925s
Epoch: 6 cost time: 4.962274789810181
Epoch: 6, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.141 Vali Acc: 0.357 Test Loss: 2.141 Test Acc: 0.357
Validation loss decreased (-0.330474 --> -0.357237).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3027389
	speed: 0.1578s/iter; left time: 2269.0354s
Epoch: 7 cost time: 5.522954225540161
Epoch: 7, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.451 Vali Acc: 0.191 Test Loss: 2.451 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8394814
	speed: 0.1549s/iter; left time: 2203.1913s
Epoch: 8 cost time: 5.758959531784058
Epoch: 8, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.304 Vali Acc: 0.363 Test Loss: 2.304 Test Acc: 0.363
Validation loss decreased (-0.357237 --> -0.362913).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8047990
	speed: 0.1549s/iter; left time: 2178.6955s
Epoch: 9 cost time: 5.819617509841919
Epoch: 9, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.339 Vali Acc: 0.368 Test Loss: 2.339 Test Acc: 0.368
Validation loss decreased (-0.362913 --> -0.367779).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4382523
	speed: 0.1543s/iter; left time: 2147.6420s
Epoch: 10 cost time: 4.953587055206299
Epoch: 10, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.756 Vali Acc: 0.345 Test Loss: 2.756 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2877910
	speed: 0.1442s/iter; left time: 1983.7847s
Epoch: 11 cost time: 5.1623969078063965
Epoch: 11, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.160 Vali Acc: 0.187 Test Loss: 3.160 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1795480
	speed: 0.1553s/iter; left time: 2113.4553s
Epoch: 12 cost time: 5.590296506881714
Epoch: 12, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.839 Vali Acc: 0.152 Test Loss: 2.839 Test Acc: 0.152
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0597030
	speed: 0.1390s/iter; left time: 1869.9718s
Epoch: 13 cost time: 5.393739461898804
Epoch: 13, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.910 Vali Acc: 0.247 Test Loss: 2.910 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3459091
	speed: 0.1422s/iter; left time: 1891.2861s
Epoch: 14 cost time: 5.054478406906128
Epoch: 14, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.234 Vali Acc: 0.205 Test Loss: 3.234 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.8352846
	speed: 0.1476s/iter; left time: 1940.0728s
Epoch: 15 cost time: 5.451891899108887
Epoch: 15, Steps: 154 | Train Loss: 1.455 Vali Loss: 3.222 Vali Acc: 0.365 Test Loss: 3.222 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.2052410
	speed: 0.1674s/iter; left time: 2174.9342s
Epoch: 16 cost time: 5.560517311096191
Epoch: 16, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.995 Vali Acc: 0.208 Test Loss: 2.995 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.8789343
	speed: 0.1506s/iter; left time: 1933.8061s
Epoch: 17 cost time: 5.582355976104736
Epoch: 17, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.326 Vali Acc: 0.195 Test Loss: 3.326 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.5712776
	speed: 0.1632s/iter; left time: 2070.3137s
Epoch: 18 cost time: 5.515415668487549
Epoch: 18, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.548 Vali Acc: 0.195 Test Loss: 3.548 Test Acc: 0.195
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.5802591
	speed: 0.1570s/iter; left time: 1966.6302s
Epoch: 19 cost time: 5.602287530899048
Epoch: 19, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.156 Vali Acc: 0.174 Test Loss: 3.156 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 86950
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0900438
	speed: 0.0500s/iter; left time: 764.3606s
Epoch: 1 cost time: 6.85337233543396
Epoch: 1, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1848488
	speed: 0.1617s/iter; left time: 2449.1553s
Epoch: 2 cost time: 5.906581878662109
Epoch: 2, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.169 Vali Acc: 0.315 Test Loss: 2.169 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3000562
	speed: 0.1551s/iter; left time: 2325.4372s
Epoch: 3 cost time: 5.714791536331177
Epoch: 3, Steps: 154 | Train Loss: 2.089 Vali Loss: 2.146 Vali Acc: 0.315 Test Loss: 2.146 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315064).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0904162
	speed: 0.1491s/iter; left time: 2212.6471s
Epoch: 4 cost time: 5.744679689407349
Epoch: 4, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.139 Vali Acc: 0.325 Test Loss: 2.139 Test Acc: 0.325
Validation loss decreased (-0.315064 --> -0.325202).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1164353
	speed: 0.1492s/iter; left time: 2191.5454s
Epoch: 5 cost time: 4.689429998397827
Epoch: 5, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.172 Vali Acc: 0.172 Test Loss: 2.172 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9144440
	speed: 0.1385s/iter; left time: 2012.3080s
Epoch: 6 cost time: 4.717741012573242
Epoch: 6, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.114 Vali Acc: 0.341 Test Loss: 2.114 Test Acc: 0.341
Validation loss decreased (-0.325202 --> -0.340611).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9678515
	speed: 0.1528s/iter; left time: 2196.8516s
Epoch: 7 cost time: 5.879468679428101
Epoch: 7, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.330 Vali Acc: 0.367 Test Loss: 2.330 Test Acc: 0.367
Validation loss decreased (-0.340611 --> -0.366562).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5489969
	speed: 0.1459s/iter; left time: 2074.8579s
Epoch: 8 cost time: 4.970600366592407
Epoch: 8, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.563 Vali Acc: 0.187 Test Loss: 2.563 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1409962
	speed: 0.1414s/iter; left time: 1988.7687s
Epoch: 9 cost time: 5.148292303085327
Epoch: 9, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.601 Vali Acc: 0.358 Test Loss: 2.601 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8072174
	speed: 0.1415s/iter; left time: 1968.3538s
Epoch: 10 cost time: 4.99183201789856
Epoch: 10, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.878 Vali Acc: 0.165 Test Loss: 2.878 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6432240
	speed: 0.1416s/iter; left time: 1948.8116s
Epoch: 11 cost time: 5.053401947021484
Epoch: 11, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.654 Vali Acc: 0.390 Test Loss: 2.654 Test Acc: 0.390
Validation loss decreased (-0.366562 --> -0.389673).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2223321
	speed: 0.1489s/iter; left time: 2026.0440s
Epoch: 12 cost time: 4.9941041469573975
Epoch: 12, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.294 Vali Acc: 0.121 Test Loss: 3.294 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2625461
	speed: 0.1433s/iter; left time: 1927.6028s
Epoch: 13 cost time: 5.256042242050171
Epoch: 13, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.223 Vali Acc: 0.199 Test Loss: 3.223 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7532307
	speed: 0.1416s/iter; left time: 1882.5621s
Epoch: 14 cost time: 5.516164064407349
Epoch: 14, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.174 Vali Acc: 0.071 Test Loss: 3.174 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7010355
	speed: 0.1504s/iter; left time: 1976.9335s
Epoch: 15 cost time: 5.4421327114105225
Epoch: 15, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.398 Vali Acc: 0.177 Test Loss: 3.398 Test Acc: 0.177
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2654784
	speed: 0.1520s/iter; left time: 1974.3132s
Epoch: 16 cost time: 5.241573095321655
Epoch: 16, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.323 Vali Acc: 0.136 Test Loss: 3.323 Test Acc: 0.136
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.5701014
	speed: 0.1542s/iter; left time: 1979.4144s
Epoch: 17 cost time: 5.354435682296753
Epoch: 17, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.514 Vali Acc: 0.142 Test Loss: 3.514 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4079787
	speed: 0.1367s/iter; left time: 1733.6516s
Epoch: 18 cost time: 5.092805862426758
Epoch: 18, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.343 Vali Acc: 0.157 Test Loss: 3.343 Test Acc: 0.157
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 2.0508215
	speed: 0.1481s/iter; left time: 1855.6408s
Epoch: 19 cost time: 5.75890326499939
Epoch: 19, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.930 Vali Acc: 0.114 Test Loss: 3.930 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.6593342
	speed: 0.1528s/iter; left time: 1891.2270s
Epoch: 20 cost time: 5.59110951423645
Epoch: 20, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.397 Vali Acc: 0.120 Test Loss: 3.397 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.7790189
	speed: 0.1540s/iter; left time: 1882.1893s
Epoch: 21 cost time: 5.804480314254761
Epoch: 21, Steps: 154 | Train Loss: 1.336 Vali Loss: 3.150 Vali Acc: 0.188 Test Loss: 3.150 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_Crossformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 86854
model size : 1.01MB
